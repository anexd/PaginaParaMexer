(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[1],{14:function(e,t,n){"use strict";n.d(t,{f:function(){return r}});var r=(0,n(4115).y)("22634de5$IHeaderFooterControlOwnerEvent")},1141:function(e,t,n){"use strict";n.r(t);var r=n(1817),i=n(4115),s=n(1982),o=(0,i.y)("bb67ce19$IFindResultAppEventCoordinator"),a=n(5566),l=n(9101),u=(0,i.y)("b2585251$IFindResultNavigator"),d=n(8902),c=n(4232),p=n(7766),h=n(8108),g=n(2323),_=n(9749),f=n(3408),y=n(9399),R=n(3619),v=n(885),T=n(7762),m=n(2612),N=n(8721),I=function(){function e(e){this._graphIteratorFactory=null,this.$$pf_SupportedTypes=null,this._graphIteratorFactory=e;var t=new Array(0);Array.add(t,1),this.set_supportedTypes(t)}return e.prototype.get_supportedTypes=function(){return this.$$pf_SupportedTypes},e.prototype.set_supportedTypes=function(e){return this.$$pf_SupportedTypes=e,e},e.prototype.getFindContexts=function(e){var t=this._graphIteratorFactory.getGraphIterator();t.set(e);var n=new Array(0);if(t.tryToRootAtAncestorOfType(8)){t.returnToAncestorOfType(8);var r=t.get_currentNode();Array.add(n,new m.w(r,e,1))}return n},e.CreateInstanceWithResolvedDependencies=function(){return new e(new N.c)},e.get_instance=function(){return e._instance||(e._instance=e.CreateInstanceWithResolvedDependencies())},e._instance=null,e}();(0,i.l)(I,"af689ef7$FindContextHelper",null,[T.z]);var F=n(639),S=n(8280),C=n(9275),A=n(8681),k=n(9090),x=n(2375),w=function(){function e(e,t,n,r,s,o,a,l,u){this._task=null,this._handleEvents=!1,this._hasSkippedGrepOfNodes=!1,this._findManager=null,this._findUIManager=null,this._findHelper=null,this._taskManager=null,this._graphTransactionFactory=null,this._clearResults=null,this._regrepNodes=null,this._regrepNode=null,this._stopwatchBuilder=null,this.changedNodes=null,this.addedNodes=null,this.deletedNodes=null,this.scheduleDirtyNodeProcessing=null,this.$$pf_ResultsOutOfSyncWithDocument=!1,this._findManager=e,this._findUIManager=t,this._findHelper=n,this._taskManager=r,this._graphTransactionFactory=s,this._clearResults=o,this._regrepNodes=a,this._regrepNode=l,this._stopwatchBuilder=u,this.Reset(),this.scheduleDirtyNodeProcessing=i.i(this,this.ScheduleDirtyNodeProcessTask,"ScheduleDirtyNodeProcessTask"),this._findHelper.registerParagraphChangeHandlers(i.i(this,this.OnParagraphPropertyChanged,"OnParagraphPropertyChanged"),i.i(this,this.OnParagraphConnect,"OnParagraphConnect"),i.i(this,this.OnParagraphDisconnect,"OnParagraphDisconnect"))}return e.prototype.get_changedNodes=function(){return this.changedNodes},e.prototype.get_addedNodes=function(){return this.addedNodes},e.prototype.get_deletedNodes=function(){return this.deletedNodes},e.prototype.get_resultsOutOfSyncWithDocument=function(){return this.$$pf_ResultsOutOfSyncWithDocument},e.prototype.set_resultsOutOfSyncWithDocument=function(e){return this.$$pf_ResultsOutOfSyncWithDocument=e,e},e.prototype.get_hasChangedOrDeletedNodesToProcess=function(){return this.get_changedNodes().get_count()>0||this.get_deletedNodes().get_count()>0},e.prototype.start=function(){this._handleEvents=!0,this.SetResultsOutOfSyncWithDocument(!1)},e.prototype.stop=function(){this.Reset()},e.prototype.Reset=function(){this._handleEvents=!1,this.SetResultsOutOfSyncWithDocument(!1),this.changedNodes=new k.e(C.h,d.d),this.addedNodes=new k.e(C.h,d.d),this.deletedNodes=new k.e(C.h,d.d),this.ClearPendingTask()},e.prototype.OnParagraphPropertyChanged=function(e,t){var n=t.get_node();t.get_property()===S.b.richEditTextUnicode&&this.IsNodePartOfActivePageObjectSpace(n)&&this.HandleNodeUpdate(n,3)},e.prototype.OnParagraphDisconnect=function(e,t){var n=t.get_node();this.IsNodePartOfActivePageObjectSpace(n)&&this.HandleNodeUpdate(n,2)},e.prototype.OnParagraphConnect=function(e,t){var n=t.get_node(),r=t.get_isDelayLoad();!this._findManager.get_findCompleted()&&r||!this.IsNodePartOfActivePageObjectSpace(n)||this.HandleNodeUpdate(n,1)},e.prototype.IsNodePartOfActivePageObjectSpace=function(e){return!!e.get_containingObjectSpace()&&!!this._findHelper.get_objectSpace()&&e.get_containingObjectSpace().get_id().equals(this._findHelper.get_objectSpace().get_id())},e.prototype.HandleNodeUpdate=function(e,t){if(this._handleEvents&&i.r(d.d,e)&&!this._findManager.get_replaceManager().get_replaceInProgress())if(this._findManager.get_resultManager().get_totalIncludingDirtyResults()||this._findManager.get_resultManager().get_lastReplacedNodeIds().length){var n=e;switch(t){case 1:this.get_changedNodes().containsKey(e.get_id())||this.get_addedNodes().set_item(e.get_id(),n);break;case 2:this.get_changedNodes().containsKey(e.get_id())&&this.get_changedNodes().remove(e.get_id()),this.get_addedNodes().containsKey(e.get_id())?this.get_addedNodes().remove(e.get_id()):this.get_deletedNodes().set_item(e.get_id(),n);break;case 3:this.get_changedNodes().set_item(e.get_id(),n)}this.scheduleDirtyNodeProcessing()}else 2!==t&&this.SetResultsOutOfSyncWithDocument(this._hasSkippedGrepOfNodes=!0)},e.prototype.ProcessDirtyNodes=function(e){var t=this._stopwatchBuilder.makeAndStartStopwatch("UserAction","ProcessDirtyNodesInFindResultsTime");this._task=null;var n=this._graphTransactionFactory.getTransaction(3);if(n.setFromNode(this._findHelper.get_activePage()),this.get_addedNodes().get_count()>0&&(this._hasSkippedGrepOfNodes=!0,this._clearResults(this.get_addedNodes(),this._findManager.get_resultManager())),this.get_deletedNodes().get_count()>0&&this._clearResults(this.get_deletedNodes(),this._findManager.get_resultManager()),this.get_changedNodes().get_count()>0){var r=!this._regrepNodes(this.get_changedNodes(),this._findManager,this._findHelper,this._regrepNode);this._hasSkippedGrepOfNodes=this._hasSkippedGrepOfNodes||r}n.dispose(),this._findManager.get_resultManager().updateActiveIndexFromActiveResult(),this.SetResultsOutOfSyncWithDocument(this._hasSkippedGrepOfNodes),this.scheduleDirtyNodeProcessing(),t.stop()},e.prototype.ScheduleDirtyNodeProcessTask=function(){this.ClearPendingTask(),(this.get_changedNodes().get_count()>0||this.get_addedNodes().get_count()>0||this.get_deletedNodes().get_count()>0)&&(this._task=new R.c(2,1,e.ProcessTimeout,i.i(this,this.ProcessDirtyNodes,"ProcessDirtyNodes"),53),this._taskManager.addTask(this._task))},e.prototype.ClearPendingTask=function(){this._task&&(this._taskManager.deleteTask(this._task),this._task=null)},e.prototype.SetResultsOutOfSyncWithDocument=function(e){this.get_resultsOutOfSyncWithDocument()!==e&&(this.set_resultsOutOfSyncWithDocument(e),this._findUIManager.setResultsOutOfSyncWithDocument(e)),e||(this._hasSkippedGrepOfNodes=!1)},e.CreateInstanceWithResolvedDependencies=function(t,n){return new e(t,n,F.FindManagerHelper.get_Instance(),A.y.get_instance(),new x.b,e.ClearDirtyResults,e.RegrepNodesAndUpdateResults,e.RegrepNodeAndUpdateResults,v.App.get_activeAppFrame().get_theStopwatchBuilder())},e.CreateInstance=function(t,n){return e._instance||(e._instance=e.CreateInstanceWithResolvedDependencies(t,n))},e.RegrepNodesAndUpdateResults=function(t,n,r,i){for(var s=!1,o=e.GetUptoMaxNodesToProcess(t,e.MaxNodesToRegrep),a=0;a<o.length;++a){var l=!i(o[a],n,r);s=s||l,t.remove(o[a].get_id())}return!s},e.RegrepNodeAndUpdateResults=function(e,t,n){var r=t.get_resultManager();e.clearHitRanges();var i=e.get_id(),s=r.getResultForNodeId(i);if(!s)return!1;var o=n.grepString(e.getFindableText(),t.get_findRegex()),a=n.mergedResultsFromHitRanges(i,o,null,s.get_type(),s.get_isAfterInitialPivot());return e.setHitRanges(o),r.replaceResultsForNode(i,a),!0},e.ClearDirtyResults=function(t,n){for(var r=e.GetUptoMaxNodesToProcess(t,e.MaxNodesToClear),i=0;i<r.length;++i){var s=r[i],o=s.get_id();s.clearHitRanges(),n.removeResultsForNode(o),t.remove(o)}},e.GetUptoMaxNodesToProcess=function(e,t){var n=new Array(0),r=t;return e.forEach((function(e,t){return Array.add(n,t),!!--r})),n},e.MaxNodesToRegrep=5,e.MaxNodesToClear=15,e.ProcessTimeout=500,e._instance=null,e}();(0,i.l)(w,"ebff9f70$FindResultAppEventCoordinator",null,[o]);var M,b=n(809);!function(e){e[e.unknown=0]="unknown",e[e.mainDocument=1]="mainDocument",e[e.header=2]="header",e[e.footer=4]="footer",e[e.footnote=8]="footnote",e[e.endnote=16]="endnote",e[e.comment=32]="comment"}(M||(M={})),(0,i.h)("896976b7$FindResultType",M);var D=n(3324),P=function(){function e(e,t){this._resultTypeToFirstFindResult=null,this._resultTypeToLastFindResult=null,this._nodeIdToFindResult=null,this._resultTypeToCount=null,this._resultIdToResult=null,this._dirtyNodeIdToFindResult=null,this._activeIndex=0,this._totalResults=0,this._activeResult=null,this._startRecheckResult=null,this._currentRecheckResult=null,this._findUIManager=null,this._findResultTypes=null,this.$$pf_TotalIncludingDirtyResults=0,this.$$pf_LastReplacedNodeIds=null,this.lastAddedResultFromStart=null,this._findUIManager=e,this._findResultTypes=t,this._resultTypeToFirstFindResult=new k.e(M,D.q),this._resultTypeToLastFindResult=new k.e(M,D.q),this._nodeIdToFindResult=new k.e(C.h,D.q),this._dirtyNodeIdToFindResult=new k.e(C.h,D.q),this._resultTypeToCount=new k.e(M,Number),this._resultIdToResult=new k.e(Number,D.q);for(var n=0;n<t.length;++n)this._resultTypeToCount.set_item(t[n],0);this.set_lastReplacedNodeIds(new Array(0))}return e.prototype.get_activeResult=function(){return this._activeResult},e.prototype.set_activeResult=function(e){this._activeResult=e;var t=new Array(1);return t[0]=this._activeResult,this._findUIManager.findResultChanged(3,t),e},e.prototype.get_startRecheckResult=function(){return this._startRecheckResult},e.prototype.set_startRecheckResult=function(e){return this._startRecheckResult=e,e},e.prototype.get_currentRecheckResult=function(){return this._currentRecheckResult},e.prototype.set_currentRecheckResult=function(e){return this._currentRecheckResult=e,e},e.prototype.get_firstResult=function(){for(var e=null,t=(this._findResultTypes[0],0),n=this._findResultTypes;t<n.length;t++){var r=n[t];if(e=this._resultTypeToFirstFindResult.get_item(r))break}return e},e.prototype.get_activeIndex=function(){return this._activeIndex},e.prototype.set_activeIndex=function(e){return e!==this._activeIndex&&(this._activeIndex=e),e},e.prototype.get_totalResults=function(){return this._totalResults},e.prototype.set_totalResults=function(e){return e!==this._totalResults&&(this._totalResults=e,this._findUIManager&&!this._totalResults&&(this._findUIManager.setActiveHitNumber(0),this._findUIManager.setTotalHitCount(0))),e},e.prototype.get_totalIncludingDirtyResults=function(){return this.$$pf_TotalIncludingDirtyResults},e.prototype.set_totalIncludingDirtyResults=function(e){return this.$$pf_TotalIncludingDirtyResults=e,e},e.prototype.get_lastReplacedNodeIds=function(){return this.$$pf_LastReplacedNodeIds},e.prototype.set_lastReplacedNodeIds=function(e){return this.$$pf_LastReplacedNodeIds=e,e},e.prototype.get_lastAddedResultFromStart=function(){return this.lastAddedResultFromStart},e.prototype.AddAfter=function(e,t){if(e&&!(e.length<=0)){var n=e[0].get_type(),r=t,i=r?r.get_next():this._resultTypeToFirstFindResult.get_item(n);r||this._resultTypeToFirstFindResult.set_item(n,e[0]);e[0].get_nodeId();for(var s=0,o=e;s<o.length;s++){var a=o[s];this._resultIdToResult.set_item(a.get_id(),a),a.get_id().toString()+",",r&&r.set_next(a),a.set_previous(r),r=a}r&&r.set_next(i),i&&i.set_previous(r),t&&e[0].get_nodeId().equals(t.get_nodeId())||this._nodeIdToFindResult.set_item(e[0].get_nodeId(),e[0]),!i&&r&&this._resultTypeToLastFindResult.set_item(r.get_type(),r),this.get_lastAddedResultFromStart()===t&&(this.lastAddedResultFromStart=r),this._resultTypeToCount.set_item(n,this._resultTypeToCount.get_item(n)+e.length),this.set_totalResults(this.get_totalResults()+e.length),this.set_totalIncludingDirtyResults(this.get_totalIncludingDirtyResults()+e.length),this._findUIManager&&this._findUIManager.findResultChanged(0,e)}},e.prototype.addToStart=function(e){this.AddAfter(e,null)},e.prototype.addToEnd=function(e){!e||e.length<=0||this.AddAfter(e,this._resultTypeToLastFindResult.get_item(e[0].get_type()))},e.prototype.addAfterLastAddedFromStart=function(e){!e||e.length<=0||(this.get_lastAddedResultFromStart()&&this.get_lastAddedResultFromStart().get_type()!==e[0].get_type()&&(this.lastAddedResultFromStart=null),this.AddAfter(e,this.get_lastAddedResultFromStart()))},e.prototype.removeResult=function(e){this.RemoveResultRange(e,e)},e.prototype.removeResultsForNode=function(t){var n=this.getResultForNodeId(t);if(!n)return g.ULS.sendTraceTag(4069027,313,15,"RemoveResultsForNode called for node not in cache: {0}",t.toString()),e.InvalidIndex;for(var r=e.InvalidIndex,i=n,s=0;i&&(this.get_activeResult()&&this.get_activeResult().get_id()===i.get_id()&&(r=s),++s,i.get_next()&&i.get_nodeId().equals(i.get_next().get_nodeId()));)i=i.get_next();return this.RemoveResultRange(n,i),r},e.prototype.RemoveResultRange=function(e,t){for(var n=e,r=t,i=0,s=0,o=[],a=n;a!==r.get_next();){var l=this.IsResultDirty(a);this._nodeIdToFindResult.get_item(a.get_nodeId()).get_id()===a.get_id()&&(a.get_next()&&a.get_next().get_nodeId().equals(a.get_nodeId())?(this._nodeIdToFindResult.set_item(a.get_nodeId(),a.get_next()),l&&this._dirtyNodeIdToFindResult.set_item(a.get_nodeId(),a.get_next())):(this._nodeIdToFindResult.remove(a.get_nodeId()),l&&this._dirtyNodeIdToFindResult.remove(a.get_nodeId()))),this.get_lastAddedResultFromStart()&&this.get_lastAddedResultFromStart().get_id()===a.get_id()&&(this.lastAddedResultFromStart=n.get_previous()),this.get_startRecheckResult()&&this.get_startRecheckResult().get_id()===a.get_id()&&this.set_startRecheckResult(this.GetNextResultNotMatching(a,n)),this.get_currentRecheckResult()&&this.get_currentRecheckResult().get_id()===a.get_id()&&this.set_currentRecheckResult(this.GetNextResultNotMatching(a,n)),this.get_activeResult()&&this.get_activeResult().get_id()===a.get_id()&&this.set_activeResult(this.GetNextResultNotMatching(a,n)),this._resultIdToResult.remove(a.get_id()),Array.add(o,a),a=a.get_next(),l?++s:++i}n.get_previous()?n.get_previous().set_next(r.get_next()):r.get_next()?this._resultTypeToFirstFindResult.set_item(r.get_type(),r.get_next()):this._resultTypeToFirstFindResult.remove(r.get_type()),r.get_next()?r.get_next().set_previous(n.get_previous()):n.get_previous()?this._resultTypeToLastFindResult.set_item(n.get_type(),n.get_previous()):this._resultTypeToLastFindResult.remove(n.get_type()),r.set_next(null),n.set_previous(null),this._resultTypeToCount.set_item(n.get_type(),this._resultTypeToCount.get_item(n.get_type())-i),this.set_totalResults(this.get_totalResults()-i),this.set_totalIncludingDirtyResults(this.get_totalIncludingDirtyResults()-(i+s)),this._findUIManager&&this._findUIManager.findResultChanged(1,o)},e.prototype.replaceResultsForNode=function(e,t){var n=this.getResultForNodeId(e);if(n){var r=new Array(0),i=new Array(0),s=new Array(0),o=n,a=null,l=0;do{l<t.length?(o.CopyFrom(t[l]),Array.add(r,o)):(Array.add(i,o),this.get_startRecheckResult()&&this.get_startRecheckResult().get_id()===o.get_id()&&r.length>0&&this.set_startRecheckResult(r[r.length-1])),++l,a=o,o=o.get_next()}while(o&&a.get_nodeId().equals(o.get_nodeId()));for(;l<t.length;++l)Array.add(s,t[l]);i.length>0&&this.RemoveResultRange(i[0],i[i.length-1]),s.length>0&&this.AddAfter(s,r.length>0?r[r.length-1]:n);var u=r.length;if(u>0){if(this._dirtyNodeIdToFindResult.containsKey(e)){this._dirtyNodeIdToFindResult.remove(e),this.set_totalResults(this.get_totalResults()+u);var d,c=void 0;(c=this._resultTypeToCount).set_item(d=r[0].get_type(),c.get_item(d)+u)}this._findUIManager&&this._findUIManager.findResultChanged(4,r)}}else g.ULS.sendTraceTag(4069056,313,15,"ReplaceResultsForNode: NodeId not found in cache nodeId={0}",e.toString())},e.prototype.clearResults=function(){this._nodeIdToFindResult=new k.e(C.h,D.q),this._dirtyNodeIdToFindResult=new k.e(C.h,D.q),this._resultTypeToFirstFindResult=new k.e(M,D.q),this._resultTypeToLastFindResult=new k.e(M,D.q),this._resultIdToResult=new k.e(Number,D.q);for(var e=0;e<this._findResultTypes.length;++e)this._resultTypeToCount.set_item(this._findResultTypes[e],0);this.set_activeResult(null),this.set_activeIndex(0),this.lastAddedResultFromStart=null,this.set_startRecheckResult(null),this.set_currentRecheckResult(null),this.set_totalResults(0),this.set_totalIncludingDirtyResults(0),this._findUIManager&&this._findUIManager.findResultChanged(2,null)},e.prototype.markAllResultsDirty=function(){var e=this;this._dirtyNodeIdToFindResult=new k.e(C.h,D.q),this._nodeIdToFindResult.forEach((function(t,n){return e._dirtyNodeIdToFindResult.set_item(t,n),!0}));for(var t=0;t<this._findResultTypes.length;++t)this._resultTypeToCount.set_item(this._findResultTypes[t],0);this.set_activeResult(null),this.set_activeIndex(0),this.lastAddedResultFromStart=null,this.set_totalResults(0),this._findUIManager&&this._findUIManager.findResultChanged(2,null)},e.prototype.getResultForNodeId=function(e){return this._nodeIdToFindResult.containsKey(e)?this._nodeIdToFindResult.get_item(e):null},e.prototype.getResult=function(e){var t=null;return this._resultIdToResult.containsKey(e)&&(t=this._resultIdToResult.get_item(e)),t},e.prototype.getFirstResultForType=function(e){return this._resultTypeToFirstFindResult.containsKey(e)?this._resultTypeToFirstFindResult.get_item(e):null},e.prototype.GetLastResultForType=function(e){return this._resultTypeToLastFindResult.containsKey(e)?this._resultTypeToLastFindResult.get_item(e):null},e.prototype.onAfterNodeIdChanged=function(e,t){var n=this.getResultForNodeId(t);if(n){for(var r=n;r&&r.get_nodeId().equals(t);)r.set_nodeId(e.get_id()),r=r.get_next();this._nodeIdToFindResult.set_item(e.get_id(),n),this._nodeIdToFindResult.remove(t),this._dirtyNodeIdToFindResult.containsKey(e.get_id())&&(this._dirtyNodeIdToFindResult.set_item(e.get_id(),n),this._dirtyNodeIdToFindResult.remove(t));for(var i=0;i<this.get_lastReplacedNodeIds().length;++i)if(this.get_lastReplacedNodeIds()[i].equals(t)){this.get_lastReplacedNodeIds()[i]=e.get_id();break}}},e.prototype.updateActiveIndexFromActiveResult=function(){var e=0;if(this.get_activeResult()){var t=0,n=this.get_activeResult().get_type(),r=this._resultTypeToFirstFindResult.get_item(n);if(r){for(var i=1;r&&this.get_activeResult().get_id()!==r.get_id();)this.IsResultDirty(r)||++i,r=r.get_next();r&&(t=i)}if(r){for(var s=0,o=0;o<this._findResultTypes.length&&this._findResultTypes[o]!==n;++o)s+=this._resultTypeToCount.get_item(this._findResultTypes[o]);e=s+t}else g.ULS.sendTraceTag(4069057,313,10,"UpdateActiveIndexFromActiveResult, active result not found in cache, setting it to null"),this.set_activeResult(null),e=0}this.set_activeIndex(e),this._findUIManager&&(this._findUIManager.setActiveHitNumber(this.get_activeIndex()),this._findUIManager.setTotalHitCount(this.get_totalResults()))},e.prototype.getNextResult=function(e){return this.GetNextOrPreviousResult(e,!1)},e.prototype.getPreviousResult=function(e){return this.GetNextOrPreviousResult(e,!0)},e.prototype.GetNextOrPreviousResult=function(e,t){for(var n=t?e.get_previous():e.get_next(),r=e.get_type();!n&&(r=this.GetNextOrPreviousResultType(r,t),n=t?this.GetLastResultForType(r):this.getFirstResultForType(r),r!==e.get_type()););return n||e},e.prototype.getFirstResultOfNextNode=function(e){return this.GetClosestResultOfNextOrPreviousNode(e,!1)},e.prototype.getLastResultOfPreviousNode=function(e){return this.GetClosestResultOfNextOrPreviousNode(e,!0)},e.prototype.GetClosestResultOfNextOrPreviousNode=function(e,t){for(var n=this.GetNextOrPreviousResult(e,t);n.get_nodeId().equals(e.get_nodeId())&&n.get_id()!==e.get_id();)n=this.GetNextOrPreviousResult(n,t);return n},e.prototype.GetNextResultType=function(e){return this.GetNextOrPreviousResultType(e,!1)},e.prototype.GetPreviousResultType=function(e){return this.GetNextOrPreviousResultType(e,!0)},e.prototype.GetNextOrPreviousResultType=function(e,t){for(var n=0,r=0;r<this._findResultTypes.length;++r)if(e===this._findResultTypes[r]){n=r;break}return t?--n<0&&(n=this._findResultTypes.length-1):++n===this._findResultTypes.length&&(n=0),this._findResultTypes[n]},e.prototype.resetLastAddedFromStart=function(){this.lastAddedResultFromStart=null},e.prototype.GetNextResultNotMatching=function(e,t){var n=this.getNextResult(e);return n.get_id()===t.get_id()&&(n=null),n},e.prototype.IsResultDirty=function(e){return this._dirtyNodeIdToFindResult.containsKey(e.get_nodeId())},e.CreateInstance=function(t,n,r){return void 0===r&&(r=!1),r?new e(t,n):e._instance||(e._instance=new e(t,n))},e.InvalidIndex=-1,e._instance=null,e}();(0,i.l)(P,"51688314$FindResultManager",null,[b.m]);var O=function(){function e(e,t){this._resultManager=null,this._findHelper=null,this.goToFindResult=null,this._resultManager=e,this._findHelper=t,this.set_goToFindResult(i.i(this,this.GoToResultInternal,"GoToResultInternal"))}return e.prototype.set_goToFindResult=function(e){return this.goToFindResult=e,e},e.prototype.goToNextResult=function(){var e=this._resultManager.get_activeResult()?this._resultManager.getNextResult(this._resultManager.get_activeResult()):this._resultManager.get_firstResult();this.goToFindResult(e)},e.prototype.goToPreviousResult=function(){var e=this._resultManager.get_activeResult()?this._resultManager.getPreviousResult(this._resultManager.get_activeResult()):this._resultManager.get_firstResult();this.goToFindResult(e)},e.prototype.goToResult=function(e){var t=this._resultManager.getResult(e);t?this.goToFindResult(t):g.ULS.sendTraceTag(4069058,313,10,"{0}",{GoToResult:"Invalid FindResult",ResultId:e})},e.prototype.GoToResultInternal=function(e){var t=this._findHelper.get_objectSpace().getObject(e.get_nodeId());if(t){if(this._resultManager.get_activeResult()){var r=this._findHelper.get_objectSpace().getObject(this._resultManager.get_activeResult().get_nodeId()),i=(0,c.e)(d.d,r);i?i.clearActiveHit():g.ULS.sendTraceTag(4069060,313,15,"{0}",{GoToResultInternal:"ActiveHitNodeNotFound",NodeId:this._resultManager.get_activeResult().get_nodeId()})}if(t.makeHitActive(e.get_hitIndex(),e.get_type()))this._resultManager.set_activeResult(e),g.ULS.sendTraceTag(4065305,313,50,"{0}",{GoToResultInternal:"Success",ResultId:e.get_id()});else n(1141).FindManager.get_instance().hasStaleResultsPendingProcessing()?g.ULS.sendTraceTag(4575581,313,15,"{0}",{GoToResultInternal:"Failure",NodeId:t.get_id(),HitIndexInNode:e.get_hitIndex(),ResultId:e.get_id()}):g.ULS.sendTraceTag(4069061,313,10,"{0}",{GoToResultInternal:"Failure",NodeId:t.get_id(),HitIndexInNode:e.get_hitIndex(),ResultId:e.get_id()});this._resultManager.updateActiveIndexFromActiveResult()}else g.ULS.sendTraceTag(4069059,313,10,"{0}",{GoToResultInternal:"Invalid findResult.NodeId",NodeId:e.get_nodeId()})},e.CreateInstanceWithResolvedDependencies=function(t){return new e(t,F.FindManagerHelper.get_Instance())},e.CreateInstance=function(t){return e._instance||(e._instance=e.CreateInstanceWithResolvedDependencies(t))},e._instance=null,e}();(0,i.l)(O,"bb85cf38$FindResultNavigator",null,[u]);var E=n(2411),U=n(4768),H=n(3672),L=function(){function e(){}return e.prototype.preprocessQuery=function(e){return U.l.encodeString(e,H.m.regexEscapeCharacters)},e.prototype.parseQuery=function(e){var t=H.m.parseQuery(e);return t=H.m.replaceSpacesWithRegexForOneOrMoreSpaces(t)},e.prototype.preprocessQueryWithQueryFilters=function(e){return null},e.prototype.isValidWildCardStatement=function(e){return!1},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();(0,i.l)(L,"8d635757$QueryProcessor",null,[E.a]);var $=n(6928),G=n(9994),z=n(1390),W=n(2228),j=function(){return function(){this.transaction=null,this.replaceString=null,this.replaceCount=0,this.totalCount=0,this.currentResult=null,this.replaceComplete=null}}();(0,i.l)(j,"9f0c3f59$ReplaceAllContext",null,[]);var q=n(5776),B=n(6398),Q=n(2163),V=n(8945),K=n(813),J=n(5966),X=n(6988),Y=n(1596),Z=n(706),ee=function(){function e(t,n,r,s,o,a,l,u,d,c,p,h){this._findManager=null,this._resultManager=null,this._findHelper=null,this._graphTransactionFactory=null,this._lazySelectionReader=null,this._lazySelectionManager=null,this._isContextSetInLockedRangeDelegate=null,this._acquireAndApplyLockDelegate=null,this._replaceTextRangeWithNewText=null,this._lazyAppSettingForLockedRangesGetter=null,this._lazyAppSettingForIsCoauthorableGetter=null,this._stopwatchBuilder=null,this.startReplaceAll=null,this.processReplaceAll=null,this.completeReplaceAll=null,this.executeReplaceAllOperation=null,this.removeLastReplacedFindHits=null,this.replaceText=null,this.capitalizeReplaceText=null,this.getNextResultAfterReplace=null,this.$$pf_ReplaceInProgress=!1,this._findManager=t,this._resultManager=n,this._findHelper=r,this._graphTransactionFactory=s,this._lazySelectionReader=o,this._lazySelectionManager=a,this._isContextSetInLockedRangeDelegate=l,this._acquireAndApplyLockDelegate=u,this._replaceTextRangeWithNewText=d,this._lazyAppSettingForLockedRangesGetter=c,this._lazyAppSettingForIsCoauthorableGetter=p,this._stopwatchBuilder=h,this.set_replaceInProgress(!1),this.set_startReplaceAll(i.i(this,this.OnStartReplaceAll,"OnStartReplaceAll")),this.set_processReplaceAll(i.i(this,this.OnProcessReplaceAll,"OnProcessReplaceAll")),this.set_completeReplaceAll(i.i(this,this.OnCompleteReplaceAll,"OnCompleteReplaceAll")),this.set_executeReplaceAllOperation(i.i(this,this.OnExecuteReplaceAllOperation,"OnExecuteReplaceAllOperation")),this.set_removeLastReplacedFindHits(i.i(this,this.clearLastReplacedFindHits,"clearLastReplacedFindHits")),this.set_replaceText(i.i(this,this.OnReplaceText,"OnReplaceText")),this.set_capitalizeReplaceText(e.OnCapitalizeReplaceText),this.set_getNextResultAfterReplace(i.i(this,this.OnGetNextResultAfterReplace,"OnGetNextResultAfterReplace"))}return e.prototype.set_startReplaceAll=function(e){return this.startReplaceAll=e,e},e.prototype.set_processReplaceAll=function(e){return this.processReplaceAll=e,e},e.prototype.set_completeReplaceAll=function(e){return this.completeReplaceAll=e,e},e.prototype.set_executeReplaceAllOperation=function(e){return this.executeReplaceAllOperation=e,e},e.prototype.set_removeLastReplacedFindHits=function(e){return this.removeLastReplacedFindHits=e,e},e.prototype.set_replaceText=function(e){return this.replaceText=e,e},e.prototype.set_capitalizeReplaceText=function(e){return this.capitalizeReplaceText=e,e},e.prototype.set_getNextResultAfterReplace=function(e){return this.getNextResultAfterReplace=e,e},e.prototype.get_SelectionReader=function(){return this._lazySelectionReader.get_value()},e.prototype.get_replaceInProgress=function(){return this.$$pf_ReplaceInProgress},e.prototype.set_replaceInProgress=function(e){return this.$$pf_ReplaceInProgress=e,e},e.prototype.replace=function(e){var t=!1;if(this.get_replaceInProgress())return g.ULS.sendTraceTag(4069062,313,15,"Replace: Cancelled as replace is already in progress"),t;if(this.get_SelectionReader().get_currentSelectionContainsSingleContext()){var n=this.get_SelectionReader().get_firstContextForCurrentSelection(),r=n.get_node();n.get_contextId()===X.d.paragraph&&(n=J.y.createTextRange(r,0,V.ParagraphReader.textLength(r)));var i=(0,c.e)(d.d,r);if(i){var s=new Z.b(n.get_cpBegin(),n.get_cpEnd()),o=i.getIndexOfReplaceableHitAtRange(s);if(o!==Y.l.invalid&&o>=0){if(this.CheckAndApplyLockOnContext(n))return g.ULS.sendTraceTag(5007250,313,50,"Replace: Cancelled as Paragraph is locked"),t;this.set_replaceInProgress(!0);var a=this._graphTransactionFactory.getTransaction(15);a.setFromNode(r),this.replaceText(this._findManager.get_findQuery(),i,e,n),a.dispose(),this.removeLastReplacedFindHits(),i.setReplaced(o,e.length),e.length>0&&Array.add(this._resultManager.get_lastReplacedNodeIds(),r.get_id());var l=this._resultManager.getResultForNodeId(r.get_id()),u=this._resultManager.getNextResult(l),p=i.getHitRanges(),h=this._findHelper.mergedResultsFromHitRanges(r.get_id(),p,null,l.get_type(),l.get_isAfterInitialPivot());this._resultManager.replaceResultsForNode(r.get_id(),h),(u=this.getNextResultAfterReplace(h.length,o,l,u,r))?this._findManager.get_resultNavigator().goToResult(u.get_id()):this._resultManager.updateActiveIndexFromActiveResult(),t=!0,this.set_replaceInProgress(!1)}else g.ULS.sendTraceTag(5007251,313,50,"Replace: Cancelled as current selection not on a find hit.")}else g.ULS.sendTraceTag(4069063,313,15,"Replace: Failed as No node found corresponding to current selection")}else g.ULS.sendTraceTag(5007252,313,50,"Replace: Cancelled as current selection does not contain single context");return t?(g.ULS.sendTraceTag(4065306,313,50,"ReplaceManager Replace Success"),this._findManager.set_replaceCompleted(!0)):(g.ULS.sendTraceTag(5007253,313,50,"ReplaceManager Replace Not Successful"),this._findManager.get_resultNavigator().goToNextResult()),t},e.prototype.OnGetNextResultAfterReplace=function(e,t,n,r,i){var s=null;if(e>t)for(s=n;t>0&&s.get_nodeId().equals(i.get_id());)s=this._resultManager.getNextResult(s),--t;else e>0?s=this._resultManager.getFirstResultOfNextNode(n):r.get_nodeId()!==i.get_id()&&(s=r);return s},e.prototype.clearLastReplacedFindHits=function(){var e=this._resultManager.get_lastReplacedNodeIds();if(e&&e.length>0){var t=this._graphTransactionFactory.getTransaction(3);t.setFromNode(this._findHelper.get_objectSpace().getObject(e[0]));for(var n=0;n<e.length;++n){var r=this._findHelper.get_objectSpace().getObject(e[n]);r?r.clearHitRanges(!1,!0):g.ULS.sendTraceTag(4069064,313,10,"Last replaced node not found in object Space, NodeId: {0}",e[n])}t.dispose(),Array.clear(this._resultManager.get_lastReplacedNodeIds())}},e.prototype.replaceAll=function(e,t){this.get_replaceInProgress()?g.ULS.sendTraceTag(4069065,313,15,"ReplaceAll: Called when Replace is already in Progress"):this._resultManager.get_totalResults()?this.startReplaceAll(e,t):g.ULS.sendTraceTag(4069066,313,15,"ReplaceAll: Called when total results is 0")},e.prototype.OnStartReplaceAll=function(e,t){this.set_replaceInProgress(!0),this.removeLastReplacedFindHits();var n=new j;n.replaceString=e||"",n.replaceComplete=t,n.totalCount=this._resultManager.get_totalResults();var r=this._graphTransactionFactory.getTransaction(15);r.setFromNode(this._findHelper.get_activePage()),n.transaction=r,this.executeReplaceAllOperation(n,r)},e.prototype.OnExecuteReplaceAllOperation=function(e,t){var n=new W.a(null,this.processReplaceAll,e),r=this._findHelper.get_activePage();r&&r.getGraphSpace().get_graphTransactionOperations().blockRttSend(9),n.setDebugName("ReplaceAll"),t.setAsyncOperation(n),n.run()},e.prototype.OnProcessReplaceAll=function(e,t){var n=this._stopwatchBuilder.makeAndStartStopwatch("UserAction","OnProcessReplaceAll"),r=t;if(this.IsReplaceAllComplete(r))return this.completeReplaceAll(r),!1;var i=r.currentResult;i||(i=this._resultManager.get_firstResult()),r.currentResult=this._resultManager.getFirstResultOfNextNode(i);var s=this._findHelper.get_objectSpace().getObject(i.get_nodeId());if(!s)return g.ULS.sendTraceTag(4065307,313,10,"ReplaceAll: Node for result with id: {0} and nodeId: {1}, Not Found!",i.get_id(),i.get_nodeId()),!0;var o=s.getHitRanges();if(o&&o.length)if(this.CheckAndApplyLockOnRange(s,o[0].begin,o[0].end))g.ULS.sendTraceTag(5007254,313,50,"ReplaceAll: Skipping node: {0} as Paragraph is locked",s.get_id());else{for(var a=0,l=0;l<o.length;++l){r.replaceCount=r.replaceCount+1;var u=this.replaceText(this._findManager.get_findQuery(),s,r.replaceString,J.y.createTextRange(s,o[l].begin+a,o[l].end+a));a+=r.replaceString.length-(o[l].end-o[l].begin)+u,s.setReplaced(0,r.replaceString.length)}r.replaceString.length>0&&Array.add(this._resultManager.get_lastReplacedNodeIds(),i.get_nodeId())}else g.ULS.sendTraceTag(4065308,313,15,"ReplaceAll: No hits found for result with id: {0} and nodeId: {1}!",i.get_id(),i.get_nodeId());return n.stop(),!0},e.prototype.OnCompleteReplaceAll=function(e){e.transaction.dispose(),this.set_replaceInProgress(!1),this._findManager.cancelAndClearFind(!1),e.replaceComplete&&e.replaceComplete(e.replaceCount,e.totalCount)},e.prototype.OnReplaceText=function(e,t,n,r){if(!e.get_matchCase()&&n.length>0){var i=t.getFindableText().substr(r.get_cpBegin(),r.get_cpEnd()-r.get_cpBegin());n=this.capitalizeReplaceText(n,i)}return this._replaceTextRangeWithNewText(r,n,!0,!1)},e.prototype.CheckAndApplyLockOnContext=function(e){var t=this._lazyAppSettingForLockedRangesGetter.get_value()&&this._isContextSetInLockedRangeDelegate(e);return!t&&this._acquireAndApplyLockDelegate.get_value()&&this._lazyAppSettingForIsCoauthorableGetter.get_value()&&this._acquireAndApplyLockDelegate.get_value()(e.get_node()),t},e.prototype.CheckAndApplyLockOnRange=function(e,t,n){return this.CheckAndApplyLockOnContext(J.y.createTextRange(e,t,n))},e.prototype.IsReplaceAllComplete=function(e){return e.currentResult===this._resultManager.get_firstResult()},e.get_CharacterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=z.w.get_instance().resolve(G.x))},e.CreateInstanceWithResolvedDependencies=function(t,n){var r=new h.q(Function,(function(){return v.App.get_theCoauthManager()&&v.App.get_theCoauthManager().get_theLockManager()?i.i(v.App.get_theCoauthManager().get_theLockManager(),v.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock,"acquireAndApplyLock"):null}));return new e(t,n,F.FindManagerHelper.get_Instance(),new x.b,new h.q($.r,(function(){return B.z.get_instance()})),new h.q(s.l,(function(){return q.SelectionManager.get_instance()})),i.i(Q.k.get_instance(),Q.k.get_instance().isContextSetInLockedRange,"isContextSetInLockedRange"),r,i.i(e.get_CharacterPropertiesEditor(),e.get_CharacterPropertiesEditor().replaceTextRange,"replaceTextRange"),new h.q(Boolean,(function(){return K.n.get_instance().get_item(14)})),new h.q(Boolean,(function(){return K.n.get_instance().get_item(50)&&v.App.get_theCoauthManager().get_isCoauthorable()})),v.App.get_activeAppFrame().get_theStopwatchBuilder())},e.CreateInstance=function(t,n){return e._instance||(e._instance=e.CreateInstanceWithResolvedDependencies(t,n))},e.OnCapitalizeReplaceText=function(e,t){var n=U.l.toUpper(t),r=U.l.toLower(t);if(!U.l.localeCompare(n,t)&&U.l.localeCompare(r,t))e=U.l.toUpper(e);else if(U.l.isUpperCase(t.charAt(0))&&!U.l.isLowerCase(t.charAt(0))){var i=U.l.toUpper(e.substr(0,1));e=1===e.length?i:i+e.substr(1,e.length-1)}return e},e._instance=null,e._characterPropertiesEditor=null,e}();(0,i.l)(ee,"48f964d4$ReplaceManager",null,[l.z]);var te=n(4852),ne=n(3066),re=n(1410),ie=n(9312),se=n(6031),oe=function(e){function t(){var t=this;return t.rootNodeType=0,t.findResultType=0,t=e.call(this,new se.m(33))||this}return(0,r.t)(t,e),t.prototype.initChildCoreChannel=function(e){return 0},t.prototype.OnBeforeChildDisconnectedFromCoreGraph=function(e){var t=new ne.GraphTransaction(3);t.setFromNode(this);var n=new ie.g;if(n.set(this),n.hasChildren()){var r=n.goToFirstChild();n.set(r);var i=re.w.moveIteratorToNextFindableNode(n,this.rootNodeType,this.findResultType),s=new ie.g;s.set(this),s.goToFirstChild(),s.disconnectNodeAndReturnToParent(),i&&n.get_currentNode()!==r&&s.addChild(n.get_currentNode(),-2)}t.dispose()},t}(te.k);(0,i.l)(oe,"3a92cb47$FindTrackingNode",te.k,[]);var ae=n(4499),le=n(3738);n.d(t,{FindManager:function(){return ue}});var ue=function(e){function t(t,n,r,i,s,o,a,l,u,d,c,p,h,g,_,f){void 0===f&&(f=!1);var y=this;return y._savedQuery=null,y._latestQueryTerms=null,y._findNodeContexts=null,y._walkFindInProgress=!1,y._currentNodeTracker=null,y._startNodeTracker=null,y._cpWithinStartNode=0,y._lastKnownContentObjectSpace=null,y._currentPivotNode=null,y._walker=null,y._errorRestartCount=0,y._shouldSetHitRanges=!0,y._lazySelectionManager=null,y._graphIteratorFactory=null,y._graphTransactionFactory=null,y._preOrderTraverserCreator=null,y._findResultAppEventCoordinator=null,y._supportUpdatingResultsOnAppEvents=!1,(y=e.call(this,t,n,r,s,o,h,g,c,p)||this)._supportUpdatingResultsOnAppEvents=i,y._lazySelectionManager=a,y._graphIteratorFactory=l,y._graphTransactionFactory=u,y._preOrderTraverserCreator=d,y._findResultAppEventCoordinator=_,y._latestQueryTerms=new Array(0),y._state=2,y._shouldSetHitRanges=!f,y._currentNodeTracker=new oe,y._findHelper.addRootNodeToGraph(y._currentNodeTracker),y._startNodeTracker=new oe,y._findHelper.addRootNodeToGraph(y._startNodeTracker),y._findHelper.get_activePage()&&(y._lastKnownContentObjectSpace=y._findHelper.get_objectSpace()),y.set_waitTimeAfterType(400),y.set_waitTimeBetweenCycles(100),y}return(0,r.t)(t,e),t.prototype.get_SelectionManager=function(){return this._lazySelectionManager.get_value()},t.prototype.get_findQuery=function(){return this._savedQuery},t.prototype.get_FindResultAppEventCoordinator=function(){return this._findResultAppEventCoordinator.get_value()},t.prototype.cancelAndClearFind=function(e){void 0===e&&(e=!0),this.get_replaceManager()&&this.get_replaceManager().get_replaceInProgress()||(this.cancelFind(e),this._findStatusManager.reset(),this._userQuery="",this._supportUpdatingResultsOnAppEvents&&this.get_FindResultAppEventCoordinator().stop(),this.ClearPendingTasks$1(),this.SetStartingAndCurrentNode(null))},t.prototype.ClearPendingTasks$1=function(){this._workTask&&(this.get_taskManager().deleteTask(this._workTask),this._workTask=null),this._findTask&&(this.get_taskManager().deleteTask(this._findTask),this._findTask=null)},t.prototype.cancelFind=function(e){if(void 0===e&&(e=!0),this._lastKnownContentObjectSpace,!this._lastKnownContentObjectSpace&&this.get_resultManager().get_totalIncludingDirtyResults()>0&&g.ULS.sendTraceTag(4235910,313,10,"{0}",{CancelFind:"LastKnowSpaceNull"}),this.get_resultManager().get_totalIncludingDirtyResults()>0&&this._lastKnownContentObjectSpace){var t=this.get_resultManager().get_firstResult(),n=t.get_nodeId();if(this._lastKnownContentObjectSpace.getObject(n)){var r=this._graphTransactionFactory.getTransaction(3);for(r.setFromNode(this._lastKnownContentObjectSpace.getObject(n));t;){var i=this._lastKnownContentObjectSpace.getObject(t.get_nodeId()),s=(0,c.e)(d.d,i);if(s){if(this._shouldSetHitRanges&&s.clearHitRanges(void 0,e),V.ParagraphReader.isParagraphNode(i)){var o=this._findHelper.getBlobObjectsInParagraph(i);if(o)for(var a=0;a<o.length;a++){var l=o[a];l.isFindable()&&this._shouldSetHitRanges&&l.clearHitRanges(void 0,e)}}i.invalidateViewElements(16,!0)}if(!(t=this.get_resultManager().getFirstResultOfNextNode(t))||t.get_nodeId().equals(n))break}r.dispose()}else g.ULS.sendTraceTag(4235911,313,10,"ClearFindHits: Error - node not in last known space");this.get_resultManager().clearResults()}e&&this.get_replaceManager()&&this.get_replaceManager().clearLastReplacedFindHits(),this.ResetPivot(),this._latestQueryTerms=new Array(0),this._savedQuery=null,this.set_findRegex(null),this._currentFindNodeContextIndex=0,this._walkFindInProgress=!1,this.set_replaceCompleted(!1)},t.prototype.restartFind=function(){var e=this._originalQuery;this.cancelFind(),e&&""!==e.get_text()&&this.find(e)},t.prototype.shouldAllowReplication=function(){return""===this._userQuery},t.prototype.onAfterNodeIdChanged=function(e,t){this.get_resultManager().onAfterNodeIdChanged(e,t)},t.prototype.hasStaleResultsPendingProcessing=function(){return this._supportUpdatingResultsOnAppEvents&&this.get_FindResultAppEventCoordinator().get_hasChangedOrDeletedNodesToProcess()},t.prototype.RestartFindAfterErrorCondition=function(){this._errorRestartCount<t.MaxErrorRestart?(this._errorRestartCount++,g.ULS.sendTraceTag(4069014,313,15,"{0}",{ErrorRestartCount:this._errorRestartCount}),this.find(this._originalQuery)):(g.ULS.sendTraceTag(4235912,313,10,"RestartFindAfterErrorCondition: max retries reached"),y.AFrameworkApplication.get_theActionManager().processAction(_.u.cancelFindAndSearch,2),this._errorRestartCount=0)},t.prototype.recheck=function(){var e=(new Date).getTime(),t=!1;this.get_resultManager().get_totalIncludingDirtyResults()||(t=!0);var n=0;if(!t){this.get_resultManager().get_startRecheckResult()||this.get_resultManager().set_startRecheckResult(this.get_resultManager().get_firstResult()),this.get_resultManager().get_currentRecheckResult()||(this.get_resultManager().set_currentRecheckResult(this.get_resultManager().get_startRecheckResult()),this.get_resultManager().set_activeResult(null));for(var r=null,s=!0;!t&&this.get_resultManager().get_currentRecheckResult()&&(new Date).getTime()-e<p.e.maxTimeSpentInSyncCall;){var o=this.get_resultManager().get_currentRecheckResult(),a=this._findHelper.get_objectSpace().getObject(o.get_nodeId());a?(s&&((r=this._graphTransactionFactory.getTransaction(3)).setFromNode(a),s=!1),o.get_isAfterInitialPivot()&&!this._currentPivotNode&&(this._currentPivotNode=a),this.get_resultManager().set_currentRecheckResult(this.get_resultManager().getFirstResultOfNextNode(this.get_resultManager().get_currentRecheckResult())),t=!this.get_resultManager().get_currentRecheckResult()||this.get_resultManager().get_currentRecheckResult().get_nodeId().equals(this.get_resultManager().get_startRecheckResult().get_nodeId()),this.grepAndMarkNode(a,o.get_type(),this._shouldSetHitRanges),++n):this.get_resultManager().removeResultsForNode(o.get_nodeId())}r&&r.dispose()}this.get_resultManager().updateActiveIndexFromActiveResult(),t&&(this.get_resultManager().set_currentRecheckResult(null),this._walkFindInProgress?this._state=0:(this._state=2,this.set_findCompleted(!0))),this._workTask=new R.c(2,1,this.get_waitTimeBetweenCycles(),i.i(this,this.findInternal,"findInternal"),52),this.get_taskManager().addTask(this._workTask);var l=(new Date).getTime()-e;g.ULS.sendTraceTag(4065247,313,50,"{0}",{RecheckTime:l,Count:n,Total:this.get_resultManager().get_totalResults(),TotalWithDirty:this.get_resultManager().get_totalIncludingDirtyResults()})},t.prototype.PrepareForRestart=function(){if(this.cancelFind(),this._currentFindNodeContextIndex=0,this._findHelper.get_isContentViewAPageView()){var e=this.get_SelectionManager();if(e){var t=e.get_selectionCollection().get_currentSelection();if(t){var n=v.App.get_activeAppFrame().workspace.get_contentView(),r=n?n.get_autoScroller():null;r&&r.supressAutoScroll();var i=ae.SelectionEditor.collapseToIp(t,!1,!1);e.setSelection(i),r&&r.allowAutoScroll()}}}var s=this.DetermineStartingNodeBasedOnIp(7,0);this._findNodeContexts=this._findContextHelper.getFindContexts(s)},t.prototype.SetStartingAndCurrentNodeFromCurrentNodeContext=function(){var e=this._findNodeContexts[this._currentFindNodeContextIndex];this.SetStartingAndCurrentNode(e.get_startNode())},t.prototype.SetStartingAndCurrentNode=function(e){this.SetStartingNode(e),this.SetCurrentNode(e)},t.prototype.ClearFind=function(){},t.prototype.ResetPivot=function(){this._currentPivotNode=null,this._isAfterPivotNode=!1},t.prototype.GetNextFindableNode=function(e,t,n){var r=this._graphIteratorFactory.getGraphIterator();if(r.set(e),!r.tryToRootAtAncestorOfType(t))return r.reset(),null;if(this._findHelper.moveToNextFindableNode(r,t,n)){var i=r.get_currentNode();return r.reset(),i}return g.ULS.sendTraceTag(4235914,313,10,"GetNextFindableNode: No findable nodes"),r.reset(),null},t.prototype.DetermineStartingNodeBasedOnIp=function(e,t){if(this._findHelper.get_isContentViewAPageView()){var n=this.get_SelectionManager(),r=n?n.get_selectionCollection().get_currentSelection():null;if(r){if(r.get_lastContext().get_isGraphNodeContext()){var s=r.get_lastContext();if(ae.SelectionEditor.isInsertionPointOrTextRangeContext(s)){var o=s.get_node();return i.r(d.d,o)?(this._cpWithinStartNode=s.get_cpEnd(),o):(this._cpWithinStartNode=0,this.GetNextFindableNode(o,e,t))}return i.r(d.d,s.get_node())?(this._cpWithinStartNode=0,s.get_node()):(this._cpWithinStartNode=0,this.GetNextFindableNode(s.get_node(),e,t))}return this._cpWithinStartNode=0,this.GetNextFindableNode(this._findHelper.get_activePage(),e,t)}var a=this._graphIteratorFactory.getGraphIterator();if(a.set(this._findHelper.get_activePage()),this._findHelper.tryMoveToLeadingFindableContent(a,8,1)){g.ULS.sendTraceTag(4069018,313,50,"No Selection: No selection, choosing title or first findable");var l=a.get_currentNode();return a.reset(),l}g.ULS.sendTraceTag(4235915,313,10,"TryMoveToPageLeadingContent failed")}return g.ULS.sendTraceTag(4235916,313,10,"Error: ContentView isn't PageView"),null},t.prototype.GetStartingNode=function(){var e=this._graphIteratorFactory.getGraphIterator();return e.set(this._startNodeTracker),1===e.getChildCount()?(e.goToFirstChild(),e.get_currentNode()):(g.ULS.sendTraceTag(4069019,313,15,"Something went wrong in GetStartingNode..."),null)},t.prototype.SetStartingNode=function(e){var t=this._graphTransactionFactory.getTransaction(3);t.setFromNode(this._startNodeTracker);var n=this._graphIteratorFactory.getGraphIterator();if(n.set(this._startNodeTracker),n.hasChildren()&&(n.goToFirstChild(),n.disconnectNodeAndReturnToParent()),e){n.addChild(e,51);var r=this._findNodeContexts[this._currentFindNodeContextIndex];this._startNodeTracker.rootNodeType=r.get_rootNode().get_type(),this._startNodeTracker.findResultType=r.get_findType()}t.dispose()},t.prototype.GetCurrentNode=function(){if(this._currentNodeTracker){var e=this._graphIteratorFactory.getGraphIterator();if(e.set(this._currentNodeTracker),e.getChildCount())return e.goToFirstChild(),e.get_currentNode();var t=this._preOrderTraverserCreator(this._findHelper.get_activePage());if(t.moveNext(),t.get_currentNode())return t.get_currentNode()}return g.ULS.sendTraceTag(4069020,313,15,"Something went wrong in GetCurrentNode..."),null},t.prototype.SetCurrentNode=function(e){var t=this._graphTransactionFactory.getTransaction(3);t.setFromNode(this._currentNodeTracker);var n=this._graphIteratorFactory.getGraphIterator();if(n.set(this._currentNodeTracker),n.hasChildren()&&(n.goToFirstChild(),n.disconnectNodeAndReturnToParent()),e){n.addChild(e,51);var r=this._findNodeContexts[this._currentFindNodeContextIndex];this._currentNodeTracker.rootNodeType=r.get_rootNode().get_type(),this._currentNodeTracker.findResultType=r.get_findType()}t.dispose()},t.prototype.goToNextHit=function(){var e=this.get_resultManager().get_activeResult()||this.get_resultManager().get_firstResult();if(e){var t=!1,n=!0;for(e.get_nodeId();e;){var r=this._findHelper.get_objectSpace().getObject(e.get_nodeId()),i=(0,c.e)(d.d,r);if(i){if(t=i.makeNextHitActive(e.get_type())){n&&(e=this.get_resultManager().getNextResult(e));break}e=this.get_resultManager().getNextResult(e)}else{var s=e;if(e=this.get_resultManager().getFirstResultOfNextNode(e),this.get_resultManager().removeResultsForNode(s.get_nodeId()),!e||s.get_nodeId().equals(e.get_nodeId()))break}n=!1}t?(this.get_resultManager().set_activeResult(e),this.get_resultManager().updateActiveIndexFromActiveResult(),g.ULS.sendTraceTag(4065248,313,50,"FindManager GoToNextHit Success")):g.ULS.sendTraceTag(4069022,313,15,"Failed to go to Next Hit")}},t.prototype.goToPreviousHit=function(){var e=this.get_resultManager().get_activeResult()||this.get_resultManager().get_firstResult();if(e){var t=!1,n=!0;for(e.get_nodeId();e;){var r=this._findHelper.get_objectSpace().getObject(e.get_nodeId()),i=(0,c.e)(d.d,r);if(i){if(t=i.makePreviousHitActive(e.get_type())){n&&(e=this.get_resultManager().getPreviousResult(e));break}e=this.get_resultManager().getPreviousResult(e)}else{var s=e;if(e=this.get_resultManager().getLastResultOfPreviousNode(e),this.get_resultManager().removeResultsForNode(s.get_nodeId()),!e||s.get_nodeId().equals(e.get_nodeId()))break}n=!1}t?(this.get_resultManager().set_activeResult(e),g.ULS.sendTraceTag(4065249,313,50,"FindManager GoToPreviousHit Success")):g.ULS.sendTraceTag(4069024,313,15,"Failed to go to Previous Hit"),this.get_resultManager().updateActiveIndexFromActiveResult()}},t.prototype.CanSkipQueryModifiedAndRecheckPossible=function(){return 2===this._state&&(this.get_replaceCompleted()||this._supportUpdatingResultsOnAppEvents&&this.get_FindResultAppEventCoordinator().get_resultsOutOfSyncWithDocument())},t.prototype.onBeforeFind=function(){this._findHelper.get_isPageContentViewInitialized()?(this._userQuery=this._queryProcessor.preprocessQuery(this._originalQuery.get_text()),this._lastKnownContentObjectSpace=this._findHelper.get_objectSpace(),this.ResetPivot()):this.RestartFindAfterErrorCondition()},t.prototype.startAppEventCoordinator=function(){this._supportUpdatingResultsOnAppEvents&&this.get_FindResultAppEventCoordinator().start()},t.prototype.cancelFindUnderConditions=function(){return this._findHelper.get_isPageContentViewInitialized()&&this._lastKnownContentObjectSpace===this._findHelper.get_objectSpace()?(this._errorRestartCount=0,!1):(this.cancelFind(),this.RestartFindAfterErrorCondition(),!0)},t.prototype.restartFindIfQueryRecheckable=function(){var e=this._queryProcessor.parseQuery(this._userQuery),t=this.CanSkipQueryModifiedAndRecheckPossible(),n=!1;if(t||this._findHelper.isQueryModified(this._savedQuery,this._latestQueryTerms,this._originalQuery,e)){n=!0,this.set_findCompleted(!1),this._findStatusManager.update(),this._findStatusManager.findStarted(),!t&&this._findHelper.isRecheckPossible(this._savedQuery,this._latestQueryTerms,this._originalQuery,e)?(this.get_resultManager().markAllResultsDirty(),this.get_resultManager().set_currentRecheckResult(null),this._state=1):(this.PrepareForRestart(),this.SetStartingAndCurrentNodeFromCurrentNodeContext(),this._state=0,this._walkFindInProgress=!0),this._savedQuery=this._originalQuery,this._latestQueryTerms=e;try{this.set_findRegex(this._findUtils.getRegex(this._latestQueryTerms.join("|"),this._originalQuery))}catch(e){return g.ULS.sendTraceTag(0,313,10,"FindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",this._originalQuery.get_matchCase(),this._originalQuery.get_matchWholeWord()),this.set_findRegex(null),this._state=2,this.set_findCompleted(!0),n=!0}this._workTask=new R.c(2,1,this.get_waitTimeBetweenCycles(),i.i(this,this.findInternal,"findInternal"),52),this.get_taskManager().addTask(this._workTask)}return n},t.prototype.onBeforeWalkOverNodes=function(){if(!this._currentPivotNode){var e=this._graphIteratorFactory.getGraphIterator();if(e.set(1===this._findNodeContexts[this._currentFindNodeContextIndex].get_findType()?this._findHelper.get_activePage():this._findNodeContexts[this._currentFindNodeContextIndex].get_rootNode()),!this._findHelper.tryMoveToLeadingFindableContent(e,this._findNodeContexts[this._currentFindNodeContextIndex].get_rootNode().get_type(),this._findNodeContexts[this._currentFindNodeContextIndex].get_findType()))return g.ULS.sendTraceTag(17306254,313,10,"TryToMoveToPageLeadingParagraph failed."),e.reset(),this._workTask=new R.c(2,1,this.get_waitTimeBetweenCycles(),i.i(this,this.findInternal,"findInternal"),52),void this.get_taskManager().addTask(this._workTask);this._currentPivotNode=e.get_currentNode(),e.reset()}},t.prototype.onAfterWalkOverNodes=function(){this.get_resultManager().updateActiveIndexFromActiveResult(),this.SetCurrentNode(this._walker.get_currentNode()),this._walker.get_currentNode()===this.GetStartingNode()&&(this._currentFindNodeContextIndex++,this._currentFindNodeContextIndex===this._findNodeContexts.length?(this._currentFindNodeContextIndex=0,this._state=2,this._walkFindInProgress=!1,this.set_findCompleted(!0)):this.SetStartingAndCurrentNodeFromCurrentNodeContext()),this._walker=null},t.prototype.getStartingNodeForWalkOver=function(){return this.GetStartingNode()},t.prototype.prepareSourceForWalkOverNodes=function(){var e=this.GetCurrentNode();this._walker=this._graphIteratorFactory.getGraphIterator(),this._walker.set(e),this._walker.tryToRootAtAncestor(this._findNodeContexts[this._currentFindNodeContextIndex].get_rootNode())},t.prototype.setTransaction=function(){var e=this._graphTransactionFactory.getTransaction(3);return e.setFromNode(this._walker.get_currentNode()),e},t.prototype.onWalkOverNodes=function(){this.grepAndMarkNode(this._walker.get_currentNode(),this._findNodeContexts[this._currentFindNodeContextIndex].get_findType(),this._shouldSetHitRanges),this._findHelper.moveToNextFindableNode(this._walker,this._findNodeContexts[this._currentFindNodeContextIndex].get_rootNode().get_type(),this._findNodeContexts[this._currentFindNodeContextIndex].get_findType())},t.prototype.conditionToProceedWalk=function(e){return!!this._walker.get_currentNode()&&!this._walker.get_currentNode().get_id().equals(e.get_id())},t.prototype.checkCurrentNodeForGrep=function(e){!this._isAfterPivotNode&&this._currentPivotNode&&e.get_id()===this._currentPivotNode.get_id()&&this.GetStartingNode().get_id()!==this._currentPivotNode.get_id()&&this.get_resultManager().get_totalIncludingDirtyResults()>0&&(this._isAfterPivotNode=!0,this.get_resultManager().resetLastAddedFromStart())},t.prototype.addResultsForNodeToResultManager=function(e,t,n,r){var i=this.get_resultManager().getResultForNodeId(e);i?this.get_resultManager().replaceResultsForNode(e,t):this._isAfterPivotNode?this.get_resultManager().addAfterLastAddedFromStart(t):this.get_resultManager().addToEnd(t),1===v.App.get_mode()&&y.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteNotebookSearchIsEnabled")||this._shouldSetHitRanges&&!this.get_resultManager().get_activeResult()&&t.length>0&&n.makeNextHitActive(r)&&(this.get_resultManager().set_activeResult(i||t[0]),this.get_resultManager().get_startRecheckResult()||this.get_resultManager().set_startRecheckResult(this.get_resultManager().get_activeResult()))},t.prototype.setHitRanges=function(e,t){e.setHitRanges(t)},t.prototype.clearHitRanges=function(e){this._shouldSetHitRanges&&e.clearHitRanges()},t.prototype.markViewableNodeDirty=function(e){e.invalidateViewElements(16,!0)},t.CreateInstanceWithResolvedDependencies=function(e,n,r,i,d){void 0===d&&(d=!1),n||(n=L.get_instance()),r||(r=I.get_instance());var c=P.CreateInstance(e,r.get_supportedTypes(),d),p=new h.q(l.z,(function(){return ee.CreateInstance(t.get_instance(),t.get_instance().get_resultManager())})),g=new h.q(u,(function(){return O.CreateInstance(t.get_instance().get_resultManager())})),_=new h.q(o,(function(){return w.CreateInstance(t.get_instance(),e)}));return new t(e,n,r,i,F.FindManagerHelper.get_Instance(),new h.q(a.h,(function(){return y.AFrameworkApplication.get_theTaskManager()})),new h.q(s.l,(function(){return q.SelectionManager.get_instance()})),new N.c,new x.b,le.z.createInstance,f.w.get_instance(),c,p,g,_,d)},t.get_instance=function(){return t.instance},t.createInstance=function(e,n,r,i,s){return void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=!1),void 0===s&&(s=!1),s?t.CreateInstanceWithResolvedDependencies(e,n,r,i,!0):t.get_instance()||(t.instance=t.CreateInstanceWithResolvedDependencies(e,n,r,i))},t.MaxErrorRestart=10,t.instance=null,t}(p.e);(0,i.l)(ue,"10cedb7d$FindManager",p.e,[])},1389:function(e,t,n){"use strict";n.d(t,{v:function(){return r}});var r=(0,n(4115).y)("9b4c521$IOneDriveFilePickerApiManager")},1581:function(e,t,n){"use strict";n.d(t,{u:function(){return s}});var r=n(4115),i=n(8889),s=function(){function e(t,n,i){this._eventEmitter=null,this._resultCallback=null,this.$$pf_Id=0,r.m(this,e.$$(t)),this._eventEmitter=n,this.set_id(e.$$(r.f(this,"Common.App.NewAndOpen.Core.EventReceiver$1").T)._nextEventReceiverId++),this._resultCallback=i}return e.prototype.get_id=function(){return this.$$pf_Id},e.prototype.set_id=function(e){return this.$$pf_Id=e,e},e.prototype.notify=function(e,t){this._resultCallback(e,t)},e.prototype.getResult=function(e,t){return this._eventEmitter.queryForResult(e,t?this:null)},e.$$=function(t){return r.o("Common.App.NewAndOpen.Core.EventReceiver$1",e,[{T:t}],null,[i.k.$$(t)],{_nextEventReceiverId:function(){return 0}})},e}()},1824:function(e,t,n){"use strict";n.d(t,{l:function(){return i}});var r=n(4115),i=function(){function e(){}return e.truncateIfNecessary=function(t){if(!t)return"{NULL}";var n=t.length;if(n<=e.MaxSizeToLog)return t;var r=n-(e.MaxSizeToLog-e.FirstPartSizeToLog-5);return t.substring(0,e.FirstPartSizeToLog)+"[...]"+t.substring(r,n)},e.MaxSizeToLog=600,e.FirstPartSizeToLog=400,e}();(0,r.l)(i,"581a48d7$LogUtils",null,[])},2138:function(e,t,n){"use strict";n.d(t,{f:function(){return u}});var r=n(4115),i=n(1389),s=n(2323),o=n(5378),a=n(2565),l=n(6801),u=function(){function e(e,t,n,r){this._errorDialogFactory=null,this.appEnvironment=0,this.appSettingsManager=null,this.onFilePickerClosedCallback=null,this._limitedEdit=!1,this._onApiReadyCallback=null,this._setup=!1,this._settingUp=!1,this._oneDriveApiScript=null,this.appSettingsManager=e,this.appEnvironment=t,this._limitedEdit=n,this._errorDialogFactory=r}return e.prototype.get_appEnvironment=function(){return this.appEnvironment},e.prototype.get_appSettingsManager=function(){return this.appSettingsManager},e.prototype.getOneDriveApi=function(){return this._oneDriveApiScript||(this._oneDriveApiScript=this.get_oneDriveApiUrl()?l.v.create(this.get_oneDriveApiUrl(),null,null,null,!1):null),this._oneDriveApiScript},e.prototype.setup=function(e){var t=this;if(this._onApiReadyCallback=e,this._setup||this._settingUp)this._setup&&this._onApiReadyCallback&&this._onApiReadyCallback(!0);else{var n=this.getOneDriveApi();if(!n)return s.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),void this._onApiReadyCallback(!1);this._settingUp=!0,n.get_loadFinishedTask().CW((function(e){t.OnOneDriveApiScriptLoaded(e)})),a.z.enqueueResourceWithoutEnabling(n)}},e.prototype.onJsDownloadFail=function(e){s.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",e.get_exception()?e.get_exception().toString():"No error detail.")},e.prototype.OnOneDriveApiScriptLoaded=function(e){if(this._settingUp=!1,e.get_isFaulted())return this.onJsDownloadFail(e),void this._onApiReadyCallback(!1);try{this._setup=!0,s.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.initializeApi(),s.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this._onApiReadyCallback(!0)}catch(e){s.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",e.toString()),this._onApiReadyCallback(!1)}},e.prototype.startPicker=function(e){this.onFilePickerClosedCallback=e,this._limitedEdit?s.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(s.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(r.i(this,this.onApiReady,"onApiReady")))},e.prototype.onApiReady=function(e){e?this.launchFilePicker():this.showErrorDialog()},e.prototype.showErrorDialog=function(){this._errorDialogFactory().displayError(o.p.oneDriveFilePickerNotJSON)},e.prototype.onSuccess=function(e){s.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function."),this.onFilePickerClosedCallback&&this.onFilePickerClosedCallback(!0,e)},e.prototype.dispose=function(){this._oneDriveApiScript&&this._oneDriveApiScript.dispose()},e}();(0,r.l)(u,"374d8329$AOneDriveFilePickerApiManager",null,[i.v,Sys.IDisposable])},2612:function(e,t,n){"use strict";n.d(t,{w:function(){return i}});var r=n(4115),i=function(){function e(e,t,n){this.rootNode=null,this.startNode=null,this.findType=0,this.rootNode=e,this.startNode=t,this.findType=n}return e.prototype.get_rootNode=function(){return this.rootNode},e.prototype.get_startNode=function(){return this.startNode},e.prototype.get_findType=function(){return this.findType},e}();(0,r.l)(i,"2d52bcd1$FindNodeContext",null,[])},2718:function(e,t,n){"use strict";n.d(t,{e:function(){return s}});var r=n(1817),i=n(4115),s=function(e){function t(t,n,r,i,s,o){var a=e.call(this)||this;return a.controlId=null,a.legacyId=null,a.parentMenuId=null,a.control=null,a.time=0,a.sqmInfo=null,a.controlId=t,a.legacyId=n,a.parentMenuId=r,a.control=i,a.time=s,a.sqmInfo=o,a}return(0,r.t)(t,e),t.prototype.get_controlId=function(){return this.controlId},t.prototype.get_legacyId=function(){return this.legacyId},t.prototype.get_parentMenuId=function(){return this.parentMenuId},t.prototype.get_control=function(){return this.control},t.prototype.get_time=function(){return this.time},t.prototype.get_sqmInfo=function(){return this.sqmInfo},t}(Sys.EventArgs);(0,i.l)(s,"73fddcae$SQMEventArgs",Sys.EventArgs,[])},2802:function(e,t,n){"use strict";var r=n(4115),i=function(){function e(t){this.next=null,r.m(this,e.$$(t)),this.data=r.c(r.f(this,"Box3.QueueNode$1").TNode)}return e.$$=function(t){return r.o("Box3.QueueNode$1",e,[{TNode:t}],null,[],{})},e}();n.d(t,{z:function(){return s}});var s=function(){function e(t){this._back=null,this._front=null,this._count=0,r.m(this,e.$$(t)),this._back=null,this._front=null,this._count=0}return e.prototype.get_count=function(){return this._count},e.prototype.get_isEmpty=function(){return!this._count||!this._back||!this._front},e.prototype.enqueue=function(e){var t=new i(r.f(this,"Box3.Queue$1").T);t.data=e,this.get_isEmpty()?(this._back=t,this._front=t):(this._back.next=t,this._back=t),this._count++},e.prototype.front=function(){return this.get_isEmpty()?null:this._front.data},e.prototype.back=function(){return this.get_isEmpty()?null:this._back.data},e.prototype.dequeue=function(){if(this.get_isEmpty())return null;var e=this._front;return this._front=e.next,this._count--,this._front||(this._back=null),e.data},e.prototype.clear=function(){this._back=null,this._front=null,this._count=0},e.prototype.toArray=function(){for(var e=new Array(this.get_count()),t=this._front,n=0;n<this.get_count()&&t;n++)e[n]=t.data,t=t.next;return e},e.$$=function(t){return r.o("Box3.Queue$1",e,[{T:t}],null,[],{})},e}()},2892:function(e,t,n){"use strict";n.d(t,{z:function(){return i}});var r=n(4115),i=function(){function e(){}return e.inputMethod="InputMethod",e.shouldCanvasTakeFocus="ShouldCanvasTakeFocus",e}();(0,r.l)(i,"4217db39$ReactRibbonConstants",null,[])},3208:function(e,t,n){"use strict";n.d(t,{l:function(){return r}});var r=(0,n(4115).y)("458617bf$IBasicChatUserExperienceController")},3497:function(e,t,n){"use strict";n.d(t,{o:function(){return r}});var r=(0,n(4115).e)("e39dc472$IEventEmitter$1")},3672:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var r=n(6616),i=n(1647),s=n(4115),o=function(){function e(){}return e.parseQuery=function(t){var n,r=[],s=new RegExp('"[^"\\r\\n]*"',"ig"),o=t.match(s);if(o&&o.length>0)for(n=0;n<o.length;n++){var a=o[n].split('"').join("");if(""!==(a=(a=a.trim()).split(e.Spaces).join(" "))){Array.add(r,a);var l=a.split(e.Punctuation).join(" ");""!==(l=(l=l.trim()).split(e.Spaces).join(" "))&&l!==a&&Array.add(r,l)}}var u=t.split(s).join(" "),d=i.i.get_instance().getBreaks(u);if(!d.length)return r.sort(e.SortTermsByLength),r;var c=d[0],p="";for(n=1;n<d.length;n++){var h=d[n];2===c.wordBreakType&&2===h.wordBreakType||(p=(p=u.substring(c.cp,h.cp)).trim(),e.IsWordWeCareToFind(p,c)&&Array.add(r,p),c=h)}return p=(p=u.substring(c.cp,u.length)).trim(),e.IsWordWeCareToFind(p,c)&&Array.add(r,p),r.sort(e.SortTermsByLength),r},e.IsWordWeCareToFind=function(e,t){return""!==e&&'"'!==e&&1!==t.wordBreakType},e.replaceSpacesWithRegexForOneOrMoreSpaces=function(t){for(var n=0;n<t.length;n++)t[n]=t[n].split(e.Spaces).join("\\s+");return t},e.SortTermsByLength=function(e,t){return e.length>t.length?-1:e.length===t.length?0:1},e.Punctuation=new RegExp("[\\[\\]\\\\\\^\\$\\.\\|\\+\\(\\)\\?\\*\\-_=,;:%!'<>/@#&{}]"),e.Spaces=new RegExp("\\s+"),e.regexEscapeCharacters=[new r.o(new RegExp("\\[","g"),"\\["),new r.o(new RegExp("\\]","g"),"\\]"),new r.o(new RegExp("\\\\","g"),"\\\\"),new r.o(new RegExp("\\^","g"),"\\^"),new r.o(new RegExp("\\$","g"),"\\$"),new r.o(new RegExp("\\.","g"),"\\."),new r.o(new RegExp("\\|","g"),"\\|"),new r.o(new RegExp("\\+","g"),"\\+"),new r.o(new RegExp("\\(","g"),"\\("),new r.o(new RegExp("\\)","g"),"\\)"),new r.o(new RegExp("\\?","g"),"\\?"),new r.o(new RegExp("\\*","g"),"\\*")],e}();(0,s.l)(o,"695ebd1a$SearchAndFindUtils",null,[])},4037:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var r=n(6362),i=n(8480),s=n(4115),o=function(){function e(e,t,n,r,i){void 0===i&&(i=!1),this.type=0,this.user=null,this.recordId=null,this.isLossy=!1,this.time=null,this.commentId=null,this.assignee=null,this.schedule=null,this.title=null,this.undoId=null,this.completion=-1,this.priority=-1,this.type=e,this.user=t,this.time=n,this.recordId=r,this.isLossy=i}return e.prototype.clone=function(){var t=new e(this.type,this.user,this.time,this.recordId,this.isLossy);return t.commentId=this.commentId,this.assignee&&(t.assignee=new r.m(this.assignee.UserId,this.assignee.Provider,this.assignee.DisplayName,this.assignee.Email)),this.schedule&&(t.schedule=new i.j,t.schedule.startDate=this.schedule.startDate,t.schedule.endDate=this.schedule.endDate),t.completion=this.completion,t.title=this.title,t.priority=this.priority,t},e}();(0,s.l)(o,"873e5305$HistoryRecord",null,[])},4269:function(e,t,n){"use strict";var r=n(4115),i=(0,r.e)("d3b92fe7$IReactTaskPaneManager$1"),s=n(9730);n.d(t,{j:function(){return o}});var o=function(){function e(t){this._callbacks=null,r.m(this,e.$$(t)),this._callbacks=new s.c(Function)}return e.prototype.registerDataCallback=function(e){this._callbacks.add(e)},e.prototype.getCallbackSize=function(){return this._callbacks.get_count()},e.prototype.setProps=function(e){for(var t=this._callbacks.$$lge();t.$$mn();){t.$$cu()(e)}},e.$$=function(t){return r.o("Common.ReactTaskPaneManager$1",e,[{T:t}],null,[i.$$(t)],{})},e}()},4487:function(e,t,n){"use strict";var r=n(5195),i=n(544),s=n(2218),o=n(6362),a=n(8480),l=n(4037),u=n(4115),d=function(){function e(){}return e.eventType="Type",e.eventTime="Time",e.eventId="Id",e.attributionUserId="AttributionId",e.attributionUserProvider="AttributionProvider",e.attributionDisplayName="AttributionName",e.assigneeUserId="AssigneeId",e.assigneeUserProvider="AssigneeProvider",e.assigneeDisplayName="AssigneeName",e.startDate="Start",e.endDate="End",e.title="Title",e.commentAnchor="Anchor",e.percentComplete="Percent",e.priority="Priority",e}();(0,u.l)(d,"23469ee2$Key",null,[]),n.d(t,{l:function(){return c}});var c=function(){function e(){}return e.prototype.serializeHistoryToString=function(t){if(!t)return"[]";var n=e.ConvertHistoryArrayToDictionaryArray(t);return i.x.serialize(n)},e.prototype.deserializeHistoryFromString=function(t){var n=i.x.secureDeserialize(t||"[]");return e.ConvertDictionaryArrayToHistoryList(n)},e.ThrowArgumentException=function(e,t){throw Error.argument(e,t)},e.GetOptionalStringValueFromDictionary=function(e,t){return(t=t.toString())in e?e[t].toString():null},e.GetStringValueFromDictionary=function(t,n){return(n=n.toString())in t||e.ThrowArgumentException("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",n)),t[n].toString()},e.GetIntValueFromDictionary=function(t,n){return(n=n.toString())in t||e.ThrowArgumentException("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",n)),Number.parseInvariant(t[n].toString())},e.StringToDateTime=function(t){var n=new Date(t);return isNaN(n.getUTCMilliseconds())&&e.ThrowArgumentException("dateTime","Date and time is in invalid format"),n},e.DateTimeToString=function(e){return e.toISOString()},e.ConvertHistoryRecordToSerializationDictionary=function(t){t.isLossy&&e.ThrowArgumentException("record","TaskHistorySerializer doesn't support serializing lossy records");var n={};switch(n[d.eventType]=t.type,n[d.eventTime]=e.DateTimeToString(t.time),n[d.eventId]=t.recordId,t.user&&(t.user.UserId&&t.user.Provider&&t.user.DisplayName||e.ThrowArgumentException("record","HistoryRecord has invalid attribution"),n[d.attributionUserId]=t.user.UserId,n[d.attributionUserProvider]=t.user.Provider,n[d.attributionDisplayName]=t.user.DisplayName),t.commentId&&(n[d.commentAnchor]=t.commentId),t.type){case 1:break;case 2:case 3:t.assignee&&t.assignee.UserId&&t.assignee.Provider&&t.assignee.DisplayName||e.ThrowArgumentException("record","HistoryRecord has invalid assignee"),n[d.assigneeUserId]=t.assignee.UserId,n[d.assigneeUserProvider]=t.assignee.Provider,n[d.assigneeDisplayName]=t.assignee.DisplayName;break;case 4:break;case 5:t.schedule||e.ThrowArgumentException("record","Schedule history record must have a schedule object"),t.schedule.startDate&&(n[d.startDate]=e.DateTimeToString(t.schedule.startDate)),t.schedule.endDate&&(n[d.endDate]=e.DateTimeToString(t.schedule.endDate));break;case 6:(t.completion<0||t.completion>100)&&e.ThrowArgumentException("record","Progress history record must have a completion >= 0 and <= 100"),n[d.percentComplete]=t.completion;break;case 10:(t.priority<0||t.completion>10)&&e.ThrowArgumentException("record","Priority history record must have a completion >= 0 and <= 10"),n[d.priority]=t.priority;break;case 7:case 8:break;case 9:t.title||e.ThrowArgumentException("record","Set-title history record must have a title"),n[d.title]=t.title;break;default:e.ThrowArgumentException("record","Unknown or unsupported history record type")}return n},e.ConvertSerializationDictionaryToHistoryRecord=function(t){var n=null,r=e.GetOptionalStringValueFromDictionary(t,d.attributionUserId),i=e.GetOptionalStringValueFromDictionary(t,d.attributionUserProvider),s=e.GetOptionalStringValueFromDictionary(t,d.attributionDisplayName);(r||i||s)&&(r&&i&&s||e.ThrowArgumentException("dictionary","Record has invalid attribution user"),n=new o.m(r,i,s));var u=new l.m(e.GetIntValueFromDictionary(t,d.eventType),n,e.StringToDateTime(e.GetStringValueFromDictionary(t,d.eventTime)),e.GetStringValueFromDictionary(t,d.eventId));switch(u.commentId=e.GetOptionalStringValueFromDictionary(t,d.commentAnchor),u.type){case 1:break;case 2:case 3:u.assignee=new o.m(e.GetStringValueFromDictionary(t,d.assigneeUserId),e.GetStringValueFromDictionary(t,d.assigneeUserProvider),e.GetStringValueFromDictionary(t,d.assigneeDisplayName));break;case 4:break;case 5:u.schedule=new a.j;var c=e.GetOptionalStringValueFromDictionary(t,d.startDate);c&&(u.schedule.startDate=e.StringToDateTime(c));var p=e.GetOptionalStringValueFromDictionary(t,d.endDate);p&&(u.schedule.endDate=e.StringToDateTime(p));break;case 10:u.priority=e.GetIntValueFromDictionary(t,d.priority),(u.priority<0||u.priority>10)&&e.ThrowArgumentException("dictionary","Priority record must have history >= 0 and <= 10");break;case 6:u.completion=e.GetIntValueFromDictionary(t,d.percentComplete),(u.completion<0||u.completion>100)&&e.ThrowArgumentException("dictionary","Progress record must have history >= 0 and <= 100");break;case 7:case 8:break;case 9:u.title=e.GetStringValueFromDictionary(t,d.title);break;default:e.ThrowArgumentException("dictionary","Unknown or unsupported history record type")}return u},e.ConvertHistoryArrayToDictionaryArray=function(t){for(var n=new Array(t.get_length()),r=0;r<t.get_length();++r)n[r]=e.ConvertHistoryRecordToSerializationDictionary(t.get_item(r));return n},e.ConvertDictionaryArrayToHistoryList=function(t){for(var n=new s.o(l.m),r=0,i=t;r<i.length;r++){var o=i[r],a=e.ConvertSerializationDictionaryToHistoryRecord(o);n.add(a)}return n},e}();(0,u.l)(c,"e2c8b155$JsonTaskHistorySerialization",null,[r.i])},4902:function(e,t,n){"use strict";n.d(t,{c:function(){return r}});var r=(0,n(4115).y)("79ffe58c$IGetMoreInfoResult")},5041:function(e,t,n){"use strict";n.d(t,{n:function(){return r}});var r=(0,n(4115).y)("cf89e89b$IChatClientFactory")},5195:function(e,t,n){"use strict";n.d(t,{i:function(){return r}});var r=(0,n(4115).y)("5cfea2a4$ITaskHistorySerialization")},5727:function(e,t,n){"use strict";n.d(t,{u:function(){return r}});var r=(0,n(4115).y)("1bb018a2$IO365ShellActor")},6314:function(e,t,n){"use strict";n.d(t,{u:function(){return p}});var r=n(4115),i=n(3067),s=n(7762),o=n(3660),a=n(6778),l=n(1390),u=n(2612),d=n(1410),c=n(8721),p=function(){function e(e,t){this._graphIteratorFactory=null,this.findResultTypeForNode=null,this.findNodeContextForTypeHavingStartNode=null,this.findNodeContextForType=null,this.findTypes=0,this.$$pf_SupportedTypes=null,this._graphIteratorFactory=e,this.findResultTypeForNode=r.i(this,this.GetFindResultTypeForNode,"GetFindResultTypeForNode"),this.findNodeContextForTypeHavingStartNode=r.i(this,this.GetFindNodeContextForTypeHavingStartNode,"GetFindNodeContextForTypeHavingStartNode"),this.findNodeContextForType=r.i(this,this.GetFindNodeContextForType,"GetFindNodeContextForType"),this.findTypes=1,t&&(this.findTypes=6|this.findTypes),this.findTypes=24|this.findTypes,this.set_supportedTypes(this.GetFindTypeList())}return e.prototype.get_supportedTypes=function(){return this.$$pf_SupportedTypes},e.prototype.set_supportedTypes=function(e){return this.$$pf_SupportedTypes=e,e},e.prototype.getFindContexts=function(e){var t=new Array(0),n=this.findResultTypeForNode(e);n&&((s=this.findNodeContextForTypeHavingStartNode(n,e))&&(t[t.length]=s));for(var r=0,i=this.get_supportedTypes();r<i.length;r++){var s,o=i[r];if(o!==n&&o)(s=this.findNodeContextForType(o,e))&&(t[t.length]=s)}return t},e.prototype.GetFindNodeContextForTypeHavingStartNode=function(e,t){var n=this.GetRootNodeType(e),r=this._graphIteratorFactory.getGraphIteratorFromNode(t);if(r.tryToRootAtAncestorOfType(n)){r.returnToAncestorOfType(n);var i=r.get_currentNode();return new u.w(i,t,e)}return null},e.prototype.GetFindNodeContextForType=function(e,t){var n=null,r=null,i=this.GetRootNodeType(e),s=this._graphIteratorFactory.getGraphIteratorFromNode(t);return this.SetRootAndFirstNodeForType(s,e,i,(0,o.m)((function(){return n}),(function(e){return n=e})),(0,o.m)((function(){return r}),(function(e){return r=e}))),n&&r?new u.w(n,r,e):null},e.prototype.GetFindResultTypeForNode=function(e){var t=this._graphIteratorFactory.getGraphIteratorFromNode(e);return(this.IsSupportedtype(2)||this.IsSupportedtype(4))&&t.tryToRootAtAncestorOfType(36)?(t.returnToAncestorOfType(36),this.FindResultTypeForHeaderFooterNode(t.get_currentNode())):(this.IsSupportedtype(8)||this.IsSupportedtype(16))&&t.tryToRootAtAncestorOfType(37)?(t.returnToAncestorOfType(37),this.FindResultTypeForFootnoteEndnoteContainerNode(t.get_currentNode())):this.IsSupportedtype(32)&&t.tryToRootAtAncestorOfType(40)?32:this.IsSupportedtype(1)&&t.tryToRootAtAncestorOfType(8)?1:0},e.prototype.IsSupportedtype=function(e){return!!e&&!!(this.findTypes&e)},e.prototype.SetRootAndFirstNodeForType=function(e,t,n,r,i){if(e.tryToRootAtAncestorOfType(7)){if(e.returnToAncestorOfType(7),8===n||37===n||39===n)for(var s=e.goToFirstChild();s;){if(s.get_type()===n){if(37!==n){r.val=e.get_currentNode();break}if((8===t||16===t)&&t===this.FindResultTypeForFootnoteEndnoteContainerNode(s)){r.val=e.get_currentNode();break}}s=e.goToNextSibling()}if(r.val&&e.hasChildren()){var o=this._graphIteratorFactory.getGraphIteratorFromNode(r.val);d.w.moveIteratorToNextFindableNode(o,n,t)&&(i.val=e.get_currentNode())}}},e.prototype.GetFindTypeList=function(){var e=new Array(0);return this.IsSupportedtype(1)&&(e[e.length]=1),this.IsSupportedtype(2)&&(e[e.length]=2),this.IsSupportedtype(4)&&(e[e.length]=4),this.IsSupportedtype(8)&&(e[e.length]=8),this.IsSupportedtype(16)&&(e[e.length]=16),this.IsSupportedtype(32)&&(e[e.length]=32),e},e.prototype.GetRootNodeType=function(e){var t=8;switch(e){case 1:case 2:case 4:t=8;break;case 8:case 16:t=37;break;case 32:t=39}return t},e.prototype.FindResultTypeForFootnoteEndnoteContainerNode=function(e){var t=e.get_properties().getValue(Number,a.j.footnoteEndnoteKind);return this.IsSupportedtype(8)&&1===t?8:this.IsSupportedtype(16)&&!t?16:0},e.prototype.FindResultTypeForHeaderFooterNode=function(t){var n=t.getValue(Number,a.j.headerFooterKind);return this.IsSupportedtype(2)&&e.IsHeaderKind(n)?2:this.IsSupportedtype(4)&&e.IsFooterKind(n)?4:0},e.get_FeatureHelper=function(){return e._featureHelper||(e._featureHelper=l.w.get_instance().resolve(i.d))},e.CreateInstanceWithResolvedDependencies=function(){var t=e.get_FeatureHelper();return new e(new c.c,t.isFeatureEnabled(63))},e.get_instance=function(){return e._instance||(e._instance=e.CreateInstanceWithResolvedDependencies())},e.IsHeaderKind=function(e){return!e||1===e||2===e},e.IsFooterKind=function(e){return 3===e||4===e||5===e},e._instance=null,e._featureHelper=null,e}();(0,r.l)(p,"f29deefd$WordFindContextHelper",null,[s.z])},6362:function(e,t,n){"use strict";n.d(t,{m:function(){return i}});var r=n(4115),i=function(){return function(e,t,n,r,i,s){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=!1),void 0===s&&(s=null),this.UserId=null,this.Provider=null,this.DisplayName=null,this.Email=null,this.UserId=e,this.Provider=t,this.DisplayName=n,this.Email=r}}();(0,r.l)(i,"47e66ca1$CommentTaskPerson",null,[])},6935:function(e,t,n){"use strict";n.d(t,{o:function(){return i}});var r=n(4115),i=function(){function e(){}return e.Callback="action",e}();(0,r.l)(i,"fd81bd20$MenuLauncherAsyncTriggerCommandProperties",null,[])},7239:function(e,t,n){"use strict";n.d(t,{n:function(){return o}});var r=n(1817),i=n(3298),s=n(4115),o=function(e){function t(){var t=e.call(this)||this;return t.Character=null,t.Style=null,t}return(0,r.t)(t,e),t.prototype.get_Type=function(){return 1},t}(i.f);(0,s.l)(o,"e3970085$CharacterCodeGalleryButtonProps",i.f,[])},7467:function(e,t,n){"use strict";n.d(t,{a:function(){return l}});var r=n(4115),i=n(9730),s=n(9399),o=n(7223),a=n(2718),l=function(){function e(){this._commandClickBuffer=null}return e.prototype.init=function(){this._commandClickBuffer=new i.c(a.e),o.z.add_onSQMEventHandler(r.i(this,this.SqmEventRaised,"SqmEventRaised"))},e.prototype.SqmEventRaised=function(e,t){var n=s.AFrameworkApplication.appSettingsManager.getIntAppSetting("MaxCommandClickedEventQueueSize",20),r=t;this._commandClickBuffer.insert(0,r),this._commandClickBuffer.get_count()>n&&this._commandClickBuffer.removeAt(n)},e.prototype.getCommandClicks=function(){return this._commandClickBuffer},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();(0,r.l)(l,"de6d541$CommandClickEventsCache",null,[])},7762:function(e,t,n){"use strict";n.d(t,{z:function(){return r}});var r=(0,n(4115).y)("f65303e$IFindContextHelper")},7771:function(e,t,n){"use strict";n.d(t,{x:function(){return a}});var r=n(8540),i=n(5890),s=n(9514),o=n(4115),a=function(){function e(){}return e.prototype.dispose=function(){},e.createButton=function(e,t,n,o,a){void 0===a&&(a=!0);var l=a?"":n,u=r.j.createDomElement("a",e,"StandardButton "+t);u.title=l,u.tabIndex=0;var d=null;if(o?((d=i.ImageClusteringHelper.createClusteredImage(16,16,o,"StandardButtonImage",!0,null)).setAttribute(s.t.ariaRoleAttribute,s.t.ariaPresentationRole),u.appendChild(d)):Sys.UI.DomElement.addCssClass(u,"StandardButtonNoImage"),a){var c=r.j.createDomElement("span",null,"StandardButtonLabel");c.innerText=n,u.appendChild(c)}else Sys.UI.DomElement.addCssClass(d,"StandardButtonImageNoText");return u.setAttribute(s.t.ariaRoleAttribute,s.t.ariaButtonRole),u},e.setButtonEnabledState=function(e,t){var n;null!=e&&(e.disabled=!t,t?(n=s.t.ariaFalseValue,Sys.UI.DomElement.removeCssClass(e,"DisabledButton"),Sys.UI.DomElement.removeCssClass(e,"cui-disabled")):(n=s.t.ariaTrueValue,Sys.UI.DomElement.containsCssClass(e,"DisabledButton")||Sys.UI.DomElement.addCssClass(e,"DisabledButton"),Sys.UI.DomElement.containsCssClass(e,"cui-disabled")||Sys.UI.DomElement.addCssClass(e,"cui-disabled")),s.t.setAriaAttribute(e,s.t.ariaDisabledAttribute,n))},e}();(0,o.l)(a,"11f350c6$SimpleButtonFactory",null,[Sys.IDisposable])},8480:function(e,t,n){"use strict";n.d(t,{j:function(){return i}});var r=n(4115),i=function(){return function(){this.startDate=null,this.endDate=null}}();(0,r.l)(i,"fb5d99f1$CommentTaskSchedule",null,[])},8540:function(e,t,n){"use strict";n.d(t,{j:function(){return i}});var r=n(4115),i=function(){function e(){}return e.createDomElement=function(e,t,n){var r=document.createElement(e);return t&&(r.id=t),n&&(r.className=n),r},e.createUnselectableDomElement=function(t,n,r){var i=e.createDomElement(t,n,r);return i.setAttribute("Unselectable","on"),i},e}();(0,r.l)(i,"8da1a8e6$DomElementFactory",null,[])},8666:function(e,t,n){"use strict";n.d(t,{p:function(){return i}});var r=n(4115),i=function(){return function(){this.title=null,this.sections=null}}();(0,r.l)(i,"88bf4d3$MenuModel",null,[])},8889:function(e,t,n){"use strict";n.d(t,{k:function(){return r}});var r=(0,n(4115).e)("1219ebdd$IEventReceiver$1")},9101:function(e,t,n){"use strict";n.d(t,{z:function(){return r}});var r=(0,n(4115).y)("894bcf7d$IReplaceManager")},9674:function(e,t,n){"use strict";n.d(t,{f:function(){return u}});var r=n(1817),i=n(4115),s=n(2138),o=n(2323),a=n(5378),l=n(2565),u=function(e){function t(n,r,i,s){var o=e.call(this,n,r,i,s)||this;return o.options=null,o.options={},o.options.advanced={},o.options.action=t.QueryAction,o.options.clientId=o.get_appSettingsManager().getStringAppSetting("OneDriveApiV72ClientId"),o.options.advanced.trapFocus=!0,o}return(0,r.t)(t,e),t.prototype.get_oneDriveApiUrl=function(){return this.get_appSettingsManager().getStringAppSetting("OneDriveApiV72Url")},t.prototype.start=function(e,t,n,r){this.options.advanced.iframeParentDiv=n,this.options.advanced.endpointHint=r,this.options.cancel=t,this.startPicker(e)},t.prototype.startPicker=function(e){this.onFilePickerClosedCallback=e,this._limitedEdit?o.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(o.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(i.i(this,this.onApiReady,"onApiReady")))},t.prototype.initializeApi=function(){var e=this;this.options.success=function(t){var n={};n.data=t,e.onSuccess(n)},this.options.error=function(t){var n={};n.error=t,e.onFailure(n)}},t.prototype.launchFilePicker=function(){try{o.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(e){o.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",e.message,e.stack),this.showErrorDialog()}},t.prototype.onJsDownloadFail=function(e){o.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",e.get_exception()?e.get_exception().toString():"No error detail."),l.z.removeReferenceForRetryDownload(this.get_oneDriveApiUrl()),this._oneDriveApiScript=null},t.prototype.showErrorDialog=function(){this._errorDialogFactory().displayWarning(a.p.saveAsToOneDriveFailed_FilePicker)},t.prototype.onFailure=function(e){this.onFilePickerClosedCallback&&this.onFilePickerClosedCallback(!1,e)},t.QueryAction="query",t}(s.f);(0,i.l)(u,"7e6824bb$OneDriveFilePickerApiManagerV72",s.f,[])}}]);
//# sourceMappingURL=https://wordwebclientbuilds.blob.core.windows.net/official/16.0.12222.32650/WordEditorDS.box4.dll1.js.map