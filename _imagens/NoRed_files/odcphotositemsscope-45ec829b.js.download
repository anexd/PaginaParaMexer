define("odsp-next/controls/list/allphoto2/PhotosItemsScopeItemContent",["require","exports","tslib","react","@ms/odsp-shared-react/lib/utilities/resources/Resources","../../../resources/ControlResourceKeys","../react/SelectionManager","../../../resources/DataSourceResourceKeys","../../../dataSources/base/vroom/VroomDataRequestor","../../list/layouts/LayoutType","./ItemsScopeAllPhoto","@ms/odsp-utilities/lib/resources/Resources","../../../models/itemCache/ItemCacheStore","../../../bindings/component/ReactControlBinding","../../itemsScope/CurrentItemsScope","../../itemsScope/ItemsScopeItemKey","../../../dataSources/itemInvalidator/odc/ItemInvalidator.key","../../../models/itemsScope/ItemsScopeCurrentItemKey.key","office-ui-fabric-react/lib/Fabric","../../../utilities/icons/InitializeIcons"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;if(r.props.child){var i=r.context.dependencies.actionMap;r.openItemOverlay=r.props.child(i.DefaultClickAction)}r.state={currentItemSetKey:r.context.dependencies.itemsScopeCurrentItemKey.peek()};return r}t.prototype.render=function(){var e=this.context.dependencies,t=this.props.layoutType===f.Grid,n=e.currentItemsScope;return r.createElement(y.Fabric,null,r.createElement(n,null,r.createElement(l.ItemsScopeAllPhoto,{itemCacheStore:e.itemCacheStore,openItemOverlay:this.openItemOverlay,selectionModel:e.selectionModel,resources:e.resources,identityDataSource:e.identityDataSource,vroomDataRequestor:e.vroomDataRequestor,squareTiles:t,selection:e.selection,selectionMode:e.selectionMode,currentItemSetKey:e.itemsScopeCurrentItemKey.peek(),itemInvalidator:e.itemInvalidator})))};t.contextTypes=i.RESOLVED_COMPONENT_CONTEXT_TYPES;return t}(r.PureComponent);t.default=b;t.resourceKey=i.createResolvedComponentTypeResourceKey(e("module").id,b,{itemCacheStore:h.resourceKey,currentItemsScope:d.resourceKey.local,identityDataSource:u.identity,vroomDataRequestor:a.resourceKey,actionMap:s.actionMap,selection:o.resourceKey,selectionMode:o.selectionModeResourceKey,selectionModel:s.itemsSelection,resources:c.resourceScopeKey,urlDataSource:u.url,itemsScopeItemKey:v.resourceKey,itemInvalidator:m.resourceKey,itemsScopeCurrentItemKey:g.resourceKey});t.knockoutResourceKey=p.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-scope-photos",name:e("module").id+".knockout"})});
define("odsp-next/controls/list/allphoto2/ItemsScopeAllPhoto",["require","exports","tslib","react","@ms/items-view-addon-photos/lib/PhotosAddon","@ms/items-view-addon-photos/lib/PhotosAddonConfig","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/store/createStore","./src/itemsscope/SkyAPIAddonSource","./src/itemsscope/GraphAddonSource","./src/itemsscope/VroomAddonSource","./src/itemsscope/PhotoProviderAddonSource","office-ui-fabric-react/lib/MarqueeSelection","office-ui-fabric-react/lib/Selection","@uifabric/experiments/lib/Tile","./src/ExplorePhotos","knockout","../../../resources/PagesResourceKeys","@ms/items-view-addon-photos/lib/components/gallery/AllPhotosGallery","../../../providers/engagement/Engagement","office-ui-fabric-react/lib/Icon","../../../models/item/OneDriveItem","../../../models/item/ItemType","../../../models/item/VirtualItemType","../../../dataSources/url/QueryType","../../../models/photo/AllPhotosSet","../../../resources/ControlResourceKeys","../../../resources/DataSourceResourceKeys","../../../models/tag/TagType","../../../utilities/tag/GroupPacker","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../utilities/icons/IconHelper","ODCPhotosItemsScope_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var D=0,P=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.openItemOverlayAction=function(e,t){if(n.props.openItemOverlay){var r=n._currentItemSet.peek().content.peek().items[t];new n.props.openItemOverlay({item:r,userInvokedItem:!0,sourceEngagement:"ImageTile.Click"}).execute(e).done()}};n.renderTileListParent=function(e,t){return r.createElement(h.MarqueeSelection,{selection:n.props.selection,onShouldStartSelection:n._onShouldStartSelection,isDraggingConstrainedToRoot:!0},r.createElement(p.SelectionZone,{selection:n.props.selection,selectionMode:n.props.selectionMode,onItemInvoked:n.openItemOverlayAction.bind(n),enterModalOnTouch:!0,disableAutoSelectOnInputElements:!0},t))};n._onLocationHeaderClick=function(e){var t=O.serializeQuery(n._navigation.viewParams),r=[e.country||e.countryOrRegion,e.state,e.city||e.locationTag],i=r.join(A.ALLPLACES_GEOLOCATION_DELIMITER),s=t+"&locationFilter="+r.join(A.ALLPLACES_GEOLOCATION_HARDCODED),o=new E.default(s);o.id=i;o.isDropEnabled=!1;o.isPlaceholder=!0;o.properties={};o.type=S.default.Folder;o.tagInfo={tagType:L.default.allPlaces};o.virtualItemType=x.default.TagsRoot;o.queryType=T.default.AllMyPhotos;o.isRootFolder=!0;new N.default(L.default[L.default.allPlaces]).item=m.observable(o);var u=n._urlDataSource.getDefaultClickUrl(o,{preferCurrentView:!0,itemSet:n._currentItemSet.peek()});n._navigation.navigateTo(u)};n.renderTileAnnotation=function(e,t){var i=n._currentItemSet.peek().content.peek().items[e.imageIndex];return i&&"function"==typeof i&&i().video?r.createElement("span",{className:"Tile-playButton"},r.createElement(w.Icon,{iconName:"Play",className:"Tile-playButton"})):r.createElement(r.Fragment,null)};n.renderTile=function(e,t){return r.createElement(d.Tile,{role:"option",label:e.label,contentSize:e.contentSize,className:e.className,key:e.id,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:e.onClick,style:e.style,tileSize:e.tileSize,selection:n.props.selection,selectionIndex:e.selectionIndex,id:e.id,"aria-label":e.ariaLabel,ariaLabel:e.ariaLabel,onKeyDown:e.onKeyDown,onFocus:e.onFocus,onBlur:e.onBlur})};n.renderExplorePhotos=function(e,t){return r.createElement(v.default,{resources:n.props.resources,rowStyle:e.rowStyle})};if(n.props.itemCacheStore)n.itemCacheStore=n.props.itemCacheStore;else{console.warn("ItemsscopeAllPhotos is building it's own cache store.");n.itemCacheStore=u.createItemCacheStore({})}var y=n.itemCacheStore.dispatch(o.readItems(function(e){return e.demandItemFacet(s.photosAddonDataSourceFacet,s.photosConfigurationKey)}));if(y)n.addon_Source=y;else{n.addon_Source=0===D?new c.PhotoProviderAddonSource(n.props.vroomDataRequestor):1===D?new a.SkyAPIAddonSource:2===D?new f.GraphAddonSource(n.props.identityDataSource):new l.VroomAddonSource(n.props.vroomDataRequestor);n.itemCacheStore.dispatch(i.photosAddon);s.registerAllPhotosConfig(n.itemCacheStore,n.addon_Source,100,100,250)}n.addPaddingBottom=n._exposeIfNeeded(g.base.addPaddingBottom,m.observable(!1));n.openItemOverlayAction=n.openItemOverlayAction;n._urlDataSource=n.props.resources.consume(k.url);n._navigation=n.props.resources.consume(M.navigation);n._currentItemSet=n.props.resources.consume(C.currentItemSet);n._imageErrorThumbnailUrl=_.getIconUrl(n.props.resources,"photo",96);n._videoErrorThumbnailUrl=_.getIconUrl(n.props.resources,"video",96);n._engagement=n.props.resources.consume(b.resourceKey);n._telemetryFileCount=0;n._telemetryFileRenderCount=0;n._telemetryFileExtension={};n._telemetryFileAspectRatio={};n._telemetryTimelineScrubberScroll=!1;n._telemetryMaxRenderedIndex=0;n._telemetryLastScroll=0;n._telemetryOldestMediaDate="";n._telemetryAvgImageLoadMs=0;n._telemetryCallbacks={fileRenderCount:function(e){n._telemetryFileRenderCount++;e>n._telemetryMaxRenderedIndex&&(n._telemetryMaxRenderedIndex=e)},scrubberScroll:function(e){n._telemetryTimelineScrubberScroll=!0;e>n._telemetryLastScroll&&(n._telemetryLastScroll=e)},screenSize:function(e,t){n._engagement&&n._engagement.logData({name:"AllPhotos.ScreenWidthHeightPx",extraData:{width:e,height:t}})},firstImageLoadMs:function(e){n._engagement&&n._engagement.logData({name:"AllPhotos.FirstImageLoadMs",extraData:{time:e}})},fullPageLoadMs:function(e){n._engagement&&n._engagement.logData({name:"AllPhotos.FullPageLoadMs",extraData:{time:e}})},avgImageLoadMs:function(e){n._telemetryAvgImageLoadMs=e},thumbnailfirstLoadMs:function(e){n._engagement&&n._engagement.logData({name:"AllPhotos.FirstLoadThumbnailMs",extraData:{time:e}})},allThumbnailLoadTimeMs:function(e,t,r){n._engagement&&n._engagement.logData({name:"AllPhotos.ThumbnailLoadTimeMs",extraData:{minTime:e,maxTime:t,avgTime:r}})}};return n}t.prototype.UNSAFE_componentWillMount=function(){this.addon_Source.updateResource(this.props.resources);this.props.itemInvalidator.invalidateCurrentItemSet();this.addPaddingBottom(!1);this._engagement&&this._engagement.logData({name:"AllPhotos.FirstLoadInitializeAllPhotosGallery"})};t.prototype.componentDidMount=function(){var e=this;this._collectTelmetryOnUpdate();window.onbeforeunload=function(t){e._onBeforeUnload(t)}};t.prototype.componentWillUnmount=function(){this.addPaddingBottom(!0);window.onbeforeunload=null;this._logTelemetryEndOfSession()};t.prototype.componentDidUpdate=function(e){if(e.squareTiles!==this.props.squareTiles&&this._engagement){var t=this.props.squareTiles?"od-grid-list":"od-river-list";this._engagement.logData({name:"AllPhotos.ToggleListLayout",extraData:{toggleListLayout:t}})}};t.prototype.render=function(){return r.createElement("div",{className:"od-Photos"},r.createElement(y.AllPhotosGallery,{squareTiles:this.props.squareTiles,onRenderTileListParent:this.renderTileListParent,onRenderTile:this.renderTile,onRenderTileAnnotation:this.renderTileAnnotation,onRenderExplorePhotos:this.renderExplorePhotos,openItemOverlay:this.openItemOverlayAction,explorePhotosHeight:280,selection:this.props.selection,selectionMode:this.props.selectionMode,telemetryCallbacks:this._telemetryCallbacks,onLocationHeaderClick:this._onLocationHeaderClick,showDebug:!1,rowHeight_aspect:[160,180,200,220,225,250],midRowGroupGap_aspect:[16,16,16,16,16,16],imagePadding_aspect:[2,2,2,2,2,2],galleryPadding_aspect:[0,28,28,32,32,32],galleryPaddingRight_aspect:[0,28,28,64,64,64],rowHeight_squaretiles:[125,125,125,125,125,125],midRowGroupGap_squaretiles:[0,0,0,0,0,0],imagePadding_squaretiles:[1,1,1,1,1,1],galleryPadding_squaretiles:[0,28,28,32,32,32],galleryPaddingRight_squaretiles:[0,28,28,64,64,64],maxRowScaleUpFactor_squaretiles:[4,1.6,1.6,1.6,1.6,1.6],maxRowScaleUpFactor:[3,1.58,1.35,1.25,1.2,1.2],groupHeaderMarginTop:[32,32,32,32,32,32],groupHeaderMarginBottom:[8,8,8,8,8,8],groupHeaderLeadingMargin:[8,0,0,0,0,0],lookAheadRowsCount:5,maxParallelRequests:10,thumbnailResizingMode:"exact",thumbnailProgressiveMode:"one",screenResBreakPoints:[480,768,1024,1366,1920,2560],enableScrubber:!0,enableDateStitching:!0,imageErrorThumbnail:this._imageErrorThumbnailUrl,videoErrorThumbnail:this._videoErrorThumbnailUrl}))};t.prototype._collectTelmetryOnUpdate=function(){var e=this._currentItemSet.peek().content.peek().items;if(e){this._telemetryFileCount=e.length;for(var t={},n={},r=0;r<e.length;r++)if(e[r]&&e[r].peek()){var i=e[r]();if(i.extension){var s=i.extension.toLowerCase();t[s]=t[s]?t[s]+1:1}if(i.photo&&i.photo.height&&i.photo.width){var o=Math.floor(i.photo.width/i.photo.height*10)/10;n[o]=n[o]?n[o]+1:1}r===e.length-1&&(this._telemetryOldestMediaDate=i.dateTaken||"")}this._telemetryFileExtension=t;this._telemetryFileAspectRatio=n}};t.prototype._logTelemetryEndOfSession=function(){if(this._engagement){this._engagement.logData({name:"AllPhotos.FileCount",extraData:{fileCount:this._telemetryFileCount}});this._engagement.logData({name:"AllPhotos.FileRenderCount",extraData:{fileRenderCount:this._telemetryFileRenderCount}});this._engagement.logData({name:"AllPhotos.FileExtension",extraData:this._telemetryFileExtension});this._engagement.logData({name:"AllPhotos.FileAspectRatio",extraData:this._telemetryFileAspectRatio});this._engagement.logData({name:"AllPhotos.MaxRenderedIndex",extraData:{maxRenderedIndex:this._telemetryMaxRenderedIndex}});this._engagement.logData({name:"AllPhotos.TimelineScrubberScroll",extraData:{timelineScrubberScroll:this._telemetryTimelineScrubberScroll}});this._engagement.logData({name:"AllPhotos.LastScroll",extraData:{lastScroll:this._telemetryLastScroll}});this._engagement.logData({name:"AllPhotos.OldestMediaDate",extraData:{oldestMediaDate:this._telemetryOldestMediaDate}});this._engagement.logData({name:"AllPhotos.AvgImageLoadMs",extraData:{avgImageLoadMs:this._telemetryAvgImageLoadMs}})}};t.prototype._onBeforeUnload=function(e){this._logTelemetryEndOfSession()};t.prototype._onShouldStartSelection=function(e){for(var t=e.target;t&&t!==document.body;){if(null!==t.getAttribute("data-selection-index"))return!1;t=t.parentElement}return!0};t.prototype._exposeIfNeeded=function(e,t){return this.props.resources.isExposed(e)?this.props.resources.consume(e):this.props.resources.expose(e,t)};return t}(r.PureComponent);t.ItemsScopeAllPhoto=P;t.default=P});
define("@ms/items-view-addon-photos/lib/PhotosAddon",["require","exports","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/operations/getItems","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view-addon-graph/lib/models/keys/DriveItemKeyFacet","./models/keys/PhotosRootKeyFacet","./models/keys/PhotosRootItemSetKeyFacet","./models/keys/AllGroupToCountsItemKeyFacet","./models/keys/AllGroupToCountsPageKeyFacet","./models/keys/GroupKeyFacet","./models/keys/GroupPageKeyFacet","./handlers/operations/photosRoot/getItemsOperationHandler","./handlers/operations/photosRootItemSet/getItemsOperationHandler","./handlers/operations/group/getItemsOperationHandler","./handlers/operations/allGroupToCountsPage/getItemsOperationHandler","./handlers/operations/allGroupToCountsItem/getItemsOperationHandler","./handlers/operations/groupPage/getItemsOperationHandler","./handlers/operations/widths/getItemsOperationHandler","./handlers/operations/widthsPage/getItemsOperationHandler","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/facets/GroupFacets","@ms/items-view/lib/private/facets/ItemFacets","./models/facets/GroupToCountFacets","./models/facets/WidthsFacets","./models/facets/PhotoThumbnailSetFacet","./models/facets/PhotoLocationFacet","./models/keys/WidthsItemKeyFacet","./models/keys/WidthsPageKeyFacet","./handlers/controls/itemsBreadcrumbControlHandler","@ms/items-view/lib/private/controls/itemsBreadcrumbBetaControl"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.photosAddon=n.createAddon(function(){return function(e){e(r.supportFacets({keyFacet:o.photosRootKeyFacet,facets:[o.photosRootKeyFacet,w.defaultChildItemSetFacet]}));e(r.supportFacets({keyFacet:u.photosRootItemSetKeyFacet,facets:[u.photosRootItemSetKeyFacet,x.allGroupToCountsPointerFacet,T.widthsPointerFacet,w.childItemsFacet,E.isGroupFacet]}));e(r.supportFacets({keyFacet:l.groupKeyFacet,facets:[l.groupKeyFacet,S.displayNameFacet,w.childItemsFacet,w.childItemsFacet]}));e(r.supportFacets({keyFacet:c.groupPageKeyFacet,facets:[w.pageFacet,w.childItemsFacet]}));e(r.supportFacets({keyFacet:s.driveItemKeyFacet,facets:[s.driveItemKeyFacet,S.deletedFacet,S.displayNameFacet,N.photoThumbnailSetFacet,C.photoLocationFacet]}));e(r.supportFacets({keyFacet:a.allGroupToCountsItemKeyFacet,facets:[x.allGroupToCountsFacet,w.childItemsFacet,x.allGroupsTotalCountFacet]}));e(r.supportFacets({keyFacet:f.allGroupToCountsPageKeyFacet,facets:[w.pageFacet,w.childItemsFacet]}));e(r.supportFacets({keyFacet:k.widthsItemKeyFacet,facets:[T.targetHeightFacet,T.widthsFacet,w.childItemsFacet]}));e(r.supportFacets({keyFacet:L.widthsPageKeyFacet,facets:[w.pageFacet,w.childItemsFacet]}));e(n.registerOperationHandler(o.photosRootKeyFacet,r.getItemsOperation)(h.PhotosRootItemOperationHandler));e(n.registerOperationHandler(u.photosRootItemSetKeyFacet,r.getItemsOperation)(p.PhotosRootItemSetOperationHandler));e(n.registerOperationHandler(l.groupKeyFacet,r.getItemsOperation)(d.GroupItemOperationHandler));e(n.registerOperationHandler(c.groupPageKeyFacet,r.getItemsOperation)(g.GroupPageItemOperationHandler));e(n.registerOperationHandler(a.allGroupToCountsItemKeyFacet,r.getItemsOperation)(m.allGroupToCountsItemOperationHandler));e(n.registerOperationHandler(f.allGroupToCountsPageKeyFacet,r.getItemsOperation)(v.allGroupToCountsPageItemOperationHandler));e(n.registerOperationHandler(k.widthsItemKeyFacet,r.getItemsOperation)(y.WidthsItemOperationHandler));e(n.registerOperationHandler(L.widthsPageKeyFacet,r.getItemsOperation)(b.WidthsPageItemOperationHandler));e(i.registerControlHandler(u.photosRootItemSetKeyFacet,O.itemsBreadcrumbBetaControl)(A.itemsBreadcrumbControlHandler))}})});
define("@ms/items-view-addon-photos/lib/models/keys/AllGroupToCountsItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./PhotosRootItemSetKeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.allGroupToCountsItemKeyFacet=new n.KeyFacet("allGroupToCountsItemKeyFacet",{photosRootItemSetKeyPart:n.subKeyPart(r.photosRootItemSetKeyFacet)})});
define("@ms/items-view-addon-photos/lib/models/keys/AllGroupToCountsPageKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./AllGroupToCountsItemKeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.allGroupToCountsPageKeyFacet=new n.KeyFacet("allPhotosGroupToCountItemPageFacet",{groupToCountsItemKeyPart:n.subKeyPart(r.allGroupToCountsItemKeyFacet),pageToken:n.stringPart()})});
define("@ms/items-view-addon-photos/lib/models/keys/GroupKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./PhotosRootItemSetKeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupKeyFacet=new n.KeyFacet("allPhotosGroup",{photosRootItemSetKeyPart:n.subKeyPart(r.photosRootItemSetKeyFacet),label:n.stringPart()})});
define("@ms/items-view-addon-photos/lib/models/keys/GroupPageKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./GroupKeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupPageKeyFacet=new n.KeyFacet("allPhotoGroupPage",{groupKeyPart:n.subKeyPart(r.groupKeyFacet),offset:n.numberPart(),count:n.numberPart()})});
define("@ms/items-view-addon-photos/lib/handlers/operations/photosRoot/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/facets/SetFacets","../../../models/keys/PhotosRootKeyFacet","../../../models/keys/PhotosRootItemSetKeyFacet","../../../models/interfaces/EAllPhotosGroupBy"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PhotosRootItemOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,f=o.photosRootKeyFacet.deserialize(r),l=f.driveId,c=f.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,f,h;return n.__generator(this,function(p){f=u.photosRootItemSetKeyFacet.serialize({photosRootKeyPart:{driveId:l,endpoint:c},groupBy:a.EAllPhotosGroupBy.Date,filter:"root",filterType:"folder"});(h=new i.ItemResolver).resolveItems({items:(t={},t[r]=n.__assign({},o.photosRootKeyFacet.pack({driveId:l,endpoint:c}),s.defaultChildItemSetFacet.pack({itemKey:f})),t)});e(h.execute());return[2]})})}})});
define("@ms/items-view-addon-photos/lib/handlers/operations/photosRootItemSet/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/facets/GroupFacets","@ms/items-view/lib/private/operations/invalidateItems","../../../models/keys/PhotosRootItemSetKeyFacet","../../../models/keys/AllGroupToCountsItemKeyFacet","../../../models/facets/GroupToCountFacets","../../../models/facets/WidthsFacets","../../../models/keys/WidthsItemKeyFacet","../../../PhotosAddonConfig","../../helpers/resolveMetadataBurstHelper","../../../models/facets/PhotosMetadataBurstFacet","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/facets/SetFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PhotosRootItemSetOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,y=a.photosRootItemSetKeyFacet.deserialize(r),b=y.photosRootKeyPart,w=y.groupBy,E=y.filter,S=y.filterType;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,y,x,T,N,C,k,L,A,O;return n.__generator(this,function(M){switch(M.label){case 0:y=new s.ItemResolver;x=f.allGroupToCountsItemKeyFacet.serialize({photosRootItemSetKeyPart:{photosRootKeyPart:b,groupBy:w,filter:E,filterType:S}});T=h.widthsItemKeyFacet.serialize({photosRootItemSetKeyPart:{photosRootKeyPart:b,groupBy:w,filter:E,filterType:S}});y.resolveItems({items:(t={},t[r]=n.__assign({},m.displayNameFacet.pack(""),a.photosRootItemSetKeyFacet.pack({photosRootKeyPart:b,groupBy:w,filter:E,filterType:S}),l.allGroupToCountsPointerFacet.pack({itemKey:x}),c.widthsPointerFacet.pack({itemKey:T}),o.isGroupFacet.pack(!0),u.getInvalidationFacet().forFacet(c.widthsPointerFacet).thenInvalidate(T,c.targetHeightFacet).forFacet(l.allGroupToCountsPointerFacet).thenInvalidate(x,l.allGroupToCountsFacet).forFacet(g.childItemsFacet).thenInvalidate(r,l.allGroupToCountsPointerFacet).forFacet(g.childItemsFacet).thenInvalidate(r,c.widthsPointerFacet).pack()),t[x]=n.__assign({},l.allGroupsTotalCountFacet.pack(100)),t)});return[4,e(i.readItems(function(e){return{hasBurst:void 0!==e.demandItemFacet(v.photosMetadataBurstFacet,r),burstSize:e.demandItemFacet(p.photosInitialBurstSizeFacet,p.photosConfigurationKey),addonSrc:e.demandItemFacet(p.photosAddonDataSourceFacet,p.photosConfigurationKey),targetHeight:e.demandItemFacet(p.photosTargetHeightConfigFacet,p.photosConfigurationKey)}}))];case 1:N=M.sent(),C=N.burstSize,k=N.addonSrc,L=N.hasBurst,A=N.targetHeight;return!L&&C&&k&&A&&"folder"===S?[4,k.getPhotoRecordsForBurstMode(C,E,b.driveId)]:[3,3];case 2:(O=M.sent()).length>0&&y.merge(d.resolveMetadataBurstHelper(r,O,A));M.label=3;case 3:e(y.execute());return[2]}})})}})});
define("@ms/items-view-addon-photos/lib/models/facets/GroupToCountFacets",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.allGroupToCountsFacet=new n.Facet("allGroupToCountsFacet");t.allGroupToCountsPointerFacet=new n.Facet("allGroupToCountsPointerFacet");t.allGroupsTotalCountFacet=new n.Facet("AllPhotosTotalCount")});
define("@ms/items-view-addon-photos/lib/models/facets/WidthsFacets",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.widthsFacet=new n.Facet("widthsFacet");t.widthsPointerFacet=new n.Facet("widthsPointerFacet");t.targetHeightFacet=new n.Facet("targetHeightFacet")});
define("@ms/items-view-addon-photos/lib/models/keys/WidthsItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./PhotosRootItemSetKeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.widthsItemKeyFacet=new n.KeyFacet("widthsItemKeyFacet",{photosRootItemSetKeyPart:n.subKeyPart(r.photosRootItemSetKeyFacet)})});
define("@ms/items-view-addon-photos/lib/PhotosAddonConfig",["require","exports","tslib","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/models/KeyFacet","@ms/items-view/lib/private/operations/getItems","@ms/items-view/lib/private/operations/pruneItems"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.photosConfigurationKeyFacet=new i.KeyFacet("photosConfigurationKeyFacet",{});t.photosConfigurationKey=t.photosConfigurationKeyFacet.serialize({});t.photosAddonDataSourceFacet=new r.Facet("PhotosAddonSource");t.photosGroupPageSizeFacet=new r.Facet("PhotosMaxPageSize");t.photosWidthsPageSizeFacet=new r.Facet("PhotosWidthsMaxPageSize");t.photosInitialBurstSizeFacet=new r.Facet("PhotosInitialBurstSize");t.photosTargetHeightConfigFacet=new r.Facet("PhotosTargetHeight");t.registerAllPhotosConfig=function(e,r,i,u,a,f){void 0===u&&(u=0);void 0===a&&(a=1e3);void 0===f&&(f=1e3);var l,c;e.dispatch(s.supportFacets({keyFacet:t.photosConfigurationKeyFacet,facets:[]}));e.dispatch(s.resolveItems({items:(l={},l[t.photosConfigurationKey]=n.__assign({},t.photosAddonDataSourceFacet.pack(r),t.photosGroupPageSizeFacet.pack(i),t.photosInitialBurstSizeFacet.pack(u),t.photosWidthsPageSizeFacet.pack(a),t.photosTargetHeightConfigFacet.pack(f)),l)}));e.dispatch(o.registerPermanentItemDemands({items:(c={},c[t.photosConfigurationKey]={},c)}))}});
define("@ms/items-view-addon-photos/lib/handlers/helpers/resolveMetadataBurstHelper",["require","exports","tslib","@ms/items-view/lib/private/models/items/ItemResolver","../../models/facets/PhotosMetadataBurstFacet","../../util/generateWidthsFromRecords","../../util/generateGroupToCountFromRecords"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resolveMetadataBurstHelper=function(e,t,u){var a,f=new r.ItemResolver,l=o.generateGroupToCountFromRecords(t),c=s.generateWidthsFromRecords(u,t);f.resolveItems({items:(a={},a[e]=n.__assign({},i.photosMetadataBurstFacet.pack({records:t,groupToCount:l,widths:c,targetHeight:u})),a)});return f}});
define("@ms/items-view-addon-photos/lib/models/facets/PhotosMetadataBurstFacet",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.photosMetadataBurstFacet=new n.Facet("PhotosMetadataBurst")});
define("@ms/items-view-addon-photos/lib/util/generateWidthsFromRecords",["require","exports","./typedArrayUtils"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.generateWidthsFromRecords=function(e,t){var r=n.makeUint16Array(t.length);t.map(function(t,n){var i=t.thumbnails[t.thumbnails.length-1];if(i){var s=Math.round(e*(i.width/i.height));r[n]=s}});return r}});
define("@ms/items-view-addon-photos/lib/util/typedArrayUtils",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e){var t=new ArrayBuffer(2*e);return new Uint16Array(t)}t.makeUint16Array=n;t.resizeUint16Array=function(e,t){for(var r=n(t),i=Math.min(e.length,t),s=0;s<i;s++)r[s]=e[s];return r}});
define("@ms/items-view-addon-photos/lib/util/generateGroupToCountFromRecords",["require","exports","./localeDateFormat","@ms/odsp-utilities/lib/dateTime/DateTime","@ms/items-view-utilities/lib/locale/Locale"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.generateGroupToCountFromRecords=function(e){for(var t=[],s=void 0,o=void 0,u=0,a=[],f=r.getBrowserSafeLocale(i.Locale.language),l=0;l<e.length;l++)if(s=e[l].dateTakenTime?e[l].dateTakenTime:0===e[l].dateTaken.length?0===l?new Date:e[l-1].dateTakenTime:new Date(e[l].dateTaken)){s=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),24,0,0,-1));a[l]=s;void 0===o&&(o=s);if(s.getUTCFullYear()!==o.getUTCFullYear()||s.getUTCMonth()!==o.getUTCMonth()||s.getUTCDate()!==o.getUTCDate()){t.push({labels:[o.toLocaleDateString(f,{month:"short",day:"numeric",year:"numeric"}),o.getUTCMonth().toString(),o.getUTCFullYear().toString()],count:u,header:s?n.localeDateFormat(o):""});u=0;o=s}u++}else console.error("Current Date was undefined.");u>0&&t.push({labels:[s?s.toLocaleDateString(f,{month:"short",day:"numeric",year:"numeric"}):"",s?s.getUTCMonth().toString():"",s?s.getUTCFullYear().toString():""],count:u,header:s?n.localeDateFormat(s):""});return t}});
define("@ms/items-view-addon-photos/lib/util/localeDateFormat",["require","exports","@ms/odsp-utilities/lib/dateTime/DateTime"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.localeDateFormat=function(e){return n.getFriendlyDateTimeStringPast(e,!1,!1,!1,{displayHoursInDates:!1,displayHoursToOneDay:!1,displayMinutesToOneHour:!1,displayShortenedWeekday:!1})}});
define("@ms/items-view-addon-photos/lib/handlers/operations/group/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/models/items/PageHelpers","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/facets/GroupFacets","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/operations/invalidateItems","../../../models/keys/PhotosRootItemSetKeyFacet","../../../models/keys/GroupKeyFacet","../../../models/keys/GroupPageKeyFacet","../../../models/facets/GroupToCountFacets","../../../PhotosAddonConfig","../../../models/interfaces/IGroupToCount","@ms/items-view/lib/private/operations/demandItems"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GroupItemOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,g=c.groupKeyFacet.deserialize(r),y=g.photosRootItemSetKeyPart,b=g.label;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,g,w,E,S,x,T,N,C,k,L,A,O,M,_,D;return n.__generator(this,function(P){switch(P.label){case 0:g=l.photosRootItemSetKeyFacet.serialize(y);return[4,e(m.demandItems(function(e){var t=e.demandItemFacet(d.photosGroupPageSizeFacet,d.photosConfigurationKey),n=e.demandItemFacet(p.allGroupToCountsPointerFacet,g);return{maxPageSize:t,groupToCount:n?e.demandItemFacet(p.allGroupToCountsFacet,n.itemKey):void 0}}))];case 1:w=P.sent(),E=w.maxPageSize;if((S=w.groupToCount)&&E){x=void 0;T=0;for(N=0,C=S;N<C.length;N++){k=C[N];if(v.getLabelsFromGroupToCount(k).join(";")===b){x=k;break}T+=k.count}if(x){L=new i.ItemResolver;A=[];O=x.count;M=T;for(;O>0;){_=O<E?O:E;D=h.groupPageKeyFacet.serialize({groupKeyPart:c.groupKeyFacet.deserialize(r),offset:M,count:_});A.push(D);L.merge(s.resolveNewPage({itemKey:D}).itemResolver);M+=_;O-=_}L.resolveItems({items:(t={},t[r]=n.__assign({},c.groupKeyFacet.pack({photosRootItemSetKeyPart:y,label:b}),a.displayNameFacet.pack(b),o.childItemsFacet.pack({itemKeys:A}),u.isGroupFacet.pack(!0),u.countFacet.pack(x.count),f.getInvalidationFacet().forFacet(o.childItemsFacet).thenInvalidate(g,p.allGroupToCountsPointerFacet).pack()),t)});e(L.execute())}else console.error("photosAddon: Unable to find the groupObject for label: ",b)}else console.error("photosAddon: Failed to get GroupByCount while resolving a GroupItemSet!");return[2]}})})}})});
define("@ms/items-view-addon-photos/lib/models/interfaces/IGroupToCount",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getLabelsFromGroupToCount=function(e){if(e.labels)return e.labels;if(e.label){var t=e.label.split(";");return[t[0],"",t.length>1?t[1]:""]}return["","",""]}});
define("@ms/items-view-addon-photos/lib/handlers/operations/allGroupToCountsPage/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/operations/demandItems","@ms/items-view/lib/private/facets/SetFacets","../../../models/keys/PhotosRootItemSetKeyFacet","../../../models/keys/AllGroupToCountsItemKeyFacet","../../../models/keys/AllGroupToCountsPageKeyFacet","../../../models/facets/GroupToCountFacets","../../../models/facets/WidthsFacets","../../../PhotosAddonConfig","../../helpers/resolveGroupToCountHelper","../../helpers/resolveNewWidthsPagesHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.allGroupToCountsPageItemOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,v=f.allGroupToCountsPageKeyFacet.deserialize(r),m=v.groupToCountsItemKeyPart,g=v.pageToken;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,f,v,y,b,w,E,S,x,T,N,C,k,L,A,O,M;return n.__generator(this,function(_){switch(_.label){case 0:f=a.allGroupToCountsItemKeyFacet.serialize(m);return[4,e(s.demandItems(function(e){return{addonSrc:e.demandItemFacet(h.photosAddonDataSourceFacet,h.photosConfigurationKey),oldGroupToCount:e.demandItemFacet(l.allGroupToCountsFacet,f),oldTotalPhotoCount:e.demandItemFacet(l.allGroupsTotalCountFacet,f)}}))];case 1:v=_.sent(),y=v.addonSrc,b=v.oldGroupToCount,w=v.oldTotalPhotoCount;if(!(y&&b&&w))return[3,5];E=m.photosRootItemSetKeyPart;S=new i.ItemResolver;return[4,y.getGroupToCount(E.groupBy,E.filter,E.photosRootKeyPart.driveId,g,E.filterType)];case 2:x=_.sent();S.merge(p.resolveGroupToCountHelper(f,x,!1,b));S.resolveItems({items:(t={},t[r]=n.__assign({},o.pageFacet.pack({}),o.childItemsFacet.pack(void 0)),t)});return[4,e(S.execute())];case 3:_.sent();T=new i.ItemResolver;return[4,e(s.demandItems(function(e){var t=e.demandItemFacet(l.allGroupsTotalCountFacet,f),n=e.demandItemFacet(c.widthsPointerFacet,u.photosRootItemSetKeyFacet.serialize(E)),r=n?e.demandItemFacet(o.childItemsFacet,n.itemKey):void 0,i=e.demandItemFacet(h.photosWidthsPageSizeFacet,h.photosConfigurationKey);return{newTotalPhotoCount:t,widthsItemKey:n?n.itemKey:void 0,widthsChildItems:r,widthsPageSize:i}}))];case 4:N=_.sent(),C=N.newTotalPhotoCount,k=N.widthsItemKey,L=N.widthsChildItems,A=N.widthsPageSize;if(C&&k&&L&&A){if(C>w){O=C-w;M=w;T.merge(d.resolveNewWidthsPagesHelper(k,O,M,A,L.itemKeys))}}else console.warn("Expanded GroupToCount page but was unable to get a new total photo count value or widths child items!");e(T.execute());_.label=5;case 5:return[2]}})})}})});
define("@ms/items-view-addon-photos/lib/handlers/helpers/resolveGroupToCountHelper",["require","exports","tslib","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/models/items/PageHelpers","@ms/items-view/lib/private/utilities/Graft","@ms/items-view/lib/private/facets/GroupFacets","@ms/items-view/lib/private/operations/invalidateItems","../../models/keys/PhotosRootItemSetKeyFacet","../../models/keys/GroupKeyFacet","../../models/keys/AllGroupToCountsItemKeyFacet","../../models/keys/AllGroupToCountsPageKeyFacet","../../models/facets/GroupToCountFacets","../../models/interfaces/IGroupToCount"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resolveGroupToCountHelper=function(e,t,m,g){void 0===g&&(g=[]);var y,b,w,E,S,x=new r.ItemResolver;if(h.allGroupToCountsItemKeyFacet.matches(e)){for(var T=h.allGroupToCountsItemKeyFacet.deserialize(e).photosRootItemSetKeyPart,N=function(e,t){var n=[];if(e.length>0&&t.length>0)if(v.getLabelsFromGroupToCount(e[e.length-1]).join(";")===v.getLabelsFromGroupToCount(t[0]).join(";")){e[e.length-1].count+=t[0].count;n=e.slice();t.length>1&&(n=n.concat(t.slice(1)))}else n=(n=e.slice()).concat(t);0===n.length&&(n=e.length>0?e.slice():t.slice());return n}(g,t.counts),C=0,k=[],L=f.getInvalidationFacet(),A=0,O=N;A<O.length;A++){var M=O[A];C+=M.count;var _=c.groupKeyFacet.serialize({photosRootItemSetKeyPart:T,label:v.getLabelsFromGroupToCount(M).join(";")});k.push(_);L=L.forFacet(s.childItemsFacet).thenInvalidate(_,s.childItemsFacet)}if(t.pageToken){var D=p.allGroupToCountsPageKeyFacet.serialize({groupToCountsItemKeyPart:{photosRootItemSetKeyPart:T},pageToken:t.pageToken});x.merge(o.resolveNewPage({itemKey:D}).itemResolver);x.resolveItems({items:(y={},y[e]=n.__assign({},s.childItemsFacet.pack({itemKeys:[D]})),y)})}else x.resolveItems({items:(b={},b[e]=n.__assign({},s.childItemsFacet.pack({itemKeys:[]})),b)});var P=l.photosRootItemSetKeyFacet.serialize(T);m?x.resolveItems({items:(w={},w[P]=n.__assign({},s.childItemsFacet.pack({itemKeys:k})),w)}):x.resolveItems({items:(E={},E[P]=i.pack({childItems:s.childItemsFacet},{childItems:{itemKeys:new u.ArrayConcatIfNotMatchKeyPatch(k,function(e){return e})}}),E)});x.resolveItems({items:(S={},S[e]=n.__assign({},d.allGroupToCountsFacet.pack(N),d.allGroupsTotalCountFacet.pack(C)),S[P]=n.__assign({},a.countFacet.pack(N.length),L.pack()),S)})}else console.warn("Key ",e," was not a valid AllPhotosGroupToCountItemKey. Unable to resolve GroupToCount!");return x}});
define("@ms/items-view-addon-photos/lib/handlers/helpers/resolveNewWidthsPagesHelper",["require","exports","tslib","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/models/items/PageHelpers","@ms/items-view/lib/private/facets/SetFacets","../../models/keys/WidthsItemKeyFacet","../../models/keys/WidthsPageKeyFacet"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resolveNewWidthsPagesHelper=function(e,t,a,f,l){void 0===l&&(l=[]);var c,h=new r.ItemResolver;if(o.widthsItemKeyFacet.matches(e)){for(var p=o.widthsItemKeyFacet.deserialize(e).photosRootItemSetKeyPart,d=l.slice(),v=t,m=a;v>0;){var g=v<f?v:f,y=u.widthsPageKeyFacet.serialize({widthsItemKeyPart:{photosRootItemSetKeyPart:p},offset:m,count:g});m+=g;d.push(y);h.merge(i.resolveNewPage({itemKey:y}).itemResolver);v-=g}h.resolveItems({items:(c={},c[e]=n.__assign({},s.childItemsFacet.pack({itemKeys:d})),c)})}else console.warn("resolveWidthsHelper was not passed a valid WidthsItemKey!");return h}});
define("@ms/items-view-addon-photos/lib/models/keys/WidthsPageKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./WidthsItemKeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.widthsPageKeyFacet=new n.KeyFacet("AllPhotosWidthsItemPageKeyFacet",{widthsItemKeyPart:n.subKeyPart(r.widthsItemKeyFacet),offset:n.numberPart(),count:n.numberPart()})});
define("@ms/items-view-addon-photos/lib/handlers/operations/allGroupToCountsItem/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/facets/SetFacets","../../../models/keys/AllGroupToCountsItemKeyFacet","../../../PhotosAddonConfig","../../helpers/resolveGroupToCountHelper","@ms/items-view/lib/private/operations/invalidateItems","../../../models/facets/GroupToCountFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.allGroupToCountsItemOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,h=u.allGroupToCountsItemKeyFacet.deserialize(r).photosRootItemSetKeyPart;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,p,d;return n.__generator(this,function(v){switch(v.label){case 0:return[4,e(s.readItems(function(e){return e.demandItemFacet(a.photosAddonDataSourceFacet,a.photosConfigurationKey)}))];case 1:if(!(u=v.sent()))return[3,3];p=new i.ItemResolver;return[4,u.getGroupToCount(h.groupBy,h.filter,h.photosRootKeyPart.driveId,void 0,h.filterType)];case 2:d=v.sent();p.merge(f.resolveGroupToCountHelper(r,d,!0));p.resolveItems({items:(t={},t[r]=n.__assign({},l.getInvalidationFacet().forFacet(c.allGroupToCountsFacet).thenInvalidate(r,o.childItemsFacet).forFacet(c.allGroupToCountsFacet).thenInvalidate(r,c.allGroupsTotalCountFacet).pack()),t)});e(p.execute());v.label=3;case 3:return[2]}})})}})});
define("@ms/items-view-addon-photos/lib/handlers/operations/groupPage/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/operations/demandItems","../../../models/keys/PhotosRootItemSetKeyFacet","../../../models/keys/GroupPageKeyFacet","../../../models/facets/GroupToCountFacets","../../../PhotosAddonConfig","../../helpers/resolvePhotoRecordsHelper"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GroupPageItemOperationHandler=r.createSingleItemOperationHandler({maxQueueSize:2,prioritizeRecent:!0})(function(e){var t=this,r=e.itemKey,c=u.groupPageKeyFacet.deserialize(r),h=c.groupKeyPart,p=c.offset,d=h.photosRootItemSetKeyPart;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,u,c,h,v,m,g,y,b,w,E;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(s.demandItems(function(e){var t=e.demandItemFacet(f.photosAddonDataSourceFacet,f.photosConfigurationKey),n=e.demandItemFacet(f.photosGroupPageSizeFacet,f.photosConfigurationKey),r=e.demandItemFacet(a.allGroupToCountsPointerFacet,o.photosRootItemSetKeyFacet.serialize(d));return{addonSrc:t,maxPageSize:n,totalPhotoCount:r?e.demandItemFacet(a.allGroupsTotalCountFacet,r.itemKey):void 0,groupToCount:r?e.demandItemFacet(a.allGroupToCountsFacet,r.itemKey):void 0,targetHeight:e.demandItemFacet(f.photosTargetHeightConfigFacet,f.photosConfigurationKey)}}))];case 1:t=n.sent(),r=t.addonSrc,u=t.maxPageSize,c=t.totalPhotoCount,h=t.groupToCount,v=t.targetHeight;if(!(r&&u&&c&&h&&v))return[3,4];m=p;g=Math.min(m+u,c);return[4,r.getPhotoRecords(m,g,d.filter,d.photosRootKeyPart.driveId,c,d.filterType)];case 2:y=n.sent();b=new i.ItemResolver;E=(w=b).merge;return[4,l.resolvePhotoRecordsHelper(y,e,o.photosRootItemSetKeyFacet.serialize(d),h,p,v)];case 3:E.apply(w,[n.sent()]);e(b.execute());n.label=4;case 4:return[2]}})})}})});
define("@ms/items-view-addon-photos/lib/handlers/helpers/resolvePhotoRecordsHelper",["require","exports","tslib","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/operations/demandItems","@ms/items-view/lib/private/models/items/PageHelpers","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/operations/invalidateItems","@ms/items-view-addon-graph/lib/models/keys/DriveItemKeyFacet","@ms/items-view-addon-graph/lib/models/keys/DriveItemSetKeyFacet","../../models/keys/PhotosRootItemSetKeyFacet","../../models/keys/GroupKeyFacet","../../models/keys/GroupPageKeyFacet","../../models/facets/PhotoThumbnailSetFacet","../../models/facets/PhotoLocationFacet","../../models/keys/WidthsItemKeyFacet","@ms/items-view/lib/private/facets/MediaFacets","../../models/interfaces/IGroupToCount","../../models/facets/PhotoRotationFacet","../../models/facets/WidthsFacets","../../models/facets/WidthsFacets","@ms/items-view/lib/private/operations/readItems"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function x(e,t,r,i,s,o,u,a){return n.__awaiter(this,void 0,void 0,function(){var f,l,c,h,p,d;return n.__generator(this,function(v){switch(v.label){case 0:l=m.widthsItemKeyFacet.serialize({photosRootItemSetKeyPart:{photosRootKeyPart:t,groupBy:r,filter:i,filterType:s}});return[4,e(S.readItems(function(e){return{widths:e.demandItemFacet(E.widthsFacet,l)}}))];case 1:if(c=v.sent().widths){h=Math.max(c.length,u.length+a);(p=new Uint16Array(h)).set(c);c=p}else c=new Uint16Array(u.length+a);if(c){for(d=0;d<u.length;++d)c[d+a]=u[d];o.resolveItems({items:(f={},f[l]=n.__assign({},E.widthsFacet.pack(c)),f)})}return[2]}})})}t.resolvePhotoRecordsHelper=function(e,t,m,E,S,T){return n.__awaiter(this,void 0,void 0,function(){var N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K;return n.__generator(this,function(Q){switch(Q.label){case 0:k=new r.ItemResolver;if(!e.length||!c.photosRootItemSetKeyFacet.matches(m))return[3,3];L=c.photosRootItemSetKeyFacet.deserialize(m),A=L.photosRootKeyPart,O=L.groupBy,M=L.filter,_=L.filterType;D=S;P=new Map;H=new Uint16Array(e.length);B=0;j=0;for(F=0;F<e.length;++F){I=e[F];q=I.thumbnails[I.thumbnails.length-1];R=Math.round(T*q.width/q.height);H[F]=R;U=f.driveItemKeyFacet.serialize({itemId:I.id,driveId:A.driveId,endpoint:A.endpoint});z=F+D;W=void 0;for(;B<E.length;++B){X=E[B];V=j+X.count;if(z>=j&&z<V){W=h.groupKeyFacet.serialize({photosRootItemSetKeyPart:{photosRootKeyPart:A,groupBy:O,filter:M,filterType:_},label:y.getLabelsFromGroupToCount(X).join(";")});if($=P.get(X)){$.newChildKeys.push(U);$.newChildIndices.push(z)}else P.set(X,{key:W,label:y.getLabelsFromGroupToCount(X).join(";"),startIdx:j,endIdx:V,newChildKeys:[U],newChildIndices:[z],curChildKeysIdx:-1});break}j+=X.count}W&&k.resolveItems({items:(N={},N[U]=n.__assign({},f.driveItemKeyFacet.pack({itemId:I.id,driveId:A.driveId,endpoint:A.endpoint}),d.photoThumbnailSetFacet.pack(I.thumbnails),u.displayNameFacet.pack(I.name),u.fileNameFacet.pack({name:I.name,extension:I.extension?I.extension:""}),u.canonicalUrlFacet.pack(I.originalUrl),v.photoLocationFacet.pack(I.location),b.photoRotationFacet.pack(void 0),u.deletedFacet.pack(void 0),o.defaultChildItemSetFacet.pack({itemKey:l.driveItemSetKeyFacet.serialize({driveItemKey:f.driveItemKeyFacet.deserialize(U),sortBy:"",isAscending:!0})}),a.getInvalidationFacet().forFacet(u.deletedFacet).thenInvalidate(W,o.childItemsFacet).forFacet(u.deletedFacet).thenInvalidate(m,w.widthsPointerFacet).forFacet(o.defaultChildItemSetFacet).thenInvalidate(U,b.photoRotationFacet).forFacet(o.defaultChildItemSetFacet).thenInvalidate(U,u.displayNameFacet).forFacet(o.defaultChildItemSetFacet).thenInvalidate(U,d.photoThumbnailSetFacet).forFacet(d.photoThumbnailSetFacet).thenInvalidate(W,o.childItemsFacet).forFacet(b.photoRotationFacet).thenInvalidate(W,o.childItemsFacet).forFacet(b.photoRotationFacet).thenInvalidate(m,w.widthsPointerFacet).pack()),N)});I.isVideo&&k.resolveItems({items:(C={},C[U]=n.__assign({},g.videoFacet.pack({})),C)})}return[4,x(t,A,O,M,_,k,H,D)];case 1:Q.sent();J=[];P.forEach(function(e){var n=t(i.demandItems(function(t){var n=t.demandItemFacet(o.childItemsFacet,e.key);if(n)return n.itemKeys})),r=J.push(n);e.curChildKeysIdx=r-1});return[4,Promise.all(J)];case 2:K=Q.sent();P.forEach(function(e){var t=0,n=new Map;if(e.curChildKeysIdx>=0){var r=K[e.curChildKeysIdx];if(r)for(var i=0,o=r;i<o.length;i++){var u=o[i];if(p.groupPageKeyFacet.matches(u)){var a=p.groupPageKeyFacet.deserialize(u),f=a.offset,l=a.count;if(f<D)continue;for(var c=[],h=Math.min(e.newChildKeys.length-t,l),d=0;d<h;++d){var v=f+d;e.newChildIndices[t]===v&&c.push(e.newChildKeys[t++])}if(c.length>0){if(l>h){var m=p.groupPageKeyFacet.serialize({groupKeyPart:{photosRootItemSetKeyPart:{photosRootKeyPart:A,groupBy:O,filter:M,filterType:_},label:e.label},offset:f+h,count:l-h});c.push(m);k.merge(s.resolveNewPage({itemKey:m}).itemResolver)}n.set(u,c)}if(t>=e.newChildKeys.length)break}}}n.forEach(function(t,n){k.merge(s.resolveExistingPage({itemKey:n,itemSetKey:e.key,childItemKeys:t}).itemResolver)})});Q.label=3;case 3:return[2,k]}})})}});
define("@ms/items-view-addon-photos/lib/models/facets/PhotoThumbnailSetFacet",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.photoThumbnailSetFacet=new n.Facet("PhotoThumbnailSet")});
define("@ms/items-view-addon-photos/lib/models/facets/PhotoLocationFacet",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.photoLocationFacet=new n.Facet("PhotoLocation")});
define("@ms/items-view-addon-photos/lib/models/facets/PhotoRotationFacet",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.photoRotationFacet=new n.Facet("PhotoRotation")});
define("@ms/items-view-addon-photos/lib/handlers/operations/widths/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/operations/demandItems","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/operations/invalidateItems","../../../PhotosAddonConfig","../../../models/keys/WidthsItemKeyFacet","../../../models/keys/AllGroupToCountsItemKeyFacet","../../../models/facets/GroupToCountFacets","../../../models/facets/WidthsFacets","../../helpers/resolveNewWidthsPagesHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WidthsItemOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,d=f.widthsItemKeyFacet.deserialize(r).photosRootItemSetKeyPart;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,f,v,m,g,y,b,w,E,S;return n.__generator(this,function(x){switch(x.label){case 0:return[4,e(s.demandItems(function(e){var t=e.demandItemFacet(a.photosAddonDataSourceFacet,a.photosConfigurationKey),n=e.demandItemFacet(c.allGroupsTotalCountFacet,l.allGroupToCountsItemKeyFacet.serialize({photosRootItemSetKeyPart:d}));return{addonSrc:t,totalPhotoCount:n||0,widthsPageSize:e.demandItemFacet(a.photosWidthsPageSizeFacet,a.photosConfigurationKey),targetHeight:e.demandItemFacet(a.photosTargetHeightConfigFacet,a.photosConfigurationKey)}}))];case 1:f=x.sent(),v=f.addonSrc,m=f.totalPhotoCount,g=f.widthsPageSize,y=f.targetHeight;if(!(v&&g&&y))return[3,3];b=new i.ItemResolver;return[4,v.getWidths(0,g,y,d.filter,d.photosRootKeyPart.driveId,m,d.filterType)];case 2:w=x.sent();b.resolveItems({items:(t={},t[r]=n.__assign({},h.targetHeightFacet.pack(y),h.widthsFacet.pack(w),u.getInvalidationFacet().forFacet(h.targetHeightFacet).thenInvalidate(r,h.widthsFacet).forFacet(h.targetHeightFacet).thenInvalidate(r,o.childItemsFacet).pack()),t)});E=m-w.length;S=w.length;b.merge(p.resolveNewWidthsPagesHelper(r,E,S,g));e(b.execute());x.label=3;case 3:return[2]}})})}})});
define("@ms/items-view-addon-photos/lib/handlers/operations/widthsPage/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/operations/demandItems","@ms/items-view/lib/private/models/items/PageHelpers","../../../PhotosAddonConfig","../../../models/keys/WidthsPageKeyFacet","../../../models/keys/AllGroupToCountsItemKeyFacet","../../../models/keys/WidthsItemKeyFacet","../../../models/facets/WidthsFacets","../../../models/facets/GroupToCountFacets","../../../util/typedArrayUtils"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WidthsPageItemOperationHandler=r.createSingleItemOperationHandler({maxQueueSize:0,prioritizeRecent:!0})(function(e){var t=this,r=e.itemKey,d=a.widthsPageKeyFacet.deserialize(r),v=d.widthsItemKeyPart,m=d.offset,g=d.count,y=v.photosRootItemSetKeyPart;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,d,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D;return n.__generator(this,function(P){switch(P.label){case 0:d=l.widthsItemKeyFacet.serialize(v);return[4,e(s.demandItems(function(e){var t=e.demandItemFacet(u.photosAddonDataSourceFacet,u.photosConfigurationKey),n=e.demandItemFacet(c.widthsFacet,d),r=e.demandItemFacet(c.targetHeightFacet,d),i=e.demandItemFacet(h.allGroupsTotalCountFacet,f.allGroupToCountsItemKeyFacet.serialize({photosRootItemSetKeyPart:y}));return{addonSrc:t,currentWidths:n,currentTargetHeight:r,totalPhotoCount:i||0}}))];case 1:b=P.sent(),w=b.addonSrc,E=b.currentTargetHeight,S=b.totalPhotoCount;if(!w||!E)return[3,4];x=new i.ItemResolver;T=m;N=m+g;return[4,w.getWidths(T,N,E,v.photosRootItemSetKeyPart.filter,v.photosRootItemSetKeyPart.photosRootKeyPart.driveId,S,v.photosRootItemSetKeyPart.filterType)];case 2:C=P.sent();return[4,e(s.demandItems(function(e){return{currentWidths:e.demandItemFacet(c.widthsFacet,d)}}))];case 3:if(k=P.sent().currentWidths){N=T+C.length;L=N>k.length?p.resizeUint16Array(k,N):k.subarray(0);for(A=0;A<C.length;A++){0!==L[O=T+A]&&L[O]!==C[A]&&console.warn("Widths value at index: ",O," is being stomped!");L[O]=C[A]}x.resolveItems({items:(t={},t[d]=n.__assign({},c.widthsFacet.pack(L)),t)});M=[];if((_=g-C.length)>0){D=a.widthsPageKeyFacet.serialize({widthsItemKeyPart:v,offset:N,count:_});M.push(D);x.merge(o.resolveNewPage({itemKey:D}).itemResolver)}x.merge(o.resolveExistingPage({itemKey:r,itemSetKey:d,childItemKeys:M}).itemResolver);e(x.execute())}P.label=4;case 4:return[2]}})})}})});
define("@ms/items-view-addon-photos/lib/handlers/controls/itemsBreadcrumbControlHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerControlHandler","../../models/keys/PhotosRootItemSetKeyFacet"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ALLPLACES_GEOLOCATION_DELIMITER=String.fromCharCode(9);t.itemsBreadcrumbControlHandler=r.createControlHandler()(function(){return function(){return s}});function s(e,t){return{leafItemKey:t.itemKey,crumbControlHandler:function(e,t){var n=e.demandItemFacet(i.photosRootItemSetKeyFacet,t.itemKey);if(n)n.filter;return{}}}}});
define("odsp-next/controls/list/allphoto2/src/itemsscope/SkyAPIAddonSource",["require","exports","tslib","@ms/items-view-addon-photos/lib/util/localeDateFormat","@ms/items-view-addon-photos/lib/util/generateWidthsFromRecords","../../../../../dataSources/base/odc/DataRequest","@ms/odsp-utilities/lib/uri/Uri","../../../../../dataSources/url/odc/UrlDataSource"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){this._groupToCount=[];this._groupToCountDate=[];this._photos=[];this._timestamps=[];e&&(this._dataRequestType=e)}e.prototype.updateResource=function(e){};e.prototype.getWidths=function(e,t,r,s,o,u){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,this._loadPhotoMetadata(s)];case 1:e.sent();this._widths=i.generateWidthsFromRecords(r,this._photos);return[2,this._widths]}})})};e.prototype.getGroupToCount=function(e,t,r,i){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,this._loadPhotoMetadata(t)];case 1:e.sent();return[2,{counts:this._groupToCount}]}})})};e.prototype.getPhotoRecordsForBurstMode=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this.getPhotoRecords(0,e,t,r,-1)]})})};e.prototype.getPhotoRecords=function(e,t,r,i,s){return n.__awaiter(this,void 0,void 0,function(){var i,s,o,u,a,f,l,c,h,p;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._getStartDate(e,r)];case 1:i=n.sent(),s=i.date,o=i.index;u=e-o;a=0;f=[];l=Math.min(250,t-e+u);c=this._getPhotosQueryURL(l,r)+"&startDate="+s.toISOString();n.label=2;case 2:return a<t-e?[4,this._makeQuery(c)]:[3,4];case 3:if(!(h=n.sent())){console.error("Did not receive a response while requesting photos for the SkyAPI");return[3,4]}if(h.error){console.error("Received an error response from SkyAPI, it's likely that the auth data has expired. Please relaunch the proxy server with updated credentials.");return[3,4]}for(p=u;p<h.items.length;++p)f.push(this._convertPhoto(h.items[p]));if(h.items.length<l)return[3,4];a+=h.items.length-u;u=0;l-=a;c=this._getPhotosQueryURL(l,r,h.pastPagingToken);return[3,2];case 4:return[2,f]}})})};e.prototype.getIsSamsungFolderAvailable=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){throw"Not implemented"})})};e.prototype._loadPhotoMetadata=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:this._loadingPromise||(this._loadingPromise=this._getAllUserPhotos(e));return[4,this._loadingPromise];case 1:t.sent();this._loadingPromise=void 0;return[2]}})})};e.prototype._getStartDate=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,i,s,o;return n.__generator(this,function(n){switch(n.label){case 0:r=0;i=-1;s=0;return[4,this._loadPhotoMetadata(t)];case 1:n.sent();for(o=0;o<this._groupToCount.length;o++){if((r+=this._groupToCount[o].count)>e){i=o;break}s=r}if(i>=0)return[2,{date:this._groupToCountDate[i],index:s}];throw new Error("Index "+e+" is not a valid item")}})})};e.prototype._makeQuery=function(e){var t=this._dataRequestType?new this._dataRequestType:new s.default,n=new o.default(e);return t.send({apiName:"AllPhotos",url:n.toString()})};e.prototype._timeStampToDate=function(e){var t=e;null==t&&(t="0000-00-00T12:00:00.000");"Z"!==t.charAt(t.length-1)&&(t+="Z");return new Date(t)};e.prototype._generateGroupToCount=function(e){for(var t=[],n=[],i=void 0,s=void 0,o=0,u=0;u<e.length;u++){i=e[u];i=new Date(Date.UTC(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),24,0,0,-1));void 0===s&&(s=i);if(i.getUTCFullYear()!==s.getUTCFullYear()||i.getUTCMonth()!==s.getUTCMonth()||i.getUTCDate()!==s.getUTCDate()){t.push({labels:[r.localeDateFormat(s),s.getUTCMonth().toString(),s.getUTCFullYear().toString()],count:o});s?n.push(s):n.push(new Date);o=0;s=i}o++}if(o>0){t.push({labels:i?[r.localeDateFormat(i),i.getUTCMonth().toString(),i.getUTCFullYear().toString()]:["","",""],count:o});i?n.push(i):n.push(new Date)}return{groupToCount:t,groupToCountDate:n}};e.prototype._convertPhoto=function(e){var t=0!==e.height?e.width/e.height:1,n=Math.min(32,e.height),r=Math.floor(n*t),i=Math.min(352,e.height),s=Math.floor(i*t);return{id:e.resId,thumbnails:[{url:e.thumbnailBaseUrl+"?psid=2&width="+r+"&height="+n,width:r,height:n},{url:e.thumbnailBaseUrl+"?psid=2&width="+s+"&height="+i,width:s,height:i},{url:e.thumbnailBaseUrl+"?psid=2&width="+e.width+"&height="+e.height,width:e.width,height:e.height}],name:e.name||"No Name",location:e.location,dateTaken:e.dateTaken.date,isVideo:!1}};e.prototype._processAllPhotosPage=function(e){for(var t=0;t<e.items.length;++t){var n=e.items[t];this._photos.push(this._convertPhoto(n));this._timestamps.push(this._timeStampToDate(n.dateTaken.isoDate))}};e.prototype._getPhotosQueryURL=function(e,t,n){return u.default.skyApiBaseUrl+"AllPhotos?"+(n?"pagingToken="+n+"&":"")+"ascending=0&pageSize="+e.toString()+"&rootItemId="+t+"&verbose=2"};e.prototype._getAllUserPhotos=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:this._timestamps=[];this._photos=[];t=this._getPhotosQueryURL(250,e);n.label=1;case 1:0;return[4,this._makeQuery(t)];case 2:if((r=n.sent()).error){console.error("Received an error response from SkyAPI, it's likely that the auth data has expired. Please relaunch the proxy server with updated credentials.");return[3,3]}this._processAllPhotosPage(r);if(!r.pastPagingToken)return[3,3];t=this._getPhotosQueryURL(250,e,r.pastPagingToken);return[3,1];case 3:i=this._generateGroupToCount(this._timestamps);this._groupToCount=i.groupToCount;this._groupToCountDate=i.groupToCountDate;return[2]}})})};return e}();t.SkyAPIAddonSource=a});
define("odsp-next/controls/list/allphoto2/src/itemsscope/GraphAddonSource",["require","exports","tslib","@ms/items-view-addon-photos/lib/services/GraphService","@ms/items-view-addon-photos/lib/util/localeDateFormat","@ms/items-view-addon-photos/lib/util/generateWidthsFromRecords"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._url="https://graph.microsoft.com/v1.0/";this._groupToCount=[];this._photos=[];this._timestamps=[];this._graphService=t?new t:new r.GraphService;this._identityDataSource=e}e.prototype.getWidths=function(e,t,n,r,i,o){var u=this;return new Promise(function(e,t){u._loadingPromise?u._loadingPromise.then(function(){u._widths=s.generateWidthsFromRecords(n,u._photos);e(u._widths)}):e(u._widths)})};e.prototype.getGroupToCount=function(e,t,n,r){var i=this;return new Promise(function(e,t){i._loadingPromise?i._loadingPromise.then(function(){e(i._groupToCount)}):e({counts:i._groupToCount})})};e.prototype.getPhotoRecords=function(e,t,n,r,i){var s=this;return new Promise(function(n,r){s._loadingPromise?s._loadingPromise.then(function(){n(s._photos.slice(e,t))}):n(s._photos.slice(e,t))})};e.prototype.getPhotoRecordsForBurstMode=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this.getPhotoRecords(0,e,t,r,-1)]})})};e.prototype.updateResource=function(e){var t=this;this._loadingPromise||(this._loadingPromise=this._getAllUserPhotos().then(function(){t._loadingPromise=void 0}))};e.prototype.getIsSamsungFolderAvailable=function(){throw"Not implemented"};e.prototype._makeQuery=function(e){var t=this;return new Promise(function(n,r){t._identityDataSource.getGraphToken().then(function(i){t._graphService.graphQuery(i.accessToken,e).then(function(e){try{n(e.text())}catch(e){r("JSON parsing failed.")}}).catch(function(t){r("error loading "+e)})})})};e.prototype._timeStampToDate=function(e){var t=e;null==t&&(t="0000-00-00 12:00:00 AM");return new Date(t)};e.prototype._generateGroupToCount=function(e){for(var t=[],n=void 0,r=void 0,s=0,o=0;o<e.length;o++){var u=e[o];n=this._timeStampToDate(u);void 0===r&&(r=n);if(n.getUTCFullYear()!==r.getUTCFullYear()||n.getUTCMonth()!==r.getUTCMonth()||n.getUTCDate()!==r.getUTCDate()){t.push({labels:[i.localeDateFormat(r),r.getUTCMonth().toString(),r.getUTCFullYear().toString()],count:s});s=0;r=n}s++}s>0&&t.push({labels:n?[i.localeDateFormat(n),n.getUTCMonth().toString(),n.getUTCFullYear().toString()]:["","",""],count:s});return t};e.prototype._processAllPhotosPage=function(e){for(var t=0;t<e.length;++t){var n=e[t];this._photos.push({id:n.id,thumbnails:n.thumbnails&&n.thumbnails[0]?[{url:n.thumbnails[0].small?n.thumbnails[0].small.url:"",width:n.thumbnails[0].small?n.thumbnails[0].small.width:void 0,height:n.thumbnails[0].small?n.thumbnails[0].small.height:void 0},{url:n.thumbnails[0].medium?n.thumbnails[0].medium.url:"",width:n.thumbnails[0].medium?n.thumbnails[0].medium.width:void 0,height:n.thumbnails[0].medium?n.thumbnails[0].medium.height:void 0},{url:n.thumbnails[0].large?n.thumbnails[0].large.url:"",width:n.thumbnails[0].large?n.thumbnails[0].large.width:void 0,height:n.thumbnails[0].large?n.thumbnails[0].large.height:void 0}]:[],name:n.name||"No Name",dateTaken:n.photo&&n.photo.takenDateTime||n.createdDateTime,isVideo:!1});var r=n.photo&&n.photo.takenDateTime||n.createdDateTime;this._timestamps.push(r)}};e.prototype._getPhotosQueryURL=function(e,t){return this._url+"me/drive/root/search(q='photo')?expand=thumbnails&filter=image+ne+null+and+file+ne+null"};e.prototype._sortPhotos=function(e){e.sort(function(e,t){var n=e.photo&&e.photo.takenDateTime||e.createdDateTime,r=t.photo&&t.photo.takenDateTime||t.createdDateTime;return n>r?-1:n<r?1:0});return e};e.prototype._getAllUserPhotos=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t,r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._makeQuery(this._getPhotosQueryURL(250))];case 1:e=n.sent();t=JSON.parse(e);r=[];if(!t)return[3,8];if(!t.error)return[3,2];console.error("Received an error response from Graph API, it's likely that the auth data has expired. Please relaunch the proxy server with updated credentials.");return[3,7];case 2:0;r=r.concat(t.value);return t["@odata.nextLink"]?[4,this._makeQuery(t["@odata.nextLink"])]:[3,4];case 3:e=n.sent();t=JSON.parse(e);return[3,5];case 4:return[3,6];case 5:return[3,2];case 6:r=this._sortPhotos(r);this._processAllPhotosPage(r);this._groupToCount=this._generateGroupToCount(this._timestamps);n.label=7;case 7:return[3,9];case 8:console.error("Did not receive a response while requesting photos for the Graph API");n.label=9;case 9:return[2]}})})};return e}();t.GraphAddonSource=o});
define("@ms/items-view-addon-photos/lib/services/GraphService",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.graphUrl="https://graph.microsoft.com/v1.0"}e.prototype.graphQuery=function(e,t){var n=new Headers({Authorization:"Bearer "+e});return fetch(t,{headers:n}).catch(function(e){throw e})};e.prototype.graphQueryAsObject=function(e,t){var n=this;return new Promise(function(r,i){n.graphQuery(e,t).then(function(e){e.json().then(r)})})};e.prototype.getUserInfo=function(e){return this.graphQuery(e,this.graphUrl+"/me").then(function(e){return e.json()})};e.prototype.getUserPhoto=function(e){return this.graphQuery(e,this.graphUrl+"/me/photo/$value")};return e}();t.GraphService=n});
define("odsp-next/controls/list/allphoto2/src/itemsscope/VroomAddonSource",["require","exports","tslib","@ms/items-view-addon-photos/lib/util/localeDateFormat","@ms/items-view-addon-photos/lib/util/typedArrayUtils"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e){this._groupToCount=[];this._vroomDataRequester=e}e.prototype.getWidths=function(e,t,r,i,s,o){return n.__awaiter(this,void 0,void 0,function(){var u,f;return n.__generator(this,function(n){switch(n.label){case 0:u=e+1;return[4,this._makeQuery(a(u,t-e,i,s,o))];case 1:if(!(f=n.sent()))throw new Error("Did not receive a response while requesting widths for the CoreApi");if(f.error)throw new Error("Received an error response from CoreApi, it's likely that the auth data has expired. Please relaunch the proxy server with updated credentials.");return[2,this._generateWidths(r,f.value)]}})})};e.prototype.getGroupToCount=function(e,t,r,i){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(n){switch(n.label){case 0:return this._groupToCount.length<=0?[4,this._getCountByDay(t,r)]:[3,2];case 1:e=n.sent();this._processCountByDay(e);n.label=2;case 2:return[2,{counts:this._groupToCount}]}})})};e.prototype.getPhotoRecords=function(e,t,r,i,s){return n.__awaiter(this,void 0,void 0,function(){var u,a,f;return n.__generator(this,function(n){switch(n.label){case 0:u=e+1;return[4,this._makeQuery(o(u,t-e,r,i,s))];case 1:if(!(a=n.sent()))throw new Error("Did not receive a response while requesting photos for the CoreApi");if(a.error)throw new Error("Received an error response from CoreApi, it's likely that the auth data has expired. Please relaunch the proxy server with updated credentials.");f=[];a.value.map(function(e){f.push(l(e))});return[2,f]}})})};e.prototype.getPhotoRecordsForBurstMode=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){return[2,this.getPhotoRecords(0,e,t,r,-1)]})})};e.prototype.updateResource=function(e){};e.prototype.getIsSamsungFolderAvailable=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this._vroomDataRequester.send({apiName:"Special",path:"/drive/special/samsungGallery",requestType:"HEAD",useAuthorizationHeaders:!0}).then(function(){return!0}).catch(function(){return!1})]})})};e.prototype._generateWidths=function(e,t){var n=i.makeUint16Array(t.length);t.map(function(t,r){var i=t.image?t.image.width:t.video.width,s=t.image?t.image.height:t.video.height,o=Math.round(e*(i/s));n[r]=o});return n};e.prototype._makeQuery=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,this._vroomDataRequester.send({apiName:"allPhotos",path:e,useAuthorizationHeaders:!0}).catch(function(t){throw new Error("error loading "+e)})];case 1:return[2,t.sent()]}})})};e.prototype._processCountByDay=function(e){for(var t=0;t<e.length;++t){var n=e[t],i=new Date(n.photo.takenDateTime);this._groupToCount.push({labels:[r.localeDateFormat(i),i.getUTCMonth().toString(),i.getUTCFullYear().toString()],count:n.totalCount})}};e.prototype._getCountByDay=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,i,s;return n.__generator(this,function(n){switch(n.label){case 0:r=[];i=u(1e3,e,t,1);n.label=1;case 1:return i?[4,this._makeQuery(i)]:[3,3];case 2:if((s=n.sent()).error){console.error("Received an error response from "+i);throw new Error(s.error)}r=r.concat(s.value);i=s["@odata.nextLink"];return[3,1];case 3:return[2,r]}})})};return e}();t.VroomAddonSource=s;function o(e,t,n,r,i){var s="/drives/"+r+"/items/"+n+"/items?filter=photo+ne+null&orderby=photo/takenDateTime+desc&expand=thumbnails&top="+t;e>1&&(s+="&skiptoken="+e+"/"+i);return s}t.getPhotosQueryURLForVroom=o;function u(e,t,n,r){var i="/drives/"+n+"/items/"+t+"/items?filter=photo+ne+null&orderby=photo/takenDateTime+desc&apply=groupby((takenDateTime),aggregate(id+with+countdistinct+as+total)&top="+e;r>1&&(i+="&skiptoken="+r+"/"+r);return i}t.getCountByDayQueryURLForVroom=u;function a(e,t,n,r,i){var s="/drives/"+r+"/items/"+n+"/items?filter=photo+ne+null&orderby=photo/takenDateTime+desc&select=id,cTag,image,video&top="+t;e>1&&(s+="&skiptoken="+e+"/"+i);return s}t.getWidthsQueryURLForVroom=a;function f(e){return e?{url:e.url,width:e.width,height:e.height}:{url:"",width:0,height:0}}t.convertIThumbnailToIImage=f;function l(e){var t=[];e.thumbnails&&e.thumbnails[0]&&(t=[f(e.thumbnails[0].small),f(e.thumbnails[0].medium),f(e.thumbnails[0].large)]);var n=e.location;return{id:e.id,thumbnails:t,name:e.name||e.id,location:n?n.address:void 0,dateTaken:e.photo&&e.photo.takenDateTime?e.photo.takenDateTime:e.createdDateTime,isVideo:!1}}t.responseToIPhotoRecord=l});
define("odsp-next/controls/list/allphoto2/src/itemsscope/PhotoProviderAddonSource",["require","exports","tslib","@ms/items-view-addon-photos/lib/models/interfaces/IGroupToCount","@ms/items-view-addon-photos/lib/util/localeDateFormat","@ms/odsp-utilities/lib/string/StringHelper","../../../../../resources/ProviderResourceKeys","@ms/items-view-addon-photos/lib/util/typedArrayUtils","../../../../../providers/item/ItemProvider","../../../../../providers/engagement/Engagement","./VroomAddonSource","./VroomAddonSource"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(){function e(e){this._groupToCount=[];this._groupToCountDate=[];this._vroomDataRequester=e}e.prototype.updateResource=function(e){this.resources=e;this._photoProvider=this.resources.consume(o.photo);this._itemProvider=this.resources.consume(a.resourceKey);this._engagement=this.resources.consume(f.resourceKey)};e.prototype.getWidths=function(e,t,r,i,s,o){return n.__awaiter(this,void 0,void 0,function(){var u,a,f,l,h;return n.__generator(this,function(n){switch(n.label){case 0:u=e+1;a=new Date;return[4,this._makeQuery(c.getWidthsQueryURLForVroom(u,t-e,i,s,o))];case 1:if(!(f=n.sent()))throw new Error("Did not receive a response while requesting widths for the CoreApi");if(f.error)throw new Error("Received an error response from CoreApi, it's likely that the auth data has expired. Please relaunch the proxy server with updated credentials.");if(this._engagement){l=new Date;h=l.getTime()-a.getTime();this._engagement.logData({name:"AllPhotos.FirstLoadAPIWidths",extraData:{time:h}})}return[2,this._generateWidths(r,f.value)]}})})};e.prototype.getPhotoRecordsForBurstMode=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var i,s;return n.__generator(this,function(n){switch(n.label){case 0:1;return[4,this._makeQuery(c.getPhotosQueryURLForVroom(1,e,t,r,1e3))];case 1:if(!(i=n.sent()))throw new Error("Did not receive a response while requesting photos for the CoreApi");if(i.error)throw new Error(i.error);s=[];i.value.map(function(e){s.push(l.responseToIPhotoRecord(e))});return[2,s]}})})};e.prototype.getGroupToCount=function(e,t,r,i){return n.__awaiter(this,void 0,void 0,function(){var e,s,o,u,a,f,l,h,p,d,v,m,g;return n.__generator(this,function(n){switch(n.label){case 0:e=new Date;s=i?parseInt(i,10):1;o=[];for(u=0;u<10;++u){a=c.getCountByDayQueryURLForVroom(250,t,r,s);o.push(this._makeQuery(a));s+=250}return[4,Promise.all(o)];case 1:f=n.sent();l=f.map(function(e){0===e.value.length&&(s=void 0);return e.value});h=[].concat.apply([],l);p=this._processCountByDay(h),d=p.groupToCount,v=p.groupToCountDate;if(i)this._mergeGroupToCounts(d,v);else{this._groupToCount=d;this._groupToCountDate=v}if(this._engagement){m=new Date;g=m.getTime()-e.getTime();this._engagement.logData({name:"AllPhotos.FirstLoadAPICountbyday",extraData:{time:g}})}return[2,{counts:d,pageToken:s?s.toString():void 0}]}})})};e.prototype.getPhotoRecords=function(e,t,r,i,s){return n.__awaiter(this,void 0,void 0,function(){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;return n.__generator(this,function(n){switch(n.label){case 0:i=void 0;s=0;return 0===e?[3,2]:[4,this._getStartDate(e,r)];case 1:o=n.sent(),u=o.date,a=o.index;i=new Date(Date.UTC(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate(),24,0,0,-1));s=a;n.label=2;case 2:f=e-s;l=t-s;c=this._photoProvider.getAllPhotosSettings();h=i?i.toISOString():void 0;p=0;d=l;v=[];m=200;g=new Date;n.label=3;case 3:if(!(d>0))return[3,11];y=Math.min(m,d);w=(b=s+p)+y;E={rootItemId:c.peek().rootId,parentKey:null,startIndex:b,endIndex:w-1,jumpToStartDate:h,photoType:0,ascending:!1,locationFilter:void 0,pageSize:m,revision:0,skipInMemoryCache:!1,tagFilter:void 0};return[4,this._photoProvider.getAllPhotosForPage(E)];case 4:S=n.sent();if(Array.isArray(S))throw new Error("Invalid result from getAllPhotosForPage (array)");if(!S||!S.content)return[3,10];if(!(x=S.content())||!x.items)return[3,10];T=Math.min(x.items.length,w);N=b+f;n.label=5;case 5:if(!(N<T))return[3,10];if(!x.items[N])return[3,8];if(".gif"!==(C=x.items[N]()).extension)return[3,7];k={parentKey:C.key};return[4,this._itemProvider.getItem(k)];case 6:L=n.sent();(A=L.item()).photo&&A.photo.originalUrl?C=A:console.warn("Retrieved getItems for Gif did not have an Open URL");n.label=7;case 7:O=this._transformPhoto(C);v.push(O);return[3,9];case 8:v.push({id:"",thumbnails:[],name:N.toString(),dateTaken:"",isVideo:!1});n.label=9;case 9:++N;return[3,5];case 10:p+=y;f=f>y?f-y:0;d-=y;return[3,3];case 11:if(this._engagement){M=new Date;_=M.getTime()-g.getTime();this._engagement.logData({name:"AllPhotos.FirstLoadAPIMetadata",extraData:{time:_}})}return[2,v]}})})};e.prototype.getIsSamsungFolderAvailable=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,this._vroomDataRequester.send({apiName:"Special",path:"/drive/special/samsungGallery",requestType:"HEAD",useAuthorizationHeaders:!0}).then(function(){return!0}).catch(function(){return!1})]})})};e.prototype._getStartDate=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s;return n.__generator(this,function(n){t=0;r=-1;i=0;for(s=0;s<this._groupToCount.length;s++){if((t+=this._groupToCount[s].count)>e){r=s;break}i=t}if(r>=0)return[2,{date:this._groupToCountDate[r],index:i}];throw new Error("Index "+e+" is not a valid item")})})};e.prototype._makeQuery=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,this._vroomDataRequester.send({apiName:"allPhotos",path:e,useAuthorizationHeaders:!0}).catch(function(t){throw new Error("error loading "+e)})];case 1:return[2,t.sent()]}})})};e.prototype._timeStampToDate=function(e){var t=e;null==t&&(t="0000-00-00 12:00:00 AM");/[A,P]M/.test(t)&&(t=t.replace(/-/g,"/"));return new Date(t)};e.prototype._generateWidths=function(e,t){var n=u.makeUint16Array(t.length);t.map(function(t,r){var i=t.image?t.image.width:t.video?t.video.width:600,s=t.image?t.image.height:t.video?t.video.height:600,o=Math.round(e*(i/s));n[r]=o});return n};e.prototype._transformPhoto=function(e){var t=e.thumbnail?e.thumbnail.width:e.photo&&e.photo.width,n=e.thumbnail?e.thumbnail.height:e.photo&&e.photo.height;if(!t||!n){t=600;n=600;console.warn("Image doesn't have width and height, using default instead")}var r=0!==n?t/n:1,i=Math.min(32,n),o=Math.floor(i*r),u=Math.min(352,n),a=Math.floor(u*r),f=void 0,l=void 0;if(e.dateTaken){f=e.dateTaken;l=this._timeStampToDate(f)}else if(e.dateCreatedTime){var c=e.dateCreatedTime,h=e.dateModifiedTime;if(c&&h&&c>h){l=e.dateModifiedTime;f=e.dateModified}else{l=e.dateCreatedTime;f=e.dateCreated}}return{id:e.id||e.key,thumbnails:t&&n&&e.thumbnail?[{url:s.format(e.thumbnail.url,o,i),width:o,height:i},{url:s.format(e.thumbnail.url,a,u),width:a,height:u},{url:s.format(e.thumbnail.url,t,n),width:e.thumbnail.width,height:e.thumbnail.height}]:[{url:"",width:0,height:0}],name:e.name||"No Name",dateTaken:f,dateTakenTime:l,location:e.geoLocation,extension:e.extension,originalUrl:".gif"===e.extension?e.photo.originalUrl:"",isVideo:!!e.video}};e.prototype._processCountByDay=function(e){for(var t=[],n=[],r=0;r<e.length;++r){var s=e[r],o=new Date(s.photo.takenDateTime),u=new Date(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate());t.push({labels:[i.localeDateFormat(u),u.getUTCMonth().toString(),u.getUTCFullYear().toString()],count:s.totalCount});n.push(o)}return{groupToCount:t,groupToCountDate:n}};e.prototype._mergeGroupToCounts=function(e,t){if(this._groupToCount.length>0&&e.length>0){var n=this._groupToCount.length-1;if(r.getLabelsFromGroupToCount(this._groupToCount[n]).join(";")===r.getLabelsFromGroupToCount(e[0]).join(";")){this._groupToCount[n].count+=e[0].count;if(e.length>1){this._groupToCount=this._groupToCount.concat(e.slice(1));this._groupToCountDate=this._groupToCountDate.concat(t.slice(1))}}else{this._groupToCount=this._groupToCount.concat(e);this._groupToCountDate=this._groupToCountDate.concat(t)}}else console.warn("Tried to add empty group to count into local groupTocount variables!")};return e}();t.PhotoProviderAddonSource=h});
define("@uifabric/experiments/lib/Tile",["require","exports","tslib","./components/Tile/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@uifabric/experiments/lib/components/Tile/index",["require","exports","tslib","./Tile","./ShimmerTile/ShimmerTile"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("@uifabric/experiments/lib/components/Tile/Tile",["require","exports","tslib","react","office-ui-fabric-react/lib/Check","office-ui-fabric-react/lib/Selection","../../Utilities","ODCPhotosItemsScope_css"],function(e,t,n,r,i,s,o,u){"use strict";var a=u.Signal_4,f=u.Check_8;u=u.Tile_1;Object.defineProperty(t,"__esModule",{value:!0});var l=u,c=a,h=f;t.TileLayoutValues={nameplatePadding:12,largeNameplateNameHeight:15,smallNameplateNameHeight:12,nameplateMargin:0,largeNameplateActivityHeight:20,smallNameplateActivityHeight:20,foregroundMargin:16};t.TileLayoutSizes={small:{nameplatePadding:t.TileLayoutValues.nameplatePadding,nameplateNameHeight:t.TileLayoutValues.smallNameplateNameHeight,nameplateMargin:t.TileLayoutValues.nameplateMargin,nameplateActivityHeight:t.TileLayoutValues.smallNameplateActivityHeight,foregroundMargin:t.TileLayoutValues.foregroundMargin},large:{nameplatePadding:t.TileLayoutValues.nameplatePadding,nameplateNameHeight:t.TileLayoutValues.largeNameplateNameHeight,nameplateMargin:t.TileLayoutValues.nameplateMargin,nameplateActivityHeight:t.TileLayoutValues.largeNameplateActivityHeight,foregroundMargin:t.TileLayoutValues.foregroundMargin}};var p=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onSelectionChange=function(){var e=r.props,t=e.selection,n=e.selectionIndex,i=void 0===n?-1:n,s=i>-1&&!!t&&t.isIndexSelected(i),o=!!t&&!!t.isModal&&t.isModal();r.setState({isSelected:s,isModal:o})};r._nameId=o.getId("Tile-name");r._activityId=o.getId("Tile-activity");r._labelId=o.getId("Tile-label");r._descriptionId=o.getId("Tile-description");var i=t.selectionIndex,s=void 0===i?-1:i,u=t.selection,a=!!u&&s>-1&&u.isIndexSelected(s),f=!!u&&!!u.isModal&&u.isModal();r.state={isSelected:a,isModal:f};return r}t.prototype.componentWillReceiveProps=function(e){var t=this.props,n=t.selection,r=t.selectionIndex,i=e.selection,s=e.selectionIndex,o=void 0===s?-1:s;if(n!==i||r!==o){var u=!!i&&o>-1&&i.isIndexSelected(o),a=!!i&&i.isModal&&i.isModal();this.setState({isSelected:u,isModal:a})}};t.prototype.componentDidMount=function(){var e=this.props.selection;e&&this._events.on(e,s.SELECTION_CHANGE,this._onSelectionChange)};t.prototype.componentDidUpdate=function(e){var t=this.props.selection,n=e.selection;if(t!==n){n&&this._events.off(n);t&&this._events.on(t,s.SELECTION_CHANGE,this._onSelectionChange)}};t.prototype.render=function(){var e,t=this.props,i=(t.children,t.selectionIndex),s=void 0===i?-1:i,a=t.invokeSelection,f=void 0!==a&&a,h=t.selection,p=t.background,d=t.foreground,v=t.showBackgroundFrame,m=void 0!==v&&v,g=t.showForegroundFrame,y=void 0!==g&&g,b=t.hideBackground,w=void 0!==b&&b,E=t.hideForeground,S=void 0!==E&&E,x=t.itemName,T=t.itemActivity,N=(t.componentRef,t.className),C=t.tileSize,k=void 0===C?"large":C,L=(t.contentSize,t.ariaLabel),A=t.descriptionAriaLabel,O=t.href,M=t.onClick,_=t.isFluentStyling,D=t.ariaLabelSelected,P=t.nameplateOnlyOnHover,H=n.__rest(t,["children","selectionIndex","invokeSelection","selection","background","foreground","showBackgroundFrame","showForegroundFrame","hideBackground","hideForeground","itemName","itemActivity","componentRef","className","tileSize","contentSize","ariaLabel","descriptionAriaLabel","href","onClick","isFluentStyling","ariaLabelSelected","nameplateOnlyOnHover"]),B=this.state,j=B.isSelected,F=void 0!==j&&j,I=B.isModal,q=void 0!==I&&I,R=!!h&&s>-1,U=!(!O&&!M&&!f||q),z=F&&D?L+", "+D:L,W=r.createElement(r.Fragment,null,L?r.createElement("span",{key:"label",id:this._labelId,className:o.css("ms-Tile-label",u.label)},z):null,p?this._onRenderBackground({background:p,hideBackground:w}):null,d?this._onRenderForeground({foreground:d,hideForeground:S}):null,x||T?this._onRenderNameplate({name:x,activity:T,onlyOnHover:!!P}):null),X=O?"a":"button",V=r.createElement(X,{href:O,onClick:M,ref:this.props.linkRef,"data-selection-invoke":!!(U&&s>-1)||void 0,className:o.css("ms-Tile-link",l.link)},W);return r.createElement("div",n.__assign({"aria-selected":F},o.getNativeProps(H,o.divProperties),{"aria-labelledby":L?this._labelId:this._nameId,"aria-describedby":z?this._descriptionId:this._activityId,className:o.css("ms-Tile",N,l.tile,(e={},e["ms-Tile--isSmall "+l.isSmall]="small"===k,e["ms-Tile--isLarge "+l.isLarge]="large"===k,e["ms-Tile--hasBackgroundFrame "+l.hasBackgroundFrame]=m,e["ms-Tile--hasForegroundFrame "+l.hasForegroundFrame]=y,e["ms-Tile--isSelected "+l.selected+" "+c.selected]=F,e["ms-Tile--isSelectable "+l.selectable]=R,e["ms-Tile--hasBackground "+l.hasBackground]=!!p,e[c.dark]=!!p&&!w,e["ms-Tile--showBackground "+l.showBackground]=!w,e["ms-Tile--invokable "+l.invokable]=U,e["ms-Tile--uninvokable "+l.uninvokable]=!U,e["ms-Tile--isDisabled "+l.disabled]=!R&&!U,e["ms-Tile--showCheck "+l.showCheck]=q,e["ms-Tile--isFluentStyling "+l.isFluentStyling]=_,e)),"data-is-focusable":!0,"data-is-sub-focuszone":!0,"data-disable-click-on-enter":!0,"data-selection-index":s>-1?s:void 0}),V,A?r.createElement("span",{key:"description",id:this._descriptionId,className:o.css("ms-Tile-description",u.description)},A):null,R?this._onRenderCheck({isSelected:F}):null)};t.prototype._onRenderBackground=function(e){var t,n=e.background,i=e.hideBackground,s="function"==typeof n?n(d(this.props)):n;return s?r.createElement("span",{key:"background",className:o.css("ms-Tile-background",l.background,(t={},t["ms-Tile-background--hide "+l.backgroundHide]=i,t))},s):null};t.prototype._onRenderForeground=function(e){var t,n=e.foreground,i=e.hideForeground,s="function"==typeof n?n(d(this.props)):n;return s?r.createElement("span",{key:"foreground",role:"presentation",className:o.css("ms-Tile-aboveNameplate",l.aboveNameplate)},r.createElement("span",{role:"presentation",className:o.css("ms-Tile-content",l.content)},r.createElement("span",{role:"presentation",className:o.css("ms-Tile-foreground",l.foreground,(t={},t["ms-Tile-foreground--hide "+l.foregroundHide]=i,t))},s))):null};t.prototype._onRenderNameplate=function(e){var t,n,i,s=e.name,u=e.activity,a=e.onlyOnHover;return r.createElement("span",{key:"nameplate",className:o.css("ms-Tile-nameplate",l.nameplate,(t={},t[l.onlyOnHover]=a,t))},s?r.createElement("span",{id:this._nameId,className:o.css("ms-Tile-name",l.name,(n={},n[l.onlyOnHover]=a,n))},s):null,u?r.createElement("span",{id:this._activityId,className:o.css("ms-Tile-activity",l.activity,(i={},i[l.onlyOnHover]=a,i))},u):null)};t.prototype._onRenderCheck=function(e){var t,n=e.isSelected,s=this.props.toggleSelectionAriaLabel;return r.createElement("span",{key:"check",role:"checkbox","aria-label":s,className:o.css("ms-Tile-check",l.check,h.checkHost,(t={},t[h.hostShowCheck]=this.state.isModal,t)),"data-selection-toggle":!0,"aria-checked":n},r.createElement(i.Check,{checked:n}))};return t}(o.BaseComponent);t.Tile=p;t.getTileLayout=function(e){return d(e.props)};function d(e){var n=e.contentSize,r=e.tileSize,i=void 0===r?"large":r;if(!n)return{};var s=n.width,o=t.TileLayoutSizes[i],u=o.nameplatePadding,a=o.nameplateMargin,f=o.nameplateActivityHeight,l=o.nameplateNameHeight,c=o.foregroundMargin,h=0;if(e.itemName||e.itemActivity){h+=2*u;e.itemName&&(h+=l);e.itemActivity&&(h+=f+a)}return{foregroundSize:{width:s-2*c,height:n.height-c-h},backgroundSize:n}}t.renderTileWithLayout=function(e,t){var i=e.type;return r.createElement(i,n.__assign({},e.props,t))}});
define("@uifabric/experiments/lib/components/Tile/ShimmerTile/ShimmerTile",["require","exports","../../../Utilities","./ShimmerTile.base","./ShimmerTile.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShimmerTile=n.styled(r.ShimmerTileBase,i.getStyles)});
define("@uifabric/experiments/lib/components/Tile/ShimmerTile/ShimmerTile.base",["require","exports","tslib","react","../../../Utilities","../Tile","office-ui-fabric-react/lib/Shimmer"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={small:{squareWidth:62,squareHeight:61,nameWidth:106,nameHeight:5,activityWidth:62,activityHeight:5},large:{squareWidth:96,squareHeight:96,nameWidth:144,nameHeight:7,activityWidth:96,activityHeight:7}},a=i.classNamesFunction(),f=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.styles,n=e.contentSize,i=void 0===n?{width:176,height:171}:n,f=e.itemActivity,l=void 0===f||f,c=e.itemName,h=void 0===c||c,p=e.itemThumbnail,d=void 0===p||p,v=e.tileSize,m=void 0===v?"large":v,g=s.TileLayoutSizes[m],y=g.nameplatePadding,b=g.nameplateMargin,w=g.nameplateActivityHeight,E=g.nameplateNameHeight,S=u[m],x=S.squareWidth,T=S.squareHeight,N=S.nameWidth,C=S.nameHeight,k=S.activityWidth,L=S.activityHeight,A=0;if(h||l){A+=2*y;h&&(A+=E);l&&(A+=w+b)}this._classNames=a(t,{});return r.createElement("div",{className:this._classNames.root},r.createElement(o.ShimmerGap,{width:i.width,height:i.height-T-A}),r.createElement(o.ShimmerElementsGroup,{shimmerElements:[{type:o.ShimmerElementType.gap,width:(i.width-x)/2,height:T},d?{type:o.ShimmerElementType.line,width:x,height:T}:{type:o.ShimmerElementType.gap,width:x,height:T},{type:o.ShimmerElementType.gap,width:(i.width-x)/2,height:T}]}),l||h?r.createElement("div",null,r.createElement(o.ShimmerGap,{width:i.width,height:y}),h?r.createElement(o.ShimmerElementsGroup,{shimmerElements:[{type:o.ShimmerElementType.gap,width:(i.width-N)/2,height:E},{type:o.ShimmerElementType.line,width:N,height:C},{type:o.ShimmerElementType.gap,width:(i.width-N)/2,height:E}]}):null,l?r.createElement(o.ShimmerElementsGroup,{shimmerElements:[{type:o.ShimmerElementType.gap,width:(i.width-k)/2,height:w},{type:o.ShimmerElementType.line,width:k,height:L},{type:o.ShimmerElementType.gap,width:(i.width-k)/2,height:w}]}):null,r.createElement(o.ShimmerGap,{width:i.width,height:y})):null)};return t}(i.BaseComponent);t.ShimmerTileBase=f});
define("@uifabric/experiments/lib/components/Tile/ShimmerTile/ShimmerTile.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){return{root:["ms-ShimmerTile-root",{width:"100%",height:"100%",display:"flex",flexDirection:"column"}]}}});
define("odsp-next/controls/list/allphoto2/src/ExplorePhotos",["require","exports","tslib","react","../../../knockout/Knockout","../../../../bindings/component/ControlBinding","../../../../resources/DataSourceResourceKeys","../../../../resources/ProviderResourceKeys","../../../promotedPhotos/PromotedPhotos","../../../../dataSources/promotedPhotos/odc/PromotedPhotosDataSource","../../../../providers/promotedPhotos/PromotedPhotosProvider","office-ui-fabric-react/lib/FocusZone","ODCPhotosItemsScope_css"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.explorePhotosRef=r.createRef();n.state={height:void 0};n.props.resources.expose(o.promotedPhotos,new(n.props.resources.injected(f.default)));n.props.resources.expose(u.promotedPhotos,new(n.props.resources.injected(l.default)));return n}t.prototype.componentDidMount=function(){this.setState({promotedPhotosSpecification:s.toSpecification(a.resourceKey,{resources:this.props.resources})})};t.prototype.componentDidUpdate=function(){};t.prototype.render=function(){return r.createElement(c.FocusZone,{direction:c.FocusZoneDirection.bidirectional,isCircularNavigation:!0},r.createElement("div",{className:"od-photos-promotedWrapper-AllPhotos--loaded"},r.createElement("div",{className:"od-photos-promoted-AllPhotos",ref:this.explorePhotosRef},r.createElement(i.default,{specification:this.state.promotedPhotosSpecification,resources:this.props.resources}))))};return t}(r.Component);t.default=h});
define("odsp-next/controls/promotedPhotos/PromotedPhotos",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../bindings/component/ControlBinding","./PromotedPhotosViewModel","./PromotedPhotos.html","ODCPhotosItemsScope_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="od-promoted-photos",o=e("./PromotedPhotos.html"),u=n.registerComponent({tagName:s,template:o,viewModel:i.default,synchronous:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:s,name:e("module").id,template:o,viewModelType:i.default});t.default=u});
define("odsp-next/controls/promotedPhotos/PromotedPhotosViewModel",["require","exports","tslib","./PromotedPhotos.resx","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","../itemTileCard/ItemTileCard","../itemTile/ItemTile","../../bindings/clientRect/ClientRectBinding","../image/frame/ImageFrameViewModel","../componentCarousel/ComponentCarouselViewModel","../componentCarousel/ComponentCarousel","../../models/tag/TagType","../../utilities/features/Features","../../models/item/ItemHelper","../../controls/photos/Photos.resx","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../models/itemsScope/ItemsScopeFeature.key","@ms/utilities-strings/lib/index"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=100,S=194,x=268,T=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.carouselTagName=p.default.tagName;n.addBindingHandlers({clientRect:l.default});var i=n.resources.consume(u.photo);n._promotedPhotosProvider=n.resources.consume(u.promotedPhotos);n._actionMap=n.resources.consume(s.actionMap);n._urlDataSource=n.resources.consume(o.url);n.promotedPhotosSize=n.createObservable({width:0,height:0}).extend({rateLimit:{timeout:c.LAYOUT_THROTTLE_MS,method:"notifyWhenChangesStop"}});n._cellSize=n.createPureComputed(n._computeCellSize);n.label=r.strings.exploreRecentPhotosLabel;n.title=r.strings.exploreRecentPhotosTitle;n._allPhotosUserSettings=i.getAllPhotosSettings();n._allPhotosContext={rootItemId:n._allPhotosUserSettings.peek().rootId,ascending:!1,pageSize:E,startIndex:0,parentKey:void 0};n._photoItemSet=i.getAllPhotosSync(n._allPhotosContext);n._photoItemSetCanary=n.observables.pureCompute(function(){return n._photoItemSet.content().items});n._photoItemSetCanary.equalityComparer=y.objectStrictEquality;n._onThisDayPhotos=n.createObservable([]);n._autoAlbums=n.createObservable([]);n._sharedAlbums=n.createObservable([]);n._tagsAndPlaces=n.createObservable({tags:[],places:[]});n.createBackgroundComputed(n._updateContent).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}});n._availableTiles=n.createPureComputed(n._computeAvailableTiles);n._visibleTileCount=n.createPureComputed(n._computeVisibleTileCount);n._carouselComponents=n.createPureComputed(n._computeCarouselComponents);n._carouselItemWidth=n.createPureComputed(n._computeCarouselItemWidth);var a={title:r.strings.exploreRecentPhotosTitle,ariaLabel:r.strings.exploreRecentPhotosLabel},f=n.resources.consume(b.isItemsScopeEnabledInAllPhotosPivotResourceKey),d=f?S:x;n.carouselParams={tileWidth:n._carouselItemWidth,tileHeight:n.createObservable(d),components:n._carouselComponents,parentSize:n.promotedPhotosSize,useVirtualizedList:!0,pagerMode:h.PagerMode.arrowsSide,useCarouselIndicator:!f,maxNumberOfPages:6,useTopNavigation:f,carouselTitle:a};return n}t.prototype._updateContent=function(){var e=this;this._photoItemSetCanary();this._promotedPhotosProvider.getNewAutoAlbums().done(function(t){e._autoAlbums(t)});this._promotedPhotosProvider.getSharedAlbums().done(function(t){e._sharedAlbums(t)});this._promotedPhotosProvider.getOnThisDay(this._allPhotosContext).done(function(t){e._onThisDayPhotos(t)});this._promotedPhotosProvider.getTagsAndPlaces(this._allPhotosContext).done(function(t){e._tagsAndPlaces(t)})};t.prototype._computeAvailableTiles=function(){var e=this._tagsAndPlaces()||{tags:[],places:[]};return this._orderPromotedPhotos(this._onThisDayPhotos()||[],this._autoAlbums()||[],e.tags||[],e.places||[],this._sharedAlbums()||[])};t.prototype._orderPromotedPhotos=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=!1,i=0;!r;i++){r=!0;for(var s=0,o=e;s<o.length;s++){var u=o[s];if(u[i]){n.push(u[i]);r=!1}}}return n};t.prototype._computeCarouselItemWidth=function(){var e=this.promotedPhotosSize(),t=this._visibleTileCount();return e.width/t-8+8/t};t.prototype._computeCellSize=function(){var e=this.promotedPhotosSize(),t=this._visibleTileCount();return{width:e.width/t-8,height:x}};t.prototype._computeCarouselComponents=function(){var e=this._availableTiles().filter(function(e){return!!e}),t=[],n=this._carouselComponents.peek(),r=[];n&&n.length&&(r=n.map(function(e){return e.params.itemTileParams.item}));for(var i=0,s=e;i<s.length;i++){var o=s[i],u=r.indexOf(o),l=void 0;if(u>=0)l=n[u];else{var c={itemTileParams:{item:o,cellSize:this._cellSize,isInteractable:!0,engagementSource:"PromotedPhotosTile"},text:this._getCardTitleForItem(o.peek()),actionText:this._getActionText(o.peek()),action:this._getAction(o),itemTileTagName:f.default.tagName,ariaLabel:this.getItemTileCardArialabel(this._getActionText(o.peek()),this._getCardTitleForItem(o.peek()),o().name)};l={name:a.default.tagName,params:c}}t.push(l)}return t};t.prototype.customizeItemNameForScreenReader=function(e){return 0===e.indexOf("#")?e.slice(1):e};t.prototype.getItemTileCardArialabel=function(e,t,n){return n?w.format(r.strings.ItemTileCardArialabel,e,t,this.customizeItemNameForScreenReader(n)):e};t.prototype._computeVisibleTileCount=function(){var e=this.promotedPhotosSize().width;return Math.min(10,Math.floor(e/268))};t.prototype._isItemTag=function(e){var t=e.tagInfo;return t&&(t.tagType===d.default.singleTag||t.tagType===d.default.allTags)};t.prototype._isItemLocation=function(e){var t=e.tagInfo;return t&&(t.tagType===d.default.singlePlace||t.tagType===d.default.allPlaces)};t.prototype._isOnThisDayItem=function(e){return e&&!e.tagInfo&&e.dateTakenTime};t.prototype._isSharedAlbum=function(e){return e.isAlbum&&e.ownerId.toLowerCase()!==this._urlDataSource.getOwnerId(this._photoItemSet.item.peek().key).toLowerCase()};t.prototype._getAction=function(e){var t=this.peekUnwrapObservable(e);return v.isFeatureEnabled(v.EnableEvokeAlignments)&&m.isAutoAlbum(t)?new(this.child(this._actionMap.SaveAutoAlbumAction))({item:e}):!v.isFeatureEnabled(v.EnableEvokeAlignments)&&t.properties.autoAlbumTag?new(this.managed(this._actionMap.ShareByLinkAction))({item:e}):new(this.child(this._actionMap.DefaultClickAction))({item:e,userInvokedItem:!0,sourceEngagement:"PromotedPhotosTile.AutoAlbum.Click"})};t.prototype._getActionText=function(e){return this._isSharedAlbum(e)?"":v.isFeatureEnabled(v.EnableEvokeAlignments)&&m.isAutoAlbum(e)?g.strings.autoAlbumCardAction:!v.isFeatureEnabled(v.EnableEvokeAlignments)&&e.properties.autoAlbumTag?r.strings.shareActionTitle:this._isItemTag(e)||this._isItemLocation(e)||this._isOnThisDayItem(e)?r.strings.seeAllTitle:""};t.prototype._getCardTitleForItem=function(e){var t=this._isItemTag(e),n=this._isItemLocation(e);return this._isSharedAlbum(e)?r.strings.sharedAlbumTitle:v.isFeatureEnabled(v.EnableEvokeAlignments)&&m.isAutoAlbum(e)?g.strings.autoAlbumCardTitle:!v.isFeatureEnabled(v.EnableEvokeAlignments)&&e.properties.autoAlbumTag?r.strings.autoAlbumCardTitle:t?r.strings.recentTagsTitle:n?r.strings.recentPlacesTitle:this._isOnThisDayItem(e)?r.strings.onThisDayTitle:void 0};return t}(i.default);t.default=T});
define("odsp-next/controls/itemTileCard/ItemTileCard",["require","exports","./ItemTileCardViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","ODCPhotosItemsScope_css","./ItemTileCard.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-item-tile-card",template:e("./ItemTileCard.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/itemTileCard/ItemTileCardViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.text,i=void 0===r?"":r,s=t.itemTileParams,o=t.actionText,u=void 0===o?"":o,a=t.action,f=t.itemTileTagName,l=t.ariaLabel;n.text=n.wrapObservable(i);n.actionText=n.wrapObservable(u);n.action=a;n.itemTileParams=s;n.itemTileTagName=f;n.ariaLabel=l;return n}t.prototype.onClick=function(e,t){return this.action?this.action.execute(t):s.default.wrap({resultType:i.ResultTypeEnum.ExpectedFailure})};return t}(r.default);t.default=o});
define("odsp-next/controls/itemTileCard/ItemTileCard.html",[],function(){return'<div class=od-ItemTileCard><div class=od-ItemTileCard-tile>\x3c!--ko component: {\r\n name: itemTileTagName,\r\n params: itemTileParams\r\n }--\x3e\x3c!--/ko--\x3e</div><div class=od-ItemTileCard-cardSection>\x3c!--ko if: text--\x3e<span class=od-ItemTileCard-title data-bind="text: text"></span>\x3c!--/ko--\x3e\x3c!--ko if: actionText--\x3e<a class="od-ItemTileCard-action od-Link" href=# data-bind="attr: { \'aria-label\': ariaLabel }, text: actionText, click: onClick, css: { \'od-ItemTileCard-action--withoutTitle\': !text() }"></a>\x3c!--/ko--\x3e</div></div>'});
define("odsp-next/controls/promotedPhotos/PromotedPhotos.html",[],function(){return'<div class=od-PromotedPhotos data-bind="clientRect: { size: promotedPhotosSize, allowHiddenSizeUpdates: true }">\x3c!--ko component: {\r\n name: carouselTagName,\r\n params: carouselParams\r\n }--\x3e\x3c!--/ko--\x3e</div>'});
define("@ms/items-view-addon-photos/lib/components/gallery/AllPhotosGallery",["require","exports","@ms/items-view/lib/private/components/decorators/connectToItemCache","../../models/facets/GroupToCountFacets","../../models/facets/WidthsFacets","../../models/keys/PhotosRootItemSetKeyFacet","@ms/items-view/lib/private/components/decorators/selectors","../gallery/Gallery","@ms/items-view/lib/private/facets/SetFacets","../../models/facets/PhotosMetadataBurstFacet"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n.connectToItemCache(function(e,t){var n=t.itemKey;if(s.photosRootItemSetKeyFacet.matches(n)){var o=e.demandItemFacet(r.allGroupToCountsPointerFacet,n),u=e.demandItemFacet(i.widthsPointerFacet,n);if(o&&u){var l=e.demandItemFacet(r.allGroupToCountsFacet,o.itemKey),c=e.demandItemFacet(r.allGroupsTotalCountFacet,o.itemKey);if(e.isItemFacetResolved(a.childItemsFacet,o.itemKey)){var h=e.demandItemFacet(a.childItemsFacet,o.itemKey);h&&h.itemKeys[0]&&e.demandItemFacet(a.childItemsFacet,h.itemKeys[0])}var p=e.demandItemFacet(i.widthsFacet,u.itemKey),d=e.demandItemFacet(i.targetHeightFacet,u.itemKey);if((void 0===l||void 0===p)&&e.isItemFacetResolved(f.photosMetadataBurstFacet,n)){var v=e.demandItemFacet(f.photosMetadataBurstFacet,n);if(v){l=v.groupToCount;c=v.records.length;p=v.widths;d=v.targetHeight}}if(l&&p&&d)return{groupToCount:l,widths:p,targetHeight:d,photoCount:c}}}return{}});t.AllPhotosGallery=o.withCurrentItemSet()(l(u.Gallery))});
define("@ms/items-view-addon-photos/lib/components/gallery/Gallery",["require","exports","tslib","react","../scrubber/Scrubber","./GalleryLayout","../../services/imgLoadingScheduler","@uifabric/utilities","../allPhotosTilesList/AllPhotosTilesList","../demander/ItemDemander","../demander/ItemDemandManager","./layout/CalculateMargins","../groupHeader/AllPhotosGroupHeader","../image/AllPhotosImage","@ms/items-view-utilities/lib/locale/Locale","@ms/items-view/lib/private/components/itemsBreadcrumb/ItemsBreadcrumbBeta","../../util/typedArrayUtils","ODCPhotosItemsScope_css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g,y={ArrowDown:!0,ArrowUp:!0,PageDown:!0,PageUp:!0,End:!0,Home:!0},b=500,w=100,E=[],S=m.makeUint16Array(0);g=Date.now();var x=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._imageRows=[];n._scrubberRows=[];n.handleKeyDown=function(e){y[e.key]&&n.releaseAnchorImageIdDataLock()};n.releaseAnchorImageIdDataLock=function(){n._anchorImageIdDataLock=!1};n.onImageLoad=function(e,t,r){if(g){var i=g,s=+new Date-i;if(n.props.telemetryCallbacks){(0,n.props.telemetryCallbacks.firstImageLoadMs)(s)}if(window.performance){(d=n._getThumbnailLoadLoadTime().minTime)&&d!==Number.POSITIVE_INFINITY&&n.props.telemetryCallbacks.thumbnailfirstLoadMs(d)}g=void 0}var o=new Date,u=o.getTime()-t.getTime();n._timeImageLoad[e]||(n._timeImageLoad[e]=u);var a=0,f=0;for(var l in n._timeImageLoad)if(n._timeImageLoad.hasOwnProperty(l)){a+=n._timeImageLoad[l];f++}var c=Math.floor(a/f);if(n.props.telemetryCallbacks&&c){(0,n.props.telemetryCallbacks.avgImageLoadMs)(c)}if(n._imageIndexIsVisible(e)&&n._afterScrolling){var h=o.getTime()-n._endscrolltime;if(h<n._minTimeImageLoad){if(n.props.telemetryCallbacks){(0,n.props.telemetryCallbacks.firstImageLoadMs)(h)}n._minTimeImageLoad=h}if(h>n._maxTimeImageLoad&&0===r){if(n.props.telemetryCallbacks){(0,n.props.telemetryCallbacks.fullPageLoadMs)(h)}n._maxTimeImageLoad=h}}if(0===r&&window.performance){var p=n._getThumbnailLoadLoadTime(),d=p.minTime,v=p.maxTime,m=p.avgTime;d&&d!==Number.POSITIVE_INFINITY&&v&&m&&n.props.telemetryCallbacks.allThumbnailLoadTimeMs(d,v,m);n._imgLoadingScheduler.clearUrlsThatHaveLoaded()}};n.registerAnchorId=function(e,t){n._anchorMap.set(e,t);n._anchorImageIdData&&!n._anchorImageIdData.anchorId&&n._anchorImageIdData.imageIndex===e&&(n._anchorImageIdData.anchorId=t)};n.deregisterAnchorId=function(e,t){n._anchorMap.get(e)===t&&n._anchorMap.delete(e)};n._scrollToRow=function(e){if(n.props.telemetryCallbacks){(0,n.props.telemetryCallbacks.scrubberScroll)(e)}var t=0;if(0!==e){e>0&&!n._imageRows[e].isLabel&&n._imageRows[e-1].isLabel&&(e-=1);var r=n._explorePhotosContainerRef&&n._explorePhotosContainerRef.current?n._explorePhotosContainerRef.current.clientHeight:n.props.explorePhotosHeight;t=n._imageRows[e].y+r}n.galleryRef&&n.galleryRef.current&&(n.galleryRef.current.scrollTop=t)};n._onListPagesUpdated=function(e){n._calculateMinMaxVisibleRows(e);void 0===n._nextFrameTimer&&(n._nextFrameTimer=window.setTimeout(function(){if(n._visibleRowsMinMax){n._visibleImagesMinMax=n._layout.getVisibleImageIndexRange(n._visibleRowsMinMax.min,n._visibleRowsMinMax.max);n._imgLoadingScheduler.setVisibleImageIndexRange(n._visibleImagesMinMax);n._visibleImagesMinMax&&n.itemDemanderRef&&n.itemDemanderRef.current&&n.itemDemanderRef.current.setVisibleImageRange(n._visibleImagesMinMax.min,n._visibleImagesMinMax.max);n._itemDemandManager.resetCurrentlyRenderedData()}n._nextFrameTimer=void 0},0))};n._checkWidthChanged=function(){if(n.galleryRef&&n.galleryRef.current&&n.galleryRef.current.clientWidth!==n.state.containerWidth){n.setState({containerWidth:n.galleryRef.current.clientWidth});if(n.props.telemetryCallbacks){(0,n.props.telemetryCallbacks.screenSize)(window.outerWidth,window.outerHeight)}}n._widthPollingIsActive&&setTimeout(n._checkWidthChanged,w)};n._renderRowForTilesList=function(e){return n._renderRow(e.rowIndex,"TilesListRow_"+e.rowIndex,{height:e.rowData.height,left:0,position:"absolute",top:e.rowData.y,width:n.state.containerWidth},!1,!0)};n._renderExplorePhotos=function(){var e=r.createElement(r.Fragment,null);if(n.props.onRenderExplorePhotos){var t=n.props.squareTiles?n.props.galleryPadding_squaretiles[n.screenResIndex]:n.props.galleryPadding_aspect[n.screenResIndex],i=n.props.squareTiles?n.props.galleryPaddingRight_squaretiles[n.screenResIndex]:n.props.galleryPaddingRight_aspect[n.screenResIndex],s={height:n.props.explorePhotosHeight,left:0,top:0,width:n.state.containerWidth-t-i+"px"};d.Locale.isRightToLeft?s.marginLeft=i:s.marginLeft=t;return r.createElement("div",{ref:n._explorePhotosContainerRef,style:s},r.createElement(v.ItemsBreadcrumbBeta,null),n.props.onRenderExplorePhotos({rowStyle:{}},e))}return e};n._windowResized=function(){if(void 0===n._windowResizeEndedTimer){n.releaseAnchorImageIdDataLock();n._updateAnchorData()}else clearTimeout(n._windowResizeEndedTimer);n._windowResizeEndedTimer=window.setTimeout(function(){n._windowResizeEndedTimer=void 0},b)};n._onGalleryScroll=function(){n._isAnchorScroll?n._isAnchorScroll=!1:n.releaseAnchorImageIdDataLock();n._minTimeImageLoad=Number.POSITIVE_INFINITY;n._maxTimeImageLoad=0;n._endscrolltime=(new Date).getTime();n._afterScrolling=!0};n._onClickRow=function(e){var t=e.currentTarget,r=u.findScrollableParent(t);n._focusZoneRef&&n._focusZoneRef.current&&r&&0===n.props.selection.getSelectedIndices().length&&n._focusZoneRef.current.focusElement(r)};n.parentGalleryRef=r.createRef();n.galleryRef=r.createRef();n.itemDemanderRef=r.createRef();n.galleryId="ReactGridGallery";n._anchorImageIdDataLock=!0;n._focusZoneRef=r.createRef();n._explorePhotosContainerRef=r.createRef();n.state={squareTiles:n.props.squareTiles,containerWidth:0};n.galleryTopOffset=0;n._imgLoadingScheduler=new o.ImgLoadingScheduler({resizeMode:n.props.thumbnailResizingMode,progressiveMode:n.props.thumbnailProgressiveMode,maxParallelRequests:n.props.maxParallelRequests});n._itemDemandManager=new l.ItemDemandManager;n._layout=new s.GalleryLayout;n._anchorImageIdData=void 0;n._timeImageLoad={};n._minTimeImageLoad=Number.POSITIVE_INFINITY;n._maxTimeImageLoad=0;n._visibleImagesMinMax=void 0;n.screenResIndex=0;n._endscrolltime=0;n._afterScrolling=!1;n._events=new u.EventGroup(void 0);n._widthPollingIsActive=!1;n._isAnchorScroll=!1;n._anchorScrollQueued=!1;n._anchorMap=new Map;n._anchorImageIdData={imageIndex:0,isHeader:!1};return n}t.prototype.componentDidMount=function(){this._layout.setLayoutData(this.props.groupToCount,this.props.widths,this.props.targetHeight,this.props.photoCount);this._layout.setSelection(this.props.selection);this.updateGalleryLayout(this.props,this.state);this._widthPollingIsActive=!0;this._checkWidthChanged();window.addEventListener("resize",this._windowResized)};t.prototype.componentWillUnmount=function(){this._widthPollingIsActive=!1;this._layout.disposeEvent();this._events.dispose();window.removeEventListener("resize",this._windowResized)};t.prototype.componentDidUpdate=function(){if(this._anchorScrollQueued){this._anchorScrollQueued=!1;this.scrollToAnchor()}};t.prototype.shouldComponentUpdate=function(e,t){var n=!1,r=!1;if(e.selection!==this.props.selection){this._layout.setSelection(e.selection);r=!0}if(t.containerWidth!==this.state.containerWidth||this.props.squareTiles!==e.squareTiles){n=!0;r=!0;this._anchorScrollQueued=!0}if(this.props.groupToCount!==e.groupToCount||this.props.widths!==e.widths||this.props.targetHeight!==e.targetHeight||this.props.photoCount!==e.photoCount){this._layout.setLayoutData(e.groupToCount,e.widths,e.targetHeight,e.photoCount);n=!0;r=!0;this._anchorScrollQueued=!0}n&&this.updateGalleryLayout(e,t);return r};t.prototype.updateGalleryLayout=function(e,t){this.screenResIndex=e.screenResBreakPoints.length-1;for(var n=0;n<e.screenResBreakPoints.length;n++)if(t.containerWidth<=e.screenResBreakPoints[n]){this.screenResIndex=n;break}this._updateAnchorData();this.galleryTopOffset=0;if(this.galleryRef.current){var r=this.galleryRef.current.getBoundingClientRect(),i=window.pageYOffset||document.documentElement.scrollTop;this.galleryTopOffset=Math.round(r.top+i)}var s={rowHeight:e.squareTiles?e.rowHeight_squaretiles[this.screenResIndex]:e.rowHeight_aspect[this.screenResIndex],margin:e.squareTiles?e.imagePadding_squaretiles[this.screenResIndex]:e.imagePadding_aspect[this.screenResIndex],squareTiles:e.squareTiles,groupHeaderMarginTop:e.groupHeaderMarginTop[this.screenResIndex],groupHeaderMarginBottom:e.groupHeaderMarginBottom[this.screenResIndex],groupHeaderLeadingMargin:e.groupHeaderLeadingMargin[this.screenResIndex],labelRowHeight:e.labelRowHeight,containerWidth:t.containerWidth,maxRowScaleUpFactor:e.squareTiles?e.maxRowScaleUpFactor_squaretiles[this.screenResIndex]:e.maxRowScaleUpFactor[this.screenResIndex],midRowGroupGap:e.squareTiles?e.midRowGroupGap_squaretiles[this.screenResIndex]:e.midRowGroupGap_aspect[this.screenResIndex],enableDateStitching:e.enableDateStitching,startRowLeadingMargin:e.squareTiles?e.galleryPadding_squaretiles[this.screenResIndex]:e.galleryPadding_aspect[this.screenResIndex],endRowTrailingMargin:e.squareTiles?e.galleryPaddingRight_squaretiles[this.screenResIndex]:e.galleryPaddingRight_aspect[this.screenResIndex]};this._imageRows=this._layout.buildAllRows(s);var o={height:this.props.explorePhotosHeight,y:0};this._scrubberRows=[o].concat(this._imageRows)};t.prototype.scrollToAnchor=function(){if(this._anchorImageIdData){var e=-1;if(this._anchorImageIdData.anchorId)if(this._anchorImageIdData.isHeader){var t=this._layout.getrowIndexByLabel(this._anchorImageIdData.anchorId);e=void 0!==t?t:-1}else for(var n=this._anchorMap.keys(),r=n.next();!r.done;){if(this._anchorMap.get(r.value)===this._anchorImageIdData.anchorId){e=this._layout.getRowIndexFromImageIndex(r.value);break}r=n.next()}e<0&&(e=this._layout.getRowIndexFromImageIndex(this._anchorImageIdData.imageIndex));if(e>=0){this._isAnchorScroll=!0;this._scrollToRow(e)}}};t.prototype.getRowHeight=function(e){var t=e.index;return this._layout.getRowHeight(t)};t.prototype.render=function(){return r.createElement("div",{id:"GalleryContainer"+this.props.id,className:"ms-normalize",style:{display:"block",minHeight:"1px",width:"100%",overflow:"auto"},onKeyDown:this.handleKeyDown,onWheel:this.releaseAnchorImageIdDataLock,ref:this.parentGalleryRef},r.createElement("div",{id:this.props.id,className:this.props.id,"data-is-scrollable":!0,style:{height:"calc(100vh - "+this.galleryTopOffset+"px)",float:"left",width:"100%",contain:"layout",overflowY:"scroll",overflowX:"hidden",scrollbarWidth:"none"},ref:this.galleryRef,onScroll:this._onGalleryScroll},r.createElement(this._renderExplorePhotos,null),r.createElement(a.AllPhotosTilesList,{rows:this._imageRows,focusZoneComponentRef:this._focusZoneRef,rowRenderer:this._renderRowForTilesList,containerWidth:this.state.containerWidth,onRenderTileListParent:this.props.onRenderTileListParent,onListPagesUpdated:this._onListPagesUpdated})),this.props.enableScrubber&&r.createElement(i.Scrubber,{galleryId:this.galleryId,layout:this._layout,rows:this._scrubberRows,key:"timeline",focusZoneRef:this._focusZoneRef,releaseAnchorImageIdDataLock:this.releaseAnchorImageIdDataLock,listOwnerClass:"AllPhotosTilesList",activatingZone:this.props.squareTiles?this.props.galleryPaddingRight_squaretiles[this.screenResIndex]:this.props.galleryPaddingRight_aspect[this.screenResIndex],scrollToRow:this._scrollToRow}),r.createElement(f.ItemDemander,{ref:this.itemDemanderRef,itemDemandManager:this._itemDemandManager}))};t.prototype.getLastImageIndex=function(){if(this._imageRows.length>0){var e=this._imageRows.length-1,t=this._imageRows[e].items.length-1;return this._imageRows[e].items[t].index}return 0};t.prototype._updateAnchorData=function(){if(!this._anchorImageIdDataLock&&this._imageRows.length>0){var e=this.getLastImageIndex();if(this._imageIndexIsVisible(e)){this._anchorImageIdData={imageIndex:e,anchorId:this._anchorMap.get(e),isHeader:!1};this._anchorImageIdDataLock=!0}else if(this.galleryRef&&this.galleryRef.current){var t=this.galleryRef.current.scrollTop,n=this._layout.getRowIndexFromYPosition(t),r=this._imageRows[n].isLabel,i=this._layout.getFirstPhotoIndexInClosestImageRow(n),s=void 0;s=r?this._layout.getFullLabelByIndex(i):this._anchorMap.get(i);this._anchorImageIdData={imageIndex:i,anchorId:s,isHeader:r};this._anchorImageIdDataLock=!0}}};t.prototype._calculateMinMaxVisibleRows=function(e){var t=Number.POSITIVE_INFINITY,n=-1,r=0;e.forEach(function(e){if(e.isVisible){r++;t=Math.min(e.startIndex,t);n=Math.max(e.startIndex+e.itemCount-1,n)}});this._visibleRowsMinMax=r>0?{min:t,max:n}:void 0};t.prototype._imageIndexIsVisible=function(e){return!!this._visibleImagesMinMax&&(e>=this._visibleImagesMinMax.min&&e<=this._visibleImagesMinMax.max)};t.prototype._renderRow=function(e,t,i,s,o){var u,a,f,l=this,v=this._imgLoadingScheduler,m=this._itemDemandManager,g=this._layout,y=this._imageRows,b=this.props.squareTiles?this.props.imagePadding_squaretiles[this.screenResIndex]:this.props.imagePadding_aspect[this.screenResIndex],w=this.props.groupHeaderMarginTop[this.screenResIndex],E=this.props.groupHeaderMarginBottom[this.screenResIndex],S=this.props.groupHeaderLeadingMargin[this.screenResIndex],x=this.props.labelRowHeight,T=this.props.squareTiles?this.props.midRowGroupGap_squaretiles[this.screenResIndex]:this.props.midRowGroupGap_aspect[this.screenResIndex],N=this.props.squareTiles?this.props.galleryPadding_squaretiles[this.screenResIndex]:this.props.galleryPadding_aspect[this.screenResIndex],C=this.props.squareTiles?this.props.galleryPaddingRight_squaretiles[this.screenResIndex]:this.props.galleryPaddingRight_aspect[this.screenResIndex],k=0;v.setUserIsScrolling(s);var L=y[e];if(L){if(L.isLabel){var A=y[e+1],O=[],M=0,_=S;k=A.items[A.items.length-1].index;u=void 0;a=void 0;f=void 0;var D=0,P=0,H=!0;A.items.forEach(function(n){var r=g.getGrandParentLabelByIndex(n.index);a=g.getLabelByIndex(n.index);f=n.index<k?g.getLabelByIndex(n.index+1):void 0;var i=c.calculateMargins(b,T,N,C,u,a,f);if(H){if(d.Locale.isRightToLeft)P=i.right;else{D=_+i.left;0===l.screenResIndex&&(M-=_)}H=!1}else d.Locale.isRightToLeft?M+=i.right:M+=i.left;M+=n.vwidth;if(n.index<k)d.Locale.isRightToLeft?M+=i.left:M+=i.right;else if(d.Locale.isRightToLeft){D=_;M-=_}if(a!==f){O.push({rowIndex:e,rowKey:t,label:g.getHeaderByIndex(n.index),grandParentLabel:r,locations:[],imageStartIndex:g.getStartIdxByLabel(a),imageCount:g.getImgsCountByLabel(a),labelRowHeight:x,labelRowWidth:M,margins:{top:w,bottom:E,left:D,right:P},layout:g,onLocationHeaderClick:l.props.onLocationHeaderClick});M=0;H=!0}u=a});var B=O;return r.createElement("div",{key:t,id:t,style:i,"data-list-index":e,onClick:this._onClickRow},B.map(function(e){var t=e.rowKey,i=e.label,s=e.imageStartIndex,o=e.imageCount,u=e.labelRowHeight,a=e.labelRowWidth,f=e.margins,c=e.layout,p=e.rowIndex;return r.createElement(h.AllPhotosGroupHeader,n.__assign({key:t+"_"+i,rowKey:t,label:i,imageStartIndex:s,imageCount:o,labelRowHeight:u,labelRowWidth:a,margins:f,layout:c,rowIndex:p,focusZoneRef:l._focusZoneRef},e))}))}u=void 0;a=void 0;f=void 0;k=L.items[L.items.length-1].index;var j=n.__assign({},i,{paddingBottom:y.length===e+1?"32px":"0px"});return r.createElement("div",{className:"row","data-list-index":e,key:t,id:t,style:j,onClick:this._onClickRow},L.items.map(function(t){a=g.getLabelByIndex(t.index);f=t.index<k?g.getLabelByIndex(t.index+1):void 0;var n=c.calculateMargins(b,T,N,C,u,a,f),i="Image-"+e+"-"+t.index;u=a;return r.createElement(p.AllPhotosImage,{key:i,index:t.index,rowIndex:e,imgLoadingScheduler:v,layout:g,itemDemandManager:m,margin:b,itemWidthInCssPixels:t.vwidth,itemHeightInCssPixels:t.vheight,isScrolling:s,imageOnLoad:l.onImageLoad,registerAnchorId:l.registerAnchorId,deregisterAnchorId:l.deregisterAnchorId,openItemOverlay:l.props.openItemOverlay,onRenderTile:l.props.onRenderTile,onRenderTileAnnotation:l.props.onRenderTileAnnotation,margins:n,telemetryCallbacks:l.props.telemetryCallbacks,useSquareTiles:l.props.squareTiles,imageErrorThumbnail:l.props.imageErrorThumbnail,videoErrorThumbnail:l.props.videoErrorThumbnail})}))}console.warn("Requested row to render is not in rows array!");return r.createElement("span",{key:t},"An error has occurred rendering this row.")};t.prototype._getThumbnailLoadLoadTime=function(){if(window.performance){for(var e=this._imgLoadingScheduler.getUrlsThatHaveLoaded(),t=Number.POSITIVE_INFINITY,n=0,r=0,i=0,s=0;s<e.length;s++)if(e[s]){var o=window.performance.getEntriesByName(e[s]);for(var u in o)if(u){var a=o[u].duration;a>10&&(t=Math.min(t,a));n=Math.max(n,a);r+=a;i++}}if(t!==Number.POSITIVE_INFINITY)return{minTime:t,maxTime:n,avgTime:0!==i?r/i:0}}return{}};t.defaultProps={id:"ReactGridGallery",squareTiles:!1,labelRowHeight:25,targetHeight:1e3,photoCount:0,groupToCount:E,widths:S};return t}(r.Component);t.Gallery=x});
define("@ms/items-view-addon-photos/lib/components/scrubber/Scrubber",["require","exports","tslib","react","./ScrubberCallout","./StateAnimator","./ScrubberText","@uifabric/utilities/lib/css","ODCPhotosItemsScope_css","@ms/items-view-utilities/lib/locale/Locale"],function(e,t,n,r,i,s,o,u,a,f){"use strict";a=a.Scrubber_9;Object.defineProperty(t,"__esModule",{value:!0});var l;l=0;var c=267,h=267,p=300,d=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._scrubberTexts=[];n._calloutDataByYPos=[];n._show=function(){n._fader.animateTo(1,c);n._clearHideTimer();n._scrubberIsActivated=!0};n._hideScrubber=function(){n._fader.animateTo(0,h,p);n._scrubberIsActivated=!1};n._onParentScrolled=function(e){var t=n.props.layout.getTotalHeight();if(t>0){var r=e.target.scrollTop/n.props.layout.getTotalHeight()*t;n.setState({scrollTop:r,showCursorAtMouse:n.state.containsMouse});n._interacted();n.state.containsMouse||n._mouseDownFlag||(n._hideTimer=window.setTimeout(n._hideScrubber,300))}};n._handleWindowMouseMove=function(e){if(n.state.clickInScrubberRegion||n.state.containsMouse){e.preventDefault();var t=n._getMouseYPositionFromEvent(e);if(n.state.clickInScrubberRegion){var r=n._calculateScrollRow(t);n._scrollToRow(r)}if(n._scrubberCalloutRef&&n._scrubberCalloutRef.current){var i=n._clampMouseYPosToScrubber(t);n._scrubberCalloutRef.current.setTopValue(n._calculateCallOutTopValue(i));var s=n._calloutDataByYPos[i].calloutLabel;n._scrubberCalloutRef.current.setCalloutTextValue(s)}}};n._handleWindowMouseDown=function(e){n._mouseDownFlag=!0;e.clientX>=window.innerWidth-n._totalWidth-n.state.scrollbarWidth&&n.props.releaseAnchorImageIdDataLock()};n._onMouseEnter=function(e){n.setState({containsMouse:!0,showCursorAtMouse:!0});n._interacted()};n._onMouseLeave=function(e){n.setState({containsMouse:!1});n.state.clickInScrubberRegion||n._hideScrubber()};n._onMouseDown=function(e){e.preventDefault();var t=n._getMouseYPositionFromEvent(e),r=n._calculateScrollRow(t);n._scrollToRow(r);n.setState({clickInScrubberRegion:!0,mouseY:t,showCursorAtMouse:!0})};n._handleWindowMouseUp=function(e){if(n.state.clickInScrubberRegion||n._mouseDownFlag){n.setState({clickInScrubberRegion:!1});n.state.containsMouse||n._hideScrubber();n._mouseDownFlag=!1}};n._handleMouseWheel=function(e){n._scrollBox&&(n._scrollBox.scrollTop+=e.deltaY)};n._onMouseUp=function(e){};n.state={scrollbarWidth:0,height:0,scrollTop:0,mouseY:0,containsMouse:!1,clickInScrubberRegion:!1,showCursorAtMouse:!1,opacity:0,areLabelsAtStart:n.props.layout.getAreLabelsAtStart()};n._id="ScrubberComponent_"+l;l++;n._callOutLabelCount=0;n._callOutLabelsInitialized=!1;n._calloutTagWidth=100;n._calloutTagHeight=35;n._calloutOffsetFromScrollbar=30;n._calloutTextOffsetOnScrollBarSide=0;n._calloutTextOffset=5;n._interactableWidth=100;n._scrollPosLineWidth=32;n._totalWidth=n._calloutTagWidth+n._calloutOffsetFromScrollbar;n._scrubberCalloutRef=r.createRef();n._fader=new s.StateAnimator(function(e){n.setState({opacity:e})},n.state.opacity);n._mouseDownFlag=!1;n._scrubberIsActivated=!1;return n}t.prototype.getSelectedLabelRowIndex=function(){var e=this._getCalloutYPosition();return this._calloutDataByYPos[e].closestLabelRowIndex};t.prototype.componentDidUpdate=function(){this._updateLayout()};t.prototype.shouldComponentUpdate=function(e,t){var n=!1;t.scrollbarWidth===this.state.scrollbarWidth&&t.height===this.state.height||(n=!0);if(this.props.rows!==e.rows){this._callOutLabelsInitialized=!1;n=!0}n&&this._buildScrubberData(e,t);return!0};t.prototype.componentDidMount=function(){window.addEventListener("mouseup",this._handleWindowMouseUp);window.addEventListener("mousemove",this._handleWindowMouseMove);window.addEventListener("mousedown",this._handleWindowMouseDown);this._updateLayout()};t.prototype.componentWillUnmount=function(){window.removeEventListener("mouseup",this._handleWindowMouseUp);window.removeEventListener("mousemove",this._handleWindowMouseMove);window.removeEventListener("mousedown",this._handleWindowMouseDown)};t.prototype.render=function(){if(this._callOutLabelsInitialized&&this._callOutLabelCount<2)return r.createElement("div",{id:this._id});var e={position:"absolute",pointerEvents:this.state.containsMouse?"auto":"none",width:this._totalWidth+"px",height:this.state.height+"px",right:"",left:"",opacity:this.state.opacity};f.Locale.isRightToLeft?e.left=this.state.scrollbarWidth+"px":e.right=this.state.scrollbarWidth+"px";var t=n.__assign({},e,{pointerEvents:"auto",width:this._scrubberIsActivated?this._interactableWidth+"px":this.props.activatingZone+"px"});if(0===this.props.layout.getRows().length)return r.createElement("div",{className:u.css(""+a.timeLine),style:e,id:this._id,key:this._id});var s,o=this._getCalloutYPosition();o-this._calloutTagHeight/2<0&&(o=this._calloutTagHeight/2);s=r.createElement("g",{key:"scroll_pos_line"},r.createElement("rect",{id:"Fill",x:f.Locale.isRightToLeft?0:this._totalWidth-this._scrollPosLineWidth,y:o,width:"32",height:"2",rx:"1",fill:"#0078D4"}),r.createElement("circle",{id:"Oval",cx:f.Locale.isRightToLeft?this._scrollPosLineWidth:this._totalWidth-this._scrollPosLineWidth,cy:o+1,r:"3",fill:"#0078D4"}));this.state.showCursorAtMouse&&(o=this._clampMouseYPosToScrubber(this.state.mouseY));var l=this._scrubberTexts;return r.createElement("div",{id:this._id,className:u.css(""+a.scrubber),key:this._id,onWheel:this._handleMouseWheel},r.createElement("div",{className:u.css(""+a.timeLineInteractive),style:t,onMouseEnter:this._onMouseEnter,onMouseDown:this._onMouseDown,onMouseLeave:this._onMouseLeave,onMouseUp:this._onMouseUp}),r.createElement("div",{className:u.css(""+a.timeLine),style:e},r.createElement("svg",{"aria-hidden":"true",height:this.state.height,width:this._totalWidth,style:{cursor:"default"},key:"timeline"},l,s),this._calloutDataByYPos[o]&&r.createElement(i.ScrubberCallout,{caption:this._getCallOutLabelForInitialization(o),height:this._calloutTagHeight,offsetFromScrollbar:this._calloutOffsetFromScrollbar-15,textOffsetOnScrollbarSide:this._calloutTextOffsetOnScrollBarSide,top:this._calculateCallOutTopValue(o),width:this._calloutTagWidth,textOffset:this._calloutTextOffset,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave,ref:this._scrubberCalloutRef})))};t.prototype._interacted=function(){this._show()};t.prototype._clearHideTimer=function(){if(this._hideTimer){window.clearTimeout(this._hideTimer);this._hideTimer=void 0}};t.prototype._jumptoFirstLabel=function(e){for(var t="",n=e;n<this._calloutDataByYPos.length;n++)if(""!==this._calloutDataByYPos[n].calloutLabel){t=this._calloutDataByYPos[n].calloutLabel;break}return t};t.prototype._getCallOutLabelForInitialization=function(e){var t=this._calloutDataByYPos[e].calloutLabel;return 0===t.localeCompare("")?this._jumptoFirstLabel(e):t};t.prototype._updateLayout=function(){var e=document.getElementById(this._id);if(e&&e.parentElement){var t=e.parentElement;if(t&&this.props.listOwnerClass){var n=t.getElementsByClassName(this.props.listOwnerClass),r=document.getElementById(this.props.galleryId);if(0!==n.length&&r){var i=n[0],s=r.offsetWidth-(i.offsetWidth>0?i.offsetWidth:r.clientWidth),o=r.clientHeight;s===this.state.scrollbarWidth&&o===this.state.height||this.setState({scrollbarWidth:s,height:o});if(!this._scrollBox){this._scrollBox=r;this._scrollBox.onscroll=this._onParentScrolled}}else console.warn("Updating layout but unable to find elements")}else console.warn("Updating layout but unable to find elements")}};t.prototype._scrollToRow=function(e){this.props.scrollToRow(e)};t.prototype._calculateScrollRow=function(e){var t=this._convertFromMouseYToScrollPos(e);return this.props.layout.getRowIndexFromYPosition(t)};t.prototype._getMouseYPositionFromEvent=function(e){var t=document.getElementById(this._id);if(t){var n=t.getBoundingClientRect();return e.clientY-n.top}return e.clientY};t.prototype._clampMouseYPosToScrubber=function(e){var t=this.state.scrollbarWidth,n=this.state.height-2*t,r=Math.max(t,e);r=Math.min(r,t+n);return Math.round(r)};t.prototype._buildScrubberData=function(e,t){var n=this;if(!(this._callOutLabelsInitialized&&this._callOutLabelCount<2)){this._scrubberTexts=[];this._calloutDataByYPos=[];this._callOutLabelCount=0;var i=[],s=[],u=e.layout.getRows();if(0!==u.length){var a,l,c=e.layout.getTotalHeight(),h=t.scrollbarWidth,p=t.height-2*h,d=new Map,v=0,m={closestLabelRowIndex:-1,calloutLabel:""};u.forEach(function(r,o){var u=e.layout.getRowLevelLabel(1,o)||"",f=e.layout.getRowLevelLabel(0,o);if(f!==m.calloutLabel){n._callOutLabelCount++;for(var g=Math.round(h+r.y/c*p);v<g;)n._calloutDataByYPos[v++]=m;var y=e.layout.getRowLevelLabel(2,o);y||(y="");if(y!==l){var b=void 0;t.areLabelsAtStart?b={text:y,yPosition:g,showText:!1,key:f+";"+u+";"+y,priority:2}:l&&(b={text:l,yPosition:g,showText:!1,key:m.calloutLabel+";"+a+";"+l,priority:2});if(b){s.push(b);i.push(b)}l=y}if(u!==a){var w=void 0;t.areLabelsAtStart?w={text:u,yPosition:g,showText:!1,key:f+";"+u+";"+y,priority:1}:a&&(w={text:a,yPosition:g,showText:!1,key:m.calloutLabel+";"+a+";"+l,priority:1});if(w){s.push(w);i.push(w)}}m={closestLabelRowIndex:o,calloutLabel:f}}var E=d.has(l)?d.get(l):0;E+=1;d.set(l,E);a=u});for(var g=h+p;v<=g;)this._calloutDataByYPos[v++]=m;if(u.length>0&&!t.areLabelsAtStart){var y=e.layout.getRowLevelLabel(2,u.length-1);if(y){var b={text:y,yPosition:g,showText:!1,key:y+"lastitem",priority:3};i.push(b);s.push(b)}}if(s.length>0){s[0].priority=3;s[s.length-1].priority=3;s.sort(function(e,t){var n=t.priority-e.priority;return 0!==n?n:void 0!==d.get(t.key)&&void 0!==d.get(e.key)?d.get(t.key)-d.get(e.key):0});s.forEach(function(e,t){for(var n=!1,r=0;r<t;r++){var i=s[r];if(i.showText&&Math.abs(e.yPosition-i.yPosition)<25){n=!0;break}}e.showText=!n})}var w=0;i.map(function(e,t){if(e.showText&&""!==e.text){e.key.split(";")[2]!==i[t].text&&(e.priority<3||0===t)?n._scrubberTexts[w]=r.createElement("circle",{key:"month_"+e.key,cx:f.Locale.isRightToLeft?n._scrollPosLineWidth:n._totalWidth-n._scrollPosLineWidth,cy:e.yPosition,r:"3",fill:"#f3f2f1"}):n._scrubberTexts[w]=r.createElement(o.ScrubberText,{x:f.Locale.isRightToLeft?n._calloutOffsetFromScrollbar+n._calloutTextOffsetOnScrollBarSide:n._totalWidth-n._calloutOffsetFromScrollbar-n._calloutTextOffsetOnScrollBarSide,item:e,key:"text_"+e.key});w++}});this._callOutLabelsInitialized=!0}}};t.prototype._getCalloutYPosition=function(){var e=this.props.layout.getTotalHeight(),t=this.state.scrollbarWidth,n=this.state.height-2*t,r=t+this.state.scrollTop/e*n;return r=Math.round(r)};t.prototype._convertFromMouseYToScrollPos=function(e){var t=this.state.scrollbarWidth,n=this.props.layout.getTotalHeight();return Math.round(n*(e-t)/(this.state.height-2*t))};t.prototype._calculateCallOutTopValue=function(e){var t=this.state.height-this._calloutTagHeight,n=e-this._calloutTagHeight/2;return n<0?0:n>t?t:n};return t}(r.Component);t.Scrubber=d});
define("@ms/items-view-addon-photos/lib/components/scrubber/ScrubberCallout",["require","exports","tslib","react","@uifabric/utilities/lib/css","ODCPhotosItemsScope_css","@ms/items-view-utilities/lib/locale/Locale"],function(e,t,n,r,i,s,o){"use strict";s=s.ScrubberCallout_3;Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onMouseDown=function(e){n.props.onMouseDown(e)};n._onMouseUp=function(e){n.props.onMouseUp(e)};n._onMouseEnter=function(e){n.props.onMouseEnter(e)};n._onMouseLeave=function(e){n.props.onMouseLeave(e)};n.state={fittedTagWidth:n.props.width,tagWidth:n.props.width};n.textCallout=r.createRef();n.calloutRef=r.createRef();return n}t.prototype.getFittedTagWidth=function(){return this.textCallout.current?this.textCallout.current.textLength.baseVal.value:this.props.width};t.prototype.getTagWidth=function(){var e=this.props.width;if(this.textCallout.current){var t=this.textCallout.current.textLength.baseVal.value;e=t;if(t<this.props.width)return this.props.width}return e};t.prototype.setCalloutTextValue=function(e){this.textCallout&&this.textCallout.current&&(this.textCallout.current.innerHTML=e)};t.prototype.setTopValue=function(e){this.calloutRef&&this.calloutRef.current&&(this.calloutRef.current.style.top=e.toString()+"px")};t.prototype.componentDidUpdate=function(){this.getFittedTagWidth()!==this.state.fittedTagWidth&&this.setState({fittedTagWidth:this.getFittedTagWidth(),tagWidth:this.getTagWidth()})};t.prototype.render=function(){var e=this.props,t=e.textOffset,n=e.caption,u=e.top,a=e.height,f=e.offsetFromScrollbar,l=e.textOffsetOnScrollbarSide,c={position:"absolute",left:"",right:"",top:u};o.Locale.isRightToLeft?c.left=f+"px":c.right=f+"px";return n?r.createElement("svg",{className:i.css(""+s.calloutMain),style:c,width:this.state.tagWidth+2*t,height:a,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave,key:"callout_display",ref:this.calloutRef},r.createElement("button",null,r.createElement("rect",{height:a,width:this.state.tagWidth,style:{fill:"rgb(255,255,255)",strokeWidth:0,stroke:"rgb(128,128,128)",cursor:"pointer"},key:"callout_bg"})),r.createElement("text",{ref:this.textCallout,className:i.css(""+s.textCallout),textAnchor:/MSIE|Trident/.test(window.navigator.userAgent)&&o.Locale.isRightToLeft?"start":"end",x:o.Locale.isRightToLeft?l+t:this.state.tagWidth-l+t,y:a/2+5,fill:"rgb(0;0;0)",key:"cursor_text"},n)):r.createElement("div",null)};return t}(r.Component);t.ScrubberCallout=u});
define("@ms/items-view-addon-photos/lib/components/scrubber/StateAnimator",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.update=function(){if(n._isUpdateActive){if(n._value!==n._animEndValue){var e=+new Date-n._animStartTime-n._animationDelay;if(e<0){window.requestAnimationFrame(n.update);return}var t=e/n._animDurationMs;t<0&&(t=0);t>1&&(t=1);var r=n._animStartValue+(n._animEndValue-n._animStartValue)*t;n._value=r;n._onValueChanged&&n._onValueChanged(r);1===t&&(n._isUpdateActive=!1)}window.requestAnimationFrame(n.update)}};this._isUpdateActive=!1;this._animStartTime=+new Date;this._animStartValue=-1;this._animEndValue=-1;this._animDurationMs=100;this._animationDelay=0;this._value=t;this._onValueChanged=e}e.prototype.startUpdates=function(){if(!this._isUpdateActive){this._isUpdateActive=!0;window.requestAnimationFrame(this.update)}};e.prototype.animateTo=function(e,t,n){void 0===n&&(n=0);if(e!==this._animEndValue){this._animStartTime=+new Date;this._animStartValue=this._value;this._animEndValue=e}this._animDurationMs=t;this._animationDelay=n;this.startUpdates()};return e}();t.StateAnimator=n});
define("@ms/items-view-addon-photos/lib/components/scrubber/ScrubberText",["require","exports","tslib","react","ODCPhotosItemsScope_css","@ms/items-view-utilities/lib/locale/Locale"],function(e,t,n,r,i,s){"use strict";i=i.ScrubberText_0;Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props.item;return r.createElement("g",null,r.createElement("rect",{x:s.Locale.isRightToLeft?this.props.x-12:this.props.x-20,y:e.yPosition-7.5,height:"25px",width:"35px",fill:"rgb(255,255,255)",fillOpacity:"0.6"}),r.createElement("text",{textAnchor:/MSIE|Trident/.test(window.navigator.userAgent)&&s.Locale.isRightToLeft?"start":"end",x:s.Locale.isRightToLeft?this.props.x-10:this.props.x+10,y:e.yPosition+10,className:i.normalText},e.text))};return t}(r.Component);t.ScrubberText=o});
define("@ms/items-view-addon-photos/lib/components/gallery/GalleryLayout",["require","exports","./layout/CalculateMargins","office-ui-fabric-react/lib/utilities/selection/interfaces","office-ui-fabric-react/lib/Utilities","../../util/typedArrayUtils","./layout/DirectedGraph","../../models/interfaces/IGroupToCount"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){var e=this;this.handleResizeAfterRotate=function(t,n){if(e._selection&&!0===e._selection.isIndexSelected(t)){var r=1/(e._widths[t]/e._currentTargetHeight),i=Math.floor(r*e._currentTargetHeight);e._widths[t]=i}};this.setSelection=function(t){e._event.off(e._selection);e._selection=t;e._event.on(e._selection,r.SELECTION_CHANGE,e.imageSelectionOnChangedHandler)};this.imageSelectionOnChangedHandler=function(){e._event.off(e._selection);if(e._selection){var t=e._selection.getSelectedIndices().slice();e.updateSelectedIndices(t)}e.updateGroupHeaderSelection();e._event.on(e._selection,r.SELECTION_CHANGE,e.imageSelectionOnChangedHandler)};this.groupSelectionOnChangedHandler=function(t,n,i){if(e._selection){e._event.off(e._selection);var s=e._selection.isRangeSelected(t,n);if(s!==i){var o=t+n;e._selection.setChangeEvents(!1);for(var u=t;u<o;u++)e._selection.setIndexSelected(u,!s,!1);e._selection.setChangeEvents(!0)}var a=e._selection.getSelectedIndices().slice();e.updateSelectedIndices(a);e._event.on(e._selection,r.SELECTION_CHANGE,e.imageSelectionOnChangedHandler)}};this.updateGroupHeaderSelection=function(t,n){if(e._selection)if(void 0!==t&&void 0!==n){e._groupHeaderShouldSelectMap.set(t,n);e.setGroupHeaderSelectionState(t,n)}else if(0===e._selection.getSelectedCount())e._selectAllHeaders(!1);else if(e._selection.isAllSelected())e._selectAllHeaders(!0);else{var r=e._getSelectionChangedIndices(e._prevSelectedIndices,e._currentSelectedIndices),i=0;r.forEach(function(t){if(t>=i){var n=e.getLabelByIndex(t),r=e.getStartIdxByLabel(n),s=e.getImgsCountByLabel(n);i=r+s;var o=!0,u=e._currentSelectedIndices.indexOf(r);if(u<0)o=!1;else for(var a=1;a<s;a++)if(e._currentSelectedIndices[u+a]!==r+a){o=!1;break}e._groupHeaderShouldSelectMap.get(n)!==o&&e.updateGroupHeaderSelection(n,o)}})}};this.setGroupHeaderSelectionState=function(t,n){var r=e._groupHeaderSetSelectionRequestMap.get(t);if(r){var i=!1;n?i=n:e._groupHeaderShouldSelectMap.get(t)&&(i=e._groupHeaderShouldSelectMap.get(t));r(i)}};this.rows=[];this._groupIds=s.makeUint16Array(0);this._groupIdToLabel=[];this._groupIdToHeader=[];this._groupIdToParentLabel=[];this._groupIdToGrandParentLabel=[];this._currentGroupHeader="";this._event=new i.EventGroup(void 0);this._labelToImgStartIdxMap=new Map;this._labelToImgsCountMap=new Map;this._labelToRowIndex=new Map;this._groupHeaderShouldSelectMap=new Map;this._currentSelectedIndices=[];this._prevSelectedIndices=[];this._groupHeaderSetSelectionRequestMap=new Map;this._widths=s.makeUint16Array(0);this._currentTargetHeight=0}e.prototype.setLayoutData=function(e,t,n,r){this._currentTargetHeight=n;this._groupIds=s.makeUint16Array(r);for(var i=0,o=0,a=0,f=0;f<e.length;++f){var l=e[f],c=l.count,h=u.getLabelsFromGroupToCount(l),p=h[0];this._groupIdToParentLabel[o]=h[1];this._groupIdToGrandParentLabel[o]=h[2];this._groupIdToLabel[o]=p;this._groupIdToHeader[o]=l.header?l.header:p;this._labelToImgStartIdxMap.set(p,a);this._labelToImgsCountMap.set(p,c);this._groupHeaderShouldSelectMap.set(p,!1);for(var d=0;d<c;d++){this._groupIds[i]=o;i++}o++;a+=c}var v=Math.floor(n*(4/3));this._widths=s.makeUint16Array(Math.max(r,t.length));for(d=0;d<this._widths.length;++d)this._widths[d]=v;for(d=0;d<t.length;++d)0!==t[d]&&(this._widths[d]=t[d])};e.prototype.checkgroupHeaderlastTile=function(e){var t=!1;if(""!==this._currentGroupHeader){var n=this.getStartIdxByLabel(this._currentGroupHeader),r=this.getImgsCountByLabel(this._currentGroupHeader);if(void 0!==n&&void 0!==r){e===n+r-1&&(t=!0)}}return t};e.prototype.checkgroupHeaderFirstTile=function(e){var t=!1;if(""!==this._currentGroupHeader){var n=this.getStartIdxByLabel(this._currentGroupHeader);void 0!==n&&e===n&&(t=!0)}return t};e.prototype.getSelection=function(){return this._selection};e.prototype.disposeEvent=function(){this._event.dispose()};e.prototype.registerGroupHeaderSetStateFuncByLabel=function(e,t){this._groupHeaderSetSelectionRequestMap.set(e,t)};e.prototype.deregisterGroupHeaderSetStateFuncByLabel=function(e){this._groupHeaderSetSelectionRequestMap.set(e,void 0)};e.prototype.getGroupHeaderShouldSelect=function(e){return!!this._groupHeaderShouldSelectMap.get(e)};e.prototype.getRows=function(){return this.rows};e.prototype.getAreLabelsAtStart=function(){return!1};e.prototype.getStartIdxByLabel=function(e){var t=this._labelToImgStartIdxMap.get(e);return void 0!==t?t:-1};e.prototype.getImgsCountByLabel=function(e){var t=this._labelToImgsCountMap.get(e);return void 0!==t?t:-1};e.prototype.getrowIndexByLabel=function(e){return this._labelToRowIndex.get(e)};e.prototype.updateSelectedIndices=function(e){this._prevSelectedIndices=this._currentSelectedIndices.slice();this._currentSelectedIndices=e};e.prototype.getLabel=function(e){return this._groupIdToLabel[e]||e.toString()};e.prototype.getHeader=function(e){return this._groupIdToHeader[e]||e.toString()};e.prototype.getLabelByIndex=function(e){var t=this._groupIds[e];return void 0!==t?this.getLabel(t):""};e.prototype.getHeaderByIndex=function(e){var t=this._groupIds[e];return void 0!==t?this.getHeader(t):""};e.prototype.getRowLevelLabel=function(e,t){var n=this.getFirstPhotoIndexInClosestImageRow(t),r=this._groupIds[n];return 0===e?this._groupIdToLabel[r]:1===e?this._groupIdToParentLabel[r]:2===e?this._groupIdToGrandParentLabel[r]:""};e.prototype.getGrandParentLabel=function(e){return this._groupIdToGrandParentLabel[e]};e.prototype.getGrandParentLabelByIndex=function(e){var t=this._groupIds[e];return this.getGrandParentLabel(t)};e.prototype.getFullLabelByIndex=function(e){return this.getGrandParentLabelByIndex(e)?this.getLabelByIndex(e)+";"+this.getGrandParentLabelByIndex(e):this.getLabelByIndex(e)};e.prototype.getPhotosCount=function(){return this._widths.length};e.prototype.getWidths=function(){return this._widths};e.prototype.getTargetHeight=function(){return this._currentTargetHeight};e.prototype.getGroupIds=function(){return this._groupIds};e.prototype.isGroupHeaderRow=function(e){var t=!1;this.rows[e]&&this.rows[e].isLabel&&(t=!0);return t};e.prototype.getFirstPhotoIndexInClosestImageRow=function(e){e>=this.rows.length&&(e=this.rows.length-1);this.rows[e].isLabel&&e++;return this.rows[e].items[0].index};e.prototype.getVisibleImageIndexRange=function(e,t){if(t>=this.rows.length)console.warn("getVisibleImageIndexRange received invalid end Row value ",e,t,this.rows.length);else if(e>=this.rows.length)console.warn("getVisibleImageIndexRange received invalid start row value ",e,t,this.rows.length);else{this.rows[e].isLabel&&e++;this.rows[t].isLabel&&t--;if(t>=this.rows.length)console.warn("end Row value is invalid ",e,t,this.rows.length);else if(e>=this.rows.length)console.warn("startRow row value is invalid ",e,t,this.rows.length);else{if(!(e>t)){var n=this.rows[e].items[0].index,r=this.rows[t].items.length;return{min:n,max:this.rows[t].items[r-1].index}}console.warn("unexpected startRow > endRow ",e,t,this.rows.length)}}};e.prototype.getRowHeight=function(e){return this.rows[e].height&&e>=0&&e<this.rows.length?this.rows[e].height:0};e.prototype.getTotalHeight=function(){if(0===this.rows.length)return 0;var e=this.rows[this.rows.length-1];return e?e.y+e.height:0};e.prototype.getRowIndexFromImageIndex=function(e){return this._getRowIndexFromImgIdxBinarySearch(e)};e.prototype.getRowIndexFromYPosition=function(e){return function(e,t){for(var n=0,r=e.length-1;n<=r;){var i=Math.floor(n+(r-n)/2),s=e[i];if(s){var o=t(s);if(o>0)n=i+1;else{if(!(o<0))return i;r=i-1}}}return r>=e.length-1?e.length-1:0}(this.rows,function(t){return e>=t.y+t.height?1:e<t.y?-1:0})};e.prototype.buildAllRows=function(e){var t=this;this.rows=[];if(e.containerWidth<=0)return this.rows;this.rows=this._buildImageRows(e);this._insertLabelRows(e);this.rows.forEach(function(e,n){if(0===n)e.y=0;else{var r=t.rows[n-1];e.y=r.y+r.height}});return this.rows};e.prototype._selectAllHeaders=function(e){var t=this;this._groupHeaderShouldSelectMap.forEach(function(n,r){n!==e&&t.updateGroupHeaderSelection(r,e)})};e.prototype._getItemWidthToMatchRowHeight=function(e,t){var n=this.getWidths(),r=this.getTargetHeight();return t*(n[e.index]/r)};e.prototype._getAdjustedSquareTileHeight=function(e){var t=e.rowHeight+2*e.margin,n=e.containerWidth-e.startRowLeadingMargin-e.endRowTrailingMargin,r=n/(Math.floor(n/t)*t);r=Math.min(e.maxRowScaleUpFactor,r);return Math.floor(e.rowHeight*r)};e.prototype._adjustImageRowToFitContainer=function(e,t){var r=this,i=e.items;if(i.length>0){var s,o,u,a=0,f=0,l=i[i.length-1].index;i.forEach(function(e){o=r.getLabelByIndex(e.index);u=e.index<l?r.getLabelByIndex(e.index+1):void 0;var i=n.calculateMargins(t.margin,t.midRowGroupGap,t.startRowLeadingMargin,t.endRowTrailingMargin,s,o,u);f+=i.left+i.right;a+=r._getItemWidthToMatchRowHeight(e,t.rowHeight);s=o});var c=t.containerWidth-f,h=c/a;e.fillsSpace=!(h>t.maxRowScaleUpFactor);h=Math.min(t.maxRowScaleUpFactor,h);var p=Math.round(t.rowHeight*h),d=0,v=0;i.forEach(function(e){e.vheight=p;var t=r._getItemWidthToMatchRowHeight(e,p),n=Math.round(t);e.vwidth=n;d+=n});if(e.fillsSpace&&0!==(v=d-c)){var m=0;v>0?m=1:v<0&&(m=-1);for(var g=0;0!==v&&v;){e.items[g].vwidth-=m;g=(g+1)%e.items.length;v-=m}}}};e.prototype._buildImageRows=function(e){var t=this,n=[],r=this.getWidths(),i=this.getGroupIds();if(0===r.length||0===i.length)return n;var s=this.getTargetHeight()/e.rowHeight,u=e.containerWidth*s,a={targetRowWidth:u,maxRowWidth:2*u,margin:e.margin*s,targetRowNumItems:0,enableDateStitching:e.enableDateStitching,midRowGroupGap:e.midRowGroupGap,startRowLeadingMargin:e.startRowLeadingMargin,endRowTrailingMargin:e.endRowTrailingMargin};if(e.squareTiles){var f=Math.floor((e.containerWidth-e.startRowLeadingMargin-e.endRowTrailingMargin)/(e.rowHeight+2*e.margin));a.targetRowNumItems=f}for(var l=o.calculateRowBreaks(r,i,a),c=-1,h=l.length-1;h>=0;h--){for(var p=[],d=c+1;d<=l[h];d++)p.push({index:d,vheight:0,vwidth:0});c=l[h];n.push({isLabel:!1,items:p,height:0,width:0,y:0})}if(e.squareTiles){var v=this._getAdjustedSquareTileHeight(e);n.forEach(function(e){e.items.forEach(function(e){e.vheight=v;e.vwidth=v})})}else n.forEach(function(n){t._adjustImageRowToFitContainer(n,e)});n.forEach(function(t){t.height=t.items[0].vheight+2*e.margin});if(!e.squareTiles){var m=0;for(h=0;h<=n.length;h++){var g=!0;h>=0&&h<n.length&&(g=n[h].fillsSpace);if(g){var y=h-m,b=h-1;if(y<=b){var w=e.rowHeight,E=e.rowHeight;y-1>=0&&(w=n[y-1].height);b+1<n.length&&(E=n[b+1].height);var S=e.rowHeight;e.rowHeight=(w+E)/2;for(d=y;d<=b;d++){this._adjustImageRowToFitContainer(n[d],e);n[d].height=n[d].items[0].vheight+2*e.margin}e.rowHeight=S}m=0}else m++}}return n};e.prototype._getItemLabel=function(e){return this.getLabelByIndex(e.index)};e.prototype._insertLabelRows=function(e){var t,n=this,r=0,i=[];this._labelToRowIndex.clear();this.rows.forEach(function(s,o){for(var u=s.items,a="",f=!1,l=0;l<u.length;l++){var c=n._getItemLabel(u[l]);if(a!==c){a=c;var h=n.getFullLabelByIndex(u[l].index);!1===n._labelToRowIndex.has(h)&&n._labelToRowIndex.set(h,r)}c!==t&&(f=!0)}if(f){i.push({isLabel:!0,height:e.groupHeaderMarginTop+e.labelRowHeight+e.groupHeaderMarginBottom,items:[],width:0,y:0});r++}t=n._getItemLabel(u[u.length-1]);i.push(s);r++});this.rows=i};e.prototype._getSelectionChangedIndices=function(e,t){for(var n=[],r=[],i=0;i<e.length;i++)n[e[i]]=!0;for(i=0;i<t.length;i++)n[t[i]]?delete n[t[i]]:n[t[i]]=!0;n.forEach(function(e,t){r.push(t)});return r};e.prototype._getRowIndexFromImgIdxBinarySearch=function(e){if(e)for(var t=0,n=this.rows.length-1;t<=n;){var r=Math.floor(t+(n-t)/2),i=0;this.rows[r].isLabel&&i++;var s=this.rows[r+i];if(!s)break;if(e<s.items[0].index)n=r-1;else{if(!(e>s.items[s.items.length-1].index))return r;t=r+1}}return-1};return e}();t.GalleryLayout=a});
define("@ms/items-view-addon-photos/lib/components/gallery/layout/CalculateMargins",["require","exports","@ms/items-view-utilities/lib/locale/Locale"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.calculateMargins=function(e,t,r,i,s,o,u){var a={top:e,right:e,bottom:e,left:e};if(n.Locale.isRightToLeft){u||(a.left=i);s?o!==s&&(a.right+=t):a.right=r}else{u||(a.right=i);s?o!==s&&(a.left+=t):a.left=r}return a}});
define("@ms/items-view-addon-photos/lib/components/gallery/layout/DirectedGraph",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=[],r=[],i=[];t.calculateRowBreaks=function(e,t,s){var o,u,a=Math.min(e.length,t.length),f=s.targetRowWidth,l=void 0===f?100:f,c=s.maxRowWidth,h=void 0===c?150:c,p=s.margin,d=void 0===p?0:p,v=s.sizePenaltyPower,m=void 0===v?4:v,g=s.lastRowUndersizedPenaltyFactor,y=void 0===g?.1:g,b=s.midRowGroupBreakingPenalty,w=void 0===b?1e5:b,E=s.targetRowNumItems,S=void 0===E?0:E,x=s.rowNumItemsPenalty,T=void 0===x?10:x,N=s.enableDateStitching,C=void 0===N||N,k=s.midRowGroupGap,L=void 0===k?0:k,A=s.startRowLeadingMargin,O=void 0===A?0:A,M=s.endRowTrailingMargin,_=void 0===M?0:M,D=s.wrappingGroupRowUndersizedPenalty,P=void 0===D?50:D,H=2*d;if(n.length!==a){(n=new Array(a)).forEach(function(e){void 0});(r=new Array(a)).forEach(function(e){0})}var B=-1,j=a-1;for(o=0;o<a;o++){var F=Number.MAX_VALUE,I=_,q=void 0,R=t[o],U=o<a-1?t[o+1]:void 0,z=0;for(u=o;u>=0;u--){z++;q=t[u];I+=z>1?H:O;u!==o&&q!==t[u+1]&&(I+=L);I+=e[u];if(0!==S&&z>S&&F!==Number.MAX_VALUE)break;if(0===S&&h&&I>h&&F!==Number.MAX_VALUE)break;var W=u-1,X=void 0;u>0&&(X=t[u-1]);var V=0,$=0;if(0!==S){$=S-z;V=T*Math.abs($)}else if(l){$=l-I;var J=Math.abs($/l);V=Math.pow(J,m)}$>0&&(U!==R&&X!==q||o===j?V*=y:U===R&&(V+=P));C?q===R||U!==R&&X!==q||(V+=w):q!==R&&(V+=Math.abs(q-R)*w);W>=0&&(V+=n[W]);if(V<F){F=V;B=W}}n[o]=F;r[o]=B}o=a-1;u=0;i[u++]=o;for(;;){var K=r[o];if(-1===K)break;i[u++]=K;o=K}i.length=u;return i}});
define("@ms/items-view-addon-photos/lib/services/imgLoadingScheduler",["require","exports","./imageSrcItem","./imageSrcCache"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._stateById={};this._srcCache=new r.ImageSrcCache;this._resetLoadingStatusArrays();this.numLoading=0;this._numVisibleNonGifsThatAreLoading=0;this._visibleDeferredItems={};this._hiddenDeferredItems={};this._config=e;this.minVisibleImageIndex=0;this.maxVisibleImageIndex=0;this._userIsScrolling=!1;this.numVisibleImagesLoadingByIndex=[];this.numVisibleImagesNeededByIndex=[];this.numHiddenImagesLoadingByIndex=[];this.numHiddenImagesNeededByIndex=[];this._firstImageLoadTimeFromStart=0;this._urlsThatHaveLoaded=[]}e.prototype.setVisibleImageIndexRange=function(e){if(e){this.minVisibleImageIndex=e.min;this.maxVisibleImageIndex=e.max;this.updateStats();this._maybeLoadDeferredItems()}};e.prototype.firstImageLoadTimeFromStart=function(){return this._firstImageLoadTimeFromStart};e.prototype.setUserIsScrolling=function(e){this._userIsScrolling=e};e.prototype.updateStats=function(){var e=this;this._resetLoadingStatusArrays();this._numVisibleNonGifsThatAreLoading=0;var t=3;"one"===this._config.progressiveMode?t=1:"two"===this._config.progressiveMode&&(t=2);var n=function(n){if(r._stateById.hasOwnProperty(n)){var i=r._stateById[n];r.validateItemStateVisible(i);var s=i.getHighestThumbnailIndexNeeded(),o=i.getThumbnailIndexThatIsLoading(),u=o<=s,a=t;1===a&&0===i.item.thumbnails[0].url.indexOf("data:")&&(a=2);i.isGif&&(a=2);var f=[0,1,2];1===a?f=[2]:2===a&&(f=[0,2]);f.forEach(function(t){u&&(i.isVisible?t>=o&&t<=s&&e.numVisibleImagesNeededByIndex[t]++:t>=o&&t<=s&&e.numHiddenImagesNeededByIndex[t]++)});if(i.isLoading)if(i.isVisible){r.numVisibleImagesLoadingByIndex[o]++;i.isGif||r._numVisibleNonGifsThatAreLoading++}else r.numHiddenImagesLoadingByIndex[o]++}},r=this;for(var i in this._stateById)n(i);var s=this.numVisibleImagesLoadingByIndex[0]+this.numVisibleImagesLoadingByIndex[1]+this.numVisibleImagesLoadingByIndex[2],o=this.numHiddenImagesLoadingByIndex[0]+this.numHiddenImagesLoadingByIndex[1]+this.numHiddenImagesLoadingByIndex[2];this.numLoading=s+o};e.prototype.onItemLoaded=function(e,t){var n=this._stateById[e];if(n){n.loadedHeightInPixels=t.naturalHeight;n.loadedWidthInPixels=t.naturalWidth;if(n.imageComponent){if(n.isLoading){var r=n.imageComponent.getSrc(),i=n.isReloading,s=n.getThumbnailIndexThatIsLoading();n.setLoading(!1);this.validateItemStateVisible(n);if(!i){n.loadedSrc=r;n.isGif&&s>0||this._urlsThatHaveLoaded.push(r);n.nextThumbnailIndex>2&&console.warn("unexpeted thumbnail index "+n.nextThumbnailIndex+" in image load complete callback.\n                             itemState.imageComponent.src = "+n.imageComponent.getSrc()+" id="+n.item.id);n.nextThumbnailIndex++;this._srcCache.set(n.item.id,n.nextThumbnailIndex,r)}this._setNextImageFor(n)}}else console.warn("imageComponent no longer exists onItemLoaded")}else console.warn("got a load callback for an unknown item!");this.updateStats();this._maybeLoadDeferredItems();return this.numLoading};e.prototype.validateItemStateVisible=function(e){this.isOverscanRow(e)?e.isVisible=!1:e.isVisible=!0};e.prototype.hasImageItem=function(e){return this._stateById.hasOwnProperty(e)};e.prototype.isOverscanRow=function(e){var t=e.imageIndex;return t<this.minVisibleImageIndex||t>this.maxVisibleImageIndex};e.prototype.activateItem=function(e,t,r,i){r||console.warn("imageComponent undefined");var s;s=this._stateById.hasOwnProperty(e)?this._stateById[e]:new n.ImageSrcItem(e,t,i,r);this.validateItemStateVisible(s);s.imageComponent&&this.deactivateItem(e);this._stateById[e]=s;var o=this._srcCache.get(s.item.id);if(o){var u=!0;t.thumbnails.forEach(function(e){e.url===o.src&&(u=!1)});if(u){s.nextThumbnailIndex=0;s.loadedHeightInPixels=0;s.imageIndex=i;s.item=t}else{s.loadedSrc=o.src;s.nextThumbnailIndex=o.thumbIndex;s.isReloading=!0}}this._addDeferredItemState(s);this.updateStats();this._maybeLoadDeferredItems()};e.prototype.deactivateItem=function(e){var t=this._stateById[e];if(t){t.isLoading&&t.setLoading(!1);delete this._stateById[e];this._removeDeferredItemState(t.imageUid)}};e.prototype.getUrlsThatHaveLoaded=function(){return this._urlsThatHaveLoaded};e.prototype.clearUrlsThatHaveLoaded=function(){this._urlsThatHaveLoaded=[]};e.prototype._addDeferredItemState=function(e){e.isVisible?this._visibleDeferredItems[e.imageUid]=e:this._hiddenDeferredItems[e.imageUid]=e};e.prototype._removeDeferredItemState=function(e){delete this._visibleDeferredItems[e];delete this._hiddenDeferredItems[e]};e.prototype._maybeLoadDeferredItems=function(){this._loadDeferredItemsHelper(this._visibleDeferredItems)&&this._loadDeferredItemsHelper(this._hiddenDeferredItems)};e.prototype._loadDeferredItemsHelper=function(e){if(this.numLoading>this._config.maxParallelRequests)return!1;for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];if(!this._shouldDeferItem(n)){this._removeDeferredItemState(n.imageUid);this._setNextImageFor(n);if(this.numLoading>this._config.maxParallelRequests)return!1}}return!0};e.prototype._setNextImageFor=function(e){this.validateItemStateVisible(e);if(this._shouldDeferItem(e))this._addDeferredItemState(e);else if(e.isLoading)console.warn("item is already loading in call to setNextImageFor");else{if(e.isReloading){e.setLoading(!0);e.setDomSrc(e.loadedSrc)}else{var t=e.getUrlAndSizeToLoad(this._config.resizeMode,this._config.progressiveMode);if(t){var n=t.imageURL,r=t.height,i=t.width;e.setLoading(!0);var s=this._getNextImageSrcFor(e,n,e.item.id,r,i);e.setDomSrc(s)}}this.updateStats()}};e.prototype._shouldDeferItem=function(e){this.validateItemStateVisible(e);if(e.isVisible&&e.isReloading)return!1;if(this.numLoading>=this._config.maxParallelRequests)return!0;if("one"===this._config.progressiveMode){var t=this.numVisibleImagesNeededByIndex[this.numVisibleImagesNeededByIndex.length-1];if(!e.isVisible&&t>0)return!0}else{for(var n=e.getThumbnailIndexThatIsLoading(),r=0,i=0,s=0;s<n-1;s++){r+=this.numVisibleImagesNeededByIndex[s];i+=this.numHiddenImagesNeededByIndex[s]}var o=this.numVisibleImagesNeededByIndex[n];if(r>0)return!0;if(this._userIsScrolling&&i>0)return!0;if(!e.isVisible&&o>0)return!0;if(!e.isVisible&&i>0)return!0}return!!(e.isGif&&e.getThumbnailIndexThatIsLoading()>0&&this._numVisibleNonGifsThatAreLoading>0)};e.prototype._resetLoadingStatusArrays=function(){this.numVisibleImagesLoadingByIndex=[0,0,0];this.numVisibleImagesNeededByIndex=[0,0,0];this.numHiddenImagesLoadingByIndex=[0,0,0];this.numHiddenImagesNeededByIndex=[0,0,0]};e.prototype._getNextImageSrcFor=function(e,t,n,r,i){if(0===t.indexOf("data"))return t;if("exact"===this._config.resizeMode&&i&&r){var s=i.toString(),o=r.toString(),u=t.split("?");if(2===u.length){var a=u[1].split("&"),f=[],l=!1,c=!1;a.forEach(function(e){var t=e.split("=");if("width"===t[0]){t[1]=s;l=!0}else if("height"===t[0]){t[1]=o;c=!0}f.push(t.join("="))});l||f.push("width="+s);c||f.push("height="+o);t=u[0]+"?"+f.join("&")}else t+="?width="+s+"&height="+o}return t};return e}();t.ImgLoadingScheduler=i});
define("@ms/items-view-addon-photos/lib/services/imageSrcItem",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r){this.imageUid=e;this.imageComponent=r;this.item=t;this.loadedSrc="";this.nextThumbnailIndex=0;this.isLoading=!1;this.isReloading=!1;this.isVisible=!1;this.imageIndex=n;this.loadedHeightInPixels=0;this.loadedWidthInPixels=0;this.isGif=".gif"===t.extension}e.prototype.getThumbnailIndexThatIsLoading=function(){return this.isReloading?this.nextThumbnailIndex-1:this.nextThumbnailIndex};e.prototype.getHighestThumbnailIndexNeeded=function(){for(var e=this._getItemSizeInDevicePixels().height,t=0;t<this.item.thumbnails.length;t++)if(this.item.thumbnails[t].height>=e)return t;return this.item.thumbnails.length-1};e.prototype.hasExactSizeNeeded=function(){var e=this._getItemSizeInDevicePixels();return this.loadedWidthInPixels===e.width&&this.loadedHeightInPixels===e.height};e.prototype.getUrlAndSizeToLoad=function(e,t){if(0!==this.item.thumbnails.length){var n=this.getHighestThumbnailIndexNeeded();if(this.nextThumbnailIndex>n){if("exact"===e)return;if(this.hasExactSizeNeeded())return}"one"===t&&0===this.item.thumbnails[0].url.indexOf("data:")&&(t="two");this.isGif&&"one"===t&&(t="two");"one"===t&&this.nextThumbnailIndex<n?this.nextThumbnailIndex=n:"two"===t?1===this.nextThumbnailIndex&&(this.nextThumbnailIndex=n):2===this.nextThumbnailIndex&&(this.nextThumbnailIndex=n);if(!(this.nextThumbnailIndex>=this.item.thumbnails.length)){var r,i=this.item.thumbnails[this.nextThumbnailIndex].url,s=this.item.thumbnails[this.nextThumbnailIndex].height;if(0===i.indexOf("data"))return{imageURL:i,width:-1,height:-1};var o=this.loadedHeightInPixels,u=this._getItemSizeInDevicePixels(),a=u.height;if("exact"===e){if(this.hasExactSizeNeeded())return;if(this.nextThumbnailIndex===n){r=u.width;if((s=u.height)>this.item.thumbnails[n].height||r>this.item.thumbnails[n].width){r=this.item.thumbnails[n].width;s=this.item.thumbnails[n].height;if(this.loadedWidthInPixels===r||this.loadedHeightInPixels===s)return}}}else if(o>=a)return;return{imageURL:i,height:s,width:r}}}};e.prototype.setDomSrc=function(e){if(e){if(this.imageComponent){if(this.imageComponent.getSrc()===e){this.setLoading(!1);return}this.imageComponent.setSrc(e)}}else console.warn("unexpected empty src value in setItemDomSrc")};e.prototype.setLoading=function(e){if(this.isLoading!==e){this.isLoading=e;e||(this.isReloading=!1)}else console.warn("attempted to set isLoading to the value it already has.")};e.prototype._getItemSizeInDevicePixels=function(){var e=Math.floor(this.imageComponent.props.itemHeightInCssPixels*window.devicePixelRatio);return{width:Math.floor(this.imageComponent.props.itemWidthInCssPixels*window.devicePixelRatio),height:e}};return e}();t.ImageSrcItem=n});
define("@ms/items-view-addon-photos/lib/services/imageSrcCache",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._cache={};this._array=[];this._totalMemoryUsed=0}e.prototype.set=function(e,t,n){var r,i=+new Date;if(this._cache[e]){this._totalMemoryUsed-=this._cache[e].src.length;(r=this._cache[e]).thumbIndex=t;r.src=n;r.lastAccessed=i}else{r={id:e,thumbIndex:t,src:n,lastAccessed:i};this._array.push(r);this._cache[e]=r}this._totalMemoryUsed+=r.src.length;this._clean()};e.prototype.get=function(e){this._cache[e]&&(this._cache[e].lastAccessed=+new Date);return this._cache[e]};e.prototype._reduceToNLatest=function(e){var t=this;this._array.sort(function(e,t){return t.lastAccessed-e.lastAccessed});this._array=this._array.slice(0,e);this._cache={};this._totalMemoryUsed=0;this._array.forEach(function(e){t._cache[e.id]=e;t._totalMemoryUsed+=e.src.length})};e.prototype._clean=function(){this._array.length>1e3&&this._reduceToNLatest(800);this._totalMemoryUsed>104857600&&this._reduceToNLatest(Math.floor(this._array.length/2))};return e}();t.ImageSrcCache=n});
define("@ms/items-view-addon-photos/lib/components/allPhotosTilesList/AllPhotosTilesList",["require","exports","tslib","react","@uifabric/experiments/lib/TilesList","ODCPhotosItemsScope_css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.getPageHeight=function(e,t,r){if(void 0!==e&&e>=0&&r){var i=Math.min(e+r-1,n.props.rows.length-1),s=n.props.rows[e],o=n.props.rows[i];return o.y+o.height-s.y}return 0};n.getPageStyle=function(e){var t=e.height;if(e.items){var r=e.startIndex,i=Math.min(r+e.items.length-1,n.props.rows.length-1),s=n.props.rows[r],o=n.props.rows[i];t=o.y+o.height-s.y}for(var u=[],a=0;a<e.itemCount;a++)u[e.startIndex+a]=n.props.containerWidth;e.data.pageWidths=u;return{widths:u,width:n.props.containerWidth,height:t}};n._renderRow=function(e,t){if(n.props.rowRenderer)return n.props.rowRenderer(e);console.warn("RowRenderer is undefined when trying to render row!")};n.listRef=r.createRef();n.state={items:[]};return n}t.prototype.componentDidUpdate=function(e){e.rows!==this.props.rows&&this._generateItemsAsRows()};t.prototype.render=function(){var e={getPageStyle:this.getPageStyle,getPageHeight:this.getPageHeight,onPagesUpdated:this.props.onListPagesUpdated,role:"listbox"},t=r.createElement(i.TilesList,{ref:this.listRef,focusZoneComponentRef:this.props.focusZoneComponentRef,items:this.state.items,cellsPerPage:1,listProps:e});return r.createElement("div",{className:"AllPhotosTilesList"},this.props.onRenderTileListParent?this.props.onRenderTileListParent({},t):void 0)};t.prototype._generateItemsAsRows=function(){for(var e=[],t={key:"AllPhotosView",items:[],mode:0,minRowHeight:100},n=0;n<this.props.rows.length;++n){var r=this.props.rows[n];t.items.push({key:"TilesListRowCell_"+n,content:{rowIndex:n,rowData:r},desiredSize:{width:this.props.containerWidth,height:r.height},onRender:this._renderRow})}e.push(t);this.setState({items:e})};return t}(r.Component);t.AllPhotosTilesList=s});
define("@uifabric/experiments/lib/TilesList",["require","exports","tslib","./components/TilesList/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@uifabric/experiments/lib/components/TilesList/index",["require","exports","tslib","./TilesList","./TilesList.types"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("@uifabric/experiments/lib/components/TilesList/TilesList",["require","exports","tslib","react","office-ui-fabric-react/lib/List","office-ui-fabric-react/lib/FocusZone","office-ui-fabric-react/lib/Utilities","ODCPhotosItemsScope_css","office-ui-fabric-react/lib/Shimmer"],function(e,t,n,r,i,s,o,u,a){"use strict";u=u.TilesList_5;Object.defineProperty(t,"__esModule",{value:!0});var f=u,l=100,c=3,h=function(e){n.__extends(t,e);function t(t,i){var s=e.call(this,t,i)||this;s._onRenderPage=function(e,t){for(var i,u,l=e.page,h=e.className,p=n.__rest(e,["page","className"]),d=l.items,v=l.data,m=d||[],g=[],y=s.state.cells[l.startIndex-1],b=s.state.cells[l.startIndex+l.itemCount],w=m.length,E=0,S=function(e){for(var t=m[e].grid,h=t.isPlaceholder,p=t.maxRowCount,d=[],S=v.pageWidths[l.startIndex+e],x=0,T=!1,N=function(){var u=m[e],a=l.startIndex+e,h=v.rows[a];if(h){h!==i&&x++;if("number"==typeof p&&x>p){T=!0;return"break"}i=h}var g=v.cellSizes[a];if(i){var y=i.scaleFactor,b=i.isLastRow,w=i.maxScaleFactor;if(w){var N=Math.min(w,t.maxScaleFactor);g={width:g.width*N,height:2===t.mode?g.height*N:t.minRowHeight}}else if((2===t.mode||3===t.mode)&&(!b||y<=t.maxScaleFactor)){N=Math.min(t.maxScaleFactor,y);g={width:g.width*N,height:2===t.mode?g.height*N:t.minRowHeight}}}var C=function(e){return r.createElement("div",{key:t.key+"-item-"+u.key+(e?"-"+e:""),"data-item-index":a,className:o.css("ms-List-cell",s._onGetCellClassName(),(l={},l["ms-TilesList-cell--firstInRow "+f.cellFirstInRow]=!!h,l)),style:n.__assign({},s._onGetCellStyle(u,i))},s._onRenderCell(u,g));var l};if(u.isPlaceholder&&0!==t.mode){var k=Math.floor(S/(t.spacing+g.width)),L=k*c;E=k*g.width+t.spacing*(k-1);for(var A=0;A<L;A++)d.push(C(A))}else{E=g.width/3;d.push(C())}};e<w&&m[e].grid===t;e++){if("break"===N())break}if(T)for(;e<w&&m[e].grid===t;e++);var C,k=y&&y.grid===t,L=b&&b.grid===t,A=t.spacing/2,O=r.createElement("div",{key:t.key,className:o.css("ms-TilesList-grid",(C={},C[""+f.grid]=0!==t.mode,C[""+f.shimmeredList]=h,C)),style:{width:S+"px",margin:-A+"px",marginTop:k?"0":t.marginTop-A+"px",marginBottom:L?"0":t.marginBottom-A+"px"}},d);g.push(h?r.createElement(a.Shimmer,{key:e,customElementsGroup:O,width:E}):O);u=e},x=0;x<w;){S(x);x=u}return r.createElement("div",n.__assign({},p,{className:o.css(h,s._onGetPageClassName())}),g)};s._getPageSpecification=function(e,t){s._pageSpecificationCache&&s._pageSpecificationCache.width!==t.width&&(s._pageSpecificationCache=void 0);s._pageSpecificationCache||(s._pageSpecificationCache={width:t.width,byIndex:{}});var n=s._pageSpecificationCache;if(n.byIndex[e])return n.byIndex[e];for(var r,i=s.state.cells,o=s.props.cellsPerPage,u=void 0===o?l:o,a=Math.min(i.length,e+u),f=0,c=0,h=e,p=!0,d={},v={},m={};h<a;){var g=i[h].grid,y=g.maxRowCount;f=0;c=h;var b=t.width+g.spacing;m[h]=b;var w=d[h]={scaleFactor:1};if(0!==g.mode){for(var E=0,S=!1;h<a&&i[h].grid===g;h++){if("number"==typeof y&&E>=y){S=!0;break}var x=i[h].aspectRatio;if(f+(N=x*g.minRowHeight+g.spacing)>b){var T=g.spacing*(h-c);w.scaleFactor=(b-T)/(f-T)}f+=N;v[h]={width:x*g.minRowHeight,height:g.minRowHeight};if(f>b){f=N;c=h;w=d[h]={scaleFactor:1};E++}}!i[h]||i[h].grid!==g||S?w.isLastRow=!0:p=!1;if(f<b){T=g.spacing*(h-c);w.scaleFactor=(b-T)/(f-T);if((2===g.mode||3===g.mode)&&w.isLastRow&&h-c>0)for(var N=(f-T)/(h-c)+g.spacing,C=f,k=h;;k++){if(C+N>b){var L=g.spacing*(k-c);w.maxScaleFactor=(b-L)/(C-L);break}C+=N}}!p&&w.scaleFactor>(2===g.mode||3===g.mode?g.maxScaleFactor:1)&&(r=i.slice(c,h));if(S)for(;h<i.length&&i[h].grid===g;)h++}else{p=!0;v[h]={width:t.width,height:0};h++}}var A={itemCount:h-(r?r.length:0)-e,data:{pageWidths:m,rows:d,extraCells:r,cellSizes:v}};n.byIndex[e]=A;return A};s._onGetCellClassName=function(){return f.listCell};s._onGetPageClassName=function(){return f.listPage};s._onGetCellStyle=function(e,t){var n=e.grid,r=n.mode,i=n.maxScaleFactor,s=e.grid;if(0===r)return{};var o=e.aspectRatio||1,u=s.spacing/2,a=2===r||3===r,f=o*s.minRowHeight;return{flex:a?o+" "+o+" "+f+"px":"0 0 "+f+"px",maxWidth:(t&&t.maxScaleFactor?f*Math.min(t.maxScaleFactor,i):a&&(!t||!t.isLastRow||t.scaleFactor<=i)?f*i:f)+"px",margin:e.isPlaceholder?0:u+"px",borderStyle:e.isPlaceholder?"solid":"none",borderWidth:e.isPlaceholder?u+"px":0}};s.listRef=r.createRef();s.state={cells:s._getCells(t.items)};return s}t.prototype.componentWillReceiveProps=function(e){e.items!==this.props.items&&this.setState({cells:this._getCells(e.items)})};t.prototype.componentWillUpdate=function(e,t){t.cells!==this.state.cells&&(this._pageSpecificationCache=void 0)};t.prototype.render=function(){var e=this.state.cells,t=this.props,u=t.className,a=(t.onActiveElementChanged,t.items,t.cellsPerPage,t.ref),f=t.role,l=t.focusZoneComponentRef,c=n.__rest(t,["className","onActiveElementChanged","items","cellsPerPage","ref","role","focusZoneComponentRef"]);return r.createElement(s.FocusZone,n.__assign({role:f},c,{ref:a,componentRef:l,className:o.css("ms-TilesList",u),direction:s.FocusZoneDirection.bidirectional,onActiveElementChanged:this.props.onActiveElementChanged}),r.createElement(i.List,n.__assign({items:e,role:f?"presentation":void 0,getPageSpecification:this._getPageSpecification,onRenderPage:this._onRenderPage,ref:this.listRef,usePageCache:!0},this.props.listProps)))};t.prototype.scrollToIndex=function(e,t){var n=this;void 0===t&&(t=i.ScrollToMode.auto);this.listRef&&this.listRef.current&&(0===this.state.cells[e].grid.mode?this.listRef.current.scrollToIndex(e,function(t){var r=n.state.cells[e];return r&&void 0!==r.desiredHeight?r.desiredHeight:0},t):this.listRef.current.scrollToIndex(e,void 0,t))};t.prototype.getTotalListHeight=function(){return this.listRef&&this.listRef.current&&this.listRef.current.getTotalListHeight?this.listRef.current.getTotalListHeight():0};t.prototype._onRenderCell=function(e,t){if(0===e.grid.mode)return r.createElement("div",{className:o.css(f.header)},e.onRender(e.content,{width:0,height:0}));var n=1/e.aspectRatio;return r.createElement("div",{role:"presentation",className:o.css(f.cell),style:3===e.grid.mode?{height:e.grid.minRowHeight+"px"}:{paddingTop:(100*n).toFixed(2)+"%"}},r.createElement("div",{role:"presentation",className:o.css(f.cellContent)},e.onRender(e.content,t)))};t.prototype._getCells=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(p(i))for(var s=i.spacing,o=void 0===s?0:s,u=i.maxScaleFactor,a=void 0===u?1.5:u,f=i.marginBottom,l=void 0===f?0:f,c=i.marginTop,h=void 0===c?0:c,d=i.minAspectRatio,v=void 0===d?.5:d,m=i.maxAspectRatio,g=void 0===m?3:m,y={minRowHeight:i.minRowHeight,spacing:o,mode:i.mode,key:"grid-"+i.key,maxScaleFactor:a,marginTop:i.isPlaceholder?0:h,marginBottom:i.isPlaceholder?0:l,isPlaceholder:i.isPlaceholder,maxRowCount:i.maxRowCount},b=0,w=i.items;b<w.length;b++){var E=w[b],S=E.desiredSize,x=Math.min(g,Math.max(v,S&&S.width/S.height||1));t.push({aspectRatio:x,content:E.content,onRender:E.onRender,grid:y,key:E.key,isPlaceholder:E.isPlaceholder,desiredHeight:S?S.height:void 0})}else t.push({aspectRatio:1,content:i.content,onRender:i.onRender,grid:{minRowHeight:0,spacing:0,mode:0,key:"grid-header-"+i.key,maxScaleFactor:1,marginBottom:0,marginTop:0,isPlaceholder:i.isPlaceholder},key:"header-"+i.key,isPlaceholder:i.isPlaceholder})}return t};return t}(r.Component);t.TilesList=h;function p(e){return!!e.items}});
define("@uifabric/experiments/lib/components/TilesList/TilesList.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none";e[e.stack=1]="stack";e[e.fill=2]="fill";e[e.fillHorizontal=3]="fillHorizontal"}(t.TilesGridMode||(t.TilesGridMode={}))});
define("@ms/items-view-addon-photos/lib/components/demander/ItemDemander",["require","exports","tslib","react","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view/lib/private/facets/DemandFacets","../../models/facets/WidthsFacets","../../models/keys/WidthsPageKeyFacet","@ms/items-view/lib/private/facets/SetFacets"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentDidUpdate=function(){this.props.itemDemandManager.resetCanceledKeys(this.props.itemCacheDispatch)};t.prototype.render=function(){return null};return t}(r.Component);t.ItemDemandInvalidator=l;var c=s.withCurrentItemSet()(i.connectToItemCache(function(e,t){var n=t.itemKey,r=t.min,i=t.max;if(r>=0&&i>=0){var s=e.demandItemFacet(u.widthsPointerFacet,n);if(s){var l=e.demandItemFacet(f.childItemsFacet,s.itemKey);if(l)for(var c=0,h=l.itemKeys;c<h.length;c++){var p=h[c];if(a.widthsPageKeyFacet.matches(p)){var d=a.widthsPageKeyFacet.deserialize(p),v=d.offset,m=v,g=v+d.count;if(Math.min(i,g)-Math.max(r,v)>=0){e.demandItemFacet(f.childItemsFacet,p);if(e.isItemFacetResolved(o.errorFacet,p)){var y=e.demandItemFacet(o.errorFacet,p);y&&"Canceled"===y.name&&t.itemDemandManager.registerCanceledPageKey(p)}}if(m>=i)break}}}}return{itemCacheDispatch:e.dispatch,itemDemandManager:t.itemDemandManager}})(l)),h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={min:-1,max:-1};return n}t.prototype.render=function(){return r.createElement(c,{itemDemandManager:this.props.itemDemandManager,min:this.state.min,max:this.state.max})};t.prototype.setVisibleImageRange=function(e,t){e>=0&&t>=0&&t>=e?this.setState({min:e,max:t}):console.warn("Set Visible Range on Widths pager with invalid range values!")};return t}(r.PureComponent);t.ItemDemander=h});
define("@ms/items-view-addon-photos/lib/components/demander/ItemDemandManager",["require","exports","@ms/items-view/lib/private/operations/resetItems"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._currentRenderedMinImageIndex=-1;this._canceledKeys=[]}e.prototype.requestPageForDemand=function(e,t){if(this._currentRenderedMinImageIndex<0||e<this._currentRenderedMinImageIndex){this._currentRenderedMinImageIndex=e;this._currentRenderedMinImagePageKey=t}return this._currentRenderedMinImagePageKey?this._currentRenderedMinImagePageKey:t};e.prototype.registerCanceledPageKey=function(e){this._canceledKeys.push(e)};e.prototype.resetCanceledKeys=function(e){for(var t,r=0,i=this._canceledKeys;r<i.length;r++){var s=i[r];e(n.resetItems({items:(t={},t[s]=!0,t)}))}this._canceledKeys.length=0};e.prototype.resetCurrentlyRenderedData=function(){this._currentRenderedMinImageIndex=-1;this._currentRenderedMinImagePageKey=void 0};return e}();t.ItemDemandManager=r});
define("@ms/items-view-addon-photos/lib/components/groupHeader/AllPhotosGroupHeader",["require","exports","@ms/items-view/lib/private/components/decorators/connectToItemCache","../../models/keys/PhotosRootItemSetKeyFacet","../../models/keys/GroupKeyFacet","../../models/facets/GroupToCountFacets","../../models/facets/PhotoLocationFacet","@ms/items-view/lib/private/facets/SetFacets","../../models/interfaces/IGroupToCount","@ms/items-view/lib/private/components/decorators/selectors","../groupHeader/GroupHeader"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=n.connectToItemCache(function(e,t){var n=t.itemKey,f=t.imageStartIndex,l=[];if(r.photosRootItemSetKeyFacet.matches(n)){var c=e.demandItemFacet(s.allGroupToCountsPointerFacet,n),h=c?e.demandItemFacet(s.allGroupToCountsFacet,c.itemKey):void 0;if(h){for(var p="",d=0,v=0,m=h;v<m.length;v++){var g=m[v];f===d&&(p=a.getLabelsFromGroupToCount(g).join(";"));d+=g.count}if(p.length>0){var y=i.groupKeyFacet.serialize({photosRootItemSetKeyPart:r.photosRootItemSetKeyFacet.deserialize(n),label:p}),b=e.demandItemFacet(u.childItemsFacet,y);if(b&&b.itemKeys){for(var w=0;w<b.itemKeys.length;++w){var E=b.itemKeys[w];if(e.isItemFacetResolved(o.photoLocationFacet,E)){var S=e.demandItem({location:o.photoLocationFacet},E).location;S&&l.push(S)}}return{locations:l}}b&&console.error("Retrieved a childItemsFacet with no child keys when retrieving group for key: ",y)}}}});t.AllPhotosGroupHeader=f.withCurrentItemSet()(c(l.GroupHeader))});
define("@ms/items-view-addon-photos/lib/components/groupHeader/GroupHeader",["require","exports","tslib","react","react","office-ui-fabric-react/lib/Utilities","@uifabric/utilities/lib/css","office-ui-fabric-react/lib/Check","ODCPhotosItemsScope_css","office-ui-fabric-react/lib/Button","./GroupHeader.resx","@ms/utilities-strings/lib/index","office-ui-fabric-react/lib/Utilities"],function(e,t,n,r,i,s,o,u,a,l,c,h,p){"use strict";var f=a.Check_8;a=a.GroupHeader_1;Object.defineProperty(t,"__esModule",{value:!0});t.SELECTION_GROUP_LABEL="GroupHeaderCell";t.CHECK_PADDING=4;t.LOCATION_CHILD_PADDING=30;var d={height:"36px",fontSize:"18px"},v=a,m=f,g=function(e){n.__extends(f,e);function f(t){var n=e.call(this,t)||this;n.setSelectionState=function(e){n.setState({isSelected:e})};n._checkBoxClassName=function(){var e;return[s.css("ms-Tile-check",v.check,m.checkHost,(e={},e[m.hostShowCheck]=n.state.isModal,e)),v.groupHeaderCheckbox].join(" ")};n._getCheckboxId=function(){return n.props.label+"Checkbox"};n._onClick=function(e){var t=!n.state.isSelected;n.props.layout.updateGroupHeaderSelection(n.props.label,t);e.stopPropagation();e.preventDefault()};n._onKeyDown=function(e){n._isClicked=!1;if(e.keyCode===p.KeyCodes.enter||e.keyCode===p.KeyCodes.space){e.stopPropagation();e.preventDefault();var t=!n.state.isSelected;n.setSelectionState(t);n.props.layout.updateGroupHeaderSelection(n.props.label,t)}};n._handleMouseDownEvent=function(e){n._isClicked=!0};n._handleKeyDownEvent=function(e){n._isClicked=!1};n._handleOutlineFocus=function(e){n.setState({focus:!0});if(n._isClicked){e.target.classList.remove(v.tabbing);e.target.classList.add(v.clicking)}else{e.target.classList.remove(v.clicking);e.target.classList.add(v.tabbing)}};n._onClickRenderCheck=function(e){n._onClick(e)};n._onBlurRenderCheck=function(){n.setState({focus:!1})};n._onMouseEnterRenderCheck=function(){n.setState({hover:!0})};n._onMouseLeaveRenderCheck=function(){n.setState({hover:!1})};n.state={hover:!1,isSelected:t.layout.getGroupHeaderShouldSelect(t.label),isModal:!1,focus:!1};n._menuRef=i.createRef();n._labelRef=i.createRef();n._checkDivRef=i.createRef();n._locationDivRef=i.createRef();n._locationChildRef=i.createRef();n._useLocationMenu=!1;n._locationInfoSet=[];n._isClicked=!1;return n}f.prototype.componentDidMount=function(){this.props.layout?this.props.layout.registerGroupHeaderSetStateFuncByLabel(this.props.label,this.setSelectionState):console.warn("Have a valid group header record in list, but unable to register it to layout!");window.addEventListener("mousedown",this._handleMouseDownEvent);window.addEventListener("keydown",this._handleKeyDownEvent)};f.prototype.componentDidUpdate=function(e,n){var r=this.props,i=r.imageStartIndex,s=r.imageCount;void 0!==this.state.isSelected&&n.isSelected!==this.state.isSelected&&this.props.layout&&this.props.layout.groupSelectionOnChangedHandler(i,s,this.state.isSelected);if(this.props.locations&&this.props.locations.length>0){var o=0;this._labelRef.current&&(o=this._labelRef.current.offsetWidth);var u=this.props.labelRowWidth-o-this._getCheckboxWidth()-t.LOCATION_CHILD_PADDING-2;n.locationWidth!==u&&this.setState({locationWidth:u});this._locationDivRef.current&&this.props.locations.length>1&&(this._useLocationMenu=this._locationDivRef.current.offsetWidth>u);if(this.state.locationWidth&&this._locationChildRef&&this._locationChildRef.current){var a=this._locationChildRef.current.querySelector(".ms-Button-label"),f=this._locationChildRef.current.querySelector(".ms-Button-menuIcon");if(a&&f){var l=this.state.locationWidth-2*f.offsetWidth;f.style.padding=t.CHECK_PADDING+"px";a.style.maxWidth=l+"px"}}}};f.prototype.componentWillUnmount=function(){this.props.layout&&this.props.layout.deregisterGroupHeaderSetStateFuncByLabel(this.props.label);window.removeEventListener("mousedown",this._handleMouseDownEvent);window.removeEventListener("keydown",this._handleKeyDownEvent)};f.prototype.groupHeaderStyle=function(){return{width:this.props.labelRowWidth,height:this.props.labelRowHeight,position:"absolute"}};f.prototype.labelStyle=function(){return{maxWidth:this.props.labelRowWidth-this._getCheckboxWidth()-2*t.CHECK_PADDING}};f.prototype.render=function(){var e=this,n=this.state.isSelected,i=void 0!==n&&n,u=this._onRenderCheck({isSelected:i}),f={groupHeaderKey:t.SELECTION_GROUP_LABEL,onMouseEnter:function(t){return e.setState({hover:!0})},onMouseLeave:function(t){return e.setState({hover:!1})},groupHeaderStyle:this.groupHeaderStyle(),onClick:function(t){return e._onClick(t)},onKeyDown:function(t){return e._onKeyDown(t)},foregroundKey:"foreground",foregroundRole:"presentation",foregroundClassNames:s.css("ms-Tile-aboveNameplate",v.aboveNameplate),foregroundTabIndex:-1,labelKey:this.props.rowKey+"-"+this.props.label,labelStyle:this.labelStyle(),label:this.props.label,isSelected:this.state.isSelected,ariaLabel:this._getGroupHeaderAriaLabel(this.props.label),onFocus:function(){return e.setState({focus:!0})},onBlur:function(){return e.setState({focus:!1})}},p=r.createElement("div",null);if(this.props.locations&&this.props.locations.length>0){this._locationInfoSet=[];var m=void 0;m={};for(var g=0,y=this.props.locations;g<y.length;g++){var b=y[g],w=void 0;if(b.city&&b.city.length>0){w=b.city+", ";w+=b.state&&b.state.length>0?b.state+", ":"";w+=b.country&&b.country.length>0?b.country:"";w+=b.countryOrRegion&&b.countryOrRegion.length>0?b.countryOrRegion:""}else if(b.locationTag&&b.locationTag.length>0){w=b.locationTag+", ";w+=b.state&&b.state.length>0?b.state+", ":"";w+=b.country&&b.country.length>0?b.country:""}if(void 0!==w&&w.length>0&&!m[w]){m[w]=!0;this._locationInfoSet.push({displayText:w,locationData:b})}}var E=this._locationInfoSet.length>2||this._useLocationMenu,S=0;this._labelRef.current&&(S=this._labelRef.current.offsetWidth);this._locationInfoSet.length>0&&(p=r.createElement("div",{key:f.labelKey+"location",ref:this._locationChildRef,className:v.locationStyle,style:{float:"none",position:"relative",bottom:E?"3px":"0px",marginLeft:S+t.LOCATION_CHILD_PADDING+"px",maxWidth:this.props.labelRowWidth-S-t.LOCATION_CHILD_PADDING-this._getCheckboxWidth()-2*t.CHECK_PADDING}},E?r.createElement(l.DefaultButton,{role:"menuitem",className:v.groupHeaderMenu,"data-is-focusable":"true",id:f.labelKey+"location",onFocus:f.onFocus,onBlur:f.onBlur,text:h.format(c.default.locationmoreLabel,this._locationInfoSet[0].displayText,this._locationInfoSet.length-1)||"",componentRef:this._menuRef,menuProps:{items:this._locationInfoSet.map(function(t){return{key:t.displayText,text:t.displayText,onClick:e._createLocationClickHandler(t),style:d}})}}):this._locationInfoSet.map(function(t,n){return r.createElement("span",{key:f.labelKey+t.displayText},r.createElement("span",{role:"link","data-is-focusable":"true",onFocus:f.onFocus,onBlur:f.onBlur,ref:e._locationDivRef,onClick:e._createLocationClickHandler(t),title:t.displayText,className:o.css(""+a.locationHeader),style:{cursor:"pointer"}},t.displayText),r.createElement("span",null,n<e._locationInfoSet.length-1?", ":""))})))}return r.createElement("div",{className:v.groupHeader,style:{width:this.props.labelRowWidth,height:this.props.labelRowHeight,marginTop:this.props.margins.top,marginBottom:this.props.margins.bottom,marginLeft:this.props.margins.left,marginRight:this.props.margins.right}},r.createElement("div",{key:f.groupHeaderKey,onMouseEnter:f.onMouseEnter,onMouseLeave:f.onMouseLeave,style:f.groupHeaderStyle},r.createElement("h2",{id:f.labelKey,role:"checkbox",className:v.groupHeaderTitle,"data-is-focusable":"true","data-is-sub-focuszone":"true",onClick:f.onClick,key:f.labelKey,ref:this._labelRef,style:f.labelStyle,"is-checked":f.isSelected?f.isSelected.toString():"false","aria-label":f.ariaLabel,"aria-checked":f.isSelected,onFocus:this._handleOutlineFocus,onBlur:f.onBlur,onKeyDown:f.onKeyDown},f.label),p),u)};f.prototype._createLocationClickHandler=function(e){var t=this;return function(){e&&t.props.onLocationHeaderClick(e.locationData)}};f.prototype._onRenderCheck=function(e){var n=e.isSelected;return r.createElement("div",{id:this._getCheckboxId(),onClick:this._onClickRenderCheck,onKeyDown:this._onKeyDown,key:"check",role:"checkbox","aria-label":this._getGroupHeaderAriaLabel(this.props.label),onFocus:this._handleOutlineFocus,onBlur:this._onBlurRenderCheck,"data-is-focusable":"true",className:this._checkBoxClassName(),"data-selection-toggle":!0,"aria-checked":n,ref:this._checkDivRef,onMouseEnter:this._onMouseEnterRenderCheck,onMouseLeave:this._onMouseLeaveRenderCheck,style:{padding:t.CHECK_PADDING+"px",display:this.state.hover||this.state.isSelected||this.state.focus?"flex":"none"}},r.createElement(u.Check,{checked:n}))};f.prototype._getGroupHeaderAriaLabel=function(e){return h.format(c.default.GroupHeaderAriaLabel,e)};f.prototype._getCheckboxWidth=function(){var e=0;this._checkDivRef.current&&this._checkDivRef.current.children&&this._checkDivRef.current.children[0]&&(e=this._checkDivRef.current.children[0].clientWidth);return e};return f}(i.Component);t.GroupHeader=g});
define("@ms/items-view-addon-photos/lib/components/image/AllPhotosImage",["require","exports","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/facets/DemandFacets","@ms/items-view-addon-graph/lib/models/keys/DriveItemKeyFacet","../../models/keys/PhotosRootItemSetKeyFacet","../../models/keys/GroupKeyFacet","../../models/keys/GroupPageKeyFacet","../../models/facets/GroupToCountFacets","../../models/facets/PhotoThumbnailSetFacet","../../models/facets/PhotoLocationFacet","@ms/items-view/lib/private/facets/SetFacets","../../models/interfaces/IGroupToCount","@ms/items-view/lib/private/components/decorators/selectors","../image/Image","@ms/items-view/lib/private/facets/ItemFacets","../../models/facets/PhotosMetadataBurstFacet","@ms/items-view/lib/private/facets/MediaFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AllPhotosImage=p.withCurrentItemSet()(n.connectToItemCache(function(e,t){var n=t.itemKey,p=t.index,d={id:"image-placeholder-"+t.index,thumbnails:[],name:t.index+"",dateTaken:"",isVideo:!1};if(s.photosRootItemSetKeyFacet.matches(n)){var y=e.demandItemFacet(a.allGroupToCountsPointerFacet,n),b=y?e.demandItemFacet(a.allGroupToCountsFacet,y.itemKey):void 0;if(b){for(var w="",E=0,S=0,x=0;x<b.length;++x){var T=b[x];if(p>=E&&p<E+T.count){w=h.getLabelsFromGroupToCount(T).join(";");S=E;break}E+=T.count}if(w.length>0){var N=o.groupKeyFacet.serialize({photosRootItemSetKeyPart:s.photosRootItemSetKeyFacet.deserialize(n),label:w}),C=e.demandItemFacet(c.childItemsFacet,N);if(C&&C.itemKeys)for(var k=t.index-S,L=0,A=0;A<C.itemKeys.length;++A){var O=C.itemKeys[A];if(e.isItemFacetResolved(c.pageFacet,O)){if(u.groupPageKeyFacet.matches(O)){var M=u.groupPageKeyFacet.deserialize(O),_=M.offset,D=M.count,P=_,H=_+D;if(t.index>=P&&t.index<H){var B=t.itemDemandManager.requestPageForDemand(p,O);if(e.isItemFacetResolved(r.errorFacet,B)){var j=e.demandItemFacet(r.errorFacet,B);j&&"Canceled"===j.message&&t.itemDemandManager.registerCanceledPageKey(B)}else e.isItemFacetResolved(c.childItemsFacet,B)&&(B=O);e.demandItemFacet(c.childItemsFacet,B);break}if(t.index>=H){k-=D;L++}else console.warn("Error trying to determine if our index is in a page for index:",t.index," page range was from ",P," to ",H)}}else{if(!e.isItemFacetResolved(i.driveItemKeyFacet,O)){console.error(O," has not been resolved into the itemCache!");break}if(A===k+L){var F=e.demandItem({key:i.driveItemKeyFacet,thumbnails:f.photoThumbnailSetFacet,name:v.displayNameFacet,location:l.photoLocationFacet,fileName:v.fileNameFacet,originalUrl:v.canonicalUrlFacet,isVideo:g.videoFacet},O),I=F.key,q=F.thumbnails,R=F.name,U=F.location,z=F.fileName,W=F.originalUrl,X=F.isVideo;d={id:I&&I.itemId?I.itemId:"",thumbnails:q,name:R||"",location:U,dateTaken:"",extension:z?z.extension:"",originalUrl:W||"",isVideo:void 0!==X};break}}}else C&&console.error("Retrieved a childItemsFacet with no child keys when retrieving group for key: ",N)}}if(0===d.thumbnails.length&&e.isItemFacetResolved(m.photosMetadataBurstFacet,n)){var V=e.demandItemFacet(m.photosMetadataBurstFacet,n);V&&p<V.records.length&&(d=V.records[p])}}return{index:p,item:d}})(d.Image))});
define("@ms/items-view-addon-photos/lib/components/image/Image",["require","exports","tslib","react","@uifabric/experiments/lib/Tile","ODCPhotosItemsScope_css","@ms/items-view-utilities/lib/locale/Locale"],function(e,t,n,r,i,s,o){"use strict";s=s.Image_7;Object.defineProperty(t,"__esModule",{value:!0});var u=0,a=s,f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.handleRotate=function(){var e=n.props.layout.getSelection();if(e&&!0===e.isIndexSelected(n.props.index)){var t=n.state.rotationDegree+90;t>360&&(t-=360);n.setState({rotationDegree:t});!1===n.props.useSquareTiles&&n.props.layout.handleResizeAfterRotate(n.props.index,n.props.itemHeightInCssPixels)}};n._onClick=function(e){var t=n.props.layout.getSelection();t&&t.setIndexSelected(n.props.index,!0,!1);n.props.openItemOverlay.call(n,e,n.props.index);e.stopPropagation()};n._onMouseEnter=function(e){n.setState({hoverd:!0})};n._onMouseLeave=function(e){n.setState({hoverd:!1})};n._onFocus=function(e){n.setState({focused:!0})};n._onBlur=function(e){n.setState({focused:!1})};n._rotateHandler=function(e){n.handleRotate()};n._onError=function(e){n._handleError()};n._onLoad=function(e){var t=n._imgLoadingScheduler.onItemLoaded(n._uniqueId,e.target);n.props.imageOnLoad.call(n,n.props.index,n.state.timecreated,t)};var r=new Date;n._uniqueId=String(u++);n.state={hoverd:!1,loaded:!1,thumbLoaded:!1,timecreated:r,imageElementId:"img_"+n._uniqueId,src:"",rotationDegree:0,thumbnailError:!1,focused:!1};n._imgLoadingScheduler=t.imgLoadingScheduler;n.isUnMounting=!1;n.handleRotate=n.handleRotate.bind(n);n.setSrc=n.setSrc.bind(n);return n}t.prototype.componentDidMount=function(){if(this.props.telemetryCallbacks){(0,this.props.telemetryCallbacks.fileRenderCount)(this.props.index)}this._imageIsPlaceHolder(this.props.item)||this._imgLoadingScheduler.activateItem(this._uniqueId,this.props.item,this,this.props.index);this.props.registerAnchorId&&!this._imageIsPlaceHolder(this.props.item)&&this.props.registerAnchorId(this.props.index,this.props.item.id);window.addEventListener("RotateEvent",this._rotateHandler)};t.prototype.componentWillUnmount=function(){if(!this._imageIsPlaceHolder(this.props.item)){this._imgLoadingScheduler.deactivateItem(this._uniqueId);this.props.deregisterAnchorId&&this.props.deregisterAnchorId(this.props.index,this.props.item.id)}this.isUnMounting=!0;window.removeEventListener("RotateEvent",this._rotateHandler)};t.prototype.componentDidUpdate=function(e,t,n){if(!this._imageIsPlaceHolder(this.props.item)){(this._imageIsPlaceHolder(e.item)||this.props.item.id&&this.props.item.id!==e.item.id||e.itemWidthInCssPixels!==this.props.itemWidthInCssPixels||e.itemHeightInCssPixels!==this.props.itemHeightInCssPixels||this._didThumbnailsChange(e.item.thumbnails,this.props.item.thumbnails))&&this._imgLoadingScheduler.activateItem(this._uniqueId,this.props.item,this,this.props.index);if(this.props.registerAnchorId&&this.props.deregisterAnchorId&&(this.props.index!==e.index||this.props.item.id!==e.item.id)){this._imageIsPlaceHolder(e.item)||this.props.deregisterAnchorId(e.index,e.item.id);this.props.registerAnchorId(this.props.index,this.props.item.id)}}};t.prototype.setSrc=function(e){this.isUnMounting||this.setState({src:e})};t.prototype.getSrc=function(){return this.state.src};t.prototype.tileStyle=function(){var e=this.props.margins;return{margin:e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px",WebkitUserSelect:"none",position:"relative",float:o.Locale.isRightToLeft?"right":"left",background:"#eee",padding:"0px",width:this.props.itemWidthInCssPixels,height:this.props.itemHeightInCssPixels,cursor:"pointer"}};t.prototype.tileViewportStyle=function(){return{width:this.props.itemWidthInCssPixels,height:this.props.itemHeightInCssPixels,overflow:"hidden",justifyContent:"center",alignItems:"center",display:"flex"}};t.prototype.getRotationClass=function(e){var t="";90===e||-270===e?t=a.rotate0TO90:180===e||-180===e?t=a.rotate90TO180:270===e||-90===e?t=a.rotate180TO270:360!==e&&-360!==e||(t=a.rotate270TO360);return t};t.prototype.getTransformStyle=function(e){return 0===e||180===e||360===e?"rotate("+this.state.rotationDegree+"deg)":"translateX("+(this.props.itemWidthInCssPixels/2-this.props.itemHeightInCssPixels/2)+"px)translateY("+(this.props.itemHeightInCssPixels/2-this.props.itemWidthInCssPixels/2)+"px)rotate("+this.state.rotationDegree+"deg)"};t.prototype.getWidth=function(e){return 0===e||180===e||360===e?this.props.itemWidthInCssPixels:this.props.itemHeightInCssPixels};t.prototype.getHeight=function(e){return 0===e||180===e||360===e?this.props.itemHeightInCssPixels:this.props.itemWidthInCssPixels};t.prototype.getTransitionTime=function(e){var t=this.props.layout.getSelection(),n=0;t?!1===t.isIndexSelected(this.props.index)&&(n=0):0!==e&&(n=.2);return n};t.prototype.getClassName=function(){var e="";this.props.useSquareTiles&&(e=this.getRotationClass(this.state.rotationDegree));return e};t.prototype.thumbnailStyle=function(){return this.props.useSquareTiles?{cursor:"pointer",width:this.props.itemWidthInCssPixels,height:this.props.itemHeightInCssPixels,marginLeft:0,marginTop:0,display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",flexShrink:0,minWidth:"100%",minHeight:"100%",objectFit:"cover",transform:"rotate("+this.state.rotationDegree+"deg)"}:{cursor:"pointer",height:this.getHeight(this.state.rotationDegree),width:this.getWidth(this.state.rotationDegree),marginLeft:0,marginTop:0,display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",flexShrink:0,transform:this.getTransformStyle(this.state.rotationDegree),transition:"height "+this.getTransitionTime(this.state.rotationDegree)+"s ,width "+this.getTransitionTime(this.state.rotationDegree)+"s ease",minWidth:void 0,minHeight:void 0,objectFit:void 0}};t.prototype.render=function(){var e,t=r.createElement(r.Fragment,null),n={width:this.props.itemWidthInCssPixels,height:this.props.itemHeightInCssPixels};if(this.state.src.length>0){var s=((e={role:"option",id:"tile-"+this.props.index,contentSize:n,style:this.tileStyle(),selectionIndex:this.props.index,className:"ms-Tile--isSelectable od-ItemTile2 od-hasContextMenu od-ItemTile2--isLarge ms-Tile--isLarge ms-Tile--invokable",label:"ImageTileCell",tileSize:"large",ariaLabel:this._getImageAriaLabelAttribute()})["aria-label"]=this._getImageAriaLabelAttribute(),e.onMouseEnter=this._onMouseEnter,e.onMouseLeave=this._onMouseLeave,e.onClick=this._onClick,e.onFocus=this._onFocus,e.onBlur=this._onBlur,e),o=this.props.onRenderTile(s,t),u=this._renderThumbnail();return i.renderTileWithLayout(o,{foreground:u,background:null})}return r.createElement("div",{"aria-hidden":"true",className:a.tileViewport,id:"tile-viewport-"+this.props.index,key:"tile-viewport-"+this.props.index,style:this.tileStyle(),"data-is-focusable":"true"})};t.prototype._errorThumbnailStyle=function(){return{display:"block",marginLeft:"auto",marginRight:"auto",width:"96px",marginTop:"-48px",alignContent:"center"}};t.prototype._imageIsPlaceHolder=function(e){return!e||0===e.thumbnails.length||""===e.id};t.prototype._getImageAriaLabelAttribute=function(){return this.props.item.name+this.props.item.extension};t.prototype._didThumbnailsChange=function(e,t){return e.length!==t.length||e.some(function(e,n){return!t[n]||e.url!==t[n].url})};t.prototype._renderThumbnail=function(){return r.createElement(r.Fragment,null,!this.props.isScrolling&&this.state.hoverd&&r.createElement("div",{className:"custom-overlay",key:"custom-overlay-"+this.props.index,style:{pointerEvents:"none",position:"absolute",height:"100%",width:this.props.itemWidthInCssPixels+"px",zIndex:1,border:this.state.hoverd?"2px solid #c8c8c8":"0px solid",boxSizing:"border-box",left:0,top:0}}),r.createElement("div",{"aria-hidden":"true",className:a.tileViewport,style:this.tileViewportStyle(),key:"tile-viewport-"+this.props.index},r.createElement("img",{key:"imgSmall-"+this._uniqueId,id:this.state.imageElementId,src:".gif"===this.props.item.extension&&(this.state.hoverd||this.state.focused)?this.props.item.originalUrl:this.state.src,alt:"",style:this.state.thumbnailError?this._errorThumbnailStyle():this.thumbnailStyle(),onLoad:this._onLoad,onError:this._onError,className:this.getClassName()}),this.state.thumbnailError&&r.createElement("div",{className:"ItemTile-namePlate",style:{minHeight:"35px",borderTop:"1px solid rgba(255,255,255,.2)"}},r.createElement("div",{className:"ItemTile-name",style:{fontSize:"15px",lineHeight:"20px"}},this.props.item.name))),this.props.onRenderTileAnnotation({imageIndex:this.props.index},r.createElement(r.Fragment,null)))};t.prototype._handleError=function(){if(this.state.src||this.props.item.thumbnails.length>=1&&0===this.props.item.thumbnails[0].url.length){this.setState({thumbnailError:!0});this.props.item.isVideo?this.setSrc(this.props.videoErrorThumbnail):this.setSrc(this.props.imageErrorThumbnail)}};t.defaultProps={margin:0,itemHeightInCssPixels:0,itemWidthInCssPixels:0};return t}(r.PureComponent);t.Image=f});
define('ODCPhotosItemsScope_css',["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e){"use strict";e.loadStyles([{"rawString":".tile_90cacf48{display:block;position:absolute;top:0;bottom:0;left:0;right:0;z-index:0;background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";-webkit-transition:-webkit-transform 0.1s linear;transition:-webkit-transform 0.1s linear;transition:transform 0.1s linear;transition:transform 0.1s linear, -webkit-transform 0.1s linear;color:"},{"theme":"neutralPrimary","defaultValue":"#333333"},{"rawString":";-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.tile_90cacf48::-moz-focus-inner{border:0}.tile_90cacf48{outline:transparent}.tile_90cacf48.selectable_90cacf48:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f4f4f4"},{"rawString":"}.tile_90cacf48.selectable_90cacf48:hover.selected_90cacf48{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#dadada"},{"rawString":"}.tile_90cacf48.selected_90cacf48{background-color:"},{"theme":"neutralLight","defaultValue":"#eaeaea"},{"rawString":"}.tile_90cacf48.selected_90cacf48.isFluentStyling_90cacf48 .name_90cacf48{font-weight:600}.ms-Fabric--isFocusVisible .tile_90cacf48:focus{background-color:"},{"theme":"neutralLighter","defaultValue":"#f4f4f4"},{"rawString":"}.ms-Fabric--isFocusVisible .tile_90cacf48:focus.isFluentStyling_90cacf48{background-color:transparent}.ms-Fabric--isFocusVisible .tile_90cacf48:focus.selected_90cacf48{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#dadada"},{"rawString":"}.ms-Fabric--isFocusVisible .tile_90cacf48:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#666666"},{"rawString":"}.ms-Fabric--isFocusVisible .tile_90cacf48:focus.selected_90cacf48{outline:1px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.ms-Fabric--isFocusVisible .tile_90cacf48:focus.selected_90cacf48.isFluentStyling_90cacf48{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#666666"},{"rawString":"}.tile_90cacf48.hasBackgroundFrame_90cacf48{-webkit-box-shadow:0 1px 3px 1px rgba(1,1,0,0.05);box-shadow:0 1px 3px 1px rgba(1,1,0,0.05)}.tile_90cacf48.hasBackgroundFrame_90cacf48.selectable_90cacf48:hover{outline:1px solid "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c8c8"},{"rawString":"}.ms-Fabric--isFocusVisible .tile_90cacf48.hasBackgroundFrame_90cacf48:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#666666"},{"rawString":"}.ms-Fabric--isFocusVisible .tile_90cacf48.hasBackgroundFrame_90cacf48:focus.selected_90cacf48{outline:1px solid "},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.tile_90cacf48.hasBackgroundFrame_90cacf48:after{content:'';display:block;position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none;border:2px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.tile_90cacf48.invokable_90cacf48:active{-webkit-transform:scale(0.95);transform:scale(0.95)}.label_90cacf48{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.description_90cacf48{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.link_90cacf48{border:none;background:transparent;position:absolute;padding:0;top:0;left:0;bottom:0;right:0;width:100%;text-decoration:none;color:inherit;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-ms-flex-line-pack:stretch;align-content:stretch;pointer-events:none}.link_90cacf48::-moz-focus-inner{border:0}.link_90cacf48{outline:transparent}.foreground_90cacf48{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;overflow:visible;max-width:100%;max-height:100%;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:1;-webkit-transition:opacity 0.2s linear;transition:opacity 0.2s linear}.tile_90cacf48.invokable_90cacf48 .foreground_90cacf48{pointer-events:auto;cursor:pointer}.foreground_90cacf48.foregroundHide_90cacf48{opacity:0}.hasForegroundFrame_90cacf48 .foreground_90cacf48{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";-webkit-box-shadow:0 1px 3px 1px rgba(1,1,0,0.05);box-shadow:0 1px 3px 1px rgba(1,1,0,0.05);min-width:32px;min-height:32px}.hasForegroundFrame_90cacf48 .foreground_90cacf48:after{content:'';display:block;position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none;border:2px solid "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.check_90cacf48{display:none;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;top:0;border:none;background:none;background-color:transparent;opacity:0;-webkit-box-sizing:border-box;box-sizing:border-box;padding:6px}.check_90cacf48::-moz-focus-inner{border:0}.check_90cacf48{outline:transparent}.check_90cacf48{position:absolute}.ms-Fabric--isFocusVisible .check_90cacf48:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{"theme":"focusBorder","defaultValue":"#666666"},{"rawString":"}html[dir='ltr'] .check_90cacf48{right:0}html[dir='rtl'] .check_90cacf48{left:0}.tile_90cacf48.uninvokable_90cacf48 .check_90cacf48{width:100%;height:100%}.tile_90cacf48.selectable_90cacf48 .check_90cacf48{display:-webkit-box;display:-ms-flexbox;display:flex}.tile_90cacf48.selected_90cacf48 .check_90cacf48,.tile_90cacf48:hover .check_90cacf48,.tile_90cacf48.showCheck_90cacf48 .check_90cacf48{opacity:1}.ms-Fabric--isFocusVisible .check_90cacf48:focus{opacity:1}.ms-Fabric--isFocusVisible .tile_90cacf48:focus .check_90cacf48{opacity:1}.background_90cacf48{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:1;-webkit-transition:opacity 0.2s linear;transition:opacity 0.2s linear}.tile_90cacf48.invokable_90cacf48 .background_90cacf48{cursor:pointer;pointer-events:auto}.background_90cacf48.backgroundHide_90cacf48{opacity:0}.aboveNameplate_90cacf48{-webkit-box-flex:1;-ms-flex:1;flex:1;position:relative;margin:16px 16px 0 16px}.content_90cacf48{position:absolute;top:0;left:0;bottom:0;right:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.hasForegroundFrame_90cacf48 .content_90cacf48{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.nameplate_90cacf48{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;position:relative;margin:auto 0 0 0;padding:12px 8px;text-align:center;z-index:0}.nameplate_90cacf48 .name_90cacf48{-webkit-transition:color 0.2s linear;transition:color 0.2s linear}.tile_90cacf48.invokable_90cacf48 .nameplate_90cacf48 .name_90cacf48{pointer-events:auto;cursor:pointer}.link_90cacf48:hover .nameplate_90cacf48 .name_90cacf48{text-decoration:underline}.isFluentStyling_90cacf48 .link_90cacf48:hover .nameplate_90cacf48 .name_90cacf48{text-decoration:none}.nameplate_90cacf48 .activity_90cacf48{-webkit-transition:color 0.2s linear;transition:color 0.2s linear}.tile_90cacf48.hasBackgroundFrame_90cacf48 .nameplate_90cacf48{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:12px 10px}.signal_90cacf48{display:inline-block}html[dir='ltr'] .signal_90cacf48.storageSignal_90cacf48{margin-left:4px}html[dir='rtl'] .signal_90cacf48.storageSignal_90cacf48{margin-right:4px}html[dir='ltr'] .signal_90cacf48.socialSignal_90cacf48{margin-right:4px}html[dir='rtl'] .signal_90cacf48.socialSignal_90cacf48{margin-left:4px}html[dir='ltr'] .signal_90cacf48.lifecycleSignal_90cacf48{margin-right:4px}html[dir='rtl'] .signal_90cacf48.lifecycleSignal_90cacf48{margin-left:4px}.name_90cacf48{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;font-weight:400;color:"},{"theme":"neutralPrimary","defaultValue":"#333333"},{"rawString":";white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%}html[dir='ltr'] .name_90cacf48{margin-left:-8px}html[dir='rtl'] .name_90cacf48{margin-right:-8px}html[dir='ltr'] .name_90cacf48{padding-left:8px}html[dir='rtl'] .name_90cacf48{padding-right:8px}.name_90cacf48,.isLarge_90cacf48 .name_90cacf48{font-size:14px;height:30px;margin-top:-7px;margin-bottom:-8px}.isSmall_90cacf48 .name_90cacf48{font-size:12px;height:24px;margin-top:-5px;margin-bottom:-7px}.activity_90cacf48{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;font-weight:400;font-size:12px;color:"},{"theme":"neutralSecondary","defaultValue":"#666666"},{"rawString":";white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%;height:24px;margin-bottom:-4px}html[dir='ltr'] .activity_90cacf48{margin-left:-8px}html[dir='rtl'] .activity_90cacf48{margin-right:-8px}html[dir='ltr'] .activity_90cacf48{padding-left:8px}html[dir='rtl'] .activity_90cacf48{padding-right:8px}.hasBackgroundFrame_90cacf48 .name_90cacf48{display:block}html[dir='ltr'] .hasBackgroundFrame_90cacf48 .name_90cacf48{-webkit-box-pack:left;-ms-flex-pack:left;justify-content:left}html[dir='rtl'] .hasBackgroundFrame_90cacf48 .name_90cacf48{-webkit-box-pack:right;-ms-flex-pack:right;justify-content:right}.hasBackgroundFrame_90cacf48 .name_90cacf48,.isLarge_90cacf48 .isSmall_90cacf48 .hasBackgroundFrame_90cacf48 .name_90cacf48{font-size:14px;height:auto;padding-top:6px;margin-top:0px;margin-bottom:0px;line-height:22px}.hasBackgroundFrame_90cacf48 .activity_90cacf48{font-size:12px;display:block;height:auto;margin-top:0px;margin-bottom:0px;line-height:20px}html[dir='ltr'] .hasBackgroundFrame_90cacf48 .activity_90cacf48{-webkit-box-pack:left;-ms-flex-pack:left;justify-content:left;text-align:left}html[dir='rtl'] .hasBackgroundFrame_90cacf48 .activity_90cacf48{-webkit-box-pack:left;-ms-flex-pack:left;justify-content:left;text-align:left}.hasBackground_90cacf48 .nameplate_90cacf48:before{position:absolute;content:'';display:block;top:-4px;bottom:0;left:0;right:0;background-image:-webkit-gradient(linear, left bottom, left top, from(rgba(0,0,0,0.65)), color-stop(55%, rgba(0,0,0,0.5525)), color-stop(80%, rgba(0,0,0,0.195)), to(rgba(0,0,0,0)));background-image:linear-gradient(to top, rgba(0,0,0,0.65) 0%, rgba(0,0,0,0.5525) 55%, rgba(0,0,0,0.195) 80%, rgba(0,0,0,0) 100%);z-index:-1;-webkit-transition:opacity 0.2s linear;transition:opacity 0.2s linear;opacity:0}.hasBackground_90cacf48 .onlyOnHover_90cacf48 .name_90cacf48{opacity:0;-webkit-transition:opacity 0.2s linear, color 0.2s linear, -webkit-transform 0.25s ease-out;transition:opacity 0.2s linear, color 0.2s linear, -webkit-transform 0.25s ease-out;transition:transform 0.25s ease-out, opacity 0.2s linear, color 0.2s linear;transition:transform 0.25s ease-out, opacity 0.2s linear, color 0.2s linear, -webkit-transform 0.25s ease-out;-webkit-transform:translateY(1rem);transform:translateY(1rem)}.hasBackground_90cacf48 .onlyOnHover_90cacf48 .activity_90cacf48{opacity:0;-webkit-transition:opacity 0.2s linear, color 0.2s linear, -webkit-transform 0.25s ease-out;transition:opacity 0.2s linear, color 0.2s linear, -webkit-transform 0.25s ease-out;transition:transform 0.25s ease-out, opacity 0.2s linear, color 0.2s linear;transition:transform 0.25s ease-out, opacity 0.2s linear, color 0.2s linear, -webkit-transform 0.25s ease-out;-webkit-transform:translateY(1rem);transform:translateY(1rem)}.hasBackground_90cacf48:hover .name_90cacf48.onlyOnHover_90cacf48,.hasBackground_90cacf48.selected_90cacf48 .name_90cacf48.onlyOnHover_90cacf48{opacity:1;-webkit-transform:translateY(0px);transform:translateY(0px)}.hasBackground_90cacf48:hover .activity_90cacf48.onlyOnHover_90cacf48,.hasBackground_90cacf48.selected_90cacf48 .activity_90cacf48.onlyOnHover_90cacf48{opacity:1;-webkit-transform:translateY(0px);transform:translateY(0px)}.hasBackground_90cacf48.showBackground_90cacf48:hover .onlyOnHover_90cacf48.nameplate_90cacf48:before,.hasBackground_90cacf48.showBackground_90cacf48.selected_90cacf48 .onlyOnHover_90cacf48.nameplate_90cacf48:before{opacity:1}.hasBackground_90cacf48.showBackground_90cacf48 .nameplate_90cacf48:not(.onlyOnHover_90cacf48):before{opacity:1}.hasBackground_90cacf48.showBackground_90cacf48 .name_90cacf48{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";text-shadow:0.5px 0.5px 2px rgba(0,0,0,0.55)}.hasBackground_90cacf48.showBackground_90cacf48 .activity_90cacf48{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";text-shadow:0.5px 0.5px 2px rgba(0,0,0,0.55)}\n"},{"rawString":".root_f2de5b4d{line-height:1;width:18px;height:18px;vertical-align:top;position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.root_f2de5b4d:before{content:'';position:absolute;left:1px;right:1px;bottom:1px;top:1px;border-radius:50%;opacity:1;background:"},{"theme":"bodyBackground","defaultValue":"#ffffff"},{"rawString":"}.root_f2de5b4d.rootIsChecked_f2de5b4d:before{background:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";opacity:1}@media screen and (-ms-high-contrast: active){.root_f2de5b4d.rootIsChecked_f2de5b4d:before{background:Window}}.root_f2de5b4d .check_f2de5b4d{opacity:0}.checkHost_f2de5b4d:hover .root_f2de5b4d .check_f2de5b4d,.checkHost_f2de5b4d:focus .root_f2de5b4d .check_f2de5b4d,.root_f2de5b4d:hover .check_f2de5b4d,.root_f2de5b4d:focus .check_f2de5b4d,.root_f2de5b4d.rootIsChecked_f2de5b4d .check_f2de5b4d{opacity:1}.circle_f2de5b4d,.check_f2de5b4d{font-size:18px;position:absolute;left:0;top:0;width:18px;height:18px;text-align:center;vertical-align:middle}.circle_f2de5b4d{color:"},{"theme":"neutralSecondary","defaultValue":"#666666"},{"rawString":"}@media screen and (-ms-high-contrast: active){.circle_f2de5b4d{color:WindowText}}.rootIsChecked_f2de5b4d .circle_f2de5b4d{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.check_f2de5b4d{color:"},{"theme":"neutralSecondary","defaultValue":"#666666"},{"rawString":";font-size:16px;left:0.5px}@media screen and (-ms-high-contrast: active){.check_f2de5b4d{-ms-high-contrast-adjust:none}}.rootIsChecked_f2de5b4d .check_f2de5b4d{color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";font-weight:900}@media screen and (-ms-high-contrast: active){.rootIsChecked_f2de5b4d .check_f2de5b4d{border:none;color:WindowText}}\n"},{"rawString":".od-ItemTileCard-cardSection{background-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";position:absolute;bottom:0;left:0;right:0;border:1px solid "},{"theme":"neutralLight","defaultValue":"#eaeaea"},{"rawString":";padding-left:12px;padding-right:12px;height:40px;line-height:40px;font-size:14px}.md .od-ItemTileCard-cardSection,.sm .od-ItemTileCard-cardSection{height:40px;line-height:40px}.lg .od-ItemTileCard-cardSection{height:40px;line-height:40px}.xlg .od-ItemTileCard-cardSection,.xxlg .od-ItemTileCard-cardSection,.xxxlg .od-ItemTileCard-cardSection,.xxxxlg .od-ItemTileCard-cardSection{padding-left:20px;padding-right:20px}.od-ItemTileCard .ItemTile{bottom:42px}.md .od-ItemTileCard .ItemTile,.sm .od-ItemTileCard .ItemTile{bottom:42px}.lg .od-ItemTileCard .ItemTile{bottom:42px}.od-ItemTileCard-action{position:absolute;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir=ltr] .od-ItemTileCard-action{right:12px}[dir=rtl] .od-ItemTileCard-action{left:12px}[dir=ltr] .xlg .od-ItemTileCard-action,[dir=ltr] .xxlg .od-ItemTileCard-action,[dir=ltr] .xxxlg .od-ItemTileCard-action,[dir=ltr] .xxxxlg .od-ItemTileCard-action{right:20px}[dir=rtl] .xlg .od-ItemTileCard-action,[dir=rtl] .xxlg .od-ItemTileCard-action,[dir=rtl] .xxxlg .od-ItemTileCard-action,[dir=rtl] .xxxxlg .od-ItemTileCard-action{left:20px}.od-ItemTileCard-action.od-ItemTileCard-action--withoutTitle{display:inline;text-align:center;left:0;right:0}.xlg .od-ItemTileCard-action.od-ItemTileCard-action--withoutTitle,.xxlg .od-ItemTileCard-action.od-ItemTileCard-action--withoutTitle,.xxxlg .od-ItemTileCard-action.od-ItemTileCard-action--withoutTitle,.xxxxlg .od-ItemTileCard-action.od-ItemTileCard-action--withoutTitle{right:0}.od-ItemTileCard .od-ItemTile--isAlbum .ItemTile-namePlate,.od-ItemTileCard .od-ItemTile--isAlbum .od-FolderCoverTile-item1{left:0;right:0}"},{"rawString":".od-PromotedPhotos-itemTile{position:relative;display:inline-block}[dir=ltr] .od-PromotedPhotos-itemTile{margin-right:4px}[dir=rtl] .od-PromotedPhotos-itemTile{margin-left:4px}.od-PromotedPhotos-sections{height:140px;overflow:hidden}.lg .od-PromotedPhotos-sections,.xlg .od-PromotedPhotos-sections,.xxlg .od-PromotedPhotos-sections,.xxxlg .od-PromotedPhotos-sections,.xxxxlg .od-PromotedPhotos-sections{height:220px}.od-PromotedPhotos-featuredAlbum{height:140px;overflow:hidden;margin-bottom:4px}.lg .od-PromotedPhotos-featuredAlbum,.xlg .od-PromotedPhotos-featuredAlbum,.xxlg .od-PromotedPhotos-featuredAlbum,.xxxlg .od-PromotedPhotos-featuredAlbum,.xxxxlg .od-PromotedPhotos-featuredAlbum{height:380px}.od-PromotedPhotos-featuredAlbum .od-PromotedPhotos-itemTile{margin-top:4px}html[dir=ltr] .od-PromotedPhotos-featuredAlbum .od-PromotedPhotos-itemTile{float:left}html[dir=rtl] .od-PromotedPhotos-featuredAlbum .od-PromotedPhotos-itemTile{float:right}.od-PromotedPhotos .ItemTile .ItemTile-name{font-size:21px;font-weight:100}.od-PromotedPhotos .ItemTile.is-tag,.od-PromotedPhotos .ItemTile.od-OnThisDayTile{top:8px}.od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-name{bottom:28px;line-height:31px;left:12px;right:12px}.xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-name,.xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-name,.xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-name,.xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-name{left:20px;right:20px;bottom:40px}.od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum.od-ItemTile--noDate .ItemTile-name{bottom:12px}.xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum.od-ItemTile--noDate .ItemTile-name,.xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum.od-ItemTile--noDate .ItemTile-name,.xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum.od-ItemTile--noDate .ItemTile-name,.xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum.od-ItemTile--noDate .ItemTile-name{bottom:20px}.od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date{display:block;position:absolute;top:auto;bottom:12px;font-size:14px}[dir=ltr] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date{left:12px}[dir=rtl] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date{right:12px}.xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,.xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,.xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,.xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date{bottom:20px}[dir=ltr] .xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,[dir=ltr] .xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,[dir=ltr] .xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,[dir=ltr] .xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date{left:20px}[dir=rtl] .xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,[dir=rtl] .xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,[dir=rtl] .xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,[dir=rtl] .xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date{right:20px}.od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{font-size:14px;bottom:12px}[dir=ltr] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{right:12px}[dir=rtl] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{left:12px}[dir=ltr] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{left:auto}[dir=rtl] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{right:auto}.xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,.xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,.xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,.xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{bottom:20px}[dir=ltr] .xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,[dir=ltr] .xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,[dir=ltr] .xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,[dir=ltr] .xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{right:20px}[dir=rtl] .xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,[dir=rtl] .xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,[dir=rtl] .xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,[dir=rtl] .xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{left:20px}.od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge{bottom:53px}.xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,.xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,.xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,.xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge{bottom:72px}[dir=ltr] .xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,[dir=ltr] .xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,[dir=ltr] .xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,[dir=ltr] .xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge{left:9px}[dir=rtl] .xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,[dir=rtl] .xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,[dir=rtl] .xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,[dir=rtl] .xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge{right:9px}.od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .od-newBadge{font-size:15px}[dir=ltr] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .od-newBadge .od-newBadge-icon{margin-right:-.55em}[dir=rtl] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .od-newBadge .od-newBadge-icon{margin-left:-.55em}"},{"rawString":".od-photos-promoted-AllPhotos .od-ComponentCarousel-topNavigation{margin-top:3px;margin-bottom:8px}.od-photos-promoted-AllPhotos .od-ComponentCarousel-title{margin-top:23px;font-size:18px;font-weight:700;margin-bottom:0}.od-photos-promoted-AllPhotos .od-ComponentCarousel-nav{margin-bottom:0}.od-photos-promotedWrapper--loaded{transition:height 467ms cubic-bezier(.1,.25,.75,.9)}"},{"rawString":".calloutMain_680dc4c6{position:absolute;-ms-high-contrast-adjust:none;border-radius:2px;background:#fff;border-radius:2px;-webkit-box-shadow:0px 1.6px 3.6px 0px rgba(0,0,0,0.13),0px 0.3px 0.9px 0px rgba(0,0,0,0.11);box-shadow:0px 1.6px 3.6px 0px rgba(0,0,0,0.13),0px 0.3px 0.9px 0px rgba(0,0,0,0.11)}.calloutMain_680dc4c6:hover{border-radius:2px;-webkit-box-shadow:0px 6.4px 14.4px 0px rgba(0,0,0,0.13),0px 1.2px 3.6px 0px rgba(0,0,0,0.11);box-shadow:0px 6.4px 14.4px 0px rgba(0,0,0,0.13),0px 1.2px 3.6px 0px rgba(0,0,0,0.11)}.calloutMain_680dc4c6:focus{border-radius:0px;border:1px solid #605e5c;height:32px;width:84px}.calloutMain_680dc4c6:active{border-radius:2px;-webkit-box-shadow:0px 6.4px 14.4px 0px rgba(0,0,0,0.13),0px 1.2px 3.6px 0px rgba(0,0,0,0.11);box-shadow:0px 6.4px 14.4px 0px rgba(0,0,0,0.13),0px 1.2px 3.6px 0px rgba(0,0,0,0.11)}.textCallout_680dc4c6{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:rgba(0,0,0,0);font-size:14px;font-weight:550;font-family:'Segoe UI'}\n"},{"rawString":".normalText_f81b8f8e{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-ser-select:none;-ms-user-select:none;user-select:none;color:gray;font-family:'Segoe UI';font-size:12px;-webkit-text-fill-color:gray}\n"},{"rawString":".scrubber_851e501c{outline:none;cursor:pointer}.timeLine_851e501c{position:absolute;border:0px;padding:0px;padding-left:0px;padding-right:0px;pointer-events:none;outline:none}html[dir='ltr'] .timeLine_851e501c{margin-right:0px}html[dir='rtl'] .timeLine_851e501c{margin-left:0px}.timeLine_851e501c:focus{outline:none;outline-color:none;outline-width:0px}.timeLineInteractive_851e501c{position:absolute;border:0px;padding:0px;padding-left:0px;padding-right:0px;pointer-events:auto;outline:none}html[dir='ltr'] .timeLineInteractive_851e501c{margin-right:0px}html[dir='rtl'] .timeLineInteractive_851e501c{margin-left:0px}.timeLineInteractive_851e501c:focus{outline:none;outline-color:none;outline-width:0px}\n"},{"rawString":".listCell_b8824898{display:block;margin:0;border-color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"}.listPage_b8824898{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.cell_b8824898{display:block;position:relative}.cellContent_b8824898{position:absolute;top:0;left:0;bottom:0;right:0}.cellFirstInRow_b8824898{display:block}.sizer_b8824898{display:block;visibility:hidden}.grid_b8824898{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-ms-flex-line-pack:start;align-content:flex-start}.shimmeredList_b8824898::after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;background-image:-webkit-gradient(linear, left top, left bottom, color-stop(30%, transparent), color-stop(65%, "},{"theme":"whiteTranslucent40","defaultValue":"rgba(255,255,255,.4)"},{"rawString":"), to("},{"theme":"white","defaultValue":"#ffffff"},{"rawString":"));background-image:linear-gradient(to bottom, transparent 30%, "},{"theme":"whiteTranslucent40","defaultValue":"rgba(255,255,255,.4)"},{"rawString":" 65%, "},{"theme":"white","defaultValue":"#ffffff"},{"rawString":" 100%)}.none_b8824898{display:block}\n"},{"rawString":".isFluent_94325870 .AllPhotosTilesList .ms-Tile .ms-Tile-link:hover .ms-Tile-nameplate .ms-Tile-name{text-decoration:none}.AllPhotosTilesList .ms-Tile .ms-Tile-content{position:static}.AllPhotosTilesList .ms-Tile .ms-Tile-aboveNameplate{margin:0px}.isFluent_94325870 .AllPhotosTilesList .ms-Tile.ms-Tile--isSelectable:hover{background-color:"},{"theme":"neutralLighter","defaultValue":"#f4f4f4"},{"rawString":"}.isFluent_94325870 .AllPhotosTilesList .ms-Tile.ms-Tile--isSelectable.ms-Tile--isSelected{background-color:"},{"theme":"neutralLight","defaultValue":"#eaeaea"},{"rawString":"}.isFluent_94325870 .AllPhotosTilesList .ms-Tile.ms-Tile--isSelectable.ms-Tile--isSelected .ms-Tile-name{font-weight:600}.isFluent_94325870 .AllPhotosTilesList .ms-Tile.ms-Tile--isSelectable.ms-Tile--isSelected:hover{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#dadada"},{"rawString":"}.isFluent_94325870 .AllPhotosTilesList .ms-Tile.ms-Tile--isSelectable .ms-FolderCover-signal i{color:"},{"theme":"neutralSecondary","defaultValue":"#666666"},{"rawString":"}.isFluent_94325870 .AllPhotosTilesList .ms-Tile-name,.isFluent_94325870 .AllPhotosTilesList .ms-Tile-activity{color:"},{"theme":"neutralPrimary","defaultValue":"#333333"},{"rawString":"}.ms-Fabric--isFocusVisible .isFluent .ms-Tile:focus,.ms-Fabric--isFocusVisible .isFluent .ms-Tile.ms-Tile--isSelected:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#666666"},{"rawString":"}\n"},{"rawString":".groupHeader_603bc36b{-webkit-user-select:none;position:relative;padding:0px;overflow:visible;font-size:18px;text-overflow:ellipsis;white-space:nowrap}html[dir='ltr'] .groupHeader_603bc36b{float:left}html[dir='rtl'] .groupHeader_603bc36b{float:right}.groupHeader_603bc36b .groupHeaderTitle_603bc36b{font-size:18px;height:20px;left:0;margin:0;float:left;position:relative;font-weight:bold;display:block;cursor:pointer;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:100%}.groupHeader_603bc36b .groupHeaderTitle_603bc36b:focus{outline:none}.groupHeader_603bc36b .groupHeaderTitle_603bc36b .aboveNameplate{position:relative;margin:0px}.groupHeader_603bc36b .locationHeader_603bc36b:hover{text-decoration:underline}.groupHeader_603bc36b .locationHeader_603bc36b:focus{text-decoration:underline}.groupHeader_603bc36b .clicking_603bc36b:focus{outline:none !important}.groupHeader_603bc36b .tabbing_603bc36b:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#666666"},{"rawString":" !important}.groupHeader_603bc36b .groupHeaderMenu_603bc36b{color:"},{"theme":"neutralPrimary","defaultValue":"#333333"},{"rawString":";font-size:18px;background-color:white;padding:0px}.groupHeader_603bc36b .groupHeaderMenu_603bc36b:hover{background-color:white}.groupHeader_603bc36b .ms-Button-label{font-weight:normal;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:normal}.groupHeader_603bc36b .ms-Button-label:hover{text-decoration:underline}.groupHeader_603bc36b .groupHeaderCheckbox_603bc36b{float:right;cursor:pointer;position:relative}.groupHeader_603bc36b .groupHeaderCheckbox_603bc36b:focus{outline:none}.groupHeader_603bc36b .groupHeaderCheckbox_603bc36b:active{outline:none}.groupHeader_603bc36b .locationStyle_603bc36b{float:none;position:relative;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:1px}.groupHeader_603bc36b .locationStyle_603bc36b .locationHeader_603bc36b{cursor:pointer}.groupHeader_603bc36b .locationStyle_603bc36b .locationHeader_603bc36b:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#666666"},{"rawString":"}.groupHeader_603bc36b .locationStyle_603bc36b .locationHeader_603bc36b:hover{text-decoration:underline}.groupHeader_603bc36b .locationStyle_603bc36b .locationHeader_603bc36b:active{outline:none}\n"},{"rawString":".tileViewport_1d2dc7ef{background-color:"},{"theme":"neutralLighter","defaultValue":"#f4f4f4"},{"rawString":";outline:1px solid transparent}.tileViewport_1d2dc7ef:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#666666"},{"rawString":" !important}.rotate0TO90_1d2dc7ef{-webkit-animation:rotateKeyFrame1_1d2dc7ef 0.1s ease;animation:rotateKeyFrame1_1d2dc7ef 0.1s ease}@-webkit-keyframes rotateKeyFrame1_1d2dc7ef{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(90deg);transform:rotate(90deg)}}@keyframes rotateKeyFrame1_1d2dc7ef{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(90deg);transform:rotate(90deg)}}.rotate90TO180_1d2dc7ef{-webkit-animation:rotateKeyFrame2_1d2dc7ef 0.1s ease;animation:rotateKeyFrame2_1d2dc7ef 0.1s ease}@-webkit-keyframes rotateKeyFrame2_1d2dc7ef{from{-webkit-transform:rotate(90deg);transform:rotate(90deg)}to{-webkit-transform:rotate(180deg);transform:rotate(180deg)}}@keyframes rotateKeyFrame2_1d2dc7ef{from{-webkit-transform:rotate(90deg);transform:rotate(90deg)}to{-webkit-transform:rotate(180deg);transform:rotate(180deg)}}.rotate180TO270_1d2dc7ef{-webkit-animation:rotateKeyFrame3_1d2dc7ef 0.1s ease;animation:rotateKeyFrame3_1d2dc7ef 0.1s ease}@-webkit-keyframes rotateKeyFrame3_1d2dc7ef{from{-webkit-transform:rotate(180deg);transform:rotate(180deg)}to{-webkit-transform:rotate(270deg);transform:rotate(270deg)}}@keyframes rotateKeyFrame3_1d2dc7ef{from{-webkit-transform:rotate(180deg);transform:rotate(180deg)}to{-webkit-transform:rotate(270deg);transform:rotate(270deg)}}.rotate270TO360_1d2dc7ef{-webkit-animation:rotateKeyFrame4_1d2dc7ef 0.1s ease;animation:rotateKeyFrame4_1d2dc7ef 0.1s ease}@-webkit-keyframes rotateKeyFrame4_1d2dc7ef{from{-webkit-transform:rotate(270deg);transform:rotate(270deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotateKeyFrame4_1d2dc7ef{from{-webkit-transform:rotate(270deg);transform:rotate(270deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}\n"},{"rawString":".ReactGridGallery{scrollbar-width:none;-ms-overflow-style:none}.ReactGridGallery:focus{outline:none}.ReactGridGallery::-webkit-scrollbar{width:0px;background:transparent}\n"},{"rawString":".Tile-playButton{position:absolute;color:"},{"theme":"white","defaultValue":"#ffffff"},{"rawString":";bottom:8px;font-size:1.3em}[dir=ltr] .Tile-playButton{left:8px}[dir=rtl] .Tile-playButton{right:8px}"}]);return {Tile_1:{tile:'tile_90cacf48',selectable:'selectable_90cacf48',selected:'selected_90cacf48',isFluentStyling:'isFluentStyling_90cacf48',name:'name_90cacf48',hasBackgroundFrame:'hasBackgroundFrame_90cacf48',invokable:'invokable_90cacf48',label:'label_90cacf48',description:'description_90cacf48',link:'link_90cacf48',foreground:'foreground_90cacf48',foregroundHide:'foregroundHide_90cacf48',hasForegroundFrame:'hasForegroundFrame_90cacf48',check:'check_90cacf48',uninvokable:'uninvokable_90cacf48',showCheck:'showCheck_90cacf48',background:'background_90cacf48',backgroundHide:'backgroundHide_90cacf48',aboveNameplate:'aboveNameplate_90cacf48',content:'content_90cacf48',nameplate:'nameplate_90cacf48',activity:'activity_90cacf48',signal:'signal_90cacf48',storageSignal:'storageSignal_90cacf48',socialSignal:'socialSignal_90cacf48',lifecycleSignal:'lifecycleSignal_90cacf48',isLarge:'isLarge_90cacf48',isSmall:'isSmall_90cacf48',hasBackground:'hasBackground_90cacf48',onlyOnHover:'onlyOnHover_90cacf48',showBackground:'showBackground_90cacf48'},Signal_4:{signal:'signal_63cd35e0',dark:'dark_63cd35e0',selected:'selected_63cd35e0',isFluent:'isFluent_63cd35e0'},Check_8:{root:'root_f2de5b4d',rootIsChecked:'rootIsChecked_f2de5b4d',check:'check_f2de5b4d',checkHost:'checkHost_f2de5b4d',circle:'circle_f2de5b4d'},Scrubber_9:{scrubber:'scrubber_851e501c',timeLine:'timeLine_851e501c',timeLineInteractive:'timeLineInteractive_851e501c'},ScrubberCallout_3:{calloutMain:'calloutMain_680dc4c6',textCallout:'textCallout_680dc4c6'},ScrubberText_0:{normalText:'normalText_f81b8f8e'},AllPhotosTilesList_7:{isFluent:'isFluent_94325870'},TilesList_5:{listCell:'listCell_b8824898',listPage:'listPage_b8824898',cell:'cell_b8824898',cellContent:'cellContent_b8824898',cellFirstInRow:'cellFirstInRow_b8824898',sizer:'sizer_b8824898',grid:'grid_b8824898',shimmeredList:'shimmeredList_b8824898',none:'none_b8824898'},GroupHeader_1:{groupHeader:'groupHeader_603bc36b',groupHeaderTitle:'groupHeaderTitle_603bc36b',locationHeader:'locationHeader_603bc36b',clicking:'clicking_603bc36b',tabbing:'tabbing_603bc36b',groupHeaderMenu:'groupHeaderMenu_603bc36b',groupHeaderCheckbox:'groupHeaderCheckbox_603bc36b',locationStyle:'locationStyle_603bc36b'},Image_7:{tileViewport:'tileViewport_1d2dc7ef',rotate0TO90:'rotate0TO90_1d2dc7ef',rotateKeyFrame1:'rotateKeyFrame1_1d2dc7ef',rotate90TO180:'rotate90TO180_1d2dc7ef',rotateKeyFrame2:'rotateKeyFrame2_1d2dc7ef',rotate180TO270:'rotate180TO270_1d2dc7ef',rotateKeyFrame3:'rotateKeyFrame3_1d2dc7ef',rotate270TO360:'rotate270TO360_1d2dc7ef',rotateKeyFrame4:'rotateKeyFrame4_1d2dc7ef'}}});