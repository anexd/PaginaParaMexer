wac_pob.prototype.Beb=wac_5(947662998,function(a,b,c,d){a=new wac_aL(new wac_nob(a,b),c,d,function(a){return!a.StatusCode},0,null,null,2);this.AB.d7(a,this.Ca,!1)});wac_pob.prototype.HG=wac_5(1768140151,function(a,b,c,d,e,f,g,h){a=new wac_aL(new wac_eY(a,b,c,d,e,f),g,h,function(a){return!a.StatusCode},0,null,null,2);this.AB.d7(a,this.Ca,!1)});
wac_BX.prototype.Jca=wac_5(-600525999,function(a){var b,c;switch(a){case 22:b=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;c=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;default:return}b=this.ME.Db(b,c,null);b.Do(a);b.Lja(1);wac_KP(b,!0);wac_CX(this,b)});wac_f_.prototype.iD=wac_5(-1869917821,function(){return this.Ao.ej(String,wac_Kua,null)});wac_f_.prototype.wF=wac_5(-192743680,function(){return this.Ao.Za(Number,wac_oua)});
wac_ICc.prototype.jee=wac_5(761801586,function(a,b){this.Xeb.a2e(a);b&&b.O()});wac_ICc.prototype.rne=wac_5(2097531658,function(a){a.Qva||(this.Xeb.h2e(a._id),a.Ki(),a.dZb=this.NYe,wac_Yzb(this.jn,a.Ahc),this.jn.Tg(!1))});wac_JS.prototype.y7=wac_5(-414161050,function(){wac_7k()&&wac_CS(wac_KS(this),{DocChat:"ButtonModel"})});wac_MS.prototype.y7=wac_5(-2077628593,function(){this.pK.y7()});wac_JX.prototype.y7=wac_5(680888400,function(){});wac_40b.prototype.y7=wac_5(-1454752941,function(){this.Mt.y7()});
wac_BQ.prototype.RDb=wac_5(1989496113,function(a){wac_AQ.fC(5018263,!!this.hCa,null);Array.add(this.hCa,a);wac_AQ.Ex(5018264,2,"Allow free sending: {0}",a);return!0});
wac_CL.prototype.s2e=wac_5(-1898054939,function(){var a=[],b;if((b=wac_AI(this.Pb))&&wac_DQ(b)){var c=wac_X(b),d=[];if(c.mb(34)){do{var e=c.ea();e.sja=[];for(var f=b.Msc,g=f.length,h=0;h<g;++h){var k=f[h];if(wac_CQ(e))for(var l=wac_CQ(e),m=l.length,n=0;n<m;++n)wac_fl(l[n],k.ia())&&e.sja.push(wac_yF(k.Vc(),k.fe()))}Array.add(d,e)}while(c.ge(34))}b=d}else b=null;if(!b||!b.length)return a;c=b.length;for(d=0;d<c;++d){e=b[d];f=[];g=e.sja;h=g.length;for(k=0;k<h;++k){var l=g[k],p;f.push((p=new wac_Ta,p.Cid=
l.fe(),p.Sid=l.Vc(),p))}var q,e=(q=new wac_$sa,q.Id=e.ia().toString(),q.Title=e.Cz(),q.SlideIds=f,q);a.push(e)}return a});wac_JM.prototype.s2e=wac_5(610610388,function(){return null});wac_rI.prototype.fsa=wac_5(1119380928,function(){return new wac_WN(this.mi(),this.Yc(),this.Gm())});wac_tG.prototype.B9e=wac_5(-1994680739,function(){});
wac_YNa.prototype.B9e=wac_5(-155888164,function(a,b,c,d){var e;a=(e=new wac_5ra,e.PresentationID=a,e.VersionID=b,e);e=new wac_ME("RestoreFileVersion");wac_NE(e,null);wac_OE(e,new wac_PE("restoreVersionParams",a));wac_LE.pr(e,c,d,null,null,null,2)});wac_tG.prototype.O8e=wac_5(1785958266,function(){});
wac_YNa.prototype.O8e=wac_5(-300714119,function(a,b,c,d,e,f,g,h,k,l,m,n,p){var q=new wac_ME("ClosePopWacSessionSync");wac_NE(q,m);wac_OE(q,new wac_PE("popSessionID",a));wac_OE(q,new wac_PE("podSessionID",b));wac_OE(q,new wac_PE("presentationID",c));wac_OE(q,new wac_PE("podUrl",d));wac_OE(q,new wac_PE("podInstance",e));wac_OE(q,new wac_PE("fTimeoutOrUserClose",f));wac_OE(q,new wac_PE("forceHardClose",g));wac_LE.pr(q,h,k,l,n,p,2)});wac_.prototype.yOa=wac_5(1557014499,function(){return null});
wac_nM.prototype.yOa=wac_5(-554528132,function(){var a=new wac_Rh;a.iOa="PptJewel.New";a.kyc="PptJewel.New.Blank";a.lyc=ResourceStrings.L_NewBlank;a.myc=ResourceStrings.L_NewBlankDescription;a.ZOa=this.Ob.ed.Io("prt2.png");a.$Oa="prt2_OLKNewButton_32x32x32";a.fV=ResourceStrings.L_New;a.KFb=this.Pi()?this.ftb+"p/":"";return a});wac_.prototype.zOa=wac_5(-1371525569,function(){return null});
wac_nM.prototype.zOa=wac_5(1890129606,function(){var a=new wac_Sh;a.iOa="PptJewel.Open";a.ZOa=this.Ob.ed.Io("prt2.png");a.$Oa="prt2_SaveAsPowerPointPptx_32x32x32";return a});wac_.prototype.qze=wac_5(285984587,function(){return!1});wac_nM.prototype.qze=wac_5(-1840172508,function(){return this.od.Ta.ao});
wac_1f.prototype.BGb=wac_5(-1111067053,function(){var a=1===this.Kb(),b=wac_3ga(wac_hh(),wac_6q)||wac_IYa(wac_hh(),wac_6q,wac_.O8a),c=wac_2g||wac_hf||wac_q(wac_.pa,"ProtectedFile");return!(a&&b)&&!c&&wac_.Vgb});wac_xM.prototype.BGb=wac_5(2041535240,function(){return wac_1f.prototype.BGb.call(this)&&0<wac_II(wac_j().H(wac_Mt))});wac_oN.prototype.BGb=wac_5(-1106878778,function(){return!0});
function wac_9Zc(a,b,c){a.SQe.Zlf=b;wac_Y(41682758,830,50,"Toggling transcriber's Live Broadcast mode ... On: {toggleOn}");var d;wac_q7(a,(d=new wac__Uc,d.IsToggleOn=b,d.PragueSessionInfo=c,d));wac_TUc(a)}function wac_$Zc(a){wac_Y(51200071,830,50,"SlideShowFrame: Exiting with post message");wac_q7(a,new wac_r7(3))}function wac_a_c(a,b){a.la.sb("OnPositionChangeEventId",b)}
function wac_sob(a,b,c,d,e,f,g,h,k,l){b=new wac_aL(new wac_iob(b,c,d,e,f,null,g,h),k,l,function(a){return!a.StatusCode},0,null,null,2);a.AB.d7(b,a.Ca,!1)}function wac_rob(a,b,c,d){b=new wac_aL(new wac_mob(b,c),null,d,function(a){return!a.StatusCode},0,null,null,2);a.AB.d7(b,a.Ca,!1)}function wac_znc(a,b,c,d,e,f,g,h,k,l,m){b=new wac_aL(new wac_6jc(b,c,d,e,f,g,74,74,h,k),l,m,function(a){return!a.StatusCode},0,null,null,2);a.AB.d7(b,a.Ca,!1)}
function wac_aHc(a,b){if(!a.Xeb)return wac_b(24134219,371,10,"TaskPaneManager is null when trying to create task pane entry."),null;var c=a.Xeb.Z1e(new wac_dBc,"InsightsTaskPane",1,320),c=new wac_gKb(new wac_fKb,c,a.tVe,new wac_cKb);c.Aa=new wac_oS("InsightsTaskPaneData",b);c.lbe();var d=c.Pa;d.TC=1;a.hVa.uc(function(a){d.ty(a)});d.Nh();return d}function wac_bHc(a,b){a.hid=b}function wac_dvc(a,b){a.la.wa("IC",b,null)}function wac_Bnc(a){a.la.wa("AROSBSR",Sys.EventArgs.Empty,null)}
function wac_Cnc(a){a.la.wa("AROSASR",Sys.EventArgs.Empty,null)}function wac_Dnc(a,b){a=wac_fO(a,b.yaa);a:{b=b.n7b;if(a&&b){var c=wac_X(a),d;for(d=c.mb(37);d;d=c.ge(37))if((d=window.$$as(wac_HH,d))&&b.Ka(d.Gm())){b=d;break a}}b=null}return b||a}function wac_fvc(a,b){wac_v(a,wac_ltb,b)}function wac_KBb(a,b,c,d,e){wac_v(a,wac_wq,!0);wac_v(a,wac_Uq,!0);wac_v(a,wac_wua,b);c&&wac_v(a,wac_Pq,c);d&&wac_v(a,wac_vnb,d);e&&wac_v(a,wac_wnb,e)}function wac_DCb(a){return!a.uka&&a.gva}
function wac_LO(a,b,c){a.E0b[b.toString()]=c}function wac_b_c(a,b){for(var c=0;c<a.na();c++)if(!b||b(a.K(c)))return!0;return!1}var wac_c_c=!0,wac_uDb=null;function wac_d_c(){if(!wac_c_c)return null;var a=null;try{a=localStorage}catch(b){wac_c_c=!1,a=null}return a}
function wac_$Cb(a,b,c){wac_v(a,wac_Dqa,b.targetType===window.OSF.OsfControlTarget.InContent);wac_v(a,wac_Xo,b.id);wac_v(a,wac_Eqa,b.appVersion);wac_v(a,wac_Fqa,b.storeId);wac_v(a,wac_Gqa,b.currentStoreType);wac_v(a,wac_oua,c.tFb(b.currentStoreType));b.assetId&&wac_v(a,wac_pua,b.assetId);wac_v(a,wac_qua,b.assetStoreId);wac_Wb(b.isAddinCommands)?wac_v(a,wac_fua,!1):wac_v(a,wac_fua,b.isAddinCommands);b.targetType===window.OSF.OsfControlTarget.InContent&&(wac_v(a,wac_rq,!0),c=b.height?b.height:200,wac_v(a,
wac_En,b.width?b.width:200),wac_v(a,wac_Fn,c))}var wac_dHc=null,wac_SIb=null,wac_e_c={},wac_dDb={};function wac_f_c(a){return String.format(a.toString())}function wac_fDb(a,b,c,d,e){return String.format("{0}|{1}|{2}|{3}|{4}",a.toLowerCase(),b,c.toLowerCase(),d.toLowerCase(),e.toLowerCase())}function wac_hDb(a,b,c,d){if(!a)throw Error.argumentNull("formatInfo");var e=a.SlideHeight;c.val=a.SlideWidth;d.val=e;a=c.val/d.val;a!==b&&(a>b?c.val=Math.round(d.val*b):d.val=Math.round(c.val/b))}
function wac_g_c(a,b){var c=null;try{var d=wac_d_c();if(!wac_Wb(d)&&d)var e=a+"_"+wac_uDb+"_"+wac_Nf(wac_.J0)+"_"+b,c=d.getItem(e);else wac_b(42074645,220,10,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(f){wac_b(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",a,b)}return c}function wac_eHc(){return wac_dHc||(wac_dHc=new wac_ICc(wac_Aic(wac_9s()),window.Box4.App.zb().Xeb,window.Box4.App.zb(),wac_l(wac_j(),wac_hs)))}
function wac_g3(){wac_SIb||(wac_SIb=new wac_RIb);return wac_SIb}function wac_Enc(a,b){if(!a||!b)return!a&&!b;var c;c=a.n7b&&b.n7b?a.n7b.Ka(b.n7b):!a.n7b&&!b.n7b;return wac_$xb(a.mg,b.mg)&&a.yaa===b.yaa&&c}function wac_eEb(a){var b=[],c;for(c in a)Array.add(b,a[c]);return b}
function wac_h_c(a,b,c){try{var d=wac_d_c();if(!wac_Wb(d)&&d){var e=a+"_"+wac_uDb+"_"+wac_Nf(wac_.J0)+"_"+c;d.setItem(e,b)}else wac_b(42074647,220,10,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(f){wac_b(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",a,c)}}function wac_iEb(){return"ack3_"+wac_uDb+"_"+wac_Nf(wac_.J0)+"_"}
function wac_gvc(a){try{window.Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(a)}catch(b){}}function wac_hvc(a){try{window.Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(a)}catch(b){}}function wac_Q1(){return!!wac_r()&&!!wac_r().Hd()&&4===wac_r().Hd().Nv()||wac_.jEb||wac_.hJb&&wac_.iEb&&wac_q(wac_.pa,"InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled")&&wac__g&&!wac_.LIb}Type.registerNamespace("Common.App.AddinCommands");
wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.Nwd=wac_d.Qa.Nwd||{};function wac_fIb(){}wac_fIb.registerInterface("Common.App.AddinCommands.IAddinCommandsInitializer");function wac_gIb(a,b,c){this.zka=c;this.AKa=a;this.Tf=b}wac_gIb.prototype={Tf:null,zka:0,AKa:null,MCc:function(a){var b=null;this.Tf&&(b=this.Tf.uj("ComponentAttach",wac_d.Xwa.toString(a)+wac_d.yla.toString(this.zka)));if(null==this.tQb(a)?0:this.tQb(a)){var c=(new Date).getTime()-2592E5;this.AKa(a,this.zka,{ak0:c})}b&&b.vg()}};
function wac_hIb(a,b){wac_hIb.initializeBase(this,[a,b,5])}wac_hIb.prototype={tQb:function(){return!0}};function wac_iIb(a,b,c){this.zka=2;this.AKa=a;this.Rtc=b;this.Pja=c}
wac_iIb.prototype={Pja:null,zka:0,Rtc:null,AKa:null,MCc:function(a){var b=!!wac_.pa&&wac_q(wac_.pa,"AppCommandsQuickCheckIsEnabled");if(!b||window.parseInt(wac_g_c("ak2",a)||"-1")<=(new Date).getTime()){var c=wac_r().Hd().jO(),c=String.format(c+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",wac_r().Hd().Nv(),this.Rtc,wac_.eo),d=wac_.Af,e=null;this.Pja&&(e=this.Pja.uj("ComponentAttach",wac_d.Xwa.toString(a)+wac_d.yla.toString(this.zka)));var f=this;d.lk(c,1,null,null,!0,
4,function(c){if(c=window.Sys.Net.XMLDOM(c.Aa.Be)){b&&wac_h_c("ak2",((new Date).getTime()+144E5).toString(),a);var d=c.getElementsByTagName("update");d&&d.length||(d=c.getElementsByTagName("o:update"));d&&0<d.length&&(c=Date.parse(d[0].firstChild.nodeValue),d=b?window.parseInt(wac_g_c("ak0",a)||"-1"):-1,(!b||d<c||Boolean.parse(wac_g_c("ak4",a)||"false"))&&f.AKa(a,f.zka,{ak0:c}))}e&&e.vg()},function(a){wac_b(17438153,220,50,"GetLastUpdate request failed with {0}.",a.Aa.ho);e&&e.vg()},null,null,!1,
null,null,null,null,!1,null,!1)}else Boolean.parse(wac_g_c("ak4",a)||"false")&&(c=window.parseInt(wac_g_c("ak0",a)||"-1"),this.AKa(a,this.zka,{ak0:c}))}};function wac_jIb(a,b){wac_jIb.initializeBase(this,[a,b,1])}wac_jIb.prototype={tQb:function(a){try{var b=wac_iEb()+a;return Boolean.parse(wac_kIb(b)||"false")}catch(c){wac_b(17306844,220,50,"LocalStorage is not allowed, {0}.",c.toString())}return null}};function wac_kIb(a){var b=localStorage;return wac_Wb(b)||null===b?null:b.getItem(a)}
function wac_lIb(a){this.Cwb=Function.createDelegate(this,this.M_d);this.Pja=a}wac_lIb.prototype={Pja:null,M_d:function(a,b,c){c&&c.ak0&&(c.ack1=a,c.ack0=b,this.aj.$k().os(1782110672,2,c,null),wac_.pa&&wac_q(wac_.pa,"AppCommandsQuickCheckIsEnabled")&&wac_h_c("ak0",c.ak0.toString(),a))}};wac_gIb.registerClass("Common.App.AddinCommands.AddinCommandsInitializerBase",null,wac_fIb);wac_hIb.registerClass("Common.App.AddinCommands.AddinCommandsInitializer",wac_gIb);
wac_iIb.registerClass("Common.App.AddinCommands.AddinCommandsAnonymousAPIInitializer",null,wac_fIb);wac_jIb.registerClass("Common.App.AddinCommands.AddinCommandsLocalCacheInitializer",wac_gIb);wac_lIb.registerClass("Common.App.AddinCommands.AddinCommandsInitializerHost");Type.registerNamespace("Common.App.DirectPrint");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.SBd=wac_d.Qa.SBd||{};function wac_uNb(){}wac_uNb.registerInterface("Common.App.DirectPrint.IDirectPrintDialog");
function wac_vNb(){}wac_vNb.registerInterface("Common.App.DirectPrint.IDirectPrintDialogFactory");function wac_h4(){}wac_h4.registerInterface("Common.App.DirectPrint.IDirectPrintManager");
function wac_wNb(a){this.yx=Boolean.parse(a.DirectPrintIsEnabled||"false");this.ezc=Boolean.parse(a.DirectPrintProbeIsEnabled||"false");this.Wyc=Boolean.parse(a.DirectPrintEnabledForInternetExplorer||"false");this.zea=(a.DirectPrintSupportedMimeTypes||"").split(wac_xNb);this.C0=(a.DirectPrintSupportedPlugins||"").split(wac_xNb);this.yyc=(a.DirectPrintImmersivePreviewPlugins||"").split(wac_xNb);this.BJb=Boolean.parse(a.DirectPrintEnabledForEdge||"false");this.Slf=Boolean.parse(a.ChromePrintLayoutFixIsEnabled||
"false");this.zlf=window.parseInt(a.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.$bb=14;this.EKb=14394;if(a=a.DirectPrintMinimalSupportedEdgeVersion){var b=a.split(".");2===b.length?(this.$bb=window.parseInt(b[0]),this.EKb=window.parseInt(b[1])):wac_b(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",a)}else wac_b(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}
wac_wNb.prototype={yx:!1,ezc:!1,Wyc:!1,zea:null,C0:null,yyc:null,BJb:!1,$bb:0,EKb:0,Slf:!1,zlf:0};function wac_yNb(a,b,c,d){this.Dcc=Function.createDelegate(this,this.CCd);this.atf=Function.createDelegate(this,this.Ryf);this.Xmd=Function.createDelegate(this,this.vXd);wac_yNb.initializeBase(this);this.FZb=b;this.dF=a;this.MKc=c;this.S6e=d;this.pra=new wac_Za("LoadResource","LoadPrintablePdf")}
wac_yNb.prototype={aCa:null,q1a:null,S6e:null,FZb:null,dF:null,MKc:!1,pra:null,N1:null,n_:function(){wac_Nh(this,5);this.uT(40);var a=document.createElement("span");a.id=this.Rf("DirectPrintHeaderContent");var b=document.createElement("span");b.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(b,"DirectPrintHeader");this.N1=document.createElement("iframe");this.N1.name="pdfObjectFrame";this.N1.onload=this.Xmd;if(this.S6e&&0<this.S6e.Ma()){var c=wac_pOc(this.FZb,this.S6e),
d=wac_oOc(this.FZb,this.S6e);this.q1a=document.createElement("form");this.q1a.id="printPreviewPostForm";this.q1a.method="POST";this.q1a.target=this.N1.name;this.q1a.action=d;for(c=c.GetEnumerator();c.$$mn();){var d=c.$$cu(),e=document.createElement("input");e.type="hidden";e.name=d.rh();e.value=d.ma();this.q1a.appendChild(e)}}else this.N1.setAttribute("src",this.FZb);Sys.UI.DomElement.addCssClass(this.N1,"ObjectInDialog");this.MKc?(Sys.UI.DomElement.addCssClass(this.N1,"DirectPrintPdfObjectHidden"),
b.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,wac_Fe(this.N1,"aria-hidden","true")):Sys.UI.DomElement.addCssClass(this.N1,"DirectPrintPdfObject");a.appendChild(b);a.appendChild(document.createElement("br"));a.appendChild(this.N1);this.q1a&&a.appendChild(this.q1a);a.appendChild(document.createElement("br"));a.appendChild(wac_zNb(this,this.q1a?"#":this.FZb));this.pra.Wd();wac_en(this,CommonUIStrings.l_AppTitle,null,null,null,null,a);wac_9m(this,this.Rf("DirectPrintHeaderContent"));this.q1a&&
this.q1a.submit();this.aCa.focus();wac_b(4771852,328,50,"Direct Print Dialog launched.")},Ryf:function(a){this.q1a&&(this.q1a.target="_blank",this.q1a.submit());a.preventDefault()},CCd:function(){wac_b(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1},vXd:function(){this.pra&&this.pra.vg()},dispose:function(){this.aCa&&(this.dF.ub("click",this.aCa,this.Dcc),this.aCa=null);wac_id(this.N1);this.N1=null;wac_di.prototype.dispose.call(this)}};
function wac_zNb(a,b){var c=document.createElement("span"),d=document.createElement("span");d.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;c.appendChild(d);d=document.createElement("a");d.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink;d.href=b;d.target="_blank";d.id="PrintPDFLink";d.className="AllowBrowserClick";a.aCa=d;c.appendChild(document.createElement("br"));c.appendChild(d);a.q1a&&wac_tf(d,"click",a.atf);a.dF.ya("click",a.aCa,a.Dcc,null);return c}
function wac_i4(a){this.dF=a}wac_i4.prototype={dF:null};function wac_ANb(a,b){this.$fb=a;this.C0=b}wac_ANb.prototype={$fb:null,C0:null};function wac_BNb(a,b,c,d,e,f,g,h,k,l){this.y$c=Function.createDelegate(this,this.TEd);this.mx=a;this.SWa=b;this.yYb=c;this.NLc=d;this.rMc=e;this.JDa=new (wac_f.$$(wac_ANb))(this.y$c);this.sUa=f;this.SXb=k;this.jX=g;this.sMc=h;this.pXb=l}
function wac_CNb(a){try{return new ActiveXObject(a),!0}catch(b){wac_b(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",a)}return!1}function wac_DNb(a){return wac_h(a)?!1:!wac_h(a.enabledPlugin)}function wac_ENb(a){return wac_Ek()||wac_ag()&&a.Wyc||a.BJb&&wac_FNb(a)?!0:!1}function wac_FNb(a){var b=wac_F3a();if(b){var c=b.split(".");if(2===c.length)return b=window.parseInt(c[0]),c=window.parseInt(c[1]),b>a.$bb||b===a.$bb&&c>=a.EKb}return!1}
wac_BNb.prototype={mx:null,SWa:null,yYb:null,NLc:null,JDa:null,rMc:null,sUa:null,jX:null,sMc:null,SXb:null,pXb:!1,Rnb:null,Wd:function(){},TEd:function(){var a=Array(this.mx.zea.length);if(!wac_h(this.SWa))for(var b=0;b<this.mx.zea.length;b++)a[b]=this.mx.zea[b]in this.SWa&&this.NLc(this.SWa[this.mx.zea[b]]);for(var b=Array(a.length),c=0;c<a.length;c++){var d;a[c]?(d=this.SWa[this.mx.zea[c]],wac_h(d)?d=null:(d=d.enabledPlugin,d=wac_h(d)?null:d.name)):d=null;b[c]=d}a=Array(this.mx.C0.length);c=!wac_h(this.yYb);
for(d=0;d<this.mx.C0.length;d++){var e=this.mx.C0[d];a[d]=c&&e in this.yYb?!0:this.rMc(e)}c={};d={};for(e=0;e<this.mx.zea.length;e++)c[this.mx.zea[e]]=b[e];for(e=0;e<this.mx.C0.length;e++)d[this.mx.C0[e]]=a[e];return new wac_ANb(c,d)}};
function wac_i_c(a,b){if(a.pXb||!a.mx.yx?0:wac_INb(a)){var c;a:{c=wac_eEb(a.JDa.ma().$fb);for(var d=c.length,e=0;e<d;++e)if(wac_jm(a.mx.yyc,c[e])){c=!0;break a}c=!1}c=c&&!0;d=a.jX.uj("UserAction","OpenDirectPrintDialog");(new wac_yNb(a.sUa.dF,b,c,null)).n_();d.vg()}else a.SXb(b,null)}function wac_INb(a){if(!a.sMc(a.mx))return!1;for(var b=wac_eEb(a.JDa.ma().$fb),c=b.length,d=0;d<c;++d)if(!wac_h(b[d]))return!0;a=wac_eEb(a.JDa.ma().C0);b=a.length;for(c=0;c<b;++c)if(a[c])return!0;return!1}
function wac_JNb(a){if(null!=a.Rnb)return a.Rnb;var b=wac_FNb(a.mx);(b=a.mx.BJb&&b)||(b=wac_Ek()&&a.mx.Slf&&wac_3hc()>=a.mx.zlf?!0:!1);a.Rnb=b;return a.Rnb}function wac_KNb(){}
wac_KNb.prototype={sa:null,Ub:function(){return"Common.App.DirectPrint"},GIc:null,gc:function(a){this.sa=a;wac_m(wac_n(a.fa(wac_i4)),function(){return new wac_i4(wac_r().Dha())});wac_m(wac_n(a.fa(wac_h4)),function(){return new wac_BNb(new wac_wNb(wac_.pa.Qb),window.navigator.mimeTypes,window.navigator.plugins,wac_DNb,wac_CNb,a.H(wac_i4),wac_r().Bz(),wac_ENb,function(a,c){return new wac_d3(a,!1,c)},wac_yg)})},tb:function(){this.GIc=this.sa.H(wac_h4);this.GIc.Wd()},O:function(){}};wac_wNb.registerClass("Common.App.DirectPrint.DirectPrintBrsSettings");
wac_yNb.registerClass("Common.App.DirectPrint.DirectPrintDialog",wac_di,wac_uNb);wac_i4.registerClass("Common.App.DirectPrint.DirectPrintDialogFactory",null,wac_vNb);wac_ANb.registerClass("Common.App.DirectPrint.DirectPrintProbeResults");wac_BNb.registerClass("Common.App.DirectPrint.DirectPrintManager",null,wac_h4);wac_KNb.registerClass("Common.App.DirectPrint.PackageManager",null,wac_I,wac_i);(function(){}).registerClass("Common.App.DirectPrint.Program");var wac_xNb=",";
wac_J(wac_C(),new wac_KNb,0,!1);Type.registerNamespace("Common.App.Embed");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.NCd=wac_d.Qa.NCd||{};function wac_yIb(a,b,c,d){this.Gdb=a;this.d6=b;this.LNb=c;this.Mc=d}wac_yIb.prototype={Gdb:null,d6:null,LNb:null,Mc:0};function wac_zIb(a,b,c){this.Veb=a;this.Oma=b;this.d6=c}wac_zIb.prototype={Veb:null,Oma:null,d6:null};
function wac_e3(a){this.Yld=Function.createDelegate(this,this.iBc);this.i6c=Function.createDelegate(this,this.fvc);this.isd=Function.createDelegate(this,this.J3d);this.N5c=Function.createDelegate(this,this.Exd);this.M5c=Function.createDelegate(this,this.Dxd);this.Zld=Function.createDelegate(this,this.aWd);this.Xld=Function.createDelegate(this,this.$Vd);this.R3a={};this.Jja=[];wac_e3.initializeBase(this);this.OUa=wac_.pya;this.Wlb=a;this.vlb=this.Xld;this.sDa=this.Zld;this.nhb=this.M5c;this.Joa=this.N5c;
this.KYa=this.isd;this.po=wac_AIb.yNa;wac_Nh(this,0);this._id="EmbedDialog"}
wac_e3.prototype={vlb:null,sDa:null,nhb:null,Joa:null,KYa:null,OUa:null,Wlb:null,qnf:476,pnf:288,JUb:798,XZb:476,CPc:288,GDa:null,wlb:null,tUa:null,xlb:null,nga:null,JC:null,gSa:function(){this.Hm(CommonUIStrings.l_Embed,null);this.GDa=document.getElementById("embedpreviewpane");this.wlb=document.getElementById("embedoptionpane");this.GDa.style.width=String.format("{0}px",this.XZb);this.nga=document.createElement("iframe");this.nga.className="EmbedPreviewFrame";this.nga.frameBorder="0";this.nga.style.height=
String.format("{0}px",this.CPc);this.nga.tabIndex=-1;this.GDa.appendChild(this.N4c(CommonUIStrings.l_Preview,this.nga,"Preview","PreviewHeader","Preview",!0));this.JC=document.createElement("textarea");this.JC.className="EmbedCodeTextArea";Sys.UI.DomElement.addCssClass(this.JC,"AllowBrowserContextMenu");this.JC.id="EmbedCode";wac_Ge()||(this.JC.readOnly=!0);this.JC.rows=4;this.JC.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.JC.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;
this.JC.setAttribute("aria-labelledby",String.format("{0} {1}","EmbedCodeHeader","EmbedCodeFooter"));this.GDa.appendChild(this.N4c(CommonUIStrings.l_EmbedCode,this.JC,"EmbedCodeHeader",null,null,!1));wac_tf(this.JC,"focus",this.KYa);var a=document.createElement("span");a.className="EmbedCodeFooter";a.innerText=CommonUIStrings.l_CopyText;a.id="EmbedCodeFooter";this.GDa.appendChild(a);this.tUa=document.createElement("div");this.tUa.className="EmbedDimensionSection";this.wlb.appendChild(this.N4c(CommonUIStrings.l_Dimensions,
this.tUa,null,null,null,!1));this.xlb=document.createElement("div");this.wlb.appendChild(this.SBe("Options",CommonUIStrings.l_Interaction,this.xlb));wac_Nh(this,0);wac_Oh(this,1,CommonUIStrings.l_Close);wac_DIb(this);wac_EIb(this);wac_Ge()||this.JC.focus()},dispose:function(){if(this.R3a){var a=this.R3a,b;for(b in a){var c=a[b];this.Fk.ub("click",c.Gdb,this.vlb);this.Od.ub("keydown",c.Gdb,this.sDa);this.Od.ub("keyup",c.Gdb,this.sDa)}this.sDa=this.vlb=this.R3a=null}if(this.Jja){for(a=0;a<this.Jja.length;++a)this.Fk.ub("click",
this.Jja[a].Oma,this.nhb),this.Od.ub("keydown",this.Jja[a].Oma,this.Joa),this.Od.ub("keypress",this.Jja[a].Oma,this.Joa),this.Od.ub("keyup",this.Jja[a].Oma,this.Joa);this.Od=this.nhb=this.Jja=null}this.KYa&&(wac_jg(this.JC,"focus",this.KYa),this.KYa=null);this.JC=this.nga=this.xlb=this.tUa=this.wlb=this.GDa=null;wac__m.prototype.dispose.call(this)},Pda:function(){wac_0m.prototype.Pda.call(this);this.Rb.style.width=String.format("{0}px",this.JUb);this.HMa()},N4c:function(a,b,c,d,e,f){var g=document.createElement("div");
g.className="EmbedSectionHeader";d&&(g.id=d);e&&g.setAttribute("aria-labelledby",e);f&&(g.tabIndex=0);d=document.createElement("span");d.className="EmbedSectionName UIFontBold";d.innerText=a;c&&(d.id=c);g.appendChild(d);g.appendChild(b);return g},SBe:function(a,b,c){b=this.N4c(b,c,null,null,null,!1);var d=this.fg.createElement("div");d.className="WACGlyph EmbedArrowHolder";d.id="Arrow"+a;d.setAttribute("role","button");d.tabIndex=0;b.insertBefore(d,c);a=wac_4h(16,16,"UpArrowServer","EmbedArrowIcon",
"");d.appendChild(a);a=a.childNodes[0];a.className=wac_9h("OutlookSearchChevronDown_16x16x32");a.title=CommonUIStrings.l_Expand;d.title=CommonUIStrings.l_Expand;c.style.visibility="hidden";c=new wac_zIb(c,d,a);Array.add(this.Jja,c);this.Fk.zA("click",d,this.nhb,c);this.Od.zA("keydown",d,this.Joa,c);this.Od.zA("keypress",d,this.Joa,c);this.Od.zA("keyup",d,this.Joa,c);return b},Dxd:function(a){this.fvc(a);return!0},Exd:function(a){return wac_Cma(this,a,this.i6c)},fvc:function(a){a=a.AYa;"visible"===
a.Veb.style.visibility?(a.Veb.style.visibility="hidden",a.d6.className=wac_9h("OutlookSearchChevronDown_16x16x32"),a.d6.title=CommonUIStrings.l_Expand,a.Oma.title=CommonUIStrings.l_Expand):(a.Veb.style.visibility="visible",a.d6.className=wac_9h("OutlookSearchChevronUp_16x16x32"),a.d6.title=CommonUIStrings.l_Collapse,a.Oma.title=CommonUIStrings.l_Collapse)},$Vd:function(a){this.iBc(a);return!0},aWd:function(a){return wac_Cma(this,a,this.Yld)},iBc:function(a){var b=this.R3a[a.AYa.toString()];b.Mc?(b.Mc=
0,b.d6.className=wac_9h("CheckboxUnchecked_16x16x32"),b.LNb.setAttribute("aria-checked","false")):(b.Mc=1,b.d6.className=wac_9h("CheckboxChecked_16x16x32"),b.LNb.setAttribute("aria-checked","true"));a=a.AYa.toString();b=b.Mc.toString();wac_FIb(this,a,b)&&(wac_DIb(this),wac_EIb(this))},J3d:function(){this.JC.select()}};
function wac_GIb(a){var b=ResourceStrings.l_AutoAdvanceLabel,c=document.createElement("div");c.className="EmbedOption";c.id="wdEaaOption";var d=a.fg.createElement("div");d.tabIndex=0;d.className="EmbedCheckBoxHolder";d.id="wdEaaCheck";d.setAttribute("role","checkbox");d.setAttribute("aria-checked","false");d.setAttribute("aria-labelledby","wdEaaEmbedDescription");c.appendChild(d);c.setAttribute("role","presentation");var e=wac_4h(16,16,"CommentChecked","EmbedOptionImage","");d.appendChild(e);e=e.childNodes[0];
e.id="wdEaaOptionImage";e.className=wac_9h("CheckboxUnchecked_16x16x32");a.R3a.wdEaa=new wac_yIb(c,e,d,0);a.Fk.zA("click",c,a.vlb,"wdEaa");d=document.createElement("span");d.className="EmbedDescription";d.innerText=b;d.id="wdEaaEmbedDescription";c.appendChild(d);a.Od.zA("keydown",c,a.sDa,"wdEaa");a.Od.zA("keyup",c,a.sDa,"wdEaa");return c}function wac_EIb(a){a.nga.contentWindow.location.replace(wac_Ml(a.Wlb,"wdPreview","1",!1))}
function wac_DIb(a){var b=a.JC,c;c=a.OUa;var d=a.qnf;a=a.pnf;if(!wac_HIb){var e=String.format('<a target="_blank" href="{0}">{1}</a>',wac_Bf("https://office.com",wac_wDb()),CommonUIStrings.l_Office),f=String.format('<a target="_blank" href="{0}">{1}</a>',wac_Bf("https://office.com/webapps",wac_wDb()),CommonUIStrings.l_WebAppName);wac_HIb=String.format(CommonUIStrings.l_NoFrames,e,f)}c=String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',wac_Bf(c,wac_wDb()),d,
a,wac_HIb);b.innerText=c}function wac_FIb(a,b,c){var d=wac_Ml(a.OUa,b,c,!1);return a.OUa!==d?(a.OUa=d,a.Wlb=wac_Ml(a.Wlb,b,c,!1),!0):!1}function wac_AIb(){}wac_yIb.registerClass("Common.App.Embed.OptionInfo");wac_zIb.registerClass("Common.App.Embed.SectionInfo");wac_e3.registerClass("Common.App.Embed.EmbedDialog",wac__m);wac_AIb.registerClass("Common.App.Embed.EmbedDialogHtml");var wac_HIb=null;wac_AIb.yNa="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";
Type.registerNamespace("Common.App.AppsForOfficeCommon");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.Bxd=wac_d.Qa.Bxd||{};(function(){}).registerInterface("Common.App.AppsForOfficeCommon.IExtensionIdentity");function wac_j_c(){this.dGe={};this.h8e={}}wac_j_c.prototype={dGe:null,h8e:null};wac_j_c.registerClass("Common.App.AppsForOfficeCommon.ExtensionLaunchProperties");Type.registerNamespace("Common.App.NewAndOpen.Core");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};
wac_d.Qa.PG=wac_d.Qa.PG||{};wac_d.Qa.PG.$I=wac_d.Qa.PG.$I||{};function wac_t6a(){}wac_t6a.prototype={kg:function(){return this._state},pI:function(a){wac_b(5849616,202,50,"Changing event result state. {0}",{OldState:wac_d.N$a.toString(this._state),NewState:wac_d.N$a.toString(a)},"ResultType",this.Fxc());return this._state=a},_state:0};function wac_9P(a,b){this.rJc=a;this.Ab=wac_9P.$$(this.jb["Common.App.NewAndOpen.Core.EventReceiver$1"].T).t7d++;this.rQc=b}
wac_9P.$$=function(a){var b=wac_d.Qa.PG.$I.__tc=wac_d.Qa.PG.$I.__tc||{},c="EventReceiver$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_9P.apply(this,a)};d.registerClass("Common.App.NewAndOpen.Core.__tc."+c,null,wac_nc.$$(a));d.prototype.jb={"Common.App.NewAndOpen.Core.EventReceiver$1":{T:a},ctor:wac_9P};a=wac_9P.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}d.t7d=
0}return b[c]};wac_9P.prototype={rJc:null,rQc:null,Ab:0,ia:function(){return this.Ab},QG:function(a,b){this.rQc(a,b)},XU:function(a,b){var c=this.rJc;(b=b?this:null)&&(c.HSb[b.ia().toString()]=b);return c.cBc(a,b)}};function wac_$P(){this.HSb={}}
wac_$P.$$=function(a){var b=wac_d.Qa.PG.$I.__tc=wac_d.Qa.PG.$I.__tc||{},c="AEventEmitter$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_$P.apply(this,a)};d.registerClass("Common.App.NewAndOpen.Core.__tc."+c,null,wac_oc.$$(a));d.prototype.jb={"Common.App.NewAndOpen.Core.AEventEmitter$1":{T:a},ctor:wac_$P};a=wac_$P.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};
wac_$P.prototype={};function wac_u6a(a,b){var c=a.HSb,d;for(d in c)c[d].QG(b,!1);a.HSb={}}function wac_v6a(){this.k8c=Function.createDelegate(this,this.HBd);this.u5c=Function.createDelegate(this,this.puc);this.dispose=this.O}
wac_v6a.prototype={sa:null,Ub:function(){return"Common.App.NewAndOpen.Core"},gc:function(a){this.sa=a;wac_m(wac_n(a.fa(wac_wc)),function(){return wac_w6a()});wac_m(wac_n(a.fa(wac_oc.$$(wac_sc))),function(){return wac_x6a||(wac_x6a=wac_y6a())});wac_m(wac_n(a.fa(wac_oc.$$(wac_vc))),function(){return wac_aQ()})},tb:function(){var a=this;wac_.pa.Ok(function(){a.aPa()})},aPa:function(){this.sa.H(wac_wc);this.sa.H(wac_oc.$$(wac_sc));this.sa.H(wac_oc.$$(wac_vc));var a=!1,b=wac_w6a();b.Ia.ma().ja(1959943459,
2147483648,b.Wld);wac_Kd?wac_z6a():b.Ia.ma().Mp(1169404878,2147483648,b.R8c,96);wac_0g&&(a=!0);wac_1g&&(wac_A6a(wac_aQ(),"Open",!1),0<wac_nfa&&this.puc(),a=wac_bQ(),b=wac_aQ().jed,a.Ra.xa(a.Q8a,b),a=wac_bQ(),a.Ra.xa(a.Q8a,this.u5c),a=wac_bQ(),a.Ra.xa(a.WIb,this.k8c),a=!0);wac_2fa&&a&&wac_B6a(wac_x6a||(wac_x6a=wac_y6a()),"Document opened",!1);wac_1fa&&(a=wac_aQ(),a.Ov().Ia.ma().ja(3502386740,2147483648,a.gpd),wac_C6a(a,"File Opened"),a=wac_bQ(),b=wac_aQ().med,a.Ra.xa(a.WIb,b),a=wac_bQ(),b=wac_aQ().led,
a.Ra.xa(a.Q8a,b))},HBd:function(){wac_p().Rg(wac_D6a(this))},puc:function(){wac_p().Hb(wac_D6a(this))},eQc:null,O:function(){}};function wac_D6a(a){return a.eQc||(a.eQc=new wac_D(4,2,wac_nfa,wac_aQ().v$c,109,null,!1))}function wac_E6a(){wac_E6a.initializeBase(this);this.pI(0);this.Fva=this.t6a=!1}wac_E6a.prototype={BI:null,Wba:null,t6a:!1,Fva:!1,Fxc:function(){return"GetMoreInfo Result"}};
function wac_F6a(a,b){wac_F6a.initializeBase(this);this.zu=a;this.SDa=new wac_cQ(b,this.zu.ma().Pc.ma(),"GetMoreInfo");this.Xq=new wac_E6a}function wac_y6a(){return new wac_F6a(new (wac_f.$$(wac_wc))(function(){return wac_w6a()}),new (wac_f.$$(String))(function(){return wac_qfa}))}
function wac_G6a(a){if(!a)return wac_b(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(wac_rd(a).startsWith("https://"))return!0;wac_b(5849625,202,10,"StorageUrl has invalid scheme.");return!1}
wac_F6a.prototype={zu:null,SDa:null,Xq:null,cBc:function(a,b){wac_b(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{Trigger:a});3===this.Xq._state?(b&&b.QG(this.Xq,!0),wac_b(5849619,202,50,"GetMoreInfo already populated. {0}",{Trigger:a})):wac_B6a(this,a,!1);return this.Xq}};
function wac_H6a(a,b){return function(c){wac_dQ(a.zu.ma(),"GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",c.Aa,"Failure");a.Xq.pI(2);a.Xq.t6a=!1;a.Xq.Fva=!1;wac_u6a(a,a.Xq);wac_I6a(a.SDa,wac_J6a(a,b))}}
function wac_K6a(a){return function(b){var c=!1,d=!1,e=!1,f=null;if(wac_q(wac_.pa,"GetMoreInfoDataFromResponseBody"))if(b.Aa.Be){var g,h;(h=wac_dP(Object,b.Aa.Be,g={val:f}),f=g.val,h)?f?(e=!0,a.Xq.Wba=f.StorageServiceDisplayName,a.Xq.BI=wac_G6a(f.PersonalFileStorageUrl)?f.PersonalFileStorageUrl:""):wac_b(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):wac_b(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else wac_b(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");e||((f=b.Aa.ti)?(a.Xq.Wba=(f.StorageServiceDisplayName||"").toString(),c=(f.PersonalFileStorageUrl||"").toString(),a.Xq.BI=wac_G6a(c)?c:"",c=""===c&&""!==a.Xq.Wba):(wac_b(5849622,202,50,"Null response headers received."),d=!0));e=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",a.SDa.$ka,d,c,e);wac_dQ(a.zu.ma(),
"GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.Aa,e);b=c;a.Xq.pI(3);a.Xq.t6a=b;a.Xq.Fva=d;wac_u6a(a,a.Xq)}}
function wac_B6a(a,b,c){wac_eQ(a.SDa,!c);1===a.Xq._state?wac_b(5849620,202,50,"Not starting new request, because one is already in progress {0}",{Trigger:b,RetryIndex:a.SDa.$ka}):(wac_b(5849621,202,50,"Making GetMoreInfo request {0}",{Trigger:b,RetryIndex:a.SDa.$ka}),a.Xq.pI(1),c=String.format("{0}GetMoreInfoHandler.ashx?{1}",a.zu.ma().jO(),wac_.eo),wac_bj(a.zu.ma().$g.ma(),c,1,null,null,["PersonalFileStorageUrl","StorageServiceDisplayName"],4,wac_K6a(a),wac_H6a(a,b),null,null,null,null,!1,null,null))}
function wac_J6a(a,b){return function(){wac_B6a(a,b,!0)}}function wac_L6a(){}wac_L6a.prototype={PersonalFileStorageUrl:null,StorageServiceDisplayName:null};function wac_M6a(a,b,c,d,e){this.Zcd=Function.createDelegate(this,this.BJd);this.Pc=a;this.xVb=b;this.BW=c;this.c1b=d;this.Ra=new wac_Re;e&&(a=new wac_D(4,2,this.K6d,this.Zcd,108,null,!1),this.Pc.ma().Hb(a));this.BXb=this.xVb()}function wac_bQ(){return wac_N6a||(wac_N6a=wac_O6a())}
function wac_O6a(){return new wac_M6a(new (wac_f.$$(wac_dd))(function(){return wac_p()}),function(){return wac_yia.getTime()},function(){return(new Date).getTime()},new (wac_f.$$(Number))(function(){return wac_ofa}),!0)}
wac_M6a.prototype={K6d:6E4,BXb:0,Pc:null,xVb:null,BW:null,c1b:null,Ra:null,WIb:"inactive",Q8a:"active",yWb:!0,BJd:function(){var a=this.xVb(),b=this.BW()-a;b>this.c1b.ma()&&this.yWb&&(wac_b(5849626,202,50,"User went inactive {0}",{TimeSinceLastActive:b}),this.yWb=!1,this.Ra.wa(this.WIb,null,null));a-this.BXb>this.c1b.ma()&&(this.yWb=!0,this.Ra.wa(this.Q8a,null,null));this.BXb=a}};function wac_P6a(){wac_P6a.initializeBase(this);this.pI(0);this.Fva=!1}wac_P6a.prototype={kBb:null,Dtc:0,Fva:!1,Fxc:function(){return"MruActor Result"}};
function wac_fQ(a,b,c,d,e){this.t$c=Function.createDelegate(this,this.MEd);this.s$c=Function.createDelegate(this,this.LEd);this.u$c=Function.createDelegate(this,this.NEd);this.otd=Function.createDelegate(this,this.D5d);this.gpd=Function.createDelegate(this,this.f_d);this.v$c=Function.createDelegate(this,this.OEd);this.led=Function.createDelegate(this,this.WLd);this.med=Function.createDelegate(this,this.XLd);this.jed=Function.createDelegate(this,this.ULd);wac_fQ.initializeBase(this);this.zu=a;this.cYb=
b;this.QXa=new wac_cQ(c,this.Ov().Pc.ma(),"Read");this.eob=new wac_cQ(d,this.Ov().Pc.ma(),"Write");this.W1b=e;this.$P={};this.OR=new wac_P6a}function wac_aQ(){return wac_Q6a||(wac_Q6a=wac_R6a())}
function wac_R6a(){return new wac_fQ(new (wac_f.$$(wac_wc))(function(){return wac_w6a()}),new (wac_f.$$(String))(function(){return wac_nm(wac_.vh)._name}),new (wac_f.$$(String))(function(){return wac_.pa.Qb.MruServerReadRetryIntervalsInMs}),new (wac_f.$$(String))(function(){return wac_.pa.Qb.MruServerWriteRetryIntervalsInMs}),wac_q(wac_.pa,"MruWriteFileIdInHeader"))}
wac_fQ.prototype={zu:null,cYb:null,W1b:!1,OR:null,QXa:null,eob:null,$P:null,yCc:"RenameMruEntry",rFc:"UpdateMruEntry",f_d:function(a,b,c,d,e){if(!e)return 32;if(!e.QKb)return wac_b(5849666,202,15,"Failure to rename MRU entry {0}",{Error:"Null NewDocumentDAVUrl"}),8;if(!e.RKb)return wac_b(5849667,202,15,"Failure to rename MRU entry {0}",{Error:"Null NewFileName"}),8;if(!e.RFb)return wac_b(5849668,202,15,"Failure to rename MRU entry {0}",{Error:"Null CurrentDocumentDAVUrl"}),8;this.$P[wac_fQ.k$a]=this.$P[wac_fQ.k$a]||
wac_Cf(e.RFb);this.$P[wac_fQ.$Pa]=wac_Cf(e.QKb);this.$P[wac_fQ.JMd]=wac_Cf(e.RKb);wac_b(5849669,202,50,"Starting rename of MRU entry {0}",{Trigger:"Rename"});return wac_S6a(this,"Rename",this.yCc,!1)},XLd:function(){wac_C6a(this,"Inactivity")},WLd:function(){wac_C6a(this,"Back from Inactivity")},D5d:function(a){wac_dQ(this.Ov(),"MruActor.WriteMruEntryOnServerSuccessCallback",a.Aa,"Success");wac_eQ(this.eob,!0);a=(a.Aa.Request.get_headers()[wac_fQ.$Pa]||"").toString();""!==a&&(this.$P[wac_fQ.k$a]=
a)},OEd:function(){wac_A6a(this,"Polling",!1)},MEd:function(){wac_A6a(this,"Retry",!0)},ULd:function(){wac_A6a(this,"Activity",!1)},NEd:function(a){var b=a.Aa.Be;wac_r()&&wac_r().Hd().X2e()&&wac_7k()&&window.appChrome.api.dispatch(window.appChrome.actions.setFileMenuMRUJson(b));wac_eQ(this.QXa,!0);var c=null;if(b){var d;try{d=wac_Hd(b)}catch(e){d=null,wac_b(5849675,202,10,"MruActor.TryDeserializeJson: Exception thrown from JsonSerializer.SecureDeserialize Exception: {0}",e)}c=d}c?(wac_T6a(this,3,
c,!1),wac_dQ(this.Ov(),"MruActor.GetMruFromServerSuccessCallback",a.Aa,"Success")):(wac_dQ(this.Ov(),"MruActor.GetMruFromServerSuccessCallback",a.Aa,"Failure: Invalid JSON"),wac_T6a(this,3,null,!0));wac_u6a(this,this.OR)},LEd:function(a){wac_dQ(this.Ov(),"MruActor.GetMruFromServerFailureCallback",a.Aa,"Failure");wac_T6a(this,2,null,!1);wac_I6a(this.QXa,this.t$c)||wac_eQ(this.QXa,!0);wac_u6a(this,this.OR)},cBc:function(a,b){wac_b(6029918,202,50,"MRU result requested {0}",{Trigger:a,ResultState:this.OR._state});
b&&3===this.OR._state&&b.QG(this.OR,!0);return this.OR},Ov:function(){return this.zu.ma()}};function wac_T6a(a,b,c,d){if(3!==a.OR._state||3===b)a.OR.kBb=c,a.OR.pI(b),a.OR.Fva=d,a.OR.Dtc=(0,a.Ov().BW)()}
function wac_A6a(a,b,c){wac_b(5849674,202,50,"Making GetMru request {0}",{Trigger:b});wac_eQ(a.QXa,!c);b=a.u$c;c=a.s$c;wac_T6a(a,1,null,!1);var d=String.format(a.Ov().jO()+"MruServiceHandler.ashx?action={0}&app={1}&lc={2}","getmru",wac_gQ(a.Ov()),a.cYb.ma()),e=null;a.W1b?(e={},e["X-FileId"]=wac_.eo):d+=String.format("&{0}",wac_.eo);a.Ov().$g.ma().lk(d,1,null,e,!0,4,b,c,null,null,!1,null,null,null,null,!1,null,!1)}function wac_U6a(a,b){return function(){wac_S6a(a,"Retry",b,!0)}}
function wac_V6a(a,b){return function(c){wac_dQ(a.Ov(),"MruActor.WriteMruEntryOnServerFailureCallback",c.Aa,"Failure");403!==c.Aa.ho&&wac_I6a(a.eob,wac_U6a(a,b))}}
function wac_S6a(a,b,c,d){if(4===wac_gQ(a.Ov())&&!wac_Bg)return 2;var e;a.$P[wac_fQ.$Pa]&&a.$P[wac_fQ.k$a]!==a.$P[wac_fQ.$Pa]?e=a.yCc:(e=a.rFc,delete a.$P[wac_fQ.$Pa]);wac_b(5849673,202,50,"Writing to MRU {0}",{Trigger:b,IntendedActionType:c,ActualActionType:e});wac_eQ(a.eob,!d);b=String.format(a.Ov().jO()+"MruServiceHandler.ashx?action={0}&app={1}&lc={2}",e,wac_gQ(a.Ov()),a.cYb.ma());a.W1b?a.$P["X-FileId"]=wac_.eo:b+=String.format("&{0}",wac_.eo);return a.Ov().$g.ma().lk(b,2,null,a.$P,!0,4,a.otd,
wac_V6a(a,c),null,null,!1,null,null,"4",null,!1,null,!1)}function wac_C6a(a,b){wac_b(5849670,202,50,"Starting update of MRU entry {0}",{Trigger:b});wac_S6a(a,b,a.rFc,!1)}function wac_cQ(a,b,c){this.cRc=a;this.Pc=b;this.FUb=c}wac_cQ.prototype={Pd:null,cRc:null,Pmb:null,FUb:"",Pc:null,$ka:0};
function wac_W6a(a){if(!a.Pmb){var b=(a.cRc.ma()||"0").split(",");a.Pmb=[];for(var c=0;c<b.length;c++){var d=window.parseInt(b[c]);window.isNaN(d)?wac_b(5849677,202,15,"Retry interval list contains non-number element {0}",{Action:a.FUb,Entry:b[c]}):Array.add(a.Pmb,d)}}return a.Pmb}
function wac_I6a(a,b){var c;c=a.$ka>=wac_W6a(a).length?-1:wac_W6a(a)[a.$ka];var d=0<=c;d?(a.$ka++,wac_eQ(a,!1),a.Pd=new wac_D(4,1,c,b,107,null,!1),a.Pc.Hb(a.Pd)):(wac_eQ(a,!0),wac_b(5849676,202,50,"Retries exhausted {0}",{Action:a.FUb}));return d}function wac_eQ(a,b){a.Pd&&(a.Pc.Rg(a.Pd),a.Pd=null);b&&(a.$ka=0)}
function wac_X6a(a,b,c,d,e,f,g,h){this.R8c=Function.createDelegate(this,this.pCd);this.Wld=Function.createDelegate(this,this.YVd);this.Ia=a;this.$g=b;this.jn=c;this.iR=d;this.Pc=e;this.BW=f;this.AKc=g;this.qra=h}function wac_w6a(){return wac_Y6a||(wac_Y6a=wac_Z6a())}
function wac_Z6a(){return new wac_X6a(new (wac_f.$$(wac_Oc))(function(){return wac_z()}),new (wac_f.$$(wac_Wc))(function(){return wac_.Af}),new (wac_f.$$(wac_gc))(function(){return wac_r()}),new (wac_f.$$(wac_d.Xya))(function(){return wac_r().Hd().Nv()}),new (wac_f.$$(wac_dd))(function(){return wac_p()}),function(){return(new Date).getTime()},new (wac_f.$$(String))(function(){return wac_r().Hd().jO()}),new (wac_f.$$(Boolean))(function(){return wac_2fa}))}
wac_X6a.prototype={Ia:null,$g:null,jn:null,iR:null,Pc:null,BW:null,AKc:null,qra:null,YVd:function(a,b,c,d,e){e&&e.MenuItemId&&(wac_b(5849678,202,50,"Opening new tab {0}",{Id:e.SourceControlId,AppType:wac_d.Xya.toString(wac_gQ(this))}),a=e.MenuItemId.toString(),window.open(a,"_blank"));return 32},pCd:function(){wac_z6a();return 32},jO:function(){return this.AKc.ma()}};function wac_gQ(a){return a.iR.ma()}
function wac_z6a(){var a=wac_q(wac_.pa,"QPGVCI"),b=wac__i(document.URL,"wdNewAndOpenCt",a);if(b){var b=window.parseInt(b),c=wac__i(document.URL,"wdPreviousSession",a),a=wac__i(document.URL,"wdPreviousCorrelation",a),d=wac_q(wac_.pa,"NAOPLP");if(wac_Kd){var e=wac_Kd.getTime();!b||b>e?wac_b(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{ClickTimestamp:b,DocumentLoadedTime:e,SessionId:c,Correlation:a}):wac_b(5849683,202,d?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",
{ClickToLoadTime:e-b,ClickTimestamp:b,SessionId:c,Correlation:a})}else wac_b(5849681,202,d?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{ClickTimestamp:b,SessionId:c,Correlation:a})}}
function wac_dQ(a,b,c,d){if(c&&c.hu){var e=wac_d.l0.toString(c.Sd);c=c.hu.getTime();a=a.BW()-c;wac_b(5849679,202,50,"Making request to the WAC server {0}",{Caller:b,RequestStatus:e,ElapsedMs:a,StartTime:c,Notes:d})}else wac_b(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{Caller:b})}wac_t6a.registerClass("Common.App.NewAndOpen.Core.AEventResult",null,wac_mc);wac_v6a.registerClass("Common.App.NewAndOpen.Core.CorePackageManager",null,wac_I,wac_i,Sys.IDisposable);
wac_E6a.registerClass("Common.App.NewAndOpen.Core.GetMoreInfoResult",wac_t6a,wac_sc,wac_mc);wac_F6a.registerClass("Common.App.NewAndOpen.Core.GetMoreInfoActor",wac_$P.$$(wac_sc));wac_L6a.registerClass("Common.App.NewAndOpen.Core.GetMoreInfoResponseData");wac_M6a.registerClass("Common.App.NewAndOpen.Core.InactivityManager");wac_P6a.registerClass("Common.App.NewAndOpen.Core.MruResult",wac_t6a,wac_vc,wac_mc);wac_fQ.registerClass("Common.App.NewAndOpen.Core.MruActor",wac_$P.$$(wac_vc));wac_cQ.registerClass("Common.App.NewAndOpen.Core.RetryHelper");
wac_X6a.registerClass("Common.App.NewAndOpen.Core.NewAndOpenCommonHelpers",null,wac_wc);(function(){}).registerClass("Common.App.NewAndOpen.Core.Program");var wac_x6a=null,wac_N6a=null;wac_fQ.k$a="CurrentDocumentDAVUrl";wac_fQ.$Pa="NewDocumentDAVUrl";wac_fQ.JMd="NewFileName";var wac_Q6a=null,wac_Y6a=null;wac_J(wac_C(),new wac_v6a,0,!1);Type.registerNamespace("Common.App.NewAndOpen.UX");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.PG=wac_d.Qa.PG||{};wac_d.Qa.PG.BSa=wac_d.Qa.PG.BSa||{};
wac_d.Qa.PG.BSa.LKb=function(){};wac_d.Qa.PG.BSa.LKb.prototype={};wac_d.Qa.PG.BSa.LKb.registerEnum("Common.App.NewAndOpen.UX.MruActorString",!1);function wac__6a(){}wac__6a.registerInterface("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");
function wac_06a(a,b,c,d,e,f){this.Jmd=Function.createDelegate(this,this.bXd);this.yed=Function.createDelegate(this,this.GMd);this.Sja=Function.createDelegate(this,this.xma);this.zu=a;this.yW=b;var g=this;this.WJ=new (wac_f.$$(wac_nc.$$(wac_sc)))(function(){return new (wac_9P.$$(wac_sc))(c.ma(),g.Sja)});this.QNc=d;this.$fa=e;this.xYa=f;this.eEa=this.xYa.ma();2===wac_gQ(wac_hQ(this))&&(this.p0b=!0)}
wac_06a.prototype={zu:null,yW:null,WJ:null,QNc:null,$fa:null,xYa:null,eEa:!1,Bhb:null,yl:null,pSc:null,u0b:!1,Ymb:!1,GNc:0,VWb:!1,p0b:!1,vX:function(){switch(wac_gQ(wac_hQ(this))){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null},Tb:function(){var a=wac_hQ(this).Ia.ma();a.ja(1056925771,2147483648,this.yed);a.Mp(2074131365,2147483648,this.Jmd,96)},GMd:function(a,b,c,d,e){return 1===c?32:2===c&&e&&e.MenuItemId&&e.SourceControlId?this.mNa(e.MenuItemId,
e.SourceControlId):8},mNa:function(a,b){var c=this.yW.ma().KFb;if(null===c)return 8;var d=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",c,wac_Cf(this.Rob()),wac_Cf(a),wac_Cf(this.vX()),wac_Cf(wac_.vh.toString()),wac_Cf(d.toString()),wac_Cf(b),wac_Cf(wac_.VD),wac_.eo);b+="&"+wac_Ug();wac_.Tma&&(b+="&"+wac_Vg());(c=this.yl?this.yl.BI:null)&&(b+="&DestinationUrl="+wac_Cf(c));window.open(b,"_blank");
2===wac_gQ(wac_hQ(this))&&wac_b(24700384,202,50,"CreateNewDocument from New Menu {0}",{AppType:wac_d.Xya.toString(wac_gQ(wac_hQ(this))),Template:a});return 32},bXd:function(a,b,c,d,e){if(1===c)return this.p0b&&(wac_Tg("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.p0b=!1),32;2!==c||this.VWb||(this.GNc=(new Date).getTime(),wac_b(5849602,202,50,"File New menu flyout opened by user {0}",{ShouldShowTemplates:this.xYa.ma(),CachedNewMenuXmlExists:!!this.Bhb,ShouldCallGetMoreInfo:wac_hQ(this).qra.ma()}));
if(e)if(this.Bhb)e.PopulationXML=this.Bhb;else{wac_hQ(this).qra.ma()&&!this.yl&&this.WJ.ma().XU("Opened New menu",!0);a=wac_16a(this);var f;b=this.yW.ma().FMa||"1056925771";var g,h=this.yW.ma();c=f={val:f};c.val=!1;d=wac_26a(this);var k="";wac_hQ(this).qra.ma()&&(this.u0b?(k=wac_iQ(CommonUIStrings.l_NewGenericErrorMessage,h.fV,null,null),this.u0b=!1,wac_b(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.yl?d?(k=this.yl,k=wac_iQ(CommonUIStrings.l_NewCreationLocationMessage,
h.fV,k.BI,k.Wba)):this.yl.t6a?(c.val=!0,this.eEa=!1,k=wac_iQ(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,this.yl.Wba,"\n\n"),h.fV,null,null),wac_b(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(c.val=!0,k=wac_iQ(CommonUIStrings.l_NewGenericErrorMessage,h.fV,null,null),wac_b(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response",{PersonalFileStorageUrlIsSet:!!this.yl.BI,StorageServiceDisplayNameIsSet:!!this.yl.Wba})):
(k=wac_36a(h.fV,CommonUIStrings.l_VoicedLoadingText),wac_b(5849606,202,50,"Rendering File>New with loading spinner")));if(d){d=k;var h=wac_jQ("menuNewBlank",wac_kQ.cJd,k?null:h.fV,wac_lQ(h.kyc,h.lyc,h.myc,null,h.$Oa,h.ZOa,b,"blank")),l;c.val=!1;if(this.xYa.ma()){var m=k="",n="MenuTemplate";if(this.Ymb)k=wac_46a(),this.Ymb=!1,wac_b(5849610,202,10,"Rendering File>New with template error message");else if(a){try{l=Sys.Serialization.JavaScriptSerializer.deserialize(a,!0),k=wac_56a(this,l,b),wac_b(5849612,
202,50,"Rendering File>New with template buttons"),wac_mfa&&"OneDrive"===this.Rob()&&(m=wac_jQ("menuNewMoreTemplates",wac_kQ.Pwc,null,wac_lQ("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,this.QNc.ma(),wac_mfa)))}catch(p){wac_b(5849613,202,10,"Failed to parse JSON response from template service {0}",{JsonToConvert:a}),k=wac_46a()}c.val=!0}else n="MenuLoading",k=wac_mQ("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText,null,
null),wac_b(5849611,202,50,"Rendering File>New with template loading spinner");l=wac_jQ("menuNewTemplates",n,null,k)+m}else c.val=!0,wac_b(5849609,202,50,"Rendering File>New without template buttons due to BRS"),l="";k=d+(h+l)}l=(g=wac_66a("New",k),f=f.val,g);f&&(this.Bhb=l,g=(new Date).getTime()-this.GNc,wac_b(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{ElapsedMsSinceMenuOpened:g}));e.PopulationXML=l}return 32},xma:function(a,b){this.yl||3!==a.kg()?2===a.kg()&&(this.u0b=
!0,wac_nQ(this)):(this.yl=a,b||wac_nQ(this))},Rob:function(){return this.$fa.ma()}};function wac_hQ(a){return a.zu.ma()}function wac_nQ(a){a.VWb=!0;wac_hQ(a).jn.ma().JE(a.yW.ma().iOa);a.VWb=!1}
function wac_56a(a,b,c){for(var d="",e=[],f=0;f<b.length;f++){var g=b[f],h="";if(g){var k=g.Title,l=g.AssetId,g=g.Thumbnails;if(l&&k&&g)var m,n,p,h=(p=wac_76a(a,g,n={val:m}),m=n.val,p),d=d+wac_lQ("jbtnNewTemplate"+f,k,null,m,null,h,c,l)}e[f]=h}b=new wac_D(4,1,5E3,function(){var a=Number.MAX_VALUE,b=Number.MIN_VALUE,c=window.performance;if(c&&"undefined"!==typeof c.getEntriesByName){for(var d=0;d<e.length;d++){var f=c.getEntriesByName(e[d]);f&&0<f.length&&(f=f[0],a=Math.min(window.parseInt(f.fetchStart),
a),b=Math.max(window.parseInt(f.responseEnd),b))}b>a&&wac_b(5849601,202,50,"Total time to download template thumbnails {0}",{TotalElapsedMs:b-a,MinFetchStart:a,MaxResponseEnd:b})}},106,null,!1);wac_hQ(a).Pc.ma().Hb(b);return d}
function wac_76a(a,b,c){var d=0;c.val="";for(var e=0;e<b.length;e++)if("ST"===b[e].ImageType){d=e;break}var f=b.length?b[d]:null;b=f?f.Url||"":"";var g,h=e=d=!1;if(f&&(g=f.AspectRatio))a=window.parseFloat(g),1>a?d=!0:1.5<a?e=!0:1===a&&(h=!0);else switch(wac_b(5849603,202,10,"Thumbnail aspect ratio missing {0}",{Url:b}),wac_gQ(wac_hQ(a))){case 3:d=!0;break;case 2:e=!0;break;case 5:h=!0}c.val=d?"95by123":e?"123by69":h?"100by100":"123by95";return b}
function wac_16a(a){if(!a.xYa.ma()||!wac_26a(a))return null;if(a.eEa&&!a.Ymb){var b="9",c=wac_.pa.Qb;"NumberOfTemplatesInBackstage"in c&&(b=c.NumberOfTemplatesInBackstage);b=String.format(wac_hQ(a).jO()+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",wac_Cf(wac_.vh.toString()),wac_Cf(a.vX()),b);Boolean.parse(c.AppendOriginQueryParam||"false")&&(b+="&org=backstage");b+="&"+wac_Ug();wac_.Tma&&(b+="&"+wac_Vg());wac_hQ(a).$g.ma().lk(b,1,null,null,!1,2,function(b){wac_dQ(wac_hQ(a),"CreateNewActor.GetTemplateListJson",
b.Aa,"");a.pSc=b.Aa.Be;a.eEa=!1;wac_nQ(a);wac_r()&&wac_r().Hd().X2e()&&window.appChrome.api.dispatch(window.appChrome.actions.setFileMenuTemplateJson(a.pSc))},function(b){wac_dQ(wac_hQ(a),"CreateNewActor.GetTemplateListJson",b.Aa,"");a.eEa=!0;a.Ymb=!0;wac_nQ(a)},null,null,!1,null,null,"5",null,!1,null,!1);a.eEa=!1}return a.pSc}function wac_26a(a){return!wac_hQ(a).qra.ma()||!!a.yl&&3===a.yl.kg()&&!!a.yl.Wba&&!!a.yl.BI}function wac_oQ(){wac_oQ.initializeBase(this)}
function wac_k_c(a){return(wac_g7a||(wac_g7a=new wac_oQ)).Tr(a)}wac_oQ.prototype={Lwd:function(){wac_LO(this,0,CommonUIStrings.l_OpenMenuEmptyMruMessage);wac_LO(this,1,CommonUIStrings.l_OpenMenuServerErrorMessage);wac_LO(this,2,CommonUIStrings.l_Open);wac_LO(this,3,CommonUIStrings.l_OpenMenuRecentDocuments);wac_LO(this,4,CommonUIStrings.l_OpenMenuMoreOnHost);wac_LO(this,5,CommonUIStrings.l_VoicedLoadingText)}};
function wac_86a(a,b,c,d,e,f,g){this.Imd=Function.createDelegate(this,this.aXd);this.ued=Function.createDelegate(this,this.uMd);this.zu=a;this.vs=b;this.dCa=c;this.NGc=d;this.MGc=e;this.WJ=new (wac_f.$$(wac_nc.$$(wac_sc)))(function(){return new (wac_9P.$$(wac_sc))(f.ma(),null)});var h=this;this.kKc=new (wac_f.$$(wac_nc.$$(wac_vc)))(function(){return new (wac_9P.$$(wac_vc))(g.ma(),h.ued)})}
wac_86a.prototype={zu:null,tTb:null,aob:!0,Ahb:"",Z7d:0,oWa:null,NGc:null,MGc:null,vs:null,dCa:null,DXb:3,kKc:null,WJ:null,uMd:function(a,b){this.oWa=a;b||wac_96a(this)},aXd:function(a,b,c,d,e){if(1!==c&&e){c=3;a=!1;if(this.Ahb&&this.Z7d===this.oWa.Dtc)wac_b(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{CacheRefresh:"Not Dirty"}),c=this.DXb;else{wac_b(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{CacheRefresh:"Starting"});b=(0,this.Ov().BW)();this.oWa=
this.kKc.ma().XU("File Open opened",!0);if(this.Ahb&&2!==this.DXb&&3!==this.oWa.kg())a=!0;else{var f,g=this.oWa;d=c={val:c};if(1!==g.kg()&&g.kg())if(3===g.kg()&&g.kBb){var g=g.kBb,h,k=this.dCa.ma().FMa||"1959943459";if(g.length){h=wac_mQ("lblRecentDocuments",wac_pQ(this)(3),null,null);for(var l=0,m=0;m<g.length;m++){var n=g[m];"FileName"in n&&"DocumentUrl"in n&&"Path"in n&&(h+=wac_lQ("MruButton"+m,n.FileName.toString(),n.Path.toString(),null,this.dCa.ma().$Oa,this.dCa.ma().ZOa,k,n.DocumentUrl.toString()),
n.IsPinned&&l++)}h=wac_jQ("RecentDocumentsMenuSection",wac_kQ.lAc,wac_pQ(this)(2),h);wac_b(5849665,202,50,"Open menu XML built {0}",{Display:"MRU List",TotalDocuments:g.length,NumPinnedDocuments:l})}else h=wac_iQ(wac_pQ(this)(0),wac_pQ(this)(2),null,null),wac_b(5849664,202,50,"Open menu XML built {0}",{Display:"Empty MRU"});g=h;d.val=0}else wac_b(5849634,202,50,"Open menu XML built {0}",{Display:"Server Error"}),g=wac_iQ(wac_pQ(this)(1),wac_pQ(this)(2),null,null),d.val=1;else wac_b(5849635,202,50,
"Open menu XML built {0}",{Display:"Spinner"}),d.val=2,g=wac_36a(wac_pQ(this)(2),wac_pQ(this)(5));this.Ahb=(f=g,c=c.val,f)}f=(0,this.Ov().BW)()-b;wac_b(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{CacheRefresh:"Complete",ElapsedMs:f})}2!==c&&(f={DisplayState:wac_$6a.toString(c)},1!==c&&(f.IsStale=a),wac_b(5849630,202,50,"MRU section display state {0}",f));this.DXb=c;if(this.aob){wac_b(5849632,202,50,"Open menu Browse More Link creation necessary.");var p;b=f={val:this.aob};
b.val=!0;a=this.NGc.ma();c=this.MGc.ma();a&&c||!this.Ov().qra.ma()?b.val=!1:(d=this.yob().XU("File Open",!1),3===d.kg()&&(a=d.BI,c=d.Wba,b.val=!1));b=c?String.format(wac_pQ(this)(4),c):null;c=this.dCa.ma().FMa;d="";a&&b&&(d=wac_jQ("BrowseMoreMenuSection",wac_kQ.Pwc,null,wac_lQ("btnBrowseMore",b,b,null,null,null,c||"1959943459",a)));this.tTb=(p=d,this.aob=f.val,p)}else wac_b(5849631,202,50,"Open menu Browse More Link creation not required.");wac_b(5849633,202,50,"Browse More link display state {0}",
{WaitingOnLinkInfo:this.aob,NotDisplayingLink:!this.tTb});e.PopulationXML=wac_66a("Open",this.Ahb+this.tTb)}return 32},Ov:function(){return this.zu.ma()},yob:function(){return this.WJ.ma()}};function wac_pQ(a){return a.vs.ma()}function wac_96a(a){a.Ov().jn.ma().JE(a.dCa.ma().iOa)}function wac_a7a(a){a.Ov().Ia.ma().Mp(2799130311,2147483648,a.Imd,96)}function wac_$6a(){}wac_$6a.prototype={success:0,failure:1,spinner:2,none:3};
wac_$6a.registerEnum("Common.App.NewAndOpen.UX.MruRenderer.DisplayState",!1);function wac_kQ(){}function wac_36a(a,b){return wac_jQ("LoadingMenuSection",wac_kQ.NLd,a,wac_mQ("lblLoading",b,null,null))}function wac_iQ(a,b,c,d){return wac_jQ("MessageMenuSection",wac_kQ.lAc,b,wac_mQ("lblMessage",a,c,d))}function wac_46a(){return wac_mQ("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage,null,null)}
function wac_mQ(a,b,c,d){var e=d;b&&0<b.length&&(e=wac_Ve(wac_b7a,b).trimEnd(),e=0<=e.indexOf("{0}")?String.format(e,d):String.format("{0} {1}",e,d));c=c&&d?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',wac_kf(c),wac_kf(d),wac_kf(e)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',wac_kf(a||""),wac_Ve(wac_b7a,wac_kf(b||"")),c)}
function wac_lQ(a,b,c,d,e,f,g,h){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',wac_kf(a||""),wac_kf(b||""),wac_kf(c||""),d||"32by32",wac_kf(e||""),wac_kf(f||""),g,wac_kf(h||""))}function wac_66a(a,b){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',a,b)}
function wac_jQ(a,b,c,d){c=c?String.format('Title="{0}"',wac_kf(c)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',wac_kf(a||""),wac_kf(b||""),c,d)}function wac_qQ(a,b,c,d){this.yW=a;this.$fa=b;this.zu=c;this.jKc=d}
wac_qQ.prototype={yW:null,$fa:null,zu:null,jKc:null,Db:function(a,b,c){return new wac_c7a(a,b,c,this.yW,this.$fa,this.zu,this.jKc)}};function wac_d7a(a,b,c,d){this.Rya=a;this.zJ=b;this.zEc=c;this.Fwc=d}wac_d7a.prototype={Rya:null,zJ:null,zEc:null,Fwc:null};
function wac_c7a(a,b,c,d,e,f,g){this.zed=Function.createDelegate(this,this.HMd);this.Aed=Function.createDelegate(this,this.IMd);this.Sja=Function.createDelegate(this,this.xma);this.ZNc=a;this.Eqa=b;this.VWa=c;this.yW=d;this.$fa=e;this.zu=f;var h=this;this.WJ=new (wac_f.$$(wac_nc.$$(wac_sc)))(function(){return new (wac_9P.$$(wac_sc))(g.ma(),h.Sja)})}
wac_c7a.prototype={yl:null,SQc:!1,fHc:0,pfa:0,VWa:null,ZNc:null,Eqa:null,yW:null,$fa:null,zu:null,WJ:null,mNa:function(){!this.yl&&this.zu.ma().qra.ma()?this.yob().XU("NewDocumentFromStream",!0):wac_e7a(this)},xma:function(a){if(!this.yl&&3===a.kg())this.yl=a;else if(2===a.kg()){this.SQc?wac_b(24904471,202,10,"After second try GetMoreResult still fail."):(this.yob().XU("NewDocumentFromStream",!0),this.SQc=!0);return}wac_e7a(this)},IMd:function(a){if(a&&a.Aa&&a.Aa.Be){var b,c,d;(d=wac_dP(Object,a.Aa.Be,
c={val:b}),b=c.val,d)?(a=b,200!==a.StatusCode&&201!==a.StatusCode?(wac_b(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.vX(),this.pfa,a.StatusCode),this.Eqa(null)):a.NewDocumentUrl&&""!==a.NewDocumentUrl?(b=(new Date).getTime()-this.fHc,wac_b(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.vX(),this.pfa,b),this.ZNc(a.NewDocumentUrl)):(wac_b(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",
this.vX(),this.pfa),this.Eqa(null))):(wac_b(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.vX(),this.pfa,{ResponseData:wac_qP(a.Aa.Be)}),this.Eqa(null))}else wac_b(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.vX(),this.pfa),this.Eqa(null)},HMd:function(a){a&&a.Aa&&wac_b(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",
this.vX(),this.pfa,a.Aa.Sd);this.Eqa(null)},vX:function(){switch(wac_gQ(this.zu.ma())){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null},Rob:function(){return this.$fa.ma()},yob:function(){return this.WJ.ma()}};
function wac_e7a(a){a.fHc=(new Date).getTime();var b=a.yW.ma().KFb;if(null===b)a.Eqa(null);else{var c=a.VWa.Rya,d=a.VWa.zJ,e=a.VWa.zEc,f=a.VWa.Fwc;a.pfa="streamBase64"===e?f.length/1024:0;wac_b(35156358,202,50,"FileType:{0}, FileSize:{1}",a.vX(),a.pfa);var g=(new Date).getTime(),b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",b,wac_Cf(a.Rob()),wac_Cf(c),wac_Cf(a.vX()),wac_Cf(wac_.vh.toString()),wac_Cf(g.toString()),wac_Cf(d),
wac_Cf(wac_.VD),wac_.eo,wac_Cf(e)),b=b+("&"+wac_Ug());wac_.Tma&&(b+="&"+wac_Vg());(c=a.yl?a.yl.BI:null)&&(b+="&DestinationUrl="+wac_Cf(c));a.zu.ma().$g.ma().lk(b,2,f,{"Content-Type":"application/json; charset=utf-8"},!0,2,a.Aed,a.zed,null,null,!1,null,null,"31",null,!1,null,!1)}}function wac_f7a(){this.dispose=this.O}
wac_f7a.prototype={Ub:function(){return"Common.App.NewAndOpen.UX"},gc:function(a){wac_m(wac_n(wac_o(a.fa(wac_qQ),wac__6a)),function(){return new wac_qQ(new (wac_f.$$(wac_Rh))(function(){return wac_r().Hd().yOa()}),new (wac_f.$$(String))(function(){return wac_0g}),new (wac_f.$$(wac_wc))(function(){return wac_k(a,wac_wc)}),new (wac_f.$$(wac_oc.$$(wac_sc)))(function(){return wac_k(a,wac_oc.$$(wac_sc))}))})},tb:function(){var a=this;wac_.pa.Ok(function(){a.aPa()})},aPa:function(){var a=wac_rP(wac_wc,
wac_l(wac_j(),wac_wc)),b=wac_rP(wac_oc.$$(wac_sc),wac_l(wac_j(),wac_oc.$$(wac_sc)));wac_0g&&wac_Db.WAA.call(null,a,b).CW(function(){var c=new wac_06a(new (wac_f.$$(wac_wc))(function(){return wac_Qb(a)}),new (wac_f.$$(wac_Rh))(function(){return wac_r().Hd().yOa()}),new (wac_f.$$(wac_oc.$$(wac_sc)))(function(){return wac_Qb(b)}),new (wac_f.$$(String))(function(){return wac_r().Hd().zOa().FMa||"1959943459"}),new (wac_f.$$(String))(function(){return wac_0g}),new (wac_f.$$(Boolean))(function(){return wac_Zfa}));
c.Tb();wac_nQ(c)});if(wac_1g){var c=wac_rP(wac_oc.$$(wac_vc),wac_l(wac_j(),wac_oc.$$(wac_vc)));wac_Db.WAA.call(null,a,b,c).CW(function(){var d=new wac_86a(new (wac_f.$$(wac_wc))(function(){return wac_Qb(a)}),new (wac_f.$$(Function))(function(){return wac_k_c}),new (wac_f.$$(wac_Sh))(function(){return wac_r().Hd().zOa()}),new (wac_f.$$(String))(function(){return wac__fa}),new (wac_f.$$(String))(function(){return wac_0fa}),new (wac_f.$$(wac_oc.$$(wac_sc)))(function(){return wac_Qb(b)}),new (wac_f.$$(wac_oc.$$(wac_vc)))(function(){return wac_Qb(c)}));
wac_a7a(d);wac_96a(d)})}},O:function(){}};wac_06a.registerClass("Common.App.NewAndOpen.UX.CreateNewActor");wac_oQ.registerClass("Common.App.NewAndOpen.UX.MruActorIntlHelper",wac_Fm.$$(wac_d.Qa.PG.BSa.LKb));wac_86a.registerClass("Common.App.NewAndOpen.UX.MruRenderer");wac_kQ.registerClass("Common.App.NewAndOpen.UX.NewAndOpenXmlUtilities");wac_qQ.registerClass("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory",null,wac__6a);wac_d7a.registerClass("Common.App.NewAndOpen.UX.NewDocumentParameters");
wac_c7a.registerClass("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperation");(function(){}).registerClass("Common.App.NewAndOpen.UX.Program");wac_f7a.registerClass("Common.App.NewAndOpen.UX.UXPackageManager",null,wac_I,wac_i,Sys.IDisposable);var wac_g7a=null;wac_kQ.lAc="MenuMru";wac_kQ.NLd="MenuLoading";wac_kQ.cJd="MenuHeader";wac_kQ.Pwc="MenuFooter";var wac_b7a=wac_Ue("\n","&#10;");wac_J(wac_C(),new wac_f7a,0,!1);Type.registerNamespace("Common.App.OneDriveFilePickerApi");
wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.KVd=wac_d.Qa.KVd||{};function wac_h7a(){}wac_h7a.registerInterface("Common.App.OneDriveFilePickerApi.IErrorDialog");function wac_rQ(){}wac_rQ.registerInterface("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper");function wac_sQ(){}wac_sQ.registerInterface("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager");function wac_tQ(){wac_tQ.initializeBase(this);wac_Nh(this,0);wac_Oh(this,1,CommonUIStrings.l_DialogClose)}
wac_tQ.prototype={Xp:function(a){this.hs(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)},Jca:function(a){this.hs(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}};function wac_i7a(){}function wac_j7a(a){this.q$c=Function.createDelegate(this,this.JEd);this.r$c=Function.createDelegate(this,this.KEd);this.$g=a;this.ymb=3}
wac_j7a.prototype={uo:null,$g:null,ymb:0,JEd:function(a){if(412===a.Aa.ho&&"X-NewKey"in a.Aa.ti){wac_b(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var b={};b["X-Key"]=a.Aa.ti["X-NewKey"];wac_k7a(this,b)}else 0<this.ymb?(wac_b(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.ymb),this.ymb--,wac_k7a(this,null)):(wac_b(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),
this.uo.SX(Error.create("GetMoreInfo request failed and no more retries remain")))},KEd:function(a){"PersonalFileStorageUrl"in a.Aa.ti&&""!==a.Aa.ti.PersonalFileStorageUrl?(wac_b(24134239,352,50,"Successfully received an ODB endpoint"),this.uo.Ze(a.Aa.ti.PersonalFileStorageUrl)):(wac_b(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.uo.SX(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}};
function wac_k7a(a,b){var c=String.format("GetMoreInfoHandler.ashx?{0}",wac_.hBd);wac_bj(a.$g,c,1,null,b,["PersonalFileStorageUrl","X-NewKey"],2,a.r$c,a.q$c,null,null,null,"21",!1,null,null)}function wac_uQ(a,b,c,d,e,f){wac_uQ.initializeBase(this,[b,c,d,f]);this.Z1=a;this.GRc=e}
wac_uQ.prototype={Z1:null,GRc:null,LOc:null,lFa:function(){return this.h4.Qb.OneDriveApiUrl},Wd:function(a,b){this.LOc=a;this.Kbc(b)},bJb:function(){window.WL.init(1===this.txb||2===this.txb?{client_id:this.h4.Qb.UploadToSkyDriveClientId}:{client_id:this.h4.Qb.UploadToSkyDriveClientId,env:"INT"})},Kbc:function(a){this.b0=a;!this.uqa&&wac_pi()?(wac_b(17909025,352,50,"User is signed in. We will show file picker."),this.Kn(this.Gdc)):(wac_b(17909026,352,50,"User is not signed in. show need to sign in dialog."),
this.GRc())},Qbb:function(){try{wac_b(17909027,352,50,"Launching file dialogue"),window.WL.fileDialog(this.LOc).then(this.EJa,this.pJa)}catch(a){wac_b(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",a,a.stack),this.Im()}},Py:function(a){if(a&&a.error){if("user_canceled"===a.error.code){wac_b(17909058,352,50,"User canceled.");return}wac_b(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",a.error.code,a.error.message)}else wac_b(17909060,352,50,"File Dialog returned with no response");
this.b0&&this.b0(!1,a);this.Im()}};function wac_vQ(a,b,c,d,e){this.msd=Function.createDelegate(this,this.UEc);wac_vQ.initializeBase(this,[a,b,c,d]);this.A6d=e;this.Up={};this.Up.clientId=this.h4.Qb.OneDriveApiV7ClientId;this.Up.cancel=this.msd}
wac_vQ.prototype={A6d:null,v7d:null,ZVb:null,Up:null,lFa:function(){return this.h4.Qb.OneDriveApiV72Url},bJb:function(){var a=this;this.Up.success=function(b){var d={};d.data=b;a.xA(d)};var b=this;this.Up.error=function(a){var d={};d.error=a;b.Py(d)};this.Up.advanced={};this.Up.advanced.linkType="share";this.Up.advanced.endpointHint=this.v7d;this.Up.advanced.iframeParentDiv=this.ZVb},Qbb:function(){try{wac_b(22090007,352,50,"Launching OneDrive file picker dialog"),this.UEc(),window.OneDrive.open(this.Up)}catch(a){wac_b(22090008,
352,10,"Opening OneDrive file picker threw an exception: {0}",a.message),this.Im()}},Py:function(a){this.b0&&this.b0(!1,a);this.Im()},UEc:function(){this.ZVb.style.visibility="hidden"===this.ZVb.style.visibility?"":"hidden"}};function wac_wQ(a,b,c,d){wac_wQ.initializeBase(this,[a,b,c,d]);this.Up={};this.Up.advanced={};this.Up.action="query";this.Up.clientId=this.h4.Qb.OneDriveApiV72ClientId;this.Up.advanced.trapFocus=!0}
wac_wQ.prototype={Up:null,lFa:function(){return this.h4.Qb.OneDriveApiV72Url},Wd:function(a,b,c,d){this.Up.advanced.iframeParentDiv=c;this.Up.advanced.endpointHint=d;this.Up.cancel=b;this.Kbc(a)},Kbc:function(a){this.b0=a;this.uqa?wac_b(24391838,216,50,"In limited edit mode, will not show Picker."):(wac_b(24391837,216,50,"Not in limited edit mode, will show file picker."),this.Kn(this.Gdc))},bJb:function(){var a=this;this.Up.success=function(b){var d={};d.data=b;a.xA(d)};var b=this;this.Up.error=
function(a){var d={};d.error=a;b.Py(d)}},Qbb:function(){try{wac_b(23881879,216,50,"Launching OneDrive file picker dialog"),window.OneDrive.save(this.Up)}catch(a){wac_b(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",a.message,a.stack),this.Im()}},pMb:function(a){wac_b(25180160,216,15,"Failure during OneDrive API download: {0}",a.qo?a.qo.toString():"No error detail.");a=this.lFa();var b=wac_tl();a in b.ZDa&&delete b.ZDa[a];this.qDa=null},Im:function(){this.Ro().Jca(35)},
Py:function(a){this.b0&&this.b0(!1,a)}};function wac_xQ(a,b,c,d){this.pJa=Function.createDelegate(this,this.Py);this.EJa=Function.createDelegate(this,this.xA);this.Gdc=Function.createDelegate(this,this.ANd);this.dispose=this.O;this.h4=a;this.txb=b;this.uqa=c;this.Ro=d}
wac_xQ.prototype={Ro:null,txb:0,h4:null,b0:null,uqa:!1,Jqa:null,i0b:!1,h0b:!1,qDa:null,Kn:function(a){this.Jqa=a;if(this.i0b||this.h0b)this.i0b&&this.Jqa&&this.Jqa(!0);else if(a=wac_yQ(this)){this.h0b=!0;var b=this;wac_2gc(a).CW(function(a){b.h0b=!1;if(wac_Fb(a))b.pMb(a),b.Jqa(!1);else try{b.i0b=!0,wac_b(17909022,352,50,"Initializing OneDrive API"),b.bJb(),wac_b(17909023,352,50,"OneDrive API is initialized."),b.Jqa(!0)}catch(d){wac_b(20555412,352,10,"Failed during OneDrive API init: {0}",d.toString()),
b.Jqa(!1)}});wac_ul(a)}else wac_b(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.Jqa(!1)},pMb:function(a){wac_b(20509838,352,15,"Failure during OneDrive API download: {0}",a.qo?a.qo.toString():"No error detail.")},ANd:function(a){a?this.Qbb():this.Im()},Im:function(){this.Ro().Xp(34)},xA:function(a){wac_b(17909057,352,50,"Success Callback called. Calling callback function.");this.b0&&this.b0(!0,a)},O:function(){this.qDa&&this.qDa.O()}};
function wac_yQ(a){a.qDa||(a.qDa=a.lFa()?wac_Ll(a.lFa(),null,null,null,!1,!1,null,!0,!1):null);return a.qDa}function wac_zQ(a,b,c,d){wac_zQ.initializeBase(this,[a,b,c,d]);this.Up.advanced.filter=a.Qb.OneDriveApiV72Filter||"folder,photo";this.Up.advanced.linkType="download";this.Up.multiSelect=wac_.Buc;wac_q(a,"OneDriveApiV72CommandModeEnabled")&&(this.Up.commandMode=a.Qb.OneDriveApiV72CommandMode||"none")}
wac_zQ.prototype={lFa:function(){return this.h4.Qb.OneDriveApiV72Url},Qbb:function(){try{wac_b(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}",this.Up.advanced.filter,this.Up.commandMode),window.OneDrive.open(this.Up)}catch(a){wac_b(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",a.message,a.stack),this.Im()}}};function wac_l7a(){}
wac_l7a.prototype={sa:null,Ub:function(){return"Common.App.OneDriveFilePickerApi"},tb:function(){},O:function(){},gc:function(a){this.sa=a;wac_m(wac_n(wac_o(this.sa.fa(wac_uQ),wac_sQ)),function(){return new wac_uQ(wac_qi(),wac_.pa,wac_Kg,wac_.rC,wac_23a,function(){return new wac_tQ})});wac__g?wac_m(wac_n(this.sa.fa(wac_rQ)),function(){return new wac_i7a}):wac_m(wac_n(this.sa.fa(wac_rQ)),function(){return new wac_j7a(wac_.Af)});var b=this;wac_m(wac_n(this.sa.fa(wac_vQ)),function(){return new wac_vQ(wac_.pa,
wac_Kg,wac_.rC,function(){return new wac_tQ},b.sa.H(wac_rQ))});wac_m(wac_n(this.sa.fa(wac_wQ)),function(){return new wac_wQ(wac_.pa,wac_Kg,wac_.rC,function(){return new wac_tQ})});wac_m(wac_n(this.sa.fa(wac_zQ)),function(){return new wac_zQ(wac_.pa,wac_Kg,wac_.rC,function(){return new wac_tQ})})}};wac_tQ.registerClass("Common.App.OneDriveFilePickerApi.ErrorDialog",wac_di,wac_h7a);wac_i7a.registerClass("Common.App.OneDriveFilePickerApi.OneDriveConsumerEndpointHelper",null,wac_rQ);
wac_j7a.registerClass("Common.App.OneDriveFilePickerApi.OneDriveForBusinessEndpointHelper",null,wac_rQ);wac_xQ.registerClass("Common.App.OneDriveFilePickerApi.AOneDriveFilePickerApiManager",null,wac_sQ,Sys.IDisposable);wac_uQ.registerClass("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5",wac_xQ);wac_vQ.registerClass("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7",wac_xQ);wac_wQ.registerClass("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72",wac_xQ);
wac_zQ.registerClass("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72",wac_wQ);wac_l7a.registerClass("Common.App.OneDriveFilePickerApi.PackageManager",null,wac_I,wac_i);wac_J(wac_C(),new wac_l7a,0,!1);Type.registerNamespace("Common.App.SaveAsToHost");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.h0d=wac_d.Qa.h0d||{};function wac_HQ(){}wac_HQ.registerInterface("Common.App.SaveAsToHost.IErrorRetryDialogFactory");function wac_P7a(){}wac_P7a.registerInterface("Common.App.SaveAsToHost.IErrorRetryDialog");
function wac_Q7a(){}wac_Q7a.registerInterface("Common.App.SaveAsToHost.IFileNameDialogFactory");function wac_R7a(){}wac_R7a.registerInterface("Common.App.SaveAsToHost.IFileNameDialog");function wac_S7a(){}wac_S7a.registerInterface("Common.App.SaveAsToHost.IUploadToHostManager");function wac_T7a(){}function wac_U7a(a,b){this.Dc=a;this.Ia=b;this.nfa=wac_q(this.Dc,"SaveToHostWithExtraCharsInFileName")}wac_U7a.prototype={Ia:null,Dc:null,nfa:!1,Db:function(){return new wac_V7a(this.Ia,this.nfa)}};
function wac_V7a(a,b){this.Dwb=Function.createDelegate(this,this.yPb);wac_V7a.initializeBase(this);this.Ia=a;this.nfa=b;this.Sba=!1}
wac_V7a.prototype={Ia:null,nfa:!1,zDa:!1,iz:null,Xp:function(a,b,c){this.iz=b;this.zDa=c;wac_b(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",a,c);(a=wac_W7a(a))?(wac_Nh(this,0),wac_Oh(this,1,CommonUIStrings.l_DialogClose)):(wac_Nh(this,6),wac_Oh(this,0,CommonUIStrings.l_DialogClose));a||wac_b(8194009,216,50,"Show standard error dialog.");this.hs(26,wac_X7a(a),wac_Y7a(this,a,b),this.Dwb,!0)},yPb:function(a){1===a?(wac_b(8194010,216,50,"User click to retry button in error dialog."),
this.iz?this.Ia.os(2316717900,2,[this.iz,this.zDa],null):this.Ia.yw(2316717900,2,null)):wac_b(8194011,216,50,"User cancel the error dialog.")}};function wac_X7a(a){a=wac_W7a(a);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][a]}
function wac_Y7a(a,b,c){b=wac_W7a(b);return a.nfa?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,c),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][b]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,c),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][b]}function wac_W7a(a){return 0>a||6<a?(wac_b(8194012,216,15,"Unexpected error code {0}.",a),0):a}function wac_IQ(a,b,c,d,e,f){this.Ia=b;this.Dc=a;this.Xy=d;this.o2=f;this.Ro=e;this.Xi=c}wac_IQ.prototype={Ia:null,Xy:null,o2:null,Ro:null,Dc:null,Xi:null,Db:function(){return new wac_Z7a(this.Dc,this.Ia,this.Xi,this.Xy,this.Ro,this.o2)}};
function wac_Z7a(a,b,c,d,e,f){wac_Z7a.initializeBase(this,[a,b,c,d,e,f,null]);this.po=wac_WO(wac_T7a.Hxa,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite);this._id="FileNameDialog-SaveAsToHost"}wac_Z7a.prototype={n_:function(a,b){var c=wac_kP(wac_.dJ.lw);this.Zp(CommonUIStrings.L_SaveAs,this.w4a,{txtFileName:a||c,lblFolderName:CommonUIStrings.l_ToCurrentFolder,chkOverwrite:b});wac__7a(this,a,c)}};
function wac_JQ(a,b,c,d,e,f,g){this.T4a=Function.createDelegate(this,this.APd);this.w4a=Function.createDelegate(this,this.WGb);wac_JQ.initializeBase(this);this.Ia=b;this.Xy=d;this.o2=f;this.Dc=a;this.Ro=e;this.Xi=c;this.nfa=wac_q(this.Dc,"SaveToHostWithExtraCharsInFileName");this.WVe=g;wac_Oh(this,1,CommonUIStrings.l_SaveButtonLabel)}
wac_JQ.prototype={XE:null,Ro:null,o2:null,Ia:null,Xy:null,Dc:null,Xi:null,nfa:!1,WVe:null,oIb:function(){var a=wac_kP(wac_.dJ.lw);wac_8m(this,1,!!this.XE&&""!==this.XE.value&&this.XE.value!==a)},APd:function(){if(this.XE){var a=this;window.setTimeout(function(){a.oIb()},0)}},WGb:function(a,b){if(1!==a)wac_b(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{a=b.txtFileName;b="chkOverwrite"in b?b.chkOverwrite:!1;wac_b(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",
wac_Lea(a),b);var c=wac_If(wac_.Vxa);(a=a?a.trim():null)&&""!==a&&""!==c||1===this.Xi.kg()?wac_07a(this,a)?this.Ro.Db().Xp(1,a,b):this.o2.xea(a+c,b,this.WVe):this.Ro.Db().Xp(2,a,b)}},dispose:function(){this.XE&&(wac_jg(this.XE,"change",this.T4a),wac_jg(this.XE,"input",this.T4a),this.XE=null);wac__m.prototype.dispose.call(this)}};
function wac_07a(a,b){return a.nfa?(new RegExp("["+'\\/:*?"<>|'.replace(/[.*+?|()\[\]{}\\]/g,"\\\\$&")+"]")).test(b):(new RegExp("["+'\\/:*?"<>|#{}%~&'.replace(/[.*+?|()\[\]{}\\]/g,"\\\\$&")+"]")).test(b)}function wac__7a(a,b,c){wac_8m(a,1,!!b&&b!==c);a.XE=document.getElementById("txtFileName");wac_tf(a.XE,"change",a.T4a);wac_tf(a.XE,"input",a.T4a);a.XE.focus()}function wac_KQ(a,b,c){this.bic=Function.createDelegate(this,this.i0d);this.o2=c;this.WUa=b;this.Dc=a}
wac_KQ.prototype={Dc:null,WUa:null,o2:null,Tb:function(){2===wac_r().Hd().Nv()?wac_z().Mp(2316717900,2147483648,this.bic,4):wac_z().ja(2316717900,2147483648,this.bic)},i0d:function(a,b,c,d,e){return 2147483648!==b.Bd()||2316717900!==a?2:wac_q(this.Dc,"SaveAsToHostBrsIsEnabled")?1===c?32:2===c?(wac_b(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),a=this.WUa.Db(),e&&Object.getType(e)===Array&&2===e.length?a.n_(e[0],!!e[1]):a.n_(null,!1),32):8:8}};
function wac_17a(){this.SB=Function.createDelegate(this,this.sC)}
wac_17a.prototype={sa:null,Ub:function(){return"Common.App.SaveAsToHost"},tb:function(){wac_.pa.Ok(this.SB)},sC:function(){wac_q(wac_.pa,"SaveAsToHostBrsIsEnabled")&&this.sa.H(wac_KQ).Tb()},gc:function(a){this.sa=a;wac_n(wac_m(wac_o(this.sa.fa(wac_U7a),wac_HQ),function(){return new wac_U7a(wac_.pa,wac_z())}));wac_n(wac_m(wac_o(this.sa.fa(wac_LQ),wac_S7a),function(){return new wac_LQ(wac_z(),wac_.pa,wac_.Af,function(){return wac_.ke},function(){return new wac_dn(!1)},a.H(wac_HQ),wac_r(),wac_r().Bz())}));
wac_n(wac_m(wac_o(this.sa.fa(wac_IQ),wac_Q7a),function(){return new wac_IQ(wac_.pa,wac_z(),wac_r(),wac_r().Hd(),a.H(wac_HQ),a.H(wac_LQ))}));wac_n(wac_m(this.sa.fa(wac_KQ),function(){return new wac_KQ(wac_.pa,a.H(wac_IQ),a.H(wac_LQ))}))},O:function(){}};
function wac_LQ(a,b,c,d,e,f,g,h){this.Dld=Function.createDelegate(this,this.yVd);this.Eld=Function.createDelegate(this,this.zVd);this.Dc=b;this.rX=this.Dc.Qb.SaveAsToHostWebServiceBase;this.AWb=d;this.ZW=e;this.$g=c;this.Ro=f;this.Tf=h;this.Xi=g;this.Ia=a;this.MC=b.Qb.SaveAsToHostUploadHandler||"hostuploadhandler.ashx"}
wac_LQ.prototype={Xi:null,Om:null,ZW:null,Ro:null,$g:null,Ia:null,AWb:null,Dc:null,rX:null,MC:null,UJ:!1,zDa:!1,iz:null,LOc:null,Tf:null,H9:null,mSa:function(){1!==this.Xi.kg()&&(this.Om=this.ZW(),this.Om.Hua(CommonUIStrings.l_CommentProgressTooltip),wac_Nh(this.Om,5),this.Om.zua(!1),this.Om.n7(CommonUIStrings.l_DefaultDialogTitle,null,null))},wE:function(a){1!==this.Xi.kg()&&this.Ro.Db().Xp(a,wac_kP(this.iz),this.zDa)},Hna:function(){var a=this.Dc.Qb.BreadcrumbFolderUrl;wac_b(8194016,216,50,"Redirecting to OneDrive for business Folder.");
window.open(a,wac_Tl(3))},Gna:function(a){wac_b(8194017,216,50,"Redirecting to edit url {0}.",a);window.open(a,wac_Tl(3))},xea:function(a,b,c){wac_b(8194018,216,50,"Starting to upload file");this.AWb&&!this.AWb()&&this.$g&&(this.Tf&&(this.H9=this.Tf.uj("DialogShown","SaveAsToHostUploadTime")),this.mSa(),this.zDa=b,this.iz=a,(this.LOc=c)&&"true"===this.LOc.SkipSaveToHost?wac_27a(this):this.sQ())},sQ:function(){if(32!==this.Ia.yw(3070187925,1,null))wac_b(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),
wac_27a(this);else{var a=this,b=this;this.Ia.os(3070187925,2,[function(){wac_b(18989379,219,50,"Call the force save file change successfully.");wac_27a(a)},function(a,d){wac_b(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");b.wE(d)}],null)}},zVd:function(a){this.Yla();this.UJ=!1;if(a&&a.Aa&&a.Aa.Be){var b,c,d;if(d=wac_dP(Object,a.Aa.Be,c={val:b}),b=c.val,d)if(a=b,200!==a.StatusCode&&201!==a.StatusCode)wac_b(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),
this.wE(window.parseInt(a.ExtraInfo));else{wac_b(8194050,216,50,"UploadToHost execute success.");try{a.NewDocumentUrl&&""!==a.NewDocumentUrl?this.Gna(a.NewDocumentUrl):this.Hna()}catch(e){wac_b(37025699,216,15,"Redirect failed with exception: {0}",e.toString())}this.WQa()}else wac_b(8194048,216,10,"Failed to deserialize : {0}",{ResponseData:wac_qP(a.Aa.Be)}),this.wE(0)}else wac_b(8194019,216,10,"UploadToHostManager failure. Response data is null"),this.wE(0)},yVd:function(a){5!==a.Aa.Sd&&12!==a.Aa.Sd||
this.UJ?(wac_b(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{Status:a.Aa.Sd,HttpStatus:a.Aa.ho}),this.Yla(),this.wE(0),this.WQa()):(wac_b(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.UJ=!0,this.LOc&&"true"===this.LOc.SkipSaveToHost?wac_27a(this):this.sQ())},Yla:function(){this.Om&&(this.Om.sA(),this.Om=null)},WQa:function(){this.H9&&(this.H9.vg(),this.H9=null)}};
function wac_27a(a){var b=a.rX+a.MC,b=wac_Ml(b,"qs",wac_Cf(wac_.eo),!1),b=wac_Ml(b,"n",wac_Cf((new Date).getTime().toString()),!1),b=wac_Ml(b,"ov",wac_Cf(a.zDa.toString()),!1),b=wac_Ml(b,"fn",wac_Cf(a.iz),!1);a.LOc&&a.LOc.FileDownloadUrl&&(b=wac_Ml(b,"furl",wac_Cf(a.LOc.FileDownloadUrl),!1));a.$g.lk(b,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,a.Eld,a.Dld,null,null,!1,null,null,"1",null,!1,null,!1)}wac_T7a.registerClass("Common.App.SaveAsToHost.FileNameDialogHtml");
wac_U7a.registerClass("Common.App.SaveAsToHost.ErrorRetryDialogFactory",null,wac_HQ);wac_V7a.registerClass("Common.App.SaveAsToHost.ErrorRetryDialog",wac_di,wac_P7a);wac_IQ.registerClass("Common.App.SaveAsToHost.FileNameDialogFactory",null,wac_Q7a);wac_JQ.registerClass("Common.App.SaveAsToHost.FileNameDialogBase",wac__m);wac_Z7a.registerClass("Common.App.SaveAsToHost.FileNameDialog",wac_JQ,wac_R7a);wac_KQ.registerClass("Common.App.SaveAsToHost.SaveAsToHostActor");
wac_17a.registerClass("Common.App.SaveAsToHost.SaveAsToHostPackage",null,wac_I,wac_i);wac_LQ.registerClass("Common.App.SaveAsToHost.UploadToHostManager",null,wac_S7a);wac_T7a.Hxa="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
wac_J(wac_C(),new wac_17a,0,!1);Type.registerNamespace("Common.App.SaveToCloudStorage");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.m0d=wac_d.Qa.m0d||{};function wac_37a(){}wac_37a.registerInterface("Common.App.SaveToCloudStorage.IErrorDialog");function wac_47a(){}wac_47a.registerInterface("Common.App.SaveToCloudStorage.ISaveToCloudManager");function wac_57a(){}wac_57a.registerInterface("Common.App.SaveToCloudStorage.ISignInDialogFactory");function wac_67a(){}wac_67a.registerInterface("Common.App.SaveToCloudStorage.ISignInDialog");
function wac_77a(){}wac_77a.registerInterface("Common.App.SaveToCloudStorage.ISkyDriveUploadCaller");function wac_87a(){}wac_87a.registerInterface("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory");function wac_97a(){}wac_97a.registerInterface("Common.App.SaveToCloudStorage.IUploadToCloudManager");function wac_MQ(){wac_MQ.initializeBase(this);wac_Nh(this,0);wac_Oh(this,1,CommonUIStrings.l_DialogClose)}
wac_MQ.prototype={Xp:function(a){this.hs(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}};function wac_$7a(){}
wac_$7a.prototype={sa:null,Ub:function(){return"Common.App.SaveToCloudStorage"},tb:function(){wac_q(wac_.pa,"SaveToCloudStorageUIIsEnabled")&&this.sa.H(wac_NQ).Tb()},O:function(){},gc:function(a){this.sa=a;wac_n(wac_m(wac_o(this.sa.fa(wac_OQ),wac_57a),function(){return new wac_OQ(wac_z(),wac_qi(),wac_r().Hd())}));wac_n(wac_m(wac_o(this.sa.fa(wac_PQ),wac_87a),function(){return new wac_PQ(wac_.pa)}));wac_n(wac_m(this.sa.fa(wac_NQ),function(){return new wac_NQ(a.H(wac_QQ),a.H(wac_sQ),wac_.pa,wac_r().Bz())}));
wac_n(wac_m(this.sa.fa(wac_RQ),function(){return new wac_RQ(a.H(wac_PQ),function(){return new wac_dn(!1)},function(){return new wac_MQ},wac_r(),wac_r().Bz())}));wac_n(wac_m(this.sa.fa(wac_QQ),function(){return new wac_QQ(a.H(wac_OQ),wac_qi(),a.H(wac_RQ),wac_.pa,wac_Kg,function(){return new wac_MQ})}))}};function wac_NQ(a,b,c,d){this.cic=Function.createDelegate(this,this.l0d);this.IQc=a;this.Dc=c;this.eZb=b;this.JDb=new (wac_Rb.$$(Boolean));this.Tf=d}
wac_NQ.prototype={IQc:null,eZb:null,Dc:null,Tf:null,vmb:null,JDb:null,nzc:function(){return wac_q(this.Dc,"SaveToCloudStorageUIIsEnabled")},Xwc:function(){return 617689800},u9a:function(){var a=this.cic;wac_tl().xa(a);wac_R3a([new wac_wl(617689800,2147483648,0)],wac_yQ(this.eZb))},Tb:function(){var a=wac_yQ(this.eZb);if(a){var b=this;wac_rl(a,function(){b.JDb.Ze(!0)});this.u9a()}else wac_b(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")},hCc:function(){wac_b(6590597,
216,50,"User clicked on SaveToOneDrive button")},l0d:function(a,b,c,d,e){if(2147483648!==b.Bd()||a!==this.Xwc())return 2;if(!this.nzc())return 8;if(1===c)return 32;if(2===c){this.hCc();e&&e.FileDownloadUrl&&wac_b(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there");this.Tf&&(this.vmb=this.Tf.uj("DialogShown","SaveToOneDriveReponseTime"));var f=this;this.JDb.oj().CW(function(){f.vmb&&(f.vmb.vg(),f.vmb=null);f.IQc.Wd(e)});return 32}return 8}};
function wac_QQ(a,b,c,d,e,f){this.pJa=Function.createDelegate(this,this.Py);this.EJa=Function.createDelegate(this,this.xA);this.JRc=a;this.Z1=b;this.Vga=c;this.Dc=d;this.USb=e;this.Ro=f}
wac_QQ.prototype={JRc:null,Ro:null,Z1:null,Vga:null,Dc:null,USb:0,LOc:null,Wd:function(a){this.LOc=a;if(wac_pi()){wac_b(6590559,216,50,"User is signed in. We will show file picker.");try{wac_b(6590561,216,50,"Initializing OneDrive API");var b={client_id:this.Dc.Qb.UploadToSkyDriveClientId,env:"INT"};if(1===this.USb||2===this.USb)b={client_id:this.Dc.Qb.UploadToSkyDriveClientId};window.WL.init(b);wac_b(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");window.WL.fileDialog({mode:"save",
lightbox:"grey"}).then(this.EJa,this.pJa)}catch(c){wac_b(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",c,c.stack),this.Im()}}else wac_b(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.JRc.Db().n_()},Im:function(){this.Ro().Xp(0)},xA:function(a){wac_b(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");a&&a.data&&a.data.folders&&this.Vga.xea(a.data.folders[0].id,a.data.folders[0].urls.viewInBrowser,null,this.LOc)},
Py:function(a){if(a&&a.error){if("user_canceled"===a.error.code){wac_b(6590593,216,50,"User cancelled upload to their OneDrive.");return}wac_b(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",a.error.code,a.error.message)}else wac_b(6590595,216,50,"File Dialog returned with no response");this.Im()}};function wac_OQ(a,b,c){this.Ia=a;this.Z1=b;this.Xy=c}wac_OQ.prototype={Ia:null,Z1:null,Xy:null,Db:function(){return new wac_a8a(this.Ia,this.Z1,this.Xy)}};
function wac_a8a(a,b,c){this.kdd=Function.createDelegate(this,this.OJd);this.ygc=Function.createDelegate(this,this.cUd);wac_a8a.initializeBase(this);this.Ia=a;this.Z1=b;this.Xy=c;this.ER=!1;wac_Nh(this,1);this.ffa=1;wac_Oh(this,1,CommonUIStrings.l_SignIn);wac_Oh(this,0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}
wac_a8a.prototype={Ia:null,Z1:null,Xy:null,n_:function(){wac_S1a(this.Z1,this.ygc);wac_ei(this,CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,this.kdd)},OJd:function(a){if(a){a=new wac_nh("Signin.aspx");wac_oh(a,"prompt","1");var b="2";if(this.Xy)switch(this.Xy.Nv()){case 3:b="0";break;case 2:b="3";break;case 1:b="1"}wac_oh(a,"cbcxt",b);wac_Wg(a.Qja);window.open(a.toString(),"LoginWindow")}else wac_b(6590598,216,50,"User dismissed SignIn Dialog."),this.fd()},
fd:function(){this.Z1.Ra.sb("R",this.ygc);wac_0m.prototype.fd.call(this)},cUd:function(){this.Sh&&this.fd();wac_b(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.Ia.yw(617689800,2,null)}};function wac_b8a(a,b,c,d,e,f,g){this.rX=a;this.iz=b;this.ofa=c;this.$Ua=d;this.OXa=e;this.MC=f;this.LOc=g}
wac_b8a.prototype={rX:null,iz:null,ofa:null,$Ua:null,OXa:null,MC:null,LOc:null,uc:function(a,b){if(!wac_.ke&&wac_.Af){var c=this.rX+this.MC,c=wac_Ml(c,"fo",wac_Cf(this.$Ua),!1),c=wac_Ml(c,"fn",wac_Cf(this.iz),!1),c=wac_Ml(c,"qs",wac_Cf(this.OXa),!1),c=wac_Ml(c,"n",wac_Cf((new Date).getTime().toString()),!1);this.LOc&&this.LOc.FileDownloadUrl&&(c=wac_Ml(c,"furl",wac_Cf(this.LOc.FileDownloadUrl),!1));this.ofa&&(c=wac_Ml(c,"fnn",wac_Cf(this.ofa),!1));wac_.Af.lk(c,1,"",{"Content-Type":"application/json; charset=utf-8"},
!1,2,a,b,null,null,!1,null,null,null,null,!1,null,!1)}}};function wac_PQ(a){this.Dc=a;this.Du=a.Qb.SkyDriveUploadWebServiceBase;this.iz=a.Qb.FileName;this.MC=a.Qb.SkyDriveUploadHandler||"skydriveuploadhandler.ashx"}wac_PQ.prototype={Du:null,iz:null,MC:null,Dc:null,Db:function(a,b,c){return new wac_b8a(this.Du,this.iz,b,a,wac_.eo,this.MC,c)}};
function wac_RQ(a,b,c,d,e){this.Wjd=Function.createDelegate(this,this.dTd);this.Xjd=Function.createDelegate(this,this.eTd);this.iZa=a;this.ZW=b;this.Ro=c;this.Xi=d;this.Tf=e}
wac_RQ.prototype={iZa:null,FTa:null,Om:null,Xi:null,AW:null,ZW:null,Ro:null,UJ:!1,Tf:null,H9:null,LOc:null,mSa:function(){this.Xi&&1===this.Xi.kg()||(this.Om=this.ZW(),this.Om.Hua(CommonUIStrings.l_CommentProgressTooltip),wac_Nh(this.Om,5),this.Om.zua(!1),this.Om.n7(CommonUIStrings.l_DefaultDialogTitle,null,null))},Yla:function(){this.Om&&(this.Om.sA(),this.Om=null)},wE:function(){1!==wac_r().kg()&&this.Ro().Xp(0)},Hna:function(){wac_b(6590599,216,50,"Redirecting to OneDrive Folder.");window.open(this.AW,
wac_Tl(3))},Gna:function(a){wac_b(6654163,216,50,"Redirecting to edit url {0}.",a);window.open(a,wac_Tl(3))},xea:function(a,b,c,d){wac_b(7143886,216,50,"Starting to upload file");this.Tf&&(this.H9=this.Tf.uj("DialogShown","SaveToOneDriveUploadTime"));this.mSa();this.AW=b;this.FTa=this.iZa.Db(a,c,d);this.LOc=d;this.sQ()},sQ:function(){wac_b(6590600,216,50,"Calling SkydriveUploadHandler.");this.FTa.uc(this.Xjd,this.Wjd)},eTd:function(a){this.Yla();this.UJ=!1;if(a&&a.Aa&&a.Aa.Be){var b,c,d;if(d=wac_dP(Object,
a.Aa.Be,c={val:b}),b=c.val,d)if(a=b,200!==a.StatusCode&&201!==a.StatusCode)wac_b(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.wE();else{wac_b(6590603,216,50,"UploadToCloudManager upload success.");try{a.NewDocumentUrl&&""!==a.NewDocumentUrl?this.Gna(a.NewDocumentUrl):this.Hna()}catch(e){wac_b(37025728,216,15,"Redirect failed with exception: {0}",e.toString())}this.WQa()}else wac_b(7660114,216,10,"Failed to deserialize : {0}",{ResponseData:wac_qP(a.Aa.Be)}),
this.wE()}else wac_b(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.wE()},dTd:function(a){5!==a.Aa.Sd&&12!==a.Aa.Sd||this.UJ?(wac_b(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",a.Aa.Sd),this.Yla(),this.wE(),this.WQa()):(wac_b(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.UJ=!0,this.sQ())},WQa:function(){this.H9&&(this.H9.vg(),this.H9=null)}};wac_MQ.registerClass("Common.App.SaveToCloudStorage.ErrorDialog",wac_di,wac_37a);
wac_$7a.registerClass("Common.App.SaveToCloudStorage.PackageManager",null,wac_I,wac_i);wac_NQ.registerClass("Common.App.SaveToCloudStorage.SaveToCloudStorageActor");wac_QQ.registerClass("Common.App.SaveToCloudStorage.SaveToCloudManager",null,wac_47a);wac_OQ.registerClass("Common.App.SaveToCloudStorage.SignInDialogFactory",null,wac_57a);wac_a8a.registerClass("Common.App.SaveToCloudStorage.SignInDialog",wac_di,wac_67a);
wac_b8a.registerClass("Common.App.SaveToCloudStorage.SkyDriveUploadCaller",null,wac_77a);wac_PQ.registerClass("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory",null,wac_87a);wac_RQ.registerClass("Common.App.SaveToCloudStorage.UploadToCloudManager",null,wac_97a);wac_J(wac_C(),new wac_$7a,0,!1);Type.registerNamespace("Common.App.SaveToSharePoint");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.n0d=wac_d.Qa.n0d||{};function wac_c8a(){}wac_c8a.registerInterface("Common.App.SaveToSharePoint.IErrorDialog");
function wac_d8a(){}wac_d8a.registerInterface("Common.App.SaveToSharePoint.IFileNameDialogFactory");function wac_e8a(){}wac_e8a.registerInterface("Common.App.SaveToSharePoint.IFileNameDialog");function wac_SQ(){}wac_SQ.registerInterface("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper");function wac_f8a(){}wac_f8a.registerInterface("Common.App.SaveToSharePoint.IPickerDialog");function wac_g8a(){}wac_g8a.registerInterface("Common.App.SaveToSharePoint.ISharePointSaveAsCaller");
function wac_h8a(){}wac_h8a.registerInterface("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory");function wac_TQ(){}wac_TQ.registerInterface("Common.App.SaveToSharePoint.ISaveToSharePointManager");function wac_i8a(){}wac_i8a.registerInterface("Common.App.SaveToSharePoint.IUploadToSharePointManager");function wac_j8a(){}function wac_UQ(){wac_UQ.initializeBase(this);wac_Nh(this,0);wac_Oh(this,1,CommonUIStrings.l_DialogClose)}
wac_UQ.prototype={Jca:function(a,b){wac_b(25235986,216,15,"Show warning dialog of Picker related issue.");this.hs(37,a,b,null,!0)}};function wac_VQ(a,b,c,d,e,f,g){this.Ia=b;this.Dc=a;this.Xy=d;this.o2=f;this.Ro=e;this.Xi=c;this.JQc=g}wac_VQ.prototype={Ia:null,Xy:null,o2:null,Ro:null,Dc:null,Xi:null,JQc:null,Db:function(a){return new wac_k8a(this.Dc,this.Ia,this.Xi,this.Xy,this.Ro,this.o2,this.JQc,a)}};
function wac_k8a(a,b,c,d,e,f,g,h){this.Zfc=Function.createDelegate(this,this.cTd);this.Yfc=Function.createDelegate(this,this.dBc);this.syd=CommonUIStrings.l_SaveToAnotherFolder;wac_k8a.initializeBase(this,[a,b,c,d,e,f,h]);this.po=wac_WO(wac_j8a.Hxa,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"");this._id="FileNameDialog-SaveToSharePoint";this.kYa=g;this.LOc=h}
wac_k8a.prototype={kYa:null,LOc:null,Vx:null,Cfa:null,n_:function(a){var b=wac_kP(wac_.dJ.lw),c=wac_.m9a,d=wac_.l9a,e={txtFileName:a||b},f=CommonUIStrings.L_SaveAs;2===wac_r().Hd().Nv()&&(f=CommonUIStrings.L_SaveACopy);this.Zp(f,this.w4a,e);wac__7a(this,a,b);(wac_kg?wac_kg.Rb:null).style.width="450px";this.Vx=document.getElementById("anotherFolder");this.Vx.className="WACButton WACDialogButtonNormal";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");
a=!1;if(c&&c.length){wac_l8a(this.Vx,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,d,c));f=a={val:a};f.val=!1;b=document.getElementById("currentLocation");b.innerText="";var g=wac_m8a(b,d),h=wac_m8a(b,c),k=255,e=255;255<g+h&&(k=Math.max(238,408-g),e=Math.max(170,408-h),f.val=!0);f=k;d&&(wac_n8a(b,d,e),d=document.createElement("span"),d.id="FolderSeparator",e=document.createElementNS("http://www.w3.org/2000/svg","svg"),e.setAttribute("class","SeparatorCaret"),g=document.createElementNS("http://www.w3.org/2000/svg",
"polygon"),g.setAttribute("points","1 4 1 11 5 7.5"),e.appendChild(g),d.appendChild(e),b.appendChild(d));c&&wac_n8a(b,c,f);a=a.val}else wac_l8a(this.Vx,CommonUIStrings.l_CurrentOnlineFolder);c=this.Vx;d=document.createElement("span");d.className="cui-img-cont-float cui-img-16by16 ";this.Cfa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Cfa.setAttribute("class","FolderIconSVG");b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");
this.Cfa.appendChild(b);d.appendChild(this.Cfa);c.appendChild(d);c=this.Vx;d=document.createElement("span");d.id="anotherFolderText";d.innerText=this.syd;d.className="AnotherFolderTextSpan";c.appendChild(d);a?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Vx,"SaveToAnotherLocationTwo"),wac_b(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Vx,"SaveToAnotherLocationOne");wac_tf(this.Vx,"click",
this.Yfc);wac_tf(this.Vx,"keydown",this.Zfc)},cTd:function(a){!a||13!==a.keyCode&&32!==a.keyCode||this.dBc(a)},dBc:function(){if(this.XE){var a=wac_If(wac_.Vxa),b=this.XE.value;this.fd();b&&""!==b&&""!==a||1===this.Xi.kg()?(""!==a&&(b+=a),wac_07a(this,b)?this.Ro.Db().Xp(1,b,!1):this.kYa.Wd(b,this.LOc)):this.Ro.Db().Xp(2,b,!1)}},oIb:function(){wac_JQ.prototype.oIb.call(this);this.Vx&&this.Cfa&&(this.XE&&""!==this.XE.value?(this.Vx.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Vx,"DisabledSaveAsButton"),
Sys.UI.DomElement.removeCssClass(this.Cfa,"DisabledFolderIconSVG")):(this.Vx.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Vx,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Cfa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Vx,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Cfa,"DisabledFolderIconSVG"))))},dispose:function(){this.Vx&&(wac_jg(this.Vx,"click",this.Yfc),wac_jg(this.Vx,"keydown",this.Zfc),this.Vx=null);wac_JQ.prototype.dispose.call(this)}};
function wac_l8a(a,b){b=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,b);a.tabIndex=0;a.setAttribute("aria-label",b);a.setAttribute("role","button")}function wac_n8a(a,b,c){var d=document.createElement("div");d.innerText=b;d.title=b;d.className="SaveToAnotherFolderBreadcrumb";d.style.maxWidth=c.toString()+"px";a.appendChild(d)}
function wac_m8a(a,b){var c=document.createElement("div");c.innerText=b;c.style.visibility="hidden";a.appendChild(c);b=c.clientWidth;a.removeChild(c);return b}function wac_o8a(a,b,c,d){this.Sja=Function.createDelegate(this,this.xma);this.tN=a;this.Xi=c;this.sPc=d;var e=this;this.WJ=new (wac_f.$$(wac_nc.$$(wac_sc)))(function(){return new (wac_9P.$$(wac_sc))(b.ma(),e.Sja)})}
wac_o8a.prototype={tN:null,Xi:null,sPc:null,TW:null,yl:null,WJ:null,mFa:function(){this.TW||(this.WJ.ma().XU("Save As",!0),this.yl&&this.yl.BI&&this.yl.BI.length&&(this.TW=this.OHb(this.yl.BI)));return this.TW},Wd:function(a){if(!this.mFa())if(wac_.oca&&wac_.oca.length)this.TW=wac_.oca;else return wac_b(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.yl),!1;var b=this.sPc();b.GQb();var c=
b.QHb();if(!c)return wac_b(24664067,216,10,"Picker container is null, will not show picker."),!1;var d=this;this.tN.Wd(function(c,d){b.fd();a(c,d)},function(){d.KLb(b)},c,this.TW);return!0},KLb:function(a){a.fd();wac_b(24664068,216,50,"User cancelled save to another folder.")},OHb:function(a){a=a.toLowerCase();a.endsWith("/")||(a+="/");var b=a.indexOf("/documents/");return-1!==b?a.substring(0,b+1)+"_layouts/15/onedrive.aspx":""},xma:function(a){this.yl||3!==a.kg()||(this.yl=a)}};
function wac_p8a(){}
wac_p8a.prototype={sa:null,Ub:function(){return"Common.App.SaveToSharePoint"},tb:function(){},O:function(){},gc:function(a){this.sa=a;var b=wac_rP(wac_oc.$$(wac_sc),wac_l(a,wac_oc.$$(wac_sc))),c=this;wac_Db.WAA.call(null,b).CW(function(){wac_n(wac_m(wac_o(c.sa.fa(wac_WQ),wac_h8a),function(){return new wac_WQ(wac_.pa)}));wac_n(wac_m(wac_o(c.sa.fa(wac_XQ),wac_i8a),function(){return new wac_XQ(wac_z(),a.H(wac_WQ),function(){return new wac_dn(!1)},function(){return new wac_UQ},wac_r())}));wac_n(wac_m(wac_o(c.sa.fa(wac_q8a),
wac_TQ),function(){return new wac_q8a(a.H(wac_XQ),function(){return new wac_UQ},a.H(wac_SQ),wac_r())}));wac_n(wac_m(wac_o(c.sa.fa(wac_o8a),wac_SQ),function(){return new wac_o8a(a.H(wac_wQ),new (wac_f.$$(wac_oc.$$(wac_sc)))(function(){return wac_Qb(b)}),wac_r(),function(){return new wac_r8a})}));wac_n(wac_m(c.sa.fa(wac_VQ),function(){return new wac_VQ(wac_.pa,wac_z(),wac_r(),wac_r().Hd(),a.H(wac_HQ),a.H(wac_S7a),a.H(wac_TQ))}));wac_n(wac_m(c.sa.fa(wac_YQ),function(){return new wac_YQ(wac_.pa,wac_z(),
a.H(wac_VQ),a.H(wac_TQ),a.H(wac_wQ),a.H(wac_SQ),function(){return wac_r().BGb()})}));wac_q(wac_.pa,"SaveToAnotherFolderBrsIsEnabled")&&c.sa.H(wac_YQ).Tb()})}};function wac_r8a(){wac_r8a.initializeBase(this)}wac_r8a.prototype={GQb:function(){this.jUa="FilePickerDialog";this.po="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this._id="PickerDialog-MsoSp";this.Hm("",null)},QHb:function(){return document.getElementById("FilePickerDiv")},qu:function(){},Pda:function(){}};
function wac_s8a(a,b,c,d,e,f,g,h){this.rX=a;this.iz=b;this.ofa=d;this.OXa=f;this.AW=c;this.LRc=e;this.MC=g;this.LOc=h}
wac_s8a.prototype={rX:null,iz:null,ofa:null,OXa:null,AW:null,LRc:null,MC:null,LOc:null,uc:function(a,b){if(!wac_.ke&&wac_.Af){var c=this.rX+this.MC,c=wac_Ml(c,"fu",wac_Cf(this.AW),!1),c=wac_Ml(c,"su",wac_Cf(this.LRc),!1),c=wac_Ml(c,"fn",wac_Cf(this.iz),!1),c=wac_Ml(c,"n",wac_Cf((new Date).getTime().toString()),!1);this.LOc&&this.LOc.FileDownloadUrl&&(c=wac_Ml(c,"furl",wac_Cf(this.LOc.FileDownloadUrl),!1));c=c+"&"+this.OXa;this.ofa&&this.ofa.length?c=wac_Ml(c,"fnn",wac_Cf(this.ofa),!1):wac_b(23881891,
216,15,"No new file name in request.");wac_b(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");wac_.Af.lk(c,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,a,b,null,null,!1,null,null,"9",null,!1,null,!1)}}};function wac_WQ(a){this.Du=a.Qb.SaveAsToHostWebServiceBase;this.iz=a.Qb.FileName;this.MC=a.Qb.SharePointSaveAsHandler||"sharepointsaveashandler.ashx"}
wac_WQ.prototype={Du:null,iz:null,MC:null,Db:function(a,b,c,d){return new wac_s8a(this.Du,this.iz,a,b,c,wac_.eo,this.MC,d)}};function wac_YQ(a,b,c,d,e,f,g){this.dic=Function.createDelegate(this,this.o0d);this.Dc=a;this.WUa=c;this.Ia=b;this.kYa=d;this.tN=e;this.gga=f;this.yVe=g}
wac_YQ.prototype={WUa:null,Dc:null,Ia:null,kYa:null,tN:null,gga:null,yVe:null,Tb:function(){var a=wac_yQ(this.tN);if(a)if(wac_Fh()||wac_q(this.Dc,"SaveToSharePointOnDemandDownloadJsIsEnabled"))this.Ia.Mp(3050207199,2147483648,this.dic,64);else{var b=this;wac_2gc(a).CW(function(a){wac_Fb(a)&&b.tN.pMb(a)});this.u9a()}else wac_b(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")},u9a:function(){var a=this.dic;wac_tl().xa(a);wac_R3a([new wac_wl(3050207199,2147483648,0)],wac_yQ(this.tN))},
o0d:function(a,b,c,d,e){return 2147483648!==b.Bd()||3050207199!==a?2:wac_q(this.Dc,"SaveToAnotherFolderBrsIsEnabled")&&(this.gga.mFa()||wac_q(this.Dc,"UserCanWriteRelative"))?1===c?this.yVe()?32:8:2===c?(wac_b(23881885,216,50,"User clicked on SaveToSharePoint button from the backstage."),e&&e.FileDownloadUrl&&wac_b(40379589,216,50,"SaveToSharePoint FileDownloadUrl - "+e.FileDownloadUrl),wac_q(this.Dc,"UserCanWriteRelative")?(wac_b(24524226,216,50,"Show save a copy dialog."),this.WUa.Db(e).n_(null)):
(wac_b(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.kYa.Wd(null,e)),32):8:8}};function wac_q8a(a,b,c,d){this.MSc=a;this.Ro=b;this.gga=c;this.Xi=d}
wac_q8a.prototype={Xi:null,Ro:null,MSc:null,gga:null,$Nc:null,LOc:null,Wd:function(a,b){wac_b(25180163,216,50,"Try launch Picker.");this.$Nc=a;this.LOc=b;var c=this;this.gga.Wd(function(a,b){c.Bna(a,b)})||wac_t8a(this)},Bna:function(a,b){a?this.xA(b):this.Py(b)},xA:function(a){wac_b(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(a&&a.data&&a.data.value&&a.data.value.length&&a.data.value[0].sharePoint){var b=a.data.value[0].sharePoint.url;a=a.data.value[0].sharePoint.listUrl;
var c=null;if(b){if(a)a.endsWith("/")&&(a=a.substring(0,a.length-1)),c=a.lastIndexOf("/"),a=-1!==c?a.substring(0,c):null;else a:{a=b;a.endsWith("/")||(a+="/");for(var d=c=0;d<a.length;d++)if("/"===a.charAt(d)&&5===++c){a=a.substr(0,d);break a}a=null}if(c=a){this.MSc.xea(b,this.$Nc,c,this.LOc);return}}wac_b(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!b,!c)}wac_b(23881887,216,10,"Picker return invalid data or empty SharePoint url.");wac_t8a(this)},
Py:function(a){wac_b(23881888,216,10,"Picker failure Callback called.");a&&a.error?wac_b(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",a.error.errorCode,a.error.message):wac_b(23881890,216,10,"File Dialog returned empty error.");wac_t8a(this)}};function wac_t8a(a){1!==a.Xi.kg()&&a.Ro().Jca(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}
function wac_XQ(a,b,c,d,e){this.Yjd=Function.createDelegate(this,this.fTd);this.Zjd=Function.createDelegate(this,this.gTd);this.iZa=b;this.ZW=c;this.Ro=d;this.Xi=e;this.Ia=a}
wac_XQ.prototype={iZa:null,FTa:null,Om:null,Xi:null,ZW:null,Ro:null,Ia:null,PSb:!1,AW:null,xea:function(a,b,c,d){this.PSb=!1;wac_b(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.mSa();this.AW=a;this.FTa=this.iZa.Db(a,b,c,d);d&&"true"===d.SkipSaveToHost?this.sQ():wac_u8a(this)},sQ:function(){wac_b(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.FTa.uc(this.Zjd,this.Yjd)},gTd:function(a){if(a&&a.Aa&&a.Aa.Be){var b,c,d;if(d=wac_dP(Object,a.Aa.Be,
c={val:b}),b=c.val,d)if(200!==b.StatusCode&&201!==b.StatusCode){if(wac_b(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",a.Aa.Sd,b.StatusCode),413===b.StatusCode||!wac_v8a(this,a.Aa.Sd))switch(a=b.StatusCode,wac_b(25180166,216,50,"Upload fail with status code: {0}.",a),a){case 401:this.Im(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage,38);break;case 413:a=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,
250);this.Im(CommonUIStrings.l_SaveAsFileTooLargeTitle,a,32);break;default:wac_ZQ(this)}}else{wac_b(23881927,216,50,"UploadToSharePointManager upload success.");try{b.NewDocumentUrl?this.Gna(b.NewDocumentUrl):this.Hna()}catch(e){wac_b(37025729,216,15,"Redirect failed with exception: {0}",e.toString())}}else wac_b(23881926,216,10,"Failed to deserialize : {0}",{ResponseData:wac_qP(a.Aa.Be)}),wac_w8a(this)||wac_ZQ(this)}else wac_b(23881925,216,10,"Upload failure. Response data is null"),wac_w8a(this)||
wac_ZQ(this)},fTd:function(a){a&&a.Aa?wac_v8a(this,a.Aa.Sd)||(wac_b(23881929,216,10,"Upload failed."),wac_ZQ(this)):(wac_b(23881928,216,10,"Upload failure. Response data is null"),wac_w8a(this)||wac_ZQ(this))},Hna:function(){wac_b(23881933,216,50,"Redirecting to Folder.");window.open(this.AW,wac_Tl(3))},Gna:function(a){wac_b(23881934,216,50,"Redirecting to edit url {0}.",a);window.open(a,wac_Tl(3))},mSa:function(){this.Xi&&1===this.Xi.kg()||(this.Om=this.ZW(),this.Om.Hua(CommonUIStrings.l_CommentProgressTooltip),
wac_Nh(this.Om,5),this.Om.zua(!1),this.Om.n7(CommonUIStrings.l_DefaultDialogTitle,null,null))},Yla:function(){this.Om&&(this.Om.sA(),this.Om=null)},Im:function(a,b,c){wac_b(25180165,216,10,"Upload failure with title: {0}, message: {1}",a,b);this.Yla();if(1!==this.Xi.kg()){var d=this.Ro();wac_b(25180161,216,10,"Show upload error dialog with error code {0}.",c);d.hs(c,a,b,null)}}};function wac_ZQ(a){a.Im(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile,38)}
function wac_v8a(a,b){wac_b(23881932,216,10,"HTTP failure with code: {0}",b);return wac_w8a(a)}function wac_w8a(a){if(!a.PSb)return wac_b(23881930,216,10,"Upload fail. Retrying."),a.PSb=!0,a.sQ(),!0;wac_b(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}
function wac_u8a(a){function b(){wac_b(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");a.sQ()}32!==a.Ia.os(3070187925,2,[function(){wac_b(23881922,216,50,"Call the force save file change successfully.");a.sQ()},b],null)&&b()}wac_j8a.registerClass("Common.App.SaveToSharePoint.FileNameDialogHtml");wac_UQ.registerClass("Common.App.SaveToSharePoint.ErrorDialog",wac_di,wac_c8a);
wac_VQ.registerClass("Common.App.SaveToSharePoint.FileNameDialogFactory",null,wac_d8a);wac_k8a.registerClass("Common.App.SaveToSharePoint.FileNameDialog",wac_JQ,wac_e8a);wac_o8a.registerClass("Common.App.SaveToSharePoint.OneDriveFilePickerHelper",null,wac_SQ);wac_p8a.registerClass("Common.App.SaveToSharePoint.PackageManager",null,wac_I,wac_i);wac_r8a.registerClass("Common.App.SaveToSharePoint.PickerDialog",wac__m,wac_f8a);
wac_s8a.registerClass("Common.App.SaveToSharePoint.SharePointSaveAsCaller",null,wac_g8a);wac_WQ.registerClass("Common.App.SaveToSharePoint.SharePointUploadCallerFactory",null,wac_h8a);wac_YQ.registerClass("Common.App.SaveToSharePoint.SaveToSharePointActor");wac_q8a.registerClass("Common.App.SaveToSharePoint.SaveToSharePointManager",null,wac_TQ);wac_XQ.registerClass("Common.App.SaveToSharePoint.UploadToSharePointManager",null,wac_i8a);wac_j8a.Hxa="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
wac_J(wac_C(),new wac_p8a,0,!1);Type.registerNamespace("Common.App.VersionHistory");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.p2b=wac_d.Qa.p2b||{};function wac_Tvc(){}wac_Tvc.registerInterface("Common.App.VersionHistory.IVersionHistoryDialog");function wac_Uvc(){}wac_Uvc.registerInterface("Common.App.VersionHistory.IVersionHistoryDialogActor");function wac_Vvc(){}wac_Vvc.registerInterface("Common.App.VersionHistory.IVersionHistoryDialogFactory");
function wac_Wvc(){this.SB=Function.createDelegate(this,this.sC)}
wac_Wvc.prototype={sa:null,Dc:null,Ub:function(){return"Common.App.VersionHistory"},gc:function(a){this.sa=a;this.Dc=wac_.pa;var b=this;wac_n(wac_m(wac_o(this.sa.fa(wac_Xvc),wac_Uvc),function(){return new wac_Xvc(wac_z(),wac_0b(b.sa,wac_Vvc))}));var c=this;wac_n(wac_m(wac_o(this.sa.fa(wac_Yvc),wac_Vvc),function(){return new wac_Yvc(c.sa.H(wac_kIa))}))},tb:function(){this.Dc.Ok(this.SB)},sC:function(){wac_Rqc()?wac_q(this.Dc,"AppSupportsReactVersionHistory")?wac_b(39890946,202,50,"VersionHistoryPackageManager:OnFullAppSettingsReady - Not initializing the VersionHistory package because the react package is enabled"):
(wac_b(38908760,202,50,"VersionHistoryPackageManager:OnFullAppSettingsReady - Initializing the VersionHistory package"),(wac_Zvc||(wac_Zvc=wac__vc())).Tb(),this.sa.H(wac_Yvc).Yd(),this.sa.H(wac_Uvc).Tb()):wac_b(38908759,202,50,"VersionHistoryPackageManager:OnFullAppSettingsReady - Not initializing the VersionHistory package because the feature is disabled")},O:function(){}};
function wac_0vc(a,b){this.xKe=Function.createDelegate(this,this.YMe);this.DAe=Function.createDelegate(this,this.xCe);this.dLe=Function.createDelegate(this,this.p2b);this.THe=a;this.Ia=b}function wac__vc(){return new wac_0vc(wac_Rqc,new (wac_f.$$(wac_Oc))(function(){return wac_z()}))}
wac_0vc.prototype={Ia:null,THe:null,Tb:function(){this.$k().ja(3182458430,2147483648,this.dLe)},p2b:function(a,b,c){if(1===c)return this.THe()?32:8;if(!wac_.vNd)return 8;wac_b(38908761,202,50,"VersionHistoryActor:VersionHistory - Version History Attempt");wac_.vNd(this.DAe,this.xKe);return 32},xCe:function(a){a?a.OperationResult?wac_b(38908763,202,10,"VersionHistoryActor:OnVersionHistorySuccess - Unknown failed operation result"):this.$k().os(3649559640,2,a,null):wac_b(38908762,202,10,"VersionHistoryActor:OnVersionHistorySuccess - Got null response")},
YMe:function(a){var b=new wac_di;wac_Nh(b,0);wac_b(38908764,202,15,"VersionHistoryActor:OnVersionHistoryFailure - {0}",{Result:a});wac_ei(b,"We Couldn't get the Version History","We're sorry, but we couldn't get the version history for the file. Please try again in a few minutes, or refresh the page and try again.",3,null)},$k:function(){return this.Ia.ma()}};function wac_1vc(a,b,c){this.Veb=a;this.Oma=b;this.d6=c}wac_1vc.prototype={Veb:null,Oma:null,d6:null};
function wac_2vc(a){this.iHe=a;this.l2b=document.createElement("div");this.l2b.id=this.iHe;this.l2b.style.position="relative";this.l2b.style.width="24px";this.l2b.style.height="100%";this.l2b.style.margin="0 auto";a=document.createElement("div");a.style.position="absolute";a.style.display="block";a.style.top="50%";this.l2b.appendChild(a);var b=document.createElement("img");b.src=wac_Le("progress.gif");a.appendChild(b)}
wac_2vc.prototype={iHe:null,l2b:null,Ki:function(){this.l2b.style.display="block"},fd:function(){this.l2b.style.display="none"}};
function wac_3vc(a){this.bLe=Function.createDelegate(this,this.pHe);this.i6c=Function.createDelegate(this,this.fvc);this.eLe=Function.createDelegate(this,this.MNe);this.cLe=Function.createDelegate(this,this.KNe);this.N5c=Function.createDelegate(this,this.Exd);this.M5c=Function.createDelegate(this,this.Dxd);this.Jja=[];this.QAd=[];wac_3vc.initializeBase(this);this.c2d=a;this.nhb=this.M5c;this.Joa=this.N5c;this.mze=this.cLe;this.qgd=this.eLe;this.po=wac_4vc;wac_Nh(this,0);this._id="VersionHistoryDialog";
wac_Oh(this,1,CommonUIStrings.l_DialogClose)}
wac_3vc.prototype={cNa:null,x2d:null,CUc:null,oze:null,rDe:null,Pcd:null,Xye:null,dze:null,cze:null,wIe:null,c2d:null,nhb:null,Joa:null,mze:null,qgd:null,Dxd:function(a){this.fvc(a);return!0},Exd:function(a){return wac_Cma(this,a,this.i6c)},KNe:function(a){this.pHe(a);return!0},MNe:function(a){return wac_Cma(this,a,this.bLe)},pHe:function(a){a=a.AYa;this.c2d.wCe(a[0],a[1]);if(document.getElementById("versionTimeStamp"))document.getElementById("versionTimeStamp").innerText=(new Date(a[0].Time.toString())).toLocaleString("en-US",
{SJe:"long",yIe:"numeric",zIe:"numeric",RJe:"numeric"}).toString();else{var b=document.createElement("div");b.id="versionTimeStamp";b.innerText=(new Date(a[0].Time.toString())).toLocaleString("en-US",{SJe:"long",yIe:"numeric",zIe:"numeric",RJe:"numeric"}).toString();b.style.paddingLeft="40%";document.getElementById("WACDialogTitlePanel").appendChild(b)}},fvc:function(a){a=a.AYa;"visible"===a.Veb.style.visibility?(a.Veb.style.visibility="hidden",a.d6.className=wac_9h("OutlookSearchChevronDown_16x16x32"),
a.d6.title=CommonUIStrings.l_Expand,a.Oma.title=CommonUIStrings.l_Expand):(a.Veb.style.visibility="visible",a.d6.className=wac_9h("OutlookSearchChevronUp_16x16x32"),a.d6.title=CommonUIStrings.l_Collapse,a.Oma.title=CommonUIStrings.l_Collapse)},Pda:function(){wac_0m.prototype.Pda.call(this);this.ICc();this.Rb.style.width=wac_xk(document.getElementById("WACInnerFrame")).width+"px";this.Rb.style.height=wac_xk(document.getElementById("WACInnerFrame")).height+wac_xk(document.getElementById("WACStatusBarContainer")).height+
"px";wac_5vc(this)},N4c:function(a,b,c,d,e,f){var g=document.createElement("div");d&&(g.id=d);e&&g.setAttribute("aria-labelledby",e);f&&(g.tabIndex=0);d=document.createElement("span");d.className="EmbedSectionName UIFontBold";d.innerText=a;c&&(d.id=c);g.appendChild(d);g.appendChild(b);return g},SBe:function(a,b,c){b=this.N4c(b,c,null,null,null,!1);var d=this.fg.createElement("div");d.className="WACGlyph EmbedArrowHolder";d.id="Arrow"+a;d.setAttribute("role","button");d.tabIndex=0;b.insertBefore(d,
c);a=wac_4h(16,16,"UpArrowServer","EmbedArrowIcon","");d.appendChild(a);a=a.childNodes[0];a.className=wac_9h("OutlookSearchChevronUp_16x16x32");a.title=CommonUIStrings.l_Collapse;d.title=CommonUIStrings.l_Collapse;c.style.visibility="visible";c=new wac_1vc(c,d,a);Array.add(this.Jja,c);this.Fk.zA("click",d,this.nhb,c);this.Od.zA("keydown",d,this.Joa,c);this.Od.zA("keypress",d,this.Joa,c);this.Od.zA("keyup",d,this.Joa,c);return b},dispose:function(){if(this.Jja){for(var a=0;a<this.Jja.length;++a)this.Fk.ub("click",
this.Jja[a].Oma,this.nhb),this.Od.ub("keydown",this.Jja[a].Oma,this.Joa),this.Od.ub("keypress",this.Jja[a].Oma,this.Joa),this.Od.ub("keyup",this.Jja[a].Oma,this.Joa);this.Joa=this.nhb=this.Jja=null}if(this.QAd){for(a=0;a<this.QAd.length;++a)this.Fk.ub("click",this.QAd[a].VersionElement,this.mze),this.Od.ub("keydown",this.QAd[a].VersionElement,this.qgd),this.Od.ub("keypress",this.QAd[a].VersionElement,this.qgd),this.Od.ub("keyup",this.QAd[a].VersionElement,this.qgd);this.qgd=this.mze=this.QAd=null}this.cNa=
this.dze=this.Pcd=this.CUc=this.x2d=null;wac__m.prototype.dispose.call(this)}};
function wac_6vc(a,b,c){var d=document.createElement("div");d.id=b.Time.toString();d.style.cssText="display:flex;direction:inherit;flex-direction:row;box-sizing:border-box;align-items:stretch;flex-wrap:nowrap;width:268px;max-width:268px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:9px;margin-bottom:9px;margin-right:9px;margin-left:9px;background-color:rgb(248, 248, 248);cursor:default;position:relative;box-shadow:rgba(0, 0, 0, 0.1) 0px 16px 24px;overflow:hidden;border-width:1px;border-style:solid;border-image:initial;border-color:rgb(234, 234, 234);outline:transparent dotted 2px;";var e=
b.AuthorID?b.AuthorID:"GuestUser";d.innerHTML=String.format('<div style="display: flex; direction: inherit; flex-direction: column; flex-grow: 1; max-width: 266px; outline: none;">\r\n                                     <div style="display: flex; flex-wrap: nowrap; flex-direction: column; flex-grow: 1; max-width: 266px; outline: none;">\r\n                                     <div style="display: flex; direction: inherit; flex-grow: 1; flex-direction: row; flex-wrap: nowrap; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px;\r\n                                                  position: relative; background-color: rgb(255, 255, 255); overflow: hidden; border-width: 0px; border-style: initial; border-color: initial; border-image: initial;">\r\n                                     <div style="position: absolute; left: 2px; top: 0px; right: 0px; bottom: 0px; width: 1px; background-color: transparent; display: none; outline: none;"></div>\r\n                                     <div style="margin-top: 8px; margin-right: 8px; margin-bottom: 8px; margin-left: 6px;">\r\n                                     <div style="font-family: inherit;-webkit-font-smoothing: antialiased;font-size: 14px;font-weight: 400;box-shadow: none;margin-top: 0px;margin-right: 0px;margin-bottom: 0px;margin-left: 0px;\r\n                                               padding-top: 0px;padding-right: 0px;padding-bottom: 0px;padding-left: 0px;box-sizing: border-box;color: rgb(51, 51, 51);position: relative;height: 24px;min-width: 24px;display: flex;\r\n                                               align-items: center;justify-content: center;">\r\n                                     <div style="font-family: \'Segoe UI\', \'Segoe UI Web (West European)\', \'Segoe UI\', -apple-system, BlinkMacSystemFont, Roboto, \'Helvetica Neue\', sans-serif; -webkit-font-smoothing: antialiased; font-size: 14px; font-weight: 400;">\r\n                                     <div style="position: relative; text-align: center; height: 24px; width: 24px; flex: 0 0 auto;">\r\n                                     <div style="color: rgb(255, 255, 255); font-size: 11px; font-weight: 400; line-height: 24px; height: 24px; background-color: rgb(96, 60, 186); border-radius: 50%;"><span>{0}</span></div></div></div></div></div>\r\n                                     <div style="display: flex; direction: inherit; flex-direction: column; flex-grow: 1; margin-top: 8px;">\r\n                                     <div style="display: flex; direction: inherit; flex-direction: row; flex-wrap: nowrap; overflow: hidden;">\r\n                                     <div style="color: rgb(51, 51, 51); font-weight: 600; font-family: inherit; font-size: 12px; line-height: 15px; align-self: baseline; text-overflow: ellipsis; white-space: nowrap;\r\n                                               max-width: 176px; padding-right: 1px; padding-left: 0px; margin-left: 3px; padding-bottom: 1px; user-select: text; overflow: hidden; flex: 4 1 176px;">{1}</div></div>\r\n                                     <div style="display: flex; margin-right: 9px; background-color: transparent; max-width: 213px; padding-top: 1px; padding-right: 1px; padding-bottom: 1px;\r\n                                               padding-left: 1px; user-select: text; border-width: 0px; border-style: initial; border-color: initial; border-image: initial;">\r\n                                     <div style="box-sizing: border-box; flex-grow: 1; overflow-y: hidden; position: relative; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 2px;\r\n                                               padding-right: 2px; padding-bottom: 2px; padding-left: 2px; font-family: inherit; font-size: 12px; font-weight: normal; line-height: 1.5; cursor: text; color: rgb(51, 51, 51);">\r\n                                     <p>{2}</p></div></div></div></div>\r\n                                     <div style="height: 1px; background-color: rgb(234, 234, 234);"></div></div>\r\n                                     <div style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; width: 1px; background-color: transparent; display: none; outline: none;"></div></div>',
2<e.length?e.substring(0,2):"G1",(new Date(b.Time.toString())).toLocaleString("en-US",{SJe:"long",yIe:"numeric",zIe:"numeric",RJe:"numeric"}).toString(),e);b.VersionElement=d;Array.add(a.QAd,b);b=[b,c];a.Fk.zA("click",d,a.mze,b);a.Od.zA("keydown",d,a.qgd,b);a.Od.zA("keypress",d,a.qgd,b);a.Od.zA("keyup",d,a.qgd,b);return d}
function wac_5vc(a){a.cNa&&a.cNa.style&&(a.cNa.style.width=wac_xk(document.getElementById("ViewHeader")).width+"px",a.cNa.style.height=window.parseInt(a.Rb.style.height)-wac_xk(document.getElementById("VersionHistoryViewContainer")).y-window.parseInt(a.cNa.style.marginBottom)+"px",a.HMa())}function wac_Xvc(a,b){this.aLe=Function.createDelegate(this,this.JNe);this.FAe=Function.createDelegate(this,this.JCe);this.Ia=a;this.vIe=b}
wac_Xvc.prototype={Ia:null,vIe:null,nze:null,Tb:function(){this.Ia.ja(466976539,2147483648,this.FAe);this.Ia.ja(3649559640,2147483648,this.aLe)},JCe:function(a,b,c){a=32;if(2===c)if(c=this.Ia.yw(3182458430,2,null),wac_b(39679138,202,50,"ShowVersionHistoryDialogAction: ProcessAction returns versionHistoryResponse {0}.",c),32!==c)a=8;else{this.nze=this.vIe.ma().Db();if(!this.nze)return wac_b(38908765,202,50,"VersionHistoryDialogActor:ShowVersionHistoryDialogAction - VersionHistoryDialogFactory should be initialized"),
8;wac_hvc("ShowVersionHistoryDialog");wac_b(39679139,202,50,"ShowVersionHistoryDialogAction: start to show dialog. StartTime: {0}.",new Date);this.KCe()}return a},JNe:function(a,b,c,d,e){if(2===c){a=this.nze;a.rDe.fd();a.oze.Ki();a.Xye.style.display="block";a.cze.style.display="block";wac_5vc(a);a.Pcd.hasChildNodes()?a.Pcd.replaceChild(wac_6vc(a,e.Versions[0],1<e.Versions.length?e.Versions[1]:null),a.Pcd.firstChild):a.Pcd.appendChild(wac_6vc(a,e.Versions[0],1<e.Versions.length?e.Versions[1]:null));
if(!(1>=e.Versions.length))for(b=1;b<e.Versions.length;b++)a.dze.appendChild(wac_6vc(a,e.Versions[b],e.Versions.length>b+1?e.Versions[b+1]:null));e=[e.Versions[0],1<e.Versions.length?e.Versions[1]:null];a.c2d.wCe(e[0],e[1])}return 32},KCe:function(){var a=this.nze;a.Hm("Version History",null);a.x2d=document.getElementById("versionhistoryviewpane");a.x2d.style.width="79%";a.x2d.style.position="relative";wac_Sqc(a.x2d,"left");a.x2d.style.marginTop="1%";a.CUc=document.getElementById("versionhistoryversionspane");
a.CUc.style.width="19%";wac_Sqc(a.CUc,"right");a.CUc.style.marginLeft="1%";a.CUc.style.marginTop="1%";a.cNa=document.createElement("div");a.cNa.id="VersionHistoryViewContainer";a.cNa.style.width="100%";a.cNa.style.height="100%";a.cNa.style.border="none";a.cNa.style.marginBottom="15px";a.cNa.tabIndex=-1;a.cNa.style.overflow="hidden";a.wIe=a.N4c("View",a.cNa,"View","ViewHeader","View",!0);a.x2d.appendChild(a.wIe);a.oze=new wac_2vc("VersionHistoryViewerSpinner");a.rDe=new wac_2vc("VersionHistoryPaneSpinner");
a.Pcd=document.createElement("div");a.Pcd.className="EmbedDimensionSection";a.oze.fd();a.CUc.appendChild(a.rDe.l2b);a.cNa.appendChild(a.oze.l2b);a.Xye=a.N4c("Current Version",a.Pcd,null,null,null,!1);a.CUc.appendChild(a.Xye);a.dze=document.createElement("div");a.cze=a.SBe("OlderVersions","Older Versions",a.dze);a.CUc.appendChild(a.cze);a.Xye.style.display="none";a.cze.style.display="none";a.Pda();a.c2d.Lye(a.cNa)}};function wac_Yvc(a){this.c2d=a;this._initialized=!1}
wac_Yvc.prototype={c2d:null,_initialized:!1,Yd:function(){this._initialized=!0},Db:function(){return this._initialized?new wac_3vc(this.c2d):null}};wac_Wvc.registerClass("Common.App.VersionHistory.PackageManager",null,wac_I,wac_i);(function(){}).registerClass("Common.App.VersionHistory.Program");wac_0vc.registerClass("Common.App.VersionHistory.VersionHistoryActor");wac_1vc.registerClass("Common.App.VersionHistory.SectionInfo");wac_2vc.registerClass("Common.App.VersionHistory.VersionHistorySpinner");
wac_3vc.registerClass("Common.App.VersionHistory.VersionHistoryDialog",wac__m,wac_Tvc);wac_Xvc.registerClass("Common.App.VersionHistory.VersionHistoryDialogActor",null,wac_Uvc);wac_Yvc.registerClass("Common.App.VersionHistory.VersionHistoryDialogFactory",null,wac_Vvc);(function(){}).registerClass("Common.App.VersionHistory.VersionHistoryDialogHtml");var wac_Zvc=null,wac_4vc="<div class='VersionHistoryDialog' id='versionhistorydialog'> <div class='VersionHistoryViewPane' id='versionhistoryviewpane'> </div> <div class='VersionHistoryVersionsPane' id='versionhistoryversionspane'> </div> </div>";
wac_J(wac_C(),new wac_Wvc,7,!1);Type.registerNamespace("Common.App.VersionHistory.VersionHistoryExecutor");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.p2b=wac_d.Qa.p2b||{};wac_d.Qa.p2b.LNe=wac_d.Qa.p2b.LNe||{};function wac_xvc(a,b){a=new Date(a.Time.toString());return new Date(b.Time.toString())-a}function wac_yvc(){}wac_yvc.prototype={xA:null,Py:null};
function wac_zvc(a,b){this.yKe=Function.createDelegate(this,this.YGe);this.zKe=Function.createDelegate(this,this.ZMe);this.DAe=Function.createDelegate(this,this.xCe);this.$g=a;this.Dc=b}function wac_Avc(){return new wac_zvc(new (wac_f.$$(wac_Wc))(function(){return wac_.Af}),new (wac_f.$$(wac_Uc))(function(){return wac_.pa}))}
wac_zvc.prototype={$g:null,Dc:null,tb:function(){},vNd:function(a){wac_Bvc=0;wac_Cvc(this,a,!0)},wye:function(){var a=(this.Dc.ma().Qb.VersionHistoryWebServiceBase||"")+"versions.ashx";return a=wac_Ml(a,"DocID",wac_Cf(wac_.eo),!1)},xCe:function(a){wac_b(38908766,202,50,"ExecuteVersionHistoryHandler:OnVersionHistorySuccess Time to get VersionList - {0}ms",new Date-wac_Dvc);var b;a:{var c=a.Aa.Be;try{var d=wac_yl(c);d.Versions.sort(wac_xvc);b=d;break a}catch(e){wac_b(38908771,202,10,"VersionHistoryResponseSerializeHelper:DeserializeResponse - Failed to deserialize the response - {0}",
c)}b=null}b.OperationResult=0;wac_hvc("LoadVersionListEnd");a.Aa.vl.xA(b)},ZMe:function(a){2!==a.Aa.Sd?(wac_hvc("LoadVersionListRetry"),wac_b(38908767,202,50,"ExecuteVersionHistoryHandler:OnVersionHistoryFailureRetry VersionHistory request failed. Retrying..."),wac_Cvc(this,a.Aa.vl,5>wac_Bvc)):(wac_hvc("LoadVersionListFailure"),this.YGe(a))},YGe:function(a){wac_b(38908768,202,50,"ExecuteVersionHistoryHandler:OnVersionHistoryFailureNoRetry VersionHistory failed second try");a.Aa.vl.Py(-1)},epb:function(){return this.$g.ma()}};
function wac_Cvc(a,b,c){var d=a.wye();wac_hvc("LoadVersionListStart");wac_Dvc=new Date;wac_Bvc++;a.epb().lk(d,1,"",{"Content-Type":"application/json; charset=utf-8","Cache-Control":"no-cache, no-store, must-revalidate"},!1,2,a.DAe,c?a.zKe:a.yKe,b,null,!1,null,null,null,null,!1,null,!1)}function wac_Evc(){this.cKe=Function.createDelegate(this,this.vNd);this.SB=Function.createDelegate(this,this.sC);this.ONe=wac_Fvc||(wac_Fvc=wac_Avc())}
wac_Evc.prototype={Ub:function(){return"Common.App.VersionHistory.VersionHistoryExecutor"},sa:null,gc:function(a){this.sa=a},tb:function(){wac_.pa.Ok(this.SB)},sC:function(){wac_Rqc()?(wac_b(38908770,202,50,"VersionHistoryRequestExecutorPackageManager:OnFullAppSettingsReady - Initializing the VersionHistoryRequestExecutor package"),(wac_Fvc||(wac_Fvc=wac_Avc())).tb(),wac_.vNd=this.cKe):wac_b(38908769,202,50,"VersionHistoryRequestExecutorPackageManager:OnFullAppSettingsReady - Not initializing the VersionHistoryRequestExecutor package because the feature is disabled.")},
vNd:function(a,b){var c=new wac_yvc;c.xA=a;c.Py=b;this.ONe.vNd(c)},O:function(){}};(function(){}).registerClass("Common.App.VersionHistory.VersionHistoryExecutor.VersionHistoryResponseSerializeHelper");wac_yvc.registerClass("Common.App.VersionHistory.VersionHistoryExecutor.ExecuteVersionHistoryData");wac_zvc.registerClass("Common.App.VersionHistory.VersionHistoryExecutor.ExecuteVersionHistoryHandler");
wac_Evc.registerClass("Common.App.VersionHistory.VersionHistoryExecutor.PackageManager",null,wac_I,wac_i);(function(){}).registerClass("Common.App.VersionHistory.VersionHistoryExecutor.Program");var wac_Fvc=null,wac_Dvc=null,wac_Bvc=0;wac_J(wac_C(),new wac_Evc,0,!1);Type.registerNamespace("Common.App.WopiIdentity");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.WGa=wac_d.Qa.WGa||{};wac_d.Qa.WGa.mlb=function(){};
wac_d.Qa.WGa.mlb.prototype={generalException:0,invalidArgument:1,notAllowed:2,apiNotAvailable:3,unresolvedPendingRequest:4,timeout:5,adalTimeout:6,userNotSignedIn:7,userAborted:8,silentSignInFailed:9,invalidResourceUrl:10,invalidGrant:11,connectionLost:12,clientError:13,serverError:14};wac_d.Qa.WGa.mlb.registerEnum("Common.App.WopiIdentity.ErrorCodes",!1);function wac_fHc(){}wac_fHc.registerInterface("Common.App.WopiIdentity.IWopiAuthContext");function wac_inc(){}wac_inc.registerInterface("Common.App.WopiIdentity.IWopiIdentityInfo");
function wac_jnc(){}wac_jnc.registerInterface("Common.App.WopiIdentity.IWopiIdentity");function wac_knc(){}wac_knc.registerInterface("Common.App.WopiIdentity.IWopiIdentityToken");function wac_lnc(){}wac_lnc.registerInterface("Common.App.WopiIdentity.ITokenRequestParameters");function wac_c$(){this.MOb=this.gbe=this.fbe="";this.mYd=0;this.DLe="";this.dmc=!0}wac_c$.prototype={fbe:null,gbe:null,MOb:null,mYd:0,DLe:null,dmc:!1};wac_c$.prototype.F1e=function(){return this.fbe};
wac_c$.prototype.get_upn=wac_c$.prototype.F1e;wac_c$.prototype.V1e=function(a){return this.fbe=a};wac_c$.prototype.set_upn=wac_c$.prototype.V1e;wac_c$.prototype.G1e=function(){return this.gbe};wac_c$.prototype.get_userId=wac_c$.prototype.G1e;wac_c$.prototype.W1e=function(a){return this.gbe=a};wac_c$.prototype.set_userId=wac_c$.prototype.W1e;wac_c$.prototype.zke=function(){return this.MOb};wac_c$.prototype.get_authority=wac_c$.prototype.zke;wac_c$.prototype.Ble=function(a){return this.MOb=a};
wac_c$.prototype.set_authority=wac_c$.prototype.Ble;wac_c$.prototype.C1e=function(){return this.mYd};wac_c$.prototype.get_authorityType=wac_c$.prototype.C1e;wac_c$.prototype.S1e=function(a){return this.mYd=a};wac_c$.prototype.set_authorityType=wac_c$.prototype.S1e;wac_c$.prototype.E1e=function(){return this.DLe};wac_c$.prototype.get_tenantId=wac_c$.prototype.E1e;wac_c$.prototype.U1e=function(a){return this.DLe=a};wac_c$.prototype.set_tenantId=wac_c$.prototype.U1e;wac_c$.prototype.D1e=function(){return this.dmc};
wac_c$.prototype.get_isAnonymous=wac_c$.prototype.D1e;wac_c$.prototype.T1e=function(a){return this.dmc=a};wac_c$.prototype.set_isAnonymous=wac_c$.prototype.T1e;function wac_k9(){this.MOb=this.wI=this.dG=""}wac_k9.prototype={dG:null,wI:null,MOb:null};wac_k9.prototype.Dwe=function(){return this.dG};wac_k9.prototype.get_displayName=wac_k9.prototype.Dwe;wac_k9.prototype.$we=function(a){return this.dG=a};wac_k9.prototype.set_displayName=wac_k9.prototype.$we;wac_k9.prototype.Ewe=function(){return this.wI};
wac_k9.prototype.get_email=wac_k9.prototype.Ewe;wac_k9.prototype.axe=function(a){return this.wI=a};wac_k9.prototype.set_email=wac_k9.prototype.axe;wac_k9.prototype.zke=function(){return this.MOb};wac_k9.prototype.get_authority=wac_k9.prototype.zke;wac_k9.prototype.Ble=function(a){return this.MOb=a};wac_k9.prototype.set_authority=wac_k9.prototype.Ble;function wac_q9(a,b,c){this.gjc=a;this.MOb=b;this.Xge=c}wac_q9.prototype={gjc:null,MOb:null,Xge:null};wac_q9.prototype.Cwe=function(){return this.gjc};
wac_q9.prototype.get_accessToken=wac_q9.prototype.Cwe;wac_q9.prototype.Zwe=function(a){return this.gjc=a};wac_q9.prototype.set_accessToken=wac_q9.prototype.Zwe;wac_q9.prototype.zke=function(){return this.MOb};wac_q9.prototype.get_authority=wac_q9.prototype.zke;wac_q9.prototype.Ble=function(a){return this.MOb=a};wac_q9.prototype.set_authority=wac_q9.prototype.Ble;wac_q9.prototype.Fwe=function(){return this.Xge};wac_q9.prototype.get_expiration=wac_q9.prototype.Fwe;
wac_q9.prototype.bxe=function(a){return this.Xge=a};wac_q9.prototype.set_expiration=wac_q9.prototype.bxe;function wac_69(a,b){wac_69.fwe===Number||Type.isEnum(wac_69.fwe);this.Ghe=a;this.Mne=b}
wac_69.$$=function(a){var b=wac_d.Qa.WGa.__tc=wac_d.Qa.WGa.__tc||{},c="OutstandingRequest$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_69.apply(this,a)};d.registerClass("Common.App.WopiIdentity.__tc."+c);d.prototype.jb={"Common.App.WopiIdentity.OutstandingRequest$1":{T:a},ctor:wac_69};a=wac_69.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};
wac_69.prototype={Ghe:null};wac_69.prototype.Iwe=function(){return this.Ghe};wac_69.prototype.get_requestParameters=wac_69.prototype.Iwe;wac_69.prototype.exe=function(a){return this.Ghe=a};wac_69.prototype.set_requestParameters=wac_69.prototype.exe;wac_69.prototype.Hwe=function(){return this.Mne};wac_69.prototype.get_requestCallback=wac_69.prototype.Hwe;wac_69.prototype.dxe=function(a){return this.Mne=a};wac_69.prototype.set_requestCallback=wac_69.prototype.dxe;
function wac_O$(a){this.rjd=Function.createDelegate(this,this.jSd);this.getAccessToken=this.GetAccessToken;this.getAuthContext=this.GetAuthContext;this.getAuthContextSync=this.GetAuthContextSync;this.getPrimaryIdentityInfo=this.GetPrimaryIdentityInfo;this.$1a={};this.lOb={};this.Lbc=wac_r().Bz();this.yrc=a;this.yrc.bQb("PostAccessToken");this.yrc.UVd("PostAccessToken",this.rjd)}
wac_O$.prototype={yrc:null,$1a:null,lOb:null,Lbc:null,jSd:function(a){var b=null;try{var c=a.Values.SsoRequestId||a.Values.AddinControlId,d=a.Values.SsoAccessToken||a.Values.AccessToken,e;if(!(e=a.Values.SsoAuthority))a:switch(a.Values.HostApplicationType){case "OneDriveWOPI":e="MicrosoftAccount";break a;default:e="AzureActiveDirectoryAccount"}var f=e,g=a.Values.SsoTokenExpiration||new Date((new Date).getTime()+51E5),h=e=null,k=this.$1a[c];"undefined"!==typeof k&&k?(b=k.get_requestCallback(),delete this.$1a[c],
"undefined"!==typeof d&&d&&d.length?h=new wac_q9(d,f,g):e=wac_d.Qa.WGa.mlb.toString(wac_9uc(this,a)),c="getAccessToken_"+c,c in this.lOb&&(this.lOb[c].vg(),delete this.lOb[c]),b(h,e)):wac_b(37856066,344,10,wac_ai({error:"No matching outstanding request for request ID.",requestId:c}))}catch(l){c=a.Values.SsoRequestId||a.Values.AddinControlId,c in this.$1a&&delete this.$1a[c],this.j5c(),wac_b(37856067,344,10,wac_ai({error:l.message,stack:l.stack})),b&&b(null,wac_d.Qa.WGa.mlb.toString(0))}},j5c:function(){wac_b(39068822,
344,50,wac_ai({userAgent:window.navigator.userAgent}))}};function wac_$uc(a,b){a=a.get_resource();a=(a?a:"").replace("://","__").replace(/\./g,"_dot_").replace("/","\\");wac_b(39921882,344,50,wac_ai({callerId:b,resource:a}))}
function wac_9uc(a,b){var c=b.Values.SsoError||b.Values.AddinSSOError;b=b.Values.HostApplicationType;a.j5c();wac_b(39068821,344,10,wac_ai({error:c,wopiHost:b}));return-1<c.indexOf("AADSTS50058")?9:-1<c.indexOf("Popup Window is null")||-1<c.indexOf("Popup Window closed")?12:-1<c.indexOf("AADSTS50001")?10:-1<c.indexOf("13002")?8:-1<c.indexOf("AADSTS70011")||-1<c.indexOf("AADSTS65001")?11:-1<c.indexOf("Token renewal operation failed due to timeout")?6:0}
function wac_onc(a){var b=wac_4Fa;a=a.toLowerCase();for(var c=b.length,d=0;d<c;++d){var e=b[d];if(a===e.toLowerCase())return!0}var b=wac_xdb,f;for(f in b)if(e={key:f,value:b[f]},a===e.value.toLowerCase())return!0;f=wac_Jeb;for(var g in f)if(e={key:g,value:f[g]},a===e.value.toLowerCase())return!0;return!1}
function wac_pnc(a){var b=wac_.pa.Qb.UserName,c=wac_.pa.Qb.LoggableUserIdSpace,d=new wac_k9;d.wI=wac_.pa.Qb.UserPrincipalName;d.dG=b;switch(c){case "OrgIdPuid":d.MOb="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":d.MOb="MicrosoftAccount";break;default:d.MOb=c}a(d,null)}
function wac_qnc(a,b,c){var d=wac_bl().yQ.toString(),e="getAccessToken_"+d,f=a.Lbc.uj("ComponentAttach",e);a.lOb[e]=f;e={};f=b.get_options()&&"undefined"!==typeof b.get_options()?b.get_options():{};e.SsoRequestId=d;e.SsoResource=b.get_resource();e.SsoScope=b.get_scope();e.SsoSilentLogin=b.get_silentLogin();e.SsoOptions=b.get_options();e.AddinControlId=d;e.AddinApplicationResource=b.get_resource();e.AddinSSOAuthChallenge=f.authChallenge||"";e.AddinIsFirstParty=!0;a.yrc.Dx("GetAccessToken",e,"");a.$1a[d]=
new (wac_69.$$(Function))(b,c)}
wac_O$.prototype.nie=function(a,b){wac_$uc(a,b);var c=this;return new Promise(function(d,e){-1<wac_Jh(wac_.pa.Qb.PostMessageOrigin,1).toLowerCase().indexOf(".spoppe.com")?e(wac_d.Qa.WGa.mlb.toString(3)):wac_onc(b)?b in c.$1a?e(wac_d.Qa.WGa.mlb.toString(4)):(window.setTimeout(function(){wac_b(37856032,344,10,wac_ai({error:"Request timeout.",callerId:b}));e(wac_d.Qa.WGa.mlb.toString(5))},12E4),wac_qnc(c,a,function(a,b){a?d(a):(wac_b(37856033,369,10,wac_ai({error:wac_d.Qa.WGa.mlb.toString(b)})),e(b))})):
(wac_b(37856034,344,10,wac_ai({error:"Caller is not allowed."})),e(wac_d.Qa.WGa.mlb.toString(2)))})};wac_O$.prototype.GetAccessToken=wac_O$.prototype.nie;wac_O$.prototype.uue=function(a){return new Promise(function(b,c){wac_onc(a)?wac_pnc(function(a,e){a?b(a):(wac_b(37856064,369,10,wac_ai({error:e.toString()})),c(e))}):(wac_b(37856065,344,10,wac_ai({error:"Caller is not allowed."})),c(wac_d.Qa.WGa.mlb.toString(2)))})};wac_O$.prototype.GetPrimaryIdentityInfo=wac_O$.prototype.uue;
wac_O$.prototype.B_e=function(a){var b=this;return new Promise(function(c,d){var e=b.GetAuthContextSync(a);e?c(e):d(wac_d.Qa.WGa.mlb.toString(2))})};wac_O$.prototype.GetAuthContext=wac_O$.prototype.B_e;
wac_O$.prototype.C_e=function(a){if(wac_onc(a)){a=new wac_c$;a.fbe=wac_.pa.Qb.UserPrincipalName;a.gbe=wac_.pa.Qb.LoggableUserId;a.MOb=wac_.pa.Qb.HostAuthAuthority;a.DLe=wac_.pa.Qb.TenantId;a.dmc=wac_q(wac_.pa,"IsAnonymousUser");var b=wac_.pa.Qb.HostAuthType;a.mYd="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return a}wac_b(40751647,344,10,wac_ai({error:"Caller is not allowed."}));return null};wac_O$.prototype.GetAuthContextSync=wac_O$.prototype.C_e;function wac_rnc(){}
wac_rnc.prototype={Ub:function(){return"Common.App.WopiIdentity"},gc:function(a){wac_m(wac_n(wac_o(a.fa(wac_O$),wac_jnc)),function(){return new wac_O$(a.H(wac_2a))})},tb:function(){},O:function(){}};wac_c$.registerClass("Common.App.WopiIdentity.WopiAuthContext",null,wac_fHc);wac_k9.registerClass("Common.App.WopiIdentity.WopiIdentityInfo",null,wac_inc);wac_q9.registerClass("Common.App.WopiIdentity.WopiIdentityToken",null,wac_knc);
wac_O$.registerClass("Common.App.WopiIdentity.WopiIdentityManager",null,wac_jnc);wac_rnc.registerClass("Common.App.WopiIdentity.WopiIdentityPackage",null,wac_I,wac_i);wac_J(wac_C(),new wac_rnc,0,!1);Type.registerNamespace("BasicChat");function wac_sMb(){}wac_sMb.registerInterface("BasicChat.IBasicChatActor");function wac_tMb(){}wac_tMb.registerInterface("BasicChat.ISkypeWebExperienceController");function wac_uMb(){}wac_uMb.prototype={implicitOAuth:1,password:2,token:3,anonymous:4};
wac_uMb.registerEnum("BasicChat.SkypeAuthMethods",!1);function wac_vMb(){}wac_vMb.registerInterface("BasicChat.IChatToast");function wac_wMb(){}wac_wMb.registerInterface("BasicChat.IChatToastFactory");function wac_xMb(a,b,c,d){this.hfd=Function.createDelegate(this,this.ONd);this.Ra=new wac_Re;this.oHc=b;this.NRc=c;this.Dc=a;this.Pc=d}
wac_xMb.prototype={oHc:null,NRc:null,Dc:null,FXb:null,Pc:null,M9:function(a){this.Ra.xa("ACEK",a)},Db:function(a){if(a&&wac_83){if(this.FXb){var b=this;this.Pc.Hb(new wac_D(0,1,0,function(){a(b.Ra,b.FXb)},115,null,!1))}this.M9(a);return wac_83}(wac_83=this.oHc())||(wac_83=this.NRc());wac_83.M9(this.hfd);a&&this.M9(a);return wac_83},ONd:function(a,b){this.FXb=b;this.Ra.wa("ACEK",b,null)}};
function wac_93(a,b){this.hdc=Function.createDelegate(this,this.gJd);this.Jcc=Function.createDelegate(this,this.Jwc);this.Ra=new wac_Re;this.aqa=new (wac_Rb.$$(Boolean));this.dispose=this.O;this.YUa=a;this.jW=b;wac_yMb(this,0)}
wac_93.prototype={YUa:null,jW:null,zp:null,xra:null,az:0,pHc:0,fBa:null,Ooa:null,L2b:function(){return wac_sP(String,wac_.Ag)},R9:function(){return!!this.zp&&this.zp.Cg()},GIa:function(a){this.zp?this.zp.Cg()!==a&&(this.zp.te(a),this.Ra.wa("PSCH",new wac_Nm(a?1:0),null)):a&&wac_b(8782405,333,15,"Trying to set visible while flexpane is null");return a},M9:function(a){this.Ra.xa("cam",a)},yZa:function(a){this.Ra.xa("PSCH",a)},AZa:function(a){this.Ra.xa("unreadConvEventKey",a)},tb:function(){if(!this.zp){this.zp=
this.YUa.Db("Mock Chat Pane",null,null,3476734992);var a=document.createElement("div");a.innerText="Notification types: unreadmessage | chat | contactrequest | audio\n\n";a.innerText+="Type in the mock notif type:\n";this.zp.Nc().appendChild(a);this.xra=document.createElement("input");this.xra.setAttribute("type","text");this.xra.setAttribute("data-lpignore","true");this.xra.style.width="100px";this.xra.style.display="block";this.zp.Nc().appendChild(this.xra);a=document.createElement("div");a.innerText=
"\n";this.zp.Nc().appendChild(a);this.fBa=document.createElement("button");this.fBa.id="chatNotif";this.fBa.innerText="Send Chat Notification";this.zp.Nc().appendChild(this.fBa);window.$addHandler(this.fBa,"mousedown",this.Jcc);this.zp.Nc().appendChild(a);this.Ooa=document.createElement("input");this.Ooa.id="hideThenChatNotif";this.Ooa.type="button";this.Ooa.value="Dismiss then Send Chat Notif";this.zp.Nc().appendChild(this.Ooa);window.$addHandler(this.Ooa,"mousedown",this.hdc)}wac_yMb(this,2);this.Ra.wa("cam",
new wac_Lm(2),null);this.aqa.Ze(!0);return this.aqa.oj()},HV:function(){this.GIa(!0);this.R9()||this.GIa(!0)},gJd:function(a){this.A_();var b=this;window.setTimeout(function(){b.Jwc(null)},0);a.stopPropagation()},Jwc:function(a){a.stopPropagation();a=wac_zMb(this.xra.value);var b,c=this,d=this,e=this,f=this,g=this,h=this;a=(b=new wac_Mm,b.Fg=a,b.Ixb=null,b.dG="mock name",b.Wka=null,b.Nl="mock title",b.fA="mock description",b.bxb=function(){c.HV();c.Q_("notification accepted")},b.G5a=function(a){d.HV();
d.Q_("notification accepted with "+a)},b.wBb=function(){e.HV();e.Q_("notification opened")},b.myb=function(){f.Q_("notification declined")},b.fwa=function(){g.Q_("notification sound played")},b.m8a=function(){h.Q_("notification sound stopped")},b.eDb=function(){},b.IZ=1===a?0:2,b);wac_AMb(this.jW,this,a)},A_:function(){this.GIa(!1)},Iya:function(a,b){this.Q_(String.format("Trying to join conversation {0}",a));"mockChatThread"===a&&b()},Gy:function(a){a?(this.pHc=this.az,wac_yMb(this,3),this.A_()):
3===this.az&&wac_yMb(this,this.pHc)},Q_:function(a){if(this.zp&&this.zp.Nc()){var b=document.createElement("div");b.innerText=a+"\n";this.zp.Nc().appendChild(b)}else window.alert(String.format("Mock Chat Client: {0}",a))},O:function(){this.zp&&(this.A_(),window.$removeHandler(this.fBa,"mousedown",this.Jcc),window.$removeHandler(this.Ooa,"mousedown",this.hdc),this.zp=null);this.jW&&(this.jW.dispose(),this.jW=null)}};function wac_yMb(a,b){a.az!==b&&(a.az=b,a.Ra.wa("cam",new wac_Lm(a.az),null))}
function wac_BMb(){}
wac_BMb.prototype={sa:null,dB:null,Ub:function(){return"Common.App.BasicChat"},tb:function(){var a=this;wac_Ed().WSb.oj().CW(function(){wac_.pa.Ok(function(){wac_CMb(a)})})},O:function(){},gc:function(a){this.sa=a;var b=this;wac_m(wac_o(wac_o(wac_n(this.sa.fa(wac_$3)),wac_tMb),wac_Im),function(){return new wac_$3(wac_.pa,wac_l(b.sa,wac_qma))});wac_m(wac_n(this.sa.fa(wac_a4)),function(){return new wac_a4(wac_r().Bz())});wac_m(wac_n(wac_o(this.sa.fa(wac_DMb),wac_qc)),function(){return new wac_DMb(new (wac_f.$$(wac_6c))(function(){return wac_Ie()}),new (wac_f.$$(wac_5c))(function(){return wac_r().JK()}),
new (wac_f.$$(wac_Hk))(function(){return wac_4f()}),new (wac_f.$$(wac_Ok))(function(){return wac_5f()}),new (wac_f.$$(wac_8c))(function(){return wac_6f()}),new (wac_f.$$(wac_ad))(function(){return wac_3f()}),new (wac_f.$$(wac_gc))(function(){return wac_r()}))});wac_n(this.sa.fa(wac_EMb));var c=this;wac_m(wac_n(this.sa.fa(wac_b4)),function(){return new wac_b4(wac_r().Hd(),wac_.pa,c.sa.H(wac_qc),c.sa.H(wac_EMb),c.sa.H(wac_tMb),c.sa.H(wac_a4),c.sa.H(wac_Km))});var d=this;wac_m(wac_n(this.sa.fa(wac_93)),
function(){var a=d.sa.H(wac_qc),b=d.sa.H(wac_Km);return 3===wac_Lg(wac_.pa,"SkypeExperience",0)?new wac_93(a,b):null});var e=this;wac_m(wac_n(this.sa.fa(wac_Jm)),function(){return new wac_xMb(wac_.pa,function(){return e.sa.H(wac_93)},function(){return e.sa.H(wac_b4)},wac_p())});var f=this;wac_m(wac_n(this.sa.fa(wac_sMb)),function(){return new wac_FMb(wac_z(),f.sa.H(wac_Jm),wac_rP(wac_SP,wac_l(f.sa,wac_SP)),f.sa.H(wac_a4),wac_Sg,wac_.pa)});wac_m(wac_n(this.sa.fa(wac_wMb)),function(){return new wac_GMb(wac_6f())});
var g=this;wac_m(wac_n(this.sa.fa(wac_Km)),function(){return new wac_HMb(function(){return wac_r().Nc().parentNode},g.sa.H(wac_wMb))})}};function wac_CMb(a){a.dB=a.sa.H(wac_a4);wac_IMb(a.dB).Wd();wac_JMb(a.dB).Wd();var b=wac_c4(a.sa.H(wac_Im));b.CW(function(){var c=wac_Qb(b);c.uka?(a.sa.H(wac_Jm),a.sa.H(wac_sMb).Yd()):c.gva&&a.sa.H(wac_Jm)})}
function wac_FMb(a,b,c,d,e,f){this.IJa=Function.createDelegate(this,this.LQa);this.awb=Function.createDelegate(this,this.MMb);this.ksd=Function.createDelegate(this,this.T3d);this.ghc=Function.createDelegate(this,this.mVd);this.fhc=Function.createDelegate(this,this.eBc);this.dispose=this.O;this.Ia=a;this.HTa=b;this.SVb=c;this.dB=d;this.iXa=e;this.Dc=f}
wac_FMb.prototype={Ia:null,DC:null,HTa:null,SVb:null,kz:null,dB:null,iXa:null,Dc:null,om:!1,r1b:0,iEa:null,$Da:null,Yd:function(){this.Tb();wac_KMb(this);var a=this;this.iXa(function(){a.O()})},eBc:function(){var a;(a=this.kz.Usc)?(this.iEa=wac_LMb(this,a,wac_TP.Ofb),this.$Da=wac_LMb(this,a,wac_TP.HPb),wac_IMb(this.dB)&&wac_IMb(this.dB).vg(),a=!!this.iEa||!!this.$Da):a=!1;a&&this.DC.Gy(!1)},mVd:function(){this.$Da=this.iEa=null;this.DC.Gy(!0)},Tb:function(){this.Ia.ja(3476734992,2147483648,this.ksd)},
MMb:function(){wac_MMb(this,this.iEa);wac_MMb(this,this.$Da)},LQa:function(a,b){a=b.zDb;a!==this.r1b&&(wac_NMb(this.iEa,a),wac_NMb(this.$Da,a),this.r1b=a)},T3d:function(a,b,c){if(this.om||2!==c)return 32;this.DC.R9()?this.A_():this.HV();return 32},HV:function(){this.DC.HV()},A_:function(){this.DC.A_()},O:function(){this.om||(this.kz&&(this.kz.Ra.sb("OnTopRowControlsCreatedEvent",this.fhc),this.kz.Ra.sb("OnTopRowControlsDisposingEvent",this.ghc),this.kz=null),this.DC&&(this.DC.dispose(),this.DC=null),
this.Ia=this.$Da=this.iEa=null,this.om=!0)}};function wac_NMb(a,b){if(a&&(b+=0,a=a.querySelector(".SkypeUnreadConversationsBubble")))if(0>=b)a.style.display="none",a.innerText="";else{var c=99<b;b=b.toString();c?(b="99+",Sys.UI.DomElement.containsCssClass(a,"SkypeUCBWide")||Sys.UI.DomElement.addCssClass(a,"SkypeUCBWide")):Sys.UI.DomElement.containsCssClass(a,"SkypeUCBWide")&&Sys.UI.DomElement.removeCssClass(a,"SkypeUCBWide");a.innerText=b;a.style.display=""}}
function wac_MMb(a,b){if(b){var c=b.querySelector("img");if(c){var d,e="";c.getAttribute("class")&&(d=c.getAttribute("class").toString(),0<d.indexOf("WACSkypeButtonBlack_20x20x32")?e=d.replace("WACSkypeButtonBlack_20x20x32","WACSkypeButtonWhite_20x20x32"):0<d.indexOf("WACSkypeButtonWhite_20x20x32")?e=d.replace("WACSkypeButtonWhite_20x20x32","WACSkypeButtonBlack_20x20x32"):0<d.indexOf("WACSkypeBusinessButtonBlack_20x20x32")?e=d.replace("WACSkypeBusinessButtonBlack_20x20x32","WACSkypeBusinessButtonWhite_20x20x32"):
0<d.indexOf("WACSkypeBusinessButtonWhite_20x20x32")&&(e=d.replace("WACSkypeBusinessButtonWhite_20x20x32","WACSkypeBusinessButtonBlack_20x20x32")),e.length&&c.setAttribute("class",e),wac_q(a.Dc,"PeoplesWellExtraButtonInfoIsEnabled")||(Sys.UI.DomElement.containsCssClass(b,"activated")?Sys.UI.DomElement.removeCssClass(b,"activated"):Sys.UI.DomElement.addCssClass(b,"activated")))}}}
function wac_KMb(a){a.DC=a.HTa.Db(null);a.DC.yZa(a.awb);var b=a.DC.tb();b.CW(function(){wac_OMb(a,wac_Qb(b))});a.DC.AZa(a.IJa)}function wac_LMb(a,b,c){var d=null;if(c){try{d=wac_xS(b,c,wac_TP.nEc)}catch(e){wac_b(18465952,333,10,"Couldn't find the button. Basic Chat will be disabled, message: {0} Callstack: {1}.",e.message,e.stack)}d&&(b.Qy(c),d.style.display="",wac_NMb(d,a.r1b))}return d}
function wac_OMb(a,b){b&&a.SVb.CW(function(){a.kz=wac_Qb(a.SVb);a.kz.y8a&&a.eBc(null,null);wac__5a(a.kz,a.fhc);a.kz.Ra.xa("OnTopRowControlsDisposingEvent",a.ghc)})}function wac_a4(a){this.Tf=a}wac_a4.prototype={Tf:null,mHc:null,nHc:null,rHc:null,RSc:null};function wac_IMb(a){return a.RSc||(a.RSc=a.Tf.S_("CommandTask","SkypeUserExperienceLoad"))}function wac_JMb(a){return a.rHc||(a.rHc=a.Tf.S_("CommandTask","SkypeBasicChatTimeToChattable"))}
function wac_PMb(a){return a.nHc||(a.nHc=a.Tf.S_("LoadResource","SkypeBasicChatClientLoad"))}function wac_QMb(a){return a.mHc||(a.mHc=a.Tf.S_("WebServiceCall","SkypeBasicChatClientAuth"))}function wac_RMb(a){this.qwa=a;this.VSb=!wac_q(this.qwa,"HeaderInsideRibbonIsEnabled");this.Kxb=wac_q(this.qwa,"SkypeAutomationModeIsEnabled")||wac_q(this.qwa,"BasicChatIsEnabled")&&!wac_q(this.qwa,"ReactSharedHeaderIsEnabled");this.wW=wac_Lg(this.qwa,"SkypeExperience",0)}
wac_RMb.prototype={Ehb:null,VSb:!1,wW:0,qwa:null,Kxb:!1,xZ:null};function wac_SMb(a){a.xZ||(a.xZ=new (wac_Rb.$$(Boolean)),a.VSb&&a.Kxb?wac_TMb(a):a.xZ.Ze(!1))}function wac_UMb(a){a.Ehb||(a.Ehb=new (wac_Rb.$$(wac_6la)),wac_SMb(a),a.xZ.oj().CW(function(){var b=wac_Qb(a.xZ.oj()),c;if(c=!b)if(c=a.VSb)a.CWb.ma()?(c=wac_q(a.qwa,"DocChatIsEnabled"),c=!a.Kxb&&c&&(2===a.wW||3===a.wW)):c=!1;a.Ehb.Ze(new wac_6la(b,c))}))}function wac_c4(a){wac_UMb(a);return a.Ehb.oj()}
function wac_VMb(a,b,c,d,e,f,g,h,k,l,m){this.Tle=Function.createDelegate(this,this.sve);this.cJa=Function.createDelegate(this,this.fd);this.dispose=this.O;this.nd=a;this.sN=b;this.dF=c;this.BSc=d;this.wg=e;this.Od=f;this.jn=g;this.sa=g.Nc().parentNode;this.mTa=g.Nc();this.fga=k;this.dga=l;this.qJc=m;this.eVb=wac_A(27,0);this.fce=wac_q(wac_.pa,"PeoplesWellExtraButtonInfoIsEnabled")&&!!wac_r()&&wac_r().Hd().Bg();this.Wc||(a=!!wac_r()&&wac_r().Hd().iO(),this.fce&&(this.fee=document.createElement("div"),
this.fee.className="cui-flexpane"),this.Wc=document.createElement("div"),this.Wc.id="FlexPane",this.Wc.className="FlexPane"+(a?" FlexBoxLayout":""),this.Wc.style.display="none",this.Wc.setAttribute("tabindex",0),wac_Fe(this.Wc,"role","region"),wac_Fe(this.Wc,"aria-label",h),this.fce&&(this.Wye=document.createElement("span"),this.Wye.className="cui-taskPaneTitle",this.Wye.innerText=CommonUIStrings.l_ChatTooltip,this.dW=document.createElement("a"),this.dW.tabIndex=0,this.dW.className="cui-taskPaneClose cui-ctl",
this.dW.title=CommonUIStrings.l_DialogClose,this.dW.style.position="absolute",this.dW.style.right="0px",this.dW.setAttribute("role","button"),this.wg.ya("click",this.dW,this.cJa),this.Od.ya("keyup",this.dW,this.Tle),this.iH=document.createElement("span"),this.iH.className="cui-taskPaneCloseButton cui-ctl-iconContainer",this.dpe=wac_4h(16,16,"ClosePaneGlyph_16x16x32","",""),this.iH.appendChild(this.dpe),this.dW.appendChild(this.iH),this.gte=document.createElement("div"),this.gte.className="cui-flexPaneTitle",
this.gte.appendChild(this.Wye),this.gte.appendChild(this.dW),this.fee.appendChild(this.gte)),a?this.fce?(this.Wc.style.height="100%",this.fee.appendChild(this.Wc),this.mTa.parentNode.appendChild(this.fee)):this.mTa.parentNode.appendChild(this.Wc):this.sa.insertBefore(this.Wc,this.mTa),this.Nca())}
wac_VMb.prototype={Hpa:null,nd:null,sN:null,dF:null,BSc:null,wg:null,Od:null,jn:null,sa:null,mTa:null,fga:null,dga:null,qJc:0,Sh:!1,eVb:null,fce:!1,dpe:null,iH:null,dW:null,gte:null,fee:null,Wye:null,Cg:function(){return this.Sh},te:function(a){if(a===this.Sh)return a;this.BRb(a);return this.Sh=a},Wc:null,Nc:function(){return this.Wc},sve:function(a){a=a.fb.keyCode;return 13===a||32===a?(this.te(!1),!0):!1},fd:function(){wac_b(40969411,333,50,"Chat pane closed with X");this.te(!1);return!0},BRb:function(a){a?
(this.Wc.style.display="block",this.fce&&(this.fee.style.display="flex"),Sys.UI.DomElement.addCssClass(this.mTa,"FlexPaneUp"),wac_2j(this.sN,"FlexPane"),wac_wg(this.nd,"FlexPane",!0)):(this.Wc.style.display="none",this.fce&&(this.fee.style.display="none"),Sys.UI.DomElement.removeCssClass(this.mTa,"FlexPaneUp"),wac_3j(this.sN,"FlexPane"),wac_ng(this.nd,"FlexPane",!0));this.jn.nab();wac_r()&&wac_r().Hd().Bg()&&window.document.dispatchEvent&&(a=null,window.document.createEvent&&(a=window.document.createEvent("UIEvents"),
a.initUIEvent("resize",!0,!0,wac_O3a(window.document),0)),a&&window.document.dispatchEvent(a))},Nca:function(){if(!this.Hpa){this.Hpa=this.nd.xc("FlexPane");this.Hpa.re="main";var a=this;wac_pk(this.Hpa,function(){wac_Vj(a.Wc);a.fga&&a.fga()});if(this.dga){var b=this;wac_ok(this.Hpa,function(){b.dga()})}this.Hpa.Ba(this.eVb,this.qJc);this.dF.b5("FlexPane",this.Wc,!1,!0);this.BSc.b5("FlexPane",this.Wc,!1,!0);wac_1j(this.sN,"FlexPane")}},O:function(){this.sa.removeChild(this.Wc);this.jn=this.Wc=null;
wac_jk(this.Hpa,this.eVb);wac_q(wac_.pa,"PeoplesWellExtraButtonInfoIsEnabled")&&(this.wg.ub("click",this.dW,this.cJa),this.Od.ub("keyup",this.dW,this.Tle))}};function wac_DMb(a,b,c,d,e,f,g){this.RJc=a;this.xJc=b;this.SNc=c;this.CSc=d;this.cpe=e;this.upe=f;this.rGc=g}wac_DMb.prototype={rGc:null,RJc:null,xJc:null,SNc:null,CSc:null,cpe:null,upe:null,Db:function(a,b,c,d){return new wac_VMb(this.RJc.ma(),this.xJc.ma(),this.SNc.ma(),this.CSc.ma(),this.cpe.ma(),this.upe.ma(),this.rGc.ma(),a,b,c,d)}};
function wac_WMb(a){this.kZ=a;this.qbc=this.kZ.me;this.a2b=this.kZ.activity}
wac_WMb.prototype={qbc:null,a2b:null,kZ:null,l_a:function(){this.qbc||wac_b(17105566,333,10,"Skype Native Contact ME is null.");return this.qbc},rJb:function(){try{return this.kZ.isAvailable()}catch(a){return wac_b(17440901,333,10,"Skype IsAvailable error. Message: {0}, Callstack: {1}",a.message,a.stack),!1}},Iya:function(a,b,c){try{wac_b(9209431,333,50,"Joining Conversation"),this.kZ.joinConversation(a,["Chat"],b,function(a){wac_b(9209432,333,10,"JoinConversation Failed. Error: {0}",a);c()})}catch(d){wac_b(8913495,
333,10,"Skype join request error. Message: {0}, Callstack: {1}",d.message,d.stack),c()}},zw:function(a){try{this.kZ.setFocus(a)}catch(b){wac_b(16799060,333,10,"Skype SetFocus error. Message: {0}, Callstack: {1}",b.message,b.stack)}}};function wac_XMb(a,b,c,d){try{a.kZ.setAuthProvider(b,c,d)}catch(e){wac_b(8757719,333,10,"Skype SetAuthProvider error. Message: {0}, Callstack: {1}",e.message,e.stack)}}
function wac_b4(a,b,c,d,e,f,g){this.Bkd=Function.createDelegate(this,this.hUd);this.IJa=Function.createDelegate(this,this.LQa);this.dfd=Function.createDelegate(this,this.MNd);this.efd=Function.createDelegate(this,this.NNd);this.aqa=new (wac_Rb.$$(Boolean));this.p2=new (wac_Rb.$$(String));this.dispose=this.O;this.bN=a;this.Dc=b;this.nNc=d;this.Ra=new wac_Re;this.YUa=c;this.zEa=e;this.dB=f;this.jW=g;this.az=0}function wac_YMb(a){switch(a){case 2:case 4:case 3:a=2;break;default:a=1}return a}
wac_b4.prototype={az:0,HTb:0,ZC:null,Ra:null,nNc:null,YUa:null,zp:null,_initialized:!1,zEa:null,R7:null,dB:null,jW:null,$nb:!1,bN:null,Dc:null,L2b:function(){return this.p2.oj()},R9:function(){return!!this.zp&&this.zp.Cg()},GIa:function(a){this.zp?this.zp.Cg()!==a&&(this.zp.te(a),this.Ra.wa("PSCH",new wac_Nm(a?1:0),null)):a&&wac_b(8728835,333,10,"Trying to set visible while flexpane is null");return a},yZa:function(a){this.Ra.xa("PSCH",a)},AZa:function(a){this.Ra.xa("unreadConvEventKey",a)},HV:function(){this.ZC?
(wac_ZMb(this),this.GIa(!0)):wac_b(8696157,333,10,"SkypeApi is null so will not render content.")},A_:function(){this.GIa(!1)},tb:function(){if(this._initialized)return this.aqa.oj();this._initialized=!0;this.R7=wac_Qb(wac_c4(this.zEa));var a=this.zEa.wW;1===a&&(wac_b(8757720,333,50,"Starting skype experience for Consumers users."),window.setTimeout(function(){wac_b(18655443,333,50,"Starting skype experience for Consumer users with longer sessions.")},15E3));2===a&&(wac_b(8757721,333,50,"Starting skype experience for Enterprise users."),
window.setTimeout(function(){wac_b(18655444,333,50,"Starting skype experience for Enterprise users with longer sessions.")},15E3));var b=this.Dc.Qb.SkypeBootstrapUrl.toString(),c=this.Dc.Qb.SkypeApiKey.toString(),a=wac__Mb(this,a);wac_PMb(this.dB).Wd();var d=this.nNc.og(b,c,!1,a),e=this;d.CW(function(){var a=wac_Qb(d);if(a){wac_PMb(e.dB)&&wac_PMb(e.dB).vg();e.ZC=a;var a=wac_b,b;try{b=e.ZC.kZ.getVersion()}catch(c){wac_b(8947681,333,10,"Skype GetVersion error. Message: {0}, Callstack: {1}",c.message,
c.stack),b=""}a(8696158,333,50,"The Skype api version we are using is: {0}.",b);if(e.ZC.rJb()){if(e.R7.uka){wac_d4(e,1,!1);wac_0Mb(e);wac_1Mb(e);try{wac_b(8947683,333,50,"Calling Skype Api auth provider for implicit auth."),wac_QMb(e.dB).Wd(),wac_XMb(e.ZC,new wac_2Mb(wac_uMb.toString(1),null,null,null,null,null),e.efd,e.dfd)}catch(c){wac_b(8947712,333,10,"Error setting auth provider {0}. Callstack: {1}.",c.message,c.stack)}}else e.R7.gva&&wac_d4(e,4,!1);b=e.ZC;b.a2b||wac_b(17105567,333,10,"Skype Native Contact activity is null");
b.a2b.unreadConversations.subscribe(e.IJa);try{e.ZC.kZ.setNotificationHandler(e.Bkd)}catch(c){wac_b(8979149,333,10,"Skype SetNotificationHandler error. Message: {0}, Callstack: {1}",c.message,c.stack)}}else wac_b(17440902,333,50,"The Skype api is not available for this browser."),wac_d4(e,1,!1);e.aqa.Ze(!0)}else wac_b(8947682,333,10,"Skype client unavailable. Failed to initialize SWX api."),wac_d4(e,0,!1),e.aqa.Ze(!1)});return this.aqa.oj()},NNd:function(){wac_d4(this,2,!1);wac_b(8947717,333,50,"Authentication is successful.");
wac_3Mb(this)},MNd:function(a){wac_d4(this,1,!1);this.zEa.BWb?wac_um()?wac_b(17126927,333,10,"Skype authentication failing for Internet Explorer. Error: {0}",a):wac_b(8947718,333,10,"Skype authentication failing. Error: {0}",a):wac_b(16831619,333,15,"MSIT user failed to authenticate with Skype. Error: {0}",a)},M9:function(a){this.Ra.xa("availEventKey",a)},Iya:function(a,b,c,d,e){if(a)if(2===this.az||5===this.az)wac_4Mb(this,a,b,c);else if(4===this.az){if(!this.$nb){var f=this;wac_5Mb(this,d,function(){wac_4Mb(f,
a,b,c)},c,e,a)}}else wac_b(18900673,333,50,"Cannot perform join operation when client is not signed in!"),c();else wac_b(16832196,333,50,"Not performing join operation as convUri is null"),c()},Gy:function(a){a?(this.HTb=this.az,wac_d4(this,3,!0),this.A_()):3===this.az&&wac_d4(this,this.HTb,!0)},LQa:function(a){3!==this.az&&this.Ra.wa("unreadConvEventKey",new wac_7la(a),null)},hUd:function(a){if(3!==this.az){var b=wac_zMb(a.type),c,d=this,e=this,f=this,b=(c=new wac_Mm,c.Fg=b,c.Ixb=a.sender.avatar(),
c.dG=a.sender.displayName(),c.Wka=a.sender.status(),c.Nl=a.title(),c.fA=a.description(),c.bxb=function(){d.HV();a.accept()},c.G5a=function(b){e.HV();a.accept(b)},c.wBb=function(){f.HV();a.open()},c.myb=function(){a.decline()},c.fwa=function(){a.sound.play()},c.m8a=function(){a.sound.stop()},c.eDb=function(b){a.active.subscribe(b)},c.IZ=wac_YMb(b),c);wac_AMb(this.jW,this,b)}},O:function(){this.A_();this.jW&&(this.jW.dispose(),this.jW=null);this.zp=this.ZC=null}};
function wac_3Mb(a){wac_QMb(a.dB)&&wac_QMb(a.dB).vg();wac_JMb(a.dB)&&wac_JMb(a.dB).vg()}
function wac_6Mb(a){if(a.zp.Nc()){var b=document.createElement("div");Sys.UI.DomElement.addCssClass(b,"ChatPane");Sys.UI.DomElement.addCssClass(b,"skypeWX");Sys.UI.DomElement.addCssClass(b,"Selectable");!a.R7.uka&&a.R7.gva&&Sys.UI.DomElement.addCssClass(b,"DocChatOnly");a.zp.Nc().appendChild(b);a=document.createElement("div");a.className="ChatContent";a.id="SkypePaneContent";b.appendChild(a);a=document.createElement("div");a.id="SkypePaneTimeline";a.className="ChatTimeline";b.appendChild(a)}else wac_b(8696159,
333,10,"Failed to get chatpane Element so not creating content and timeline divs.")}function wac_4Mb(a,b,c,d){1===a.zEa.wW?wac_b(18699104,333,15,"Joining Conversation for Consumer"):wac_b(18699105,333,15,"Joining Conversation for Business");b=1===a.zEa.wW?String.format("19:{0}",b):b;a.ZC.Iya(b,c,d)}function wac_d4(a,b,c){c||3!==a.az?a.az!==b&&(a.az=b,a.Ra.wa("availEventKey",new wac_Lm(a.az),null),wac_b(17052561,333,50,"client state {0}",b)):a.HTb=b}
function wac_7Mb(a){a.ZC.l_a().authenticated.subscribe(function(b){b?(wac_d4(a,5,!1),wac_b(18121751,333,50,"Successfully authenticated as ANONYMOUS and setting state to AnonymousChatConnected.")):(wac_d4(a,4,!1),wac_b(18121752,333,10,"Skype authentication error, ANONYMOUS authentication failed or got disconnected."))})}
function wac_5Mb(a,b,c,d,e,f){e?f?(b||wac_b(17846557,333,15,"Attempting to sign in  anonymously without a user friendly name..."),wac_7Mb(a),wac_QMb(a.dB).Wd(),wac_b(18200788,333,15,"Start anonymous sign in."),a.$nb=!0,wac_XMb(a.ZC,new wac_2Mb(wac_uMb.toString(4),null,null,null,null,new wac_8Mb(b,f,e,!0)),function(){a.$nb=!1;wac_d4(a,5,!1);wac_b(17846558,333,50,"Skype anonymous authentication was successful.");wac_3Mb(a);c()},function(b){a.$nb=!1;wac_d4(a,4,!1);wac_b(17846559,333,10,"Skype anonymous authentication failed. Error: {0}",
b);d()})):wac_b(17846556,333,10,"Cannot attempt to sign in  anonymously with conversation uri being null or empty."):wac_b(17846555,333,10,"Cannot attempt to sign in anonymously with conversation discovery uri being null or empty.")}function wac_0Mb(a){a.ZC.l_a().uri.subscribe(function(b){b?(wac_b(8947716,333,50,"Successfully got an user identifier from Skype client."),a.p2.Ze(b)):wac_b(8947715,333,10,"Skype client lost the user URI!")})}
function wac_1Mb(a){a.ZC.l_a().authenticated.subscribe(function(b){b?(wac_d4(a,2,!1),wac_b(8947713,333,50,"Authenticated and setting signed in.")):(wac_d4(a,1,!1),wac_b(8947714,333,10,"Skype authentication error, authentication failed or disconnected from SWX."))})}
function wac__Mb(a,b){var c=wac_nm(wac_Lg(a.Dc,"Lcid",1033)),d;switch(a.bN.Nv()){case 3:d="Word";break;case 4:d="OneNote";break;case 1:d="Excel";break;case 2:d="PowerPoint";break;default:d="UnknownWAC"}switch(a.bN.Uob()){case 1:d+=" Edit";break;case 2:d+=" View"}return new wac_9Mb(b,c?c._name:null,d,a.Dc.Qb.SessionId)}
function wac_ZMb(a){if(!a.zp){a.zp=a.YUa.Db(CommonUIStrings.l_SkypeTooltip,function(){a.ZC.zw(!0)},function(){a.ZC.zw(!1)},3476734992);wac_b(8696156,333,15,"Setting Chat pane to visible and attempting to create the divs.");wac_6Mb(a);try{try{a.ZC.kZ.renderContent("#SkypePaneContent")}catch(b){wac_b(8757717,333,10,"Skype render content error. Message: {0}, Callstack {1}",b.message,b.stack)}try{a.ZC.kZ.renderSidebar("#SkypePaneTimeline")}catch(b){wac_b(8757718,333,10,"Skype render sidebar error. Message: {0}, Callstack: {1}",
b.message,b.stack)}}catch(b){wac_b(8728836,333,10,"Failure to render the skype api. Message: {0}, Callstack: {1}",b.message,b.stack)}}}function wac_EMb(){this.zkd=Function.createDelegate(this,this.mNb);this.Akd=Function.createDelegate(this,this.gUd);this.vid=Function.createDelegate(this,this.SQd);this.uo=new (wac_Rb.$$(wac_WMb))}
wac_EMb.prototype={bpa:null,pGc:null,FSc:null,_jsonp:!1,TGc:!1,og:function(a,b,c,d){if(!a)return wac_b(19726497,333,10,"Cannot initialize Skype. Invalid setting for Skypebootstrap url."),this.uo.Ze(null),this.uo.oj();this.pGc=b;this.FSc=d.pkc;this._jsonp=c;this.bpa=new wac_$Mb;this.bpa.userAppId=d.Pvd;this.bpa.hostProperty=d.Ztc;this.bpa.userId=d.cwd;this.bpa.sessionId=d.Bsc;this.bpa.experienceId=wac_d.Qa.QI.UEb.toString(d.Gyb);this.TGc=2===d.Gyb;try{var e=this.vid,f=a?wac_Ll(a,null,null,null,!1,
!1,null,!0,!1):null;f&&wac_rl(f,e);try{wac_ul(f)}catch(g){wac_b(8757722,333,10,"Failure downloading the skype api bootstrapper: Message: {0}, Callstack: {1}",g.message,g.stack)}wac_b(8254435,333,100,"Downloading SWX bootstrapper from: {0}",a)}catch(g){wac_b(8245794,333,10,"Exception loading the api Message: {0} Callstack: {1}.",g.message,g.stack)}return this.uo.oj()},SQd:function(a,b){if(b.XP){wac_b(8210202,333,50,"Calling the Skype initialized method.");try{window.Skype.initialize(new wac_aNb(this.pGc,
this.FSc,this._jsonp,this.bpa,this.TGc),this.Akd,this.zkd)}catch(c){wac_b(8245795,333,10,"Exception in initializing the Skype SWX api Message: {0} Callstack: {1}.",c.message,c.stack),this.uo.Ze(null)}}else wac_b(8210203,333,10,"Failed to download the SkypBootstrapper."),this.uo.Ze(null)},gUd:function(a){if(a){var b,c,d;var e=b={val:b};try{e.val=new wac_WMb(a),d=!0}catch(f){wac_b(8757716,333,10,"SkypeApi initialization error. Message: {0}, Callstack: {1}",f.message,f.stack),e.val=null,d=!1}(c=d,b=
b.val,c)?(wac_b(8245825,333,50,"Initializing succeeded and about to create the api instance."),this.uo.Ze(b)):(this.mNb("This is not real success. Invalid native api object."),this.uo.Ze(null))}else this.mNb("This is not real success. Null native api object."),this.uo.Ze(null)},mNb:function(a){wac_b(8210207,333,10,"Skype Api error: {0}",a);this.uo.Ze(null)}};function wac_9Mb(a,b,c,d){this.Gyb=a;this.pkc=b;this.Ztc=c;this.Bsc=d}wac_9Mb.prototype={Gyb:0,pkc:null,Ztc:null,cwd:null,Bsc:null,Pvd:null};
function wac_$3(a,b){this.Ddd=Function.createDelegate(this,this.rKd);wac_$3.initializeBase(this,[a]);this.lRc=b;this.BWb=!0;this.CWb=new (wac_f.$$(Boolean))(this.Ddd)}wac_$3.prototype={lRc:null,l0b:null,m0b:null,CWb:null,BWb:!1,rKd:function(){return wac_ym()||wac_Fh()&&!wac_6i()||wac_eg()&&!wac_Ek()&&!wac_mh(8)||Sys.Browser.agent===Sys.Browser.Opera||0<=window.navigator.userAgent.indexOf("OPR")?!1:!0}};
function wac_TMb(a){a.CWb.ma()?2===a.wW?a.lRc.uc(function(b){a.l0b=b;b.f7e().CW(function(){a.m0b=a.l0b.f7e();if(wac_Gb(a.m0b)||!a.m0b.qB())wac_b(17949148,333,15,"Shell info task was canceled or was not completed"),a.xZ.Ze(!1);else{var b=wac_Qb(a.l0b.f7e()),d=!1;try{var e,f,g;if(g=wac_dP(Object,b.ClientData.toString(),f={val:e}),e=f.val,g)if(wac_q(a.qwa,"BasicChatIsForced"))d=!0,a.BWb=!1;else{var h=e.IsTenantDirSyncEnabled,k=e.HasSkypeLicense,d=!h&&k;wac_b(17949149,333,50,"Suite UX Skype check resulted in Enabled:{0}, from: Tenant Hybrid:{1}; License:{2}",
d,h,k)}}catch(l){wac_b(17949150,333,15,"object format is incorrect. Error {0}",l.message)}a.xZ.Ze(d)}})}):1===a.wW||3===a.wW?a.xZ.Ze(!0):a.xZ.Ze(!1):a.xZ.Ze(!1)}function wac_8Mb(a,b,c,d){this.displayName=a;this.conferenceUri=b;this.discoveryUri=this.discoverUri=c;this.useInternalAnonFlow=d}wac_8Mb.prototype={displayName:null,conferenceUri:null,discoverUri:null,discoveryUri:null,useInternalAnonFlow:!1};
function wac_2Mb(a,b,c,d,e,f){this.type=a;this.username=b;this.password=c;this.token=d;this.product=e;this.options=f}wac_2Mb.prototype={type:null,username:null,password:null,token:null,product:null,options:null};function wac_aNb(a,b,c,d,e){this.apiKey=a;this.locale=b;this.correlationIds=d;this.jsonp=c;this.business=e}wac_aNb.prototype={correlationIds:null,apiKey:null,locale:null,jsonp:!1,business:!1};function wac_$Mb(){}
wac_$Mb.prototype={hostProperty:null,userId:null,sessionId:null,userAppId:null,experienceId:null};function wac_bNb(a,b){this.ehc=Function.createDelegate(this,this.jVd);this.dispose=this.O;wac_bNb.initializeBase(this);this.wg=a;this.Ra=new wac_Re;this.Mga=document.createElement("div");a=wac_e4(this.Mga,"div");this.RZb=new wac_cNb(a);a=wac_e4(this.Mga,"div");this.elb=new wac_dNb(a,this.wg);Sys.UI.DomElement.addCssClass(this.Mga,"SkypeToastDiv");this.uVa=!1;wac_eNb(this,b)}
function wac_fNb(a){switch(a.Fg){case 2:return a.bxb;case 1:case 4:return a.wBb;case 3:return function(){a.G5a("Audio")};default:return Function.emptyFunction}}function wac_gNb(a){switch(a.Fg){case 3:return function(){a.G5a("Chat")};default:return null}}function wac_hNb(a){switch(a){case 2:return 25E3;case 1:case 4:return 7E3;case 3:return 6E4;default:return 7E3}}
wac_bNb.prototype={Mga:null,Nc:function(){return this.Mga},RZb:null,elb:null,fYb:null,Fqa:null,uVa:!1,WVb:null,Ra:null,wg:null,om:!1,HIc:!1,sl:function(){this.HIc||(wac_b(17114642,333,100,"Dismissing toast type: <{0}>.",this.Fqa.Fg),this.HIc=!0,wac_iNb(this),this.Fqa.m8a&&this.Fqa.m8a(),this.Ra.wa("toastDismissedEventKey",null,null))},jVd:function(){this.fYb&&this.fYb();return!0},O:function(){this.om||(this.om=!0,this.wg.ub("click",this.Mga,this.ehc),this.elb.O(),this.Mga=this.RZb=this.elb=null)}};
function wac_jNb(a,b){return function(){b&&b();wac_b(17114643,333,100,"Toast action taken...");a.sl()}}function wac_iNb(a){a.uVa&&(wac_p().Rg(a.WVb),a.uVa=!1)}function wac_kNb(a,b){wac_iNb(a);a.WVb=new wac_D(2,1,wac_hNb(b),function(){a.uVa=!1;wac_b(17114641,333,100,"Auto-hide toast task executing...");a.sl()},73,null,!1);wac_p().Hb(a.WVb);a.uVa=!0}
function wac_eNb(a,b){a.Fqa=b;wac_b(17114639,333,100,"Building toast type: <{0}>.",a.Fqa.Fg);wac_lNb(a.RZb,b.Ixb);a.fYb=wac_jNb(a,wac_fNb(b));var c=wac_gNb(b);wac_mNb(a.elb,b.dG,b.Nl,b.fA,b.Fg,wac_jNb(a,b.myb),c?wac_jNb(a,c):null);b.fwa&&b.fwa();wac_kNb(a,b.Fg);a.Fqa.eDb(function(b){b||(wac_b(17114640,333,100,"Notification inactive triggered..."),a.sl())});a.wg.ya("click",a.Mga,a.ehc)}function wac_GMb(a){this.wg=a}wac_GMb.prototype={wg:null,Db:function(a){return new wac_bNb(this.wg,a)}};
function wac_f4(){}wac_f4.prototype={};function wac_e4(a,b){b=document.createElement(b);a.appendChild(b);return b}function wac_HMb(a,b){this.rld=Function.createDelegate(this,this.kVd);this.hpd=Function.createDelegate(this,this.j_d);this.dispose=this.O;wac_HMb.initializeBase(this);this.fKc=a;this.VYa=new (wac_f.$$(Object))(this.hpd);this.zSc=b}
function wac_zMb(a){switch(a.toLowerCase()){case "unreadmessage":return 1;case "chat":return 2;case "audio":return 3;case "contactrequest":return 4;default:return 0}}wac_HMb.prototype={VYa:null,N8:null,fKc:null,zSc:null,c6d:!1,j_d:function(){var a=this.fKc(),a=wac_e4(a,"div");Sys.UI.DomElement.addCssClass(a,"SkypeToastManagerContainer");return a},kVd:function(){this.N8&&(this.VYa.ma().removeChild(this.N8.Nc()),this.N8.dispose(),this.N8=null);this.VYa.ma().style.display="none"},O:function(){wac_nNb(this)}};
function wac_nNb(a){a.N8&&(wac_b(17114645,333,100,"About to show new toast over existing one..."),a.N8.sl())}
function wac_AMb(a,b,c){wac_c(17114644,333,!!b,null);var d;a.c6d||3===b.az||!c.Fg?d=!1:a.N8&&3===a.N8.Fqa.Fg?(wac_b(17114646,333,100,"Ignoring new [{0}] notification while last A/V toast is still up...",c.Fg),d=!1):d=!0;if(d){switch(c.IZ){case 0:d=!1;break;case 1:d=!b.R9();break;case 2:d=!0;break;default:d=!1}wac_b(17118549,333,100,"{0}toast for notification level {1}. Chat Pane was visible: {2}.",d?"SHOW ":"SKIP ",c.IZ,b.R9());d?(b=a.zSc.Db(c),b.Ra.xa("toastDismissedEventKey",a.rld),wac_nNb(a),a.VYa.ma().style.display=
"block",a.VYa.ma().appendChild(b.Nc()),a.N8=b):c.fwa&&c.fwa()}}function wac_dNb(a,b){this.dispose=this.O;wac_dNb.initializeBase(this);this.flb=a;Sys.UI.DomElement.addCssClass(this.flb,"SkypeNotificationArea");this.wg=b;this.hlb=wac_e4(this.flb,"div");Sys.UI.DomElement.addCssClass(this.hlb,"SkypeNotificationTopBar");a=wac_e4(this.hlb,"div");this.gOc=new wac_oNb(a);a=wac_e4(this.hlb,"div");this.iOc=new wac_pNb(a);a=wac_e4(this.flb,"div");this.YWa=new wac_qNb(a,this.wg)}
wac_dNb.prototype={flb:null,hlb:null,gOc:null,iOc:null,YWa:null,wg:null,O:function(){this.YWa&&(this.YWa.O(),this.YWa=null)}};
function wac_mNb(a,b,c,d,e,f,g){var h=a.gOc;switch(e){case 3:d=CommonUIStrings.l_NotificationIncomingCall}h.b0b.innerText=b;h.c0b.innerText=c;h.IN.innerText=d;b=a.iOc;c=wac_6h(40,40,b.wCa[wac_d.Qa.QI.wca.toString(e)],wac_5h,"cui-img-cont-float","",!1,"",b.lDa.ownerDocument,null);b.glb&&b.lDa.removeChild(b.glb);b.lDa.appendChild(c);b.glb=c;a=a.YWa;b=CommonUIStrings.l_NotificationRespond;c=CommonUIStrings.l_NotificationIgnore;h=CommonUIStrings.l_NotificationAnswerWithIM;switch(e){case 3:b=CommonUIStrings.l_NotificationAnswer;
a.O7.style.display="";a.O7.style.maxWidth="120px";a.lTa.style.maxWidth=a.Wpa.style.maxWidth="65px";break;default:a.O7.style.display="none",a.lTa.style.maxWidth=a.Wpa.style.maxWidth=""}a.lTa.innerText=b;a.Wpa.innerText=c;a.O7.innerText=h;a.eWb=f;a.SSb=g}
function wac_qNb(a,b){this.Fdc=Function.createDelegate(this,this.zNd);this.Iec=Function.createDelegate(this,this.gQd);this.dispose=this.O;wac_qNb.initializeBase(this);this.YSa=a;Sys.UI.DomElement.addCssClass(this.YSa,"SkypeNotificationActionArea");this.wg=b;this.lTa=wac_e4(this.YSa,"div");Sys.UI.DomElement.addCssClass(this.lTa,"SkypeNotificationButton");this.Wpa=wac_e4(this.YSa,"div");Sys.UI.DomElement.addCssClass(this.Wpa,"SkypeNotificationButton");this.wg.ya("click",this.Wpa,this.Iec);this.O7=wac_e4(this.YSa,
"div");Sys.UI.DomElement.addCssClass(this.O7,"SkypeNotificationButton");this.O7.style.display="none";this.wg.ya("click",this.O7,this.Fdc)}wac_qNb.prototype={YSa:null,lTa:null,Wpa:null,O7:null,eWb:null,SSb:null,wg:null,gQd:function(){this.eWb&&this.eWb();return!0},zNd:function(){this.SSb&&this.SSb();return!0},O:function(){this.wg.ub("click",this.Wpa,this.Iec);this.wg.ub("click",this.O7,this.Fdc)}};
function wac_oNb(a){wac_oNb.initializeBase(this);this.g2=a;Sys.UI.DomElement.addCssClass(this.g2,"SkypeNotificationText");this.b0b=wac_e4(this.g2,"span");Sys.UI.DomElement.addCssClass(this.b0b,"SkypeNotificationSender");this.c0b=wac_e4(this.g2,"span");Sys.UI.DomElement.addCssClass(this.c0b,"SkypeNotificationTitle");this.IN=wac_e4(this.g2,"span");Sys.UI.DomElement.addCssClass(this.IN,"SkypeNotificationMessage")}wac_oNb.prototype={g2:null,b0b:null,c0b:null,IN:null};
function wac_pNb(a){this.wCa={};wac_pNb.initializeBase(this);this.lDa=a;Sys.UI.DomElement.addCssClass(this.lDa,"SkypeNotificationType");this.glb=wac_e4(this.lDa,"span");a=wac_8h;var b=wac_7h(a,"WACSkypeChatRequest_40x40x32");this.wCa[wac_d.Qa.QI.wca.toString(0)]=b;this.wCa[wac_d.Qa.QI.wca.toString(1)]=b;this.wCa[wac_d.Qa.QI.wca.toString(2)]=b;this.wCa[wac_d.Qa.QI.wca.toString(4)]=b;this.wCa[wac_d.Qa.QI.wca.toString(3)]=wac_7h(a,"WACSkypeVoiceRequest_40x40x32")}wac_pNb.prototype={lDa:null,glb:null};
function wac_cNb(a){wac_cNb.initializeBase(this);this.Tlb=a;Sys.UI.DomElement.addCssClass(this.Tlb,"SkypePresenceArea");this.Ulb=wac_e4(this.Tlb,"div");Sys.UI.DomElement.addCssClass(this.Ulb,"SkypePresenceIndicator");a=wac_e4(this.Tlb,"div");this.zPc=new wac_rNb(a)}wac_cNb.prototype={Tlb:null,Ulb:null,zPc:null,sUb:null};function wac_lNb(a,b){a.sUb&&Sys.UI.DomElement.removeCssClass(a.Ulb,a.sUb);Sys.UI.DomElement.addCssClass(a.Ulb,"skPresenceUnknown");a.sUb="skPresenceUnknown";a.zPc.jea(b)}
function wac_rNb(a){wac_rNb.initializeBase(this);this.hWb=a;Sys.UI.DomElement.addCssClass(this.hWb,"SkypePresenceImage");this.wu=wac_e4(this.hWb,"img");Sys.UI.DomElement.addCssClass(this.wu,"SkypePresenceImage")}wac_rNb.prototype={hWb:null,wu:null,jea:function(a){this.wu.src=a}};wac_xMb.registerClass("BasicChat.ChatClientFactory",null,wac_Jm);wac_93.registerClass("BasicChat.ChatClientMock",null,wac_5la,Sys.IDisposable);wac_BMb.registerClass("BasicChat.CommonBasicChatPackage",null,wac_I,wac_i);
wac_FMb.registerClass("BasicChat.BasicChatActor",null,wac_sMb,Sys.IDisposable);wac_a4.registerClass("BasicChat.BasicChatPerformanceManager");wac_RMb.registerClass("BasicChat.BasicChatUserExperienceController",null,wac_Im);wac_VMb.registerClass("BasicChat.FlexPane",null,wac_Rca,Sys.IDisposable);wac_DMb.registerClass("BasicChat.FlexPane.Factory",null,wac_qc);wac_WMb.registerClass("BasicChat.SkypeApi");wac_b4.registerClass("BasicChat.SkypeChatClient",null,wac_5la,Sys.IDisposable);wac_EMb.registerClass("BasicChat.SkypeLoader");
wac_9Mb.registerClass("BasicChat.SkypeSettings");wac_$3.registerClass("BasicChat.SkypeWebExperienceController",wac_RMb,wac_tMb,wac_Im);wac_8Mb.registerClass("BasicChat.SkypeAnonymousJoinOptions");wac_2Mb.registerClass("BasicChat.SkypeAuth");wac_aNb.registerClass("BasicChat.SkypeNativeInitParams");wac_$Mb.registerClass("BasicChat.SkypeNativeInitParamsCorrelationIds");wac_f4.registerClass("BasicChat.SkypeToastDomObjectBase");wac_bNb.registerClass("BasicChat.SkypeToast",wac_f4,wac_vMb,Sys.IDisposable);
wac_GMb.registerClass("BasicChat.SkypeToast.Factory",null,wac_wMb);wac_HMb.registerClass("BasicChat.SkypeToastManager",wac_f4,wac_Km,Sys.IDisposable);wac_dNb.registerClass("BasicChat.SkypeToastNotificationArea",wac_f4,Sys.IDisposable);wac_qNb.registerClass("BasicChat.SkypeToastNotificationButtons",wac_f4,Sys.IDisposable);wac_oNb.registerClass("BasicChat.SkypeToastNotificationText",wac_f4);wac_pNb.registerClass("BasicChat.SkypeToastNotificationType",wac_f4);
wac_cNb.registerClass("BasicChat.SkypeToastPresenceArea",wac_f4);wac_rNb.registerClass("BasicChat.SkypeToastPresenceImage",wac_f4);var wac_83=null;wac_J(wac_C(),new wac_BMb,0,!1);Type.registerNamespace("Common.App.DisplayEnvironmentName");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.aue=wac_d.Qa.aue||{};function wac_Lnc(a,b){this.cte=Function.createDelegate(this,this.owe);this.Ia=a;this.Dc=b}
wac_Lnc.prototype={Ia:null,Dc:null,Wfe:null,Tb:function(){(this.Wfe=this.Dc.Qb.StatusBarEnvironmentNameToUse)&&""!==this.Wfe&&this.Ia.Mp(3887408216,2147483648,this.cte,96)},owe:function(a,b,c,d,e){if(1===c)return 32;e.Value=this.Wfe;e[wac_hT.Visible]=!0;return 32}};function wac_Mnc(){}
wac_Mnc.prototype={sa:null,Ub:function(){return"Common.App.DisplayEnvironmentName"},gc:function(a){this.sa=a;wac_m(wac_n(this.sa.fa(wac_Lnc)),function(){return new wac_Lnc(wac_z(),wac_.pa)})},tb:function(){this.sa.H(wac_Lnc).Tb()},O:function(){}};wac_Lnc.registerClass("Common.App.DisplayEnvironmentName.DisplayEnvironmentName");wac_Mnc.registerClass("Common.App.DisplayEnvironmentName.DisplayEnvironmentNamePackage",null,wac_I,wac_i);wac_J(wac_C(),new wac_Mnc,0,!1);
window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_InsightsMenu",Width:"320"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]};Type.registerNamespace("Common.App.Insights");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.$4c=wac_d.Qa.$4c||{};function wac_gHc(){}wac_gHc.registerInterface("Common.App.Insights.IInsightsManager");
function wac_hHc(){}function wac_iHc(){}wac_iHc.registerInterface("Common.App.Insights.IInsightsPane");function wac_jHc(){}wac_jHc.registerInterface("Common.App.Insights.IInsightsPaneHandler");function wac_kHc(){}wac_kHc.registerInterface("Common.App.Insights.IInsightsSelection");
function wac_lHc(a,b,c,d){this.jZe=Function.createDelegate(this,this.ldd);this.nZe=Function.createDelegate(this,this.a1e);this.mZe=Function.createDelegate(this,this.$0e);this.tZe=Function.createDelegate(this,this.g1e);this.sZe=Function.createDelegate(this,this.f1e);this.dispose=this.O;this.wua=a;this.Ia=b||wac_z();this.sN=c;this.nd=d;a=this.nd.xc("InsightsTaskPane");a.re="main";wac_mk(a,this.jZe);wac_4j(this.sN,"InsightsTaskPane")}
function wac_mHc(a,b,c){a={appCorrelationId:b,message:a};if(c)for(var d in c)b={key:d,value:c[d]},a[b.key]=b.value;return wac_ai(a)}function wac_nHc(){return wac_5k().toString()}
wac_lHc.prototype={wua:null,Ia:null,nd:null,sN:null,Tb:function(){this.Ia.Mp(1435347209,2147483648,this.sZe,64);this.Ia.Mp(3317204163,2147483648,this.tZe,64);this.Ia.Mp(1756450500,2147483648,this.mZe,64);this.Ia.Mp(2114287254,2147483648,this.nZe,64)},f1e:function(a,b,c,d,e){if(1===c)return wac_oHc(this.wua.ma().tYa)?32:8;a=wac_nHc();b=this.wua.ma().tYa.EPe();return wac_pHc(this,e,b,a,0)},$0e:function(a,b,c,d,e){if(1===c)return wac_oHc(this.wua.ma().tYa)?32:8;a=wac_nHc();b=this.wua.ma().tYa.EPe();
return wac_pHc(this,e,b,a,1)},g1e:function(a,b,c,d,e){return 1===c?32:wac_qHc(this,e,0)},a1e:function(a,b,c,d,e){return 1===c?32:wac_qHc(this,e,1)},ldd:function(){document.activeElement.blur();if(!wac_r()||!wac_JAc()){var a=this.wua.ma();a.Lwa&&wac_rHc(a.Lwa);a=this.wua.ma();a.Lwa&&a.Lwa.ldd()}},O:function(){this.wua.ma()&&this.wua.ma().dispose()}};
function wac_pHc(a,b,c,d,e){wac_b(6403776,1303,50,wac_mHc("Show insights",d,{controlId:b?b.SourceControlId:"shortcut"}));a=a.wua.ma();a.Lwa||(a.Lwa=new wac_sHc(new wac_tHc,wac_qg(),wac_Ie(),wac_j().H(wac_Zb)));a.Lwa.jSa(c,d,e);return 32}function wac_qHc(a,b,c){var d=wac_nHc(),e=b.CommandValueId,f;try{f=wac_yl(e)}catch(g){return wac_b(6295941,1303,15,wac_mHc(String.format("Insights parameters [{0}] is not in proper format.",e),d,null)),8}return wac_pHc(a,b,f,d,c)}
function wac_uHc(){this.dispose=this.O}wac_uHc.prototype={Lwa:null,O:function(){this.Lwa&&(this.Lwa.dispose(),this.Lwa=null)}};function wac_vHc(a){this.messageType=a}wac_vHc.prototype={messageType:null};
function wac_wHc(a,b){this.messageContent=this.jb["Common.App.Insights.InsightsMessageWithContent$1"].T===Number||Type.isEnum(this.jb["Common.App.Insights.InsightsMessageWithContent$1"].T)?0:this.jb["Common.App.Insights.InsightsMessageWithContent$1"].T===Boolean?!1:null;wac_wHc.$$(this.jb["Common.App.Insights.InsightsMessageWithContent$1"].T).initializeBase(this,[a]);this.messageContent=b}
wac_wHc.$$=function(a){var b=wac_d.Qa.$4c.__tc=wac_d.Qa.$4c.__tc||{},c="InsightsMessageWithContent$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_wHc.apply(this,a)};d.registerClass("Common.App.Insights.__tc."+c,wac_vHc);d.prototype.jb={"Common.App.Insights.InsightsMessageWithContent$1":{T:a},ctor:wac_wHc};a=wac_wHc.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};
function wac_xHc(a){wac_xHc.initializeBase(this,["ApplicationProperties",a])}function wac_yHc(a){wac_yHc.initializeBase(this,["Selection",a])}function wac_zHc(){wac_zHc.initializeBase(this,["TakeFocus"])}function wac_AHc(){}
wac_AHc.prototype={sa:null,Xoe:null,Ub:function(){return"Common.App.Insights"},gc:function(a){this.sa=a;wac_m(wac_n(a.fa(wac_lHc)),function(){return new wac_lHc(wac_0b(a,wac_gHc),wac_z(),wac_qg(),wac_Ie())})},tb:function(){wac_.$Jd&&(this.Xoe=wac_k(this.sa,wac_lHc),this.Xoe.Tb())},O:function(){this.Xoe&&this.Xoe.O()}};
function wac_sHc(a,b,c,d){this.QYe=Function.createDelegate(this,this.s0e);this.ISe=Function.createDelegate(this,this.r0e);this.GSe=Function.createDelegate(this,this.p0e);this.HSe=Function.createDelegate(this,this.q0e);this.dispose=this.O;this.yqe=a;this.lbe();wac_tf(this.BF,"load",this.HSe);wac_tf(this.BF,"error",this.GSe);window.$addHandler(window,"message",this.ISe);this.sN=b;this.nd=c;this.jR=d;this.uQe=0}
wac_sHc.prototype={wS:null,yqe:null,BF:null,HVe:null,Khc:null,Cpe:null,Kre:!1,sN:null,nd:null,jR:null,uQe:0,lbe:function(){this.wS=wac_BHc();if(wac_r()&&wac_JAc()){var a=this;wac_bHc(this.wS,function(b){b===a.wS&&(wac_rHc(a),a.ldd())})}wac_CHc(this,this.wS.Ega.UE);this.wS.Nh()},O:function(){this.BF&&(wac_jg(this.BF,"load",this.HSe),wac_jg(this.BF,"error",this.GSe),window.$removeHandler(window,"message",this.ISe),this.BF.parentNode.removeChild(this.BF),this.BF=null);this.wS&&(this.yqe.jee(this.wS),
this.wS=null)},jSa:function(a,b,c){this.Khc=b;this.Cpe=null;this.uQe=c;this.Kre=!1;wac_b(6295947,1303,50,this.sda("Start to show Insights"));this.HVe=a;wac_.aKd&&wac_.aKd.length?this.BF.src=wac_.aKd:(this.BF.src="about:blank",wac_b(6295948,1303,15,this.sda("The Insights URL config setting is null or empty")));this.jR.bdc(CommonUIStrings.l_InsightsPaneNotification,!0);this.wS.Qva||(this.yqe.rne(this.wS),this.wS.dZb=this.QYe);this.wS.Nh()},ldd:function(){this.BF.src===wac_.aKd&&this.Kre&&(this.nd.ff("InsightsTaskPane"),
wac_DHc(this,new wac_zHc))},Fye:function(){this.yqe.vhe(this.wS);this.BF.src="about:blank";this.wS.Yg()},s0e:function(a){a===this.wS&&this.Fye()},q0e:function(){wac_b(6295951,1303,50,this.sda("The iframe is successfully loaded in Insights task pane"))},p0e:function(){wac_b(6295952,1303,15,this.sda("The iframe failed to load in Insights task pane"))},r0e:function(a){a=a.rawEvent;if(a.source===this.BF.contentWindow){var b;try{b=wac_yl(a.data)}catch(f){wac_b(6295953,1303,15,this.sda("Message data [{0}] failed to deserialize.",
a.data));return}if(wac_6(b.messageType))wac_b(6295954,1303,15,this.sda("Message data [{0}] is in wrong format.",a.data));else switch(b.messageType){case "ApplicationPropertiesRequest":b=wac_xHc;a={anid:"00000000-0000-0000-0000-000000000000"};a.appCorrelationId=this.Khc;3===wac_r().Hd().Nv()?a.applicationName="WordWac":4===wac_r().Hd().Nv()&&(a.applicationName="OneNoteWAC");a.applicationVersion=wac_.jv;var c=wac_nm(wac_.vh),c=c?c._name:null;a.market=this.yPe(c);a.uiLanguage=c;a.sessionId=wac_.Ag;a.parentalControl=
"yes";a.clientType="user";var d;try{var e=localStorage.getItem("Microsoft::Office::Insights::LegalAgreed");d=!!e&&"true"===e}catch(f){wac_b(17961860,1303,10,this.sda("Failed to GetItem in LocalStorage for LegalAgreed")),d=!1}a.legalAgreed=d;a.defaultDefineTab=1===this.uQe?"true":null;wac_DHc(this,new b(a));break;case "SelectionRequest":wac_DHc(this,new wac_yHc(this.HVe));break;case "PageRendered":this.Kre=!0;wac_rHc(this);this.ldd();wac_b(6295955,1303,50,this.sda("Insights pane rendering is completed"));
break;case "Telemetry":d=b.messageContent;this.Cpe=d.clientCorrelationId;this.Khc!==d.appCorrelationId&&wac_b(6403778,1303,15,this.sda("App correlation ID on client {0} does not match one on server {1}",this.Khc,d.appCorrelationId));break;case "LostFocus":b.messageContent?(wac_dg()&&document.activeElement.blur(),this.sN.byc(0,null,2,null,null),wac_b(6604741,1303,50,this.sda("Insights UX lost focus through Ctrl + Shift + F6"))):(this.sN.mya(0,null,2,null,null),wac_b(6604742,1303,50,this.sda("Insights UX lost focus through Ctrl + F6")));
break;case "Keyboard":d=b.messageContent;27===d.keyCode&&this.Fye();break;case "LegalAgreed":try{this.Kre=!1,localStorage.setItem("Microsoft::Office::Insights::LegalAgreed","true")}catch(f){wac_b(17961859,1303,10,this.sda("Failed to SetItem in LocalStorage for LegalAgreed"))}}}},yPe:function(a){a=a.split("-");return a[a.length-1]},sda:function(a){for(var b=[],c=1;c<arguments.length;++c)b[c-1]=arguments[c];c={};this.Khc&&(c.appCorrelationId=this.Khc);this.Cpe&&(c.clientCorrelationId=this.Cpe);c.message=
String.format.apply(null,[a].concat(b));return wac_ai(c)}};function wac_DHc(a,b){b=wac_ai(b);a.BF.contentWindow.postMessage(b,wac_Jh(wac_.aKd,0))}function wac_rHc(a){a.BF&&wac_Vj(a.BF.contentWindow)}function wac_CHc(a,b){b.style.overflow="hidden";var c=wac_7("iframe");Sys.UI.DomElement.addCssClass(c,"InsightsPaneIFrame");c.setAttribute("Unselectable","off");a.BF=c;b.appendChild(a.BF);a.BF.id="InsightsContentFrame"}function wac_EHc(){}wac_EHc.prototype={neighborhood:null,mentionStart:0,mentionLength:0};
wac_hHc.registerClass("Common.App.Insights.InsightsMessageContentAppProperties");(function(){}).registerClass("Common.App.Insights.InsightsMessageContentTelemetry");(function(){}).registerClass("Common.App.Insights.InsightsMessageContentKeyboard");wac_lHc.registerClass("Common.App.Insights.InsightsActor",null,Sys.IDisposable);wac_uHc.registerClass("Common.App.Insights.InsightsManager",null,wac_gHc,Sys.IDisposable);wac_vHc.registerClass("Common.App.Insights.InsightsMessage");
wac_xHc.registerClass("Common.App.Insights.InsightsMessageAppProperties",wac_wHc.$$(wac_hHc));wac_yHc.registerClass("Common.App.Insights.InsightsMessageSelection",wac_wHc.$$(wac_EHc));wac_zHc.registerClass("Common.App.Insights.InsightsMessageTakeFocus",wac_vHc);wac_AHc.registerClass("Common.App.Insights.InsightsPackage",null,wac_I,wac_i);wac_sHc.registerClass("Common.App.Insights.InsightsPane",null,wac_iHc,Sys.IDisposable);wac_EHc.registerClass("Common.App.Insights.InsightsParameters");Type.registerNamespace("Common.App.OAuth");
wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.zxf=wac_d.Qa.zxf||{};function wac_l_c(){}wac_l_c.registerInterface("Common.App.OAuth.IOAuthManager");function wac_m_c(){}wac_m_c.registerInterface("Common.App.OAuth.ILegacyOAuthManager");function wac_n_c(){}function wac_o_c(){}function wac_p_c(){}function wac_q_c(){}
function wac_r_c(a,b,c,d){this.v5e=a;this.Lcf=wac_q(d,"OAuthManagerEnableConsoleLogging");this.G6e=c;this.ENe=this.B_e(this.v5e,b,d);a=window.location.protocol;b=window.location.host;d=d.Qb.OAuthManagerHostPathOverride;wac_h(d)&&(d=window.location.pathname,c=d.lastIndexOf("/"),d=0<=c?d.substring(0,c+1):"");this.odf=a+"//"+b+d+"WacOAuth.html"}
wac_r_c.prototype={G6e:null,v5e:null,odf:null,Lcf:!1,ENe:null,Jdf:function(){var a=this;return wac_nea.toPromise$o(wac_s_c(this.G6e)).then(function(){var b;a:if(a.ENe){b=wac_t_c(a.ENe.get_authorityType());switch(a.ENe.get_authorityType()){case 2:var c,d=(c=new wac_o_c,c.appId=a.v5e,c.authority=a.ENe.get_authority(),c.redirectUri=a.odf,c.upn=a.ENe.get_upn(),c),e;b=(e=new wac_n_c,e.idp=b,e.aadConfig=d,e.enableConsoleLogging=a.Lcf,e);break;case 1:var f;e=(f=new wac_p_c,f.appId=a.v5e,f.authority=a.ENe.get_authority(),
f.redirectUri=a.odf,f.upn=a.ENe.get_upn(),f);b=(d=new wac_n_c,d.idp=b,d.msaConfig=e,d.enableConsoleLogging=a.Lcf,d);break;default:wac_b(41003226,3E3,100,"Non-microsoft authentication authority: {0}. WebAuthImplicit package did not load.",b);b=Promise.reject(!1);break a}wac_u_c.vie.Load(b);wac_b(41003227,3E3,100,"WebAuthImplicit package loaded.");b=Promise.resolve(!0)}else wac_b(41460757,3E3,15,"Auth context is null. WebAuthImplicit package did not load."),b=Promise.reject(!1);return b})},H5e:function(a,
b,c,d){b===this.v5e&&(b=null);return(new wac_v_c(a,b,this.ENe.get_authorityType(),c,d)).H5e()},B_e:function(a,b){b=b.getAuthContextSync(a);return b?b:(wac_b(41460758,3E3,15,"Auth context not found for appId [{0}]; Ensure that your appId is allowlisted in [Word/Excel/PowerPoint]WopiIdentityWhitelist",a),null)}};function wac_t_c(a){switch(a){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"Unexpected enum type"}}
function wac_v_c(a,b,c,d,e){this.FJ=a;this.Smf=b;this.Enf=c;this.ki=d;this.aff=e}
wac_v_c.prototype={FJ:null,Smf:null,Enf:0,ki:null,aff:!1,q$e:0,r$e:0,H5e:function(){var a=this,b=this;return wac_u_c.vie.GetToken(this.ki,this.aff,this.Smf).then(function(b){b=wac_w_c(b,!0);b.IsSuccess?wac_b(41460759,3E3,50,"Successfully retreived token for app [{0}]",a.FJ):wac_b(41460760,3E3,15,"Failed to retrieve token for app [{0}]: {1}",a.FJ,JSON.stringify(b));return b},function(a){a=wac_w_c(a,!1);if(("Timeout"===a.ErrorCode||"Token Renewal Failed"===a.ErrorCode)&&2>b.q$e)return b.q$e+=1,wac_b(42267907,
3E3,100,"Retrying to retrieve token for app [{0}] attempt {1}: {2}",b.FJ,b.q$e,JSON.stringify(a)),b.H5e();if("login_required"===a.ErrorCode&&1===b.Enf&&2>=b.r$e&&wac_q(wac_.pa,"WordOAuthTestAppPopUpIsEnabled"))return b.r$e+=1,wac_b(41460762,3E3,100,"Retrying retrieve token for app [{0}] with popup enabled, attempt {1}: {2}",b.FJ,b.r$e,JSON.stringify(a)),b.aff=!0,b.H5e();wac_b(41460764,3E3,15,"Failed to retrieve token for app [{0}]: {1}",b.FJ,JSON.stringify(a));return a})}};
function wac_w_c(a,b){var c=null,d=null,e=null;wac_h(a)?(d="NoResult",e="No result came from WebAuthJsImplictModule.GetToken()"):wac_h(a.ErrorCode)?wac_h(a.ErrorMessage)?wac_h(a.Token)?(d="Exception",e=JSON.stringify(a)):b?c=a.Token:(d="RejectToken",e="A rejected promise returned a token."):(d=wac_h(a.ErrorCode)?"Exception":a.ErrorCode,e=a.ErrorMessage):(d=a.ErrorCode,e=wac_h(a.ErrorMessage)?"No message":a.ErrorMessage);if(d||e)c=null;var f;return f=new wac_x_c,f.IsSuccess=!!c,f.Token=c,f.ErrorCode=
d,f.ErrorMessage=e,f}function wac_y_c(a,b,c){this.epf=b;this.G6e=new wac_z_c(a);this.F6e=c;wac_b(42084323,3E3,100,"OAuthManager Created")}wac_y_c.prototype={G6e:null,epf:null,F6e:null,h$e:null,Knf:!1};
function wac_A_c(a,b,c){function d(){if(a.Knf)return a.F6e.H5e(b,f,c,!1);var d;return Promise.resolve((d=new wac_x_c,d.IsSuccess=!1,d.Token=null,d.ErrorCode="InitFailed",d.ErrorMessage="Package failed to initialize.",d))}wac_b(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called",b,c);var e=wac_.pa.Qb.HostAuthType,f=null;"aad"===e.toLowerCase()?f=wac_xdb[b]:"msa"===e.toLowerCase()&&(f=wac_Jeb[b]);if(wac_h(f)){wac_b(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in WacFrameImplicitAuthAADApplications or WacFrameImplicitAuthMSAApplications.",
b);var g;return Promise.resolve((g=new wac_x_c,g.IsSuccess=!1,g.Token=null,g.ErrorCode="DisallowedApp",g.ErrorMessage="Disallowed appName: "+b,g))}a.F6e||(a.F6e=new wac_r_c(f,a.epf,a.G6e,wac_.pa));a.h$e||(a.h$e=a.F6e.Jdf().then(function(){a.Knf=!0;wac_b(42084353,3E3,100,"OAuthManager initialized for app [{0}]",b);return null},function(){wac_b(42267908,3E3,10,"OAuthManager failed to initialized for app [{0}], all future TryGetToken requests will fail.",b);return null}));return a.h$e=a.h$e.then(function(){return d()},
function(){return d()})}function wac_B_c(){}wac_B_c.prototype={Token:null,ErrorCode:null,ErrorMessage:null};function wac_x_c(){}wac_x_c.prototype={IsSuccess:!1,Token:null,ErrorCode:null,ErrorMessage:null};function wac_C_c(){}wac_C_c.prototype={Ub:function(){return"Common.App.OAuth.OAuthPackage"},gc:function(a){wac_m(wac_n(a.fa(wac_l_c)),function(){return new wac_y_c(a.H(wac_Kc),a.H(wac_jnc),null)})},tb:function(){},O:function(){}};function wac_u_c(){}function wac_z_c(a){this.Lof=a}
wac_z_c.prototype={RAf:"webauth.implicit",QAf:"Implicit",Zvf:"es6-promise.auto",Lof:null};function wac_s_c(a){var b=wac_cf(a.RAf,2),c=wac_cf(a.Zvf,2);window.self.WebAuthImplictScriptUrl=b;window.self.Es6PromisePolyfillJs=c;return wac_NO(a.Lof,b).CW(function(){wac_u_c.vie=window.self[a.QAf];wac_b(41003229,3E3,100,"WebAuth package loaded")})}wac_n_c.registerClass("Common.App.OAuth.IImplicitAuthConfig");wac_q_c.registerClass("Common.App.OAuth.IConfig");
wac_o_c.registerClass("Common.App.OAuth.IAadConfig",wac_q_c);wac_p_c.registerClass("Common.App.OAuth.IMsaConfig",wac_q_c);wac_r_c.registerClass("Common.App.OAuth.LegacyOAuthManager",null,wac_m_c);wac_v_c.registerClass("Common.App.OAuth.LegacyOAuthManager.RetryableGetToken");wac_y_c.registerClass("Common.App.OAuth.OAuthManager",null,wac_l_c);wac_B_c.registerClass("Common.App.OAuth.IImplicitAuthResult");wac_x_c.registerClass("Common.App.OAuth.OAuthResult");
wac_C_c.registerClass("Common.App.OAuth.OAuthPackage",null,wac_I,wac_i);wac_u_c.registerClass("Common.App.OAuth.WebAuthJsImplictModule");wac_z_c.registerClass("Common.App.OAuth.OAuthPackageLoader");wac_u_c.vie=null;wac_J(wac_C(),new wac_C_c,0,!1);Type.registerNamespace("Common.App.SaveACopy");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.f0d=wac_d.Qa.f0d||{};function wac_Ydb(){}wac_Ydb.registerInterface("Common.App.SaveACopy.IFileNameDialogFactory");function wac_Zdb(){}wac_Zdb.registerInterface("Common.App.SaveACopy.IFileNameDialog");
function wac_IT(a,b,c){this.Ia=a;this.Xy=b;this.Vga=c}wac_IT.prototype={Ia:null,Xy:null,Vga:null,Db:function(a){return new wac__db(this.Ia,this.Xy,this.Vga,a)}};function wac__db(a,b,c,d){this.w4a=Function.createDelegate(this,this.WGb);wac__db.initializeBase(this);this.Ia=a;this.Xy=b;this.Vga=c;wac_Oh(this,1,CommonUIStrings.l_SaveButtonLabel);this.po=wac_WO(wac_0db,CommonUIStrings.l_SaveACopyFileName);this._id="FileNameDialog-SaveACopy";this.LOc=d}
wac__db.prototype={Ia:null,Xy:null,Vga:null,AW:null,$Ua:null,LOc:null,n_:function(a,b,c){this.$Ua=a;this.AW=c;a={txtFileName:wac_kP(wac_.dJ.lw),lblFolderName:String.format(CommonUIStrings.l_DestinationFolder,b)};this.Zp(CommonUIStrings.l_SaveToOneDrive,this.w4a,a);wac_b(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()},WGb:function(a,b){1!==a?wac_b(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(a=b.txtFileName.trim(),
wac_b(7165651,216,50,"User click save to upload file with new name."),b=wac_If(wac_.Vxa),a&&""!==a&&""!==b&&(a+=b),this.Vga.xea(this.$Ua,this.AW,a,this.LOc))}};function wac_1db(){this.SB=Function.createDelegate(this,this.sC)}
wac_1db.prototype={sa:null,Ub:function(){return"Common.App.SaveACopy"},tb:function(){wac_.pa.Ok(this.SB)},sC:function(){wac_q(wac_.pa,"SaveACopyBrsIsEnabled")&&this.sa.H(wac_JT).Tb()},O:function(){},gc:function(a){this.sa=a;wac_n(wac_m(this.sa.fa(wac_KT),function(){return new wac_KT(wac_z(),a.H(wac_PQ),function(){return new wac_dn(!1)},function(){return new wac_LT(wac_z())},wac_r(),wac_r().Bz())}));wac_n(wac_m(wac_o(this.sa.fa(wac_IT),wac_Ydb),function(){return new wac_IT(wac_z(),wac_r().Hd(),a.H(wac_KT))}));
wac_n(wac_m(this.sa.fa(wac_JT),function(){return new wac_JT(a.H(wac_MT),a.H(wac_sQ),wac_.pa,wac_r().Bz())}));wac_n(wac_m(this.sa.fa(wac_MT),function(){return new wac_MT(a.H(wac_IT),a.H(wac_OQ),wac_qi(),a.H(wac_KT),wac_.pa,wac_Kg,function(){return new wac_LT(wac_z())})}))}};function wac_LT(a){this.Dwb=Function.createDelegate(this,this.yPb);wac_LT.initializeBase(this);wac_Nh(this,1);wac_Oh(this,1,CommonUIStrings.l_RetryButtonLabel);wac_Oh(this,0,CommonUIStrings.l_DialogClose);this.Ia=a}
wac_LT.prototype={Ia:null,Xp:function(a){wac_b(7165652,216,50,"Show error dialog here {0}.",a);this.hs(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,this.Dwb)},yPb:function(a){1===a?(wac_b(7165653,216,50,"User click to retry the action."),this.Ia.yw(4246497969,2,null)):wac_b(7165654,216,50,"User cancel the error dialog.")}};function wac_JT(a,b,c,d){wac_JT.initializeBase(this,[a,b,c,d]);this.IOc=b}
wac_JT.prototype={IOc:null,nzc:function(){return wac_q(this.Dc,"SaveACopyBrsIsEnabled")},Xwc:function(){return 4246497969},u9a:function(){var a=this.cic;wac_tl().xa(a);wac_R3a([new wac_wl(4246497969,2147483648,0)],wac_yQ(this.IOc))},hCc:function(){wac_b(7205456,216,50,"User clicked on SaveAs button from the backstage.")}};function wac_MT(a,b,c,d,e,f,g){wac_MT.initializeBase(this,[b,c,d,e,f,g]);this.EJc=a}
wac_MT.prototype={EJc:null,xA:function(a){a&&a.data&&a.data.folders?(wac_b(7165655,216,50,"User selected which folder to upload file to."),this.EJc.Db(this.LOc).n_(a.data.folders[0].id,a.data.folders[0].name,a.data.folders[0].urls.viewInBrowser)):(wac_b(7165656,216,10,"Fail to select folder to upload file."),this.Im())},Py:function(a){a&&a.error&&"user_canceled"===a.error.code&&wac_b(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");wac_QQ.prototype.Py.call(this,a)},Im:function(){wac_b(7205458,
216,50,"Error occur in Save A Copy Manager.");wac_QQ.prototype.Im.call(this)}};function wac_KT(a,b,c,d,e,f){wac_KT.initializeBase(this,[b,c,d,e,f]);this.Ia=a}
wac_KT.prototype={Ia:null,wE:function(){wac_b(7205459,216,50,"Display Error for Save A Copy.");wac_RQ.prototype.wE.call(this)},Hna:function(){wac_b(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");wac_RQ.prototype.Hna.call(this)},Gna:function(a){wac_b(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",a);wac_RQ.prototype.Gna.call(this,a)},sQ:function(){if(this.LOc&&"true"===this.LOc.SkipSaveToHost)wac_RQ.prototype.sQ.call(this);else if(32!==this.Ia.yw(3070187925,1,null))wac_b(8741711,
216,15,"The save file change is not supported, this operation may result in data loss"),wac_RQ.prototype.sQ.call(this);else{var a=this,b=this;this.Ia.os(3070187925,2,[function(){wac_b(8741712,216,50,"Call the force save file change successfully.");wac_RQ.prototype.sQ.call(a)},function(){wac_b(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");b.wE()}],null)}}};wac_IT.registerClass("Common.App.SaveACopy.FileNameDialogFactory",null,wac_Ydb);
wac__db.registerClass("Common.App.SaveACopy.FileNameDialog",wac__m,wac_Zdb);wac_1db.registerClass("Common.App.SaveACopy.PackageManager",null,wac_I,wac_i);wac_LT.registerClass("Common.App.SaveACopy.RetryDialog",wac_di,wac_37a);wac_JT.registerClass("Common.App.SaveACopy.SaveACopyActor",wac_NQ);wac_MT.registerClass("Common.App.SaveACopy.SaveACopyManager",wac_QQ);wac_KT.registerClass("Common.App.SaveACopy.SaveACopyUploadToCloudManager",wac_RQ);(function(){}).registerClass("Common.App.SaveACopy.FileNameDialogHtml");
var wac_0db="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";wac_J(wac_C(),new wac_1db,0,!1);Type.registerNamespace("Common");wac_d=window.Common||{};function wac_7Nb(a,b,c){this.$g=a;this.Tf=b;this.MC=c}
function wac_8Nb(a,b){b=b||"skypeproxy.ashx";return new wac_7Nb(new (wac_f.$$(wac_Wc))(function(){return wac_.Af}),a,b)}wac_7Nb.prototype={$g:null,Tf:null,MC:null,epb:function(){return this.$g.ma()},uc:function(a,b,c){this.epb().lk(this.MC,2,a.Serialization(),{"Content-Type":"application/json; charset=utf-8"},!1,2,b,c,null,null,!1,null,null,null,null,!1,null,!1)}};
function wac_9Nb(a,b,c){var d=a.Tf.uj("WebServiceCall","CreateSkypeChatThread");a.uc(new wac_$Nb(wac_.eo),function(a){d.vg();b(a)},function(a){d.vg();c(a)})}Type.registerNamespace("Common.App.SkypeChat");wac_d.Qa=wac_d.Qa||{};wac_d.Qa.RQb=wac_d.Qa.RQb||{};function wac_aOb(a,b,c){this.Email=a;this.InChat=b;this.Capabilities=c}function wac_bOb(){}wac_bOb.registerInterface("Common.App.SkypeChat.IDocChatClient");function wac_cOb(){}wac_cOb.registerInterface("Common.App.SkypeChat.IDocChatClientFactory");
function wac_m4(){}wac_m4.registerInterface("Common.App.SkypeChat.IDocChatUserIdFactory");function wac_dOb(){this.Ra=new wac_Re}wac_dOb.prototype={Ra:null,DPc:!1,M9:function(a){this.Ra.xa("AVCEK",a)},uBf:function(a){this.Ra.xa("CACEK",a)},bCf:function(a){this.Ra.sb("CACEK",a)},xZa:function(a){this.Ra.xa("MPUEK",a)},TOb:function(){this.Ra.wa("MPUEK",null,null)}};
function wac_eOb(a,b){b!==a.DPc&&(a.Ra.wa("AVCEK",new wac_n4(b,!1),null),a.DPc=b,wac_b(6603939,333,50,"Chat availability changed to now be {0}",b))}function wac_fOb(){this.Ra=new wac_Re}wac_fOb.prototype={};function wac_n4(a,b){wac_n4.initializeBase(this);this.pzb=a;this.Rjc=b}wac_n4.prototype={pzb:!1,Rjc:!1};function wac_gOb(a,b,c){this.Cvb=Function.createDelegate(this,this.yLb);this.aNc=a;this.dKc=b;this.QZb=c}
wac_gOb.prototype={QZb:null,aNc:null,dKc:null,_initialized:!1,tb:function(){this._initialized?wac_b(9000738,333,15,"Init called multiple times"):(this._initialized=!0,wac_q(wac_.pa,"DocChatIsEnabled")&&this.dKc.uc(this.Cvb))},yLb:function(a){var b=this;wac_c4(a).CW(function(){var c=wac_Qb(wac_c4(a));c.uka?b.Z4c(c):c.gva&&(wac_.PSa&&3!==a.wW?wac_b(18121750,333,50,"DocChatBootstrapper: Anonymous Doc Chat is not available because the user name is unknown."):b.Z4c(c))})},Z4c:function(a){wac_b(9000739,
333,15,"DocChatBootStrapper: Doc chat is enabled.");var b=this.aNc.ma();b.SSc=wac_.J0;b.R7=a;b.mmb||(b.mmb=new (wac_Rb.$$(Boolean)),b.OUb?wac_iOb(b):(wac_b(8730523,333,15,"docChatClient is null"),b.mmb.Ze(!1)));this.QZb&&this.QZb()}};function wac_o4(a,b){this.Vfd=Function.createDelegate(this,this.BOd);this.Ra=new wac_Re;this.GTb=a;this.Tf=b}
wac_o4.prototype={HTa:null,GTb:null,NDa:null,eW:null,Tf:null,pkb:null,gH:!1,gN:!1,M9:function(a){this.Ra.xa("ACE",a)},BOd:function(a,b){a=2===b.nva||4===b.nva||5===b.nva;!this.NDa.oj().qB()&&a&&wac_W1a(this.NDa,!0);this.gN=this.gH&&2!==b.nva&&5!==b.nva;this.gH=this.gH&&!this.gN;this.Ra.wa("ACE",new wac_n4(a,this.gN),null)},AZa:function(a){this.Ra.xa("UCC",a)},Iya:function(a,b,c,d){if(a){this.pkb=this.Tf.S_("ServerNotification","JoinSkypeChatThreadClient");var e=this,f=this;this.pkb.Wd();this.eW.Iya(a.KL,
function(){e.pkb.vg();e.gH=!0;e.gN=!1;b()},function(){f.pkb.vg();f.gH=!1;f.gN=!1;c()},d,a.yZ)}else wac_b(18200789,333,10,"Unexpected attempt to join doc chat without any chat thread info!")},yZa:function(a){this.Ra.xa("PSC",a)}};function wac_jOb(a){if(a.NDa)return a.NDa.oj();a.NDa=new (wac_Rb.$$(Boolean));a.GTb.CW(function(){a.HTa=wac_Qb(a.GTb);a.eW=a.HTa.Db(a.Vfd);a.eW.tb();a.eW.yZa(function(b,c){a.Ra.wa("PSC",c,null)});a.eW.AZa(function(b,c){a.Ra.wa("UCC",c,null)})});return a.NDa.oj()}
function wac_kOb(a){this.PIc=a}wac_kOb.prototype={PIc:null,Db:function(){return this.PIc.ma()}};function wac_lOb(a,b){this.Cvb=Function.createDelegate(this,this.yLb);this.gTb=a;this.FTb=b}wac_lOb.prototype={gTb:null,FTb:null,p2:null,DC:null,y2b:function(){return wac_sP(String,"")},yLb:function(){var a=wac_Qb(this.gTb),b=this;wac_c4(a).CW(function(){3===a.wW?b.p2.Ze(wac_.Ag):wac_Qb(wac_c4(a)).uka?wac_mOb(b):wac_nOb(b)})}};function wac_nOb(a){a.y2b().CW(function(){a.p2.Ze(wac_Qb(a.y2b()))})}
function wac_mOb(a){a.FTb.CW(function(){a.DC=wac_Qb(a.FTb).Db(null);a.DC.tb().CW(function(){a.DC.L2b().CW(function(){a.p2.Ze(wac_Qb(a.DC.L2b()))})})})}function wac_oOb(a){if(a.p2)return a.p2.oj();a.p2=new (wac_Rb.$$(String));a.gTb.CW(a.Cvb);return a.p2.oj()}function wac_pOb(a){this.BaseDocQuerySignature=a}wac_pOb.prototype={BaseDocQuerySignature:null,Serialization:function(){return wac_ai([this.ii(),this])}};function wac_$Nb(a){wac_$Nb.initializeBase(this,[a])}wac_$Nb.prototype={ii:function(){return 1}};
function wac_p4(a,b,c,d,e,f){this.Zua=Function.createDelegate(this,this.Ada);this.Yvb=Function.createDelegate(this,this.DMb);this.$ua=Function.createDelegate(this,this.kza);this.nJa=Function.createDelegate(this,this.hV);this.Bvb=Function.createDelegate(this,this.sLb);wac_p4.initializeBase(this);this.WN=a;this.SZb=b;this.UZb=c;this.G1b=d;this.Wqa=e;this.Dc=f;this.b6e=new (wac_g.$$(String))}
wac_p4.prototype={Fp:null,FDa:null,WN:null,SZb:null,UZb:null,Wqa:null,Dc:null,TZb:null,G1b:null,GXa:null,kDa:null,_initialized:!1,b6e:null,tb:function(){wac_b(9000769,333,50,"Init - RtcChatAvailabilityFinder");return wac_Db.WAA(wac_oOb(this.G1b),this.WN,this.UZb,this.Wqa,this.SZb).CW(this.Bvb)},sLb:function(){wac_b(6603968,333,50,"All prerequisite ready for RtcChatAvailabilityFinder");this.Fp=wac_Qb(this.WN);this.TZb=wac_Qb(this.UZb);this.FDa=wac_Qb(this.SZb);this.kDa=wac_Qb(wac_oOb(this.G1b));this.GXa=
wac_Qb(this.Wqa);this.Fp.Kra(this.nJa);this.Fp.zZa(this.$ua);this.Fp.xZa(this.Yvb);this.Fp.hob(this.Zua);if(this.kDa||this.FDa.wI){this.FDa.wI=this.FDa.wI||this.kDa;this.FDa&&this.TZb&&(wac_PNc(this.FDa.lr,4),this.TZb.Tza());if(this.Fp){var a;if(a=(a=this.Fp.pOa(1))&&this.Fp.iS()in a?a[this.Fp.iS()]:new wac_aOb("",!1,0))a.Email=this.kDa,a.Capabilities=1,this.Fp.LRa(1,a)}this._initialized=!0;wac_q4(this)}else wac_b(6603969,333,10,"Email in presence context is null or undefined. This will cause Skype to not work")},
hV:function(){wac_q4(this)},kza:function(a,b){a=Date.now();wac_q4(this);var c=b.nU;if(wac_q(this.Dc,"PeoplesWellExtraButtonInfoIsEnabled")){var d=new (wac_g.$$(String)),e;for(e in c){var f=this.GXa.Axc({key:e,value:c[e]});if(f){var g=this.Glf(f.iS());0<=this.b6e.DJd(f.iS())&&!g?(this.b6e.Rc(f.iS()),d.ga(f.iS())):0>this.b6e.DJd(f.iS())&&g&&(this.b6e.ga(f.iS()),d.ga(f.iS()))}else wac_b(42824128,333,15,"Presence was null when we should always have a defined value from updatedClients")}0<d.Ma()&&(this.Ra.wa("CACEK",
new Sys.EventArgs,null),wac_b(42521618,333,50,"Chat availability changed for the following coauthors {0}",d))}e=Date.now()-a;b.iTa&&b.iTa.Nq(e,"RtcChatAvailabilityFinder")},DMb:function(){this.TOb()},Ada:function(a,b){1===b.Fg&&wac_q4(this)},Glf:function(a){if(!this._initialized)return wac_b(42521619,333,50,"Find Coauthor Availability with was called before component was initialized"),!1;if(2!==this.Fp.P8a())return wac_b(42521620,333,50,"Rtc Connection not yet established: state: {0}",this.Fp.P8a()),
!1;var b={};b[a]=this.Fp.pOa(1)[a];var b=wac_D_c(this,b),c={};c[a]=this.Fp.wHb()[a];a=wac_E_c(this,c);return b||a}};function wac_D_c(a,b){if(!b)return!1;for(var c in b){var d=b[c];if(d&&d.Email&&d.Capabilities&1&&d.Email!==a.kDa)return!0}return!1}function wac_E_c(a,b){if(!b)return!1;for(var c in b){var d=a.GXa.Axc({key:c,value:b[c]});if(d&&d.wI&&d.lr&&d.lr.lr&4&&d.wI!==a.kDa)return!0}return!1}
function wac_q4(a){if(!a._initialized)return wac_b(6603970,333,50,"Anyone to chat with was called before component was initialized"),wac_eOb(a,!1),!1;if(2!==a.Fp.P8a())return wac_b(6649866,333,50,"Rtc Connection not yet established: state:{0}",a.Fp.P8a()),wac_eOb(a,!1),!1;var b=a.Fp.wHb(),c=a.Fp.pOa(1),b=wac_E_c(a,b)||wac_D_c(a,c);wac_eOb(a,b);return b}
function wac_r4(a,b,c,d,e){this.Qfd=Function.createDelegate(this,this.vOd);this.Yvb=Function.createDelegate(this,this.DMb);this.T5c=Function.createDelegate(this,this.Qxd);this.xgd=Function.createDelegate(this,this.dPd);this.Rfd=Function.createDelegate(this,this.wOd);this.Pfd=Function.createDelegate(this,this.uOd);this.IJa=Function.createDelegate(this,this.LQa);this.awb=Function.createDelegate(this,this.MMb);this.Edd=Function.createDelegate(this,this.tKd);this.Qod=Function.createDelegate(this,this.AZd);
this.Hdd=Function.createDelegate(this,this.SKd);this.Jpd=Function.createDelegate(this,this.N_d);this.N8c=Function.createDelegate(this,this.lCd);this.Dnd=Function.createDelegate(this,this.TXd);this.BT=a;this.mDa=c;this.kBa=!1;this.eX=d;this.$Aa=e;this.OUb=b}
wac_r4.prototype={s1b:0,qHc:!1,cUa:!1,aHc:!1,kBa:!1,jhb:!1,ipe:!1,FWb:!1,QIc:!1,RIc:!1,hpe:!1,gH:!1,lBa:!1,gN:!1,bke:!1,SSc:null,mDa:null,ZWa:null,R7:null,eX:null,$Aa:null,jpe:!1,mmb:null,BT:null,OUb:null,uR:null,tI:null,ar:function(){return wac_2k.FEc},Tb:function(){wac_c(5269512,333,!!this.BT,null);this.BT.Mp(this.ar().Vdb,2147483648,this.Dnd,96);this.BT.ja(this.ar().ogb,2147483648,this.N8c);wac_qOb()?this.BT.ja(this.ar().aKb,2147483648,this.Jpd):this.BT.ja(this.ar().aKb,2147483648,this.Hdd);this.BT.Mp(this.ar().mCc,
2147483648,this.Qod,96);this.BT.ja(3799468329,2147483648,this.Edd)},LQa:function(a,b){this.s1b=b.zDb;wac_s4(this)},MMb:function(){wac_s4(this);this.qHc=this.qHc||1===(this.uR.eW.R9()?1:0);this.ipe&&1===(this.uR.eW.R9()?1:0)&&!this.jpe&&(wac_b(6129288,333,50,"Doc chat started and pane toggled"),this.jpe=!0)},Qxd:function(a,b){this.jhb=b.pzb;wac_Rnc(this);wac_s4(this)},uOd:function(a,b){wac_rOb(this,b.pzb,b.Rjc)},TXd:function(a,b,c,d,e){a=this.jhb&&this.FWb||!!this.tI;e[wac_HS.Visible]=a;wac_DCb(this.R7)&&
(e.On=1===(this.uR.eW.R9()?1:0),wac_r().Hd().Bg()?wac_r().Hd().qze()?e[wac_$8a.Icon]=0<this.s1b?"DocChatUnreadGray_16":"DocChat_20":e[wac_$8a.Icon]=0<this.s1b?"DocChatUnread_20":"DocChatGlyph_20":e[wac_HS.Image16by16Class]=wac_9h(0<this.s1b?this.ar().jFc:this.ar().gbb));a&&!this.aHc&&(wac_b(6350045,333,15,"Setting visibility of the chat button to true"),this.aHc=!0);return 32},wOd:function(a,b){this.BT.os(2246375352,2,b.tI,null)},dPd:function(){wac_qOb()&&this.BT.os(2246375352,2,null,null)},SKd:function(a,
b,c,d,e){if(2!==c)return 32;wac_sOb(this);if(!this.kBa)return wac_b(16808076,333,15,"Join operation before client is ready"),wac_t4(this),8;if(!e)return wac_b(18493662,333,10,"Invalid ChatThreadInfo."),wac_t4(this),8;if(this.lBa||this.gH)return wac_b(18900674,333,50,String.format("Ignoring chat thread {0}. Already connecting or connected to it.",e.KL)),32;if(!this.tI||this.gN)wac_b(18900675,333,50,String.format("Co-authors sent chat thread {0} and we're not connected to it...attempt to connect.",
e.KL)),wac_tOb(this,e,!1);return 32},N_d:function(a,b,c){if(2!==c)return 32;wac_sOb(this);if(!this.kBa)return wac_b(21550145,333,15,"Join operation before client is ready"),wac_t4(this),8;if(this.cUa||this.lBa)return wac_b(22045828,333,50,"Ignoring coauthors' InChat flag. Already retrieving the chat info or connecting to doc chat."),1;if(this.gH)return wac_b(21550146,333,50,"Ignoring coauthors' InChat flag. Already connected to doc chat."),32;if(!this.tI||this.gN)wac_b(21550147,333,50,"Co-authors sent InChat flag and we're not connected to the Doc Chat...attempt to connect."),
wac_uOb(this,!1);return 32},DMb:function(){!this.lBa&&!this.gH&&this.tI&&this.gN&&(wac_b(18900676,333,50,String.format("User is active but disconnected from doc chat. Attempting to reconnect to chat thread {0}...",this.tI.KL)),this.BT.os(2246375352,2,this.tI,null))},vOd:function(){this.lBa=!1;this.gH=!0;wac_b(5616863,333,50,"Join operation was successful")},tKd:function(){return this.gH&&!this.gN?32:8},lCd:function(a,b,c){if(2===c){wac_sOb(this);if(!this.kBa)return wac_t4(this),8;if(this.cUa)return 1;
this.bke=this.ipe=!0;this.jhb&&this.FWb&&!this.tI?wac_uOb(this,!0):wac_DCb(this.R7)&&1===(this.uR.eW.R9()?1:0)?this.uR.eW.A_():wac_tOb(this,this.tI,!0)}return this.kBa?32:8},Hfb:function(){},AZd:function(){wac_s4(this);return 32}};function wac_sOb(a){a.RIc||(a.RIc=!0,wac_b(36705360,333,15,"Usage of doc chat"))}function wac_t4(a){a.QIc||(a.QIc=!0,wac_b(36705359,333,15,"Bad user interaction with doc chat."))}
function wac_uOb(a,b){wac_b(5616864,333,50,"Trying to create a new thread");a.cUa=!0;wac_9Nb(a.eX,function(c){wac_b(5616865,333,50,"Thread created successfully");var d=!1;if(c.Aa)if(c=c.Aa.Be){var e;a:{if(c)try{e=wac_yl(c);break a}catch(f){wac_b(5328906,333,10,"could not parse the response of request: {0}",c.substr(0,Math.min(c.length,250)))}else wac_b(5328905,333,10,"Response from SkypeProxy was null");e=null}e&&e.Success?(wac_b(5328903,333,50,"Created ChatThreadId is :{0}",e.ThreadId),wac_tOb(a,
new wac_3h(e.ThreadId,e.DiscoveryUri),b),d=!0):wac_b(5616866,333,10,"Could not parse the response, parsed response is null or create thread operation failed.")}else wac_b(5328902,333,10,"ResponseData is null");else wac_b(5328901,333,10,"e.Data is null");b&&!d&&(wac_t4(a),a.Hfb());a.cUa=!1},function(){a.cUa=!1;b&&(wac_t4(a),a.Hfb());wac_b(5328904,333,15,"Try to create thread for this user failed")})}
function wac_tOb(a,b,c){b?(a.tI=b,c&&a.uR.eW.HV(),wac_vOb(a,c),wac_wOb(a)):wac_b(18419974,333,10,"Unexpected attempt to get on the doc chat without any chat thread info!")}function wac_wOb(a){a.mDa.CW(function(){var b=wac_Qb(a.mDa);b.Vlb.CWO(b.xpd,a.tI);wac_xOb()&&(b=a.ZWa,b.WN.CW(b.wpd))})}
function wac_vOb(a,b){a.lBa=!0;a.gH=!1;a.gN=!1;a.uR.Iya(a.tI,a.Qfd,function(){a.bke?(a.bke=!1,wac_b(38088785,333,15,"Join operation failed, retrying."),wac_vOb(a,b)):(a.lBa=!1,b&&(wac_t4(a),a.Hfb()),wac_b(5616860,333,10,"Join operation failed even after retrying."))},a.SSc)}function wac_rOb(a,b,c){a.FWb=b;a.gN=a.gH&&c;a.gH=a.gH&&!a.gN;wac_s4(a)}
function wac_yOb(a,b){b?(a.Tb(),a.kBa=!0,a.uR.yZa(a.awb),a.uR.AZa(a.IJa),a.uR.M9(a.Pfd),a.mDa&&a.mDa.CW(function(){a.ZWa=wac_Qb(a.mDa);a.ZWa.Ra.xa("NTID_EK",a.Rfd);wac_xOb()&&a.ZWa.Ra.xa("DCD_EK",a.xgd);a.ZWa.tb()}),a.$Aa&&a.$Aa.tb().CW(function(){wac_b(9000771,333,50,"AvailabilityFinder ready");a.$Aa.M9(a.T5c);a.$Aa.xZa(a.Yvb);a.jhb=wac_q4(a.$Aa);wac_Rnc(a);wac_s4(a)}),wac_rOb(a,!0,!1)):wac_b(9000770,333,10,"Doc chat client not ready")}
function wac_Rnc(a){!a.hpe&&a.jhb&&(wac_b(37597725,333,15,"Doc chat is available"),a.hpe=!0)}function wac_iOb(a){a.uR=a.OUb.Db();var b=wac_jOb(a.uR);b.CW(function(){var c=wac_Qb(b);wac_yOb(a,c);a.mmb.Ze(c)})}function wac_xOb(){return wac_q(wac_.pa,"DocChatDiscoveryViaPersistentStateChannelIsEnabled")}function wac_qOb(){return wac_q(wac_.pa,"DocChatJoinInfoFromServerIsEnabled")}
function wac_u4(a,b,c,d){this.wpd=Function.createDelegate(this,this.A_d);this.xpd=Function.createDelegate(this,this.B_d);this.Zua=Function.createDelegate(this,this.Ada);this.$ua=Function.createDelegate(this,this.kza);this.Bvb=Function.createDelegate(this,this.sLb);wac_u4.initializeBase(this);wac_b(5895065,333,50,"Initializing chat notifier");this.WN=a;this.Zfa=c;this.Vlb=b;this.Wqa=d}
wac_u4.prototype={WN:null,Fp:null,Vlb:null,Zfa:null,xYb:null,APc:!1,Wqa:null,GXa:null,qPc:!1,tb:function(){return wac_Db.WAA.call(null,this.Wqa,this.WN,this.Zfa).CW(this.Bvb)},sLb:function(){wac_b(6603971,333,50,"All prerequisite ready for SkypeChatNotifier");this.GXa=wac_Qb(this.Wqa);this.xYb=wac_Qb(this.Zfa);this.Fp=wac_Qb(this.WN);wac_zOb(this,this.Fp.wHb());wac_AOb(this,this.Fp.pOa(1));wac_b(5898719,333,50,"Subscribing to presence updates");this.Fp.zZa(this.$ua);this.Fp.hob(this.Zua)},kza:function(a,
b){a=Date.now();this.xYb&&(this.APc||(this.APc=!0,wac_b(6555618,333,50,"SkypeChat complemented recorded presence update")),wac_zOb(this,b.nU),a=Date.now()-a,b.iTa&&b.iTa.Nq(a,"SkypeChatRtcNotifier"))},Ada:function(a,b){1===b.Fg&&(this.qPc||(this.qPc=!0,wac_b(21803734,333,50,"SkypeChat recorded persistent state update")),wac_AOb(this,b.nU))},B_d:function(a,b){var c=this;wac_Db.WAA(this.Zfa,this.Vlb).CW(function(){wac_Qb(c.Zfa).KL=b.KL;wac_Qb(c.Zfa).yZ=b.yZ;wac_b(5898752,333,50,"Re-sending the latest presence with the chatThreadId:{0}, chatThreaddiscoveryUri:{1}",
wac_Qb(c.Zfa).KL,wac_Qb(c.Zfa).yZ);wac_Qb(c.Vlb).Tza()})},A_d:function(){var a=this;wac_Db.WAA(this.WN).CW(function(){var b;b=(b=wac_Qb(a.WN).pOa(1))&&wac_Qb(a.WN).iS()in b?b[wac_Qb(a.WN).iS()]:new wac_aOb("",!1,0);b.InChat=!0;wac_b(21803737,333,50,"Re-sending the latest persistent state");wac_Qb(a.WN).LRa(1,b)})}};
function wac_AOb(a,b){for(var c in b){var d={key:c,value:b[c]},e=d.value;if(e&&e.InChat&&d.key!==a.Fp.iS()){wac_b(21803735,333,50,"User found in chat");a.Ra.wa("DCD_EK",null,null);break}}}function wac_zOb(a,b){for(var c in b){var d=a.GXa.Axc({key:c,value:b[c]});if(d){var e=d.KL;if(e&&d.iS()!==a.xYb.iS()){wac_b(5895069,333,50,String.format("Chat thread id found : {0}",e));a.Ra.wa("NTID_EK",new wac_2h(new wac_3h(e,d.yZ)),null);break}}}}function wac_BOb(){}
wac_BOb.prototype={Ub:function(){return"Common.App.SkypeChat"},gc:function(a){wac_m(wac_n(a.fa(wac_o4)),function(){return new wac_o4(wac_rP(wac_Jm,wac_l(a,wac_Jm)),wac_r().Bz())});wac_m(wac_n(wac_o(a.fa(wac_kOb),wac_cOb)),function(){return new wac_kOb(new (wac_f.$$(wac_o4))(function(){return a.H(wac_o4)}))})},tb:function(){},O:function(){}};wac_7Nb.registerClass("Common.SkypeProxyRequestHandler");wac_aOb.registerClass("Common.App.SkypeChat.ChatPersistentState");(function(){}).registerClass("Common.App.SkypeChat.SkypeProxyCreateThreadResponse");
wac_dOb.registerClass("Common.App.SkypeChat.AChatAvailabilityFinder",null,wac_9la);wac_fOb.registerClass("Common.App.SkypeChat.ASkypeChatNotifier",null,wac_Cc);wac_n4.registerClass("Common.App.SkypeChat.ChatAvailabilityChangedEventArgs",Sys.EventArgs,wac_8la);wac_gOb.registerClass("Common.App.SkypeChat.DocChatBootstrapper");wac_o4.registerClass("Common.App.SkypeChat.DocChatClient",null,wac_bOb);wac_kOb.registerClass("Common.App.SkypeChat.DocChatClientFactory",null,wac_cOb);
wac_lOb.registerClass("Common.App.SkypeChat.DocChatUserIdFactory",null,wac_m4);wac_pOb.registerClass("Common.App.SkypeChat.ASkypeProxyRequest");wac_$Nb.registerClass("Common.App.SkypeChat.SkypeProxyCreateThreadRequest",wac_pOb);(function(){}).registerClass("Common.App.SkypeChat.SkypeProxyResponseHelper");wac_p4.registerClass("Common.App.SkypeChat.RtcChatAvailabilityFinder",wac_dOb);wac_r4.registerClass("Common.App.SkypeChat.SkypeChatActor",null,wac_$la);
wac_u4.registerClass("Common.App.SkypeChat.SkypeChatRtcNotifier",wac_fOb);wac_BOb.registerClass("Common.App.SkypeChat.SkypeChatPackage",null,wac_I,wac_i);wac_J(wac_C(),new wac_BOb,0,!1);Type.registerNamespace("Common.App.SmartLookup");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.Tdd=wac_d.Qa.Tdd||{};function wac_F_c(){}function wac_G_c(){}function wac_zYc(){}function wac_H_c(){}function wac_BYc(){}wac_BYc.registerInterface("Common.App.SmartLookup.ISerpletExecutor");function wac_WFc(){}
function wac_VFc(){}window.Common.App.SmartLookup.EntryPoint=wac_d.Qa.Tdd.bMe=function(){};wac_d.Qa.Tdd.bMe.prototype={other:0,tellMe:1};window.Common.App.SmartLookup.EntryPoint.registerEnum("Common.App.SmartLookup.EntryPoint",!1);window.Common.App.SmartLookup.LaunchMode=wac_d.Qa.Tdd.$cf=function(){};wac_d.Qa.Tdd.$cf.prototype={"default":0,documentsView:1,objectsView:2};window.Common.App.SmartLookup.LaunchMode.registerEnum("Common.App.SmartLookup.LaunchMode",!1);function wac_CYc(){}wac_CYc.registerInterface("Common.App.SmartLookup.ISmartLookupManager");
function wac_FYc(){}wac_FYc.prototype.s9d=function(){return"SerpletExecutor"};wac_FYc.prototype.getId=wac_FYc.prototype.s9d;function wac_EYc(a){var b=new wac_bea;b.name="Office.Insights.SmartLookup.LaunchPane";b.samplingPolicy=2;var c=[];(a=wac_yZc("AppCorrelationId",a))&&Array.add(c,a);b.dataFields=c;wac_Sfa(b)}
function wac_I_c(a){wac_b(41521353,1313,50,"SmartLookupManager - Initialize");this.wpf=wac_.pa.Qb.SmartLookupApprovedOriginPattern;this.M7e=wac_.pa.Qb.SmartLookupShredderServiceEndpoint;this.a3e=new wac_G_c;this.a3e.EnableAllTabV2=wac_q(wac_.pa,"SmartLookupEnableAllTabV2");this.a3e.EnableIntentService=wac_q(wac_.pa,"SmartLookupEnableIntentService");this.a3e.EnableHelpCard=wac_q(wac_.pa,"SmartLookupEnableHelp");this.a3e.EnableInDocumentSearch=wac_q(wac_.pa,"SmartLookupEnableInDocumentSearch");this.a3e.IntentServiceEndpoint=
wac_J_c();this.qBe=a}wac_I_c.prototype={qBe:null,wpf:null,M7e:null,a3e:null,gwf:function(a){var b=this;return new Promise(function(c){a?wac_K_c(b).then(function(a){c(wac_L_c(b,a))}):c(wac_L_c(b,null))})},yPe:function(a){a=a.split("-");return a[a.length-1]}};
function wac_L_c(a,b){var c=new wac_F_c;c.anid="";c.applicationVersion=wac_.jv;c.appCorrelationId=wac_5k().toString();c.themePlatform="web";c.lcid=wac_.vh;c.lcid=wac_.vh;c.launchUtcTime=(new Date).toUTCString();c.featureGates=a.a3e;var d=wac_nm(wac_.vh),d=d?d._name:null;c.market=a.yPe(d);c.uiLanguage=d;c.sessionId=wac_.Ag;c.themeId=0;c.parentalControl="yes";var e=new wac_H_c;e.CountryCode=a.yPe(d);e.ServiceEndpoint=a.M7e;e.IsGoLocal=!1;b?(e.IsEnabled=!0,e.IsEnterpriseEnabled=!0,e.TenantRoot="",c.accessToken=
b):(e.IsEnabled=!1,e.IsEnterpriseEnabled=!1,e.TenantRoot="",c.accessToken="");c.enterpriseUserInfo=e;return c}
function wac_K_c(a){return new Promise(function(b){a.M7e&&a.M7e.length?wac_A_c(a.qBe,"SmartLookup",a.M7e).then(function(a){a.IsSuccess?a.Token&&a.Token.length?b(a.Token):(wac_b(41521354,1313,15,"SmartLookupManager - The AAD token is empty"),b(null)):(wac_b(42231944,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+a.ErrorCode+": "+a.ErrorMessage),b(null))}).catch(function(a){a=wac_ai(a);wac_b(41521355,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+a);b(null)}):
b(null)})}function wac_AYc(){}wac_AYc.prototype={sa:null,Ub:function(){return"Common.App.SmartLookup"},gc:function(a){this.sa=a;wac_b(41521356,1313,50,"SmartLookupPackage - Initialize");var b=this;wac_m(wac_n(this.sa.fa(wac_CYc)),function(){return new wac_I_c(b.sa.H(wac_l_c))})},O:function(){}};
function wac_J_c(){var a;a:switch(window.$$as(String,wac_.m0.AudienceGroup)||""){case "Dogfood":a=wac_.pa.Qb.UserPrincipalName;a=wac_rd(a);var b=wac_bf(wac_.pa,"SmartLookupINTEnabledForSKITeam");a=0<=Array.indexOf(b,a)?wac_q(wac_.pa,"SmartLookupEnableEdogSourceLocationOverride")?"EDOG":"INT":"EDOG";break a;default:a="PROD"}switch(a){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";
default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}wac_F_c.registerClass("Common.App.SmartLookup.ApplicationProperties");wac_G_c.registerClass("Common.App.SmartLookup.FeatureGates");wac_zYc.registerClass("Common.App.SmartLookup.ConfigurationProvider");wac_H_c.registerClass("Common.App.SmartLookup.EnterpriseUserInfo");wac_WFc.registerClass("Common.App.SmartLookup.SmartLookupApplicationInterface");wac_VFc.registerClass("Common.App.SmartLookup.Selection");
wac_FYc.registerClass("Common.App.SmartLookup.BaseSerpletExecutor",null,wac_BYc);(function(){}).registerClass("Common.App.SmartLookup.LoggingUtils");wac_I_c.registerClass("Common.App.SmartLookup.SmartLookupManager",null,wac_CYc);wac_AYc.registerClass("Common.App.SmartLookup.SmartLookupPackage",null,wac_I,wac_i);(function(){}).registerClass("Common.App.SmartLookup.Utils");Type.registerNamespace("Box4.Media");wac_K=window.Box4||{};wac_K.QPa=wac_K.QPa||{};function wac_gRb(){}wac_gRb.registerInterface("Box4.Media.IInsertMediaHelper");
function wac_44(){}wac_44.registerInterface("Box4.Media.IOneDriveFilePickerHelper");function wac_hRb(){}wac_hRb.registerInterface("Box4.Media.IImageFilePickerHelper");function wac_iRb(){}wac_iRb.registerInterface("Box4.Media.IInsertOnlineMediaHelper");function wac_7vc(){}wac_7vc.registerInterface("Box4.Media.IInsertOnlineMediaHandler");function wac_jRb(){}wac_jRb.registerInterface("Box4.Media.IInsertMediaCrossDocumentMessenger");function wac_54(){}wac_54.registerInterface("Box4.Media.IInsertMediaCrossDocumentMessengerFactory");
function wac_kRb(){}wac_kRb.registerInterface("Box4.Media.IInsertMediaDialog");function wac_64(){}wac_64.registerInterface("Box4.Media.IInsertMediaDialogFactory");function wac_74(){}wac_74.registerInterface("Box4.Media.IInsertMediaFromHostManagerFactory");function wac_84(){}wac_84.registerInterface("Box4.Media.IInsertMediaFromHostOneDriveHostFrame");wac_K.QPa.xKb=function(){};wac_K.QPa.xKb.prototype={Image:0,Video:1};wac_K.QPa.xKb.registerEnum("Box4.Media.MediaType",!1);function wac_94(){}
function wac_lRb(){}wac_lRb.registerInterface("Box4.Media.IPickerDialog");
function wac_$4(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t){this.y5a=Function.createDelegate(this,this.FQb);this.prd=Function.createDelegate(this,this.j2d);this.nrd=Function.createDelegate(this,this.i2d);this.Xwb=Function.createDelegate(this,this.XRb);this.Nwb=Function.createDelegate(this,this.EQb);this.dispose=this.O;this.gga=d;this.lXa=e;this.M6d=g;this.jLc=h;this.F8=k;this.Ia=a;this.Dc=b;this.u1=f;this.bMc=n;this.Z6d=p;this.Djb=q;this.OVa=c;this.lLc=l;this.tWb=m;this.QNe=r;this.RNe=t}
wac_$4.prototype={Ia:null,Dc:null,OVa:null,u1:null,M6d:null,jLc:null,F8:null,lLc:null,tWb:null,Djb:null,Z6d:!1,bMc:!1,QNe:null,RNe:null,lXa:null,gga:null,w_a:!1,Tb:function(){(this.OVa.Vyc||this.OVa.HJb)&&this.OVa.Uyc&&this.kOb();wac_M_c(this);this.Ia.Mp(720118144,2,this.Nwb,260);this.Ia.Mp(3612507612,2,this.Xwb,100);this.Ia.Mp(2494479545,2,this.nrd,260)},kOb:function(){wac_r().Nc().appendChild(this.lXa.pH);wac_tf(this.lXa.pH.contentWindow,"message",this.y5a);this.w_a=!0},FQb:function(a){if(a.rawEvent&&
(a=a.rawEvent.data))try{var b=Sys.Serialization.JavaScriptSerializer.deserialize(a,!0),c=b.MessageId?b.MessageId.toString():null;b&&c&&("UI_InsertImage"===c||"UI_InsertFileLink"===c)&&this.gga.Wd("UI_InsertImage"===c?this.lLc:this.tWb)}catch(d){}},XRb:function(a,b,c,d,e){if(1===c)return 32;a=wac_r().Hd().Bg();this.bMc?a=a?CommonUIStrings.l_OneDriveName:String.format(CommonUIStrings.L_OnlinePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.Djb?a=a?this.Djb:String.format(CommonUIStrings.L_OnlinePictureFromHost,
this.Djb):(a=a?CommonUIStrings.l_HostGeneric:CommonUIStrings.l_OnlinePictureFromHostGeneric,wac_b(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));e[wac_WS.LabelText]=a;return 32},j2d:function(){throw wac_Xb();},i2d:function(a,b,c){a=32===this.Ia.u6(b,2711544537,1,!1,null,null,null);if(1===c)return a&&this.OVa.HJb?32:8;if(2!==c||!a)return 8;wac_b(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");
return this.DQb(this.jLc.IG(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.tWb)},EQb:function(){throw wac_Xb();},DQb:function(a,b,c){try{return a.hSa(b,c),wac_b(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(d){return wac_b(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",d.toString()),this.Im(5242881,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}},Im:function(a,b,c){var d=
new wac_di(!0);d.wr=wac_.wVd;wac_Nh(d,0);wac_Oh(d,1,CommonUIStrings.l_DialogClose);d.hs(a,b,c,function(){})},O:function(){this.w_a&&this.lXa.pH.contentWindow&&(wac_jg(this.lXa.pH.contentWindow,"message",this.y5a),this.w_a=!1)}};function wac_M_c(a){a.Ia.Mp(1685987254,2,a.prd,260);wac_q(a.Dc,"OcpsIsEnabled")&&a.Ia.Nrd("ConnectedServices",!0,1685987254,2,a.prd,function(a){wac_NNc(window.Box4.App.zb(),a,(new wac_6Ic).qLd)})}
function wac_a5(a,b){wac_a5.resolveInheritance();this.dispose=this.O;wac_a5.initializeBase(this,[a,wac_Jh(b,0),null])}wac_a5.prototype={Dx:function(a,b,c){var d;this.Wna((d=new wac_0a,d.MessageId=a,d.SendTime=Date.now(),d.CorrelationId=c,d.Values=b,d),null)}};function wac_b5(a,b,c){a.yx()&&wac_s7a(a,a.ela)&&(a.bQb(b),a.UVd(b,c))}
function wac_c5(a,b){wac_c5.resolveInheritance();this.dispose=this.O;wac_c5.initializeBase(this,[a,"*"===b?b:wac_Jh(b,0),null]);wac_BQ.prototype.RDb.call(this,"UI_InsertImage");wac_BQ.prototype.RDb.call(this,"UI_InsertFileLink")}wac_c5.prototype={Dx:function(a,b,c){var d;return this.Wna((d=new wac_0a,d.MessageId=a,d.SendTime=Date.now(),d.CorrelationId=c,d.Values=b,d),null)},sdf:function(){return!1},DCc:function(){}};function wac_mRb(){}wac_mRb.prototype={IG:function(a,b){return new wac_a5(a,b)}};
function wac_d5(a,b,c){this.Hfd=Function.createDelegate(this,this.nOd);this.bhd=Function.createDelegate(this,this.OPd);this.khd=Function.createDelegate(this,this.XPd);this.ehd=Function.createDelegate(this,this.RPd);this.Dse=Function.createDelegate(this,this.rve);this.Y3=Function.createDelegate(this,this.CM);wac_d5.initializeBase(this);if(!a)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.sWb=a;this.IUb="";this.F8=c;this.ira=[];this.mga=b;this.po=
wac_nRb;this._id="InsertMediaDialog"}
wac_d5.prototype={ira:null,IUb:null,hF:null,mga:null,F8:null,sWb:null,ejb:!1,uWa:null,U1d:null,uDe:"KeepFocusDiv",pze:"KeepFocusStartDiv",Nd:null,o9d:function(a){return this.Nd=a},Fjc:null,rEe:function(a){return this.Fjc=a},hSa:function(a,b){this.IUb=a;this.ejb=!1;this.Hm(this.IUb,null);this.uWa=document.getElementById(this.Rf("insertmediaframe"));if(!this.uWa)throw wac_6m(this,this.gq),Error.invalidOperation("Couldn't get InsertMediaIframe.");a=document.createElement("div");a.setAttribute("Id",this.pze);
a.setAttribute("tabindex",0);a.setAttribute("position","absolute");a.setAttribute("width","-1000px");a.setAttribute("top","-1000px");this.uWa.parentNode.insertBefore(a,this.uWa.parentNode.firstChild);a=document.createElement("div");a.setAttribute("Id",this.uDe);a.setAttribute("tabindex",0);this.uWa.parentNode.appendChild(a);a.setAttribute("position","absolute");a.setAttribute("width","-1000px");a.setAttribute("top","10000px");window.$addHandler(wac_kg?wac_kg.Rb:null,"keydown",this.Y3);this.uWa.setAttribute("src",
this.sWb);this.uWa.setAttribute("width","100%");this.uWa.setAttribute("height","100%");this.uWa.setAttribute("frameborder","0");wac_q(wac_.pa,"ShowInsertMediaIframeWhenIframeIsReady")&&wac_dg()?(this.uWa.style.visibility="hidden",this.U1d=this.Dse,wac_tf(this.uWa,"load",this.U1d)):this.uWa.style.visibility="visible";a=document.getElementById(this.Rf("WACDialogButtonPanel"));if(!a)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");a.style.display="none";a=document.getElementById(this.Rf("WACDialogTitleText"));
if(!a)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");a.style.display="none";wac_Ie().Hg().uC.NCa=!0;this.hF=this.mga.IG(this.uWa.contentWindow,this.sWb);var c=this;wac_b5(this.hF,"AddItem",function(a){var d=b.tvb||(b.tvb=Function.createDelegate(b,b.uya));wac_b(7135752,352,100,"OnAddItem : Got message.");if(a=wac_N_c(a))50<c.ira.length?wac_b(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(c.ira,a),c.ejb&&(d(c.ira),c.ejb=!1))});var d=this;wac_b5(this.hF,"Insert",
function(a){d.mMb(a,b.tvb||(b.tvb=Function.createDelegate(b,b.uya)))});wac_b5(this.hF,"GetCustomHeaders",this.ehd);wac_b5(this.hF,"GetSessionId",this.khd);wac_b5(this.hF,"GetCID",this.bhd);wac_b5(this.hF,"CancelDialog",this.Hfd)},rve:function(){if(this.uWa){this.uWa.style.visibility="visible";var a=this;window.setTimeout(function(){if(a.fg){var b=a.fg.getElementById(a.pze);b&&b.focus()}},0)}},CM:function(a){9===a.keyCode&&(a.target.id!==this.uDe||a.shiftKey?a.target.id===this.pze&a.shiftKey&&(a.preventDefault(),
this.fg.getElementById(this.uDe).focus()):(a.preventDefault(),this.fg.getElementById(this.pze).focus()))},dispose:function(){this.hF&&(this.hF.dispose(),this.hF=null);this.U1d&&(wac_jg(this.uWa,"load",this.U1d),this.U1d=null);wac__m.prototype.dispose.call(this)},qu:function(){wac__m.prototype.qu.call(this);var a=document.getElementById(this.Rf("WACDialogPanel"));a&&(a.style.width="870px")},nOd:function(){wac_b(17662422,352,100,"OnCancelDialog : Got message.");wac_6m(this,this.gq);wac_8vc(this,1)},
Mdb:function(){var a=new XMLHttpRequest;a.open("POST",this.Fjc,!0);a.setRequestHeader("Content-Type","");return a},mMb:function(a,b){wac_b(7135754,352,100,"OnInsert : Got message.");wac_6m(this,this.gq);b&&(this.ira&&0<this.ira.length?(b(this.ira),wac_8vc(this,0)):(wac_b(23078422,352,15,"Empty search result."),this.ejb=!0,b(this.ira),wac_8vc(this,2)))},RPd:function(){this.hF&&(wac_b(7135755,352,100,"OnGetCustomHeaders : Got message."),this.hF.Dx("SetCustomHeaders",{CustomHeaders:""},""))},XPd:function(){this.hF&&
(wac_b(7135756,352,100,"OnGetSessionId : Got message."),this.hF.Dx("SetSessionId",{SessionId:wac_.Ag||"00000000-0000-0000-0000-000000000000"},""))},OPd:function(){this.hF&&(wac_b(7135757,352,100,"OnGetCID : Got message."),this.hF.Dx("SetCID",{CID:""},""))}};
function wac_8vc(a,b){var c=/hubble/gi;if(a.Fjc&&0<a.Fjc.search(c)&&a.Nd){c={};c.InsertedFiles=a.ira.length;c.DialogMode=1<a.IUb.search(/icon/gi)?"Icons":"Images";c.CorrelationId="{"+a.Nd.toString()+"}";c.Platform="Wac";c.Provider="Bing";c.AppId=window.Box4.App.Mg;c.Build=wac_.jv;var d={};wac_.pa&&(d=wac_Hd(wac_.pa.Qb.SessionStartInfoJson.toString()));c.AudienceGroup=d?d.Ring||"Unknown":"Unknown";c.Locale=wac_nm(wac_.vh)._name;0===b&&(c.MediaDetails=a.ira);c.DialogResult=1===b?"Cancel":0===b?"OK":
"Error";a.Mdb().send(JSON.stringify(c))}}function wac_oRb(a,b){this.hLc=a;this.F8=b}wac_oRb.prototype={hLc:null,F8:null,IG:function(){throw Error.notImplemented();}};function wac_e5(a,b,c){this.dispose=this.O;this.SKc=a;this.yEa=[];this.RKc=b;this.K0b=c.split(";")}
wac_e5.prototype={SKc:null,yEa:null,RKc:null,K0b:null,AUc:!1,Nd:null,o9d:function(a){return this.Nd=a},Fjc:null,rEe:function(a){return this.Fjc=a},hSa:function(a,b){Array.clear(this.yEa);a=this.SKc.ma();wac_s7a(a,this.RKc);a.bQb(b.XZa());if(!this.AUc){var c=this;a.UVd(b.XZa(),function(a){c.mMb(a,b)});this.AUc=!0}wac_b(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");a.Dx(b.LTc(),{FileExtensionFilterList:this.K0b},"")},mMb:function(a,b){wac_b(17838544,
352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");a=b.vBc(a);for(var c=[],d=0;d<a.length;d++){var e=a[d];b.Bbb(e,this.K0b)?Array.add(c,e):(e=b.Exc(e),Array.contains(this.yEa,e)||Array.add(this.yEa,e))}c&&c.length?b.uya(c):wac_b(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.yEa.length&&(b=this.yEa.join(", "),wac_b(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",b),a=new wac_di,wac_Nh(a,0),wac_fn(a,CommonUIStrings.l_DefaultDialogTitle,
String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,b),null))},O:function(){}};function wac_f5(a){this.iLc=a}wac_f5.prototype={iLc:null,IG:function(){return this.iLc}};function wac_g5(){this.pH=document.createElement("iframe");this.pH.src="about:blank";this.pH.style.visibility="hidden";this.pH.style.position="absolute";this.pH.style.zIndex=-100}wac_g5.prototype={pH:null};function wac_h5(){}
wac_h5.prototype={Bbb:function(a,b){if(!a)return!1;for(var c=0;c<b.length;c++)if(0<=a.toLowerCase().indexOf(b[c]))return!0;return!1}};function wac_pRb(a){return(a=wac_qRb.exec(a))&&2<a.length?a[2].trim():""}
function wac_N_c(a){if(!a||!a.Values)return null;a=a.Values;if(!a)return null;var b="";"sourceProvider"in a&&(b=a.sourceProvider||"");var c;return c=new wac_94,c.Action=a.action||"",c.Caption=a.caption||"",c.ContentType=a.contentType||"",c.Type=a.extension||"",c.PageUrl=a.pageUrl||"",c.OriginalUrl=a.sourceUrl||"",c.ContentProvider=b,c.ThumbnailUrl=a.thumbnailUrl||"",c.LicenseUrl=a.licenseUrl||"",c.LicenseDisplayName=a.licenseDisplayName||"",c.Height=a.height||0,c.Width=a.width||0,c.SvgContent=a.svgContent||
"",c}function wac_rRb(a){var b=wac_sRb(),c=wac_.jv,d=0<c.indexOf(".")?c.substring(0,c.indexOf(".")):"16";return String.format(a,wac_.vh,wac_.vh,wac_.vh,b,d,c,wac_K.QPa.xKb.toString(1),0,0)}function wac_sRb(){var a;switch(window.Box4.App.Mg){case 1:a=8;break;case 4:a=3;break;case 2:a=0;break;default:a=0}return a}function wac_tRb(a,b,c,d){this.CKd=a;this.Vyc=b;this.HJb=c;this.Uyc=d}wac_tRb.prototype={CKd:!1,Vyc:!1,HJb:!1,Uyc:!1};function wac_i5(a){wac_i5.initializeBase(this,[a])}
wac_i5.prototype={LTc:function(){return"UI_InsertFileLink"},XZa:function(){return"Host_InsertFileLink"},vBc:function(a){return a&&a.Values&&"Items"in a.Values?a.Values.Items:null},Exc:function(){wac_fa(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""},Bbb:function(){return!0},xOb:function(a,b,c){a=c(a);a.length&&(c={},c.Items=a,b.Dx(this.XZa(),c,""))},xBc:function(a){for(var b=[],c=0;c<a.data.value.length;c++){var d=
a.data.value[c];if(d){var e={};e.DisplayText=d.name;e.Url=d.urls.download;e.sourceUrl=d.urls.download;e.caption=d.name;Array.add(b,e)}}return b},wBc:function(a){for(var b=[],c=0;c<a.data.files.length;c++){var d=a.data.files[c];if(d){var e={};e.DisplayText=String.format("{0}{1}",d.name,d.extension);var f=e;a:{for(var d=[d.urls.viewInBrowser,d.urls.open,d.urls.download],g=0;g<d.length;g++)if(d[g]&&""!==d[g]){d=d[g];break a}wac_b(21764229,352,10,"None of the URLs we received are valid");d=""}f.Url=d;
Array.add(b,e)}}return b}};function wac_9vc(a){this.Ia=a}
wac_9vc.prototype={Ia:null,qLa:2711544537,Mxe:function(a){return this.qLa=a},uya:function(a){try{wac_b(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",a.length);for(var b=0;b<a.length;b++)this.Ia.os(this.qLa,2,a[b],null);wac_b(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",a.length)}catch(c){wac_b(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",c.toString())}}};
function wac_j5(a,b,c){wac_j5.initializeBase(this,[a,b,c])}
wac_j5.prototype={LTc:function(){return"UI_InsertImage"},XZa:function(){return"Host_InsertImage"},vBc:function(a){var b=[];if(a&&a.Values&&a.Values.Items){a=a.Values.Items;for(var c=0;c<a.length;c++){var d=a[c];if(d){var e,d=(e=new wac_94,e.Type=d.Extension||"",e.OriginalUrl=d.SourceUrl||"",e.Caption=d.caption,e.Height=d.Height||0,e.Width=d.Width||0,e);Array.add(b,d)}}}return b},Exc:function(a){return a.Type},Bbb:function(a,b){return this.F8.Bbb(a.Type,b)},xBc:function(a){var b=[];if(a&&a.data&&a.data.value&&
0<a.data.value.length)for(var c=0;c<a.data.value.length;c++)if(a.data.value[c]&&a.data.value[c].urls&&a.data.value[c].urls.download){var d=a.data.value[c],e,d=(e=new wac_94,e.OriginalUrl=d.urls.download,e.Type=d.extension||"",e.Caption=d.name,e.ContentType="",e.Height=d.driveItem||d.driveItem.image?d.driveItem.image.height:0,e.Width=d.driveItem||d.driveItem.image?d.driveItem.image.width:0,e);Array.add(b,d)}b.length||wac_b(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found");
return b},wBc:function(a){for(var b=[],c=0;c<a.data.files.length;c++){var d=a.data.files[c];if(d){var e,d=(e=new wac_94,e.ContentType=d.itemType||"",e.Type=d.extension||"",e.OriginalUrl=d.urls&&d.urls.open?d.urls.open:"",e.Height=d.photo?d.photo.height:0,e.Width=d.photo?d.photo.width:0,e);Array.add(b,d)}}return b},xOb:function(a,b,c){c=c(a);if(c.length){a=[];for(var d=0;d<c.length;d++){var e=c[d],f={};f.Extension=e.Type;f.SourceUrl=e.OriginalUrl;f.caption=e.Type;f.SourceUrl=e.OriginalUrl;f.Width=
e.Width;f.Height=e.Height;Array.add(a,f)}c={};c.Items=a;b.Dx(this.XZa(),c,"")}}};function wac_$vc(a,b,c){this.Ia=a;this.F8=b;this.YCd=c}
wac_$vc.prototype={Ia:null,F8:null,YCd:null,qLa:4034531111,jR:null,rob:function(){return this.jR||(this.jR=wac_j().H(wac_Zb))},Mxe:function(a){return this.qLa=a},uya:function(a){try{wac_b(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",a.length);var b,c="";if(a)for(var d=0;d<a.length;d++){var e=a[d];e&&(c+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',e.OriginalUrl,e.Width,e.Height))}b=c;c=2;if(b&&0<b.length){var f=new wac_ve;wac_v(f,wac_do,
b);wac_v(f,wac_xo,!0);if(this.YCd){var g=wac_ONc(this.YCd);g.J2e.insertOnlineImage=!0;wac_v(f,wac_pxc,g)}wac_q(wac_.pa,"OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.rob().bdc(Box4Intl.Box4Strings.l_ImageUploading,!0);c=this.Ia.os(this.qLa,2,f,null)}wac_b(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",a.length,32===c,""===b)}catch(h){wac_b(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",
h.toString())}}};function wac_uRb(a,b){this.tN=a;this.mga=b}
wac_uRb.prototype={tN:null,mga:null,Wd:function(a){var b=this;this.tN.Wd({mode:"open",select:"multi",lightbox:"white"},function(c,d){b.Bna(c,d,a)})},Bna:function(a,b,c){wac_b(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",a);a&&b&&b.data&&b.data.files&&0<b.data.files.length?(a=this.mga.IG(window.frames[0].parent,window.document.URL),c.xOb(b,a,c.lmd||(c.lmd=Function.createDelegate(c,c.wBc)))):wac_b(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}};
function wac_k5(a,b,c){this.Sja=Function.createDelegate(this,this.xma);this.tN=a;this.mga=c;var d=this;this.WJ=new (wac_f.$$(wac_nc.$$(wac_sc)))(function(){return new (wac_9P.$$(wac_sc))(b.ma(),d.Sja)})}
wac_k5.prototype={tN:null,mga:null,TW:null,yl:null,WJ:null,mFa:function(){this.TW||(this.WJ.ma().XU("InsertFromOneDrive",!0),this.yl&&this.yl.BI&&this.yl.BI.length&&(this.TW=this.OHb(this.yl.BI)));return this.TW},OHb:function(a){a=a.toLowerCase();a.endsWith("/")||(a+="/");var b=a.indexOf("/documents/");return-1!==b?a.substring(0,b+1)+"_layouts/15/onedrive.aspx":""},xma:function(a){this.yl||3!==a.kg()||(this.yl=a)},Wd:function(a){if(!this.mFa())if(wac_.oca&&wac_.oca.length)this.TW=wac_.oca;else{wac_b(26071185,
352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.yl);return}var b=new wac_vRb;b.GQb();var c=b.QHb();if(c){var d=this,e=this;this.tN.Wd(function(c,e){b.fd();d.Bna(c,e,a)},function(){e.KLb(b)},c,this.TW)}else wac_b(26071186,352,10,"Picker container is null, will not show picker.")},KLb:function(a){a.fd();wac_b(26071187,352,50,"User cancelled to insert picture from onedrive.")},Bna:function(a,b,c){wac_b(26071188,
352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",a);a&&b&&b.data&&b.data.value&&0<b.data.value.length?(a=this.mga.IG(window.frames[0].parent,window.document.URL),c.xOb(b,a,c.mmd||(c.mmd=Function.createDelegate(c,c.xBc)))):wac_b(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")}};function wac_vRb(){wac_vRb.initializeBase(this)}
wac_vRb.prototype={GQb:function(){this.jUa="FilePickerDialog";this.po="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>";this._id="PickerDialog-Livebooks";this.Hm("",null)},QHb:function(){return document.getElementById("OpenFilePickerDiv")},qu:function(){},Pda:function(){}};function wac_wRb(){}
wac_wRb.prototype={sa:null,Njb:null,Ub:function(){return"Box4.Media"},gc:function(a){this.sa=a;if(wac_P().K(99)){wac_m(wac_n(wac_o(a.fa(wac_g5),wac_84)),function(){return new wac_g5});var b=new wac_tRb(Boolean.parse(wac_.pa.Qb.InsertOnlinePictureEnabled||"false"),wac_33a(),wac_q(wac_.pa,"OneNoteInsertOneDriveFileIsEnabled"),wac_Q1());if(Boolean.parse(wac_.pa.Qb.OneNoteInsertOneDriveFileIsEnabled||"false")){var c=wac_rP(wac_oc.$$(wac_sc),wac_l(a,wac_oc.$$(wac_sc)));wac_m(wac_n(wac_o(a.fa(wac_k5),wac_44)),
function(){return new wac_k5(a.H(wac_zQ),new (wac_f.$$(wac_oc.$$(wac_sc)))(function(){return wac_Qb(c)}),a.H(wac_54))})}else wac_m(wac_n(wac_o(a.fa(wac_uRb),wac_44)),function(){return new wac_uRb(a.H(wac_uQ),a.H(wac_54))});wac_m(wac_n(a.fa(wac_$4)),function(){return new wac_$4(wac_z(),wac_.pa,b,a.H(wac_44),a.H(wac_g5),a.H(wac_sD),a.H(wac_64),a.H(wac_74),a.H(wac_h5),a.H(wac_j5),a.H(wac_i5),wac__g,wac_.rC,wac_Ufa,wac_.pa.Qb.InsertPictureServiceEndpoint,wac_.pa.Qb.InsertPictureTelemetryEndpoint)});wac_m(wac_n(wac_o(a.fa(wac_oRb),
wac_64)),function(){return new wac_oRb(a.H(wac_54),a.H(wac_h5))});wac_m(wac_n(wac_o(a.fa(wac_f5),wac_74)),function(){return new wac_f5(a.H(wac_e5))});wac_m(wac_n(a.fa(wac_e5)),function(){return new wac_e5(new (wac_f.$$(wac_2a))(function(){var a;wac_Q1()?(a=wac_j().H(wac_84).pH,a=new wac_c5(a.contentWindow,"*")):a=wac_.KIb;return a}),wac_Q1()?wac_Jh(window.document.URL,0):wac_Jh(wac_.cRa,0),wac_.pa.Qb.ImageFetcherSupportedExtensions)});wac_n(wac_o(a.fa(wac_mRb),wac_54));wac_n(a.fa(wac_h5));wac_m(wac_n(a.fa(wac_j5)),
function(){return new wac_j5(wac_z(),a.H(wac_h5),a.H(wac_awc))});wac_m(wac_n(a.fa(wac_i5)),function(){return new wac_i5(wac_z())})}},tb:function(){wac_P().K(99)&&(this.Njb=this.sa.H(wac_$4),this.Njb.Tb())},O:function(){this.Njb&&this.Njb.O()}};wac_94.registerClass("Box4.Media.OnlineMediaSearchResult");wac_$4.registerClass("Box4.Media.InsertMediaActor",null,Sys.IDisposable);wac_a5.registerClass("Box4.Media.InsertMediaCrossDocumentMessenger",wac_EQ,wac_jRb,Sys.IDisposable);
wac_c5.registerClass("Box4.Media.InsertMediaFromOneDriveCrossDocumentMessenger",wac_EQ,wac_2a,wac_1a,Sys.IDisposable);wac_mRb.registerClass("Box4.Media.InsertMediaCrossDocumentMessengerFactory",null,wac_54);wac_d5.registerClass("Box4.Media.InsertMediaDialog",wac__m,wac_kRb,Sys.IDisposable);wac_oRb.registerClass("Box4.Media.InsertMediaDialogFactory",null,wac_64);wac_e5.registerClass("Box4.Media.InsertMediaFromHostManager",null,wac_kRb,Sys.IDisposable);
wac_f5.registerClass("Box4.Media.InsertMediaFromHostManagerFactory",null,wac_74,wac_64);wac_g5.registerClass("Box4.Media.InsertMediaFromHostOneDriveHostFrame",null,wac_84);wac_h5.registerClass("Box4.Media.InsertMediaHelper",null,wac_gRb);wac_tRb.registerClass("Box4.Media.InsertMediaSettingsManager");wac_9vc.registerClass("Box4.Media.InsertOneDriveFileHandler",null,wac_7vc);wac_i5.registerClass("Box4.Media.InsertOneDriveFileHelper",wac_9vc,wac_iRb,wac_7vc);
wac_$vc.registerClass("Box4.Media.InsertOnlineImageHandler",null,wac_7vc);wac_j5.registerClass("Box4.Media.InsertOnlineImageHelper",wac_$vc,wac_iRb,wac_7vc);wac_uRb.registerClass("Box4.Media.OneDriveFilePickerHelperV5",null,wac_44);wac_k5.registerClass("Box4.Media.OneDriveFilePickerHelperV7",null,wac_hRb,wac_44);wac_vRb.registerClass("Box4.Media.PickerDialog",wac__m,wac_lRb);(function(){}).registerClass("Box4.Media.Program");wac_wRb.registerClass("Box4.Media.MediaPackage",null,wac_I,wac_i);(function(){}).registerClass("Box4.Media.InsertMediaDialogHtml");
var wac_qRb=/<iframe\s(.*\s)*src=[\"|'](.*?)[\"|'].*\/(iframe)?>/im,wac_nRb="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";wac_J(wac_C(),new wac_wRb,0,!1);Type.registerNamespace("Box4.Insights");wac_K=window.Box4||{};wac_K.$4c=wac_K.$4c||{};function wac_FHc(){}wac_FHc.registerInterface("Box4.Insights.IBox4InsightsSelection");
function wac_GHc(a){wac_GHc.initializeBase(this);this.tYa=a}wac_GHc.prototype={tYa:null};function wac_HHc(){wac_HHc.initializeBase(this)}wac_HHc.prototype={Ub:function(){return"Box4.Insights"},gc:function(a){wac_AHc.prototype.gc.call(this,a);wac_m(wac_n(wac_o(wac_o(a.fa(wac_UFc),wac_kHc),wac_FHc)),function(){return new wac_UFc(2E3)});wac_m(wac_n(wac_o(a.fa(wac_GHc),wac_gHc)),function(){return new wac_GHc(a.H(wac_kHc))})}};function wac_tHc(){}
wac_tHc.prototype={rne:function(a){wac_eHc().rne(a)},vhe:function(a){wac_eHc().vhe(a)},jee:function(a){wac_eHc().jee("InsightsTaskPane",a)}};function wac_BHc(){var a=new wac_TP(wac_6s.zEb,Box4Intl.Box4Strings,null,null,null),b=wac_eHc();return wac_aHc(b,a)}function wac_UFc(a){this.qab=a}
function wac_IHc(){var a=window.Box4.App.zb().Zc.ik;if(!a)return wac_b(38548897,1303,50,"ContentView is null"),null;a=a.Fa;return a&&a.wb()&&a.wb().na()?a.wb().kb():(wac_b(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}
wac_UFc.prototype={qab:0,EPe:function(){var a=wac_IHc();return this.Ufe(a)},Ufe:function(a){a&&wac_Wu(a)&&wac_Nv(a.La())&&wac_bEb(a.La())&&(wac_b(17944729,1303,50,"Selection was an insertion point, expanding to word"),a=wac_RCa(a.La(),!1));if(!a){var b;return b=new wac_EHc,b.neighborhood="",b.mentionStart=0,b.mentionLength=0,b}var c=new Sys.StringBuilder,d=0;b=0;for(var e=[],f=a.na(),g=0;g<f;g++){var h=a.K(g);if(wac_Yv(h.aa)&&!Array.contains(e,h.aa.B8a)){e.push(h.aa.B8a);var k=h.aa.Xc,l=g===f-1;g||
-1===h.Na||(d=h.Na);b+=l&&-1!==h.Nb?h.Nb:k.length;c.append(k);l||(c.append(" "),b++)}}for(a=c.toString().replace(/\ufffc/g," ");d<b&&wac_zf(a.charCodeAt(d));)d++;for(;b>d&&wac_zf(a.charCodeAt(b-1));)b--;a.length>this.qab&&(c=b-d,c>this.qab?(a=a.substr(d,this.qab),b=this.qab,d=0):(e=this.qab-c,c=Math.max(d-Math.floor(e/2),0),e=Math.min(c+this.qab,a.length),c=Math.max(e-this.qab,0),d-=c,b-=c,a=a.substring(c,e)));var m;return m=new wac_EHc,m.neighborhood=a,m.mentionStart=d,m.mentionLength=b-d,m}};
function wac_oHc(a){var b=wac_IHc();return 0<a.Ufe(b).mentionLength}(function(){}).registerClass("Box4.Insights.Program");wac_GHc.registerClass("Box4.Insights.Box4InsightsManager",wac_uHc);wac_HHc.registerClass("Box4.Insights.Box4InsightsPackage",wac_AHc);wac_tHc.registerClass("Box4.Insights.Box4InsightsPaneHandler",null,wac_jHc);wac_UFc.registerClass("Box4.Insights.Box4InsightsSelection",null,wac_FHc,wac_kHc);wac_J(wac_C(),new wac_HHc,0,!1);Type.registerNamespace("Common.App.VersionHistory");
wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.p2b=wac_d.Qa.p2b||{};wac_d.Qa.p2b.rVe=function(){};wac_d.Qa.p2b.rVe.prototype={};wac_d.Qa.p2b.rVe.registerEnum("Common.App.VersionHistory.VersionHistoryFullAppErrorCode",!1);(function(){}).registerInterface("Common.App.VersionHistory.IVersionHistoryController");(function(){}).registerInterface("Common.App.VersionHistory.IFocusTrapZoneComponent");function wac_JHc(){}
wac_JHc.prototype={appColor:null,appName:0,fileExtension:null,wdEnableDownloadTokens:!1,retryCount:0,wdEnableSaveACopy:!1,wdEnableRestore:!1,wdEnableIterator:!1,userSessionId:null,wacCluster:null,uiLocale:null,isRtl:!1,useXhr:!1,wdEnableIteratorBasedHeaderAlignment:!1,viewerRootPositionRelative:!1,wdEnableHiddenButtonsUntilVersionLoadComplete:!1,wdEnableShowVersionChanges:!1,disableSaveACopy:!1,wdEnableCompareVersionsByGroup:!1};function wac_KHc(){}wac_KHc.prototype={telemetryEventKey:null,telemetryEventData:null};
function wac_uwc(){}wac_uwc.prototype={revisionID:null,authorID:null,authors:null,time:null,downloadUrl:null,wopiInfo:null};function wac_vwc(){}wac_vwc.prototype={ulsLogger:null,serviceBase:null,latestStreamServiceBase:null,docId:null,appSettings:null,perfTelemetryInfos:null};function wac_wwc(){}wac_wwc.prototype={currentVersion:null,baseVersion:null,correlationID:null,groupName:null};function wac_xwc(){}wac_xwc.prototype={versions:null,containerDiv:null,correlationID:null};function wac_LHc(){}
wac_LHc.prototype={updatedVersions:null,versionSelected:null};Type.registerNamespace("PowerPointWebEditor.VersionHistory");wac_Z=window.PowerPointWebEditor||{};wac_Z.p2b=wac_Z.p2b||{};function wac_MHc(){}wac_MHc.registerInterface("PowerPointWebEditor.VersionHistory.IVersionHistoryPaneActor");function wac_ywc(){this.SB=Function.createDelegate(this,this.sC)}
wac_ywc.prototype={sa:null,Fre:null,Ub:function(){return"PowerPointWebEditor.VersionHistory"},gc:function(a){this.sa=a},tb:function(){wac_.pa.Ok(this.SB)},sC:function(){var a=this.sa.H(wac_Uc);if(wac_q(a,"PptVersionHistoryIsEnabled"))if(wac_Rqc())if(wac_q(a,"AppSupportsReactVersionHistory"))if(this.sa.H(wac_R).ujf)wac_b(42755924,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the file is open password protected");else{wac_b(39711108,
202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Initializing the React VersionHistory package");var b=this;wac_Zg(window.Common.App.AppLifecycleManager.get_instance(),7,function(){b.sa.H(wac_wEa).uje.MRd("versionHistory").catch(function(a){return wac_b(39711109,811,10,"Failed to load the resources for the versionHistory feature: {0}",a)}).then(function(){b.pPe();return null}).catch(function(a){return wac_b(39711110,811,10,"Failed to initialize the versionHistory feature: {0}",a)})},3)}else wac_b(39711107,
202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled");else wac_b(39711106,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled");else wac_b(40718789,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")},pPe:function(){var a=this;wac_n(wac_m(this.sa.fa(wac_Awc),
function(){return new wac_Awc(wac_z(),a.sa.H(wac_iK),a.sa.H(wac_Em),a.sa.H(wac_R),a.sa.H(wac_Mt),wac_Ie(),wac_qg(),a.sa.H(wac_kG),a.sa.H(wac_mG),a.sa.H(wac_$D),a.sa.H(wac_VF),wac_l(a.sa,wac_SY))}));this.Fre=this.sa.H(wac_Awc);this.Fre.Tb()},O:function(){this.Fre&&this.Fre.O()}};
function wac_Awc(a,b,c,d,e,f,g,h,k,l,m,n){this.fYe=Function.createDelegate(this,this.j_e);this.AAe=Function.createDelegate(this,this.yye);this.etf=Function.createDelegate(this,this.czf);this.FAe=Function.createDelegate(this,this.JCe);this.Pxd=-1;this.dispose=this.O;this.U=a;this.qIa=b;this.Gh=c;this.Ta=d;this.Cc=e;this.Rta={};this.ra=f;this.Dg=g;this.DRd={};this.kC=k;this.XVd={};this.Cqf=h;this.o3=l;this.hb=m;this.iaf=[];if(n){this.Qpf=n;var p=this;this.Qpf.uc(function(a){p.my=a})}}
function wac_NHc(a){return a.RevisionID?a.RevisionID:a.revisionID?a.revisionID:""}
wac_Awc.prototype={U:null,V4d:null,s2a:null,qIa:null,Gh:null,Ta:null,Cc:null,Rta:null,ZXe:null,D$d:null,HIe:null,iNd:null,ra:null,Dg:null,kC:null,Cqf:null,o3:null,hb:null,Qpf:null,my:null,iaf:null,DRd:null,hWd:null,XVd:null,A4e:null,Tb:function(){this.U.ja(466976539,2147483648,this.FAe);this.U.ja(4281380812,2147483648,this.etf)},JCe:function(a,b,c){if(1===c)return a=!1,this.Ta.ALd&&this.hb.V3d&&(a=!0),a?2:32;if(2===c){this.hWd=wac_5k().toString();wac_b(40144898,822,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",
this.hWd);wac_1t("Microsoft.Office.Server.Powerpoint.Web.IPptVersionHistoryIsEnabledSettings");this.Rta.VersionHistoryLaunchSessionId=this.hWd;this.DRd.VersionHistoryLaunchSessionId=this.hWd;this.Rta.ShowVersionHistoryDialog=(new Date).getTime().toString();this.iNd=[];if(!this.V4d){var d,e;this.V4d=window.versionHistory.FactoryGlobal.getVersionHistoryControllerInstance((e=new wac_vwc,e.ulsLogger=new window.UlsExternalLogger,e.serviceBase=wac_.pa.Qb.VersionHistoryWebServiceBase,e.latestStreamServiceBase=
wac_q(wac_.pa,"PPTVHPodsBootEnabled")?wac_.pa.Qb.PODSLatestServiceBase+"&PodSID="+wac_.pa.Qb.PodSID:"",e.docId=wac_.eo,e.appSettings=(d=new wac_JHc,d.appColor="#B7472A",d.fileExtension="pptx",d.wdEnableDownloadTokens=!0,d.retryCount=wac_.pa.Qb.PodVHRetryCount,d.wdEnableSaveACopy="true"===wac_.pa.Qb.PodVHEnableSaveACopy.toLowerCase()&&this.kC.raa(),d.wdEnableRestore="true"===wac_.pa.Qb.PodVHEnableRestore.toLowerCase()&&this.kC.raa(),d.userSessionId=wac_.Ag,d.wacCluster=wac_.pa.Qb.WacCluster,d.uiLocale=
this.Ta.QBb?this.Ta.QBb:"en-us",d.isRtl=wac_Ag&&wac_q(wac_.pa,"PPTVHRTLIsEnabled"),d.viewerRootPositionRelative=wac_q(wac_.pa,"PPTVHRootContainerPositionIsAbsolute"),d),e.perfTelemetryInfos=this.iNd,e))}this.V4d&&wac_q(wac_.pa,"PPTOVersionHistorySaveACopyProtectedDocDisabled")&&this.V4d.setDisableSaveACopy(wac_hf);this.KCe()}return 32},czf:function(a,b,c){return 1===c&&this.Ta.ALd&&this.hb.V3d?2:this.U.yw(3681556347,c,null)},KCe:function(){if(!document.getElementById("VersionHistoryOverlay")){wac_OHc(this);
wac_Bwc(this);wac_Cwc(this);this.Ta.rTe&&wac_PHc(this);wac_Dwc(this);wac_QHc(this);wac_RHc(this);var a=document.createElement("div");a.id="VersionHistoryOverlay";a.style.width="100%";a.style.height="calc(100% + 23px)";a.style.zIndex=998;a.style.display="block";a.style.position="absolute";a.style.top="0px";document.getElementById("WACInnerFrame").appendChild(a);this.ZXe=this.V4d.createVersionHistoryDialog(a);this.SDc()}document.getElementById("VersionHistoryOverlay").style.display="block";this.V4d.getTipVersion&&
wac_q(wac_.pa,"PPTVHPodsBootEnabled")&&this.V4d.getTipVersion();this.V4d.getVersions("");try{var b;var c=this.Cqf;try{var a=[],d=c.kxc();d&&c.od.Ta.fGe&&d.push("EditingSelectionPaneFocus");for(var e=0;e<d.length;e++)Array.contains(c.Wx.gR,d[e])&&a.push(d[e]);b=a}catch(f){wac_Y(41698500,822,10,"AppFrame::GetCurrentActiveF6Focuses, Exception: {0}",f),b=null}this.A4e=b;for(b=0;b<this.A4e.length;b++)wac_3j(this.Dg,this.A4e[b]);wac_2j(this.Dg,"VersionHistoryOverlay")}catch(f){wac_b(41698513,822,10,"VersionHistoryPaneActor: exception in ActivateVersionHistoryFocus: {0}.",
f)}},Lye:function(a){try{if(this.s2a)wac_gvc(!1),this.s2a.switchParentViewContainer(a);else{wac_gvc(!0);var b=new window.PowerPointVersionHistory.AppBootSettings;b.RenderServiceBase="";b.IsRtl=wac_Ag;var c=new window.PowerPointVersionHistory.AppCallbackBag,d=this.qIa;c.animationDecoratorCallback=d.zAe||(d.zAe=Function.createDelegate(d,d.RBe));c.notesIconDecoratorCallback=this.AAe;c.addToF6LoopCallback=this.fYe;var e=this;c.reportViewerErrorCallback=function(a){e.DRd[wac_SHc]=wac_THc().sHa.K(a);106===
a&&e.V4d.setViewerError(!0);wac_b(40125919,822,50,"Versions viewer error: {0}",a);return!0};b.IsHighContrast=!1;this.Gh&&(b.IsHighContrast=this.Gh.ZJ);b.IsHighContrast&&(b.ClientColorSettings=this.Gh.Ap.wba+"_"+this.Gh.Ap.DP+"_"+this.Gh.Ap.YKa);if(this.Cc){var f=wac_CI(this.Cc);b.DefaultSlideWidth=f.ac;b.DefaultSlideHeight=f.qc}b.UserSessionId=wac_.Ag;b.VersionViewerCssUrl=this.Ta.IBe;b.ProgressImageResourceUrl=wac_Le("progress.gif");b.ThumbnailShareOptimizationEnabled=this.Ta.HFe;b.DiffIconEnabled=
wac_q(wac_.pa,"PPTVHDiffIconEnabled");var g;b.SlidePrefetchSettings=(g=new window.PowerPointVersionHistory.SlidePrefetchSettings,g.SlidePrefetchEnabled=wac_q(wac_.pa,"PPTVHSlidePrefetchEnabled"),g.SlidePrefetchAhead=wac_.pa.Qb.PPTVHSlidePrefetchAhead,g.SlidePrefetchBehind=wac_.pa.Qb.PPTVHSlidePrefetchBehind,g.SlidePrefetchChunkSize=wac_.pa.Qb.PPTVHSlidePrefetchChunkSize,g.SlidePrefetchDelay=wac_.pa.Qb.PPTVHSlidePrefetchDelay,g);b.FileExtension=wac_h(this.Ta.PBb)?"":wac_If(this.Ta.PBb).toLowerCase();
b.SlideInformationLabel=ResourceStrings.l_SlideMenuButtonLabel;b.NotesButtonLabel=ResourceStrings.L_Notes;b.SynchronizerTimeout=wac_.pa.Qb.PptVersionHistorySynchronizerTimeout;b.IsRtl=wac_Ag&&wac_q(wac_.pa,"PPTVHRTLIsEnabled");b.VersionViewerUseGetItems=this.Ta.scf;b.IsRootContainerPositionAbsolute=wac_q(wac_.pa,"PPTVHRootContainerPositionIsAbsolute");this.s2a=new window.PowerPointVersionHistory.AppVersionController(b,a,c)}}catch(h){this.V4d.setViewerError(!0),wac_b(39711112,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",
h)}},yye:function(){return wac_4h(14,14,"ToolbarNotesActiveDark_14x14x32",null,ResourceStrings.L_Notes)},SDc:function(){var a=this.ra.xc("VersionHistoryOverlay");a.re="main";a.NCa=!0;a.rmf=!0;var b=this;wac_pk(a,function(){b.Pxd=-1;wac_O_c(b,!0)});wac_1j(this.Dg,"VersionHistoryOverlay");var c=this;wac_Zia(this.Dg,"VersionHistoryOverlay",function(a){wac_O_c(c,a)})},j_e:function(a){try{var b=wac_UHc(this);b&&b.push(a)}catch(c){wac_b(40743826,822,10,"VersionHistoryPaneActor: exception in AddToF6Loop: {0}.",
c)}return!0},O:function(){document.getElementById("VersionHistoryOverlay")&&"none"!==document.getElementById("VersionHistoryOverlay").style.display&&wac_VHc(this)}};function wac_UHc(a){if(!a.D$d)return null;var b=wac_NHc(a.D$d);return a.XVd[b]?a.XVd[b]:null}function wac_WHc(a){var b=wac_NHc(a.D$d);a.XVd[b]||(a.XVd[b]=["VersionListPane","vhHeader"],a.Pxd=-1)}
function wac_P_c(a,b){var c=wac_UHc(a),d=a.Pxd;do if(b?c&&(d=(d+1)%c.length):c&&(d=0<d?d-1:c.length-1),!d||1===d||c&&"none"!==document.getElementById(c[d]).style.display)return d;while(d!==a.Pxd);return 0}
function wac_O_c(a,b){try{var c=wac_UHc(a);a.Pxd=wac_P_c(a,b);a.Pxd?1===a.Pxd?a.ZXe.then(function(a){a.enterHeaderFocusTrapZone();return null}):c&&wac_Vj(document.getElementById(c[a.Pxd])):a.ZXe.then(function(a){a.enterFocusTrapZone();return null})}catch(d){wac_b(40743825,822,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",d)}}
function wac_VHc(a){try{if(a.A4e)for(var b=0;b<a.A4e.length;b++)wac_2j(a.Dg,a.A4e[b]);else wac_b(41698514,822,10,"VersionHistoryPaneActor: editorActiveF6Focuses is null.");wac_3j(a.Dg,"VersionHistoryOverlay")}catch(c){wac_b(41698515,822,10,"VersionHistoryPaneActor: exception in DeactivateVersionHistoryFocus: {0}.",c)}wac_ng(a.ra,"VersionHistoryOverlay",!0);document.getElementById("VersionHistoryOverlay").style.display="none";wac_b(40208089,822,50,wac_ai(a.DRd))}
function wac_Dwc(a){a.V4d.getCloseSelectedEvent().addListener(function(){if(wac_q(wac_.pa,"PowerPointVersionHistoryFloodGateIsEnabled")){var b=wac_k(wac_j(),wac_Dc);b?(b.lCe("VersionHistoryExited",null),b.lCe("VersionHistoryCheckExited",null)):wac_b(41523081,822,50,"ISystemInitiatedFeedback was null")}wac_VHc(a)})}
function wac_XHc(a){for(var b=a.iNd,c=b.length,d=0;d<c;++d){var e=b[d],f=e.TelemetryEventKey?e.TelemetryEventKey:e.telemetryEventKey?e.telemetryEventKey:"",e=e.TelemetryEventData?e.TelemetryEventData:e.telemetryEventData?e.telemetryEventData:"";f&&e&&(a.Rta[f]=e)}}
function wac_RHc(a){a.V4d.getRestoreVersionSelectedEvent().addListener(function(b){wac_b(41022552,832,50,"VersionHistoryPaneActor:  RegisterForRestoreVersionSelectedEvent: {0}",b);var c=Date.now(),d="true"===wac_.pa.Qb.PodVHEnableCoauthRestore.toLowerCase();a.my?(a.iaf=a.my.Hlf(),0<a.iaf.length&&!d?(wac_b(41706369,832,15,"VersionHistoryPaneActor: restore failed because of {0} coauthors",a.iaf.length),a.V4d.setCoauthRestoreError()):wac_Q_c(a,b,c)):(wac_b(41706368,832,10,"VersionHistoryPaneActor: presence manager is null"),
wac_Q_c(a,b,c))})}
function wac_Q_c(a,b,c){try{(new Promise(function(b,c){a.V4d.setRestoreInProgress();a.o3.O8e(a.hb.jh,a.hb.Jc,a.hb.Bj().Tj,wac_.pa.Qb[wac_2(361)],a.hb.Ota,!1,!0,function(){b(!0)},function(a){c("ClosePopWacSessionSync:: "+a.hh.AY)},null,null,null,null)})).then(function(){(new Promise(function(c,e){a.o3.B9e(a.hb.Bj().Tj,b,function(){c(!0)},function(a){e("RestoreFileVersion:: "+a.hh.AY)},null,null,null,null)})).then(function(){var b=Date.now()-c;wac_b(41997769,832,50,"VersionHistoryPaneActor: successfully restored version, refreshing now. Time: {0}",b);
a.DRd.RestoreSucceededTime=b;a.U.yw(2054778433,2,null)}).catch(function(b){var e=Date.now()-c;a.V4d.setRestoreFailedAtServer(function(){a.U.yw(2054778433,2,null)});wac_b(41706370,832,10,"VersionHistoryPaneActor: Failed to restore version: {0}, Time: {1}",b,e);a.DRd.RestoreFailedTime=e})})}catch(d){wac_b(41706371,832,10,"VersionHistoryPaneActor: Sending restore failed with message: {0}",d.message)}}
function wac_QHc(a){a.V4d.getSaveACopySelectedEvent().addListener(function(b){wac_b(40417503,822,10,"VersionHistoryPaneActor:  RegisterForSaveACopySelectedEvent: {0}",b);if(wac_q(wac_.pa,"PowerPointVersionHistoryFloodGateIsEnabled")){var c=wac_k(wac_j(),wac_Dc);c?c.lCe("VersionHistoryExited",null):wac_b(41754647,822,10,"ISystemInitiatedFeedback was null")}b=a.U.os(3050207199,2,{FileDownloadUrl:b},null);32!==b&&wac_b(40974167,832,10,"Failed to launch Save a Copy dialog. ActionResponse: {0}",b)})}
function wac_PHc(a){a.V4d.getDownloadTokenReadyEvent().addListener(function(b){try{if(wac_b(40481121,822,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),a.HIe)if(b&&b.updatedVersions&&2<=b.updatedVersions.length){var c=null,d=null,e=wac_NHc(a.D$d),f=wac_NHc(a.HIe),g=b.updatedVersions,h=g.length;for(b=0;b<h;++b){var k=g[b],l=wac_NHc(k);e===l?c=k:f===l&&(d=k);if(c&&d)break}c&&d?(a.D$d=c,a.HIe=d,a.s2a.diff(a.D$d,a.HIe)):wac_b(40665475,822,50,"VersionHistoryPaneActor - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",
e,f)}else wac_b(40665476,822,50,"VersionHistoryPaneActor - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");else wac_b(40665474,822,50,"VersionHistoryPaneActor - m_baseVersion is null in GetDownloadTokenReadyEvent callback.")}catch(m){wac_b(40481123,822,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",m)}})}
function wac_Cwc(a){a.V4d.getVersionSelectedEvent().addListener(function(b){a.D$d=b.currentVersion;a.HIe=b.baseVersion;if(a.s2a&&a.D$d.DownloadUrl.length)try{wac_XHc(a),wac_WHc(a),a.s2a.onVersionSelected(b.currentVersion,b.baseVersion,a.Rta),a.iNd=[],a.Rta={}}catch(c){wac_b(40122449,822,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",c)}})}
function wac_Bwc(a){a.V4d.getVersionsReadyEvent().addListener(function(b){a.Lye(b.containerDiv);b=b.versions;for(var c=a.s2a.getAppDataStore(),d=b.length,e=0;e<d;++e)c.AddVersionInfoToStore(b[e]);wac_wg(a.ra,"VersionHistoryOverlay",!0);try{a.D$d&&a.D$d.DownloadUrl.length&&a.s2a&&(wac_XHc(a),wac_WHc(a),a.s2a.onVersionSelected(a.D$d,a.HIe,a.Rta),a.iNd=[],a.Rta={})}catch(f){wac_b(40122448,822,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",f)}})}
function wac_OHc(a){a.V4d.getFullAppErrorEvent().addListener(function(b){try{var c=wac_THc().TFa.K(b);a.DRd[wac_SHc]=c;wac_b(40489094,822,50,"FullApp Error Event: {0}, VersionHistoryLaunchSessionId: {1}",c,a.hWd)}catch(d){wac_b(40489095,822,10,"Exception in FullAppErrorEvent call back: {0}.",d)}})}
function wac_YHc(){this.TFa=new (wac_e.$$(Number,String));this.TFa.ga(0,wac_ZHc);this.TFa.ga(100,wac__Hc);this.TFa.ga(101,wac_0Hc);this.TFa.ga(102,wac_1Hc);this.TFa.ga(103,wac_2Hc);this.TFa.ga(104,wac_3Hc);this.TFa.ga(105,wac_4Hc);this.TFa.ga(106,wac_5Hc);this.sHa=new (wac_e.$$(Number,String));this.sHa.ga(0,wac_ZHc);this.sHa.ga(100,wac_6Hc);this.sHa.ga(101,wac_7Hc);this.sHa.ga(102,wac_8Hc);this.sHa.ga(103,wac_9Hc);this.sHa.ga(104,wac_$Hc);this.sHa.ga(105,wac_aIc);this.sHa.ga(106,wac_bIc)}
function wac_THc(){wac_cIc||(wac_cIc=new wac_YHc);return wac_cIc}wac_YHc.prototype={TFa:null,sHa:null};Type.registerNamespace("PowerPointVersionHistory");(function(){}).registerInterface("PowerPointVersionHistory.IDataStore");wac_JHc.registerClass("Common.App.VersionHistory.AppSettings");wac_KHc.registerClass("Common.App.VersionHistory.TelemetryInfo");wac_uwc.registerClass("Common.App.VersionHistory.VersionInfo");wac_vwc.registerClass("Common.App.VersionHistory.ControllerFactoryParameters");wac_wwc.registerClass("Common.App.VersionHistory.VersionSelectedObject");
wac_xwc.registerClass("Common.App.VersionHistory.VersionsReadyObject");wac_LHc.registerClass("Common.App.VersionHistory.DownloadTokenReadyObject");(function(){}).registerClass("PowerPointWebEditor.VersionHistory.Program");wac_ywc.registerClass("PowerPointWebEditor.VersionHistory.PPTWebEditorVersionHistoryPackageManager",null,wac_I,wac_i);wac_Awc.registerClass("PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor",null,wac_MHc,Sys.IDisposable);(function(){}).registerClass("PowerPointWebEditor.VersionHistory.ErrorName");
wac_YHc.registerClass("PowerPointWebEditor.VersionHistory.VersionHistoryTelmetryHelper");
var wac_ZHc="None",wac__Hc="VHFailedToLoadVersionList",wac_0Hc="VHFailedToGetDownloadToken",wac_1Hc="VHFailedToParseVersionList",wac_2Hc="VHFetchFailed",wac_3Hc="VHVersioningNotEnabled",wac_4Hc="VHFileNotFound",wac_5Hc="VHVersionTooOld",wac_6Hc="VHFailedToRenderThumbnails",wac_7Hc="VHFailedToRenderSlide",wac_8Hc="VHFailedToRenderNotes",wac_9Hc="VHFailedToRenderDiff",wac_$Hc="VHFailedToShowAnimaitonIcon",wac_aIc="VHFailedToShowHiddenEffect",wac_bIc="VHFailedToRenderInitPresInfo",wac_SHc="ErrorCode",
wac_cIc=null;wac_J(wac_C(),wac_k4(new wac_ywc,0),0,!1);Type.registerNamespace("PowerPointLive");wac_62=window.PowerPointLive||{};wac_62.NGb=function(){};
wac_62.NGb.prototype={errorNone:0,errorFailedToFetchDocumentDownloadURL:1,errorFailedToInitializePrague:2,errorFailedToStartLiveBroadcast:3,errorFailedToPauseLiveBroadcast:4,errorFailedToResumeLiveBroadcast:5,errorFailedToEndLiveBroadcast:6,errorFailedToFetchAuthToken:7,errorFailedToCollectShowInfoForAudienceFeedback:8,errorFailedToTryTriggerAudienceFeedback:9,errorFailedToCreateRendezvousSession:10,errorFailedToPauseRendezvousSession:11,errorFailedToResumeRendezvousSession:12,errorFailedToEndRendezvousSession:13,
errorFailedToCreateSurvey:14};wac_62.NGb.registerEnum("PowerPointLive.ErrorCode",!1);window.PowerPointLive.ILiveSessionURL=wac_62.cxf=function(){};wac_62.cxf.prototype={participantUrl:null,sessionQRCode:null};window.PowerPointLive.ILiveSessionState=wac_62.bxf=function(){};wac_62.bxf.prototype={isPrivate:!1,isPaused:!1,participantsCount:0,sessionURLPromise:null};window.PowerPointLive.ILiveActorSettings=wac_62.$wf=function(){};
wac_62.$wf.prototype={hostElement:null,welcomeScreenBackgroundImageUrl:null,baseZIndex:0,urlBarHeightInPercentage:0,welcomeScreenLayerHostId:null,calloutContainerId:null,urlBarLayerHostId:null,dialogLayerHostId:null,reactionsBarLayerHostId:null};window.PowerPointLive.ILiveReaction=wac_62.axf=function(){};wac_62.axf.prototype={react:null,reactionCount:0,reactionImagePath:null};window.PowerPointLive.ILiveActor=wac_62.oCf=function(){};
function wac_R_c(){this.sessionEntryPoint=wac_62.t9e.toString(0);this.sessionExitPoint=wac_62.u9e.toString(0);this.pragueInitCallTimeInMS=this.documentDownloadUrlOnStartLiveFetchTimeInMS=this.sessionCreationWebServiceCallTimeInMS=-1}
wac_R_c.prototype={sessionId:"",sessionStartUtc:null,pragueDocId:"",transcriberSessionIds:"",sessionActiveDurationInMS:0,sessionDurationInMS:0,maxParticipantCount:0,sessionPauseCount:0,sessionResumeCount:0,welcomeShownCount:0,calloutShownCount:0,isSubtitleStartedByLive:!1,errorCode:"",accessControl:"Anyone"};function wac_T9(a,b){a.errorCode=a.errorCode.length?a.errorCode:b}
function wac_S_c(a,b,c,d,e,f){this.ssf=Function.createDelegate(this,this.Ixf);this.tsf=Function.createDelegate(this,this.Jxf);this.rsf=Function.createDelegate(this,this.Hxf);this.htf=Function.createDelegate(this,this.fzf);this.Xhf=Function.createDelegate(this,this.iyf);this.kif=Function.createDelegate(this,this.Dyf);this.uif=Function.createDelegate(this,this.Syf);this.rif=Function.createDelegate(this,this.Oyf);this.wif=Function.createDelegate(this,this.Uyf);this.sif=Function.createDelegate(this,this.Pyf);
this.lsf=Function.createDelegate(this,this.xxf);this.qif=Function.createDelegate(this,this.Nyf);this.pif=Function.createDelegate(this,this.Lyf);this.la=new wac_Re;this.M4e=-1;this.ed=d;this.ua=a;this.v7e=!1;this.ob=c;this.Cc=f;if(this.zD=b)this.j7e=b.lC();this.qBe=e;this.Dff()?(this.H4d=1,this.ua.ykf&&wac_T_c(this,"ConstructLivePresenter")):this.H4d=0}
wac_S_c.prototype={ua:null,zD:null,v7e:!1,taf:!1,D4e:!1,t7e:!1,B4e:!1,u7e:!1,ob:null,ed:null,Dza:null,j7e:null,mua:null,waa:null,qBe:null,H4d:0,P4e:30,m1c:null,sBe:null,Zz:null,Taf:0,ehf:0,$$e:null,Z2e:null,k7e:null,jaf:0,Cc:null,Keb:function(){return!!this.waa},m3e:function(a){return this.v7e=a},grf:function(a){return this.taf=a},Cff:function(){return!!this.waa&&this.waa.isPaused},Yaf:function(a){return this.H4d=a},Dff:function(){var a=wac_.pa.Qb.TenantId;return this.ua.bcf&&a&&a.length&&"9188040d-6c67-4c5b-b112-36a304b66dad"!==
a?!0:!1},qUd:function(a,b,c,d,e,f,g){if(this.ua.vbc){this.ob.la.xa("OnEnterEndOfShowEventId",this.pif);this.ob.la.xa("OnLeaveEndOfShowEventId",this.qif);this.B4e=!1;this.u7e=!0;try{var h=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}&waccluster={2}",this.ua.M4,d,c);this.ua.Akf&&(h+="&shareable=true");if(this.Dza)(this.taf||this.Cff())&&this.Dza.FetchDocumentDownloadURL(h);else{wac_Y(42869313,833,50,"Creating Broadcast monitor ...");this.Dza=new window.PowerPointLive.PPTBroadcastMonitor(h,
this.ua.uTe,this.ua.mbf);var k=this;this.Dza.RegisterParticipantsCountChangeEventListener(function(a){k.Zz.maxParticipantCount=Math.max(k.Zz.maxParticipantCount,a);k.mua&&k.mua.setParticipantCount(a);k.la.wa("ParticipantsCountChanged",Sys.EventArgs.Empty,null)});this.ua.A8e&&this.Dza.RegisterNewReactionEventListener(this.lsf)}this.Dza.SetCurrentPosition(a,null);this.jaf=a;if(this.taf&&!this.waa){var l=!!wac_r()&&wac_r().Hd().Bg();this.I9e(l?1:2,f,b,d,g);wac_U_c(this,a);this.Z2e=new window.Set}else this.m1c&&
wac_V_c(this);this.Z2e&&this.Z2e.add(a)}catch(m){wac_Y(42869315,833,10,"LivePresenter: Exception at creating Broadcast monitor: {0}",m.toString())}}},Myf:function(){if(this.ua.vbc&&(this.ob.la.sb("OnEnterEndOfShowEventId",this.pif),this.ob.la.sb("OnLeaveEndOfShowEventId",this.qif),this.u7e=this.B4e=!1,this.Keb()&&this.mua)){if(this.ua.vbc&&this.Keb()&&this.Dza&&wac_W_c(this)&&!this.waa.isPaused){wac_X_c(this,1,null);var a=wac_T_c(this,"PauseLiveBroadcasting");try{this.Zz.sessionPauseCount+=1,this.Zz.sessionActiveDurationInMS+=
this.pee()-this.Taf,wac_Y(42869327,833,50,"SessionId: {0}, Message: Pause live broadcasting ...",this.Zz.sessionId),this.mua.actOnSessionPaused(),this.waa.isPaused=!0,this.Dza.PauseLiveBroadcasting(a),this.la.wa("OnLiveSessionPaused",Sys.EventArgs.Empty,null),-1!==this.M4e&&window.clearInterval(this.M4e),this.P4e=30,this.M4e=window.setInterval(this.htf,6E4),wac_9Zc(this.ob,!1,"")}catch(b){wac_T9(this.Zz,wac_62.NGb.toString(4)),wac_Y(50452490,833,10,"SessionId: {0}, Message: Exception when pausing Live session, Details: {1}",
this.Zz.sessionId,b.toString())}finally{wac_Y_c(this)}}this.mua.hideAll();this.m1c||!this.zD||wac_.ke||(a=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.P4e.toString()),a=new wac_a5a(ResourceStrings.l_LiveBusinessBarTitle_PausedSession,a,null),wac_KP(a,!0),wac_LP(a,this.rsf),a.Lja(3),wac_JP(a,ResourceStrings.l_LiveBusinessBarButton_ResumeSession,this.tsf,"",!1),wac_7Oc(a,ResourceStrings.l_LiveBusinessBarButton_EndSession,this.ssf),this.zD.bha().tG(a,!1),this.zD.nab(),this.m1c=
a)}},I9e:function(a,b,c,d,e){var f="rdvSession_"+wac_5k().toString();this.Zz=new wac_R_c;this.Zz.sessionId=f;this.Zz.sessionStartUtc=(new Date).format("yyyy-MM-ddTHH:mm:ss.fffffff");this.Zz.accessControl=wac_62.tcf.toString(this.H4d);if(this.ua.vbc&&this.Dza&&wac_W_c(this)&&!this.waa){wac_WUc(this.ob,this.Xhf);wac_q7(this.ob,new wac_r7(5));var g=wac_T_c(this,"StartLiveBroadcasting");wac_Z_c(this,a,b,c,d,e,f,g)}else wac_T9(this.Zz,wac_62.NGb.toString(3)),wac_Y(50648476,833,10,"StartLiveBroadcasting: Live actor or broadcast monitor is null while trying to start live session!")},
A5e:function(a){if(this.ua.vbc&&this.Keb()&&this.Dza&&wac_W_c(this)){var b=wac_T_c(this,"EndLiveBroadcasting");try{var c=this,d=function(){c.Zz.sessionExitPoint=wac_62.u9e.toString(a);c.waa.isPaused||(c.Zz.sessionActiveDurationInMS+=c.pee()-c.Taf);c.m1c&&wac_V_c(c);wac___c(c);wac_Y(42869329,833,50,"SessionId: {0}, Message: End live broadcasting ...",c.Zz.sessionId);c.mua.actOnSessionEnded();c.ob.la.sb("OnSlideshowReady",c.sif);wac_a_c(c.ob,c.rif);c.ob.la.sb("OnSubtitleUpdatedEventId",c.uif);c.ob.la.sb("OnTranscriberStartedEventId",
c.wif);c.ob.la.sb("OnSetActiveCanvasUrlEventId",c.kif);c.u7e&&wac_9Zc(c.ob,!1,"");c.waa=null;c.k7e=null;c.la.wa("OnLiveSessionEnded",Sys.EventArgs.Empty,null);var d=c.Dza.EndLiveBroadcasting(b);d?d.then(function(){wac_Y(42869331,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call succeeded!",c.Zz.sessionId)}).catch(function(a){wac_Y(50452498,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call failed due to error!, Details: {1}",c.Zz.sessionId,a.toString())}):(wac_T9(c.Zz,
wac_62.NGb.toString(6)),wac_Y(42869333,833,10,"SessionId: {0}, Message: EndLiveBroadcasting failed to created Promise object!"))};this.ua.r5e&&this.k7e&&(1===a||2===a||4===a)?wac_X_c(this,2,d):d()}catch(e){wac_T9(this.Zz,wac_62.NGb.toString(6)),wac_Y(42869335,833,10,"SessionId: {0}, Message: Exception when ending live session!, Details: {1}",this.Zz.sessionId,e.toString())}finally{wac_Y_c(this)}}},eSa:function(a){this.ua.vbc&&this.mua&&(this.t7e=!0,this.mua.showCallout(a))},qAf:function(){this.ua.vbc&&
this.mua&&this.mua.showWelcomeScreen()},zdf:function(a,b){this.ua.vbc&&this.Keb()&&this.mua&&this.mua.showEndSessionDialogWithCallbacks(a,b)},Pyf:function(){if(this.ua.vbc&&this.Dza)if(this.Cff()){var a=this;window.setTimeout(function(){a.la.wa("OnRelaunchPausedSession",Sys.EventArgs.Empty,null)},500);wac_0_c(this)}else this.waa&&this.mua&&this.mua.isWelcomeScreenVisible()&&wac_1_c(this,"LiveWelcomeScreenLayerHost")},Oyf:function(a,b){if(this.ua.vbc&&this.Dza){this.Dza.SetCurrentPosition(b.Ls,b.E3e);
if(this.jaf!==b.Ls&&this.ua.A8e&&this.sBe){a=this.sBe;for(var c=a.length,d=0;d<c;++d)a[d].reactionCount=0;this.mua&&this.mua.resetReactions()}this.jaf=b.Ls;this.Z2e&&this.Z2e.add(b.Ls)}},Lyf:function(){this.B4e=!0;this.ua.vbc&&this.Keb()&&this.mua&&(this.mua.hideURLBar(),wac_X_c(this,0,null))},Nyf:function(){this.B4e=!1;this.ua.vbc&&this.Keb()&&this.mua&&this.mua.showURLBar()},Syf:function(a,b){this.ua.vbc&&this.Keb()&&this.Dza&&(b.ljf?this.Dza.UpdateFinalSubtitles(b.rcf):this.Dza.UpdatePartialSubtitles(b.rcf))},
Uyf:function(a,b){this.Zz.transcriberSessionIds+=b.plf+",";this.ua.vbc&&this.Keb()&&wac_9Zc(this.ob,!0,this.Dza.GetPragueSessionInfoJSONString())},Dyf:function(a,b){this.ua.vbc&&this.Keb()&&this.Dza&&this.Dza.SetActiveCanvasUrl(b.Jif)},fzf:function(){--this.P4e;0>=this.P4e?(wac_V_c(this),this.A5e(3)):this.m1c&&this.m1c.Hua(String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.P4e.toString()))},Hxf:function(a){a===this.m1c&&(this.m1c=null)},Jxf:function(a){a===this.m1c&&this.mua&&
(wac_V_c(this),wac_z().yw(1989200744,2,null))},Ixf:function(a){a===this.m1c&&this.mua&&this.mua.showEndSessionDialog()},pee:function(){return(new Date).getTime()},iyf:function(a,b){this.ob&&this.Dza&&b&&(wac_VUc(this.ob,this.Xhf),this.Dza.SetCurrentPosition(b.Ls,b.E3e))},Ilf:function(){return wac_W_c(this)?this.mua.getCalloutMenuDefinition():null},xxf:function(a){var b=a.slideId===this.jaf;b||wac_Y(51406406,833,50,"SessionId: {0}, Message: New reaction received on slide that is not presenting",this.Zz.sessionId);
if(b&&this.sBe){for(var b=this.sBe,c=b.length,d=0;d<c;++d){var e=b[d];if(e.react===a.react){e.reactionCount+=1;break}}if(this.mua){a=Array(this.sBe.length);for(b=0;b<this.sBe.length;b++){var f;a[b]=(f=new window.PowerPointLive.ILiveReaction,f.react=this.sBe[b].react,f.reactionCount=this.sBe[b].reactionCount,f.reactionImagePath=this.sBe[b].reactionImagePath,f)}this.mua.setReactions(a)}}},xBf:function(a){this.la.xa("OnLiveResourcesLoaded",a)},dCf:function(a){this.la.sb("OnLiveResourcesLoaded",a)},hpf:function(a){this.la.xa("OnLiveSessionStarted",
a)},frf:function(a){this.la.sb("OnLiveSessionStarted",a)},gpf:function(a){this.la.xa("OnLiveSessionEnded",a)},erf:function(a){this.la.sb("OnLiveSessionEnded",a)},vBf:function(a){this.la.xa("OnCalloutDismissed",a)},cCf:function(a){this.la.sb("OnCalloutDismissed",a)},fpf:function(a){this.la.xa("OnRelaunchPausedSession",a)},drf:function(a){this.la.sb("OnRelaunchPausedSession",a)}};
function wac_2_c(a){var b,c,d,e,f,g;a.sBe=[(b=new window.PowerPointLive.ILiveReaction,b.react="yes",b.reactionCount=0,b.reactionImagePath="https://cdn.hubblecontent.osi.office.net/getty/publish/reactions/yes_240.png",b),(c=new window.PowerPointLive.ILiveReaction,c.react="heart",c.reactionCount=0,c.reactionImagePath="https://cdn.hubblecontent.osi.office.net/getty/publish/reactions/heart_240.png",c),(d=new window.PowerPointLive.ILiveReaction,d.react="clap",d.reactionCount=0,d.reactionImagePath="https://cdn.hubblecontent.osi.office.net/getty/publish/reactions/clap_240.png",
d),(e=new window.PowerPointLive.ILiveReaction,e.react="laugh",e.reactionCount=0,e.reactionImagePath="https://cdn.hubblecontent.osi.office.net/getty/publish/reactions/laugh_240.png",e),(f=new window.PowerPointLive.ILiveReaction,f.react="surprised",f.reactionCount=0,f.reactionImagePath="https://cdn.hubblecontent.osi.office.net/getty/publish/reactions/surprised_240.png",f),(g=new window.PowerPointLive.ILiveReaction,g.react="wonder",g.reactionCount=0,g.reactionImagePath="https://cdn.hubblecontent.osi.office.net/getty/publish/reactions/wonder_240.png",
g)]}
function wac_X_c(a,b,c){if(a.ua.r5e&&a.ua.vbc&&a.Dza&&a.waa&&a.k7e)try{a.k7e.then(function(d){var e=!1;switch(b){case 1:if(!a.Z2e||!a.$$e||10*a.Z2e.size<8*a.$$e.size)return;break;case 2:e=!0}var f={triggeredSurveyType:"Survey.AudienceFeedback"};f.isMandatory=e;f.triggerEventId=wac_5k().toString();f.surveyeeName=wac_.J0;a.ua.ccf&&(d?(f.surveyId=d.surveyId,f.surveyResponseUrl=d.surveyResponseUrl):wac_Y(51168984,833,10,"SessionId: {0}, Message: Audience feedback survey info is not valid!",a.Zz.sessionId));a.Dza.TriggerSurvey(JSON.stringify(f));
wac_Y(50860052,833,50,"SessionId: {0}, Message: Triggering audience feedback!, Details: {1}",a.Zz.sessionId,b);c&&c()}).catch(function(b){wac_Y(51168987,833,10,"SessionId: {0}, Message: Failed to trigger audience feedback as CreateSurvey request failed due to error!, Details: {1}",a.Zz.sessionId,b.toString());wac_T9(a.Zz,wac_62.NGb.toString(14));c&&c()})}catch(d){wac_T9(a.Zz,wac_62.NGb.toString(9)),wac_Y(50860054,833,10,"SessionId: {0}, Message: Exception when collecting show info for triggering audience feedback!, Details: {1}",
a.Zz.sessionId,d.toString()),c&&c()}}function wac_U_c(a,b){if(a.ua.r5e&&a.Cc)try{var c=wac_FI(a.Cc),d=!1,e=!1;a.$$e=new window.Set;for(var f=c.length,g=0;g<f;++g){var h=c[g];d||h.Vc()!==b||(d=!0,e=h.qS());!d||h.qS()&&!e||a.$$e.add(h.Vc());e&&!h.qS()&&(e=!1)}}catch(k){wac_T9(a.Zz,wac_62.NGb.toString(8)),wac_Y(50860050,833,10,"SessionId: {0}, Message: Exception when collecting slide show info for triggering audience feedback!, Details: {1}",a.Zz.sessionId,k.toString())}}
function wac_Y_c(a){var b=a.Dza.GetPPTBroadcastMonitorTelemetry();a.Zz.errorCode=b.errorCode.length?b.errorCode:a.Zz.errorCode;a.Zz.documentDownloadUrlOnStartLiveFetchTimeInMS=b.documentDownloadUrlOnStartLiveFetchTimeInMS;a.Zz.pragueInitCallTimeInMS=b.pragueInitCallTimeInMS;a.Zz.sessionDurationInMS=a.pee()-a.ehf;wac_Y(50706442,833,50,JSON.stringify(a.Zz))}
function wac_T_c(a,b){return!a.Dff()||!a.H4d&&a.ua.Cbf?new Promise(function(a){a(null)}):a.qBe?new Promise(function(c){var d=new Date;wac_A_c(a.qBe,a.ua.Pjf,a.ua.Qjf).then(function(e){wac_Y(51197915,833,50,"LivePresenter::GetToken - action: {0}, is success: {1}, time (in ms): {2}, error code: {3}, error message: {4}",b,e.IsSuccess,new Date-d,e.ErrorCode,e.ErrorMessage);e.IsSuccess?c(e.Token):(a.Zz&&wac_T9(a.Zz,wac_62.NGb.toString(7)),wac_Y(50452304,833,15,"LivePresenter::GetToken - action: {0}, Failed to get AAD token with error code: {1}, error message: {2}",
b,e.ErrorCode,e.ErrorMessage),c(null))}).catch(function(e){a.Zz&&wac_T9(a.Zz,wac_62.NGb.toString(7));wac_Y(50452306,833,50,"LivePresenter::GetToken - action: {0}, Time taken to get exception when fetching auth token (in ms): {1}",b,new Date-d);wac_Y(50452308,833,15,"LivePresenter::GetToken - action: {0}, threw exception: {1}",b,e);c(null)})}):(a.Zz&&wac_T9(a.Zz,wac_62.NGb.toString(7)),wac_Y(50452300,833,10,"LivePresenter::GetToken - action: {0}, m_oauthManager is null",b),new Promise(function(a){a(null)}))}
function wac_V_c(a){a.zD&&a.m1c&&a.zD.bha().nda(a.m1c.ia())&&(a.zD.bha().xV(a.m1c),a.zD.nab(),a.m1c.dispose(),a.m1c=null)}function wac___c(a){-1!==a.M4e&&(window.clearInterval(a.M4e),a.M4e=-1)}function wac_1_c(a,b){a.j7e&&a.mua&&window.setTimeout(function(){wac_Vj(a.j7e.ownerDocument.getElementById(b))},50)}
function wac_W_c(a){if(a.ua.vbc&&!a.mua&&a.j7e){var b=new window.PowerPointLive.ILiveActorSettings;b.hostElement=a.j7e;b.baseZIndex=50005;b.welcomeScreenBackgroundImageUrl=a.ed.Io("LiveWelcomeScreenBackground.png");b.welcomeScreenLayerHostId="LiveWelcomeScreenLayerHost";b.calloutContainerId="LiveCalloutContainer";b.urlBarLayerHostId="LiveURLBarLayerHost";b.dialogLayerHostId="LiveDialogLayerHost";b.reactionsBarLayerHostId="LiveReactionBarLayerHost";a.mua=window.liveActor.LiveActorFactory.CREATE_LIVE_ACTOR(b);
a.mua.on("OnWelcomeScreenOpenedAction",function(){wac_1_c(a,"LiveWelcomeScreenLayerHost");a.Zz.welcomeShownCount+=1});a.mua.on("OnWelcomeScreenClosedAction",function(){a.B4e&&a.mua.hideURLBar();a.ob.U6()});a.mua.on("ResumeSessionAction",function(){wac_0_c(a);a.B4e||a.mua.showURLBar()});a.mua.on("EndSessionAction",function(){a.A5e(a.u7e?1:2);a.ob.U6()});a.mua.on("OnCalloutOpenedAction",function(){a.t7e=!0;a.la.wa("OnCalloutOpened",Sys.EventArgs.Empty,null);a.Zz.calloutShownCount+=1});a.mua.on("OnCalloutClosedAction",
function(){a.t7e=!1;a.la.wa("OnCalloutDismissed",Sys.EventArgs.Empty,null);a.ob.U6()});a.mua.on("OnEndSessionDialogOpenedAction",function(){wac_1_c(a,"LiveDialogLayerHost")});a.mua.on("OnEndSessionDialogClosedAction",function(){a.u7e&&a.ob.U6()})}return!!a.mua}
function wac_0_c(a){if(a.ua.vbc&&a.Keb()&&a.Dza&&wac_W_c(a)&&a.waa.isPaused){var b=wac_T_c(a,"ResumeLiveBroadcasting");try{a.Taf=a.pee(),a.Zz.sessionResumeCount+=1,wac_Y(50452492,833,50,"SessionId: {0}, Message: Resume live broadcasting ...",a.Zz.sessionId),a.mua.actOnSessionResumed(),a.Dza.ResumeLiveBroadcasting(b),a.waa.isPaused=!1,a.la.wa("OnLiveSessionResumed",Sys.EventArgs.Empty,null),wac___c(a),wac_9Zc(a.ob,!0,a.Dza.GetPragueSessionInfoJSONString())}catch(c){wac_T9(a.Zz,wac_62.NGb.toString(5)),
wac_Y(50452494,833,10,"SessionId: {0}, Message: Exception when resuming Live session, Details: {1}",a.Zz.sessionId,c.toString())}}}
function wac_Z_c(a,b,c,d,e,f,g,h){try{a.ehf=a.pee();a.Taf=a.pee();a.Zz.sessionEntryPoint=wac_62.t9e.toString(b);a.Zz.isSubtitleStartedByLive=a.v7e;var k=new window.PowerPointLive.RendezvousSessionConfig;k.userSessionId=c;k.webServiceBase=d;k.podSessionId=e;k.docId=f;k.sessionId=g;k.accessControl=1===a.H4d?"organization":"anyone";k.authTokenPromise=h;k.tenantId=1===a.H4d?wac_.pa.Qb.TenantId:"";k.locale=wac_.lHe;k.presentationName=wac_kP(wac_.Vxa);a.ua.zkf||(k.fileName=wac_.Vxa,k.bootstrapperUrl=a.ua.gqc);
var l=a.Dza.StartLiveBroadcasting(k);a.ua.A8e&&wac_2_c(a);if(l){var m=l.then(function(a){var b=new window.PowerPointLive.ILiveSessionURL;b.participantUrl=a.shortParticipantUrl;b.sessionQRCode=a.sessionQRCode;return b});a.waa=new window.PowerPointLive.ILiveSessionState;a.waa.isPrivate=1===a.H4d;a.waa.isPaused=!1;a.waa.participantsCount=0;a.waa.sessionURLPromise=m;a.mua.actOnSessionRequested(a.waa);a.ob.la.xa("OnSlideshowReady",a.sif);a.ob.la.xa("OnTranscriberStartedEventId",a.wif);l.then(function(b){a.Zz.pragueDocId=
b.pragueDocId;a.Zz.sessionCreationWebServiceCallTimeInMS=a.pee()-a.ehf;wac_Y(50452483,833,50,"SessionId: {0}, Message: StartLiveBroadcasting succeeded!, TimeElapsed: {1}",a.Zz.sessionId,a.Zz.sessionCreationWebServiceCallTimeInMS.toString());wac_9Zc(a.ob,!0,a.Dza.GetPragueSessionInfoJSONString());a.ob.la.xa("OnPositionChangeEventId",a.rif);a.ob.la.xa("OnSubtitleUpdatedEventId",a.uif);a.ob.la.xa("OnSetActiveCanvasUrlEventId",a.kif);wac_1_c(a,"LiveWelcomeScreenLayerHost");a.la.wa("OnLiveSessionStarted",
b,null);a.ua.r5e&&(a.k7e=a.ua.ccf?a.Dza.CreateSurvey(h,null):new Promise(function(a){a(null)}))}).catch(function(b){wac_Y(42869319,833,10,"SessionId: {0}, Message: StartLiveBroadcasting failed due to error!, Details: {1}",a.Zz.sessionId,b.toString());wac_T9(a.Zz,wac_62.NGb.toString(3));wac_Y_c(a)})}else wac_T9(a.Zz,wac_62.NGb.toString(3)),wac_Y(42869321,833,10,"StartLiveBroadcasting failed to create Promise object!")}catch(n){wac_T9(a.Zz,wac_62.NGb.toString(3)),wac_Y(42869323,833,10,"SessionId: {0}, Message: Exception when staring a new Live session, Details: {1}",
a.Zz.sessionId,n.toString())}finally{wac_Y_c(a)}}Type.registerNamespace("PowerPointWebEditor.Live");wac_Z=window.PowerPointWebEditor||{};wac_Z.qxf=wac_Z.qxf||{};function wac_3_c(){this.SB=Function.createDelegate(this,this.sC)}
wac_3_c.prototype={J:null,xqf:0,Ub:function(){return"PowerPointWebEditor.Live"},gc:function(a){this.J=a;var b=this.J.H(wac_kG),c=this;wac_m(wac_n(this.J.fa(wac_5Uc)),function(){return new wac_S_c(c.J.H(wac_R),b,c.J.H(wac_l7),c.J.H(wac_5F),c.J.H(wac_l_c),c.J.H(wac_Mt))})},sC:function(){try{if(this.J.H(wac_R).vbc){this.xqf=Date.now();wac_Y(42869339,833,50,"PPTWebEditorLivePackage: Loading the Live Presenter scripts");var a=this;wac_Zg(window.Common.App.AppLifecycleManager.get_instance(),7,function(){var b=
a.J.H(wac_wEa).uje,c=new (wac_g.$$(Promise));c.ga(b.MRd("PPTLiveBroadcast"));c.ga(b.MRd("BroadcastMonitor"));c.ga(b.MRd("liveActor"));wac_r().Hd().Bg()||c.ga(b.MRd("uiFabricLazy"));Promise.all(c.xe()).then(function(){wac_Y(50860060,833,50,"PPTWebEditorLivePackage: Loading time: {0}ms",Date.now()-a.xqf);var b=a.J.H(wac_5Uc);b.D4e=!0;b.D4e&&b.la.wa("OnLiveResourcesLoaded",Sys.EventArgs.Empty,null);return null}).catch(function(a){return wac_Y(42869341,833,10,"Failed to load scripts for the Live Presenter feature: {0}",
a)})},3)}else wac_Y(42869337,833,50,"PPTWebEditorLivePackage: Not loading the Live Presenter scripts because the feature is not enabled")}catch(b){wac_Y(42869343,833,10,"PPTWebEditorLivePackage: exception in OnFullAppSettingsReady: {0}",b)}},tb:function(){wac_.pa.Ok(this.SB)},O:function(){}};window.PowerPointLive.ILiveSessionURL.registerClass("PowerPointLive.ILiveSessionURL");window.PowerPointLive.ILiveSessionState.registerClass("PowerPointLive.ILiveSessionState");window.PowerPointLive.ILiveActorSettings.registerClass("PowerPointLive.ILiveActorSettings");
window.PowerPointLive.ILiveReaction.registerClass("PowerPointLive.ILiveReaction");window.PowerPointLive.ILiveActor.registerClass("PowerPointLive.ILiveActor");wac_R_c.registerClass("PowerPointLive.LiveSessionTelemetry");wac_S_c.registerClass("PowerPointLive.LivePresenter",null,wac_5Uc);wac_3_c.registerClass("PowerPointWebEditor.Live.PPTWebEditorLivePackage",null,wac_I,wac_i);wac_J(wac_C(),new wac_3_c,0,!1);Type.registerNamespace("PowerPointWebEditor");wac_Z=window.PowerPointWebEditor||{};
function wac_dIc(){}wac_dIc.registerInterface("PowerPointWebEditor.IThumbnailDataStoreManager");function wac_4_c(){}wac_4_c.registerInterface("PowerPointWebEditor.ISlideGridHelper");function wac_eIc(a,b){this.h_e=a;this.ePe=b}wac_eIc.prototype={h_e:null,ePe:null,olf:null,ojf:!1};
function wac_fIc(a,b,c,d,e){this.gif=Function.createDelegate(this,this.zyf);this.iif=Function.createDelegate(this,this.Byf);this.tif=Function.createDelegate(this,this.Qyf);this.hif=Function.createDelegate(this,this.Ayf);this.rI=Function.createDelegate(this,this.mna);this.hld=Function.createDelegate(this,this.pza);this.la=new wac_Re;this.Kf=a;this.WUd={};this.t4c=b;this.f3e=c;this.dhf=d;this.fj=e}
wac_fIc.prototype={Kf:null,WUd:null,t4c:null,qGa:null,Qp:!1,f3e:null,dhf:null,fj:null,tge:function(){try{return this.qGa=this.Kf.msa()}catch(a){return wac_Y(41239360,822,10,"ThumbnailDataStoreManager: Exception in GetSlideOrder: {0}",a),null}},zqd:function(a){return this.Kf.zqd(a)},s2e:function(){return this.Kf.s2e()},O:function(){try{this.Qp||(this.Qp=!0,wac_5_c(this))}catch(a){wac_Y(41239364,822,10,"ThumbnailDataStoreManager: Exception in Dispose: {0}.",a)}},pza:function(a,b){wac_6_c(this,b.En)},
mna:function(a,b){try{2===b.EP&&(b.Hc.pS()||wac_6_c(this,-1))}catch(c){wac_Y(50861078,822,10,"ThumbnailDataStoreManager: Exception in OnChildTopologyChanged: {0}.",c)}},Ayf:function(a,b){b.nh!==wac_tCc&&b.nh!==wac_HBc||wac_6_c(this,-1)},Byf:function(a,b){wac_Y(51135129,822,50,"ThumbnailDataStoreManager: OnSectionRemoved handler called.");b&&wac_6_c(this,-1)},Qyf:function(a,b){wac_Y(51172897,822,50,"ThumbnailDataStoreManager: OnSlidesRemoved handler called.");b&&wac_6_c(this,-1)},zyf:function(){wac_6_c(this,
-1)}};function wac_gIc(a){a.qGa=a.Kf.msa();for(var b=0;b<a.qGa.length;b++){var c=a.qGa[b];a.WUd[c.Vc().toString()]||(a.WUd[c.Vc().toString()]=new wac_eIc(c,""));var d=a.WUd[c.Vc().toString()],e=a.Kf.y_(b);e&&(e.Mk&&e.Mk.src&&e.Mk.src.length&&(e.N$?(wac_Y(50861058,822,50,"ThumbnailDataStoreManager: slide {0} is not ready for render, Sid={1}, Cid={2}.",b,c.Vc(),c.fe()),d.ePe=""):d.ePe=e.Mk.src),d.ojf=e.qS(),d.olf=e.Mk?e.Mk.title:"")}}
function wac_6_c(a,b){wac_gIc(a);var c={};c.SlideIndex=b;a.la.wa("ThumbnailDataStoreUpdated",c,null)}function wac_7_c(a){try{return a.Kf.y_(0).VF}catch(b){return wac_Y(41817742,822,10,"ThumbnailDataStoreManager: Exception in GetThumbnailSize: {0}",b),new wac_LF(176,100)}}function wac_8_c(a,b){a.la.sb("ThumbnailDataStoreUpdated",b)}function wac_9_c(a,b){a.la.xa("ThumbnailDataStoreUpdated",b)}
function wac_$_c(a,b){try{a.qGa=a.Kf.msa();for(var c=a.qGa.length,d=0,e=0;e<a.qGa.length;e++)for(var f=0;f<b.length;f++)a.qGa[e].Vc()===b[f].Vc()&&a.qGa[e].fe()===b[f].fe()&&(e<=c&&(c=e),e>=d&&(d=e));var g=new wac_7F(c,d>c?d-c+1:1,!1);a.Kf.HCe(g,!0,{})}catch(h){wac_Y(41239362,822,10,"ThumbnailDataStoreManager: Exception in RequestThumbnails: {0}",h)}}
function wac_5_c(a){a.t4c.la.sb("STN",a.hld);wac_Sy(a.f3e,a.rI);wac_lD(a.dhf,a.hif);a.fj.la.sb("SLNR",a.tif);a.fj.la.sb("SECNR",a.iif);a.fj.la.sb("SECNOC",a.gif)}function wac_a0c(a){a.t4c.la.xa("STN",a.hld);wac_Ry(a.f3e,a.rI);wac_mD(a.dhf,a.hif);a.fj.la.xa("SLNR",a.tif);a.fj.la.xa("SECNR",a.iif);a.fj.la.xa("SECNOC",a.gif)}function wac_hIc(a){wac_gIc(a);return a.WUd}
function wac_iIc(a,b,c,d,e,f){this.suf=Function.createDelegate(this,this.MAf);this.W6c=Function.createDelegate(this,this.Ezd);this.ibf=Function.createDelegate(this,this.rAf);this.CSe=Function.createDelegate(this,this.h0e);this.bOe=Function.createDelegate(this,this.s1e);this.aOe=Function.createDelegate(this,this.k1e);this.pYe=Function.createDelegate(this,this.A_e);this.Y3=Function.createDelegate(this,this.CM);this.Mvb=Function.createDelegate(this,this.fMb);this.Kgc=Function.createDelegate(this,this.vUd);
this.luf=Function.createDelegate(this,this.DAf);this.pZe=Function.createDelegate(this,this.c1e);this.Uaf=this.kaf=this.gaf=this.KHb=-1;this.dispose=this.O;this.Jf=a;this.HUc=b;this.U=c;this.ob=d;this.SGa=e;this.nEe=!1;this.uGa=null;this.K$d=f;this.zaf=wac_q(wac_.pa,"PptGridViewUseFullExitSlideShowEnabled");this.Apf=wac_Lg(wac_.pa,"PPTCloseGridViewTimeoutMs",500);this.Xff=wac_Lg(wac_.pa,"PPTGridViewDisplayNoneTimeoutMs",800);this.Spf=wac_Lg(wac_.pa,"PPTGridViewTransitionTimeoutMs",500);this.AZe=[]}
wac_iIc.prototype={SGa:null,K$d:null,U:null,Jf:null,HUc:null,ob:null,RH:null,dad:null,$2e:null,SZe:null,HDe:null,yaf:null,oaf:null,nEe:!1,R7b:!1,Qp:!1,uGa:null,fja:null,K4e:!1,H4e:!1,Gaf:0,z7e:0,Apf:0,Xff:0,Spf:0,zaf:!1,Ejd:0,bTe:0,DRe:!0,AZe:null,DQe:0,z4e:null,Tb:function(){this.U.ja(1461264478,1,this.pZe);this.U.ja(1910466663,1,this.luf);this.ob.EEa(this.Kgc)},c1e:function(a,b,c){return 2===c?wac_b0c(this):32},DAf:function(a,b,c){try{if(2===c)if(wac_Y(41714240,822,15,"ToggleGridView called."),
this.nEe)wac_c0c(this,!0),wac_lIc(this,!1);else return wac_b0c(this);return 32}catch(d){return wac_Y(41714242,822,10,"GridViewActor: Exception in ToggleGridView: {0}.",d),8}},fMb:function(a,b){try{wac_VUc(this.ob,this.Mvb);var c=this.KHb=b.En,d=b.E3e,e;wac_q7(this.ob,(e=new wac_ZUc,e.SlideIndex=c,e.TimeLineMappings=d,e));wac_Vj(this.RH.Oa);this.DQe=0;var f=this.SGa.tge();if(f){var g=wac_jIc(this.HUc,f,wac_hIc(this.SGa));wac_d0c(g);var h=wac_kIc(this.HUc,g);this.fja.show(this.KHb,g,h)}}catch(k){wac_Y(41539613,
822,10,"Exception in OnGetCurrentPositionHandler: {0}.",k)}},rAf:function(a,b){try{if(this.K4e&&b){var c=b.En;this.KHb!==c||0>this.KHb?wac_Y(41539615,822,15,"GridViewActor-SlideChangedHandler: currentSelectedSlideIndex not equal to slideIndex in args. currentSelectedSlideIndex: {0}, slideIndex: {1}.",this.KHb,c):(wac_a_c(this.ob,this.ibf),this.ob.Eab(c),this.z7e=Date.now(),wac_e0c(this),wac_lIc(this,!0),this.K4e=!1)}}catch(d){wac_Y(41539619,822,10,"Exception in SlideChangedHandler: {0}.",d)}},CM:function(a){try{if(71===
a.keyCode)this.Ezd(null);else if(13===a.keyCode){var b=this.AZe?this.AZe[this.DQe]:null;!b||b.className!==this.yaf.className&&b.className!==this.oaf.className||this.Ezd(null)}else 27===a.keyCode&&!wac__Ac()&&this.nEe&&(this.zaf?wac_$Zc(this.ob):wac_p7(this.ob),wac_lIc(this,!1));a.ctrlKey&&117===a.keyCode&&((this.DQe=a.shiftKey?Math.abs((this.DQe-1)%this.AZe.length):(this.DQe+1)%this.AZe.length)?0<this.DQe?wac_Vj(this.AZe[this.DQe]):wac_Y(50444322,822,15,"GridViewActor: wrong focus index value: {0}.",
this.DQe):this.fja.restoreFocusToGrid())}catch(c){wac_Y(50444352,822,10,"GridViewActor: Exception in KeyDownHandler : {0}.",c)}},h0e:function(a,b){try{var c=this.SGa.tge();if(c){var d=wac_jIc(this.HUc,c,wac_hIc(this.SGa));wac_d0c(d);this.fja.slideDataList=d;this.fja.sectionDataList=wac_kIc(this.HUc,d);if(b.SlideIndex){var e=b.SlideIndex;-1!==e&&(0<=e&&e<c.length?this.p2e(c[e]):wac_Y(41683094,822,10,"OnDataStoreUpdated: slideIndex is invalid: {0}.",e))}else wac_Y(41683096,822,10,"OnDataStoreUpdated: SlideIndex is null from eventData.")}else wac_Y(41239318,
822,10,"OnDataStoreUpdated: slideOrder is null.")}catch(f){wac_Y(41239320,822,10,"Exception in OnDataStoreUpdated: {0}.",f)}},p2e:function(a){try{var b=this.fja.visibleSlideRange,c=!1;if(a)for(var d=b.length,e=0;e<d;++e){var f=b[e];if(f.slideSid===a.Vc()){c=!0;break}}else c=!0;if(c){a=!0;for(var g=b.length,c=0;c<g;++c)for(var f=b[c],h=this.fja.slideDataList,k=h.length,d=0;d<k;++d){var l=h[d];if(l.slideID.slideSid===f.slideSid&&l.slideID.slideCid===f.slideCid&&!l.thumbnailImage){a=!1;break}}a&&0<this.Ejd&&
(this.bTe=Date.now(),wac_Y(41683099,822,15,"VisibleSlideRangePLT - firstVisibleRangePLTCalc: {0}, visibleSlideLength: {1}, startTime: {2}, endTime: {3}, elapse: {4}.",this.DRe,b.length,this.Ejd,this.bTe,this.bTe-this.Ejd),this.DRe&&(this.DRe=!1),this.bTe=this.Ejd=0)}}catch(m){wac_Y(41683101,822,10,"Exception in CheckAndLogVisibleSlideRangePLT: {0}.",m)}},k1e:function(a,b){try{this.Gaf=Date.now();var c=b.slideIndex;wac_Y(41539651,822,15,"GridViewActor: SlideSelectionChangeHandler - targetSlideIndex: {0}.",
c);if(0>this.KHb)wac_Y(41539653,822,10,"GridViewActor-SlideSelectionChangeHandler: wrong currentSelectedSlideIndex: {0}.",this.KHb);else{var d=this.SGa.tge();if(!d||0>=d.length)wac_Y(41953432,822,10,"GridViewActor-SlideSelectionChangeHandler: wrong slideOrder.");else{var e=this.KHb===d.length-1;if(this.KHb!==c||e){this.ob.la.xa("OnPositionChangeEventId",this.ibf);this.KHb=c;this.K4e=!0;wac_c0c(this,!0);0<=c&&this.ob.Eab(c);wac_f0c(this.gaf);var f=this;this.gaf=window.setTimeout(function(){try{f.nEe&&
f.K4e&&wac_lIc(f,!0)}catch(a){wac_Y(41959616,822,10,"GridViewActor: Exception in closeGridViewTimeoutHandler: {0}.",a)}},this.Apf)}else wac_Y(41539655,822,15,"GridViewActor: SlideSelectionChangeHandler - targetSlideIndex is the same to currentSelectedSlideIndex: {0}",this.KHb),this.K4e||(wac_c0c(this,!0),this.z7e=Date.now(),wac_e0c(this),wac_lIc(this,!0))}}}catch(g){wac_Y(41239324,822,10,"GridViewActor: Exception in SlideSelectionChangeHandler: {0}.",g)}},s1e:function(){try{this.Ejd=Date.now();this.p2e(null);
for(var a=[],b=this.fja.visibleSlideRange,c=b.length,d=0;d<c;++d){var e=b[d],f;a.push(new wac_wF((f=new wac_Ta,f.Cid=e.slideCid,f.Sid=e.slideSid,f)))}wac_$_c(this.SGa,a)}catch(g){wac_Y(41239326,822,10,"GridViewActor: Exception in VisibleSlideRangeChangedHandler: {0}.",g)}},MAf:function(){try{wac_g0c(this);this.$2e.Oa.style.display="none";var a=this;window.setTimeout(function(){a.dad&&(a.dad.Oa.style.display="none");a.SZe.Oa.style.display="none";wac_b0c(a)},1E3)}catch(b){wac_Y(41972700,822,10,"Exception in TryAgainButtonClickHandler: {0}.",
b)}},vUd:function(){try{this.R7b=!0,this.zaf&&wac_$Zc(this.ob),wac_lIc(this,!1),this.ob.DIa(this.Kgc)}catch(a){wac_Y(41239521,822,10,"GridViewActor: Exception in OnSlideshowExitHandler: {0}.",a)}},A_e:function(){try{this.nEe&&(this.zaf&&wac_$Zc(this.ob),wac_lIc(this,!1))}catch(a){wac_Y(41239523,822,10,"GridViewActor: Exception in FullScreenChangeHandler: {0}.",a)}},Ezd:function(){try{wac_c0c(this,!0),wac_lIc(this,!1)}catch(a){wac_Y(41239554,822,10,"GridViewActor: Exception in CloseButtonClickHandler: {0}.",
a)}},O:function(){try{this.Qp||(this.Qp=!0,wac_lIc(this,!1),this.ob.DIa(this.Kgc),wac_hEb()&&this.uGa&&window.$removeHandler(this.Jf,wac_hEb(),this.uGa),wac_h0c(this))}catch(a){wac_Y(41239330,822,10,"GridViewActor: Exception in Dispose: {0}.",a)}}};function wac_h0c(a){wac_Y(50954582,822,50,"GridViewActor: DisposeSlideGridComponentIfExist.");a.RH&&(wac_jg(a.RH.Oa,"keydown",a.Y3),a.Jf.removeChild(a.RH.Oa),a.RH=null);a.fja&&(a.fja=null)}
function wac_e0c(a){wac_Y(41539664,822,15,"GridViewActor: selectedSlideIndex: {0}, selectedTime: {1}, showTime: {2}, elapse: {3}",a.KHb,a.Gaf,a.z7e,a.z7e-a.Gaf);a.Gaf=0;a.z7e=0}function wac_f0c(a){0<=a&&window.clearTimeout(a)}
function wac_g0c(a){if(!a.SZe){a.SZe=new wac_FG;wac_IG(a.SZe,"grid-view-spinner-class");var b=document.createElement("div");b.className="grid-view-spinner-inner-class";a.SZe.Oa.appendChild(b);if(a.Jf)a.Jf.appendChild(a.SZe.Oa);else{a.SZe=null;return}}a.SZe.Oa.style.display="flex"}
function wac_lIc(a,b){try{wac_Y(41441490,822,50,"GridViewActor: CloseGridView called."),a.H4e?wac_Y(42074850,822,15,"GridViewActor: GridView is in closing status."):a.RH&&(a.H4e=!0,wac_5_c(a.SGa),wac_8_c(a.SGa,a.CSe),wac_IG(a.RH,"pptonline-slideshow-grid-view-transition-class"),a.dad&&(a.dad.Oa.style.display="none"),b?(wac_f0c(a.Uaf),wac_f0c(a.kaf),a.Uaf=window.setTimeout(function(){try{a.RH.Oa.style.opacity="0",a.nEe=!1}catch(b){wac_Y(41959622,822,10,"Exception in setZeroOpacityHandler: {0}.",b)}},
a.Xff-a.Spf),a.kaf=window.setTimeout(function(){try{a.H4e=!1,a.RH.Oa.style.display="none"}catch(b){wac_Y(41959624,822,10,"Exception in displayNoneTimeoutHandler: {0}.",b)}},a.Xff)):(a.RH.Oa.style.opacity="0",a.nEe=!1,a.H4e=!1,a.RH.Oa.style.display="none"),a.fja&&(a.fja.events.onSlideSelectionChanged.unsubscribe(a.aOe),a.fja.events.onVisibleSlideRangeChanged.unsubscribe(a.bOe)))}catch(c){wac_Y(41714261,822,10,"GridViewActor: Exception in CloseGridView: {0}.",c),a.H4e=!1}}
function wac_i0c(a){var b=document.createElement("div");a.AZe.push(b);b.className=wac_Ag?"pptonline-slideshow-grid-view-close-button-class rtl-ui":"pptonline-slideshow-grid-view-close-button-class";b.setAttribute("tabindex","0");var c=document.createElement("i");c.className="ms-Icon ms-Icon--Back";b.appendChild(c);b.title=ResourceStrings.L_GridView_CloseButtonNewText;wac_tf(b,"click",a.W6c);return b}
function wac_d0c(a){if(a)for(var b=a.length,c=0;c<b;++c){var d=a[c];d.slideAriaLabel=d.slideTitle;d.isHiddenSlide&&(d.slideAriaLabel+=", "+ResourceStrings.l_SlideIsHidden);d.slideAriaLabel+=" "+ResourceStrings.L_GridView_GridContainerTitle}}function wac_c0c(a,b){a.ob?(a.ob.ob.style.display=b?"block":"none",b&&!a.R7b&&(wac_ag()||document.activeElement.blur(),a.ob.U6())):wac_Y(41239322,822,10,"GridViewActor: m_frame is null in TryToggleSlideShowFrame.")}
function wac_b0c(a){try{wac_Y(41441478,822,15,"ShowGridView: Open grid view.");wac_f0c(a.gaf);a.gaf=-1;wac_f0c(a.kaf);a.kaf=-1;wac_f0c(a.Uaf);a.Uaf=-1;a.nEe=!0;a.H4e=!1;a.K4e=!1;a.R7b=!1;var b=a.SGa.tge();if(!b)return wac_Y(41239314,822,10,"ShowGridView: slideOrder is null."),wac_h0c(a),8;wac_Y(41441481,822,15,"ShowGridView: slideOrder length: {0}.",b.length);wac_a0c(a.SGa);wac_WUc(a.ob,a.Mvb);wac_q7(a.ob,new wac_r7(17));a.DRe=!0;var c=wac_7_c(a.SGa);!a.z4e||c.ac===a.z4e.ac&&c.qc===a.z4e.qc||(wac_Y(50954518,
822,50,"ShowGridView: thumbnailSize updated, new width: {0}, new height: {1}, old width: {2}, old height: {3}",c.ac,c.qc,a.z4e.ac,a.z4e.qc),wac_h0c(a));if(a.RH&&a.RH.Oa)a.Ejd=Date.now(),a.fja.events.onSlideSelectionChanged.subscribe(a.aOe),a.fja.events.onVisibleSlideRangeChanged.subscribe(a.bOe),d=wac_jIc(a.HUc,b,wac_hIc(a.SGa)),wac_d0c(d),a.fja.slideDataList=d,a.fja.sectionDataList=wac_kIc(a.HUc,d);else{a.RH=new wac_FG;a.AZe.push(a.RH.Oa);a.HDe=document.createElement("div");a.RH.Oa.appendChild(a.HDe);
a.RH.Oa.setAttribute("tabindex","0");a.RH.Oa.setAttribute("aria-label",ResourceStrings.L_GridView_GridContainerTitle);a.yaf||(a.yaf=wac_i0c(a));a.RH.Oa.appendChild(a.yaf);a.RH.Oa.id="pptonline-slideshow-grid-view-id";a.RH.Oa.className="pptonline-slideshow-grid-view-class";a.HDe.className="pptonline-slideshow-grid-view-inner-container-class";a.Jf.appendChild(a.RH.Oa);a.RH.Oa.style.width="100%";a.RH.Oa.style.height="100%";wac_GYc(a.RH,"pptonline-slideshow-grid-view-transition-class");a.RH.Oa.style.display=
"block";a.RH.Oa.style.opacity="1";wac_tf(a.RH.Oa,"keydown",a.Y3);wac_hEb()&&!a.uGa&&(a.uGa=a.pYe,window.$addHandler(a.Jf,wac_hEb(),a.uGa));var d=wac_jIc(a.HUc,b,wac_hIc(a.SGa)),e=wac_kIc(a.HUc,d);a.z4e=c;var f=new wac_LF(0,0);if(c.qc&&c.ac){var g=c.ac/c.qc;1<=g?(f.ac=247,f.qc=247/g):(f.qc=247,f.ac=247*g)}else f.ac=247,f.qc=247/1.76;if(!a.fja){var h=new window.PPTGridComponent.SlideGridSettings;h.throttleTimeoutInMs=1E3;h.debounceWaitTimeInMs=200;h.slideWidth=f.ac;h.slideHeight=f.qc;h.enableSelectionBetweenSlides=
!1;h.isRTL=wac_Ag;a.fja=window.SlideGrid.SlideGridFactory.CreateSlideGrid(h,a.HDe)}a.Ejd=Date.now();a.fja.events.onSlideSelectionChanged.subscribe(a.aOe);a.fja.events.onVisibleSlideRangeChanged.subscribe(a.bOe);a.fja.show(0,d,e)}wac_GYc(a.RH,"pptonline-slideshow-grid-view-transition-class");a.RH.Oa.style.display="block";a.RH.Oa.style.opacity="1";a.p2e(null);wac_Vj(a.RH.Oa);wac_q7(a.ob,new wac_r7(15));wac_c0c(a,!1);wac_9_c(a.SGa,a.CSe);wac_a_c(a.ob,a.ibf);return 32}catch(p){wac_Y(41239316,822,10,"GridViewActor: Exception in ShowGridView: {0}.",
p);a:try{if(!a.dad){a.dad=new wac_FG;a.$2e=new wac_FG;a.oaf||(a.oaf=wac_i0c(a));a.dad.Oa.appendChild(a.oaf);a.dad.Oa.appendChild(a.$2e.Oa);wac_IG(a.$2e,"pptonline-slideshow-grid-view-error-ui-inner");var k=document.createElement("div"),l=document.createElement("span");l.innerText=ResourceStrings.L_GridView_TryAgainError;k.setAttribute("tabindex","0");k.className="pptonline-slideshow-grid-view-error-ui-message";k.appendChild(l);a.$2e.Oa.appendChild(k);var m=document.createElement("div"),n=document.createElement("span");
n.innerText=ResourceStrings.L_GridView_TryAgainButton;m.setAttribute("tabindex","0");m.className="pptonline-slideshow-grid-view-try-again-button";m.appendChild(n);a.$2e.Oa.appendChild(m);wac_tf(m,"click",a.suf);if(a.Jf)a.Jf.appendChild(a.dad.Oa);else{a.dad=null;break a}a.dad.Oa.setAttribute("tabindex","0");wac_IG(a.dad,"pptonline-slideshow-grid-view-error-ui-class");wac_IG(a.dad,"pptonline-slideshow-grid-view-class")}a.$2e.Oa.style.display="block";a.dad.Oa.style.display="flex";wac_tf(a.RH.Oa,"keydown",
a.Y3);wac_Vj(a.RH.Oa)}catch(q){wac_Y(41972698,822,10,"Exception in ShowGridViewErrorUI: {0}.",q)}return 8}}
function wac_j0c(a,b,c,d,e,f,g,h,k,l,m,n,p,q){this.jrf=Function.createDelegate(this,this.Fvf);this.isf=Function.createDelegate(this,this.jxf);this.Eif=Function.createDelegate(this,this.Yzf);this.Fif=Function.createDelegate(this,this.Zzf);this.Shf=Function.createDelegate(this,this.wxf);this.bOe=Function.createDelegate(this,this.s1e);this.aOe=Function.createDelegate(this,this.k1e);this.CSe=Function.createDelegate(this,this.h0e);this.RB=Function.createDelegate(this,this.RG);this.X3=Function.createDelegate(this,
this.CG);this.Y3=Function.createDelegate(this,this.CM);this.Zrf=Function.createDelegate(this,this.Nwf);this.dsf=Function.createDelegate(this,this.Uwf);this.Vrf=Function.createDelegate(this,this.Iwf);this.prf=Function.createDelegate(this,this.Ovf);this.buf=Function.createDelegate(this,this.nAf);this.KHb=-1;this.dispose=this.O;this.Jf=a;this.HUc=b;this.U=c;this.SGa=d;this.ha=e;this.Ca=f;this.Cc=g;this.Lc=h;this.Qg=k;this.Ea=l;this.Kz=m;this.Dg=n;this.ra=p;this.Gt=q}
wac_j0c.prototype={U:null,Dg:null,ra:null,Gt:null,Kz:null,Lc:null,ha:null,SGa:null,Jf:null,HUc:null,vgb:null,X0c:null,h3e:null,Qp:!1,fja:null,phf:!1,Ejd:0,bTe:0,DRe:!0,Ea:null,Ca:null,Cc:null,Qg:null,Tb:function(){this.U.ja(1659792175,1,this.buf);this.U.ja(1726941916,1,this.prf);this.U.Mp(2116436229,1,this.Vrf,4);this.U.Mp(224216753,1,this.dsf,4);this.U.Mp(1482946580,1,this.Zrf,4)},nAf:function(a,b,c){return 2===c?(wac_0L(this.Qg,new wac_XL(2)),a=wac_k0c(this,!1),this.U.yw(1199489336,2,null),a):32},
RG:function(a,b){b.Epc?(wac_jJ(b.Epc)&&this.h0e(null,{SlideIndex:-1}),this.phf?this.phf=!1:(this.KHb=b.Epc.En,this.fja.selectedSlideIndex=b.Epc.En)):wac_Y(50878148,829,50,"SorterViewActor::OnActiveSlideChanged - active slide was null. CorrelationId")},h0e:function(a,b){try{var c=this.SGa.tge();if(c)if(c.length){var d=this.Ea.Yj,e=wac_jIc(this.HUc,c,wac_hIc(this.SGa));this.fja.slideDataList=e;this.fja.sectionDataList=wac_kIc(this.HUc,e);this.fja.shouldDisplaySections=!(!d||!wac_DQ(d)||!wac_DQ(d).length);
if(b.SlideIndex){var f=b.SlideIndex;-1!==f&&(0<=f&&f<c.length?this.p2e(c[f]):wac_Y(42821794,822,10,"OnDataStoreUpdated: slideIndex is invalid: {0}.",f))}else wac_Y(42821824,822,10,"OnDataStoreUpdated: SlideIndex is null from eventData.")}else wac_Y(51409811,822,50,"OnDataStoreUpdated: ShowAddFirstSlidePane since slideOrder length is 0."),wac_l0c(this);else wac_Y(42821792,822,10,"OnDataStoreUpdated: slideOrder is null.")}catch(g){wac_Y(42821826,822,10,"Exception in OnDataStoreUpdated: {0}.",g)}},CG:function(a){var b=
8;try{if(this.X0c&&"none"!==this.X0c.Oa.style.display)return!0;var c=wac__ka(a.get_clientPoint()),d=/grid-content-boundary/,e=/grid-list-view/,f=/edit-title/,g=/title-input/,b=0<c.className.search(/grid-frame-view/)||0<c.className.search(e)||0<c.className.search(d)?this.U.os(3445793010,2,a,null):0<c.className.search(f)||0<c.className.search(g)?this.U.os(2813641994,2,a,null):this.U.os(2313352840,2,a,null)}catch(h){wac_Y(50652364,822,10,"Exception in ContextMenuHandler: {0}.",h)}return 32===b},Fvf:function(){try{this.U.yw(872870130,
2,null),this.X0c.Oa.style.display="none",this.h3e.style.display="block",wac_m0c(this),wac_k0c(this,!0)}catch(a){wac_Y(51409821,822,10,"Exception in AddFirstSlidePaneClickHandler: {0}.",a)}},p2e:function(a){try{var b=this.fja.visibleSlideRange,c=!1;if(a)for(var d=b.length,e=0;e<d;++e){var f=b[e];if(f.slideSid===a.Vc()){c=!0;break}}else c=!0;if(c){a=!0;for(var g=b.length,c=0;c<g;++c)for(var f=b[c],h=this.fja.slideDataList,k=h.length,d=0;d<k;++d){var l=h[d];if(l.slideID.slideSid===f.slideSid&&l.slideID.slideCid===
f.slideCid&&!l.thumbnailImage){a=!1;break}}a&&0<this.Ejd&&(this.bTe=Date.now(),wac_Y(42821828,822,15,"VisibleSlideRangePLT - firstVisibleRangePLTCalc: {0}, visibleSlideLength: {1}, startTime: {2}, endTime: {3}, elapse: {4}.",this.DRe,b.length,this.Ejd,this.bTe,this.bTe-this.Ejd),this.DRe&&(this.DRe=!1),this.bTe=this.Ejd=0)}}catch(m){wac_Y(42821830,822,10,"Exception in CheckAndLogVisibleSlideRangePLT: {0}.",m)}},Yzf:function(a,b){try{var c=b.sectionIndex,d=b.clickedAway;wac_Y(50690002,822,15,"SorterViewActor: SectionSelectionChangedHandler - targetSectionIndex: {0}.",
c);wac_vNc(this.Ea,d?-1:c);if(!d){var e=this.SGa.s2e();e&&e[c]&&(a=-1,e[c].SlideIds&&0<e[c].SlideIds.length&&(a=wac_EI(this.Cc,new wac_wF(e[c].SlideIds[0])).yo()),wac_n0c(this,a))}}catch(f){wac_Y(50690004,822,10,"SorterViewActor: Exception in SectionSelectionChangedHandler: {0}.",f)}},jxf:function(a,b){try{var c=b.insertIndex;wac_Y(51258056,822,50,"SorterViewActor: InsertBetweenSlidesPositionChangedHandler - targetSlideIndex: {0}.",c);this.phf=!0;c?wac_n0c(this,c-1):wac_n0c(this,c)}catch(d){wac_Y(51258058,
822,10,"SorterViewActor: Exception in InsertBetweenSlidesPositionChangedHandler: {0}.",d)}},k1e:function(a,b){try{var c=b.slideSelectionTrigger,d=b.slideIndex;wac_Y(42821832,822,15,"SorterViewActor: SlideSelectionChangeHandler - targetSlideIndex: {0}.",d);if(0>this.KHb)wac_Y(42821834,822,10,"SorterViewActor-SlideSelectionChangeHandler: wrong currentSelectedSlideIndex: {0}.",this.KHb);else{var e=this.SGa.tge();!e||0>=e.length?wac_Y(42821836,822,10,"SorterViewActor-SlideSelectionChangeHandler: wrong slideOrder."):
(wac_n0c(this,d),1!==c&&3!==c||this.U.yw(12696731,2,null))}}catch(f){wac_Y(42821840,822,10,"SorterViewActor: Exception in SlideSelectionChangeHandler: {0}.",f)}},s1e:function(){try{this.Ejd=Date.now();this.p2e(null);for(var a=[],b=this.fja.visibleSlideRange,c=b.length,d=0;d<c;++d){var e=b[d],f;a.push(new wac_wF((f=new wac_Ta,f.Cid=e.slideCid,f.Sid=e.slideSid,f)))}wac_$_c(this.SGa,a)}catch(g){wac_Y(42821842,822,10,"SorterViewActor: Exception in VisibleSlideRangeChangedHandler: {0}.",g)}},wxf:function(a,
b){try{var c=b.dragStartIndex,d=b.dropIndex,e=this.SGa.tge();!e||d>e.length?wac_Y(50348482,822,10,"SorterViewActor-MoveSlideHandler: slide order is null or dropIndex {0} is larger than slideOrder length {1}.",d,e?e.length:-1):d!==c-1?this.U.os(29279480,2,new wac_oMc(!1,[e[c]],e[d],null),null):wac_Y(50348484,822,50,"SorterViewActor-MoveSlideHandler: no index change: {0}, so no move.",d)}catch(f){wac_Y(50348486,822,10,"SorterViewActor: Exception in MoveSlideHandler: {0}.",f)}},Zzf:function(a,b){try{this.U.os(3581635812,
2,new wac_pMc(b.sectionIndex,b.sectionTitleAfter),null)}catch(c){wac_Y(50647377,822,10,"SorterViewActor: Exception in SectionTitleUpdateHandler: {0}.",c)}},CM:function(a){39!==a.keyCode&&37!==a.keyCode&&40!==a.keyCode&&38!==a.keyCode||a.stopPropagation()},Iwf:function(a,b,c){if(1===c)return(a=this.Ea.Yj)&&wac_DQ(a)&&wac_DQ(a).length?32:8;2===c&&(wac_Y(50857943,822,50,"HandleRenameSection called."),this.fja.editableSectionTitleIndex=this.Ea.T3c);return 32},Uwf:function(a,b,c){if(1===c)return(a=this.Ea.Yj)&&
wac_DQ(a)&&wac_DQ(a).length?32:8;2===c&&this.fja&&(this.fja.selectedSlideIndex=this.Ea.Ja().En,this.fja.selectedSectionIndex=this.Ea.T3c,this.fja.editableSectionTitleIndex=this.Ea.T3c);return 32},Nwf:function(a,b,c,d,e){2===c&&e&&(wac_Y(51233563,822,50,"HandleSelectSectionAndSlides called."),0<=e.MTe&&(this.fja.selectedSectionIndex=e.MTe),0<=e.En&&(this.fja.selectedSlideIndex=e.En));return 32},Ovf:function(a,b,c){2===c&&wac_o0c(this);return 32},O:function(){try{this.Qp||(this.Qp=!0,wac_o0c(this),
this.vgb&&(wac_hg().ub(this.vgb.Oa,this.X3),this.Jf.removeChild(this.vgb.Oa),this.vgb=null))}catch(a){wac_Y(42821850,822,10,"SorterViewActor: Exception in Dispose: {0}.",a)}}};
function wac_m0c(a){a.SGa&&(wac_5_c(a.SGa),wac_8_c(a.SGa,a.CSe));a.Kz&&a.Kz.xua(a.RB);a.fja&&(a.fja.events.onSlideSelectionChanged.unsubscribe(a.aOe),a.fja.events.onVisibleSlideRangeChanged.unsubscribe(a.bOe),a.fja.events.onMoveSlide.unsubscribe(a.Shf),a.fja.events.onSectionTitleUpdate.unsubscribe(a.Fif),a.fja.events.onSectionSelectionChanged.unsubscribe(a.Eif))}
function wac_o0c(a){try{wac_Y(42821844,822,50,"SorterViewActor: CloseSorterView called."),wac_iN(a.ra,"EditingSlideSorterViewFocus",!1),a.vgb&&(a.vgb.Oa.style.display="none"),wac_m0c(a)}catch(b){wac_Y(42821846,822,10,"SorterViewActor: Exception in CloseSorterView: {0}.",b)}}function wac_n0c(a,b){wac_Y(51390413,822,50,"SorterViewActor: SlideSelectionChangeHandler called with targetSlideIndex: {0}",b);0<=b&&a.KHb!==b&&(a.KHb=b,0<=a.KHb&&(b=wac_HI(a.Cc,b),a.ha.yJ(b),a.Ca.Wu(b)))}
function wac_l0c(a){try{if(a.vgb){a.vgb.Oa.style.display="block";a.h3e.style.display="none";if(!a.X0c){a.X0c=new wac_FG;a.X0c.Oa.className="pptonline-sorter-view-add-first-slide-container-class";a.X0c.Oa.title=ResourceStrings.l_ClickToAddSlide;a.X0c.Oa.setAttribute("aria-label",ResourceStrings.l_ClickToAddSlide);a.X0c.Oa.setAttribute("tabindex","0");var b=document.createElement("span");b.innerText=ResourceStrings.l_ClickToAddSlide;a.X0c.Oa.appendChild(b);a.vgb.Oa.appendChild(a.X0c.Oa);wac_tf(a.X0c.Oa,
"click",a.jrf)}a.X0c.Oa.style.display="block"}else wac_Y(51409817,822,10,"ShowAddFirstSlidePane: no sorter view container.")}catch(c){wac_Y(51409819,822,10,"Exception in ShowAddFirstSlidePane: {0}.",c)}}
function wac_p0c(a){a.Gt.E_("EditingSlideSorterViewFocus","main",a.vgb.Oa,function(){a.fja&&a.fja.restoreFocusToGrid()},function(){a.vgb&&wac_GYc(a.vgb,"pptonline-sorter-view-f6focus-class")},!1,null);wac_Yia(a.Dg,"EditingSlideSorterViewFocus",function(){a.vgb&&wac_IG(a.vgb,"pptonline-sorter-view-f6focus-class")})}
function wac_k0c(a,b){try{if(1===a.Lc.zLd&&!b)return wac_Y(50656730,822,50,"ShowSorterView: already in sorter view."),32;a.Lc.zLd=1;wac_Y(42821782,822,15,"ShowSorterView: Open sorter view.");if(!a.vgb){a.vgb=new wac_FG;a.h3e=document.createElement("div");a.vgb.Oa.appendChild(a.h3e);a.vgb.Oa.setAttribute("tabindex","0");a.vgb.Oa.setAttribute("aria-label",ResourceStrings.L_SlideSorter);a.vgb.Oa.id="pptonline-sorter-view-id";a.vgb.Oa.className="pptonline-sorter-view-class";a.h3e.className="pptonline-sorter-view-inner-container-class";
a.Jf.appendChild(a.vgb.Oa);a.vgb.Oa.style.width="100%";a.vgb.Oa.style.display="block";wac_tf(a.vgb.Oa,"keydown",a.Y3);var c=wac_7_c(a.SGa),d=new wac_LF(0,0);if(c.qc&&c.ac){var e=c.ac/c.qc;1<=e?(d.ac=247,d.qc=247/e):(d.qc=247,d.ac=247*e)}else d.ac=247,d.qc=247/1.76;if(!a.fja){var f=new window.PPTGridComponent.SlideGridSettings;f.throttleTimeoutInMs=1E3;f.debounceWaitTimeInMs=200;f.slideWidth=d.ac;f.slideHeight=d.qc;f.isRTL=wac_Ag;f.allowMoveSlide=!0;f.allowSectionEdit=a.HUc.caf;f.enableSelectionBetweenSlides=
!0;f.enableTriggerSelectionFromDoubleClick=!0;f.enableTriggerSelectionFromRightClick=!0;f.enableTriggerSelectionFromActiveSlideChange=!0;f.sectionTitleMaxLength=wac_Lg(wac_.pa,"PptSorterViewSectionTitleMaxLength",100);a.fja=window.SlideGrid.SlideGridFactory.CreateSlideGrid(f,a.h3e)}wac_p0c(a);wac_hg().ya(a.vgb.Oa,a.X3)}var g=window.$$as(wac_KH,a.Ca.Ja());if(!g)return wac_Y(51409805,822,50,"ShowSorterView: active slideNode is null."),wac_l0c(a),32;wac_iN(a.ra,"EditingSlideSorterViewFocus",!0);wac_a0c(a.SGa);
a.Kz.tX(a.RB);a.DRe=!0;var h=a.SGa.tge();wac_Y(50729740,822,15,"ShowSorterView: slideOrder length: {0}.",h?h.length:-1);a.KHb=g.yo();var k=a.KHb;a.Ejd=Date.now();a.fja.events.onSlideSelectionChanged.subscribe(a.aOe);a.fja.events.onVisibleSlideRangeChanged.subscribe(a.bOe);a.fja.events.onMoveSlide.subscribe(a.Shf);a.fja.events.onSectionTitleUpdate.subscribe(a.Fif);a.fja.events.onSectionSelectionChanged.subscribe(a.Eif);a.fja.events.onInsertBetweenSlidesPositionChanged.subscribe(a.isf);var l=wac_jIc(a.HUc,
h,wac_hIc(a.SGa)),m=wac_kIc(a.HUc,l);a.fja.show(k,l,m);var n=a.Ea.Yj;a.fja.shouldDisplaySections=!(!n||!wac_DQ(n)||!wac_DQ(n).length);a.vgb.Oa.style.display="block";a.h3e.style.display="block";a.X0c&&(a.X0c.Oa.style.display="none");a.fja.selectedSlideIndex=a.KHb;a.p2e(null);wac_9_c(a.SGa,a.CSe);return 32}catch(p){return wac_Y(42821790,822,10,"SorterViewActor: Exception in ShowSorterView: {0}.",p),8}}function wac_q0c(a){this.caf=wac_q(wac_.pa,"PptSectionsEnabled");this.SGa=a}
wac_q0c.prototype={caf:!1,SGa:null};
function wac_kIc(a,b){var c=a.SGa.s2e();if(a.caf&&c&&0<c.length){b=[];for(var d=0;d<c.length;d++){a=[];for(var e=c[d].SlideIds,f=e.length,g=0;g<f;++g){var h=e[g],k;a.push((k=new window.PPTGridComponent.SlideID,k.slideCid=h.Cid,k.slideSid=h.Sid,k))}var l;a=(l=new window.PPTGridComponent.SectionData,l.sectionIndex=d,l.slideIdList=a,l.sectionTitle=c[d].Title,l);b.push(a)}wac_Y(50962828,822,50,String.format("SlideGridHelper::CreateSectionListItems, sections count:{0}",b.length));c=b}else{c=[];k=(d=new window.PPTGridComponent.SectionData,
d.sectionTitle="",d.sectionIndex=0,d.slideIdList=[],d);l=b.length;for(d=0;d<l;++d)k.slideIdList.push(b[d].slideID);c.push(k);wac_Y(50962830,822,50,"SlideGridHelper: Created default section")}return c}
function wac_jIc(a,b,c){for(var d=[],e=0;e<b.length;e++){var f=c?c[b[e].Vc().toString()]:null,g=f?f.olf+", "+String.format(ResourceStrings.L_GridView_SlideSelectionNarratorTitle,e+1,b.length):String.format(ResourceStrings.L_GridView_SlideSelectionNarratorTitle,e+1,b.length),h,k,f=(k=new window.PPTGridComponent.SlideData,k.slideID=(h=new window.PPTGridComponent.SlideID,h.slideCid=b[e].fe(),h.slideSid=b[e].Vc(),h),k.slideOrderIndex=e,k.sectionIndex=a.caf?a.SGa.zqd(b[e]):0,k.thumbnailImage=f?f.ePe:"",
k.isHiddenSlide=f?f.ojf:!1,k.slideTitle=g,k);d.push(f)}return d}Type.registerNamespace("PPTGridComponent");var wac_mIc;window.PPTGridComponent.SlideID=wac_mIc=function(){};wac_mIc.prototype={slideCid:0,slideSid:0};var wac_nIc;window.PPTGridComponent.SlideData=wac_nIc=function(){};wac_nIc.prototype={slideID:null,slideOrderIndex:0,sectionIndex:0,thumbnailImage:null,isHiddenSlide:!1,slideTitle:null,slideAriaLabel:null};var wac_oIc;window.PPTGridComponent.SectionData=wac_oIc=function(){};
wac_oIc.prototype={sectionTitle:null,sectionIndex:0,slideIdList:null};window.PPTGridComponent.IEvent=function(){};var wac_pIc;window.PPTGridComponent.ISlideGrid=wac_pIc=function(){};wac_pIc.prototype={selectedSlideIndex:0,slideDataList:null,sectionDataList:null,visibleSlideRange:null,editableSectionTitleIndex:0,shouldDisplaySections:!1,selectedSectionIndex:0,events:null};var wac_qIc;window.PPTGridComponent.ISlideGridEvents=wac_qIc=function(){};
wac_qIc.prototype={onSlideSelectionChanged:null,onVisibleSlideRangeChanged:null,onMoveSlide:null,onSectionTitleUpdate:null,onSectionSelectionChanged:null,onInsertBetweenSlidesPositionChanged:null};var wac_r0c;window.PPTGridComponent.SlideGridSettings=wac_r0c=function(){};
wac_r0c.prototype={throttleTimeoutInMs:0,debounceWaitTimeInMs:0,slideWidth:0,slideHeight:0,isRTL:!1,allowMoveSlide:!1,allowSectionEdit:!1,enableTriggerSelectionFromDoubleClick:!1,enableTriggerSelectionFromRightClick:!1,enableTriggerSelectionFromActiveSlideChange:!1,enableSelectionBetweenSlides:!1,sectionTitleMaxLength:0};Type.registerNamespace("PowerPointWebEditor.SlideGrid");wac_Z.j1e=wac_Z.j1e||{};function wac_rIc(){this.SB=Function.createDelegate(this,this.sC)}
wac_rIc.prototype={J:null,nqf:!1,Ub:function(){return"PowerPointWebEditor.SlideGrid"},gc:function(a){this.J=a},tb:function(){wac_.pa.Ok(this.SB)},sC:function(){try{this.nqf=wac_q(wac_.pa,"PPTSorterViewEnabled");wac_b(41222424,202,50,"SlideGrid:Init - Grid component package");var a=this;wac_Zg(window.Common.App.AppLifecycleManager.get_instance(),7,function(){a.J.H(wac_wEa).uje.MRd("slideGrid").catch(function(a){return wac_b(41222425,811,10,"Failed to load the resources for pptGridComponent: {0}",a)}).then(function(){a.pPe();
return null}).catch(function(a){return wac_b(41222426,811,10,"Failed to initialize pptGridComponent: {0}",a)})},3)}catch(b){wac_b(41222427,811,10,"PPTWebEditorSlideGridPackage: exception in OnFullAppSettingsReady: {0}",b)}},pPe:function(){var a=this.J.H(wac_kG).lC(),b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",this.J.H(wac_R).oTe);a.appendChild(b);var b=wac_.pa.Qb.PPTFabricIconBackArrowCssUrl,c=document.createElement("link");
c.setAttribute("rel","stylesheet");c.setAttribute("type","text/css");c.setAttribute("href",b);a.appendChild(c);var d=this;wac_n(wac_m(this.J.fa(wac_dIc),function(){return new wac_fIc(d.J.H(wac_hK),d.J.H(wac_QK),wac_Kt(d.J.H(wac_lt),7),wac_Kt(d.J.H(wac_lt),68),d.J.H(wac_3H))}));var e=this;wac_n(wac_m(this.J.fa(wac_4_c),function(){return new wac_q0c(e.J.H(wac_dIc))}));var f=this;wac_n(wac_m(this.J.fa(wac_iIc),function(){return new wac_iIc(a,f.J.H(wac_4_c),wac_z(),f.J.H(wac_l7),f.J.H(wac_dIc),f.J.H(wac_x_b))}));
this.J.H(wac_iIc).Tb();if(this.nqf){var g=document.getElementById("WACDocumentPanel"),h=this;wac_n(wac_m(this.J.fa(wac_j0c),function(){return new wac_j0c(g,h.J.H(wac_4_c),wac_z(),h.J.H(wac_dIc),h.J.H(wac_It),h.J.H(wac_FH),h.J.H(wac_Mt),h.J.H(wac_KL),h.J.H(wac_NL),h.J.H(wac_Nt),h.J.H(wac_3H),h.J.H(wac_5c),h.J.H(wac_zG),h.J.H(wac_JL))}));this.J.H(wac_j0c).Tb()}},O:function(){try{var a=wac_k(this.J,wac_dIc),b=wac_k(this.J,wac_iIc);a&&a.O();b&&b.O()}catch(c){wac_b(41443788,811,10,"PPTWebEditorSlideGridPackage: exception in Dispose: {0}",
c)}}};wac_eIc.registerClass("PowerPointWebEditor.ThumbnailDataStoreItem");wac_fIc.registerClass("PowerPointWebEditor.ThumbnailDataStoreManager",null,wac_dIc);wac_iIc.registerClass("PowerPointWebEditor.GridViewActor",null,Sys.IDisposable);wac_j0c.registerClass("PowerPointWebEditor.SorterViewActor",null,Sys.IDisposable);wac_q0c.registerClass("PowerPointWebEditor.SlideGridHelper",null,wac_4_c);window.PPTGridComponent.SlideID.registerClass("PPTGridComponent.SlideID");window.PPTGridComponent.SlideData.registerClass("PPTGridComponent.SlideData");
window.PPTGridComponent.SectionData.registerClass("PPTGridComponent.SectionData");window.PPTGridComponent.IEvent.registerClass("PPTGridComponent.IEvent");window.PPTGridComponent.ISlideGrid.registerClass("PPTGridComponent.ISlideGrid");window.PPTGridComponent.ISlideGridEvents.registerClass("PPTGridComponent.ISlideGridEvents");window.PPTGridComponent.SlideGridSettings.registerClass("PPTGridComponent.SlideGridSettings");
wac_rIc.registerClass("PowerPointWebEditor.SlideGrid.PPTWebEditorSlideGridPackage",null,wac_I,wac_i);wac_J(wac_C(),wac_k4(new wac_rIc,0),0,!1);Type.registerNamespace("PPTe");wac_4D=window.PPTe||{};function wac_A2b(a,b,c,d,e,f){this.drd=Function.createDelegate(this,this.Y1d);this.crd=Function.createDelegate(this,this.gSa);this.Ob=a;this.X0a=b;this.E0a=c;this.nYc=d;this.hb=e;this.Ta=f}
wac_A2b.prototype={Ob:null,X0a:null,hb:null,Ta:null,OXc:null,E0a:null,LX:null,C5b:!1,nYc:null,d1a:null,gSa:function(a,b,c){a=wac_2g;this.Ta.ALd&&(a=a||this.hb.V3d);a||this.C5b||(a=!this.$Ec());1===c?c=a?2:32:this.C5b?wac_.pya&&this.E0a?(wac_B2b(this),c=32):(c=wac_.hSb?this.d1a.Dx("UI_FileEmbed",null,"")?32:8:2,c=32!==c?this.Ob.qv(!0,wac_.VGb,!1):c):c=8;return c},Y1d:function(a){a.Values.HostEmbeddedViewUrl&&(a=a.Values.HostEmbeddedViewUrl.toString(),this.E0a=wac_.pya=a,wac_B2b(this))},$Ec:function(){return!1}};
function wac_B2b(a){(new wac_C2b(a.E0a,a.X0a,a.OXc,a.LX)).gSa()}
function wac_C2b(a,b,c,d){this.b9c=Function.createDelegate(this,this.OCd);wac_C2b.initializeBase(this,[a]);wac_FIb(this,"wdAr",d.toString());if(!wac_e8){a=Array(4);a[0]=new wac_LF(46,29);a[1]=new wac_LF(56,34);a[2]=new wac_LF(66,39);a[3]=new wac_LF(79,46);wac_e8=[];for(var e=b.length,f=0;4>f;f++){var g=wac_eoc(b[e-1-f],d),g=new wac_F2b(g,a[f]);Array.add(wac_e8,g)}}this.hGa=[];e=new wac_LF(476,288);b=c.v2a;a=e.ac;e=e.qc;f=c.iXc;g=c.LX;c=c.v2a?c.v2a[c.v2a.length-1].Format:0;if(!b)throw Error.argumentNull("powerPointFormatInfosLargestToSmallest");
for(var h,k,l=null,m=0;m<b.length;m++)if(l=b[m],g?(wac_hDb(l,g,h={val:h},k={val:k}),h=h.val,k=k.val):(h=l.SlideWidth,k=l.SlideHeight),h<=a&&k<=e||l.Format===c||m===b.length-1){.9>h/a&&.9>k/e&&f&&m&&(l=b[m-1]);break}d=wac_eoc(l,d);this.XZb=Math.max(d.ac,300);this.CPc=Math.max(d.qc,201);this.JUb-=476-this.XZb}function wac_eoc(a,b){var c,d;wac_hDb(a,b,c={val:c},d={val:d});c=c.val;d=d.val;return new wac_LF(c+2,d+23+2)}function wac_foc(a){return"EmbedSizeAnchor_"+a}
wac_C2b.prototype={Tu:null,Lqb:null,hGa:null,gSa:function(){wac_e3.prototype.gSa.call(this);var a=wac_eH();a.className="EmbedSizesContainer";var b=document.createElement("table"),c=document.createElement("tbody");a.appendChild(b);b.appendChild(c);for(b=0;b<wac_e8.length;b++){var d=wac_e8[b],e=document.createElement("tr"),f=document.createElement("td");f.id="EmbedSize_"+b;f.setAttribute("EmbedSizeId",b);f.className="EmbedSizes";Array.add(this.hGa,f.id);var g=wac_eH();g.className="EmbedBox";g.style.width=
wac_HG(d.AEb.ac);g.style.height=wac_HG(d.AEb.qc);var h=wac_eH();h.id="EmbedSizeTitle_"+b;h.className="EmbedTitle";h.innerText=String.format(ResourceStrings.l_EmbedTitle,d.a5.ac.toString(),d.a5.qc.toString());d=wac_0O();d.id=wac_foc(b);d.className="EmbedAnchor";d.setAttribute("href","javascript:;");d.setAttribute("onclick","return false;");d.setAttribute("unselectable","on");d.setAttribute("aria-describedby",h.id);d.appendChild(h);d.appendChild(g);f.appendChild(d);e.appendChild(f);this.Tu||this.b7(f);
c.appendChild(e)}this.tUa.appendChild(a);this.Lqb=this.b9c;for(a=0;a<this.hGa.length;a++)c=document.getElementById(this.hGa[a]),this.Fk.ya("click",c,this.Lqb);this.xlb.appendChild(wac_GIb(this));this.HMa();wac_Kh()&&(a=wac_Ie(),c=[document.getElementById("EmbedCode"),document.getElementById(wac_foc(0)),document.getElementById(wac_foc(1)),document.getElementById(wac_foc(2)),document.getElementById(wac_foc(3)),document.getElementById("ArrowOptions"),document.getElementById("wdEaaCheck"),document.getElementById("WACDialogActionButton")],
c=new wac_Mma(c),(a=a.Hg())?a.Fd=c:wac_Y(8962561,807,10,"PowerPointEmbedDialog::ShowEmbedDialog cannot find current FocusRegion"),wac_Ge()?this.t0(document.getElementById("WACDialogActionButton")):this.JC.select())},x5:function(){wac_0m.prototype.x5.call(this);for(var a=0;a<this.hGa.length;a++){var b=document.getElementById(this.hGa[a]);this.Fk.ub("click",b,this.Lqb)}this.Lqb=null},OCd:function(a){this.b7(a.ns);return!0},b7:function(a){this.Tu&&(Sys.UI.DomElement.removeCssClass(this.Tu,"Selected"),
this.Tu=null);this.Tu=a;var b=wac_Ie().Hg();b&&b.Fd.Ch(a.firstChild);Sys.UI.DomElement.addCssClass(this.Tu,"Selected");a=wac_e8[this.Tu.getAttribute("EmbedSizeId")];this.qnf=a.a5.ac;this.pnf=a.a5.qc;wac_DIb(this)}};function wac_F2b(a,b){this.a5=a;this.AEb=b;this.a5.ac=Math.max(this.a5.ac,300);this.a5.qc=Math.max(this.a5.qc,201)}wac_F2b.prototype={a5:null,AEb:null};
function wac_D2b(a,b,c){this.v2a=a;this.PXc={};for(var d=0;d<a.length;d++)this.PXc[a[d].Format.toString()]=d;this.iXc=b;c&&!window.isNaN(c)&&window.isFinite(c)?this.LX=c:this.LX=0}wac_D2b.prototype={v2a:null,iXc:!1,LX:null,PXc:null};Type.registerNamespace("PowerPointWebEditor");wac_Z=window.PowerPointWebEditor||{};function wac_J2b(){}wac_J2b.registerInterface("PowerPointWebEditor.IAddinCommandsInitService");function wac_V2b(){}wac_V2b.registerInterface("PowerPointWebEditor.IPptInsertMediaDialogFactory");
function wac_12b(){}wac_12b.registerInterface("PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory");function wac_sIc(){this.idc=Function.createDelegate(this,this.Eyc);this.kqe=[new wac_37b,new wac_Jwc];this.Usb=[]}
function wac_tIc(){var a=new XMLHttpRequest;a.open("GET",wac_.pa.Qb.OneDriveApiV72Url);a.send(null);a.onreadystatechange=function(){if(4===a.readyState){var b=a.responseText;try{window.eval(b)}catch(c){wac_Y(40145442,809,10,"Load OneDrive.js throw exception: {0}, stack: {1}",c.message,c.stack)}}}}function wac_uIc(a){var b=wac_j().H(wac_bM);a?b.kxa():b.Mab()&&b.kxa();wac_J(wac_C(),new wac_P7b,0,!1)}
wac_sIc.prototype={Usb:null,kqe:null,J:null,Q8d:null,ZV:null,nu:null,Ub:function(){return"PowerPointWebEditor.Chronos2"},gc:function(a){this.J=a;this.Q8d=this.J.H(wac_hF);this.ZV=this.Q8d.d5c(5,this.Ub());this.nu=this.J.H(wac_Ipc);for(var b=0;b<this.kqe.length;++b)Array.add(this.Usb,wac_k4(this.kqe[b],5));for(var b=this.Usb,c=b.length,d=0;d<c;++d)b[d].gc(a);this.J.H(wac_3L);var e=wac_q(wac_.pa,"InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled"),f=wac_rP(wac_oc.$$(wac_sc),wac_l(this.J,wac_oc.$$(wac_sc))),
g=this;wac_n(wac_m(wac_o(this.J.fa(wac_p8b),wac_bM),function(){return new wac_p8b(g.J.H(wac_3L),g.J.H(wac_1L),g.J.H(wac_nt),g.J.H(wac_4L),g.J.H(wac_Ipc))}));var h=this;wac_m(wac_n(wac_o(this.J.fa(wac_37),wac_kIa)),function(){return new wac_37(h.J.H(wac_iK),h.J.H(wac_Em),h.J.H(wac_R),h.J.H(wac_Mt))});this.J.H(wac_R).lKa&&wac_Li().WVa&&wac_$ka(wac_Li(),this.idc);wac_m(wac_n(wac_o(this.J.fa(wac_k5),wac_hRb)),function(){return new wac_k5(a.H(wac_zQ),new (wac_f.$$(wac_oc.$$(wac_sc)))(function(){return wac_Qb(f)}),
a.H(wac_54))});wac_m(wac_n(this.J.fa(wac_i5)),function(){return new wac_i5(wac_z())});wac_m(wac_n(wac_o(this.J.fa(wac_h5),wac_gRb)),function(){return new wac_h5});var k=this;wac_m(wac_n(this.J.fa(wac_F8)),function(){return new wac_F8(k.J.H(wac_Oc),k.J.H(wac_h5),k.J.H(wac_R))});var l=this;wac_m(wac_n(this.J.fa(wac_hoc)),function(){return new wac_hoc(l.J.H(wac_Oc),l.J.H(wac_h5),l.J.H(wac_R))});var m=this;wac_m(wac_n(wac_o(this.J.fa(wac_f5),wac_74)),function(){return new wac_f5(new wac_e5(new (wac_f.$$(wac_2a))(function(){var a;
wac_Q1()?(a=m.J.H(wac_84).pH,a=new wac_c5(a.contentWindow,"*")):a=wac_.KIb;return a}),e?wac_Jh(window.document.URL,0):wac_Jh(wac_.cRa,0),wac_.pa.Qb.ImageFetcherSupportedExtensions))});wac_n(wac_o(this.J.fa(wac_mRb),wac_54));wac_m(wac_n(wac_o(this.J.fa(wac_g5),wac_84)),function(){return new wac_g5});wac_n(wac_o(this.J.fa(wac_i3b),wac_V2b));wac_m(wac_n(this.J.fa(wac_12b)),function(){return new wac_D3b})},tb:function(){var a=this.ZV.saa("resolvechronos2"),b=this.J.H(wac_),c=this.J.H(wac_3L),d=c.Ta,e=
b.Ob,f=this.J.H(wac_12b),g=this.J.H(wac_Oc),b=this.J.H(wac_bM),h=this.J.H(wac_i8),k=this.J.H(wac_zG),l=e.Zc,m=this.J.H(wac_dI),n=this.J.H(wac_Lt),p=this.J.H(wac_JH),q=this.J.H(wac_GH),r=wac_0b(this.J,wac_iM),t=this.J.H(wac_It),v=this.J.H(wac_nt),u=this.J.H(wac_Jt),w=this.J.H(wac_i7),x=this.J.H(wac_Mt),z=e.ed,y=this.J.H(wac_bY),A=this.J.H(wac_zH),B=this.J.H(wac_w_),C=this.J.H(wac_AX),F=this.J.H(wac_IH),D=this.J.H(wac_KL);this.ZV.zaa(a);a=this.ZV.saa("regactorschronos2");h=[new wac_O3b(d.YL,g,b,wac_l(this.J,
wac_2L)),new wac_Q3b(d.ABb,d.YL,h,g,l,m,r,b,wac_l(this.J,wac_9L),n,v,u,w,this.J.H(wac_R),this.J.H(wac_xmb)),new wac_A4b(d,g,u,t,k,this.J.H(wac_FH),m,this.J.H(wac_V2b),this.J.H(wac_74),this.J.H(wac_54),this.J.H(wac_h5),this.J.H(wac_F8),this.J.H(wac_hoc),x,n,p,q,F,D,C,w,this.J.H(wac_g5),this.J.H(wac_hRb),this.J.H(wac_i5),this.J.H(wac_Elc),this.J.H(wac_j8),this.J.H(wac_CT),this.J.H(wac_NL),this.J.H(wac_Yc))];l=h.length;for(m=0;m<l;++m)n=h[m],n.Tb(),n.Lf();b.lxb=!0;this.ZV.zaa(a);var G=this;wac_.pa.Ok(function(){a=
G.ZV.saa("regfullactorschronos2");for(var b=[new wac_s4b(g,u,k,t,G.J.H(wac_1L).Ve(),y,c.$f.Cn.w2c,A,G.J.H(wac_t4b),G.J.H(wac_u4b),G.J.H(wac_lr),B,f,G.J.H(wac_H8),wac_Tfa,G.J.H(wac_jM),G.J.H(wac_VF),G.J.H(wac_R),G.J.H(wac_Uc),G.J.H(wac_Mt),function(){return wac_2g},c.YZa(),function(a){return wac_TNc(wac_r().Hd(),a)}),new wac_v4b(e,d.dlc,z.zyb,g,x,c.YZa(),G.J.H(wac_VF),G.J.H(wac_R))],h=b.length,l=0;l<h;++l){var m=b[l];m.Tb();m.Lf()}G.ZV.zaa(a)});wac_Y(40145439,809,50,"Chronos2Package::Init");b=this.Usb;
h=b.length;for(l=0;l<h;++l)m=b[l],this.ZV.saa(m.Ub()),m.tb(),this.ZV.zaa(m.Ub());var H=this;wac_.pa.Ok(function(){if(d.zy){a=H.ZV.saa("idea");wac_Y(40145474,809,50,"Start to download infrared.hermes.js file");var b=[];b.push(wac_vqc(H.nu,wac_cf("ir-plugin-ski.min.js",5),null,!1));b=wac_vqc(H.nu,wac_cf("infrared.hermes"+wac_aO(H.J.H(wac_4L)),1),b,!1);wac_ul(b);wac_Y(40145476,809,50,"Start to download ideas.hermes.js file");b=wac_vqc(H.nu,wac_cf("microsoft.ideas.runtime.js",5),[b],!1);b=wac_vqc(H.nu,
wac_cf("ideas.hermes"+wac_aO(H.J.H(wac_4L)),1),[b],!1);wac_ul(b);H.ZV.zaa(a)}d.lBe&&(a=H.ZV.saa("smartLookup"),wac_Y(41236128,809,50,"Start to download smartlookup.hermes.js file"),b=[],b.push(wac_vqc(H.nu,wac_cf("microsoft.office.smartlookup.host.runtime.js",5),null,!1)),b=wac_vqc(H.nu,wac_cf("smartlookup.hermes"+wac_aO(H.J.H(wac_4L)),1),b,!1),wac_ul(b),H.ZV.zaa(a));if(wac_Rqc()){a=H.ZV.saa("versionhistory");b=wac_vqc(H.nu,wac_jt()+"pptVersionHistory.js",null,!1);try{wac_ul(b)}catch(c){wac_Y(40145478,
809,10,"ChronosPackage::InitializeVersionHistory - Failed to download VersionHistory script, Exception: {0}",c.toString())}H.ZV.zaa(a)}});wac_Yg||d.lKa&&wac_Si(wac_Li())||(a=this.ZV.saa("appforoffice"),this.Eyc(),this.ZV.zaa(a));d.crc&&wac_Fh()&&wac_q(wac_.pa,"SaveToAnotherFolderBrsIsEnabled")&&wac_tIc();a=this.ZV.saa("policy");wac_q$b(this);this.ZV.zaa(a);d.Bmc&&(a=this.ZV.saa("capture"),wac_l$b(this),this.ZV.zaa(a))},O:function(){for(var a=this.Usb,b=a.length,c=0;c<b;++c)a[c].O();this.J.H(wac_R).lKa&&
wac_Li().WVa&&wac_Li().Ra.sb("ConsentReceived",this.idc)},Eyc:function(){var a=this.J.H(wac_R);a.Pi()?wac_.pa.Ok(function(){wac_uIc(a.qbf)}):wac_uIc(a.qbf)}};function wac_q$b(a){wac_Y(40145472,809,50,"Start to download policy.hermes.js file");a=wac_vqc(a.nu,wac_cf("policy.hermes"+wac_aO(a.J.H(wac_4L)),1),null,!1);wac_ul(a)}
function wac_l$b(a){var b=wac_cf("dom-to-image",2),b=wac_vqc(a.nu,b,null,!1),c=wac_cf("Capture.Hermes"+wac_aO(a.J.H(wac_4L)),1);a=wac_vqc(a.nu,c,[b],!1);try{wac_ul(a)}catch(d){wac_Y(40186115,809,10,"ChronosPackage::InitializeCapture - Failed to download capture script, Exception: {0}",d.toString())}}function wac_O3b(a,b,c,d){this.wnd=Function.createDelegate(this,this.LXd);this.jba=Function.createDelegate(this,this.a4d);this.U=b;this.nY=a;this.yF=c;this.L3b=d}
wac_O3b.prototype={U:null,nY:!1,yF:null,L3b:null,Tb:function(){this.U.Mp(407117407,1,this.jba,4);this.U.Mp(1402209562,1,this.jba,4);this.U.Mp(543799107,1,this.jba,4);this.U.Mp(1309495434,1,this.wnd,96);this.U.ja(516359383,1,this.jba);this.U.Mp(1782110672,1,this.jba,64);this.U.ja(2517401660,1,this.jba);this.U.Mp(1592314317,1,this.jba,64);this.U.ja(2269104277,1,this.jba)},Lf:function(){},a4d:function(a,b,c,d,e){if(!this.nY)return 16;if(1===c)return wac_q(wac_.pa,"PPTOProtectDocumentDownloadIsBlocked")&&
wac_hf?8:32;if(wac_I8(this))switch(a){case 407117407:wac_I8(this).ana(e);break;case 1402209562:wac_I8(this).lIb(e);break;case 1309495434:wac_I8(this).dCc(e);break;case 516359383:wac_I8(this).T1d(e);break;case 1782110672:wac_I8(this).LCc(e);break;case 543799107:wac_I8(this).zZd();break;case 2517401660:wac_I8(this).s2d(e);break;case 1592314317:wac_I8(this).hJd(e);break;case 2269104277:wac_I8(this).S1d(e)}else this.yF.kxa(),this.yF.cia.ga(new wac_J8(a,e));return 32},LXd:function(a,b,c,d,e){if(!this.nY)return 16;
wac_I8(this)&&wac_I8(this).dCc(e);return 32}};function wac_I8(a){return a.L3b?a.L3b.Ga():null}
function wac_Q3b(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r){this.ibd=Function.createDelegate(this,this.RGd);this.Mrf=Function.createDelegate(this,this.ywf);this.Wrf=Function.createDelegate(this,this.Jwf);this.Irf=Function.createDelegate(this,this.qwf);this.asf=Function.createDelegate(this,this.Rwf);this.Ead=Function.createDelegate(this,this.jGd);this.Acd=Function.createDelegate(this,this.GId);this.Ind=Function.createDelegate(this,this.ZXd);this.ocd=Function.createDelegate(this,this.nId);this.fbd=Function.createDelegate(this,
this.NGd);this.jbd=Function.createDelegate(this,this.SGd);this.zi=c;this.U=d;this.Ca=e;this.aaa=g;this.nY=a;this.ZYc=b;this.nb=f;this.yF=h;this.Ad=k;this.za=l;this.Yb=m;this.zd=n;this.Nj=p;this.ua=q;this.Fqf=r}
wac_Q3b.prototype={zi:null,U:null,Ca:null,nb:null,aaa:null,yF:null,za:null,Ad:null,Yb:null,zd:null,Nj:null,Fqf:null,ua:null,Q$e:0,npf:!1,nY:!1,ZYc:!1,Tb:function(){wac_s0c(this);this.U.Mp(2741813164,1,this.jbd,4);this.U.ja(1592244241,1,this.fbd);this.U.Mp(2620643039,1,this.ocd,4);this.U.Mp(860152194,1,this.Ind,96);this.U.ja(2123786558,1,this.Acd);this.U.ja(2755471162,1,this.Ead);this.U.ja(2451283737,1,this.asf);this.U.ja(1530887760,1,this.Irf);this.U.ja(1323818969,1,this.Wrf);this.ua.x3e&&this.U.Mp(489273872,
1,this.Mrf,4)},Lf:function(){},tf:function(){return this.Ad.Ga()},Rwf:function(a,b,c,d,e){if(2!==c)return 32;var f=e.extId;e=e.OptionalProps;var g={};g.mRb=e.dGe.TaskPaneTitle;g.jca=wac_BGb(f);g.Goe=e.dGe.OnRenderedCallback;g.RMd=e.h8e;g.twe=!0;return this.GId(a,b,c,d,g)},qwf:function(a,b,c,d,e){if(2!==c)return 32;a=e.extId;e=e.OptionalProps;b={};b.mRb=e.dGe.TaskPaneTitle;b.jca=wac_BGb(a);b.Rfb=e.dGe.SourceLocationOverrideResourceId;b.Goe=e.dGe.OnRenderedCallback;b.RMd=e.h8e;b.twe=!0;e=this.tf().tHb(b);
return(e=this.tf().jma(e))&&this.tf().Czd(e.Xm)?32:8},Jwf:function(a,b,c,d,e){if(2!==c)return 32;a=e.extId;b=e.OptionalProps;e={};e.mRb=b.dGe.TaskPaneTitle;e.jca=wac_BGb(a);e.Rfb=b.dGe.SourceLocationOverrideResourceId;e.Goe=b.dGe.OnRenderedCallback;e.RMd=b.h8e;e.twe=!0;a=this.tf().tHb(e);return(a=this.tf().jma(a))?(this.tf().V0e(a.Xm,e),32):8},RGd:function(a,b,c,d,e){b=this.Ca.Ja();d=this.Ca.Ve();if(!(this.nY&&b&&d)||this.zd.Ac(b))return 16;if(1===c)return wac_q(wac_.pa,"PPTOProtectDocumentDownloadIsBlocked")&&
wac_hf?8:32;this.tf()?this.tf().fLd():(this.yF.kxa(),this.yF.cia.ga(new wac_J8(a,e)));return 32},SGd:function(a,b,c,d,e){if(!this.nY)return 16;if(!e)return 8;if(e.targetType===window.OSF.OsfControlTarget.InContent)return wac_t0c(this,e,a,null);if(e.targetType===window.OSF.OsfControlTarget.TaskPane){if(this.zd.Ac(this.Ca.Ve()))return 16;if(this.ZYc)if(e.isAddinCommands)e.addinCommandsActionType?1===e.addinCommandsActionType&&wac_Y4b(this,e):this.zSa(e);else{a={};a.marketplaceId=e.id;a.marketplaceVersion=
e.appVersion;a.storeType=e.currentStoreType;a.storeId=e.storeId;a.targetData=e;var f=this;this.tf().DH().isAddinCommandsAsync(a,function(a,b,c){b?f.zSa(c.targetData):wac_Y4b(f,c.targetData);a||wac_b(17687323,220,10,"Checking AddinCommands fails for {0} from {1}",c.targetData.id,c.targetData.currentStoreType)})}else wac_Y4b(this,e);wac_dDb[wac_fDb(e.id,e.targetType,e.storeId,e.currentStoreType,e.appVersion)]=!0;return 32}return 8},ywf:function(a,b,c,d,e){this.nY?e?(b={appVersion:"1.0.0.0",assetId:"WA200000523",
assetStoreId:"omex",currentStoreType:"omex",id:"WA200000523",storeId:"en-US"},b.targetType=window.OSF.OsfControlTarget.InContent,b.height=600,b.width=800,a=wac_t0c(this,b,a,e.fluidUrl)):a=8:a=16;return a},NGd:function(a,b,c,d,e){if(!this.nY)return 16;if(!e)return 8;if(1===c)return 32;c=window.$$as(String,e);if(!c||!c.length)return 8;if((a=this.tf().Hwc(c))&&a.Pk){if(a.Zj&&(a.Zj.wF()===window.OSF.StoreType.FirstParty||a.Zj.wF()===window.OSF.StoreType.Sdx))return this.tf().pGb(c),this.tf().oZd(c),32;
if(this.tf().nKd(c)||a.Pk.iD())this.tf().pGb(c);else if(a=this.tf().jab(),b=wac_X(a),c=this.tf().Iwc(c)){b.Zh(window.$$as(wac_Bu,c));c=wac_kO(this.nb,4,null,null,!0);try{c.lb(a),wac_nu(b)}finally{c&&c.dispose()}}}return 32},nId:function(a,b,c,d,e){if(!this.nY)return 16;if(!e)return 8;if(1===c)return 32;b=window.$$as(String,e);if(!b||!b.length)return 8;this.tf()?this.tf().zCc(b):this.yF.cia.ga(new wac_J8(a,e));return 32},GId:function(a,b,c,d,e){if(!this.nY)return 16;if(!e)return 8;if(1===c)return 32;
if(this.tf()){if(!e||!e.jca)return 8;!this.npf&&this.Q$e&&(this.npf=!0,a=window.performance.now()-this.Q$e,wac_b(41760289,220,50,"Apps for office load time {0}",a));a=this.tf().tHb(e);if(a=this.tf().jma(a))return this.tf().V0e(a.Xm,e),32;this.tf().i_d(e)}else this.Q$e||(this.Q$e=window.performance.now()),this.yF.kxa(),this.yF.cia.ga(new wac_J8(a,e));return 32},jGd:function(a,b,c,d,e){return this.nY?e?1===c?32:this.tf()&&e&&e.length?this.tf().Czd(e)?32:8:8:8:16},ZXd:function(a,b,c,d,e){if(2===c){a=
e.callback;if(!a)return 16;b=new wac_Xca;b.callbackFunc=a;b.storeType=window.OSF.StoreTypeEnum.MarketPlace;b.fromInsertDialog=!1;b.refresh="true"===wac_g3().COa("refreshRequired");this.tf().DH().queryEntitlementDetails(b)}return 32},zSa:function(a){var b=new (wac_g.$$(Object));b.ga(a);a={};a.ack2=b;a.ack0=3;this.U.os(407117407,2,a,null)}};
function wac_Y4b(a,b){if(!a.tf().jma(b.id)){var c=a.tf().kma(b.id),d=a.tf().jab();if(c){d=new wac_f_(c);if(!d.lO()){e=wac_kO(a.nb,4,null,null,!0);try{e.lb(c),wac_v(c,wac_Iqa,!0),wac_v(c,wac_Gqa,b.currentStoreType)}finally{e&&e.dispose()}}a.tf().zCc(d.ia())}else{c=a.aaa.ma();e=a.tf();c=window.$$as(wac_Bu,c.ak(1074135137));wac_$Cb(c,b,e);var e=wac_kO(a.nb,4,null,null,!0);try{e.lb(d),a=c,wac_U(d).Td(a,19)}finally{e&&e.dispose()}}}}
function wac_t0c(a,b,c,d){var e=a.Ca.Ja();if(!e||a.zd.Ac(e))return 16;if(!wac_k7(a.Nj,e,1))return wac_j7(a.Nj,e),16;try{var f=wac_GI(e),g=wac_70(e),h=a.aaa.ma(),k=f.fe(),l=f.Vc(),m=b.width,n=b.height,p=wac_8Cb(h,k,l,g+1,!1);wac_9Cb(p,null,0,0,m,n);wac_7Cb(p,m,n);wac_$Cb(p,b,a.tf());wac_P8(a.zi,[window.$$as(wac_HH,p)],e,c,null,null);wac_dDb[wac_fDb(b.id,b.targetType,b.storeId,b.currentStoreType,b.appVersion)]=!0;d&&(wac_e_c[wac_f_c(p.B8a)]=d);return 32}catch(q){return 8}}
function wac_s0c(a){a.U.Mp(2300394269,1,a.ibd,516);a.ua.n5e&&a.U.Nrd("ConnectedServices",!0,2300394269,1,a.ibd,function(b){wac_NNc(window.Box4.App.zb(),b,a.Fqf.qLd)})}function wac_u9(a,b){wac_u9.initializeBase(this,[a.$f.Ob.Bz()]);this.aj=a;this.Fe=b;wac_uDb="WAC_Powerpoint"}
wac_u9.prototype={aj:null,Fe:null,yHb:function(){var a=new (wac_nb.$$(wac_d.Xwa,wac_d.yla));wac_q(this.Fe,wac_2(51))&&a.vf(0,2);wac_q(this.Fe,wac_2(187))&&a.vf(1,1);this.aj.Ta.YL&&a.vf(8,1);wac_q(this.Fe,wac_2(305))&&a.vf(10,5);return a}};function wac_P7b(){}
wac_P7b.prototype={J:null,Ub:function(){return"PowerPointWebEditor.AddinCommands"},gc:function(a){this.J=a;var b=this;wac_n(wac_m(wac_o(wac_j().fa(wac_u9),wac_J2b),function(){return new wac_u9(b.J.H(wac_3L),b.J.H(wac_Uc))}))},tb:function(){if(this.J.H(wac_R).lzb){var a=wac_j().H(wac_J2b),b=a.yHb();if(b)for(b=b.$$ge();b.$$mn();){var c=b.$$cu(),d;d=a;var e=null;switch(c.ma()){case 1:e=new wac_jIb(d.Cwb,d.Pja);break;case 2:e=new wac_iIb(d.Cwb,wac_nm(wac_.vh)._name,d.Pja);break;case 5:e=new wac_hIb(d.Cwb,
d.Pja)}(d=e)&&d.MCc(c.rh())}}},O:function(){}};function wac_p8b(a,b,c,d,e){this.uIa=[];this.o3b=!1;this.Kpb=null;this.cia=new (wac_g.$$(wac_J8));this.aj=a;this.jtb=b;this.lxb=!1;this.Yb=c;this.$f=d;this.nu=e}
wac_p8b.prototype={uIa:null,o3b:!1,Kpb:null,cia:null,aj:null,jtb:null,Yb:null,$f:null,nu:null,Iwd:function(a){this.uIa.push(a)},kxa:function(){if(!this.o3b){if(!this.Kpb){var a=[wac_vqc(this.nu,wac_cf("officeExtensionMerge.js",5),null,!1)];this.Kpb=wac_vqc(this.nu,wac_cf("appforoffice.hermes"+wac_aO(this.$f),1),a,!1)}wac_ul(this.Kpb);this.o3b=!0}},Mab:function(){var a=!!this.uIa&&0<this.uIa.length,b=!1;if(this.jtb.Ve()&&!a){var c=wac_X(this.jtb.Ve()).mb(18);c&&0<wac_7v(wac_X(c),19)&&(b=!0)}return a||
b},lxb:!1};function wac_J8(a,b){this.Ii=a;this.HD=b}wac_J8.prototype={Ii:0,HD:null};
function wac_A4b(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,v,u,w,x,z,y,A,B,C,F,D,G,H){this.y5a=Function.createDelegate(this,this.FQb);this.qrd=Function.createDelegate(this,this.k2d);this.Nwb=Function.createDelegate(this,this.EQb);this.Gif=Function.createDelegate(this,this.jAf);this.ord=Function.createDelegate(this,this.DQb);this.Xwb=Function.createDelegate(this,this.XRb);this.ftd=Function.createDelegate(this,this.d5d);this.dtd=Function.createDelegate(this,this.yFc);this.Nre=Function.createDelegate(this,this.Rte);
this.Yse=Function.createDelegate(this,this.bwe);this.sse=Function.createDelegate(this,this.Sue);this.Zse=Function.createDelegate(this,this.dwe);this.ua=a;this.U=b;this.Ib=c;this.ha=d;this.ra=e;this.Ca=f;this.nb=g;this.T6b=h;this.VYc=k;this.S6b=l;this.urb=m;this.vrb=n;this.dqe=p;this.Pb=q;this.za=r;this.Wm=t;this.Bo=v;this.jd=u;this.Lc=w;this.MB=x;this.Nj=z;this.xHa=y;this.eta=F;this.Q5d=D;this.Qg=G;this.xHa&&(this.xHa.pH.removeAttribute("style"),this.xHa.pH.style.display="none");this.Msb=A;this.WYc=
B;this.gBa=C;this.SXe=H}function wac_Vwc(){return wac_02a(CommonUIStrings.l_AttributionText.split(/[{}]+/),function(a){return!!a})}function wac_Wwc(a){var b=document.createElement("span");b.innerText=a;return b}function wac_Xwc(a,b){var c=document.createElement("A");c.setAttribute("href",b);c.setAttribute("target","_blank");c.setAttribute("rel","noreferrer");b=document.createElement("span");b.innerText=a;c.appendChild(b);return c}
function wac_Ywc(a){var b=wac_Vwc(),c=document.createElement("body"),d="",e="",f=CommonUIStrings.l_CCYYSA;wac_h(a)||(wac_h(a.PageUrl)||(d=a.PageUrl),!wac_h(a.LicenseDisplayName)&&0<a.LicenseDisplayName.length&&(f=a.LicenseDisplayName),wac_h(a.LicenseUrl)||(e=a.LicenseUrl));a=b.length;for(var g=0;g<a;++g){var h=b[g];switch(h){case "L_ThePhoto":h=wac_Xwc(CommonUIStrings.l_ThePhoto,d);break;case "L_CCYYSA":h=wac_Xwc(f,e);break;case "L_PhotoAuthor":h=wac_Wwc(CommonUIStrings.l_PhotoAuthor);break;default:h=
wac_Wwc(h)}h&&c.appendChild(h)}b=document.createElement("html");b.appendChild(c);return b}
wac_A4b.prototype={ua:null,Ib:null,U:null,ha:null,ra:null,VYc:null,urb:null,vrb:null,dqe:null,Ca:null,nb:null,T6b:null,S6b:null,Pb:null,za:null,Wm:null,Bo:null,jd:null,Lc:null,MB:null,Nj:null,eta:null,Q5d:null,Qg:null,xHa:null,Msb:null,WYc:null,gBa:null,SXe:null,w_a:!1,Tb:function(){wac_u0c(this);this.U.Mp(3143141002,1,this.Zse,4);this.U.Mp(934858027,1,this.sse,4);this.U.Mp(1332899609,1,this.Yse,4);this.U.Mp(1488343741,1,this.Nre,4);this.U.Mp(2168883939,1,this.dtd,4);this.U.Mp(239978317,1,this.dtd,
4);wac_v0c(this);this.U.Mp(2168458114,1,this.ftd,4);this.U.Mp(3612507612,1,this.Xwb,96)},kOb:function(){wac_33a()&&wac_Q1()&&(wac_r().Nc().appendChild(this.xHa.pH),wac_tf(this.xHa.pH.contentWindow,"message",this.y5a),this.w_a=!0)},FQb:function(a){if(a.rawEvent&&(a=a.rawEvent.data))try{wac_Y(33944475,352,50,"User select images.");var b=Sys.Serialization.JavaScriptSerializer.deserialize(a,!0),c=b.MessageId?b.MessageId.toString():null;b&&c&&("UI_InsertImage"===c||"UI_InsertFileLink"===c)&&this.Msb.Wd("UI_InsertImage"===
c?this.vrb:this.WYc)}catch(d){wac_Y(33944477,352,10,"malformatted postmessage here.")}},Lf:function(){},XRb:function(a,b,c,d,e){if(1===c)return 32;this.ua.x8e||(e[wac_WS.LabelText]=CommonUIStrings.l_OnlinePictureFromOneDrive);return 32},DQb:function(a,b,c){var d;a=this.Ca.Ja();var e,f;if((f=wac_38(this,a,this.ua.Lba,e={val:d}),d=e.val,!f)||1===c)return d;wac_Y(8955410,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog.");try{var g=wac_5k(),h=wac_Nf(this.ua.xvd).toString(),k=String.format(this.ua.Vlc,
wac_.vh,wac_nm(wac_.vh)._name,wac_.jv,g.toString(),3,h);0<this.ua.Vlc.search(/insertmedia.bing.office.net/gi)&&(k=String.format(this.ua.jqc?this.ua.Ulc:this.ua.Vlc,wac_sRb()));var l;l=this.T6b.IG(k,this.S6b,this.urb);l.rEe(this.ua.Fjc);l.o9d(g);this.vrb.Mxe(2168883939);l.hSa(CommonUIStrings.L_PictureInsertTitle,this.vrb);wac_Y(8955412,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog success.");return 32}catch(m){return wac_Y(8955414,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",
m.toString()),8}},dwe:function(a,b,c){if(!this.ua.uvd||!this.ua.uvd.length)return 16;var d;a=this.Ca.Ja();var e,f;if((f=wac_38(this,a,this.ua.vvd,e={val:d}),d=e.val,!f)||1===c)return d;wac_Y(37822670,352,50,"InsertMediaActor::ShowInsertIconDialog : Show dialog.");try{var g=wac_5k(),h=String.format(this.ua.uvd,wac_.vh,wac_nm(wac_.vh)._name,1),k=this.T6b.IG(h,this.S6b,this.urb);k.rEe(this.ua.Fjc);k.o9d(g);this.vrb.Mxe(934858027);k.hSa(CommonUIStrings.l_InsertIconTitle,this.vrb);wac_Y(37822672,352,50,
"InsertMediaActor::ShowInsertIconDialog : Show dialog success.");return 32}catch(l){return wac_Y(37822674,352,10,"InsertMediaActor::ShowInsertIconDialog : Exception = [{0}]",l.toString()),8}},jAf:function(a,b,c){var d;a=this.Ca.Ja();var e,f;if((f=wac_38(this,a,this.ua.n8e,e={val:d}),d=e.val,!f)||1===c)return d;wac_Y(50869124,352,50,"InsertMediaActor::ShowInsertPictureDialogFromM365 : Show dialog.");try{var g=wac_5k(),h=wac_Nf(this.ua.xvd).toString(),k=String.format(this.ua.ijf,wac_.vh,wac_nm(wac_.vh)._name,
wac_.jv,g.toString(),3,h,1,1),l;l=this.T6b.IG(k,this.S6b,this.urb);l.rEe(this.ua.Fjc);l.o9d(g);this.vrb.Mxe(2168883939);l.hSa(CommonUIStrings.L_PictureInsertTitle,this.vrb);wac_Y(50869126,352,50,"InsertMediaActor::ShowInsertPictureDialogFromM365 : Show dialog success.");return 32}catch(m){return wac_Y(50869128,352,10,"InsertMediaActor::ShowInsertPictureDialogFromM365 : Exception = [{0}]",m.toString()),8}},bwe:function(a,b,c){if(!this.ua.uvd||!this.ua.uvd.length)return 16;var d;a=this.Ca.Ja();var e,
f;if((f=wac_38(this,a,this.ua.LBc,e={val:d}),d=e.val,!f)||1===c)return d;wac_Y(38670721,352,50,"InsertMediaActor::ShowChangeIconDialog : Show dialog.");try{var g=String.format(this.ua.uvd,wac_.vh,wac_nm(wac_.vh)._name,0),h=this.T6b.IG(g,this.S6b,this.urb);this.vrb.Mxe(1488343741);h.hSa(CommonUIStrings.l_InsertIconTitle,this.dqe);wac_Y(38670723,352,50,"InsertMediaActor::ShowChangeIconDialog : Show dialog successfully.");return 32}catch(k){return wac_Y(38670725,352,10,"InsertMediaActor::ShowChangeIconDialog : Exception = [{0}]",
k.toString()),8}},EQb:function(a,b,c){var d;a=this.Ca.Ja();var e,f;if((f=wac_38(this,a,wac_33a()&&(wac_K5b?!!this.Msb.mFa()&&9<this.Msb.mFa().length:!0),e={val:d}),d=e.val,!f)||1===c)return d;wac_Y(17838496,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog.");try{wac_K5b=!0;this.w_a||this.kOb();var g=this.VYc.IG();this.vrb.Mxe(239978317);g.hSa(CommonUIStrings.L_PictureInsertTitle,this.vrb);wac_Y(17838498,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog success.");
return 32}catch(h){return wac_Y(17838528,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",h.toString()),8}},yFc:function(a,b,c,d,e){var f;b=this.Ca.Ja();var g,h;if((h=wac_38(this,b,this.ua.Lba,g={val:f}),f=g.val,!h)||1===c)return f;if(!wac_k7(this.Nj,b,1))return wac_j7(this.Nj,b),16;try{var k=wac_60(b,wac_5M(this.ha));if(k&&this.Ib.Ac(k))return 16;var l=this.uab(this.Lc,b,k),m=null,n=this,p=this,q=wac_kO(this.nb,15,function(){wac_zM(n.ha);wac_GL(n.ha);n.ra.ld()},function(){wac_cU(p.ha,
l,!0,!0);m&&wac_cU(p.ha,m,!1,!0)},!1);try{q.lb(b);q.jr(1685987254);q.Dea.ElementSource="Online";c=null;f={actionId:a};if(2168883939===a&&this.ua.ste)if(e.LicenseUrl&&e.LicenseDisplayName){var r=wac_Ywc(e);c=wac_qka(r);if(this.ua.eGe)var t=wac_GI(b),m=wac_e1(this.Bo,!0,t.fe(),t.Vc(),0,0,110,75,wac_70(b)+1,!1)}else f["result.LicenseDisplayName"]=e.LicenseDisplayName,f["result.LicenseUrl"]=wac_Nf(e.LicenseUrl);else f.IsEnabled=this.ua.ste,f.IsFromBing=2168883939===a;wac_Y(39409185,352,50,"InsertMediaActor::UploadOnlinePicture: {0}.",
f);wac_KBb(l,e.OriginalUrl,this.ua.C4?null:e.Caption,c,this.ua.Sjf?e.PageUrl:e.LicenseUrl);k&&wac_iO(b,[k]);wac_90(this.Wm,b,l,null);m&&(wac_90(this.Wm,b,m,null),wac_fvc(l,m.ia()),wac_v(m,wac_Jrb,!0))}finally{q&&q.dispose()}wac_10(this.MB,l);return 32}catch(v){return wac_Y(8955416,352,10,"InsertMediaActor::UploadOnlinePicture : Pic = [{0}], Exception = [{1}].",e.OriginalUrl,v.toString()),8}},Sue:function(a,b,c,d,e){var f;a=this.Ca.Ja();var g,h;if((h=wac_38(this,a,this.ua.vvd,g={val:f}),f=g.val,!h)||
1===c)return f;wac_Y(38854735,352,50,"InsertMediaActor::InsertIcons : Start inserting.");if(!e||!e.length)return 16;if(!wac_k7(this.Nj,a,e.length))return wac_j7(this.Nj,a),16;try{var k=null;c=null;var l,m,n;if(n=wac_Foc(this,e,a,l={val:c},m={val:k}),c=l.val,k=m.val,!n)return 16;var p=this,q=this,r=wac_kO(this.nb,15,function(){wac_zM(p.ha);wac_GL(p.ha);p.ra.ld()},function(){wac_t0a(q.ha,k,!0)},!1);try{for(r.lb(a),r.jr(934858027),r.Dea.ElementSource="Icon",c&&wac_iO(a,c),l=0;l<k.length;l++)wac_90(this.Wm,
a,k[l],null)}finally{r&&r.dispose()}wac_10(this.MB,k[k.length-1]);return 32}catch(t){return wac_Y(37822680,352,10,"InsertMediaActor::InsertIcons : icon count = [{0}], Exception = [{1}].",e.length,t.toString()),8}},Rte:function(a,b,c,d,e){var f;b=this.Ca.Ja();var g,h;if((h=wac_38(this,b,this.ua.LBc,g={val:f}),f=g.val,!h)||1===c)return f;wac_Y(38854738,352,50,"InsertMediaActor::ChangeIcon : Start changing.");if(!e||!e.length)return 16;try{var k=wac_Goc(this);if(!k)return 16;var l=e[0].Caption,m=wac_BO(k);
l&&m&&wac_dvc(this.Qg,new wac_Hpc(wac_GI(b),k.Yc(),k.Gm(),l));if(this.Ib.Ac(k))return 16;var n=this,p=this,q=wac_kO(this.nb,15,function(){wac_BM(n.ha);n.ra.ld()},function(){m&&(wac_Bnc(p.Qg),wac_cU(p.ha,m,!0,!0),wac_Cnc(p.Qg))},!1);try{q.lb(k),q.jr(a),wac_9zb(k,e[0].OriginalUrl),l&&wac_GBb(k,l)}finally{q&&q.dispose()}(c=m||k)&&this.Ib.cxa(b,c,this.Lc.Cb(),a);return 32}catch(r){return wac_Y(38670732,352,10,"InsertMediaActor::ChangeIcon : icon count = [{0}], Exception = [{1}].",e.length,r.toString()),
8}},k2d:function(a,b,c){var d;a=this.Ca.Ja();var e,f;if((f=wac_38(this,a,this.ua.lLa,e={val:d}),d=e.val,!f)||1===c)return d;try{return this.ua.$ge?(wac_Y(8955424,352,50,"[Insert Online Video] Insert online video from URL, creating dialog"),(new wac_Nlc(this.gBa)).dSa()):(wac_Y(38322659,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video"),this.T6b.IG(wac_rRb(this.ua.Wlc),this.S6b,this.urb).hSa(CommonUIStrings.L_VideoInsertTitle,new wac_L5b(this.U,this.urb))),wac_Y(8955426,352,50,
"InsertMediaActor::ShowInsertVideoDialog : Show dialog success."),32}catch(g){return wac_Y(8955456,352,10,"InsertMediaActor::ShowInsertVideoDialog : Exception = [{0}]",g.toString()),8}},d5d:function(a,b,c,d,e){var f;b=this.Ca.Ja();var g,h;if((h=wac_38(this,b,this.ua.lLa,g={val:f}),f=g.val,!h)||1===c)return f;if(!wac_k7(this.Nj,b,1))return wac_j7(this.Nj,b),16;try{var k=wac_60(b,wac_5M(this.ha));if(k&&this.Ib.Ac(k))return 16;var l=this.uab(this.Lc,b,k),m=wac_pRb(e.OriginalUrl);wac_LBb(l,m,e.ThumbnailUrl,
e.Caption);var n=this,p=this,q=wac_kO(this.nb,15,function(){wac_zM(n.ha);wac_GL(n.ha);n.ra.ld()},function(){wac_cU(p.ha,l,!0,!0)},!1);try{q.lb(b),q.jr(a),k&&wac_iO(b,[k]),wac_90(this.Wm,b,l,null)}finally{q&&q.dispose()}wac_Y(8955460,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video [{0}] is done.",e.OriginalUrl);wac_10(this.MB,l);return 32}catch(r){return wac_Y(8955462,352,10,"InsertMediaActor::UploadOnlineVideo : Exception = [{0}].",r.toString()),8}},uab:function(a,b,c){return wac_Hoc(this,
b,c,!1,0)}};function wac_Hoc(a,b,c,d,e){var f=wac_GI(b);b=wac_70(b);var g=0,h=0;if(d){var k=g={val:g},l=h={val:h};c&&15===wac_YI(c)?(k.val=wac_Pe(c.ej(Number,wac_Fva,0),0,!1),l.val=wac_Pe(c.ej(Number,wac_Gva,0),0,!1)):(k.val=wac_Pe(2,0,!1),l.val=wac_Pe(2,0,!1));g=g.val;h=h.val}else g=110,h=75;k=c?wac_d1(c,g,h,!1):wac_g1(a.Pb,g,h);e=c?0:15*e;a=wac_e1(a.Bo,!0,f.fe(),f.Vc(),k.x+e,k.y+e,g,h,b+1,!0);wac_v(a,wac_38a,d);c&&wac_c1(a,c.ia());return a}
function wac_38(a,b,c,d){if(!b||!c||a.Ib.Ac(b))return d.val=16,!1;d.val=32;return!0}function wac_Goc(a){var b=null;a=wac_5M(a.ha);for(var c=a.length,d=0;d<c;++d){var e=a[d];if(e&&wac_zO(e))if(b)break;else b=e}return b}
function wac_Foc(a,b,c,d,e){d.val=Array(b.length);e.val=Array(b.length);var f=wac_Rfc(c,wac_5M(a.ha));if(f&&0<f.length)for(var g=0,h=f.length,k=0;k<h;++k){var l=f[k];if(l&&!a.Ib.Ac(l)&&g<b.length&&(d.val[g]=l,g++,g===b.length))break}f=!0;for(g=0;g<d.val.length;g++){if(a.ua.gfe&&b[g].SvgContent&&0<b[g].SvgContent.length&&(!d.val[g]||d.val[g]&&15!==wac_YI(d.val[g]))){var h=e.val,k=g,m=a,n=c,l=d.val[g],p=b[g],q=g,r=wac_GI(n),t=wac_70(n),v=void 0,u=void 0,n=window.$$as(wac_7J,wac_T(n,m.Lc.Cb()));wac_b5b(m.eta,
l,p.Width,p.Height,u={val:u},v={val:v});u=u.val;v=v.val;q=l?0:15*q;r=wac_e1(m.Bo,!0,r.fe(),r.Vc(),v.x+q,v.y+q,u.ac,u.qc,t+1,!1);t=wac_c5b(m.Lc.Df(),u,v,n.xia);wac_gzb(r,t);wac_v(r,wac_Iq,!0);wac_v(r,wac_7ta,!0);wac_Aqc(r,!0);wac_v(r,wac_Xta,!0);wac_v(r,wac_38a,!0);a:if(p=p.SvgContent,t=wac_uUc(m.Q5d,p),m=null,t&&t.innerHTML&&t.innerHTML.startsWith("<svg")){m=t.innerHTML;if(0<p.indexOf("viewBox")&&0>m.indexOf("viewBox"))if((t=p.match(/viewBox="[^"]*/))&&1===t.length&&t[0])m=m.replace("<svg",String.format('<svg {0}"',
t[0]));else{m=null;break a}if(0<p.replace(" ","").indexOf('xmlns="http://www.w3.org/'))m=0<m.indexOf("xmlns=")?m:m.replace("<svg",String.format("<svg {0}",'xmlns ="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'));else{m=null;break a}}wac_uRa(r,m?String.format("data:image/svg+xml;charset=utf8,{0}",window.encodeURIComponent(m)):"");l&&wac_c1(r,l.ia());h[k]=r}else e.val[g]=wac_Hoc(a,c,d.val[g],!0,g),f=!1;f&&wac_V7(!0,!0);wac_KBb(e.val[g],b[g].OriginalUrl,b[g].Caption,null,null)}return!0}
function wac_v0c(a){a.U.Mp(2948423841,1,a.qrd,4);a.ua.n5e&&a.U.Nrd("ConnectedServices",!0,2948423841,1,a.qrd,function(b){var c=a.SXe;wac_NNc(window.Box4.App.zb(),b,c.qLd||(c.qLd=Function.createDelegate(c,c.J3e)))})}
function wac_u0c(a){a.U.Mp(1685987254,1,a.ord,4);a.U.Mp(2691408781,1,a.Gif,4);a.U.Mp(720118144,1,a.Nwb,4);a.ua.n5e&&(a.U.Nrd("ConnectedServices",!0,1685987254,1,a.ord,function(b){var c=a.SXe;wac_NNc(window.Box4.App.zb(),b,c.qLd||(c.qLd=Function.createDelegate(c,c.J3e)))}),a.U.Nrd("ConnectedServices",!0,2691408781,1,a.Gif,function(b){var c=a.SXe;wac_NNc(window.Box4.App.zb(),b,c.qLd||(c.qLd=Function.createDelegate(c,c.J3e)))}),a.U.Nrd("ConnectedServices",!0,720118144,1,a.Nwb,function(b){var c=a.SXe;
wac_NNc(window.Box4.App.zb(),b,c.qLd||(c.qLd=Function.createDelegate(c,c.J3e)))}))}function wac_hoc(a,b,c){wac_hoc.initializeBase(this,[a,b,null]);this.ua=c;this.qLa=1488343741}
wac_hoc.prototype={ua:null,uya:function(a){if(a&&a.length){var b,c=a[0];(c=!!c&&!!c.OriginalUrl&&0<c.OriginalUrl.length&&this.ua.LBc&&!!this.ua.tvd&&0<this.ua.tvd.length&&0<=c.OriginalUrl.toLowerCase().indexOf(this.ua.tvd.toLowerCase())&&c.OriginalUrl.toLowerCase().indexOf(".svg")===c.OriginalUrl.length-4)||wac_Y(38670750,352,50,"isChangeSvg = false");try{if(c){wac_Y(38670742,352,50,"Change {0} svg images.",a.length);b=this.Ia.os(this.qLa,2,a,null);if(32!==b)throw Error.invalidOperation("Failed to change svg images.");
wac_Y(38670744,352,50,"Change {0} svg images successfully.",a.length)}else wac_Y(38670746,352,10,"Change {0} pictures not supported.",a.length)}catch(d){wac_Y(38670748,352,10,"InsertMediaActor::{0}: Exception = [{1}].",c?"OnChangeSvg":"OnChangePicture",d.toString())}}}};function wac_F8(a,b,c){wac_F8.initializeBase(this,[a,b,null]);this.ua=c;this.qLa=2168883939}
wac_F8.prototype={ua:null,uya:function(a){if(a&&a.length){var b,c=a[0];(c=!!c&&!!c.OriginalUrl&&0<c.OriginalUrl.length&&this.ua.vvd&&!!this.ua.tvd&&0<this.ua.tvd.length&&0<=c.OriginalUrl.toLowerCase().indexOf(this.ua.tvd.toLowerCase())&&c.OriginalUrl.toLowerCase().indexOf(".svg")===c.OriginalUrl.length-4)||wac_Y(37822723,352,50,"isInsertSvg = false");var d=wac_h3a(this.qLa),e=new window.Map;e.set("InsertMediaCommand",d);wac_4g().recordKpiUsageForAlertableKpi("InsertOnlineImage",null,e);try{if(934858027===
this.qLa&&c){wac_Y(37822688,352,50,"InsertMediaCallback: Insert {0} svg images.",a.length);b=this.Ia.os(this.qLa,2,a,null);if(32!==b)throw Error.invalidOperation("Failed to insert svg images");wac_Y(37822690,352,50,"InsertMediaCallback: Insert {0} svg images successfully.",a.length)}else if(2168883939===this.qLa||239978317===this.qLa){wac_Y(21844548,352,50,"InsertMediaCallback:  Insert {0} pictures, command: {1}",a.length,d);for(d=0;d<a.length;d++)if(b=this.Ia.os(this.qLa,2,a[d],null),32!==b)throw Error.invalidOperation(String.format("Failed to upload picture {0}",
d));wac_Y(21844550,352,50,"InsertMediaCallback:  Insert {0} pictures success.",a.length)}else wac_Y(39409236,352,10,"InsertMediaCallback:  invalid action: {0}.",this.qLa),wac_4g().recordKpiFailure("InsertOnlineImage","InvalidAction",!0,!0,e)}catch(f){wac_Y(21844552,352,10,"InsertMediaActor::{0}: Exception = [{1}].",c?"OnInsertSvg":"OnInsertPicture",f.toString()),e.set("Exception",f.toString()),wac_4g().recordKpiFailure("InsertOnlineImage","InsertMediaException",!1,!0,e)}}}};
function wac_L5b(a,b){wac_L5b.initializeBase(this,[a,b,null]);this.qLa=2168458114}wac_L5b.prototype={uya:function(a){a&&0<a.length&&this.Ia.os(this.qLa,2,a[0],null)}};function wac_i3b(){}wac_i3b.prototype={IG:function(a,b,c){return new wac_d5(a,b,c)}};function wac_v4b(a,b,c,d,e,f,g,h){this.Nvb=Function.createDelegate(this,this.hMb);wac_v4b.initializeBase(this,[a,b,c,f,g,h]);this.U=d;this.Pb=e}
wac_v4b.prototype={U:null,Pb:null,Tb:function(){this.U.ja(981175184,1,this.crd);this.nYc.uc(this.Nvb)},Lf:function(){},$Ec:function(){var a=this.Pb.hQa(!0);if(!this.X0a||!a.qc)return!1;var a=a.ac/a.qc,b=new wac_D2b(this.X0a,!1,a);this.OXc=b;this.LX=a;this.C5b=!!this.Ob&&!!this.X0a&&!wac_h(this.E0a)&&!!b&&!!a;return!0},hMb:function(a){this.d1a=a;wac_yg||wac_.pya||!this.d1a||(this.d1a.bQb("CanEmbed"),this.d1a.UVd("CanEmbed",this.drd))}};
function wac_s4b(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,v,u,w,x,z,y,A){this.g4=Function.createDelegate(this,this.FRa);this.Nvb=Function.createDelegate(this,this.hMb);this.aod=Function.createDelegate(this,this.yYd);this.Ypd=Function.createDelegate(this,this.k0d);this.ccd=Function.createDelegate(this,this.VHd);this.dcd=Function.createDelegate(this,this.WHd);this.mtf=Function.createDelegate(this,this.nzf);this.ltf=Function.createDelegate(this,this.mzf);this.ktf=Function.createDelegate(this,this.lzf);this.V8c=
Function.createDelegate(this,this.ACd);this.S8c=Function.createDelegate(this,this.xCd);this.T8c=Function.createDelegate(this,this.yCd);this.gvb=Function.createDelegate(this,this.uGb);this.bcd=Function.createDelegate(this,this.UHd);this.U=a;this.zd=b;this.ra=c;this.ha=d;this.JB=e;this.Zo=f;this.t$b=g;this.rYc=h;this.I1c=k;this.pqb=l;this.Ob=m;this.B6b=u.Clc;this.d3e=u.ALd;this.Kl=n;this.Cc=x;this.GUc=u.Vqc;this.fae=p;this.ZX=q;this.hb=v;this.gT=!u.Pi();this.Q9b=z;this.fhf=A;this.Y4b=!u.qCb||wac_q(w,
"DisablePrint");this.Z4b=r;this.yi=t;this.NWc=w.Qb.DownloadPdfFromPodsUrl;this.H1c=w.Qb.PrintPdfFromPodsUrl;this.MWc=w.Qb.DownloadOdpFromPodsUrl;this.J1c=u.iCb;this.LWc=w.Qb.DownloadImagesFromPodsUrl;this.M2c=u.drc;a=(wac_.Vxa||"").toLowerCase();u.Pi()&&u.Azb?(this.lVc=!0,this.w0a=w.Qb.DownloadACopyPodsUrl):!u.Pi()&&u.Znc&&(a.endsWith(".pptx")||a.endsWith(".ppsx"))?(u=new wac_nh(wac_P1("DownloadACopyHandler.ashx")),wac_oh(u,"Pid",this.hb.Bj().Tj),wac_oh(u,"si",this.hb.Gc),wac_oh(u,"fn",wac_.Vxa),
wac_Wg(u.Qja),this.w0a=u.toString()):this.w0a=wac_.INa;this.nYc=y}
wac_s4b.prototype={U:null,zd:null,ra:null,ha:null,JB:null,Zo:null,rYc:null,t$b:!1,I1c:null,pqb:null,Ob:null,B6b:null,d3e:!1,w0a:null,Kl:null,GUc:!1,fae:null,ZX:null,hb:null,gT:!1,Y4b:!1,Z4b:null,yi:null,NWc:null,H1c:null,MWc:null,LWc:null,M2c:!1,Q9b:null,J1c:!1,lVc:!1,Cc:null,nYc:null,d1a:null,fhf:null,Tb:function(){var a=!!this.Z4b&&!this.Q9b();wac_Y(25297680,801,50,"Limited printing access: {0}, Message shown: {1}",this.Y4b,a);if(this.Y4b){if(a){var a=this.yi,b=a.ME.Db(null,this.Z4b,null);wac_KP(b,
!0);b.Do(20);a.Oo.tG(b,!1)}}else this.U.ja(1588554917,1,this.bcd),this.U.ja(3555692408,1,this.gvb),this.U.ja(2439343378,1,this.T8c),this.U.ja(1249692773,1,this.S8c),this.U.ja(1191538800,1,this.V8c),this.U.ja(1924572812,1,this.ktf),this.U.ja(3098027807,1,this.ltf),this.U.ja(3131236268,1,this.mtf),this.J1c&&(wac_Y(25306193,801,50,"Printing options enabled"),this.U.ja(277798930,1,this.dcd),this.U.ja(2255327903,1,this.ccd));this.U.ja(3070187925,1,this.Ypd);this.t$b&&this.U.Mp(1007486079,1,this.aod,96);
this.nYc.uc(this.Nvb)},Lf:function(){var a=this.ra.xc("app");a.Ba(wac_A(80,wac_8j()),1588554917);a.Ba(wac_A(68,wac_8j()),336231556);a.Ba(wac_A(83,wac_8j()),336231556);a.Ba(wac_A(117,wac_8j()),336231556);a.Ba(wac_A(117,wac_8j()|4),336231556)},mzf:function(a,b,c){return wac_w0c(this,c,2316717900)},lzf:function(a,b,c){return wac_w0c(this,c,4246497969)},nzf:function(a,b,c){return wac_w0c(this,c,3050207199)},uGb:function(a,b,c){if(this.zd.Ac(this.JB))return 16;if(1===c)return wac_II(this.Cc)?wac_hf?8:
32:8;wac_GL(this.ha);this.ra.ld();wac_Y(19743434,801,50,"PPT save and download a copy");if(this.d3e&&this.hb.V3d)wac_x0c(this);else{this.Kl.Ki(!0,a);var d=this;wac_fY(this.Zo,!1,this.gT,function(){wac_x0c(d)},this.g4,1)}return 32},yYd:function(a,b,c,d,e){a="";this.t$b&&(a=this.rYc.mJ(this.JB)?String.format(ResourceStrings.L_SavingStatus):this.B6b?String.format(CommonUIStrings.l_SavedToStatus,this.B6b):String.format(ResourceStrings.L_SavedStatus));e.Value=a;return 32},UHd:function(a,b,c){return wac_w5b(this,
c,0,a)},WHd:function(a,b,c){return wac_w5b(this,c,8,a)},VHd:function(a,b,c){return wac_w5b(this,c,4,a)},yCd:function(a,b,c){if(this.zd.Ac(this.JB))return 16;if(1===c)return wac_II(this.Cc)?wac_hf?8:32:8;this.ZX.xyb=new Date;wac_GL(this.ha);this.ra.ld();if(this.d3e&&this.hb.V3d)wac_y0c(this);else{this.Kl.Ki(!0,a);var d=this;wac_fY(this.Zo,!1,this.gT,function(){wac_y0c(d)},this.g4,1)}return 32},ACd:function(a,b,c){if(this.zd.Ac(this.JB))return 16;if(1===c)return wac_II(this.Cc)?wac_hf?8:32:8;wac_GL(this.ha);
this.ra.ld();if(this.d3e&&this.hb.V3d)wac_z0c(this);else{this.Kl.Ki(!0,a);var d=this;wac_fY(this.Zo,!1,this.gT,function(){wac_z0c(d)},this.g4,1)}return 32},xCd:function(a,b,c){if(this.zd.Ac(this.JB))return 16;if(1===c)return wac_II(this.Cc)?wac_hf?8:32:8;wac_GL(this.ha);this.ra.ld();if(this.d3e&&this.hb.V3d)wac_A0c(this);else{this.Kl.Ki(!0,a);var d=this;wac_fY(this.Zo,!1,this.gT,function(){wac_A0c(d)},this.g4,1)}return 32},FRa:function(){this.Kl.fd();return!1},k0d:function(a,b,c,d,e){if(this.zd.Ac(this.JB))return 16;
if(1===c)return 32;wac_GL(this.ha);this.ra.ld();wac_fY(this.Zo,!1,!0,function(a){if(e&&1<=e.length)e[0](a)},function(a){return e&&2<=e.length?(e[1](a,a.ServerError.Code),!0):!1},1);return 32},hMb:function(a){this.d1a=a}};
function wac_08(a,b){if(b){var c=new wac_nh(b);a.hb&&a.hb.Jc&&0>b.indexOf(a.hb.Jc)&&(c.rMa("PodSID="+a.hb.Jc),wac_Y(35235403,801,50,"Append PodSessionId in url: {0}",a.hb.Jc));a.M2c&&wac_.dJ.lw&&0<wac_.dJ.lw.length&&(wac_oh(c,"fn",wac_.dJ.lw),wac_Y(37246871,801,50,"Appended FileName in url"));wac_Wg(c.Qja);return c.toString()}return null}function wac_A0c(a){a.Kl.fd();wac_x5b(a.pqb,a.hb.Bj().Tj,0,wac_08(a,a.MWc))}function wac_z0c(a){a.Kl.fd();wac_x5b(a.pqb,a.hb.Bj().Tj,2,wac_08(a,a.LWc))}
function wac_y0c(a){a.Kl.fd();a.ZX.JCb=new Date;wac_x5b(a.pqb,a.hb.Bj().Tj,1,wac_08(a,a.NWc))}function wac_B0c(a,b){a.Kl.fd();var c=a.I1c,d=a.hb.Bj().Tj;a=wac_08(a,a.H1c);c.od.Ta.Kzb&&c.qXc?(d=new wac_nh(a),wac_oh(d,"useNamedAction",wac_JNb(c.gGa).toString()),wac_oh(d,"publishOption",b.toString()),wac_i_c(c.gGa,d.toString())):(b=new wac_y5b(d,wac_JNb(c.gGa)),b.Lsb=c.ljd,b.Wd())}
function wac_w5b(a,b,c,d){if(a.zd.Ac(a.JB))return 16;if(1===b)return wac_II(a.Cc)?wac_hf?8:32:8;if(a.Q9b())return wac_Y(24934547,328,50,"Printing not allowed for IRM protected documents"),16;wac_Y(18983065,328,50,"PPT Editor print. PublishOption: {0}",c);wac_GL(a.ha);a.ra.ld();a.d3e&&a.hb.V3d?wac_B0c(a,c):(a.Kl.Ki(!0,d),wac_fY(a.Zo,!1,a.gT,function(){wac_B0c(a,c)},a.g4,1));return 32}
function wac_x0c(a){a.Kl.fd();var b=a.lVc?wac_08(a,a.w0a):a.w0a;a.fhf&&a.fhf("3555692408")?a.d1a.Dx("UI_Download",{},""):a.GUc?new wac_v5b(b):a.Ob.qv(!0,b,!0)}function wac_w0c(a,b,c){return 1===b?wac_hf?8:a.U.yw(c,1,null):a.d3e&&a.hb.V3d?(wac_Y(50370185,801,50,"DocumentOperationsActor:SaveAsImpl - Inline Repair Case , ActionId: {0}",c),a.U.os(2916697279,2,c,null)):a.U.yw(c,2,null)}function wac_T7b(a){wac_T7b.initializeBase(this,[a])}
wac_T7b.prototype={rha:function(){return wac_.oQ?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady},JPa:function(){wac_Y(25544926,801,50,"Images download dialog displayed")},KPa:function(){wac_Y(25544928,801,50,"Images download dialog link clicked")},Oya:function(){wac_Y(25544930,801,50,"Images download dialog button clicked")}};function wac_y9(a){wac_y9.initializeBase(this,[a,!0,wac_.oQ,null,null])}
wac_y9.prototype={rha:function(){return ResourceStrings.l_DownloadAsOdpDialogOdpReady},Mob:function(){return ResourceStrings.l_DownloadAsOdpDialogLinkSuggestion},S2b:function(){return"DownloadOdpLink"},MZa:function(){return ResourceStrings.L_Download},RZa:function(){return wac_.oQ?"UIFontDialogTextLarge":null},JPa:function(){wac_Y(8958087,801,50,"ODP download dialog displayed")},KPa:function(){wac_Y(8958089,801,50,"ODP download dialog link clicked")},Oya:function(){wac_Y(19505496,801,50,"ODP download dialog button clicked")},
Dzc:function(){wac_hi("PPTODF");return!0},YTc:function(){return"#"},XTc:function(){return ResourceStrings.l_DownloadAsOdpDialogLearnMoreLinkText},aUc:function(){return!wac_.oQ}};function wac_H8(){this.xyb=this.JCb=this.cyb=this.syb=window.Box4.App.Fn}wac_H8.prototype={xyb:null,JCb:null,cyb:null,syb:null};function wac_z9(a){wac_z9.initializeBase(this,[a])}
wac_z9.prototype={rha:function(){return wac_.oQ?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady},JPa:function(){wac_Y(21050910,801,50,"PDF download dialog displayed")},KPa:function(){wac_Y(21050912,801,50,"PDF download dialog link clicked")},Oya:function(){wac_Y(21050914,801,50,"PDF download dialog button clicked")}};function wac_37b(){}
wac_37b.prototype={Ub:function(){return"PowerPointWebEditor.PrintPackage"},gc:function(){wac_m(wac_n(wac_o(wac_j().fa(wac_47b),wac_t4b)),function(){return new wac_47b(wac_k(wac_j(),wac_h4),wac_k(wac_j(),wac_3L),wac_k(wac_j(),wac_R).Pi())});wac_m(wac_n(wac_o(wac_j().fa(wac_57b),wac_u4b)),function(){return new wac_57b(wac_0b(wac_j(),wac_H8),wac_k(wac_j(),wac_3L),wac_k(wac_j(),wac_R).Pi())});wac_m(wac_n(wac_j().fa(wac_H8)),function(){return new wac_H8})},tb:function(){},O:function(){}};
function wac_u$b(a){wac_u$b.initializeBase(this,[ResourceStrings.l_ConvertingToOdpProgressString,ResourceStrings.l_ConvertingToOdpErrorString,5308438]);this.Vn=a}wac_u$b.prototype={Wd:function(){wac_49.prototype.Wd.call(this);var a=this.Vn,b=this.vT,c=this.mZ,d=new wac_ME("ConvertToOdp");wac_NE(d,null);wac_OE(d,new wac_PE("presentationId",a));wac_KE.pr(d,b,c,null,null,null,2)},Vn:null};
function wac_v$b(a){wac_v$b.initializeBase(this,[ResourceStrings.L_PrintingProgressString,ResourceStrings.l_ConvertingToPdfErrorString,5308439]);this.Vn=a}wac_v$b.prototype={Wd:function(){wac_49.prototype.Wd.call(this);var a=this.Vn,b=this.vT,c=this.mZ,d=new wac_ME("ConvertToPdf");wac_NE(d,null);wac_OE(d,new wac_PE("presentationId",a));wac_KE.pr(d,b,c,null,null,null,2)},Vn:null};function wac_v5b(a){wac_v5b.initializeBase(this,[a,!0,wac_.oQ,null,null])}
wac_v5b.prototype={rha:function(){return CommonUIStrings.l_DownLoadACopyDialogMessage},Mob:function(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion},S2b:function(){return"PowerPointDownloadCopyLink"},MZa:function(){return CommonUIStrings.l_Download},RZa:function(){return wac_.oQ?"UIFontDialogTextLarge":null},JPa:function(){wac_Y(19743688,801,50,"Download a copy dialog displayed")},KPa:function(){wac_Y(19743690,801,50,"Download a copy dialog clicked")},Oya:function(){wac_Y(19743692,801,
50,"Download a copy dialog button clicked")}};function wac_D3b(){}wac_D3b.prototype={};function wac_y5b(a,b){wac_y5b.initializeBase(this,[ResourceStrings.L_PrintingProgressString,ResourceStrings.L_PrintingErrorString,5308421]);this.Vn=a;this.i4c=b}
wac_y5b.prototype={i4c:!1,Wd:function(){wac_49.prototype.Wd.call(this);var a=this.Vn,b=this.i4c,c=this.vT,d=this.mZ,e=new wac_ME("Print");wac_NE(e,null);wac_OE(e,new wac_PE("presentationId",a));wac_OE(e,new wac_PE("useNamedAction",b));wac_KE.pr(e,c,d,null,null,null,2)},Vn:null};function wac_47b(a,b,c){this.ljd=Function.createDelegate(this,this.aSd);if(!a)throw Error.argumentNull("directPrintManager");this.gGa=a;this.od=b;this.qXc=c}
wac_47b.prototype={gGa:null,od:null,qXc:!1,aSd:function(a){var b=this.gGa;b.mx.ezc&&wac_b(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",b.JDa.ma().$fb,b.JDa.ma().C0);a=a.qf;1!==wac_r().kg()&&(a=wac_P1(a.PrintUrl),wac_i_c(this.gGa,a))}};function wac_37(a,b,c,d){this.AAe=Function.createDelegate(this,this.yye);this.qIa=a;this.Gh=b;this.Ta=c;this.Cc=d;this.Rta={}}wac_37.prototype={s2a:null,qIa:null,Gh:null,Ta:null,Cc:null,Rta:null};
wac_37.prototype.wCe=function(a,b){try{wac_Y(39105290,822,50,"PPTVersionHistorySelectionHandler:OnVersionHistorySelected");var c=document.getElementById("VersionHistoryViewerSpinner");c&&(c.style.display="none");if(this.s2a)this.s2a.onVersionSelected(a,b,this.Rta)}catch(d){wac_Y(39146258,822,50,"PPTVersionHistorySelectionHandler: OnVersionHistorySelected failed due to exception. {0}",d)}};wac_37.prototype.OnVersionHistorySelected=wac_37.prototype.wCe;
wac_37.prototype.Lye=function(a){try{if(this.s2a)wac_gvc(!1),this.s2a.switchParentViewContainer(a);else{wac_gvc(!0);var b=new window.PowerPointVersionHistory.AppBootSettings;b.RenderServiceBase="";b.IsRtl=!1;var c=new window.PowerPointVersionHistory.AppCallbackBag,d=this.qIa;c.animationDecoratorCallback=d.zAe||(d.zAe=Function.createDelegate(d,d.RBe));c.notesIconDecoratorCallback=this.AAe;b.IsHighContrast=!1;this.Gh&&(b.IsHighContrast=this.Gh.ZJ);b.IsHighContrast&&(b.ClientColorSettings=this.Gh.Ap.wba+
"_"+this.Gh.Ap.DP+"_"+this.Gh.Ap.YKa);if(this.Cc){var e=wac_CI(this.Cc);b.DefaultSlideWidth=e.ac;b.DefaultSlideHeight=e.qc}b.UserSessionId=wac_.Ag;b.VersionViewerCssUrl=this.Ta.IBe;b.ProgressImageResourceUrl=wac_Le("progress.gif");b.VersionViewerUseGetItems=this.Ta.scf;this.s2a=new window.PowerPointVersionHistory.AppVersionController(b,a,c)}}catch(f){wac_Y(39146260,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",f)}};
wac_37.prototype.ResetAppVersionController=wac_37.prototype.Lye;wac_37.prototype.yye=function(){return wac_4h(14,14,"ToolbarNotesActiveDark_14x14x32",null,"Notes")};wac_37.prototype.CreateNotesIcon=wac_37.prototype.yye;function wac_3wc(a,b,c){wac_3wc.initializeBase(this,[b,c]);this.Fe=a}
wac_3wc.prototype={Fe:null,DZa:null,y2b:function(){if(this.DZa)return this.DZa.oj();this.DZa=new (wac_Rb.$$(String));var a=this;this.Fe.Ok(function(){var b=a.Fe.Qb[wac_2(125)];b||(wac_Y(9007258,333,15,"Contact Id is null"),b="NoCIdUser");a.DZa.Ze(b)});return this.DZa.oj()}};
function wac_4wc(a,b,c,d,e,f,g,h,k,l){wac_4wc.initializeBase(this,[d,c,e,f,g]);this.he=a;this.U=d;this.BVc=h;this.gy=b;this.ne=l;this.O_a=k;if(!this.gy)throw Error.argumentNull("m_coauthEventHandler");var m=this;wac_jqb(this.gy,function(){m.U.yw(2854028228,2,null)})}wac_4wc.prototype={he:null,BVc:null,gy:null,U:null,ne:!1,O_a:null,Hfb:function(){this.BVc.uc(function(a){var b=a.ME.Db(null,CommonUIStrings.l_ChatIsNotAvailable,null);wac_KP(b,!0);b.Do(17);a.Oo.tG(b,!1)})}};
function wac_s4(a){a.ne?a.O_a.uc(function(a){a.y7()}):wac_H0a(a.he,new wac_YL(a.ar().ta,!0))}function wac_Jwc(){this.hdd=Function.createDelegate(this,this.MJd);this.CEe=Function.createDelegate(this,this.xMe)}
wac_Jwc.prototype={J:null,gy:null,Ub:function(){return"PowerPointWebEditor.PowerPointSkypeChatPackage"},tb:function(){wac_.Q9a.dO()?(this.gy=this.J.H(wac_MY),this.gy.la.xa("CSC",this.CEe)):wac_5wc(this)},xMe:function(){wac_.Q9a.dO()||(wac_5wc(this),this.gy.la.sb("CSC",this.CEe))},O:function(){},MJd:function(){wac_j().H(wac_Cc)},gc:function(a){this.J=a;wac_m(wac_n(wac_o(a.fa(wac_u4),wac_Cc)),function(){return new wac_u4(wac_rP(wac_yc,wac_l(wac_j(),wac_yc)),wac_rP(wac_Hc,wac_l(wac_j(),wac_Hc)),wac_rP(wac_Ic,
wac_l(a,wac_Ic)),wac_rP(wac_Gc,wac_l(a,wac_Gc)))});wac_m(wac_n(a.fa(wac_m4)),function(){return new wac_3wc(wac_j().H(wac_Uc),wac_rP(wac_Im,wac_l(a,wac_Im)),wac_rP(wac_Jm,wac_l(a,wac_Jm)))});wac_m(wac_n(wac_o(a.fa(wac_p4),wac_9la)),function(){return new wac_p4(wac_rP(wac_yc,wac_l(wac_j(),wac_yc)),wac_rP(wac_Ic,wac_l(a,wac_Ic)),wac_rP(wac_Hc,wac_l(wac_j(),wac_Hc)),a.H(wac_m4),wac_rP(wac_Gc,wac_l(wac_j(),wac_Gc)),wac_.pa)});var b=this;wac_m(wac_n(wac_o(wac_o(a.fa(wac_4wc),wac_r4),wac_$la)),function(){var c=
wac_4wc,d=a.H(wac_Qt),e=a.H(wac_MY),f=a.H(wac_cOb),g=a.H(wac_Oc),h=wac_rP(wac_Cc,wac_l(a,wac_Cc)),k=a.H(wac_kG).Bz(),l="";b.J.H(wac_R).Pi()&&(l=wac_0i(b.J.H(wac_Uc),wac_2(368))+"p/");return new c(d,e,f,g,h,wac_8Nb(k,l+"skypeproxy.ashx"),a.H(wac_9la),wac_l(a,wac_jM),wac_l(a,wac_mr),a.H(wac_R).ao)})}};function wac_5wc(a){wac_.pa.Ok(function(){wac_q(wac_.pa,"DocChatIsEnabled")&&(new wac_gOb(new (wac_f.$$(wac_$la))(function(){return a.J.H(wac_r4)}),wac_l(a.J,wac_Im),a.hdd)).tb()})}Type.registerNamespace("PowerPointWeb");
wac_wG=window.PowerPointWeb||{};function wac_u4b(){}wac_u4b.registerInterface("PowerPointWeb.IConverter");function wac_t4b(){}wac_t4b.registerInterface("PowerPointWeb.IPrinter");function wac_57b(a,b,c){this.jgd=Function.createDelegate(this,this.TOd);this.igd=Function.createDelegate(this,this.SOd);this.ZX=a;this.od=b;this.Sqb=c}
wac_57b.prototype={ZX:null,od:null,Sqb:!1,SOd:function(a){a=a.qf;1!==wac_r().kg()&&(a=wac_P1(a.PrintUrl),new wac_y9(a))},TOd:function(a){a=a.qf;1!==wac_r().kg()&&(a=wac_P1(a.PrintUrl),this.ZX.ma().cyb=new Date,new wac_z9(a),this.ZX.ma().syb=new Date,wac_Y(21050908,801,50,"DownloadACopyAsPdf-StartTime: {0}, DownloadACopyAsPdf-SaveEnd: {1}, DownloadACopyAsPdf-ConvertEnd: {2}, DownloadACopyAsPdf-DialogShowEnd: {3}.",this.ZX.ma().xyb.toString(),this.ZX.ma().JCb.toString(),this.ZX.ma().cyb.toString(),
this.ZX.ma().syb.toString()))}};function wac_x5b(a,b,c,d){var e=null;c?1===c?a.od.Ta.Kzb&&a.Sqb?new wac_z9(d):wac_qE(wac__,function(){e=new wac_v$b(b);e.Lsb=a.jgd;e.Wd()}):2===c?a.od.Ta.vAb&&a.Sqb&&new wac_T7b(d):Error.invalidOperation(String.format("Convert task type '{0}' is not supported",c)):a.Sqb?new wac_y9(d):(e=new wac_u$b(b),e.Lsb=a.igd,e.Wd())}wac_A2b.registerClass("PPTe.EmbedManager");wac_C2b.registerClass("PPTe.PowerPointEmbedDialog",wac_e3);wac_F2b.registerClass("PPTe.PowerPointEmbedDialog.EmbedSizeOptions");
wac_D2b.registerClass("PPTe.FormatPicker");wac_sIc.registerClass("PowerPointWebEditor.Chronos2Package",null,wac_I,wac_i);wac_O3b.registerClass("PowerPointWebEditor.AddinCommandsActor",null,wac_g8);wac_Q3b.registerClass("PowerPointWebEditor.AppForOfficeActor",null,wac_g8);wac_u9.registerClass("PowerPointWebEditor.AddinCommandsInitService",wac_lIb,wac_J2b);wac_P7b.registerClass("PowerPointWebEditor.AddInCommandsInitPackage",null,wac_I,wac_i);
wac_p8b.registerClass("PowerPointWebEditor.AppForOfficeManagerFactory",null,wac_bM);wac_J8.registerClass("PowerPointWebEditor.AppForOfficeManagerFactory.CommandActionData");wac_A4b.registerClass("PowerPointWebEditor.InsertMediaActor",null,wac_g8);wac_hoc.registerClass("PowerPointWebEditor.ChangeOnlineImageHelper",wac_j5);wac_F8.registerClass("PowerPointWebEditor.InsertOnlineImageHelper",wac_j5);wac_L5b.registerClass("PowerPointWebEditor.InsertOnlineVideoHelper",wac_j5);
wac_i3b.registerClass("PowerPointWebEditor.PptInsertMediaDialogFactory",null,wac_V2b);wac_v4b.registerClass("PowerPointWebEditor.EmbedActor",wac_A2b,wac_g8);wac_s4b.registerClass("PowerPointWebEditor.DocumentOperationsActor",null,wac_g8);wac_T7b.registerClass("PowerPointWebEditor.DownloadACopyAsImagesDialog",wac_c3);wac_y9.registerClass("PowerPointWebEditor.DownloadACopyAsOdpDialog",wac_b3);wac_H8.registerClass("PowerPointWebEditor.DownloadACopyAsPdfContext");
wac_z9.registerClass("PowerPointWebEditor.DownloadACopyAsPdfDialog",wac_c3);wac_37b.registerClass("PowerPointWebEditor.PrintPackage",null,wac_I,wac_i);wac_u$b.registerClass("PowerPointWebEditor.ConvertToOdpTask",wac_49);wac_v$b.registerClass("PowerPointWebEditor.ConvertToPdfTask",wac_49);wac_v5b.registerClass("PowerPointWebEditor.PowerPointDownloadACopyDialog",wac_b3);wac_D3b.registerClass("PowerPointWebEditor.PowerPointDownloadACopyDialogFactory",null,wac_12b);
wac_y5b.registerClass("PowerPointWebEditor.PrintTask",wac_49);wac_47b.registerClass("PowerPointWebEditor.Printer",null,wac_t4b);wac_37.registerClass("PowerPointWebEditor.PPTVersionHistorySelectionHandler",null,wac_kIa);wac_3wc.registerClass("PowerPointWebEditor.PowerPointDocChatUserIdFactory",wac_lOb,wac_m4);wac_4wc.registerClass("PowerPointWebEditor.PowerPointSkypeChatActor",wac_r4);wac_Jwc.registerClass("PowerPointWebEditor.PowerPointSkypeChatPackage",null,wac_I,wac_i);
wac_57b.registerClass("PowerPointWeb.Converter",null,wac_u4b);var wac_e8=null,wac_K5b=!1;wac_.ke&&wac_dg()?wac_Y(40122142,809,15,"Firefox attempts to load chronos2 package when App is disposing"):wac_J(wac_C(),wac_k4(new wac_sIc,5),0,!1);Type.registerNamespace("PowerPointWebEditor");wac_Z=window.PowerPointWebEditor||{};function wac_X7(){}wac_X7.registerInterface("PowerPointWebEditor.IDesignerContext");function wac_07(){}wac_07.registerInterface("PowerPointWebEditor.IDesignerViewHelper");Type.registerNamespace("PowerPointWebEditor.Designer");
wac_Z.gGb=wac_Z.gGb||{};function wac_3nc(){}wac_3nc.registerInterface("PowerPointWebEditor.Designer.IDesignerPreviewImageView");
function wac_Q1b(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,v,u,w,x,z,y,A,B,C,F,D,G){this.Bse=Function.createDelegate(this,this.mve);this.Eo=Function.createDelegate(this,this.ju);this.Wee=Function.createDelegate(this,this.rCe);this.Fec=Function.createDelegate(this,this.KPd);this.lJa=Function.createDelegate(this,this.oQa);this.q8c=Function.createDelegate(this,this.LBd);this.p8c=Function.createDelegate(this,this.KBd);this.iba=Function.createDelegate(this,this.Dda);this.Vsf=Function.createDelegate(this,this.xyf);
this.r8c=Function.createDelegate(this,this.MBd);this.Nhf=Function.createDelegate(this,this.xwf);this.zZe=Function.createDelegate(this,this.o1e);this.tpd=Function.createDelegate(this,this.Beb);this.Uua=Function.createDelegate(this,this.xMd);this.Ybc=Function.createDelegate(this,this.jxd);this.cod=Function.createDelegate(this,this.AYd);this.Ytf=Function.createDelegate(this,this.hAf);this.hrd=Function.createDelegate(this,this.b2d);this.Se=f;this.WNc=g;this.Np=h;this.vHb=k;this.WX=l;this.Ft=m;this.Ec=
n;this.U=a;this.Xb=d;this.ra=e;this.Ea=p;this.Kz=q;this.Qg=r;this.gy=t;this.ua=v;this.Ib=b;this.nb=c;this.kf=u;this.$S=w;this.Exe=wac_PGc();this.hY=x;this.Lc=z;this.zc=y;this.pb=A;this.oua=B;this.Kke=D;this.qBe=G;if(v.rbf&&F){var H=this;F.km("PowerPointEnterpriseDesigner",!1).then(function(a){H.oqf=a;return null})}}
wac_Q1b.prototype={Se:null,WNc:null,Np:null,vHb:null,WX:null,Ft:null,Ec:null,U:null,ra:null,Xb:null,Ea:null,Kz:null,ua:null,Ib:null,nb:null,Qg:null,gy:null,kf:null,$S:null,Exe:null,L0a:null,hY:null,Lc:null,zc:null,oua:null,pb:null,qBe:null,ELe:0,oqf:!1,H6b:null,Kke:null,OXe:null,Tb:function(){if(this.ua.Cka){this.U.Mp(2503038014,1,this.hrd,4);this.U.Mp(2034521264,1,this.Ytf,4);this.U.Mp(1960712364,1,this.cod,96);this.U.Mp(1894291367,1,this.hrd,4);this.U.Mp(397517337,1,this.Ybc,4);this.U.Mp(1234776651,
1,this.Ybc,4);this.U.ja(2687326703,1,this.Uua);this.U.ja(1396913978,1,this.Uua);this.U.ja(2958572984,1,this.Uua);this.U.ja(3353734008,1,this.Uua);this.U.ja(1860084563,1,this.Uua);this.U.ja(3876507503,1,this.Uua);this.U.ja(1560908614,1,this.Uua);this.U.ja(446576891,1,this.Uua);this.U.ja(477300127,1,this.Uua);this.U.ja(131484319,1,this.Uua);this.U.ja(114500700,1,this.Uua);this.U.ja(2009705478,1,this.Uua);this.U.ja(407161026,1,this.Uua);this.U.ja(3690280729,1,this.Uua);this.U.Mp(2658220272,1,this.tpd,
64);this.U.ja(1170549389,1,this.zZe);this.U.ja(3180693624,1,this.Nhf);this.U.ja(39851908,1,this.Nhf);this.Kz.tX(this.r8c);this.ua.CZc&&this.Qg.la.xa("RS",this.Vsf);this.ua.p8e?wac_TY(this.$S,this.iba):this.gy.la.xa("CSC",this.p8c);this.ua.Go&&this.Kz.la.xa("SSC",this.q8c);this.ua.NAe&&wac_JSb(this.hY,this.lJa);this.Kz.la.xa("FOGTD",this.Fec);this.oua.Psa.xa("MU",this.Wee);wac_XF(this.zc,this.Eo);if(this.ua.zy&&this.Kke){var a=this;this.Kke.uc(function(b){wac_eNc(b,a.Bse)})}this.ua.s_d&&this.ua.D6a?
this.Ea.Yj?this.Ea.Yj.Msc&&1===this.Ea.Yj.Msc.length?this.Ea.Yj.p7a&&1===this.Ea.Yj.p7a.length?"62f939b6-93af-4db8-9c6b-d6c7dfdc589f"!==this.Ea.Yj.p7a[0].ThemeFamilyId?wac_Y(42300445,829,50,"Not Triggering NewDocument designer request, themeFamilyId is invalid"):(wac_Y(41705686,829,50,"Triggering NewDocument designer request"),wac_QGc(this,"NewDocument",null)):wac_Y(42300443,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters is invalid"):wac_Y(42300441,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes invalid"):
wac_Y(42300439,829,15,"Triggering NewDocument designer request failed, Presentation is null"):wac_Y(42766598,829,50,"Not Triggering NewDocument designer request, DesignerNewDocumentTriggerEnabled:{0}, IsCreateNew:{1}",this.ua.s_d,this.ua.D6a)}},Lf:function(){var a=this.ra.xc("EditingDesignerPanelFocus");a.Ba(wac_A(38,0),2687326703);a.Ba(wac_A(33,0),2687326703);a.Ba(wac_A(36,0),1396913978);a.Ba(wac_A(9,4),2958572984);a.Ba(wac_A(40,0),3353734008);a.Ba(wac_A(34,0),3353734008);a.Ba(wac_A(35,0),1860084563);
a.Ba(wac_A(9,0),3876507503);this.ua.zy&&(a=this.ra.xc("EditingIdeasPaneFocus"),a.Ba(wac_A(38,0),1560908614),a.Ba(wac_A(33,0),1560908614),a.Ba(wac_A(36,0),446576891),a.Ba(wac_A(9,4),477300127),a.Ba(wac_A(40,0),131484319),a.Ba(wac_A(34,0),131484319),a.Ba(wac_A(35,0),114500700),a.Ba(wac_A(9,0),2009705478),a.Ba(wac_A(37,0),407161026),a.Ba(wac_A(39,0),3690280729))},b2d:function(a,b,c,d,e){return this.ANe(this.Np,this.vHb,"EditingDesignerPanelFocus",c,a,e)},hAf:function(a,b,c,d,e){return e||!this.WNc.If()?
this.ANe(this.vHb,this.Np,"EditingIdeasPaneFocus",c,a,e):0},ANe:function(a,b,c,d,e,f){var g=this.Ea.Yj,g=!!this.Ea.Ja()&&!!g&&!this.Ib.Ac(g);if(this.ua.Go)var h=this.Xb.pe,g=!!(g&(!!h&&1===h.length));if(!g)return 16;if(!this.Ft.yx())return 8;if(1===d)return 32;f||wac_iN(this.ra,c,a.Se.If());b.Se.If()?a.Se.If()?a.Se.tr(!1,"CloseSecondPane"):(b=this.Ec.wLa()?this.Ec.wLa().SlideSuggestions.length:0,a.Se.tr(!0,null),a===this.Np&&this.Ec.wLa()&&!wac_km(this.Ec.wLa().SlideSuggestions)?(wac_47(a,3),wac_C0c(this.WX,
this.Ec.wLa(),b,b,this.Ec.Nd,wac_Z1b(a),!0)):a!==this.vHb||wac_km(this.Ec.DDe)?wac_47(a,2):(wac_47(a,3),wac_C0c(this.WX,this.Ec.wLa(),b,this.Ec.DDe.length,this.Ec.Nd,wac_Z1b(a),!0))):1894291367===e?wac_QGc(this,"ToolbarButtonHome",null):a.Se.If()?a.Se.tr(!1,"SuggestionPaneClosed"):(wac_QGc(this,2034521264===e?"ToolbarButtonHome":"ToolbarButton",null),a.Se.tr(!0,null));return 32},AYd:function(a,b,c,d,e){if(!wac_o0.isInstanceOfType(e)||!this.Ft.yx())return 8;wac_E(e,this.Se.If());return 32},jxd:function(a,
b,c,d,e){b=this.Ea.Yj;if(!this.Ea.Ja()||!b||this.Ib.Ac(b))return 16;d=null;var f=!0;wac_Ga.isInstanceOfType(e)?d=e:wac_fkc.isInstanceOfType(e)&&(d=e.cvd,f=!1);if(!this.Ft.yx()||!d)return 8;if(wac_D0c(this.Ft))return wac_Y(24514636,829,50,"DesignerActor::ApplyDesignerSuggestion - skipped when client refresh. CorrelationId: {0}, ActionId: {1}",d.CorrelationId,a),8;if(1===c)return 32;if(!wac_IJ(this.Xb)){if(1===wac_5M(this.Xb).length&&wac_5M(this.Xb)[0].gm)return wac_GL(this.Xb),wac_Y(36845449,829,15,
"DesignerActor::ApplyDesignerSuggestion - skipped when there are picture in crop mode. CorrelationId: {0}, ActionId: {1}",d.CorrelationId,a),8;wac_GL(this.Xb)}if(this.Ec.hva===d.SuggestionSid)return wac_Y(38580375,829,50,"DesignerActor::ApplyDesignerSuggestion - suggestion already applied, skipping. CorrelationId: {0}, SuggestionSid: {1}",d.CorrelationId,d.SuggestionSid),2;c=this.nb.je(15,0);try{this.ua.NAe&&(this.Ec.Rxe=new Date),c.lb(b),c.jr(a),wac_wN(b,wac__ua,d),this.Ec.hva=d.SuggestionSid,this.Ec.Dbc(!0),
wac_Y(22590804,829,50,"DesignerActor::ApplyDesignerSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",d.CorrelationId,a,d.SuggestionSid)}finally{c&&c.dispose()}this.ua.Vxe?this.Ib.cxa(b,this.Ea.Ja(),this.Lc.Cb(),a):this.Ib.Ns(b,a);this.Se.If()?this.ra.ff("EditingDesignerPanelFocus",!1):this.WNc.If()&&this.ra.ff("EditingIdeasPaneFocus",!1);f&&this.Ec.Cie();return 32},xMd:function(a,b,c){b=this.Ea.Yj;if(!this.Ea.Ja()||!b||this.Ib.Ac(b))return 16;if(!this.Ft.yx())return 8;if(1===c)return 32;
c=this.Ft;a:switch(a){case 3353734008:case 1860084563:case 3876507503:case 2687326703:case 1396913978:case 2958572984:c=c.Np;break;case 131484319:case 114500700:case 2009705478:case 1560908614:case 446576891:case 477300127:case 407161026:case 3690280729:c=c.vHb;break;default:c=null;break a}if(c)switch(b=c.Se,wac_Y(22590808,829,50,"DesignerManager::HandleSuggestionItemNavigation - ActionId: {0} in ViewState: {1}",a,wac_Z.p$a.toString(b.bA)),b.bA){case 3:if(c&&c.Se&&(b=document.activeElement)){var d=
b.getAttribute("suggestionIndex"),e=Sys.UI.DomElement.containsCssClass(b,"DesignerPaneCloseButton")||Sys.UI.DomElement.containsCssClass(b,"IdeasText"),f=wac_E0c(b)||b.className.startsWith("Editor");if(d||e||f)if(d=d?window.parseInt(d.toString()):-1,e=wac_T1b(c)-1,!(1>e))switch(f=c.Se,a){case 3353734008:case 131484319:wac_27(f,!1);d<e&&(c.gs(d,!1),c.gs(d+1,!0));break;case 1860084563:case 114500700:wac_27(f,!1);d!==e&&(c.gs(d,!1),c.gs(e,!0));break;case 3876507503:case 2009705478:a=c.Se;-1===d?a.U3e()?
a.dZc?(wac_27(a,!1),a.vdf()):c.gs(0,!0):(wac_27(a,!1),c.gs(0,!0)):d===e?(c.gs(d,!1),wac_27(a,!0)):(c.gs(d,!1),c.gs(d+1,!0));break;case 2687326703:case 1560908614:wac_27(f,!1);0<d&&(c.gs(d,!1),c.gs(d-1,!0));break;case 1396913978:case 446576891:wac_27(f,!1);d&&(c.gs(d,!1),c.gs(0,!0));break;case 2958572984:case 477300127:a=c.Se;0<d?(c.gs(d,!1),c.gs(d-1,!0)):-1===d?a.dZc?(wac_27(a,!1),c.gs(e,!0)):a.U3e()&&wac_27(a,!0):(c.gs(0,!1),a.U3e()?a.vdf():wac_27(a,!0));break;case 407161026:case 3690280729:if(wac_F0c.isInstanceOfType(c))if(a=
3690280729===a,c=c.Se,wac_E0c(b)){if(b=document.activeElement)Sys.UI.DomElement.containsCssClass(b,"mivOverlayContainer")?(b=window.parseInt(b.getAttribute("mivIdx").toString())+1,a?6!==b?wac_G0c(c,b+1):wac_G0c(c,1):1!==b?wac_G0c(c,b-1):wac_G0c(c,6)):a?wac_G0c(c,1):wac_G0c(c,6)}else if(b.className.startsWith("Editor")&&(f=document.activeElement)){b=wac_F0c.Xvf;for(d=0;!Sys.UI.DomElement.containsCssClass(f,b[d]);)if(d++,d===b.length){d=-1;break}e=document.querySelectorAll(".EditorSuggestionContainer").length;
"EditorSuggestionContainer"!==b[d]?a?d!==b.length-1&&-1!==d?"EditorSuggestionContainer"!==b[d+1]?wac_H0c(b[d+1],c):wac_I0c(c,0):wac_H0c(b[0],c):d&&-1!==d?"EditorSuggestionContainer"!==b[d-1]?wac_H0c(b[d-1],c):wac_I0c(c,e-1):wac_H0c(b[b.length-1],c):(f=window.parseInt(f.getAttribute("editorSuggestionIdx").toString()),a?f!==e-1?wac_I0c(c,f+1):wac_H0c(b[d+1],c):f?wac_I0c(c,f-1):wac_H0c(b[d-1],c))}}}break;case 2:c&&(b=c.Se,3876507503===a||2958572984===a)&&(a=!!c.BS.querySelector(".DesignerNoSuggestionView-Link:focus"),
wac_27(b,a),c=c.BS.querySelector(".DesignerNoSuggestionView-Link"),a?c.blur():c.focus())}return 32},Beb:function(a,b,c,d,e){if("IdeasPaneClosed"===e.ztb&&this.Se.If()||wac_J0c(this.Ft))return 0;wac_RGc(this,e.Y0c,e.ztb);return 32},xyf:function(a,b){b.ncf.or(this.Ec.N7d);wac_K0c(this,b.ncf,b.wbf,b.Ls,b.fM,b.Nd,-1);b.bjf&&(this.OXe||this.Ec.Bld.Ma()||wac_L0c(this,b.fM,b.wbf))},Dda:function(a,b){(a=this.Ea.Ja())&&b.mg.Ka(wac_kJ(a))&&(this.Ft.Pfb(b.Stb,b.J9b),wac_J0c(this.Ft)&&!this.Ft.yx()&&(wac_Y(22680479,
829,50,"DesignerActor::OnSlidePresenceChanged - More than two users in same slide and close opened designer pane. In the slide user count:{0}, presentation user count:{1}, CorrelationId:{2}",b.Stb,b.J9b,this.Ec.Nd),this.Se.tr(!1,"CoAuth"),this.WNc.tr(!1,"CoAuth")),this.ua.zy&&wac_5nc(this.Ec)&&(this.ua.c5e||0<this.Ft.Y_a?this.Ft.yx()||wac_M0c(this.Ft,this.Ec.Nd,"NoResult",null,""):wac_QGc(this,"Refresh",null)))},MBd:function(a,b){if(b.Epc){var c;a=(c=new wac_VY,c.Ls=wac_kJ(b.Epc),c);this.U.os(4236240734,
2,a,null);this.Ft.Pfb(a.h8a,a.Irc);if(wac_J0c(this.Ft)||wac_5nc(this.Ec))wac_Y(22853506,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - Slide changed when Designer pane is opened. CorrelationId:{0}",this.Ec.Nd),this.Ft.yx()&&this.ua.Akc&&!wac_jJ(b.Epc)?wac_QGc(this,"SlideNavigationDesignMode",null):wac_jJ(b.Epc)&&this.ua.vme&&(this.WNc.If()||wac_5nc(this.Ec))||(this.Se.tr(!1,"SlideNavigation"),this.WNc.tr(!1,"SlideNavigation"),this.ua.zy&&wac_M0c(this.Ft,this.Ec.Nd,"NoResult",null,""))}else wac_Y(24463122,
829,50,"DesignerActor::DesignerTargetSlideChangedHandler - active slide was null. CorrelationId:{0}",this.Ec.Nd)},KBd:function(){this.Ft.yx()||(this.Se.If()&&this.Se.tr(!1,"CoAuthDisabled"),this.WNc.If()&&this.WNc.tr(!1,"CoAuthDisabled"))},TUd:function(a,b){wac_UGc(this,b);wac_Y(36966411,829,15,"DesignerActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",a.HttpStatusCode);return!0},LBd:function(){if(wac_J0c(this.Ft)){var a=this.Xb.pe;a&&1<a.length&&(wac_Y(25968672,
829,50,"DesignerActor::DesignerSlidesSelectionChangedHandler - More than one slides are selected, close the opened designer pane."),this.Se.If()&&this.Se.tr(!1,"MultiSlidesSelected"),this.WNc.If()&&this.WNc.tr(!1,"MultiSlidesSelected"))}},oQa:function(a,b){a=this.Ec.Rxe;var c=this.ua.Vxe?"UnblockContentWhenDraw":"SessionRehydrated";a&&window.$$as(String,b.hme)===c&&(this.Ec.t9d.ga(String.format("{0}:{1}:{2}",this.Ec.hva,a-this.Ec.Qtd,new Date-a)),this.Ec.Rxe=null)},ju:function(){wac_Y(40379151,829,
50,"DesignerManager::OnSessionRehydrated - refreshing due to failover");wac_QGc(this,"Refresh",{FailoverOccurred:!0})},KPd:function(a,b){wac_VGc(this,b.Ii,b.uDb.Dea)},rCe:function(a,b){if(b.MKa&&wac_mwc(b.Ii)){a={};if(b.R4){var c;c=wac_mE(b.R4.toString()).toString();(c=wac_1uc(wac_sE,"RevisionId",c))&&1===c.length&&(a.ActionStartTime=c[0].py)}wac_VGc(this,b.Ii,a)}},xwf:function(a,b,c,d,e){switch(a){case 3180693624:return Array.add(this.Ec.xSd,e),32;case 39851908:return Array.remove(this.Ec.xSd,e),
32;default:return 2}},o1e:function(){wac_QGc(this,"Refresh",{UndoRedo:!0});return 32},mve:function(a,b){a=this.Ec;var c=b.roe;if(c){b=[];for(var d=new (wac_e.$$(Number,wac_N0c)),c=c.critiques,e=c.length,f=0;f<e;++f){var g=c[f],h=g.bucketId,k=d.K(h);k||(k=new wac_N0c(h),d.vf(h,k),b.push(k));k.WTe.push(g)}a.azc=b}}};
function wac_O0c(a,b,c,d){if(a.ua.Sif&&a.qBe){wac__Gc(a,c);d||(d={});var e=new Date;wac_A_c(a.qBe,a.ua.Ljf,a.ua.Uif).then(function(f){d.FetchAuthTokenDuration=new Date-e;f.IsSuccess?d.ServiceTicket=f.Token:wac_Y(42324814,829,15,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth Failed to get AAD token with error: "+f.ErrorCode+": "+f.ErrorMessage);wac_WGc(a,b,c,d)}).catch(function(f){wac_Y(42295842,829,10,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth - Token retrival failed:{0}",
f);d.FetchAuthTokenFailureDuration=new Date-e;wac_WGc(a,b,c,d)})}else wac_WGc(a,b,c,d)}
function wac_WGc(a,b,c,d){a.H6b&&(a.pb.Rg(a.H6b),a.H6b=null);var e=wac_XGc(a,c,d);wac_YGc(a,e)?wac_ZGc(a.Ec,a.Ea.Ja().Vc())?(wac__Gc(a,e.Eea),wac_0Gc(a,function(){wac_O0c(a,b,c,d)})):(wac_Y(40379161,829,50,"trigger: {0}; sid: {1}; correlationId: {2}",e.Eea,e.LCe,e.ncc),a.Ec.Nd&&!Array.contains(a.Ec.QFa,a.Ec.Nd)&&wac_RGc(a,wac_J0c(a.Ft),e.Eea),a.Ec.hud=new Date,a.Ec.o9d(e.ncc),a.Ec.HAe=e.Eea,wac_1Gc(a,e)?wac_P0c(a.Ec,e.PGe.ActionStartTime):wac_P0c(a.Ec,new Date),b(e),wac__Gc(a,e.Eea),wac_M0c(a.Ft,
e.ncc,"Pending",null,"")):(wac_Y(40379163,829,50,"Designer call not currently allowed for trigger {0}",c),a.Se.tr(!1,"DisallowedRequest"),a.WNc.tr(!1,"DisallowedRequest"))}function wac__Gc(a,b){var c="Typing"===b?4:1;("ToolbarButton"===b||a.Se.If())&&wac_47(a.Np,c);("ToolbarButtonHome"===b||a.WNc.If())&&wac_47(a.vHb,c)}
function wac_1Gc(a,b){if(!(a.ua.nOe&&"ActionStartTime"in b.PGe&&b.PGe.ActionStartTime))return!1;switch(b.Eea){case "ToolbarButton":case "ToolbarButtonHome":case "SlideNavigationDesignMode":case "NewDocument":return!1;case "Refresh":return!("FailoverOccurred"in b.PGe)||!("UndoRedo"in b.PGe);default:return!0}}
function wac_YGc(a,b){var c;if(!(c=!b||!b.LCe)){a:switch(b.Eea){case "ToolbarButton":case "ToolbarButtonHome":case "InsertPicture":case "SlideChangeLayout":case "ChangeSlideSize":case "ApplyTheme":case "PasteTable":case "NewDocument":case "ApplyReplaceObject":c=!0;break a;default:c=!1}c=!c&&!wac_J0c(a.Ft)&&!wac_5nc(a.Ec)}if(c)return!1;switch(b.Eea){case "ToolbarButton":case "InsertPicture":case "ApplyTheme":return!0;case "Typing":return a.ua.Y5a&&wac_Q0c(a,!1);case "SlideNavigationDesignMode":return a.ua.Akc;
case "SlideChangeLayout":return a.ua.wkc;case "Retrigger":return a.ua.zkc&&a.Ec.YT;case "ChangeSlideSize":case "DesignElementsDeleted":return a.ua.xkc;case "ToolbarButtonHome":return a.ua.zy&&(!Array.contains(a.Ec.QFa,a.Ec.Nd)||!a.Ec.Nd);case "InsertTable":return a.ua.aFe;case "PasteTable":return a.ua.LAe||a.ua.KAe;case "NewSlide":return a.ua.vme&&(wac_5nc(a.Ec)||a.WNc.If());case "ApplyReplaceObject":case "ChangeIconInSmartArt":case "ChangeIcon":return a.ua.qUe;case "Refresh":return b=b.PGe,a.ua.wme&&
(wac_5nc(a.Ec)||a.WNc.If())||"FailoverOccurred"in b&&b.FailoverOccurred||"UndoRedo"in b&&b.UndoRedo;case "NewDocument":return a.ua.s_d&&a.ua.D6a;default:return wac_Y(40379159,829,15,"invalid trigger: {0}",b.Eea),!1}}
function wac_XGc(a,b,c){var d=a.Ea.Ja();if(!d)return null;var e;e=new wac_2Gc;e.Eea=b;e.LCe=d.Vc();e.GGe=d.fe();c=c||{};a.ua.s_d&&"NewDocument"===b&&(c.EnableFullSizeSuggestedPictures="true");a.ua.tbf&&(c.SupportCustomTheme=a.ua.rbf?a.oqf:!0);a.ua.CZc&&(c.IncrementalRender=!0);a.ua.c5e&&(c.DesignerSameSlideIdleCoauthEnabled=!0,0<a.Ft.Y_a&&(c.CoauthCountInSlide=a.Ft.Y_a));if(a.ua.zy&&(c.NewPaneEnabled=!0,b=!wac_km(a.Ec.azc),c.RequestForEditorCardsForNewIdeasPane=b)){b=0;a=a.Ec.azc;for(var d=a.length,
f=0;f<d;++f)for(var g=a[f].WTe,h=g.length,k=0;k<h;++k)b+=g[k].suggestions.length;c.NumEditorCritiques=b}return e.PGe=c,e}function wac_0Gc(a,b){a.ELe<a.ua.YSe?a.pb.Hb(new wac_D(2,1,1E3,function(){wac_Y(40379155,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",a.Ec.Nd);a.Exe=wac_PGc();a.ELe++;b()},0,"RetryRequestOnWait",!1)):wac_Y(40379157,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",a.Ec.Nd)}
function wac_QGc(a,b,c){"ToolbarButtonHome"===b&&a.Ec.Nd&&!Array.contains(a.Ec.QFa,a.Ec.Nd)||wac_O0c(a,function(c){function e(){wac_QGc(a,a.L0a.Eea,a.L0a.SUe)}if(a.ua.MAe){if(a.Exe.bEe&&new Date-a.Exe.k_c<a.ua.bFe){a.L0a=new wac_SGc;a.L0a.LCe=c.LCe;a.L0a.GGe=c.GGe;a.L0a.Eea=c.Eea;a.L0a.SUe=c.PGe;wac_Y(40379153,829,50,"prior request in progress, marking current request as next pending. next trigger: {0}; next sid: {1}",b,c.LCe);return}a.Exe=wac_TGc();a.L0a=null}a.kf.HG(c.GGe,c.LCe,c.ncc,c.Eea,null,
JSON.stringify(c.PGe),function(b){b&&2===b.Status?wac_0Gc(a,function(){wac_QGc(a,c.Eea,c.PGe)}):a.ELe=0;a.ELe||wac_UGc(a,e)},function(b){return a.TUd(b,e)})},b,c)}
function wac_VGc(a,b,c){var d;a:switch(b){case 397517337:case 1234776651:case 3353734008:case 1860084563:case 3876507503:case 2687326703:case 1396913978:case 2958572984:case 131484319:case 114500700:case 2009705478:case 1560908614:case 446576891:case 477300127:case 407161026:case 3690280729:case 3078715862:d=!0;break a;case 123670621:case 4177849452:case 2665249088:case 3019226676:case 3270113035:case 2814941514:case 3409991090:case 565697619:d=!a.Ec.YT;break a;default:d=!1}if(!d){var e=function(b){var c=
{};c.Timestamp=b.SEc;c.CorrelationId=b.ncc;c.Trigger=b.Eea;c.Sid=b.LCe;c.Cid=b.GGe;c.Hints=b.PGe;b=wac_kO(a.nb,4,null,null,!1);try{b.lb(a.Ea.Yj);b.jr(3078715862);var d=JSON.stringify(c);wac_v(a.Ea.Yj,wac_9Db,d)}finally{b&&b.dispose()}},f=wac_3Gc(b,c);if(d=wac_4Gc(a,f,b,c))c||(c={}),c.ElementSource=d;if(wac_mwc(b)&&wac_Q0c(a,!0)){a.H6b&&a.pb.Rg(a.H6b);(wac_5nc(a.Ec)||a.WNc.If())&&wac_M0c(a.Ft,a.Ec.Nd,"Pending",null,"");var g=a.Se.If();!a.ua.sbf&&g&&a.Se.tr(!1,"DisallowedRequest");wac_Q0c(a,!1)&&wac__Gc(a,
"Typing");a.H6b=new wac_D(2,1,a.ua.pyb,function(){g&&wac_Y(42320064,829,50,"Potential candidate for typing refresh request for designer pane");a.Ea.Ja()&&wac_Q0c(a,!1)&&wac_O0c(a,e,f,c)},0,"DesignerTypingRefreshTask",!1);a.pb.Hb(a.H6b)}else wac_O0c(a,e,f,c)}}
function wac_3Gc(a,b){switch(a){case 1110240549:case 1685987254:case 2948423841:case 1124275563:case 934858027:return"InsertPicture";case 2995632670:case 1850078116:case 3796917740:return b&&b.HasNewPicture?"InsertPicture":b&&b.HasNewTable?"PasteTable":"";case 2963456035:case 2759977169:case 841042441:return"ApplyTheme";case 4017322732:return"SlideChangeLayout";case 529839080:case 100917881:case 1045213174:case 991302939:case 410316994:return b&&"HasDesignElements"in b&&b.HasDesignElements?"ChangeSlideSize":
"Refresh";case 868006456:case 4198410725:return b&&"HasDesignElements"in b&&b.HasDesignElements?"DesignElementsDeleted":"Refresh";case 123670621:case 4177849452:case 2665249088:case 3019226676:case 3270113035:case 2814941514:case 3409991090:case 565697619:return"Retrigger";case 2423756553:case 1296122996:case 1800138055:case 910012865:case 1991549851:case 3300418813:case 4089132864:case 134426873:case 1534685076:case 2219070986:case 1974018626:case 249647848:case 2677509403:case 4262591775:case 506982572:case 2887293604:case 1854371976:case 1460660268:case 3398225082:case 110395433:return"Typing";
case 844437181:return"PasteTable";case 67272282:return"InsertTable";case 3455582195:case 4229337931:case 830497217:case 3006547192:return"NewSlide";case 4041021629:return"ApplyReplaceObject";case 1095764407:return"ChangeIconInSmartArt";case 1488343741:return"ChangeIcon";default:return"Refresh"}}
function wac_4Gc(a,b,c,d){if("InsertPicture"!==b&&"PasteTable"!==b)return null;var e=null,f=!1,g=!1;d&&d.HasNewPicture?f=!0:d&&d.HasNewTable&&(g=!0);switch(c){case 1850078116:case 3796917740:e=f?"PastedExternalPicture":g?"PastedExternalTable":null;break;case 2995632670:e=f?"PastedInternalPicture":g?"PastedInternalTable":null;break;case 1110240549:e="FromFile";break;case 1685987254:case 2948423841:e="Online";break;case 934858027:e="Icon"}e||wac_Y(41182167,829,50,"DesignerActor::MapActionIdToElementSource - Unexpected NULL ElementSource. Trigger: {0}, ActionId: {1}, CorrelationId: {2}",
b,c,a.Ec.Nd);delete d.HasNewPicture;delete d.HasNewTable;return e}function wac_UGc(a,b){a.ua.MAe&&(a.Exe=wac_PGc(),a.L0a&&(wac_J0c(a.Ft)||wac_5nc(a.Ec)?(wac_Y(39413843,829,50,"DesignerActor::OnTaskComplete - sending pending request for triger {0}, sid: {1}",a.L0a.Eea,a.L0a.LCe),b()):a.L0a=null))}function wac_R0c(a){a.OXe&&(a.pb.Rg(a.OXe),a.OXe=null)}
function wac_S0c(a,b,c,d){var e={};e.MissingDesignerCardIndexes=a.Ec.Bld.xe().join(",");a.OXe=new wac_D(0,1,0,function(){a.kf.HG(b.fe(),b.Vc(),d,c,null,JSON.stringify(e),function(){wac_Y(42259678,829,50,"DesignerActor::TryFetchMissingDesignerCardsAsync - request successfully sent for fetch missing Designer indexes {0} for correlationId: {1}",e.MissingDesignerCardIndexes,d)},function(a){wac_Y(42259680,829,15,"DesignerViewHelper:FetchMissingDesignerCardsAsync - request failed for fetch missing Designer indexes {0} with response: {1}. returning true to prevent ACE",
e.MissingDesignerCardIndexes,a.HttpStatusCode);return!0})},0,"FetchMissingDesignerCardsTask",!1);a.pb.Hb(a.OXe)}function wac_K0c(a,b,c,d,e,f,g){if(a.Ec.N7d.Ma()===c)wac_R0c(a);else if(b&&b.Ma()&&!(0<a.Ec.Bld.Ma())){if(-1===g)for(var h=b.$$lge();h.$$mn();){var k=h.$$cu();k>g&&(g=k)}for(h=0;h<c&&(b.Ge(h)||a.Ec.Bld.Ge(h)||a.Ec.Bld.ga(h),h!==g||a.Ec.Bld.Ma());h++);0<a.Ec.Bld.Ma()&&wac_S0c(a,d,e,f)}}
function wac_L0c(a,b,c){wac_R0c(a);var d=wac_kJ(a.Ea.Ja()),e=a.Ec.Nd;a.OXe=new wac_D(2,1,a.ua.Xkf,function(){Array.contains(a.Ec.QFa,e)||wac_K0c(a,a.Ec.N7d,c,d,b,e,c)},0,"CheckAndFetchMissingDesignerCardsTask",!1);a.pb.Hb(a.OXe)}function wac_T0c(a,b){a.ua.zy&&(b.IdeasMivShown=a.Ec.t8e,b.IdeasMivDrillIn=a.Ec.Pbf,b.IdeasEditorShown=a.Ec.j8e,b.IdeasEditorKept=a.Ec.i8e,b.IdeasEditorDrillIn=a.Ec.Wif,b.AnyCardShown=a.Ec.j8e||a.Ec.t8e||0<a.Ec.dDe.Ma(),b.AnyCardKept=a.Ec.i8e||a.Ec.YT)}
function wac_RGc(a,b,c){if(!Array.contains(a.Ec.QFa,a.Ec.Nd)){var d=wac_D0c(a.Ft)?a.Ec.PCb:a.Ec.Nd,e={};e.CachedTrigger=a.Ec.HAe;e.SuggestionSlideId=a.Ec.hva.toString();e.AppliedSuggestion=a.Ec.YT;e.DisplaySuggestionsTimeoutInMs=15E3;e.SuggestionsTimeout=a.Ec.JAb;e.ClientAbort=a.Ec.tzb||wac_U0c(a.Ft);e.DesignerPaneClosed=b;e.ResetReason=c;e.HoverPreviewDesignerTriggered=a.Ec.fhe;a.ua.tbf&&(e.SupportCustomTheme=!0);b=wac_Hd(wac_.pa.Qb.SessionStartInfoJson.toString());var f={};f.ClientOS=b.Os;f.Browser=
b.Browser||"";f.BrowserVersion=b.BrowserVersion||"";f.BrowserMajorVersion=b.BrowserMajorVersion||"";f.BrowserMinorVersion=b.BrowserMinorVersion||"";a.Ec.hud&&a.Ec.Qtd&&a.Ec.Qtd>a.Ec.hud&&(f.SuggestionsE2ETimeMs=a.Ec.Qtd-a.Ec.hud);a.ua.CZc&&(wac_V0c(a.WX),wac_R0c(a),e.IncrementalRender=!0,f.VisibleSuggestionsCount=a.Ec.s3e,0<a.Ec.g5e.Ma()&&(f.IncrementalRenderTimeoutIndexes=a.Ec.g5e.xe().join(",")),0<a.Ec.Bld.Ma()&&(f.MissingDesignerCardIndexes=a.Ec.Bld.xe().join(",")),0<a.Ec.dDe.Ma()&&(f.CardIndexes=
a.Ec.dDe.xe().join(",")),0<a.Ec.N7d.Ma()&&(f.DesignerCardIndexes=a.Ec.N7d.xe().join(",")),a.Ec.oVc&&(a.Ec.m5e&&a.Ec.m5e>a.Ec.oVc&&(f.MissingDesignerCardsReceivedTime=a.Ec.m5e-a.Ec.oVc),a.Ec.a5e&&a.Ec.a5e>a.Ec.oVc&&(f.AllIncRenderReceivedTime=a.Ec.a5e-a.Ec.oVc),a.Ec.F3e&&a.Ec.F3e>a.Ec.oVc&&(f.VisibleIncRenderReceivedTime=a.Ec.F3e-a.Ec.oVc)));wac_T0c(a,f);e.BrowserData=f;a.Ec.oVc&&a.Ec.Qtd&&a.Ec.Qtd>a.Ec.oVc&&(e.TimeToDisplaySuggestionsInMs=a.Ec.Qtd-a.Ec.oVc);a.Ec.oDb&&a.Ec.v8a&&(e.TimeSuggestionsRendered=
a.Ec.oDb.toUTCString());a.Ec.v8a&&(e.TimeDesignerPaneClosed=a.Ec.v8a.toUTCString());a.Ec.t9d&&0<a.Ec.t9d.Ma()&&(e.AppliedSuggestionHis=a.Ec.t9d.xe().join(" "));b=b.Flights||[];0<b.length&&(e.ClientFlights=b.join(";"));a.kf.Beb(d,JSON.stringify(e),null,function(){return!0});a.ua.zy&&wac_M0c(a.Ft,d,"SuggestionPaneClosed"===c||"SuggestionsLoadingTimeout"===c||"NoSuggestion"===c||"DisallowedRequest"===c?"NoResult":"Pending",null,"");wac_5Gc(a.Ec,d);wac_Y(22590806,829,50,"DesignerActor::ReportSuggestionSessionInfo - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",
c,d)}}function wac_Q0c(a,b){return(a.ua.sbf||b)&&a.Se.If()||wac_5nc(a.Ec)||a.WNc.If()}function wac_6Gc(){}function wac_TGc(){var a=new wac_6Gc;a.bEe=!0;a.k_c=new Date;return a}function wac_PGc(){var a=new wac_6Gc;a.bEe=!1;a.k_c=null;return a}wac_6Gc.prototype={bEe:!1,k_c:null};function wac_SGc(){}wac_SGc.prototype={LCe:0,GGe:0,Eea:null,SUe:null};function wac_2Gc(){this.SEc=new Date;this.ncc=wac_5k().toString()}wac_2Gc.prototype={SEc:null,ncc:null,Eea:null,LCe:0,GGe:0,PGe:null};
function wac_W1b(a){this.QFa=[];this.xSd=[];this.FWc=a;this.t9d=new (wac_g.$$(String));this.dDe=new (wac_g.$$(Number));this.N7d=new (wac_g.$$(Number));this.g5e=new (wac_g.$$(Number));this.Bld=new (wac_g.$$(Number));this.s3e=1}
wac_W1b.prototype={QFa:null,xSd:null,FWc:null,azc:null,e0a:null,hva:0,Nd:null,o9d:function(a){return this.Nd=a},PCb:null,HAe:null,YT:!1,Dbc:function(a){return this.YT=a},JAb:!1,tzb:!1,oDb:null,v8a:null,Cie:function(){this.lRb(2,4)},lRb:function(a,b){this.FWc&&this.FWc.uc(function(c){var d,e=(d=new wac_jkc,d.cardId="EntityGroup.Designer.Slide.Suggestion",d.actionType=a,d.actionEngagement=b,d);c.Cfe(e)})},fhe:!1,hud:null,Qtd:null,m5e:null,t9d:null,Rxe:null,oVc:null,a5e:null,F3e:null,s3e:0,dDe:null,
N7d:null,g5e:null,Bld:null,RD:null,wLa:function(){return this.RD},n3e:function(a){return this.RD=a},DDe:null,mDc:0,j8e:!1,i8e:!1,Wif:!1,t8e:!1,Pbf:!1};function wac_W0c(a,b){a.mDc=b}function wac_X0c(a,b){a.DDe=b}function wac_P0c(a,b){a.oVc=b}function wac_ZGc(a,b){return Array.contains(a.xSd,b)}
function wac_5Gc(a,b){Array.contains(a.QFa,b)||(Array.add(a.QFa,b),wac_Y(22853508,829,50,"DesignerContext::AddCurrentSuggestionToClosedList - CorrelationId:{0}, ClosedSuggestionListLength:{1}",b,a.QFa.length));a.Nd="";a.hva=0;a.HAe="";a.YT=!1;a.JAb=!1;a.tzb=!1;a.v8a=null;a.fhe=!1;a.hud=null;a.Qtd=null;a.m5e=null;a.Rxe=null;a.t9d.ie();a.oVc=null;a.a5e=null;a.F3e=null;a.s3e=1;a.dDe.ie();a.N7d.ie();a.g5e.ie();a.Bld.ie();a.RD=null;a.DDe=null;a.mDc=0;a.j8e=a.i8e=a.t8e=a.Pbf=!1}
function wac_5nc(a){var b=!1;(a=a.FWc.Ga())&&(b=a.Q9d());return b}function wac_N0c(a){this.Hvf=a;this.WTe=[]}wac_N0c.prototype={Hvf:0,WTe:null};
function wac_X1b(a,b,c,d,e,f,g,h,k,l,m,n,p){this.xif=Function.createDelegate(this,this.Wyf);this.wkd=Function.createDelegate(this,this.bUd);this.Xfd=Function.createDelegate(this,this.IOd);this.Qgc=Function.createDelegate(this,this.FUd);this.Fgf=new (wac_ta.$$(String));this.dispose=this.O;this.vHb=a;this.Np=b;this.WX=c;this.Ec=d;this.ua=e;this.U=f;this.Ea=g;this.nb=h;this.Qg=k;this.ra=l;this.Y_a=this.X_a=0;this.Y2=m;this.mVc=n;this.U4e=p;this.JQ()}
wac_X1b.prototype={vHb:null,Np:null,WX:null,Ec:null,ua:null,U:null,Ea:null,nb:null,Qg:null,ra:null,Y2:null,mVc:null,X_a:0,Y_a:0,U4e:null,JQ:function(){this.Qg.la.xa("SU",this.Qgc);this.Qg.la.xa("DSCM",this.Xfd);var a=this;this.mVc.uc(function(b){b.Jwd(a.wkd,function(){var b=a.Np;b&&wac_47(b,3)})});this.ua.CZc&&this.Qg.la.xa("UBUP",this.xif)},O:function(){this.Qg.la.sb("SU",this.Qgc);this.Qg.la.sb("DSCM",this.Xfd);this.ua.CZc&&this.Qg.la.sb("UBUP",this.xif)},Iue:function(a,b){if(this.ua.Cka&&(this.Np.Se.If()||
this.vHb.Se.If()||wac_5nc(this.Ec))){if(b&&(397517337===a||1234776651===a)){this.Ec.hva=0;b=this.Ea.Yj;var c=wac_kO(this.nb,7,null,null,!0);try{c.lb(b),this.ua.Vif&&c.jr(a),wac_he(b,wac__ua)}finally{c&&c.dispose()}}wac_Y0c(this.WX,wac_Z1b(this.Np));wac_Y0c(this.WX,wac_Z1b(this.vHb));this.ua.ykc&&397517337!==a&&1234776651!==a&&this.U.yw(1170549389,2,null)}},yx:function(){return this.ua.Cka&&(this.ua.p8e||!(0<this.X_a))&&(this.ua.c5e||!(0<this.Y_a))},IOd:function(a,b){a=b.Ls;wac_Y(23089489,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Others is editing in slide sid: {0}",
a.Vc());if((b=this.Ea.Ja())&&wac_kJ(b).Ka(a)){b="unopened";wac_J0c(this)&&(this.ua.c5e?(this.Np.Se.If()&&(b=this.Np)&&wac_47(b,5),this.vHb.Se.If()&&(b=this.vHb)&&wac_47(b,5),b="set to SameSlideCoauthNoSuggestion UI"):(this.Np.Se.tr(!1,"CoAuth"),this.vHb.Se.tr(!1,"CoAuth"),b="force closed"));var c="unopened";this.ua.zy&&wac_5nc(this.Ec)&&(wac_M0c(this,this.Ec.Nd,"NoResult",null,""),c="closed");"unopened"===b&&"unopened"===c||wac_Y(23089491,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Designer pane state: {0}. Designer card in Ideas pane state: {1}. Slide sid:{2}, cid:{3}, CorrelationId:{4}, CoauthCountInPresentation:{5} and CoauthCountInSlide:{6}.",
b,c,a.Vc(),a.fe(),this.Ec.Nd,this.X_a,this.Y_a)}},FUd:function(a,b){wac_Y(22647391,829,50,"DesignerManager::OnSuggestionsUpdated - IsDesignerEnabled:{0}, IsDesignerSameDeckCoauthEnabled:{1}, CoauthCountInPresentation:{2}, CoauthCountInSlide:{3}, correlationId:{4}; trigger: {5}",this.ua.Cka,this.ua.p8e,this.X_a,this.Y_a,b.Nd,b.fM);if(this.yx()){if(a=this.Ea.Ja())if(b.Ls.Ka(wac_kJ(a)))if(Array.contains(this.Ec.QFa,b.Nd))wac_Y(22618318,829,50,"DesignerManager::OnSuggestionsUpdated - CorrelationId is in closed suggestion list. CorrelationId:{0}",
b.Nd);else if(this.Fgf.Ge(b.Nd))wac_Y(41694935,829,50,"DesignerManager::OnSuggestionsUpdated - User began to upload picture during incremental rendering, so ignore further suggestions for this CorrelationId. CorrelationId:{0}",b.Nd);else{this.Ec.Nd!==b.Nd&&(wac_5Gc(this.Ec,b.Nd),wac_Y(42021664,829,50,"DesignerManager::OnSuggestionsUpdated - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.Ec.Nd,b.Nd));if(this.Ec.Nd===b.Nd&&this.Np.Se.If()&&3===this.Np.Se.bA||
this.vHb.Se.If()&&3===this.vHb.Se.bA){var c=this;if(this.ua.CZc&&wac_QZa(b.s5e.xe(),function(a){return 0<=c.Ec.Bld.DJd(a)}))this.Ec.m5e=new Date,wac_Y(42342610,829,50,"DesignerManager::OnSuggestionsUpdated - Notification for missing Designer cards successfully received. CorrelationId: {0}, Received indexes: {1}, Missing indexes {2}",b.Nd,b.s5e.toString(),this.Ec.Bld.toString());else if(a=b.ilf,!this.ua.CZc||this.Ec.N7d.Ge(a)){wac_Y(22618320,829,50,"DesignerManager::OnSuggestionsUpdated - Duplicated Designer card notification. CorrelationId: {0}, StartIdx: {1}",
b.Nd,a.toString());return}}if((a=wac_Z0c(b.OT))&&!this.Ec.wLa()){var d;this.Ec.n3e((d=new wac_Fua,d.CardData=a.CardData,d.SlideSuggestions=Array(b.Bbf?b.iGe:b.klf),d))}if(a&&!wac_km(a.SlideSuggestions)){d=a.SlideSuggestions;for(var e=d.length,f=0;f<e;++f){var g=d[f];this.Ec.wLa().SlideSuggestions[g.Index]=g}}a&&this.ua.zy&&!this.Ec.DDe&&wac_X0c(this.Ec,wac__0c(a));wac_00c(this,b);!this.Np.Se.If()&&this.vHb.Se.If()||wac_10c(this,this.Np,b,a,b.iGe,b.iGe);this.vHb.Se.If()&&wac_10c(this,this.vHb,b,a,
b.iGe,wac_km(this.Ec.DDe)?b.iGe:this.Ec.DDe.length)}else wac_Y(22618322,829,50,"DesignerManager::OnSuggestionsUpdated - current slide node is different to suggestion slide node. CorrelationId:{0}",b.Nd)}else wac_Y(22618316,829,50,"DesignerManager::OnSuggestionsUpdated - Designer is not enabled. CorrelationId:{0}",b.Nd)},Pfb:function(a,b){this.Y_a=a;this.X_a=b;wac_0L(this.Qg,new wac_XL(1))},Wyf:function(){this.Np.Se.If()&&3===this.Np.Se.bA&&(this.Fgf.ga(this.Ec.Nd),wac_47(this.Np,1));this.vHb.Se.If()&&
3===this.vHb.Se.bA&&(this.Fgf.ga(this.Ec.Nd),wac_47(this.vHb,1))},bUd:function(a){this.Np.Se.Bdf();wac_C0c(this.WX,this.Ec.wLa(),a.suggestions.length,a.suggestions.length,a.correlationId,wac_Z1b(this.Np),!0);wac_iN(this.ra,"EditingDesignerPanelFocus",!0)}};function wac_U0c(a){return 1===a.Np.Se.bA||1===a.vHb.Se.bA}function wac_D0c(a){return 4===a.Np.Se.bA||4===a.vHb.Se.bA}function wac_J0c(a){return a.Np.Se.If()||a.vHb.Se.If()}
function wac_M0c(a,b,c,d,e){a.ua.zy&&a.Y2.uc(function(a){var g=new wac_ppb;g.correlationId=b;if(d){var h;b:{var k=[];try{if(!d||!d.SlideSuggestions){wac_Y(39338643,829,50,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - no slide suggestions to parse");h=k;break b}for(h=0;h<d.SlideSuggestions.length;h++){var l=d.SlideSuggestions[h].Base64Img,m;Array.add(k,(m=new wac_npb,m.suggestionIndex=d.SlideSuggestions[h].Index.toString(),m.suggestionSid=d.SlideSuggestions[h].SlideSid.toString(),m.imageData=
l.startsWith("data:image")?l:"data:image/png;base64,"+l,m.label=String.format(ResourceStrings.l_DesignerSuggestionItem,h+1),m))}}catch(n){wac_Y(39338645,829,10,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions")}h=k}g.suggestions=h}else wac_Y(39977434,829,50,"Designermanager:ParseSlideSuggestionNotificationData - no suggestions to parse");!e||(g.trigger=e);a.YMd(c,g)})}
function wac_20c(a,b,c){return c.If()||!wac_5nc(a.Ec)&&"NewSlide"!==b&&"ChangeIconInSmartArt"!==b&&"ChangeIcon"!==b}function wac_00c(a,b){b.Bbf?(wac_km(a.Ec.wLa().SlideSuggestions)||a.Ec.wLa().SlideSuggestions.length===b.iGe)&&wac_M0c(a,b.Nd,"Success",a.Ec.wLa(),b.fM):wac_M0c(a,b.Nd,"Success",a.Ec.wLa(),b.fM)}
function wac_10c(a,b,c,d,e,f){if(!f)b&&wac_47(b,2),b.Se.If()||wac_5nc(a.Ec)?wac_M0c(a,a.Ec.Nd,"NoResult",null,""):a.U.os(2658220272,2,new wac_wJ(!1,"NoSuggestion"),null);else if(wac_20c(a,c.fM,b.Se)){var g=!0;if(a.ua.CZc){var g=!document.querySelector("#"+b.Se.ia()+' .DesignerSuggestionList[correlationId="'+c.Nd+'"]'),h=new wac_iMc(c,g);a.Qg.la.wa("RS",h,null)}if(g){b&&wac_47(b,3);a.Ec.Qtd||(a.Ec.Qtd=new Date);try{a.ua.Kjf&&a.U4e.uc(function(a){a.lCe("HasSeenDesigner","PPTDesignerFloodgateSurveyEnabled")})}catch(k){wac_Y(42050709,
829,10,"DesignerManager::HandleSuggestionUpdate: Exception thrown when trying to trigger floodgate survey. Exception: {0}",k)}}wac_C0c(a.WX,d,e,f,c.Nd,wac_Z1b(b),g);wac_5nc(a.Ec)||a.U.yw(4095945772,2,null)}}
function wac_mwc(a){switch(a){case 2423756553:case 1296122996:case 1800138055:case 910012865:case 1991549851:case 3300418813:case 4089132864:case 134426873:case 1534685076:case 2219070986:case 1974018626:case 249647848:case 2677509403:case 4262591775:case 506982572:case 2887293604:case 1854371976:case 1460660268:case 3398225082:case 110395433:return!0;default:return!1}}
function wac_H0c(a,b){switch(a){case "EditorPrev":b.zw("#EditorPrev");break;case "EditorNext":b.zw("#EditorNext");break;case "EditorIgnore":b.zw(".EditorIgnore");break;case "EditorSeeMoreLabel":b.zw(".EditorSeeMoreLabel")}}function wac_E0c(a){return Sys.UI.DomElement.containsCssClass(a,"mivContainer")||Sys.UI.DomElement.containsCssClass(a,"mivOverlayContainer")}
function wac_51b(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r){this.Fce=Function.createDelegate(this,this.xue);this.x4a=Function.createDelegate(this,this.xFd);this.xib=Function.createDelegate(this,this.Mie);this.yT=Function.createDelegate(this,this.wna);this.dJa=Function.createDelegate(this,this.fPa);this.Yaa=Function.createDelegate(this,this.oxa);this.SU=Function.createDelegate(this,this.uMa);this.la=new wac_Re;this.dispose=this.O;this.Ob=a;this.ed=b;this.oc=c;this.Bn=d;this.U=e;this.Ec=f;this.Gt=g;this.zc=h;this.IB=
k;this.kC=l;this.ra=m;this.ua=n;this.fr=p;this.Vv=q;this.yqf=r;this.Fb=document.createElement("div");this.Fb.className="DesignerPane";this.Fb.id=q;this.Fb.style.position="absolute";this.Fb.setAttribute("role","region");this.Fb.setAttribute("aria-labelledby","DesignerPaneLabel");this.Fc=!1;this.UX=wac_eH();this.UX.className="DesignerPaneLayoutRoot";this.Fb.appendChild(this.UX);this.Ob.Omc(this.SU)}
wac_51b.prototype={Ob:null,ed:null,oc:null,Bn:null,Fb:null,UX:null,U:null,Ec:null,Gt:null,zc:null,IB:null,kC:null,ra:null,fr:null,Vv:null,yqf:null,Fc:!1,dZc:!1,bA:0,r0a:null,Sj:null,E$:null,A2a:null,sVa:null,ua:null,O:function(){this.Fla();this.Fb.removeChild(this.UX);this.Ob.ITc(this.SU);wac_Y(22590850,829,50,"DesignerPane::Dispose")},Yd:function(){this.Sj=this.jNa("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.Sj,"DesignerPaneCloseButton");this.Sj.setAttribute("role","button");
this.UX.appendChild(this.Sj);this.oc.ya("click",this.Sj,this.Yaa);this.Bn.xa(this.Sj,"keydown",this.dJa);this.r0a=wac_eH();this.r0a.id="DesignerPaneLabel";this.r0a.className="DesignerPaneLabel";this.r0a.innerText=this.yqf;this.UX.appendChild(this.r0a);this.ua.zy&&wac_61b(this);var a=this,b=this;this.Gt.E_(this.Klf(),"main",this.Fb,function(){a.D7b(!0)},function(){b.D7b(!1)},!1,null);wac_BPa(this.zc,this.yT);wac_XF(this.zc,this.xib);wac_5Oa(this.IB,this.xib);wac_Y(22590852,829,50,"DesignerPane::Initialize")},
Klf:function(){return"EditingDesignerPanelFocus"},Fla:function(){this.oc&&0<this.UX.childNodes.length&&(this.oc.ub("click",this.Sj,this.Yaa),this.Bn.sb(this.Sj,"keydown",this.dJa),this.UX.removeChild(this.r0a),this.UX.removeChild(this.Sj),this.ua.zy&&(this.oc.ub("click",this.sVa.Oa,this.x4a),this.oc.ub("click",this.A2a,this.x4a),this.Bn.sb(this.sVa.Oa,"keydown",this.Fce),this.Bn.sb(this.A2a,"keydown",this.Fce),this.UX.removeChild(this.E$)));wac_APa(this.zc,this.yT);wac_nO(this.zc,this.xib);wac_2Db(this.IB,
this.xib);this.ra.Re()&&"EditingDesignerPanelFocus"===this.ra.Re().Kd&&wac_iN(this.ra,"EditingDesignerPanelFocus",!1)},wna:function(a,b){b.FKa&&!this.kC.raa()&&this.Fc&&(wac_Y(24760967,829,50,"DesignerPane::OnUnifiedAppStateChanged - Switching to read-only mode and Designer pane is opened. CorrelationId:{0}",this.Ec.Nd),this.tr(!1,"SuggestionPaneClosed"))},uMa:function(a){a&&this.Fc&&this.tr(!1,"SuggestionPaneClosed")},Mie:function(){wac_Y(37861251,801,50,"Designer Pane is closed because session is rehydrated.");
this.tr(!1,"SessionRehydrated")},jNa:function(a,b){return this.iNa(a,"cui-img-16by16","cui-ctl-iconContainer",b,CommonUIStrings.l_DialogClose,null)},iNa:function(a,b,c,d,e,f){var g=wac_SG();g.alt=e;g.className=wac_7h(a,d);g.src=this.ed.Io(a+".png");g.setAttribute("Unselectable","on");a=wac_fH();a.className=b+" cui-img-cont-float";a.appendChild(g);b=wac_fH();b.className=c;b.setAttribute("Unselectable","on");b.appendChild(a);c=wac_0O();c.className="DesignerPaneNoBorderButton cui-ctl";c.title=e;c.setAttribute("role",
"button");c.tabIndex=0;c.appendChild(b);f&&(e=wac_fH(),e.className="cui-ctl-mediumlabel",e.setAttribute("Unselectable","on"),e.innerText=f,c.appendChild(e));return c},qC:function(a,b){var c=b?wac_jH(a,this.Ef()):wac_iH(a,this.Ef());this.Fc&&(b?(Sys.UI.DomElement.addCssClass(this.Fb,"DesignerPaneRTL"),wac_jH(c,1)):(Sys.UI.DomElement.addCssClass(this.Fb,"DesignerPaneLTR"),wac_iH(c,1)));wac_cH(this.Fb,c);return a},tr:function(a,b){if(this.Fc!==a){this.Fc=a;var c="IdeasPane"===this.Vv?"IdeasPaneOpen":
"PaneOpen";a?(this.ua.Xfe&&(a={},a[c]=!0,wac_wqc(this.fr,JSON.stringify(a))),this.Yd(),this.Fb.style.display="inline-flex",this.Ec.lRb(0,0),wac_Y(22590854,829,50,"DesignerPane::SetIsVisible - Set to visible")):(this.ua.Xfe&&(a={},a[c]=!1,wac_wqc(this.fr,JSON.stringify(a))),this.Fla(),this.Fb.style.display="none","GoToIdeas"===b||"CloseSecondPane"===b||wac_5nc(this.Ec)&&"SuggestionPaneClosed"===b||(this.Ec.v8a=new Date,1===this.bA&&(this.Ec.tzb=!0),this.U.os(2658220272,2,new wac_wJ(!0,b),null)),this.Ec.lRb(1,
0),wac_Y(22590856,829,50,"DesignerPane::SetIsVisible - Set to not visible"));this.Ob.nab()}},D7b:function(a){a?this.la.wa("OnDesignerPaneFocusOn",null,null):this.la.wa("OnDesignerPaneFocusBlur",null,null)},fPa:function(a){!this.Fc||13!==a.keyCode&&32!==a.keyCode||this.tr(!1,"Typing")},oxa:function(){this.Fc&&(wac_Y(22853525,829,50,"DesignerPane::ClosePaneButtonClickHandler - Designer pane close button clicked. CorrelationId:{0}",this.Ec.Nd),this.tr(!1,"SuggestionPaneClosed"));return!0},U3e:function(){return this.ua.zy&&
!!this.E$},Bdf:function(){this.U3e()&&(this.E$.style.display="block")},xFd:function(){return wac_7nc(this)},xue:function(a){13!==a.keyCode&&32!==a.keyCode||wac_7nc(this)},vdf:function(){this.U3e()&&this.A2a.focus()},If:function(){return this.Fc},$c:function(){return this.Fb},GK:function(){return 6},ia:function(){return this.Vv},Ef:function(){var a=0;this.Fc&&(a=this.ua.zy?304:263,a+=1+wac_yM);return a}};function wac_27(a,b){(a.dZc=b)&&a.Sj.focus()}
function wac_7nc(a){if(!a.Fc||!a.ua.zy)return!1;wac_Y(37065160,829,50,"DesignerPane::GoToIdeasHandlerInternal - closing Designer pane to go to Ideas Pane. CorrelationId:{0}",a.Ec.Nd);a.U.os(2034521264,2,!1,null);a.tr(!1,"GoToIdeas");return!0}
function wac_61b(a){a.E$=wac_eH();a.E$.className="GoToIdeasContainer";a.E$.style.display="none";a.sVa=new wac_MG;a.sVa.qh(20,20);wac_Soc(a.sVa,"0 0 2048 2048");a.sVa.Oa.setAttribute("class","IdeasTab");var b=new wac_UG;wac_FN(b,"M 1741 819 l -1089 1127 h -284 l 423 -717 h -484 l 605 -1127 h 587 l -363 717 z");var c=new wac_UG;wac_FN(c,"M 457 1894 l 424 -716 h -488 l 550 -1024 h 472 l -363 716 h 568 l -990 1024 z");c.Oa.setAttribute("class","IdeasTabFill1");var d=new wac_UG;wac_FN(d,"M 1741 819 l -1089 1127 h -284 l 423 -717 h -484 l 605 -1127 h 587 l -363 717 m 363 103 h -530 l 363 -717 h -358 l -496 921 h 493 l -424 717 h 61 z");
d.Oa.setAttribute("class","IdeasTabFill2");a.sVa.Ce(b);a.sVa.Ce(c);a.sVa.Ce(d);a.A2a=wac_fH();a.A2a.innerText=ResourceStrings.l_DesignerGoToIdeas;a.A2a.className="IdeasText";a.A2a.setAttribute("role","button");a.A2a.tabIndex=0;a.E$.appendChild(a.sVa.Oa);a.E$.appendChild(a.A2a);a.UX.appendChild(a.E$);a.oc.ya("click",a.sVa.Oa,a.x4a);a.oc.ya("click",a.A2a,a.x4a);a.Bn.xa(a.sVa.Oa,"keydown",a.Fce);a.Bn.xa(a.A2a,"keydown",a.Fce)}function wac_8nc(a,b){this.rre=b;this.gh=a;this.qe=!1}
wac_8nc.prototype={Ht:null,rre:null,gh:null,Uta:null,qe:!1,Kn:function(){this.qe||(this.Uta=wac_eH(),this.Uta.setAttribute("Unselectable","on"),this.Uta.style.position="absolute",wac_aH(this.Uta,"designerPreviewImageContainer"),this.Ht=new wac_FG,this.qe=!0)},O:function(){this.qe&&(this.sl(),this.Ht&&this.Ht.Oa.parentNode&&(this.Ht.Sr(),wac_mO(this.Ht.Oa,"designerPreviewImageContainer")))},sl:function(){this.qe?(this.tRa(),this.Ht.le(!1)):wac_Y(38099035,829,15,"DesignerPreviewImageView::Dismiss - called before setup")},
tRa:function(){this.Ht.Oa.firstChild&&this.Ht.Oa.removeChild(this.Ht.Oa.firstChild)}};
function wac_71b(a,b,c,d,e,f,g,h,k,l,m,n,p){this.jKe=Function.createDelegate(this,this.mMe);this.TB=Function.createDelegate(this,this.pV);this.wT=Function.createDelegate(this,this.D6);this.F4a=Function.createDelegate(this,this.gJb);this.R6c=Function.createDelegate(this,this.uzd);this.dJa=Function.createDelegate(this,this.fPa);this.S6c=Function.createDelegate(this,this.vzd);this.Dec=Function.createDelegate(this,this.GPd);this.sJa=Function.createDelegate(this,this.zQa);this.dispose=this.O;wac_71b.initializeBase(this,
[new wac_BA,a,f,null]);this.Se=b;this.WX=c;this.Ec=d;this.JHa=e;this.ra=g;this.oc=h;this.Xo=k;this.Bn=l;this.U=m;this.he=n;this.ua=p;this.Qbc=this.ua.gMa}
wac_71b.prototype={DS:null,q0a:null,BS:null,VX:null,q7e:null,p7e:null,z3a:0,HGa:!1,Se:null,WX:null,Ec:null,JHa:null,ra:null,oc:null,Xo:null,Bn:null,U:null,he:null,ua:null,Qbc:!1,O:function(){this.HGa&&wac_81b(this);wac_CA.prototype.O.call(this);wac_Y(22590858,829,50,"DesignerView::Dispose")},rbb:function(){this.DS=wac_eH();this.DS.className="DesignerViewContainer";this.sa.appendChild(this.DS);this.HGa=!0;wac_Y(22590860,829,50,"DesignerView::InitializeView")},Qlf:function(){},gya:function(a){var b=
"",c,d;return(d=wac_30c(this,a,c={val:b},{val:""}),b=c.val,d)?window.parseInt(b):-1},vzd:function(){return this.Se.If()?wac_91b(this):!1},Alf:function(){return!1},Blf:function(){return!1},Kcf:function(){return!1},uzd:function(a){if(!this.Se.If()||a.Km||!this.WX.Ja()||!a.Lb())return!1;a=a.Lb();if(Sys.UI.DomElement.containsCssClass(a,"DesignerSuggestionListDisabled"))return!1;if("mivOverlayContainer"===a.className||"mivTerm"===a.className||"mivIcon"===a.className||"mivContainer"===a.className)return this.Blf(a);
if(a.className.startsWith("Editor"))return this.Alf(a);if(!Sys.UI.DomElement.containsCssClass(a,"SuggestionImg")&&(a=a.firstChild,!a))return!1;var b=document.querySelector("#"+this.Se.ia()+" .DesignerSuggestionList"),c="",d="",e,f,g;if(g=wac_30c(this,a.parentNode,e={val:c},f={val:d}),c=e.val,d=f.val,!g)return!1;e=window.parseInt(c);f=window.parseInt(d);if(this.Ec.hva===f)return wac_Y(25203038,829,50,"DesignerView::ClickSuggestionHandler clicked the applied suggestion"),a=new wac_ZL(e,wac_T1b(this)),
this.he.la.wa("DCS",a,null),!1;a:{if(d=document.querySelectorAll('[slideId="'+f+'"] > .SuggestionImg'))for(g=0;g<d.length;g++)if(c=d[g],c!==a){d=c;break a}d=null}var h;f=(h=new wac_Ga,h.SuggestionSid=f,h.CorrelationId=b.getAttribute("correlationId").toString(),h.ActiveSlideCid=this.WX.Ja().fe(),h.ActiveSlideSid=this.WX.Ja().Vc(),h);h=a;h=.01>=Math.abs(h.width/h.height-1.33);wac_40c(this.WX,b,h)?(g=this.WX,wac_6nc(g,wac_40c(g,b,h),h,!1),d&&d.parentNode&&d.parentNode.parentNode&&(b=this.WX,wac_6nc(b,
wac_40c(b,d.parentNode.parentNode,h),h,!1)),this.U.os(1234776651,2,f,null),wac_Y(22590872,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestionMultiple")):(this.U.os(397517337,2,f,null),wac_Y(22590874,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestion"));wac_6nc(this.WX,a.parentNode,h,!0);d&&wac_6nc(this.WX,d.parentNode,h,!0);wac_$1b(this.DS,e);a=new wac_ZL(e,wac_T1b(this));this.he.la.wa("DCS",a,null);return!0},fPa:function(a){this.Se.If()&&(13!==a.keyCode&&
32!==a.keyCode||wac_91b(this))},gJb:function(a){!this.Se.If()||13!==a.keyCode&&32!==a.keyCode||(a.preventDefault(),(a=document.activeElement)&&a.click())},gs:function(a,b){if(!(0>a)){var c=this.VX.querySelector('[suggestionIndex="'+a+'"]');c?b&&(wac_Vj(c),wac_$1b(this.DS,a)):wac_Y(22590880,829,15,"DesignerView::SetSuggestionItemFocus, suggestionItem {0} is null",a)}},GPd:function(){},zQa:function(){if(this.Se.If())if(2===this.Se.bA)wac_Vj(this.BS.lastChild);else if(3===this.Se.bA){var a;a=this.VX.querySelector("#"+
this.Se.ia()+" .DesignerSuggestionResultSelected");a=this.gya(a);var b;b=this.VX.querySelector("#"+this.Se.ia()+" [slideId]:hover");b=this.gya(b);-1===a?this.gs(-1===b?0:b,!0):this.gs(a,!0)}},D6:function(a){return this.Se.If()&&a.Lb()?this.Kcf(a.get_clientPoint()):!1},pV:function(a){return this.Se.If()&&a.Lb()?this.Kcf(a.get_clientPoint()):!1},mMe:function(){this.WD();wac_47(this,2);wac_Y(22590912,829,50,"DesignerView::GetSuggestionTimeout, CorrelationId: {0}",this.Ec.Nd);this.Se.If()&&(this.Ec.JAb=
!0,this.U.os(2658220272,2,new wac_wJ(!1,"SuggestionsLoadingTimeout"),null))},kQb:function(){this.z3a=window.setTimeout(this.jKe,15E3)},WD:function(){window.clearTimeout(this.z3a)}};function wac_91b(a){try{var b=a.BS.querySelector(".DesignerNoSuggestionView-Link");if(!b)return!1;var c=b.getAttribute("href").toString();if(!c)return!1;wac_Qh(4,c,!0,null);return!0}catch(d){return wac_Y(41711770,829,10,"DesignerView:GoToSuggestionLink exception: {0}",d),!1}}
function wac_Z1b(a){var b=a.ua.gMa?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",c=a.ua.gMa?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";return a.sa.querySelector("."+(wac_Ag?c:b))}function wac_T1b(a){return a.VX.querySelectorAll("#"+a.Se.ia()+" [suggestionIndex]").length}
function wac_30c(a,b,c,d){c.val="";d.val="";if(b){var e=b.getAttribute("suggestionIndex");b=b.getAttribute("slideId");if(!e||!b)return wac_Y(41694980,829,10,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion index and slideId, CorrelationId: {1}",a.Ec.Nd),!1;c.val=e.toString();d.val=b.toString();return!0}return!1}
function wac_50c(a){a.BS=wac_eH();a.BS.className=wac_Ag?"DesignerNoSuggestionViewRTL":"DesignerNoSuggestionView";a.q7e=wac_eH();a.q7e.className="DesignerNoSuggestionView-Header";a.p7e=wac_eH();a.p7e.className="DesignerNoSuggestionView-Content";var b=wac_0O();b.className="DesignerNoSuggestionView-Link";b.setAttribute("href","https://go.microsoft.com/fwlink/?linkid=849683");b.setAttribute("target","_blank");b.innerText=ResourceStrings.L_DesignerLearnMore;b.tabIndex=0;b.setAttribute("role","link");b.setAttribute("aria-label",
ResourceStrings.L_DesignerNoSuggestionHeader);a.BS.appendChild(a.q7e);a.BS.appendChild(a.p7e);a.BS.appendChild(b);a.DS.appendChild(a.BS);a.oc.ya("click",b,a.S6c);a.Bn.xa(a.BS,"keydown",a.dJa)}
function wac_47(a,b){a.WD();4!==b&&(wac_81b(a),a.DS.id=a.Ec.Nd);a.Se.bA=b;switch(a.Se.bA){case 1:a.q0a=wac_eH();a.q0a.className="DesignerLoadingView";var c=wac_SG();c.className=wac_Ag?"DesignerLoadingViewSpinnerRTL":"DesignerLoadingViewSpinner";c.src=wac_Le("progress.gif");var d=wac_eH();d.className=wac_Ag?"DesignerLoadingViewTextRTL":"DesignerLoadingViewText";d.innerText=ResourceStrings.L_DesignerLoading;a.q0a.appendChild(c);wac_Y(38340425,829,50,"DesignerView::spinner shows up");a.q0a.appendChild(d);
a.DS.appendChild(a.q0a);wac_Y(22590866,829,50,"DesignerView::InitLoadingState");a.kQb();break;case 2:a.Se.If()&&(wac_50c(a),a.q7e.innerText=ResourceStrings.L_DesignerNoSuggestionHeader,a.p7e.innerText=ResourceStrings.L_DesignerNoSuggestionContent,wac_Y(22590868,829,50,"DesignerView::InitNoSuggestionState"));break;case 5:a.Se.If()&&(wac_50c(a),a.q7e.innerText=ResourceStrings.L_DesignerCoauthorHeader,a.p7e.innerText=ResourceStrings.L_DesignerCoauthorContent,wac_Y(41725981,829,50,"DesignerView::InitSameSlideCoauthNoSuggestionState"));
break;case 3:a.Se.If()||a.Se.tr(!0,null);a.VX=wac_eH();c=a.Qbc?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView";d=a.Qbc?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";a.VX.className=wac_Ag?d:c;a.DS.appendChild(a.VX);a.Se.Bdf();a.ua.Y5a||(wac_iN(a.ra,"EditingDesignerPanelFocus",!0),a.ra.ld());a.oc.ya("click",a.VX,a.R6c);a.Bn.xa(a.VX,"keydown",a.F4a);a.Xo.ya("msospPointerOver",a.VX,a.wT);a.Xo.ya("msospPointerOut",a.VX,a.TB);wac_Y(22590870,829,50,"DesignerView::InitShowSuggestionState");
break;case 6:a.Qlf();break;case 4:if(c=document.querySelectorAll(".DesignerSuggestionListDisabled"))for(d=0;d<c.length;d++)c[d].style.visibility="visible"}a.Se.la.xa("OnDesignerPaneFocusOn",a.sJa);a.Se.la.xa("OnDesignerPaneFocusBlur",a.Dec);wac_Y(22590864,829,50,"DesignerView::SetViewState: {0}",wac_Z.p$a.toString(b))}
function wac_81b(a){if(a.DS.children&&0<a.DS.children.length)for(;0<a.DS.children.length;)a.DS.removeChild(a.DS.children[0]);a.Se.bA=0;a.Se.la.sb("OnDesignerPaneFocusOn",a.sJa);a.Se.la.sb("OnDesignerPaneFocusBlur",a.Dec);wac_Y(22590862,829,50,"DesignerView::CleanUpView")}
function wac_a2b(a,b,c,d,e,f){this.Ea=a;this.Cc=b;this.ua=c;this.Ec=d;this.J7e=(a=this.ua.gMa)?"DesignerSuggestionResultWide":"DesignerSuggestionResult";this.K7e=a?"DesignerSuggestionResultSelectedWide":"DesignerSuggestionResultSelected";this.pb=e;this.ed=f}function wac_Z0c(a){var b=null;try{b=wac_yl(a)}catch(c){wac_Y(39338641,829,10,"DesignerViewHelper:TransformSuggestionDataFormat - parsing suggestionResults failed")}return b}
function wac__0c(a){var b=a.CardData,c=null;try{if(c=wac_yl(b),!a.SlideSuggestions&&c)for(c=wac_02a(c,function(a){return!!a.Type}),a=0;a<c.length;a++)c[a].Index=a}catch(d){wac_Y(41969486,829,10,"parsing cards failed with exception: {0}",d)}return c}function wac_60c(){var a=wac_eH();a.className=a.id="EditorSuggestionsContainer";return a}
wac_a2b.prototype={Ea:null,ua:null,Cc:null,Ec:null,pb:null,ed:null,J7e:null,K7e:null,x7e:null,hQa:function(){return this.Cc.hQa(!0)},Ja:function(){return window.$$as(wac_KH,this.Ea.Ja())}};
function wac_$1b(a,b){if(a){if(a=a.querySelector('[suggestionIndex="'+b+'"]'))b=wac_xk(a),a.contains(wac__ka(new Sys.UI.Point(b.x,b.y)))&&a.contains(wac__ka(new Sys.UI.Point(b.x+b.width-1,b.y)))?a.contains(wac__ka(new Sys.UI.Point(b.x,b.y+b.height-1)))&&a.contains(wac__ka(new Sys.UI.Point(b.x+b.width-1,b.y+b.height-1)))||a.scrollIntoView(!1):a.scrollIntoView(!0)}else wac_Y(36845459,829,15,"Designer view has been removed from DesignerViewContainer")}
function wac_40c(a,b,c){return b.querySelector("."+(c?a.K7e+"4x3":a.K7e))}function wac_6nc(a,b,c,d){b&&(d?(b.className=c?a.K7e+"4x3":a.K7e,wac_Fe(b,"aria-selected","true")):(b.className=c?a.J7e+"4x3":a.J7e,wac_Fe(b,"aria-selected","false")))}
function wac_Y0c(a,b){if(b&&(b=b.querySelector(".DesignerSuggestionResultSelected, .DesignerSuggestionResultSelected4x3, .DesignerSuggestionResultSelectedWide, .DesignerSuggestionResultSelectedWide4x3"))){var c=-1!==b.className.indexOf("4x3");wac_6nc(a,b,c,!1)}}function wac_70c(a){a=a.hQa();return.01>=Math.abs(a.ac/a.qc-1.33)}function wac_V0c(a){a.x7e&&(a.pb.Rg(a.x7e),a.x7e=null)}
function wac_80c(a,b){wac_V0c(a);a.x7e=new wac_D(2,1,a.ua.Tif,function(){wac_V0c(a);for(var c=0;c<b;c++)a.Ec.N7d.Ge(c)||a.Ec.g5e.ga(c)},0,"IncrementalRenderTimeoutTask",!1);a.pb.Hb(a.x7e)}
function wac_90c(a,b,c){a=a.Ec.azc[c].WTe[0].suggestions;c=Math.min(3,a.length);for(var d=0;d<c;d++){var e=b,f=a[d].description,g=a[d].numberOfInstances,h=d,k=wac_eH();k.className="EditorSuggestionContainer";k.tabIndex=0;k.setAttribute("editorSuggestionIdx",h);var l=wac_fH();l.className="EditorSuggestionArrow";l.innerText="\u2192";l.setAttribute("editorSuggestionIdx",h);var m=wac_fH();m.className="EditorSuggestionText";m.innerText=f;m.setAttribute("editorSuggestionIdx",h);f=wac_fH();f.className="EditorSuggestionInstances";
f.innerText=String.format("[{0}]",g);f.setAttribute("editorSuggestionIdx",h);k.appendChild(l);k.appendChild(m);k.appendChild(f);e.appendChild(k)}}
function wac_$0c(a,b,c,d,e,f){var g=wac_eH();g.className="mivButton";g.setAttribute("role","listitem");var h="mivTerm."+e,k=wac_SG();k.className="mivButtonImage";a:{for(var l=wac_a1c,m=l.length,n=0;n<m;++n){var p=l[n];if(p.toLowerCase()===b.toLowerCase()){d.ga(p);a=a.ed.Io(b+".png");break a}}a=a.ed.Io("stock"+f.val++ +".png")}k.src=a;k.setAttribute("aria-labelledby",h);a=wac_eH();a.className="mivOverlayContainer";a.tabIndex=0;a.setAttribute("mivIdx",e);a.setAttribute("role","button");e=document.createElement("i");
e.className="mivIcon";e.innerText="\ue721";e.setAttribute("role","presentation");d=wac_fH();d.className="mivTerm";d.innerText=b;d.id=h;g.appendChild(k);g.appendChild(a);a.appendChild(e);a.appendChild(d);c.appendChild(g)}
function wac_b1c(a,b,c,d,e,f,g){var h=null;if(a.ua.CZc)a:if((h=document.querySelector("#"+d+' [IncSuggestionPlaceholder="'+g+'"]'))&&Sys.UI.DomElement.addCssClass(h,"ShimmerPaused"),!a.Ec.dDe.Ge(g)&&(a.Ec.dDe.ga(g),d=a.Ec.dDe.Ma(),d===e&&(a.Ec.a5e=new Date,wac_V0c(a)),!a.Ec.F3e&&d>=a.Ec.s3e)){for(e=0;e<a.Ec.s3e;e++)if(!a.Ec.dDe.Ge(e))break a;a.Ec.F3e=new Date}switch(b){case 0:if(c&&f)try{c.setAttribute("slideId",f.SlideSid);var k=wac_SG();k.className="SuggestionImg";k.src=f.Base64Img;a.Ec.N7d.Ge(f.Index)||
a.Ec.N7d.ga(f.Index);c.appendChild(k);wac_Y(42342620,829,50,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} rendered. CorrelationId: {1}",g,a.Ec.Nd)}catch(q){c.parentNode.removeChild(c),wac_Y(41695003,829,10,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} failed to render in browser. CorrelationId: {1}, Error: {2}",g,a.Ec.Nd,q)}break;case 1:if(f){c.className="mivContainer";c.setAttribute("aria-label",ResourceStrings.L_MakeItVisualCardTitle);var l=wac_fH();l.className="mivTitle";
l.innerText=ResourceStrings.L_MakeItVisualCardTitle;var m=wac_fH();m.className="mivSubtitle";m.innerText=ResourceStrings.L_MakeItVisualCardSubtitle;b=wac_eH();b.className="mivButtonsContainer";b.setAttribute("role","list");e=0;g=new (wac_ta.$$(String));d=Math.min(6,f.SearchTerms.length);for(k=0;k<d;k++)wac_$0c(a,f.SearchTerms[k].Term,b,g,k,e={val:e}),e=e.val;for(k=d;6>k;k++){f=wac_a1c;d=f.length;for(var n=0;n<d;++n){var p=f[n];if(!g.Ge(p)){wac_$0c(a,p,b,g,k,f={val:e});e=f.val;break}}}c.appendChild(l);
c.appendChild(m);c.appendChild(b);a.Ec.t8e=!0}break;case 2:if(!(f=wac_km(a.Ec.azc))){a:if(f=a.Ec,f.e0a)l=!0;else{try{if(m=wac_k(wac_j(),wac_Hqb)){f.e0a=m;l=!0;break a}}catch(q){wac_Y(42001674,829,15,"error resolving consistencyCheckActor. ex: {0}",q)}l=!1}f=!l}f?c.style.display="none":(c.className="EditorContainer",f=wac_fH(),f.className="EditorTitle",f.innerText=ResourceStrings.L_ConsistencyCardTitle,l=wac_eH(),l.className="EditorSubtitleContainer",m=wac_fH(),m.className=m.id="EditorSubtitle",m.innerText=
m.title=a.Ec.azc[0].WTe[0].explanationLabel,b=wac_eH(),b.className="EditorBucketContainer",g=wac_fH(),g.innerText="<",g.tabIndex=0,Sys.UI.DomElement.addCssClass(g,"EditorPrev"),Sys.UI.DomElement.addCssClass(g,"EditorPrevDisabled"),g.id="EditorPrev",k=wac_fH(),k.innerText="1",k.id="EditorBucketCurrent",wac_W0c(a.Ec,0),e=wac_fH(),e.innerText="/",d=wac_fH(),d.className="EditorBucketTotalCount",d.id="EditorBucketTotal",d.innerText=a.Ec.azc.length.toString(),n=wac_fH(),n.innerText=">",n.tabIndex=0,n.className=
n.id="EditorNext",0<a.Ec.azc.length-1?Sys.UI.DomElement.addCssClass(n,"EditorNextEnabled"):Sys.UI.DomElement.addCssClass(n,"EditorNextDisabled"),b.appendChild(g),b.appendChild(k),b.appendChild(e),b.appendChild(d),b.appendChild(n),l.appendChild(m),l.appendChild(b),m=wac_fH(),m.className="EditorDescription",m.innerText=ResourceStrings.L_ConsistencyCardDescription,b=wac_60c(),wac_90c(a,b,0),g=wac_eH(),g.className="EditorIgnoreContainer",k=wac_eH(),k.className="EditorIgnore",k.innerText=ResourceStrings.L_ConsistencyCardIgnore,
k.title=ResourceStrings.L_ConsistencyCardIgnoreTitle,k.tabIndex=0,g.appendChild(k),k=wac_eH(),k.className="EditorSeeMoreContainer",e=wac_fH(),e.className="EditorSeeMoreLabel",e.innerText=ResourceStrings.L_ConsistencyCardSeeMore,e.tabIndex=0,k.appendChild(e),e=wac_eH(),e.id="EditorCardContent",e.appendChild(l),e.appendChild(m),e.appendChild(b),e.appendChild(g),c.appendChild(f),c.appendChild(e),c.appendChild(k),a.Ec.j8e=!0)}h&&h.parentNode.removeChild(h);a=wac_eH();a.className="DesignerSuggestionListDisabled";
c.appendChild(a)}
function wac_C0c(a,b,c,d,e,f,g){if(b&&d&&f){var h=wac_70c(a),k=f.parentNode.parentNode.id;if(g){var l=wac_eH();l.className="DesignerSuggestionList";l.setAttribute("correlationId",e);l.setAttribute("aria-label",ResourceStrings.l_DesignerSuggestions);l.setAttribute("role","list");if(a.ua.CZc){e=a.Ec;var m;if(m=document.getElementById("WACDocumentPanel")){var n=a.ua.gMa,p=wac_70c(a);m=Math.floor((m.offsetHeight-87)/(n||p?135:101))}else m=1;e.s3e=m}for(e=0;e<d;e++)m=wac_eH(),m.className=h?a.J7e+"4x3":
a.J7e,m.setAttribute("suggestionIndex",e),m.tabIndex=0,m.setAttribute("aria-label",String.format(ResourceStrings.l_DesignerSuggestionItem,e+1)),m.setAttribute("role","listitem"),m.setAttribute("aria-posinset",e+1),m.setAttribute("aria-setsize",d),l.appendChild(m);f.appendChild(l);f=l}else f=document.querySelector("#"+k+' .DesignerSuggestionList[correlationId="'+e+'"]');if(l=f)try{var q=a.Ec.DDe,r=!wac_km(q)&&"IdeasPane"===k;f={};if(r)for(var t=q.length,v=0;v<t;++v){var u=q[v];switch(u.Type){case 0:var w=
u;e=null;var x=b.SlideSuggestions,z=x.length;for(m=0;m<z;++m)if(y=x[m],y.Index===w.IndexInDesigner){e=y;break}f[u.Index.toString()]=e;break;default:f[u.Index.toString()]=u}}else for(v=b.SlideSuggestions,w=v.length,b=0;b<w;++b){var y=v[b];f[y.Index.toString()]=y}if(g){a.Ec.oDb=new Date;a.ua.CZc&&wac_80c(a,c);for(var A=0;A<l.childNodes.length;A++){var B=l.childNodes[A],C;if(C=a.ua.CZc){var F=f,D=A.toString();C=!(D in F)||!F[D]}if(C){var F=h,G=A,H=B;H.style.backgroundColor="white";var J=wac_eH();J.className=
F?"IncSuggestionPlaceholder placeholder_237x178":"IncSuggestionPlaceholder placeholder_237x137";J.setAttribute("IncSuggestionPlaceholder",G);(wac_Ek()||wac_dg())&&Sys.UI.DomElement.addCssClass(J,"Shimmer");H.appendChild(J)}else wac_b1c(a,r?q[A].Type:0,B,k,d,f[A.toString()],A)}}else if(a.ua.CZc)for(A=Object.keys(f),F=A.length,h=0;h<F;++h)G=A[h],H=window.parseInt(G),B=document.querySelector("#"+k+' [suggestionIndex="'+H+'"]'),f[G]&&B&&Sys.UI.DomElement.containsCssClass(B.firstChild,"IncSuggestionPlaceholder")&&
wac_b1c(a,r?q[H].Type:0,B,k,d,f[G],H)}catch(K){wac_Y(41695001,829,10,"DesignerViewHelper:RenderSuggestions - Failed to render suggestion(s) and/or incremental rendering placeholders. CorrelationId: {1}, Error: {2}",a.Ec.Nd,K)}}}function wac_c1c(a,b,c,d,e,f,g,h,k,l,m,n,p){wac_c1c.resolveInheritance();this.dispose=this.O;wac_c1c.initializeBase(this,[a,b,c,d,e,f,g,h,k,l,m,n,p,"IdeasPane",ResourceStrings.L_IdeasPaneLabel])}
wac_c1c.prototype={GK:function(){return 7},U3e:function(){return!1},Bdf:function(){},vdf:function(){},Klf:function(){return"EditingIdeasPaneFocus"},zw:function(a){(a=document.querySelector(a))&&wac_Vj(a)}};function wac_I0c(a,b){a.zw('.EditorSuggestionContainer[editorSuggestionIdx="'+b+'"')}function wac_G0c(a,b){a.zw("#"+a.Vv+" .mivButton:nth-child("+b+") > .mivOverlayContainer")}
function wac_F0c(a,b,c,d,e,f,g,h,k,l,m,n,p){this.Y3=Function.createDelegate(this,this.CM);this.dispose=this.O;wac_F0c.initializeBase(this,[a,b,c,d,e,f,g,h,k,l,m,n,p]);this.urb=new wac_h5;var q;this.Zpf=(q=new wac_F8(m,this.urb,this.ua),q.qLa=2168883939,q)}
wac_F0c.prototype={O4e:null,Zpf:null,urb:null,cTe:null,O:function(){this.O4e&&(this.O4e.dispose(),this.O4e=null);wac_71b.prototype.O.call(this)},Qlf:function(){this.VX.style.display="none";this.Ec.Pbf=!0;this.cTe=wac_eH();this.cTe.className="mivView";var a=wac_d1c("mivKeepFocusStart"),b=document.createElement("iframe");b.className=b.id="mivFrame";var c=wac_d1c("mivKeepFocusEnd");this.cTe.appendChild(a);this.cTe.appendChild(b);this.cTe.appendChild(c);this.DS.appendChild(this.cTe);var d=this.ra.xc("IdeasMakeItVisualFocusId");
d.re="app";wac_Ej(this.oc,"IdeasMakeItVisualFocusId",b,!1);var e=this;wac_mk(d,function(){b.focus();var a,c=(a=new wac_tk(function(){return e.cTe}),a.Lna=!0,a);wac_wk(c,3);wac_wk(c,2);wac_wk(c,4);wac_wk(c,1);wac_wk(c,6);wac_wk(c,5);wac_cja(wac_Ie(),e.cTe,d,c);a=wac_6j(wac_Ie(),"IdeasMakeItVisualFocusId");wac_rk(a);a.EM=!0;a.Ola=!0;wac_jk(d,wac_Ie().rra);wac_jk(d,wac_Ie().sra);c.Ch(b)});this.ra.ff("IdeasMakeItVisualFocusId",!1);this.Bn.xa(this.cTe,"keydown",this.Y3)},CM:function(a){9===a.keyCode&&
("mivKeepFocusEnd"!==a.target.id||a.shiftKey?"mivKeepFocusStart"===a.target.id&&a.shiftKey&&wac_e1c(a,"mivKeepFocusEnd"):wac_e1c(a,"mivKeepFocusStart"))},Blf:function(a){switch(a.className){case "mivContainer":return wac_8Yc.isInstanceOfType(this.Se)&&wac_G0c(this.Se,1),!0;case "mivOverlayContainer":a=a.querySelector(".mivTerm").innerText;break;case "mivTerm":a=a.innerText;break;case "mivIcon":a=a.parentNode.querySelector(".mivTerm").innerText;break;default:return!1}return wac_f1c(this,a)},Alf:function(a){var b;
if(Sys.UI.DomElement.containsCssClass(a,"EditorPrevEnabled")||Sys.UI.DomElement.containsCssClass(a,"EditorNextEnabled")){if(Sys.UI.DomElement.containsCssClass(a,"EditorPrevEnabled")){var c;wac_W0c(c=this.Ec,c.mDc-1);this.Ec.mDc||(Sys.UI.DomElement.removeCssClass(a,"EditorPrevEnabled"),Sys.UI.DomElement.addCssClass(a,"EditorPrevDisabled"));b=document.getElementById("EditorNext");Sys.UI.DomElement.removeCssClass(b,"EditorNextDisabled");Sys.UI.DomElement.addCssClass(b,"EditorNextEnabled")}else{var d;
wac_W0c(d=this.Ec,d.mDc+1);this.Ec.mDc===this.Ec.azc.length-1&&(Sys.UI.DomElement.removeCssClass(a,"EditorNextEnabled"),Sys.UI.DomElement.addCssClass(a,"EditorNextDisabled"));b=document.getElementById("EditorPrev");Sys.UI.DomElement.removeCssClass(b,"EditorPrevDisabled");Sys.UI.DomElement.addCssClass(b,"EditorPrevEnabled")}document.getElementById("EditorBucketCurrent").innerText=(this.Ec.mDc+1).toString();wac_g1c(this,this.Ec.mDc);b=!0}else if(Sys.UI.DomElement.containsCssClass(a,"EditorSuggestionContainer")||
Sys.UI.DomElement.containsCssClass(a,"EditorSuggestionArrow")||Sys.UI.DomElement.containsCssClass(a,"EditorSuggestionText")||Sys.UI.DomElement.containsCssClass(a,"EditorSuggestionInstances"))if(b=this.Ec.e0a,wac_km(this.Ec.azc)||!b)b=!1;else{a=a.getAttribute("editorSuggestionIdx");if(c=document.querySelector('.EditorSuggestionArrow[editorSuggestionIdx="'+a+'"]'))c.innerText="\u2713",Sys.UI.DomElement.removeCssClass(c,"EditorSuggestionArrow"),Sys.UI.DomElement.addCssClass(c,"EditorSuggestionCheck");
c=new (wac_e.$$(String,Number));d=this.Ec.azc[this.Ec.mDc].WTe;for(var e=d.length,f=0;f<e;++f)c.ga(d[f].critiqueId,a);b.Dmf(c,3);b=this.Ec.i8e=!0}else if(Sys.UI.DomElement.containsCssClass(a,"EditorIgnore"))if(a=this.Ec.e0a){a.cbb(wac_h1c(this),4);this.Ec.azc.splice(this.Ec.mDc,1);this.Ec.mDc===this.Ec.azc.length&&wac_W0c(b=this.Ec,b.mDc-1);a=document.getElementById("EditorBucketTotal");b=window.parseInt(a.innerText);b--;if(0>=b){b=document.getElementById("EditorCardContent");a=wac_eH();a.className=
"EditorNoMoreContainer";c=new wac_MG;c.qh(40,40);wac_Soc(c,"0,0,2048,2048");wac_IG(c,"EditorSvgCheck");d=new wac_UG;wac_FN(d,"M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m -599 -783 l 72 -72 l 348 348 l 706 -706 l 72 72 l -778 779 z");
e=new wac_UG;wac_FN(e,"M 1894 1024 q 0 120 -31 232 q -31 111 -87 208 q -57 96 -136 176 q -80 79 -176 136 q -97 56 -208 87 q -112 31 -232 31 q -120 0 -231 -31 q -112 -31 -208 -87 q -97 -57 -176 -136 q -80 -80 -136 -176 q -57 -97 -88 -208 q -31 -112 -31 -232 q 0 -120 31 -231 q 31 -112 88 -208 q 56 -97 136 -176 q 79 -80 176 -136 q 96 -57 208 -88 q 111 -31 231 -31 q 120 0 232 31 q 111 31 208 88 q 96 56 176 136 q 79 79 136 176 q 56 96 87 208 q 31 111 31 231 z");e.Oa.setAttribute("class","EditorWhiteCheck");
f=new wac_UG;wac_FN(f,"M 1024 128 q 124 0 239 32 q 114 32 214 91 q 99 58 181 140 q 81 81 140 181 q 58 99 90 214 q 32 114 32 238 q 0 124 -32 239 q -32 114 -90 214 q -59 99 -140 181 q -82 81 -181 140 q -100 58 -214 90 q -115 32 -239 32 q -124 0 -238 -32 q -115 -32 -214 -90 q -100 -59 -181 -140 q -82 -82 -140 -181 q -59 -100 -91 -214 q -32 -115 -32 -239 q 0 -124 32 -238 q 32 -115 91 -214 q 58 -100 140 -181 q 81 -82 181 -140 q 99 -59 214 -91 q 114 -32 238 -32 m 599 625 l -72 -72 l -706 706 l -348 -348 l -72 72 l 420 421 z");
f.Oa.setAttribute("class","EditorGreenFill");var g=new wac_UG;wac_FN(g,"M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m 672 -1141 l -851 851 l -493 -493 l 145 -144 l 348 347 l 706 -706 m -706 924 l 778 -779 l -72 -72 l -706 706 l -348 -348 l -72 72 z");
g.Oa.setAttribute("class","EditorGreenBorder");c.Ce(d);c.Ce(e);c.Ce(f);c.Ce(g);d=wac_fH();d.innerText=ResourceStrings.l_ConsistencyCardNoMore;d.className="EditorNoMoreLabel";a.appendChild(c.Oa);a.appendChild(d);b.parentNode.replaceChild(a,b)}else a.innerText=b.toString(),wac_g1c(this,this.Ec.mDc),a=this.Ec.mDc===this.Ec.azc.length-1,c=document.getElementById("EditorNext"),1<b&&!a?(Sys.UI.DomElement.addCssClass(c,"EditorNextEnabled"),Sys.UI.DomElement.removeCssClass(c,"EditorNextDisabled")):(Sys.UI.DomElement.addCssClass(c,
"EditorNextDisabled"),Sys.UI.DomElement.removeCssClass(c,"EditorNextEnabled")),a&&(document.getElementById("EditorBucketCurrent").innerText=b.toString()),a=document.getElementById("EditorPrev"),1<b&&this.Ec.mDc?(Sys.UI.DomElement.addCssClass(a,"EditorPrevEnabled"),Sys.UI.DomElement.removeCssClass(a,"EditorPrevDisabled")):(Sys.UI.DomElement.addCssClass(a,"EditorPrevDisabled"),Sys.UI.DomElement.removeCssClass(a,"EditorPrevEnabled"));b=!0}else b=!1;else Sys.UI.DomElement.containsCssClass(a,"EditorSeeMoreLabel")?
(this.U.yw(1625372200,2,null),this.Se.tr(!1,"OpenEditorPane"),b=this.Ec.Wif=!0):b=!1;return b},Kcf:function(a){var b=this.Ec.e0a;if(!b||wac_km(this.Ec.azc))return!1;for(a=wac__ka(a);a&&"EditorContainer"!==a.className;)a=a.parentNode;a&&"EditorContainer"===a.className?b.l9e(wac_h1c(this),2):b.l9e([],2);return!0}};
function wac_g1c(a,b){var c=a.Ec.azc[b].WTe[0].explanationLabel;document.getElementById("EditorSubtitle").innerText=c;var c=document.getElementById("EditorSuggestionsContainer"),d=wac_60c();c.parentNode.replaceChild(d,c);wac_90c(a.WX,d,b)}function wac_h1c(a){var b=[];a=a.Ec.azc[a.Ec.mDc].WTe;for(var c=a.length,d=0;d<c;++d)b.push(a[d].critiqueId);return b}
function wac_f1c(a,b){wac_47(a,6);var c=wac_Nf(a.ua.xvd).toString(),c=String.format(a.ua.Vlc,wac_.vh,wac_nm(wac_.vh)._name,wac_.jv,wac_5k().toString(),3,c),c=c.replace(/&amp;/g,"&").replace(/&p=3/,"&p=6")+"&q="+b;b=document.getElementById("mivFrame");b.setAttribute("src",c);b.style.visibility="visible";a.O4e=(new wac_mRb).IG(b.contentWindow,c);wac_b5(a.O4e,"AddItem",function(b){if(b=wac_N_c(b)){var c=[];Array.add(c,b);a.U.yw(2503038014,2,null);a.Se.tr(!1,"CloseSecondPane");a.Zpf.uya(c)}});wac_b5(a.O4e,
"ClosePane",function(){wac_47(a,3);var b=a.Ec.wLa()?a.Ec.wLa().SlideSuggestions.length:0;wac_C0c(a.WX,a.Ec.wLa(),b,a.Ec.DDe.length,a.Ec.Nd,wac_Z1b(a),!0)});return!0}function wac_e1c(a,b){a.preventDefault();a.stopPropagation();(a=document.getElementById(b))&&a.focus()}function wac_d1c(a){var b=document.createElement("div");b.setAttribute("Id",a);b.setAttribute("tabindex",0);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");return b}
function wac_b2b(){}
wac_b2b.prototype={J:null,uD:!1,Ub:function(){return"PowerPointWebEditor.Designer"},gc:function(a){this.J=a;var b=this;wac_m(wac_n(this.J.fa(wac__7)),function(){return new wac_71b(b.J.H(wac_Ts),b.J.H(wac_Z7),b.J.H(wac_07),b.J.H(wac_X7),b.J.H(wac_3nc),b.J.H(wac_Xs),b.J.H(wac_zG),b.J.H(wac_8c),b.J.H(wac_cd),b.J.H(wac_PF),b.J.H(wac_Oc),b.J.H(wac_Qt),b.J.H(wac_R))});var c=this;wac_m(wac_n(this.J.fa(wac_9Yc)),function(){return new wac_F0c(c.J.H(wac_Ts),c.J.H(wac_8Yc),c.J.H(wac_07),c.J.H(wac_X7),c.J.H(wac_3nc),
c.J.H(wac_Xs),c.J.H(wac_zG),c.J.H(wac_8c),c.J.H(wac_cd),c.J.H(wac_PF),c.J.H(wac_Oc),c.J.H(wac_Qt),c.J.H(wac_R))});var d=this;wac_m(wac_n(this.J.fa(wac_8Yc)),function(){return new wac_c1c(d.J.H(wac_lr),d.J.H(wac_5F),d.J.H(wac_8c),d.J.H(wac_PF),d.J.H(wac_Oc),d.J.H(wac_X7),d.J.H(wac_JL),d.J.H(wac_fG),d.J.H(wac_jG),d.J.H(wac_mG),d.J.H(wac_zG),d.J.H(wac_R),d.J.H(wac_Tt))});var e=this;wac_m(wac_n(this.J.fa(wac_Z7)),function(){return new wac_51b(e.J.H(wac_lr),e.J.H(wac_5F),e.J.H(wac_8c),e.J.H(wac_PF),e.J.H(wac_Oc),
e.J.H(wac_X7),e.J.H(wac_JL),e.J.H(wac_fG),e.J.H(wac_jG),e.J.H(wac_mG),e.J.H(wac_zG),e.J.H(wac_R),e.J.H(wac_Tt),"DesignerPane",ResourceStrings.L_Designer)});var f=this;wac_m(wac_n(this.J.fa(wac_07)),function(){return new wac_a2b(f.J.H(wac_Nt),f.J.H(wac_Mt),f.J.H(wac_R),f.J.H(wac_X7),f.J.H(wac_dd),f.J.H(wac_5F))});var g=this;wac_m(wac_n(this.J.fa(wac_Y7)),function(){return new wac_X1b(g.J.H(wac_9Yc),g.J.H(wac__7),g.J.H(wac_07),g.J.H(wac_X7),g.J.H(wac_R),g.J.H(wac_Oc),g.J.H(wac_Nt),g.J.H(wac_dI),g.J.H(wac_NL),
g.J.H(wac_zG),wac_l(g.J,wac_AY),wac_l(g.J,wac_zY),wac_l(g.J,wac_Dc))});var h=this;wac_m(wac_n(this.J.fa(wac_3nc)),function(){return new wac_8nc(h.J.H(wac_9G),h.J.H(wac_eK))});var k=this;wac_m(wac_n(this.J.fa(wac_X7)),function(){return new wac_W1b(wac_l(k.J,wac_AY))});var l=this;wac_m(wac_n(this.J.fa(wac_wYc)),function(){return new wac_i1c(l.J.H(wac_Oc),l.J.H(wac_R))});if(this.uD=this.J.H(wac_3L).Ta.Fo){var m=this;wac_m(wac_n(this.J.fa(wac_WF)),function(){return new wac_WF(wac_.Af,m.J.H(wac_VF),m.J.H(wac_fG),
m.J.H(wac_jG),m.J.H(wac_NF),m.J.H(wac_dd),m.J.H(wac_Uc))})}},tb:function(){var a=this.J.H(wac_Uc),b=this;a.Ok(function(){if(wac_q(a,wac_2(248))){b.uD&&b.J.H(wac_WF);var c=b.J.H(wac__7),d=wac_j().H(wac_Z7).$c();c.j5(d);c.rbb();b.J.H(wac_tL).dC(b.J.H(wac_Z7));c=b.J.H(wac_9Yc);d=wac_j().H(wac_8Yc).$c();c.j5(d);c.rbb();b.J.H(wac_tL).dC(b.J.H(wac_8Yc));c=null;if(wac_q(a,wac_2(1034))&&(c=b.J.H(wac_l_c))){var d=wac_0i(a,wac_2(1043)),e=wac_0i(a,wac_2(1035));wac_A_c(c,d,e).then(function(a){a.IsSuccess||wac_Y(42324822,
829,15,"PPTWebEditorDesignerPackage::Init Failed to get AAD token with error: "+a.ErrorCode+": "+a.ErrorMessage)}).catch(function(a){wac_Y(42324824,829,15,"PPTWebEditorDesignerPackage::Init - Token retrival failed:{0}",a)})}c=new wac_Q1b(b.J.H(wac_Oc),b.J.H(wac_Jt),b.J.H(wac_dI),b.J.H(wac_It),b.J.H(wac_zG),b.J.H(wac_Z7),b.J.H(wac_8Yc),b.J.H(wac__7),b.J.H(wac_9Yc),b.J.H(wac_07),b.J.H(wac_Y7),b.J.H(wac_X7),b.J.H(wac_Nt),b.J.H(wac_3H),b.J.H(wac_NL),b.J.H(wac_MY),b.J.H(wac_R),b.J.H(wac_aY),b.J.H(wac_RY),
b.J.H(wac_AJ),b.J.H(wac_KL),b.J.H(wac_fG),b.J.H(wac_dd),b.J.H(wac_jY),b.J.H(wac_wYc),b.J.H(wac_af),wac_l(b.J,wac_zfc),c);c.Tb();c.Lf();b.J.H(wac_R).Lde&&b.J.H(wac_3nc).Kn()}else wac_Y(37041294,829,50,"Designer setting is disabled")})},O:function(){this.J.H(wac_R).Lde&&this.J.H(wac_3nc).O()}};Type.registerNamespace("PowerPointWebEditor.Infrared");wac_Z.EJd=wac_Z.EJd||{};wac_Z.EJd.Plf=function(){};wac_Z.EJd.Plf.prototype={};wac_Z.EJd.Plf.registerEnum("PowerPointWebEditor.Infrared.IdeasCardType",!1);
wac_Z.EJd.Olf=function(){};wac_Z.EJd.Olf.prototype={};wac_Z.EJd.Olf.registerEnum("PowerPointWebEditor.Infrared.IdeasCardAction",!1);function wac_wYc(){}wac_wYc.registerInterface("PowerPointWebEditor.Infrared.IIdeasContext");
function wac_i1c(a,b){this.cbf=Function.createDelegate(this,this.swf);this.dbf=Function.createDelegate(this,this.wwf);this.Mhf=Function.createDelegate(this,this.twf);this.Krf=Function.createDelegate(this,this.uwf);this.Lrf=Function.createDelegate(this,this.vwf);this.U=a;this.ua=b;this.U.ja(1068159161,1,this.Lrf);this.U.ja(206151992,1,this.Krf);this.U.ja(1724554274,1,this.Mhf);this.U.ja(2857549322,1,this.dbf);this.U.ja(4031196440,1,this.dbf);this.U.ja(2760733910,1,this.cbf);this.U.ja(369327638,1,this.Mhf);
this.U.ja(1658089342,1,this.dbf);this.U.ja(2924806476,1,this.cbf);this.U.ja(2740350877,1,this.cbf)}
wac_i1c.prototype={U:null,ua:null,SBf:null,Laa:null,jxe:null,E7e:!1,vwf:function(){if(!this.ua.ETe)return 2;this.E7e=!0;if(!(this.jxe&&0<this.jxe.na())){var a=wac_5k();this.ua.ETe&&(this.SBf=a,this.Laa="ToolbarButtonHome",this.jxe=new (wac_sa.$$(wac_fb))(null))}return 32},uwf:function(){if(!this.ua.ETe)return 2;this.E7e=!1;return 32},twf:function(a){if(!this.ua.ETe)return 2;a=wac_j1c(a);this.E7e&&3!==a&&this.jxe&&this.jxe.ga(new wac_fb(a,1));return 32},wwf:function(a){if(!this.ua.ETe)return 2;this.M9e(wac_j1c(a));
return 32},swf:function(a){if(!this.ua.ETe)return 2;a=wac_j1c(a);this.E7e&&3!==a&&this.jxe&&this.jxe.ga(new wac_fb(a,2));return 32},M9e:function(a){this.ua.ETe&&this.E7e&&3!==a&&this.jxe&&!wac_b_c(this.jxe,function(b){return b.rh()===a})&&this.jxe.ga(new wac_fb(a,0))}};function wac_j1c(a){switch(a){case 1724554274:case 2857549322:case 2924806476:a=0;break;case 4031196440:case 2760733910:a=1;break;case 369327638:case 1658089342:case 2740350877:a=2;break;default:a=3}return a}wac_Q1b.registerClass("PowerPointWebEditor.Designer.DesignerActor");
wac_6Gc.registerClass("PowerPointWebEditor.Designer.RequestState");wac_SGc.registerClass("PowerPointWebEditor.Designer.PendingRequest");wac_2Gc.registerClass("PowerPointWebEditor.Designer.DesignerRequestData");wac_W1b.registerClass("PowerPointWebEditor.Designer.DesignerContext",null,wac_X7);wac_N0c.registerClass("PowerPointWebEditor.Designer.BucketedEditorData");wac_X1b.registerClass("PowerPointWebEditor.Designer.DesignerManager",null,wac_Y7,Sys.IDisposable);
wac_51b.registerClass("PowerPointWebEditor.Designer.DesignerPane",null,wac_Z7,wac_AG,Sys.IDisposable);wac_8nc.registerClass("PowerPointWebEditor.Designer.DesignerPreviewImageView",null,wac_3nc);wac_71b.registerClass("PowerPointWebEditor.Designer.DesignerView",wac_CA,wac__7,wac_qs,wac_us,Sys.IDisposable);wac_a2b.registerClass("PowerPointWebEditor.Designer.DesignerViewHelper",null,wac_07);wac_c1c.registerClass("PowerPointWebEditor.Designer.IdeasPane",wac_51b,wac_8Yc,wac_Z7,wac_AG,Sys.IDisposable);(function(){}).registerClass("PowerPointWebEditor.Designer.IdeasPaneConstants");
wac_F0c.registerClass("PowerPointWebEditor.Designer.IdeasView",wac_71b,wac_9Yc,wac__7,wac_qs,wac_us,Sys.IDisposable);wac_b2b.registerClass("PowerPointWebEditor.Designer.PPTWebEditorDesignerPackage",null,wac_I,wac_i);wac_i1c.registerClass("PowerPointWebEditor.Infrared.IdeasContext",null,wac_wYc);var wac_a1c="Architecture Backgrounds Cities Nature People Technology".split(" ");wac_F0c.Xvf=["EditorPrev","EditorNext","EditorSuggestionContainer","EditorIgnore","EditorSeeMoreLabel"];
wac_J(wac_C(),wac_k4(new wac_b2b,0),0,!1);Type.registerNamespace("PowerPointWebEditor.Rehearsal");wac_Z=window.PowerPointWebEditor||{};wac_Z.Nzf=wac_Z.Nzf||{};function wac_k1c(){}wac_k1c.registerInterface("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor");function wac_l1c(){this.SB=Function.createDelegate(this,this.sC)}
wac_l1c.prototype={Ub:function(){return"PowerPointWebEditor.Rehearsal"},gc:function(a){this.J=a;var b=this;wac_n(wac_m(this.J.fa(wac_dIc),function(){return new wac_fIc(b.J.H(wac_hK),b.J.H(wac_QK),wac_Kt(b.J.H(wac_lt),7),wac_Kt(b.J.H(wac_lt),68),b.J.H(wac_3H))}));var c=this;wac_m(wac_n(this.J.fa(wac_k1c)),function(){return new wac_m1c(wac_z(),c.J.H(wac_dIc),c.J.H(wac_wEa),c.J.H(wac_R),wac_l(c.J,wac_Dc))});this.J.H(wac_k1c).Tb()},tb:function(){wac_.pa.Ok(this.SB)},sC:function(){var a=this.J.H(wac_R).A3e;
wac_1t("Microsoft.Office.Server.Powerpoint.Web.IPptRehearsalIsEnabledSettings");if(a){var b=this;wac_Zg(window.Common.App.AppLifecycleManager.get_instance(),7,function(){b.J.H(wac_k1c).adf()},3)}},O:function(){},J:null};function wac_m1c(a,b,c,d,e){this.Xtf=Function.createDelegate(this,this.Adf);this.cuf=Function.createDelegate(this,this.oAf);this.U=a;this.lYc=new wac_n1c(b,this.U,d);this.Epf=c;this.eEe=e}
wac_m1c.prototype={Tb:function(){this.U.ja(3890296866,1,this.cuf);this.U.ja(1607456269,1,this.Xtf)},oAf:function(a,b,c,d,e){switch(c){case 2:return wac_o1c(this.lYc,e),32;case 1:if(this.sgf)return 32;break;default:wac_Y(41793168,822,10,"ShowSummaryPage: Unimplemented action behavior")}return 8},Adf:function(a,b,c){switch(c){case 2:return this.Adf(),32;case 1:if(this.sgf)return 32;break;default:wac_Y(42825479,822,10,"ShowFloodgateSurvey: Unimplemented action behavior")}return 8},Adf:function(){this.eEe.uc(function(a){wac_mQc(a,
"PPTRehearsePresentationSurvey","PowerPointRehearsePresentationSurveyEnabled")})},adf:function(){var a=this;this.Epf.uje.MRd("rehearsalSummaryPage").then(function(){var b=wac_.pa.Qb.RehearsalSummaryPageCssUrl,c=document.createElement("link");c.setAttribute("rel","stylesheet");c.setAttribute("type","text/css");c.setAttribute("href",b);window.$addHandler(c,"load",function(){a.sgf=!0});document.body.appendChild(c);return null})},Epf:null,sgf:!1,U:null,lYc:null,eEe:null};
function wac_n1c(a,b,c){this.dif=Function.createDelegate(this,this.ryf);this.SGa=a;this.U=b;this.ua=c}wac_n1c.prototype={SGa:null,U:null,ua:null,ryf:function(a){"MainApp"===a.target.id&&(a.preventDefault(),a.stopPropagation())}};function wac_p1c(a,b){var c=Array(b.length);if(!a.SGa)return c;var d=a.SGa.tge();a=wac_hIc(a.SGa);for(var e=0;e<b.length;e++){var f=a[d[b[e]].Vc().toString()];f&&f.ePe.length&&(c[e]=f.ePe)}return c}
function wac_q1c(a){wac_Y(51144077,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback button clicked.");a.U&&(a.ua.Bkf?a.U.os(1607456269,2,null,null):a.U.os(802602464,2,!1,null))}
function wac_o1c(a,b){try{var c=document.createElement("div");c.id="SummaryPageOverlay";c.style.width="100%";c.style.height="100%";c.style.zIndex=850;c.style.display="flex";c.style.flexDirection="column";c.style.justifyContent="center";c.style.position="absolute";document.body.insertBefore(c,document.body.firstChild);var d=c.parentNode;wac_tf(d,"keydown",a.dif);for(var e=wac_p1c(a,b.originalityProblemSlides),f=0,g=0;g<e.length;g++)e[g]||f++;wac_Y(42320001,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: number of slide thumbs requested = {0}, number of slides not found in cache = {1}",
e.length,f);b.originalityProblemSlideImgSrcs=e;e={};e.fFeedbackCardEnabled=a.ua.mkf;(new window.rehearsalSummaryPage.RehearsalSummaryPageController(c,b,function(){wac_Y(51144073,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Try Again button clicked.");a.U&&(c.parentNode.removeChild(c),a.U.os(1256345977,2,null,null))},function(){wac_jg(d,"keydown",a.dif)},a.ua.M4,window.decodeURIComponent(a.ua.H7a),function(){wac_q1c(a)},e)).renderSummaryPage();a.ua.wjf&&wac_q1c(a)}catch(h){wac_Y(51144075,
817,10,"RehearsalSummaryPageHelper::ShowRehearsalSummary Exception while generating summary page: {0}",h.toString())}}wac_l1c.registerClass("PowerPointWebEditor.Rehearsal.PPTWebEditorRehearsalPackage",null,wac_I,wac_i);wac_m1c.registerClass("PowerPointWebEditor.Rehearsal.RehearsalSummaryPageActor",null,wac_k1c);wac_n1c.registerClass("PowerPointWebEditor.Rehearsal.RehearsalSummaryPageHelper");wac_J(wac_C(),new wac_l1c,0,!1);Type.registerNamespace("PowerPointWebEditor");
wac_Z=window.PowerPointWebEditor||{};
function wac_mZ(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,v,u,w){this.Ile=Function.createDelegate(this,this.dve);this.Jle=Function.createDelegate(this,this.eve);this.cba=Function.createDelegate(this,this.iQa);this.Mic=Function.createDelegate(this,this.G4d);this.Idc=Function.createDelegate(this,this.zAc);this.Kfc=Function.createDelegate(this,this.bBc);this.Hfc=Function.createDelegate(this,this.aBc);this.iba=Function.createDelegate(this,this.Dda);this.RB=Function.createDelegate(this,this.RG);this.Qee=Function.createDelegate(this,
this.Jye);this.tP=Function.createDelegate(this,this.MM);this.ha=a;this.ra=b;this.Ea=c;this.Ib=d;this.hY=e;this.Kz=f;this.U=g;this.Rp=h;this.SY=k;this.Ru=l;this.oua=n;this.$S=p;this.I2a=q;this.Qg=r;this.g$=t;this.pb=v;this.Ob=u;this.Ej=m;this.Y2=w;this.qe=!1}
wac_mZ.prototype={ha:null,ra:null,Ea:null,Ib:null,hY:null,Kz:null,U:null,Rp:null,SY:null,Ru:null,Ej:null,oua:null,$S:null,I2a:null,Qg:null,g$:null,pb:null,Ob:null,q6b:!1,J6b:!1,Y2:null,$rb:!1,qe:!1,Kn:function(){this.qe||(this.JQ(),this.J6b=2===this.Ob.Kb(),this.qe=!0)},JQ:function(){wac_Cv(this.ha,this.tP);this.oua.Psa.xa("MU",this.Qee);this.Kz.tX(this.RB);wac_TY(this.$S,this.iba);this.Qg.la.xa("ROIU",this.Hfc);this.SY.la.xa("ReplaceObjectViewDE",this.Kfc);wac_JSb(this.hY,this.Idc);this.Kz.la.xa("CH",
this.Mic);this.Ob.N9(this.cba);this.Qg.la.xa("AROSBSR",this.Jle);this.Qg.la.xa("AROSASR",this.Ile)},O:function(){this.qe&&(wac_my(this.ha,this.tP),this.oua.Psa.sb("MU",this.Qee),this.Kz.xua(this.RB),this.$S.$$b.sb("SPC",this.iba),this.Qg.la.sb("ROIU",this.Hfc),this.SY.la.sb("ReplaceObjectViewDE",this.Kfc),wac_lMb(this.hY,this.Idc),this.Ob.Ija(this.cba),this.Kz.la.sb("CH",this.Mic),this.Qg.la.sb("AROSBSR",this.Jle),this.Qg.la.sb("AROSASR",this.Ile),this.qe=!1)},$za:function(a){return this.q6b&&this.J6b?
this.I2a.RSa(a):!1},yfe:function(a){switch(a){case 4041021629:case 2888832796:case 1982565441:case 2869688532:case 3205718471:case 4185984924:case 123670621:return!0;default:return!1}},eve:function(){this.$rb=!0},dve:function(){this.$rb=!1},tfe:function(a){return a?"data:image/png;base64,"+a:null},iQa:function(a){wac_Y(36544854,829,50,"BaseReplaceObjectManager::OnAppFrameModeSwitched, frame mode switched to :{0}",a.Kb());this.J6b=2===a.Kb()},G4d:function(){this.q6b||wac_Y(36544856,829,50,"BaseReplaceObjectManager::UpdateEditState, updating edit state");
this.q6b=!0}};
function wac_Snc(a,b,c,d){if(c.dv)if(c.UKa&&b.bC)wac_Y(38115480,829,10,"HandleReplaceObjectResponse - first reponse should have notification type : Normal. NotificationType: {0}",b.bC);else{if(b.bC)if(1===b.bC){if(!b.OT){wac_Y(38115488,829,10,"HandleReplaceObjectResponse - empty suggestions. CorrelationId {0}",b.Nd);return}c.n3e(wac_Krb(a,b.OT,b.F4));c.Kwa=new Date;d.zy&&wac_qZ(a,b.Nd,c.Yc(),c.wLa(),"Success")}else 2===b.bC&&(c.Goc=!1,c.Iua(b.rx),wac_qZ(a,c.Nd,b.rx,c.wLa(),"Success"));else{if(0>=
b.F4){wac_Y(38115482,829,50,"HandleReplaceObjectResponse - Reponse failed. CorrelationId {0}",b.Nd);a.nM(c,"NoSuggestions");return}if(b.F4<d.Lne){wac_Y(38115484,829,50,"HandleReplaceObjectResponse - not enough suggestions returned. CorrelationId {0}",b.Nd);a.nM(c,"LowSuggestions");return}wac_tZ(c,!1);c.n3e(wac_Krb(a,b.OT,b.F4));wac_Trb(c,b.F4);wac_Y(38115486,829,50,"HandleReplaceObjectResponse - suggestions returned: {0}. CorrelationId {1}",c.TZ,b.Nd)}d=c.Ay;c.Ks&&c.Ks.Uj()&&d&&d.Uj()&&a.Ej.k6(d)&&
a.q6b&&a.J6b&&(1===b.bC?wac_Urb(a.Ru,c.Nd):wac_Irb(a.Ru,d))}else wac_Y(38115478,829,15,"HandleReplaceObjectResponse - No session active. Reponse CorrelationId: {0}",b.Nd)}function wac_qZ(a,b,c,d,e){a.Y2.uc(function(a){var g,h=(g=new wac_qpb,g.correlationId=b,g.shapeId=c,g.suggestions=d,g);a.ZMd(e,h)})}
function wac_Krb(a,b,c){var d=[];if(!b)return d;b=b.split(";");if(b.length<c)return wac_Y(37065230,829,10,"BaseReplaceObjectManager::ParseSuggestions - suggestionCount:{0}, resultLength:{1}",c,b.length),d;for(var e=0;e<c;++e){var f=b[e].split(":");if(3!==f.length)throw a=String.format("Invalid format of suggestion item. Index: {0}, SuggestionItem: {1}",e,b[e]),wac_Y(37065232,829,50,"BaseReplaceObjectManager::ParseSuggestions - {0}",a),Error.create(a);var g=wac_ulc(Number.parseInvariant(f[1]),1,177,
"L_SAType"),h;Array.add(d,(h=new wac_opb,h.index=f[0],h.labelText=g?g:ResourceStrings.L_SmartArt,h.imageData=a.tfe(f[2]),h))}return d}Type.registerNamespace("PowerPointWebEditor.ReplaceObject");wac_Z.lPb=wac_Z.lPb||{};function wac_Tnc(){}wac_Tnc.registerInterface("PowerPointWebEditor.ReplaceObject.IFlyoutAnchor");function wac_rZ(){}wac_rZ.registerInterface("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager");function wac_Orb(){}wac_Orb.registerInterface("PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager");
function wac_Prb(){}wac_Prb.registerInterface("PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls");function wac_Qrb(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,v,u,w,x,z,y,A,B){this.Ggc=Function.createDelegate(this,this.qUd);this.Ehc=Function.createDelegate(this,this.YBc);this.Fhc=Function.createDelegate(this,this.FXd);wac_Qrb.initializeBase(this,[h,c,d,e,f,g,k,l,m,n,p,t,v,u,w,z,y,A,B]);this.Ez=a;this.a4b=b;this.za=q;this.d2c=r;this.ua=x;this.$9b=this.ua.Zrc}
wac_Qrb.prototype={Ez:null,a4b:null,za:null,d2c:null,ua:null,$9b:!1,JQ:function(){if(this.ua.W7a){var a=this;this.a4b.uc(function(b){b.d5("ShapeTextConvertable",a.Fhc)})}else{var b=this;this.Ez.uc(function(a){a.d5("ShapeTextConvertable",b.Ehc)})}this.Qg.la.xa("SSS",this.Ggc);wac_mZ.prototype.JQ.call(this)},O:function(){if(this.qe){if(this.ua.W7a){var a=this;this.a4b.uc(function(b){b.Nna("ShapeTextConvertable",a.Fhc)})}else{var b=this;this.Ez.uc(function(a){a.Nna("ShapeTextConvertable",b.Ehc)})}this.Qg.la.sb("SSS",
this.Ggc)}wac_mZ.prototype.O.call(this)},YBc:function(a,b){if(a&&b){var c,d;try{c=wac_yl(a),d=wac_yl(b)}catch(f){wac_Y(26080646,829,10,"AugmentationLoopReplaceObjectManager::OnSmartArtConvertable - Try parse aug response failed");return}if(c&&!window.isNaN(c.sid)&&!window.isNaN(c.cid)&&!window.isNaN(c.shapeId)&&(a=new Date(c.c),b=c.c?(new Date).getTime()-c.c:-1,wac_Y(34181982,829,50,"ALEvent received: Slide:{0}|{1}, Shape:{2}, TriggerName:{3}, ElapsedTimeInMs:{4}",c.sid,c.cid,c.shapeId,c.t,b),(b=
wac_fO(this.Ea.Ja(),c.shapeId))&&(wac_jm(wac_Rrb(this),b.Yc())||c.t===wac_Z.OI.Fea.toString(1))))if(d&&!d.isTextConvertible)wac_sZ(this.Ru,b,!0,!0,!1);else{var e=this.Rp.jJ(b.Yc());if(e&&e.CZ&&(e=new wac_vK(b,e.U4),this.U.os(3825036569,2,e,null),!e.Dka))return;this.$za(b)&&(d=d&&d.smartArtInfo?d.smartArtInfo.length:0,this.HG(this.Ea.Ja(),b,d,c.t||"AugLoopDefault","",a))}}},FXd:function(a,b,c,d){b&&d&&d.ContextId&&d.Payload&&this.YBc(d.ContextId,d.Payload)},qUd:function(){wac_Srb(this,"SlideShowStarted")},
MM:function(a,b){if(!this.qe)wac_Y(26042393,829,50,"AugmentationLoopReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.$rb&&(b.ds.length||!this.ra.Re()||"document"!==this.ra.Re().Kd)){a=wac_Rrb(this);for(b=this.Rp.$$ge();b.$$mn();){var c=b.$$cu();c.dv&&!Array.contains(a,c.Yc())&&this.nM(c,"SelectionChanged")}this.$9b&&!Array.contains(a,this.Ru.EZ)&&(a=this.Ru,-1!==a.EZ&&(b=wac_fO(a.Ea.Ja(),a.EZ))&&wac_sZ(a,b,!0,!0,!1))}},bBc:function(a,b){this.qe?(a=this.Rp.jJ(b.Ay.Yc()))&&
a.dv&&(b=a.Ay,this.nM(a,"ShapePositionChanged"),this.$za(b)&&this.HG(this.Ea.Ja(),b,0,"AugLoopRetrigger","ShapePositionChanged",null)):wac_Y(26042395,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")},Jye:function(a,b){b.MKa&&this.cE(b.Ii)},RG:function(){wac_Srb(this,"SlideNavigation")},Dda:function(a,b){if(b.DKa&&b.yq){a=b.yq;b=a.length;for(var c=0;c<b;++c){var d=this.Rp.jJ(a[c]);d&&d.dv&&this.nM(d,"ShapePresence")}}},aBc:function(a,b){(a=this.Rp.GOa(b.Nd))?
wac_Snc(this,b,a,this.ua):wac_Y(26042397,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectResponse, No session active. Reponse CorrelationId: {0}",b.Nd)},zAc:function(){if(this.qe)for(var a=this.Rp.$$ge();a.$$mn();){var b=a.$$cu();!b.B6a||b.QN||this.Ib.Ac(this.Ea.Yj)||(wac_Frb(b,!1),wac_sZ(this.Ru,b.Ay,!0,!0,!1))}},$za:function(a){var b=this.Rp.ETc();return b>=this.ua.asc?(wac_Y(34223842,829,50,"AugmentationLoopReplaceObjectManager::ShouldGenerateSuggestion, too many floaties[{0}] showing on the slide.",
b),!1):wac_mZ.prototype.$za.call(this,a)},HG:function(a,b,c,d,e,f){try{var g=this.Rp.jJ(b.Yc());g&&this.nM(g,"NewSession");g=this.Rp.Axa(a,b.Yc(),d,e,this.ua);g.ZLa=f;wac_Vrb(g,"richEditTextUnicodeChanged"===d);this.Ru.Ggb(g.Nd);var h=wac_Wrb(this.d2c,g);wac_Y(34144971,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, state:{4}",g.Nd,g.Ks.Vc(),g.Ks.fe(),g.Yc(),h);wac_Y(34097054,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion, text can convert to SmartArt, correlation id: {0}, returned suggestion count: {1}, should take suggestion count: {2}, trigger reason: {3}",
g.Nd,c,Math.min(c,this.ua.ACb),d);c&&this.ua.bsc&&(c=Math.min(c,this.ua.ACb),g.n3e(wac_r1c(c)),wac_Trb(g,c),wac_tZ(g,!1),wac_Irb(this.Ru,b));!h&&this.ua.zy&&wac_qZ(this,g.Nd,g.Yc(),[],"Pending")}catch(k){wac_Y(34152522,829,10,"GenerateSuggestion failed!! {0} ",k.message)}},cE:function(a){this.qe?this.yfe(a)||wac_Srb(this,"WebActionId:"+this.g$.ETd(a)):wac_Y(26042447,829,15,"AugmentationLoopReplaceObjectManager::HandleAction - called before setup")},nM:function(a,b){if(!a.QN){if("NoSuggestions"===
b)wac_sZ(this.Ru,a.Ay,!0,!0,!1);else if(a.CZ){var c=this.Ru,d=a.Ay,e;this.$9b?(e=wac_5M(this.ha),e=a.CZ&&Array.contains(e,a.Ay)):e=!1;wac_sZ(c,d,!0,"NewSession"!==b,e)}this.Rp.mJb(a,b);this.ua.zy&&wac_qZ(this,a.Nd,a.Yc(),a.wLa(),"NoResult")}}};function wac_Rrb(a){a=wac_5M(a.ha);var b=[];a&&Array.forEach(a,function(a){Array.add(b,a.Yc())});return b}function wac_Srb(a,b){for(var c=a.Rp.$$ge();c.$$mn();){var d=c.$$cu();a.nM(d,b)}}
function wac_r1c(a){for(var b=Array(a),c=0;c<a;c++){var d;Array.add(b,(d=new wac_opb,d.index=c.toString(),d.labelText=ResourceStrings.l_Loading,d.imageData=null,d))}return b}function wac_Unc(a,b){this.c8b=window.Box4.App.Fn;this.ua=a;this.pb=b}wac_Unc.prototype={ua:null,pb:null,c8b:null,uyb:!1};function wac_Vnc(a,b){var c=new wac_D(2,1,550,function(){b()},0,null,!1);a.pb.Hb(c)}
function wac_Wnc(a,b){a.uyb=!0;a.c8b=new Date;var c=new wac_D(2,1,a.ua.$rc,function(){a.uyb&&new Date-a.c8b>=a.ua.$rc&&b()},0,null,!1);a.pb.Hb(c)}function wac_Xnc(a,b,c,d,e,f,g,h,k){this.Wua=Function.createDelegate(this,this.lna);this.Qle=Function.createDelegate(this,this.nve);this.$Ia=Function.createDelegate(this,this.sl);this.Xia=a;this.oc=b;this.Xo=c;this.FY=d;this.faa=e;this.ed=g;this.ua=f;this.NCb=k}
wac_Xnc.prototype={D$:null,fY:null,Xia:null,oc:null,Xo:null,FY:null,faa:null,ed:null,NCb:null,ua:null,qe:!1,ofe:function(){this.ua.yCb?this.fY.setAttribute("Src",this.ed.Io("BLUEBOLT_Deactivated.gif")):this.fY.style.opacity=".3";wac_Wnc(this.NCb,this.$Ia)},pfe:function(){this.ua.yCb?this.fY.setAttribute("Src",this.ed.Io("BLUEBOLT_Reactivated.gif")):this.fY.style.opacity="initial";this.NCb.uyb=!1},Ki:function(){this.ua.yCb?this.fY.setAttribute("Src",this.ed.Io("BLUEBOLT_Entrance.gif")):this.fY.setAttribute("Src",
this.ed.Io("LightningIdeasOOUI_blue_32x.png"))},sl:function(){if(this.ua.yCb){this.fY.setAttribute("Src",this.ed.Io("BLUEBOLT_Exit.gif"));var a=this;wac_Vnc(this.NCb,function(){a.Xia.Oa.style.visibility="hidden"})}else this.fY.setAttribute("Src",""),this.Xia.Oa.style.visibility="hidden"},Kn:function(){this.qe||(this.Xia?(this.D$=new wac_FG,this.D$.Oa.style.visibility="inherit",this.D$.Oa.style.position="absolute",this.fY=wac_SG(),this.fY.setAttribute("Unselectable","on"),this.fY.setAttribute("role",
"presentation"),this.fY.className="gifFloatie",this.D$.Oa.appendChild(this.fY),this.Xia.Ce(this.D$),this.pRa()):wac_Y(38072903,829,15,"parentElement is null"),this.qe=!0)},nve:function(a){var b;switch(this.ua.zCb){case 7:b="BLUEBOLT_Hover_on.gif";break;case 8:b="BLUEBOLT_HoverWhite_On.gif";break;default:b="BLUEBOLT_Hover_on.gif"}this.fY.setAttribute("Src",this.ed.Io(b));return this.faa(a)},lna:function(){var a;switch(this.ua.zCb){case 7:a="BLUEBOLT_Hover_off.gif";break;case 8:a="BLUEBOLT_HoverWhite_Off.gif";
break;default:a="BLUEBOLT_Hover_off.gif"}this.fY.setAttribute("Src",this.ed.Io(a));return!0},pRa:function(){this.FY&&this.oc.ya("click",this.fY,this.FY);this.faa&&(this.Xo.ya("msospPointerOver",this.fY,this.Qle),this.Xo.ya("msospPointerOut",this.fY,this.Wua))},jje:function(){this.FY&&this.oc.ub("click",this.fY,this.FY);this.faa&&(this.Xo.ub("msospPointerOver",this.fY,this.Qle),this.Xo.ub("msospPointerOut",this.fY,this.Wua))},O:function(){this.sl();this.jje();this.qe=!1}};function wac_Xrb(){}
wac_Xrb.prototype={J:null,H7b:!1,cle:!1,uD:!1,Ub:function(){return"PowerPointWebEditor.ReplaceObject"},gc:function(a){this.J=a;if(this.uD=this.J.H(wac_3L).Ta.Fo){var b=this;wac_m(wac_n(this.J.fa(wac_WF)),function(){return new wac_WF(wac_.Af,b.J.H(wac_VF),b.J.H(wac_fG),b.J.H(wac_jG),b.J.H(wac_NF),b.J.H(wac_dd),b.J.H(wac_Uc))})}wac_m(wac_n(wac_o(wac_o(wac_o(a.fa(wac_Yrb),wac_ZY),wac_XY),wac_YY)),function(){return new wac_Yrb});wac_m(wac_n(a.fa(wac_vZ)),function(){return new wac_vZ(a.H(wac_9G),a.H(wac_eK),
a.H(wac_Nt))});wac_m(wac_n(a.fa(wac_kZ)),function(){return new wac_Zrb(a.H(wac_9G),a.H(wac_cd),a.H(wac_8c),a.H(wac_Nt),a.H(wac_Oc),a.H(wac_XY),a.H(wac_rZ),a.H(wac_PF),a.H(wac_JL),a.H(wac_zG),a.H(wac_R),a.H(wac_ed))});wac_m(wac_n(a.fa(wac_Prb)),function(){return new wac__rb(a.H(wac_R),a.H(wac_IH),a.H(wac_vZ))});wac_m(wac_n(a.fa(wac_wZ)),function(){return new wac_wZ(a.H(wac_Prb),a.H(wac_vZ),a.H(wac_Lt),a.H(wac_Nt),a.H(wac_R))});wac_m(wac_n(a.fa(wac_Orb)),function(){return new wac_0rb(a.H(wac_aY),a.H(wac_vZ),
a.H(wac_R).g$c)});wac_m(wac_n(a.fa(wac_rZ)),function(){return wac_q(a.H(wac_Uc),wac_2(473))?new wac_xZ(function(b,c,d,h,k,l){var m=new wac_1rb(a.H(wac_Lt),a.H(wac_aY),wac_l(a,wac_AY));m.N6a(b,c,d,h,k,l);return m}):new wac_yZ(new wac_1rb(a.H(wac_Lt),a.H(wac_aY),wac_l(a,wac_AY)))});wac_m(wac_n(a.fa(wac_lZ)),function(){return wac_q(a.H(wac_Uc),wac_2(473))?new wac_Qrb(wac_l(a,wac_2Y),wac_l(a,wac_3Y),a.H(wac_zG),a.H(wac_Nt),a.H(wac_Jt),a.H(wac_AJ),a.H(wac_3H),a.H(wac_It),a.H(wac_Oc),a.H(wac_rZ),a.H(wac_YY),
a.H(wac_zZ),a.H(wac_vZ),a.H(wac_Lt),a.H(wac_Orb),a.H(wac_jY),a.H(wac_RY),a.H(wac_wZ),a.H(wac_NL),a.H(wac_R),a.H(wac_mM),a.H(wac_dd),a.H(wac_kG),wac_l(a,wac_AY)):new wac_2rb(a.H(wac_zG),a.H(wac_Nt),a.H(wac_Jt),a.H(wac_AJ),a.H(wac_3H),a.H(wac_It),a.H(wac_Oc),a.H(wac_rZ),a.H(wac_YY),a.H(wac_zZ),a.H(wac_vZ),a.H(wac_aY),a.H(wac_jY),a.H(wac_RY),a.H(wac_wZ),a.H(wac_NL),a.H(wac_R),a.H(wac_mM),a.H(wac_dd),a.H(wac_kG),wac_l(a,wac_AY))});wac_m(wac_n(a.fa(wac_zZ)),function(){return new wac_zZ(a.H(wac_Nt),a.H(wac_MK.$$(wac_cK)),
a.H(wac_MK.$$(wac_dK)),a.H(wac_Lt),a.H(wac_rZ),a.H(wac_YY),a.H(wac_vZ),a.H(wac_kZ),a.H(wac_zG),a.H(wac_Us).Cb(),a.H(wac_IH))});wac_m(wac_n(a.fa(wac_Unc)),function(){return new wac_Unc(a.H(wac_R),a.H(wac_dd))});wac_m(wac_n(a.fa(wac_AZ)),function(){return new wac_AZ(a.H(wac_8c),a.H(wac_cd),a.H(wac_9G),a.H(wac_UX),a.H(wac_R),a.H(wac_5F),a.H(wac_Unc))});wac_m(wac_n(a.fa(wac_MK.$$(wac_cK))),function(){return new (wac_VK.$$(wac_cK))(function(b,c){var d=null,h=window.$$as(wac_5J,wac_T(b,a.H(wac_Us).Cb()));
h&&!h.Fu()&&h.Gs&&(d=new wac_3rb(b,h,c,a.H(wac_AZ),a.H(wac_Oc),a.H(wac_9G),a.H(wac_Rt),a.H(wac_rZ),a.H(wac_XY),a.H(wac_R),a.H(wac_kZ)),d.Kn());return d})});wac_m(wac_n(a.fa(wac_MK.$$(wac_dK))),function(){return new (wac_VK.$$(wac_dK))(function(b,c){var d=null,h=window.$$as(wac_5J,wac_T(b,a.H(wac_Us).Cb()));h&&!h.Fu()&&h.Gs&&(d=new wac_4rb(b,h,c,a.H(wac_AZ),a.H(wac_vZ)),d.Kn());return d})});var c=this;wac_m(wac_n(wac_o(a.fa(wac_5rb),wac_4Y)),function(){return new wac_5rb(wac_l(c.J,wac_2Y),c.J.H(wac_lZ),
c.J.H(wac_wZ))});var d=this;wac_m(wac_n(a.fa(wac_BZ)),function(){return new wac_BZ(wac_l(d.J,wac_3Y),d.J.H(wac_4Y))});wac_m(wac_n(a.fa(wac_8$)),function(){return new wac_8$(a.H(wac_It),a.H(wac_Oc),a.H(wac_zG),a.H(wac_3H),a.H(wac_Nt),a.H(wac_Jt),a.H(wac_XY),a.H(wac_NL),a.H(wac_rZ),a.H(wac_dI),a.H(wac_zZ),a.H(wac_KL),a.H(wac_IH))});wac_m(wac_n(a.fa(wac_Ync)),function(){return new wac_Ync(a.H(wac_It),a.H(wac_NL),a.H(wac_rZ),a.H(wac_Nt),a.H(wac_IH),a.H(wac_R),a.H(wac_zZ),a.H(wac_aY),a.H(wac_vZ),a.H(wac_RY),
a.H(wac_AJ),a.H(wac_GJ),a.H(wac_jY),a.H(wac_mM),a.H(wac_mG))})},tb:function(){this.uD&&this.J.H(wac_WF);var a=this.J.H(wac_Uc),b=this;a.Ok(function(){var c=new Date;b.H7b=wac_q(a,wac_2(463));b.H7b&&(wac_q(a,wac_2(499))&&b.J.H(wac_BZ).Yd(),b.J.H(wac_kZ).Kn(),b.J.H(wac_zZ).Kn(),b.J.H(wac_8$).Kn(),b.J.H(wac_lZ).Kn());b.cle=wac_q(a,wac_2(676));b.cle&&(b.J.H(wac_kZ).Kn(),b.J.H(wac_zZ).Kn(),b.J.H(wac_8$).Kn(),b.J.H(wac_Ync).Kn());wac_Y(40158946,829,50,"ReplaceObject::Callback duration:{0}",new Date-c)})},
O:function(){this.H7b&&(this.J.H(wac_kZ).O(),this.J.H(wac_lZ).O(),this.J.H(wac_zZ).O(),this.J.H(wac_8$).O());this.cle&&(this.J.H(wac_kZ).O(),this.J.H(wac_zZ).O(),this.J.H(wac_8$).O(),this.J.H(wac_Ync).O())}};
function wac_Ync(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r){this.Zgc=Function.createDelegate(this,this.TUd);this.Cse=Function.createDelegate(this,this.pve);this.Wee=Function.createDelegate(this,this.rCe);this.lJa=Function.createDelegate(this,this.oQa);this.iba=Function.createDelegate(this,this.Dda);this.EEe=Function.createDelegate(this,this.CMe);this.Gle=Function.createDelegate(this,this.bve);this.Hle=Function.createDelegate(this,this.cve);this.tP=Function.createDelegate(this,this.MM);this.Rle=Function.createDelegate(this,
this.ove);this.Qg=b;this.ha=a;this.Rp=c;this.Ea=d;this.jd=e;this.ua=f;this.Ru=g;this.kf=h;this.Ej=k;this.$S=l;this.hY=m;this.F$=n;this.Sac=p;this.g$=q;this.kC=r}
wac_Ync.prototype={Qg:null,Ea:null,ha:null,Rp:null,jd:null,ua:null,Ru:null,kf:null,Ej:null,$S:null,hY:null,F$:null,Sac:null,g$:null,kC:null,lx:null,$rb:!1,JQ:function(){this.Qg.la.xa("ISIU",this.Rle);wac_Cv(this.ha,this.tP);this.Qg.la.xa("AROSBSR",this.Hle);this.Qg.la.xa("AROSASR",this.Gle);this.Qg.la.xa("IC",this.EEe);wac_TY(this.$S,this.iba);wac_JSb(this.hY,this.lJa);this.Sac.Psa.xa("MU",this.Wee)},ije:function(){this.Qg.la.sb("ISIU",this.Rle);wac_my(this.ha,this.tP);this.Qg.la.sb("AROSBSR",this.Hle);
this.Qg.la.sb("AROSASR",this.Gle);this.Qg.la.sb("IC",this.EEe);this.$S.$$b.sb("SPC",this.iba);wac_lMb(this.hY,this.lJa);this.Sac.Psa.sb("MU",this.Wee)},O:function(){this.ije()},Kn:function(){this.JQ()},cve:function(){this.$rb=!0},bve:function(){this.$rb=!1},CMe:function(a,b){b&&this.lx&&this.lx.Fje&&this.lx.Ks.Vc()===b.Ls.Vc()&&this.lx.Ks.fe()===b.Ls.fe()&&this.lx.Yc()===b.rx&&this.lx.Gm()===b.Fac&&(this.lx.CBe=b.mFe)},Dda:function(a,b){if(b.DKa&&b.yq&&this.lx){a=b.yq;b=a.length;for(var c=0;c<b;++c){var d=
a[c];this.lx.Yc()===d&&this.lQ("ShapePresence")}}},rCe:function(a,b){b.MKa&&!this.yfe(b.Ii)&&this.lQ("WebActionId:"+this.g$.ETd(b.Ii))},yfe:function(a){switch(a){case 4041021629:case 2888832796:case 1982565441:case 2869688532:case 3205718471:case 4185984924:case 123670621:return!0;default:return!1}},oQa:function(){if(this.lx){var a=this.lx.Ay,b=wac_BO(a);a&&b&&!this.F$.Ac(b)&&(wac_Frb(this.lx,!1),wac_sZ(this.Ru,a,!0,!0,!1),this.lx.vCc=new Date,this.lx.lQ("SelectionChanged"))}},MM:function(){if(!this.$rb){var a=
wac_XT(wac_5M(this.ha));if(a){if(this.lx&&this.lx.dv){if(wac_Enc(a.fsa(),this.lx.fsa()))return;this.lQ("SelectionChanged")}this.$za(a)&&this.HG(this.Ea.Ja(),a,"SelectShape")}else this.lx&&this.lx.dv&&this.lQ("SelectionChanged")}},HG:function(a,b,c){this.lx=this.Rp.N6a(a,b.Yc(),c,"",this.ua,b.Gm());wac_tZ(this.lx,!0);this.Ru.Ggb(this.lx.Nd);wac_Y(38279303,829,50,"ReplaceIconManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, SmartArtSubNodeId:{4}",this.lx.Nd,this.lx.Ks.Vc(),
this.lx.Ks.fe(),this.lx.Yc(),this.lx.Gm().toString());var d=b.Gm()?wac_BO(b):b;d?wac_znc(this.kf,a.fe(),a.Vc(),d.Yc(),wac_CZ(d),wac_DZ(d),"{"+b.Gm().toString().toUpperCase()+"}",this.lx.Nd,c,this.Cse,this.Zgc):wac_Y(38279305,829,15,"Parent ShapeNode of a {0} is null",b.Gm()?"SmartArtSubShape":"NormalShape")},pve:function(a){if(a&&a.SuggestionResult){var b=a.CorrelationId,c=this.Rp.GOa(b);if(c)if(c.dv){b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(a.SuggestionResult)}catch(d){wac_Y(38625546,
829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - Deserialize exception: {0}",d)}if(b){c.n3e(wac_s1c(this,b));c.Kwa=new Date;if(c.UKa){if(wac_Ewc(this,c)){wac_Y(39184097,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - client suggestion timeout in {0}, expected in {1}",c.Hfe,this.ua.kye);this.lQ("ClientSuggestionTimeOut");return}wac_Y(38279317,829,50,"ReplaceIconManager::OnReplaceObjectResponse, response arrives before notification");wac_Trb(c,c.wLa()?c.wLa().length:0);wac_tZ(c,
!1);wac_Irb(this.Ru,c.Ay)}wac_Urb(this.Ru,c.Nd)}else this.lQ("ServerError"),wac_Y(38279311,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - suggestion result is null")}else wac_Y(38279315,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, sessio is not active . Selection might change to new shape, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.lx?this.lx.Nd:"",b);else wac_Y(38279313,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",
b)}else this.lQ("ServerError"),wac_Y(38279309,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - response object or reponse suggestionresult is null")},TUd:function(a){this.lQ("ServerError");wac_Y(38279319,829,15,"ReplaceIconManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",a.HttpStatusCode);return!0},$za:function(a){return this.kC.raa()?a.Gm()&&wac_zO(a)?(a=wac_BO(a),!!a&&!a.gA):!1:!1},lQ:function(a){this.lx&&(wac_sZ(this.Ru,this.lx.Ay,!0,!0,!1),this.Rp.mJb(this.lx,
a),this.lx=null)},tfe:function(a){return a?a.startsWith("<svg")?"data:image/svg+xml;charset=utf8,"+window.encodeURIComponent(a):"data:image/png;base64,"+a:null},ove:function(a,b){var c,d,e,f,g,h;b=b.OT;var k=c={val:c},l=d={val:d},m=e={val:e};a=f={val:f};k.val="";l.val=0;m.val=0;a.val=null;if(b){var n=b.split("|");if(4!==n.length)wac_Y(38279325,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue length is not equals to 4, actural:"+b.length),h=!1;else{k.val=n[0];l.val=window.parseInt(n[1]);
m.val=Number.parseInvariant(n[2]);m=n[3];b=l.val;k=[];if(m&&b){for(l=0;l<b;++l)n=(h=new wac_opb,h.index=l.toString(),h.labelText="",h.imageData=null,h.renderData=null,h),Array.add(k,n);h=m.split(";");if(h.length-1!==b)wac_Y(38618200,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, the suggestion counts parsing from suggestion string do not match, expected:{0}, actural:{1} ",k.length,b);else for(l=0;l<b;++l)m=h[l].indexOf(":"),0>m?wac_Y(38279321,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, Suggestion string does not contain :"):
k[l].labelText=h[l].substr(m+1)}a.val=k;h=!0}}else wac_Y(38279323,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue is null or empty"),h=!1;(g=h,c=c.val,d=d.val,e=e.val,f=f.val,g)?(g=this.Rp.GOa(c))?g.dv&&g.UKa?(h=g.Ay,e||(0>=d?(wac_Y(38279361,829,50,"ReplaceIconManager::OnReplaceObjectResponse, Reponse failed. CorrelationId {0}",c),this.lQ("NoSuggestions")):wac_Ewc(this,g)?(wac_Y(39184137,829,15,"ReplaceIconManager::OnIconSuggestionNotification - client suggestion timeout in {0}, expected in {1}",
g.Hfe,this.ua.kye),this.lQ("ClientSuggestionTimeOut")):(wac_tZ(g,!1),wac_Trb(g,d),g.n3e(f),wac_Y(38279363,829,50,"ReplaceIconManager::OnReplaceObjectResponse, get response from GetReplaceObject request, correlation id: {0}, suggestion count: {1}",g.Nd,g.TZ),wac_Irb(this.Ru,h)))):wac_Y(38279331,829,50,"ReplaceIconManager::OnIconSuggestionNotification: Skip notification since: IsSessionActive {2}, IsWaitingForResponse {3}. Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.lx?this.lx.Nd:"",
c,g.dv,g.UKa):wac_Y(38279329,829,50,"ReplaceIconManager::OnIconSuggestionNotification, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",c):wac_Y(38279327,829,50,"ReplaceIconManager::OnIconSuggestionResponse, IconSuggestionnotification parse failed")}};function wac_Ewc(a,b){var c=new Date,d=b.U4;a=a.ua.kye;return c&&d&&0<a&&c-d>a?(b.Hfe=c-d,!0):!1}
function wac_s1c(a,b){var c=[];if(!b||!b.length)return c;for(var d=0;d<b.length;++d){var e,f=(e=new wac_opb,e.index=b[d].Index.toString(),e.labelText=b[d].Label,e.imageData=a.tfe(b[d].Render),e.renderData=a.tfe(b[d].Replace),e);Array.add(c,f)}return c}
function wac_8$(a,b,c,d,e,f,g,h,k,l,m,n,p){this.tdc=Function.createDelegate(this,this.AMd);this.sic=Function.createDelegate(this,this.e2d);this.G5c=Function.createDelegate(this,this.rxd);this.Mic=Function.createDelegate(this,this.G4d);this.U=b;this.ra=c;this.Ea=e;this.Kz=d;this.Ib=f;this.bP=g;this.Ru=m;this.Lc=n;this.jd=p;this.ha=a;this.Qg=h;this.Rp=k;this.nb=l}
wac_8$.prototype={ra:null,U:null,Kz:null,Ea:null,Ib:null,bP:null,ha:null,Qg:null,Rp:null,nb:null,Ru:null,Lc:null,jd:null,q6b:!1,qe:!1,Kn:function(){this.qe||(this.JQ(),this.Tb(),this.Lf(),this.qe=!0)},O:function(){this.qe&&(this.ije(),this.qe=!1)},JQ:function(){this.Kz.la.xa("CH",this.Mic)},ije:function(){this.Kz.la.sb("CH",this.Mic)},Tb:function(){this.U.Mp(4041021629,1,this.G5c,4);this.U.Mp(283636573,1,this.sic,4);this.U.Mp(206307490,1,this.sic,4);this.U.Mp(1534968859,1,this.tdc,4);this.U.Mp(2657104201,
1,this.tdc,4)},Lf:function(){var a=this.ra.xc("editing"),b=this.ra.xc("document"),c=this.ra.xc("EditingReplaceObjectSuggestionsGalleryFocus");a.Ba(wac_A(13,2),206307490);b.Ba(wac_A(13,2),206307490);c.Ba(wac_A(13,2),206307490);c.Ba(wac_A(27,0),206307490);c.Ba(wac_A(37,0),1534968859);c.Ba(wac_A(39,0),2657104201)},G4d:function(){this.q6b||wac_Y(38279365,829,50,"ReplaceObjectActor::UpdateEditState, updating edit state");this.q6b=!0},rxd:function(a,b,c,d,e){if(!this.qe)return wac_Y(33698392,829,15,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - called before setup"),
16;b=this.Ea.Yj;if(!this.Ea.Ja()||!b||this.Ib.Ac(b))return 16;if(1===c)return 32;c=!0;d=null;wac_Qa.isInstanceOfType(e)?d=e:wac_gkc.isInstanceOfType(e)&&(d=e.cvd,c=!1);e=new wac_WN(wac_yF(d.ActiveSlideSid,d.ActiveSlideCid),d.ShapeId,d.SmartArtSubNodeId?wac_el(d.SmartArtSubNodeId):null);var f=new wac_oqb(e);this.bP.la.wa("ReplaceObjectBSA",f,null);var g=this.Rp.Ubc(e);if(g&&g.Yc()===d.ShapeId){var h=null;1===g.QN&&(h=wac_BO(g.Ay));var k=this,l=this;e=wac_kO(this.nb,15,function(){1===g.QN||wac_IJ(k.ha)||
(wac_Bnc(k.Qg),wac_GL(k.ha),wac_Cnc(k.Qg))},function(){h&&(wac_Bnc(l.Qg),wac_cU(l.ha,h,!0,!0),wac_Cnc(l.Qg))},!1);try{e.lb(b),e.jr(d.SmartArtSubNodeId?1095764407:a),wac_wN(b,wac_mva,d),g.uxb=d.SuggestionSid,g.vxb=d.Label,g.Dbc(!0),g.Nud=new Date,wac_Y(33698394,829,50,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",d.CorrelationId,a,d.SuggestionSid)}finally{e&&e.dispose()}g.Goc=!0;wac_Frb(g,!0);c&&g.Cie();g.QN?h?this.Ib.cxa(b,h,this.Lc.Cb(),
a):wac_Y(38854750,808,15,"Invalid smartArtShape"):this.Ib.Ns(b,a)}else wac_Y(33863682,808,15,"Couldn't find active replaceObjectContext");return 32},e2d:function(a,b,c,d,e){if(!this.qe)return wac_Y(33698398,829,15,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery - called before setup"),16;b=this.Ea.Yj;if(!this.Ea.Ja()||!b||this.Ib.Ac(b))return 16;if(1===c)return 32;c=null;b=0;if(283636573===a){a=window.$$as(wac_1Y,e);if(!a)return 16;c=a.shape;b=a.action}else if(206307490===a){a=wac_5M(this.ha);
if(1!==a.length)return 32;c=a[0]}if(!c)return wac_Y(33698400,829,10,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery, null shape."),16;a=this.Rp.Ubc(c.fsa());if(!a||!this.q6b&&a&&!a.QN)return 2;if(a&&a.dv&&a.Yc()===c.Yc())switch(wac_BM(this.ha),this.ra.ld(),b){case 0:e=this.Ru;a=a.Nd;e.qe?e.Pt.If()?((c=e.Rp.GOa(a))&&c.dv&&c.Nd===a&&e.WOa(c.Ay),wac_Grb(e,c.Ay)):wac_Hrb(e,a):wac_Y(25306503,829,15,"ReplaceObjectPresenter::ToggleSuggestionsGalleryView - called before setup");break;case 1:this.Ru.Pt.If()||
wac_Hrb(this.Ru,a.Nd);break;case 2:wac_Grb(this.Ru,c)}return 32},AMd:function(a,b,c){if(!this.qe)return wac_Y(33698396,829,15,"ReplaceObjectActor::NavigateReplaceObjectSuggestion - called before setup"),16;b=this.Ea.Yj;if(!this.Ea.Ja()||!b||this.Ib.Ac(b))return 16;if(1===c)return 32;if(!this.Ru.Pt.If())return 16;if(1534968859===a){a=this.Ru;if(a.qe){if(c=wac_t1c(a.Pt))-1===c?a.Pt.gs(0,!0):(a.Pt.gs(c,!1),a.Pt.gs(c-1,!0))}else wac_Y(25306512,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionPrev - called before setup");
return 32}return 2657104201===a?(a=this.Ru,a.qe?(c=wac_t1c(a.Pt),b=a.Pt,b.qe?b=b.dub:(wac_Y(25306574,829,15,"ReplaceObjectSuggestionsGalleryView::GetSuggestionCount - called before setup"),b=0),c+1!==b&&(-1===c?a.Pt.gs(0,!0):(a.Pt.gs(c,!1),a.Pt.gs(c+1,!0)))):wac_Y(25306514,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionNext - called before setup"),32):16}};function wac_BZ(a,b){this.nL=a;this.EFa=b}
wac_BZ.prototype={nL:null,EFa:null,Yd:function(){var a=this;this.nL.uc(function(b){b.Tda(a.EFa.$ob(),a.EFa.Etb).then(function(){b.peb(a.EFa.Hu(),a.EFa.sob(),a.EFa.dpb(),null)})})}};function wac_1rb(a,b,c){this.qJa=Function.createDelegate(this,this.xQa);this.Vta=[];this.za=a;this.kf=b;this.FWc=c;this.jc()}
wac_1rb.prototype={za:null,kf:null,FWc:null,Vta:null,ua:null,N6a:function(a,b,c,d,e,f){this.dv&&this.lQ("NewSession");if(!a)throw Error.argumentNull("slide");var g=wac_Dnc(a,new wac_WN(a?wac_kJ(a):null,b,f));if(!g)throw Error.invalidOperation(String.format("slide doesn't have shape corresponds to shapeId: {0}",b));this.Ks=a;this.Ay=g;this.rx=b;this.aCc=f;this.Nd=wac_5k().toString();this.dv=!0;this.fM=c;this.DCb=d;this.ua=e;this.U4=new Date;a=this.Ay;this.QN=this.ua.Zge&&a&&this.aCc&&wac_zO(a)?1:0;
return this.Nd},Axa:function(a,b,c,d,e){return this.N6a(a,b,c,d,e,null)},lQ:function(a){if(this.dv&&(!this.Vta||!Array.contains(this.Vta,this.Nd))){var b={};b.SuggestionCount=this.TZ;b.ClientSuggestionTimeoutInMs=this.Hfe;b.IsApplied=this.YT;b.AppliedSuggestionId=this.YT?this.uxb.toString():"";b.AppliedSuggestionLabel=this.YT?this.vxb:"";b.IsFloatieShown=this.Fzb;b.IsGalleryShown=this.Jzb;b.Trigger=this.fM;b.RetriggerReason=this.DCb;b.ResetReason=a;b.IconId=this.ua.zCb;b.SlideCID=this.Ks.fe();b.SlideSID=
this.Ks.Vc();b.ShapeID=this.rx;b.AnimId=this.ua.wCb;b.AnimEnabled=this.ua.yCb;b.GalleryHoverEnabled=this.ua.xCb;b.ReplaceSuggestionType=wac_Uba.toString(this.QN);b.SeeMoreButtonClicked=this.Fje;b.SeeMoreIconName=this.Fje?this.CBe:"";this.U4&&(b.SessionLiveTimeInMs=new Date-this.U4);this.aCc&&(b.SmartArtSubNodeId=this.aCc.toString());this.T4&&this.Kwa&&this.Kwa>this.T4&&(b.SuggestionsReadyInMs=this.Kwa-this.T4);0<this.SLa&&(b.SuggestionsDisplayedForMs=this.SLa);0<this.vva&&(b.FloatieDisplayedForMs=
this.vva);this.T4&&this.U4&&this.T4>this.U4&&(b.FloatieReadyInMs=this.T4-this.U4);this.U4&&this.ZLa&&this.U4>this.ZLa&&(b.TriggeredByAugLoopInMs=this.U4-this.ZLa);this.Nud&&this.vCc&&this.vCc>this.Nud&&(b.SuggestionAppliedInMs=this.vCc-this.Nud);if(0<this.RD.length){a=[];for(var c=0;c<this.RD.length;c++)Array.add(a,this.RD[c].labelText);b.SuggestionLabels=JSON.stringify(a)}1===this.QN&&this.U$b&&(a=wac_Wf(this.U$b))&&a.hasChildNodes()&&(wac__f(),a=this.U$b,wac_xl.removeChild(wac_yka[a]),wac_yka[a]=
null);wac_rob(this.kf,this.Nd,JSON.stringify(b),this.qJa);b=this.Nd;this.Vta&&!Array.contains(this.Vta,b)&&(Array.add(this.Vta,b),wac_Y(25012102,829,50,"ReplaceObjectContext::MarkCorrelationAsHandled - CorrelationId: {0}; handled correlations count: {1}",b,this.Vta.length))}this.jc()},jc:function(){this.dv=!1;this.Ks=null;this.Goc=this.Jzb=this.Fzb=this.B6a=this.YT=this.CZ=!1;this.DCb=this.fM=this.Nd="";this.RD=[];this.uxb=0;this.vxb="";this.UKa=!1;this.Hfe=this.TZ=0;this.vCc=this.Nud=this.mDb=this.Kwa=
this.$La=this.T4=this.ZLa=this.U4=null;this.QN=this.vva=this.SLa=0;this.U$b="";this.Ay=null;this.Fje=!1;this.CBe=""},xQa:function(a){wac_Y(37586196,829,15,"ReplaceObjectContext::OnFailureCallback - request failed with: {0}. returning true to prevent ACE.",a.HttpStatusCode);return!0},Cie:function(){wac_0nc(this,2,4)},Ks:null,Ay:null,rx:0,Yc:function(){return this.rx},Iua:function(a){return this.rx=a},aCc:null,Gm:function(){return this.aCc},QN:0,CZ:!1,uxb:0,vxb:null,YT:!1,Dbc:function(a){return this.YT=
a},B6a:!1,Fzb:!1,Jzb:!1,U4:null,ZLa:null,T4:null,$La:null,Kwa:null,mDb:null,Nud:null,vCc:null,SLa:0,vva:0,Nd:null,fM:null,DCb:null,UKa:!1,RD:null,wLa:function(){return this.RD},n3e:function(a){return this.RD=a},TZ:0,Hfe:0,Goc:!1,U$b:null,Fje:!1,CBe:null,dv:!1,fsa:function(){return new wac_WN(this.Ks?wac_kJ(this.Ks):null,this.rx,this.aCc)}};function wac_Trb(a,b){a.TZ=b}function wac_tZ(a,b){a.UKa=b}function wac_Frb(a,b){a.B6a=b}function wac_Vrb(a,b){a.CZ=b}
function wac_0nc(a,b,c){a.FWc&&a.FWc.uc(function(a){var e,f=(e=new wac_jkc,e.cardId="EntityGroup.Designer.TextToSmartArt.Suggestion",e.actionType=b,e.actionEngagement=c,e);a.Cfe(f)})}function wac_Yrb(){this.la=new wac_Re}wac_Yrb.prototype={Loe:function(a){this.la.wa("ReplaceObjectSPOver",a,null)},Koe:function(a){this.la.wa("ReplaceObjectSPOut",a,null)}};
function wac_6rb(a,b,c,d,e,f,g,h,k,l,m,n,p,q){this.Agd=Function.createDelegate(this,this.Jcb);this.$Ia=Function.createDelegate(this,this.sl);this.Xia=a;this.HO=b;this.IYc=c;this.MYc=d;this.F6b=n.zCb;this.O3b=n.wCb;this.P3b=n.yCb;this.iT=f;this.mja=e;this.oc=g;this.Xo=h;this.FY=k;this.faa=l;this.gh=m;this.tre=p;this.NCb=q;this.qe=!1}
wac_6rb.prototype={An:null,HO:0,IYc:null,MYc:null,F6b:0,O3b:0,iT:null,mja:null,oc:null,Xo:null,FY:null,faa:null,gh:null,Xia:null,P3b:!1,tre:0,NCb:null,fY:null,F2b:function(){return 1===this.tre?ResourceStrings.l_ReplaceIconSuggestionFloatieTooltip:this.NCb.uyb?ResourceStrings.l_ReplaceObjectGrayFloatieTooltip:ResourceStrings.l_ReplaceObjectFloatieTooltip},qe:!1,Kn:function(){this.qe||(this.An=new wac_FG,this.fY=new wac_fnb(this.mja.gh),this.An.Oa.style.visibility="inherit",this.sca(),this.qe=!0)},
ofe:function(){wac_Wnc(this.NCb,this.$Ia);this.m5();this.lfb(!1);Sys.UI.DomElement.containsCssClass(this.An.Oa,"replaceObjectGrayedFlyoutAnchor")||wac_IG(this.An,"replaceObjectGrayedFlyoutAnchor")},Ki:function(){this.qe?this.lfb(this.P3b):wac_Y(38072907,829,15,"ReplaceObjectFlyoutAnchor::Show - called before setup")},pfe:function(){this.NCb.uyb=!1;this.m5();this.lfb(!1);wac_GYc(this.An,"replaceObjectGrayedFlyoutAnchor")},lfb:function(a){this.qe?this.fY.jea(wac_1nc(this,a),""):wac_Y(25306443,829,15,
"ReplaceObjectFlyoutAnchor::SetGlyph - called before setup")},m5:function(){this.qe?(this.fY.ie(),wac_mO(this.An.Oa,"replaceObjectFlyoutAnchorBase"),wac_mO(this.An.Oa,"replaceObjectFlyoutAnchor"+this.F6b),this.P3b&&(wac_mO(this.An.Oa,"replaceObjectFlyoutAnchorAnimBase"),wac_mO(this.An.Oa,"replaceObjectFlyoutAnchorAnim"+this.O3b))):wac_Y(25306445,829,15,"ReplaceObjectFlyoutAnchor::ClearGlyph - called before setup")},O:function(){this.qe&&(this.jje(),this.An&&this.An.Oa.parentNode&&this.An.Sr(),this.sl(),
this.fY.O(),this.An=null,this.qe=!1)},sl:function(){this.qe?(this.m5(),this.Xia.Oa.style.visibility="hidden"):wac_Y(25306447,829,15,"ReplaceObjectFlyoutAnchor::Dismiss - called before setup")},sca:function(){this.Xia?(this.An.Oa.style.width=this.gh.CJ(this.HO),this.An.Oa.style.height=this.gh.CJ(this.HO),this.An.Oa.setAttribute("role","button"),this.Xia.Ce(this.An),this.fY.sca(this.An.Oa),this.pRa()):wac_Y(25306449,829,15,"ReplaceObjectFlyoutAnchor::BuildDom - parentElement is null")},Jcb:function(){return!0},
pRa:function(){this.FY&&this.oc.ya("click",this.An.Oa,this.FY);this.oc.ya("dblclick",this.An.Oa,this.Agd);this.faa&&(this.Xo.ya("msospPointerOver",this.An.Oa,this.faa),this.Xo.ya("msospPointerOver",this.An.Oa.firstChild,this.faa),this.Xo.ya("msospPointerOver",this.An.Oa.firstChild.firstChild,this.faa))},jje:function(){this.FY&&this.oc.ub("click",this.An.Oa,this.FY);this.oc.ub("dblclick",this.An.Oa,this.Agd);this.faa&&(this.Xo.ub("msospPointerOver",this.An.Oa,this.faa),this.Xo.ub("msospPointerOver",
this.An.Oa.firstChild,this.faa),this.Xo.ub("msospPointerOver",this.An.Oa.firstChild.firstChild,this.faa))}};function wac_1nc(a,b){var c=wac_dnb(a.iT,a.HO,a.HO,a.IYc,a.MYc,a.F2b(),null);wac_aH(a.An.Oa,"replaceObjectFlyoutAnchorBase");wac_aH(a.An.Oa,"replaceObjectFlyoutAnchor"+a.F6b);b&&(wac_aH(a.An.Oa,"replaceObjectFlyoutAnchorAnimBase"),wac_aH(a.An.Oa,"replaceObjectFlyoutAnchorAnim"+a.O3b));return c}
function wac_2rb(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,v,u,w,x,z){this.Zgc=Function.createDelegate(this,this.TUd);wac_2rb.initializeBase(this,[f,a,b,c,d,e,g,h,k,l,m,p,q,r,t,u,w,x,z]);this.Te=h.mxc();this.kf=n;this.ua=v}
wac_2rb.prototype={Te:null,kf:null,ua:null,MM:function(a,b){if(!this.qe)wac_Y(25306451,829,15,"ReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.$rb&&b.ds.length)if(a=wac_5M(this.ha),1!==a.length)this.Te.dv&&this.nM(this.Te,"SelectionChanged");else{a=a[0];if(this.Te.dv){if(this.Te.Yc()===a.Yc())return;this.nM(this.Te,"SelectionChanged")}this.$za(a)&&this.HG(this.Ea.Ja(),a,"SelectShape","")}},bBc:function(a,b){this.qe?this.Te.dv&&this.Te.Ay===b.Ay&&(a=this.Te.Ay,this.nM(this.Te,
"ShapePositionChanged"),this.$za(a)&&this.HG(this.Ea.Ja(),a,"Retrigger","ShapePositionChanged")):wac_Y(25306453,829,15,"ReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")},Jye:function(a,b){b.MKa&&this.cE(b.Ii)},RG:function(){this.Te.dv&&this.nM(this.Te,"SlideNavigation")},Dda:function(a,b){this.Te.dv&&b.DKa&&b.yq&&Array.contains(b.yq,this.Te.Yc())&&this.nM(this.Te,"ShapePresence")},aBc:function(a,b){b.Nd!==this.Te.Nd?wac_Y(25236289,829,15,"ReplaceObjectManager::OnReplaceObjectResponse, Current CorrelationId: {0}, Reponse CorrelationId: {1}",
this.Te.Nd,b.Nd):wac_Snc(this,b,this.Te,this.ua)},zAc:function(){this.qe&&this.Te.B6a&&!this.Te.QN&&!this.Ib.Ac(this.Ea.Yj)&&(wac_Frb(this.Te,!1),wac_sZ(this.Ru,this.Te.Ay,!0,!0,!1))},HG:function(a,b,c,d){try{var e=this.Te.Axa(a,b.Yc(),c,d,this.ua);wac_tZ(this.Te,!0);this.Ru.Ggb(this.Te.Nd);wac_sob(this.kf,a.fe(),a.Vc(),b.Yc(),e,c,wac_CZ(b),wac_DZ(b),null,this.Zgc);this.ua.zy&&wac_qZ(this,e,this.Te.Yc(),this.Te.wLa(),"Pending")}catch(f){wac_Y(34152532,829,15,"GenerateSuggestion failed!! {0} ",f.message)}},
TUd:function(a){wac_Y(36966422,829,15,"ReplaceObjectManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",a.HttpStatusCode);return!0},cE:function(a){this.qe?this.Te.dv&&!this.yfe(a)&&this.nM(this.Te,"WebActionId:"+this.g$.ETd(a)):wac_Y(25306497,829,15,"ReplaceObjectManager::HandleAction - called before setup")},nM:function(a,b){a.CZ&&wac_sZ(this.Ru,a.Ay,!0,!0,!1);a.lQ(b);this.ua.zy&&wac_qZ(this,a.Nd,a.Yc(),a.wLa(),"NoResult")}};
function wac_xZ(a){this.kja=[];this.$$ge=this.GetEnumerator;this.c2c=a}
wac_xZ.prototype={c2c:null,mJb:function(a,b){a&&(a.lQ(b),Array.remove(this.kja,a))},GOa:function(a){for(var b=this.kja,c=b.length,d=0;d<c;++d){var e=b[d];if(e.Nd===a)return e}return null},Ubc:function(a){for(var b=this.kja,c=b.length,d=0;d<c;++d){var e=b[d];if(wac_Enc(a,e.fsa()))return e}return null},jJ:function(a){a:{for(var b=this.kja,c=b.length,d=0;d<c;++d){var e=b[d];if(e.Yc()===a&&!e.Gm()){a=e;break a}}a=null}return a},mxc:function(){return 0<this.kja.length?this.kja[0]:null},N6a:function(a,
b,c,d,e,f){var g=this.Ubc(new wac_WN(wac_kJ(a),b,f));g&&this.mJb(g,"NewSession");g=this.c2c(a,b,c,d,e,f);Array.add(this.kja,g);return g},Axa:function(a,b,c,d,e){return this.N6a(a,b,c,d,e,null)},ETc:function(){var a=0;Array.forEach(this.kja,function(b){b.dv&&a++});return a}};wac_xZ.prototype.GetEnumerator=function(){return new (wac_EZ.$$(wac_Nrb))(this.kja)};wac_xZ.prototype.GetEnumerator=wac_xZ.prototype.GetEnumerator;
function wac_EZ(a){this.gr=-1;this.$$cu=this.get_Current;this.$$mn=this.MoveNext;this.$$rst=this.Reset;this.Ppb=Array.clone(a)}
wac_EZ.$$=function(a){var b=wac_xZ.__tc=wac_xZ.__tc||{},c="ArrayEnumerator$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_EZ.apply(this,a)};d.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectMultipleContextManager.__tc."+c,null,Sys.Ny);d.prototype.jb={"PowerPointWebEditor.ReplaceObject.ReplaceObjectMultipleContextManager.ArrayEnumerator$1":{T:a},ctor:wac_EZ};a=wac_EZ.prototype;for(var e in a){var f={key:e,
value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};wac_EZ.prototype={Ppb:null};wac_EZ.prototype.Oi=function(){if(-1===this.gr||this.gr>=this.Ppb.length)throw Error.invalidOperation();return this.Ppb[this.gr]};wac_EZ.prototype.get_Current=wac_EZ.prototype.Oi;wac_EZ.prototype.Wb=function(){this.gr++;return this.gr<this.Ppb.length};wac_EZ.prototype.MoveNext=wac_EZ.prototype.Wb;wac_EZ.prototype.jc=function(){this.gr=-1};wac_EZ.prototype.Reset=wac_EZ.prototype.jc;
function wac_zZ(a,b,c,d,e,f,g,h,k,l,m){this.Ifc=Function.createDelegate(this,this.zSd);this.Jfc=Function.createDelegate(this,this.ASd);this.Rdc=Function.createDelegate(this,this.YNd);this.Ea=a;this.a$b=b;this.e2c=c;this.za=d;this.Ej=g;this.SY=f;this.Rp=e;this.Pt=h;this.ra=k;this.Vg=l;this.jd=m;this.qe=!1;this.EZ=-1}
wac_zZ.prototype={Ea:null,a$b:null,e2c:null,SY:null,Rp:null,Pt:null,Ej:null,za:null,jd:null,ra:null,Vg:0,qe:!1,EZ:0,Kn:function(){this.qe||(this.SY.la.xa("ReplaceObjectBSA",this.Rdc),this.SY.la.xa("ReplaceObjectSPOver",this.Jfc),this.SY.la.xa("ReplaceObjectSPOut",this.Ifc),this.qe=!0)},O:function(){this.qe&&(this.SY.la.sb("ReplaceObjectBSA",this.Rdc),this.SY.la.sb("ReplaceObjectSPOver",this.Jfc),this.SY.la.sb("ReplaceObjectSPOut",this.Ifc),this.qe=!1)},YNd:function(a,b){(a=wac_Dnc(this.Ea.Ja(),b.Qne))&&
wac_sZ(this,a,!1,!0,!1)},ASd:function(a,b){this.Ea.Ja()&&(a=new wac_WN(wac_kJ(this.Ea.Ja()),b.rx,b.Fac),(a=wac_Dnc(this.Ea.Ja(),a))&&this.NQb(a,b.Klc))},zSd:function(a,b){this.Ea.Ja()&&(a=new wac_WN(wac_kJ(this.Ea.Ja()),b.rx,b.Fac),(a=wac_Dnc(this.Ea.Ja(),a))&&this.WOa(a))},NQb:function(a,b){var c=a;a.Gm()&&(c=wac_BO(a));if(a=wac_8rb(this,c))wac_9rb(this,c,!1),a.NQb(b)},WOa:function(a){var b=a;a.Gm()&&(b=wac_BO(a));if(a=wac_8rb(this,b))wac_9rb(this,b,!0),a.WOa()},Ggb:function(a){this.Pt.Ggb(a)}};
function wac_9rb(a,b,c){b&&(a=window.$$as(wac_5J,wac_T(b,a.Vg)))&&((a=a.$c())?a.Ud(c):wac_Y(25306516,829,10,"ReplaceObjectPresenter::ShowHideShape,shapeViewDiv is null"))}function wac_Urb(a,b){a.qe?a.Pt.If()&&wac_Hrb(a,b):wac_Y(25306510,829,15,"ReplaceObjectPresenter::RefreshSuggestionsGallery - called before setup")}
function wac_Hrb(a,b){var c=a.Rp.GOa(b);if(c&&c.Nd===b&&c.dv){var d=wac_$rb(a,c.Ay);if(d){var e=d.Uc();e?a.Pt.If()&&a.Pt.Te&&!wac_Enc(a.Pt.Te.fsa(),c.fsa())||(e=a.Ej.Vs(e),a.Pt.Ki(b,e.x,e.y),d.Uc().style.zIndex=wac_r().oB(),wac_iN(a.ra,"EditingReplaceObjectSuggestionsGalleryFocus",!0),c.Jzb=!0):wac_Y(25306508,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - rootElem is null")}else wac_Y(25306506,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - replaceObjectView is null")}}
function wac_Grb(a,b){a.Pt.If()&&a.Pt.Te&&wac_Enc(a.Pt.Te.fsa(),b.fsa())&&(a.Pt.sl(),(b=wac_$rb(a,a.Pt.Te.Ay))&&b.Uc()&&(b.Uc().style.zIndex=0),wac_iN(a.ra,"EditingReplaceObjectSuggestionsGalleryFocus",!1))}
function wac_sZ(a,b,c,d,e){a.qe?b&&(c&&a.WOa(b),d&&wac_Grb(a,b),c=wac_$rb(a,b))&&(e?(c.ofe(),a.EZ=b.Yc()):(a.EZ===b.Yc()&&(a.EZ=-1),c.Cg()&&c.sl(),(a=a.Rp.Ubc(b.fsa()))&&b.Yc()===a.Yc()&&wac_Vrb(a,!1))):wac_Y(25306501,829,15,"ReplaceObjectPresenter::RemoveShapeReplaceObjectView - called before setup")}
function wac_Irb(a,b){if(!a.qe)wac_Y(25306499,829,15,"ReplaceObjectPresenter::ShowShapeReplaceObjectView - called before setup");else if(b){var c;if(c=b&&window.$$as(wac_5J,wac_T(b,a.Vg))?wac_cO(a.a$b,b):null){var d=a.Rp.Ubc(b.fsa());if(d&&(!d.CZ||a.EZ===d.Yc())){if(d.CZ)a.EZ===d.Yc()&&(c.pfe(),a.EZ=-1);else{var e=!(a.Pt.Te&&a.Pt.If()&&wac_Enc(b.fsa(),a.Pt.Te.fsa()));wac_sZ(a,b,!0,e,!1);c.qQ()}wac_Vrb(d,!0)}}}}function wac_$rb(a,b){return b&&window.$$as(wac_5J,wac_T(b,a.Vg))?a.a$b.My(b):null}
function wac_8rb(a,b){return b&&!b.Gm()&&window.$$as(wac_5J,wac_T(b,a.Vg))?wac_cO(a.e2c,b):null}function wac_asb(a,b){this.Bs=a;this.gh=b;this.qe=!1}
wac_asb.prototype={gh:null,Bs:null,qe:!1,R3:null,Kn:function(){this.qe||(this.R3=new wac_FG,this.sca(),this.qe=!0)},sca:function(){this.Bs?(this.Bs.appendChild(this.R3.Oa),wac_aH(this.R3.Oa,"replaceObjectPreviewContainer"),this.R3.le(!1)):wac_Y(25306518,829,15,"ReplaceObjectPreviewImageView::BuildDom - parentElement is null")},jea:function(a){if(this.qe){if(a=this.Fca(a))this.tRa(),this.R3.Oa.appendChild(a),this.R3.le(!0)}else wac_Y(25306520,829,15,"ReplaceObjectPreviewImageView::SetImage - called before setup")},
qh:function(a,b){this.qe?this.R3.qh(a,b):wac_Y(25306522,829,15,"ReplaceObjectPreviewImageView::SetSize - called before setup")},O:function(){this.qe&&(this.sl(),this.R3&&this.R3.Oa.parentNode&&(this.R3.Sr(),wac_mO(this.R3.Oa,"replaceObjectPreviewContainer")),this.R3=null)},sl:function(){this.qe?(this.tRa(),this.R3.le(!1)):wac_Y(25306524,829,15,"ReplaceObjectPreviewImageView::Dismiss - called before setup")},Fca:function(a){if(a){var b=wac_SG();b.setAttribute("Unselectable","on");b.src=a;b.style.height=
"100%";b.style.width="100%";return b}return null},tRa:function(){this.R3.Oa.firstChild&&this.R3.Oa.removeChild(this.R3.Oa.firstChild)}};function wac_bsb(){}wac_bsb.prototype={rEc:0,pEc:0,UDc:0,tza:null,YNb:0};function wac_0rb(a,b,c){this.eua=[];this.kf=a;this.Ej=b;this.Hke=c}wac_0rb.prototype={kf:null,Ej:null,Hke:!1};
function wac_csb(a,b){Array.remove(a.eua,b);b.tza&&b.tza.dv&&(wac_Y(34144975,829,50,"ReplaceObjectRequestManager - Send pending request: {0}; {1} were in queue and skipped",b.tza.Nd,b.YNb-1),wac_Wrb(a,b.tza))}
function wac_Wrb(a,b){var c=wac_dsb(a,b.Ks.Vc(),b.Ks.fe(),b.Yc());if(c)return c.tza=b,c.YNb++,1;var d,e=(d=new wac_bsb,d.rEc=b.Ks.Vc(),d.pEc=b.Ks.fe(),d.UDc=b.Yc(),d.YNb=0,d.tza=null,d);Array.add(a.eua,e);wac_tZ(b,!0);c=b.Nd;d=b.Ks;var f=b.Ay;wac_sob(a.kf,d.fe(),d.Vc(),f.Yc(),c,b.fM,a.Hke?wac_CZ(f):wac_Znc(a.Ej,f),a.Hke?wac_DZ(f):wac__nc(a.Ej,f),function(){wac_csb(a,e)},function(b){wac_csb(a,e);wac_Y(36966425,829,15,"SendGenerateReplaceObjectRequest - request failed with response {0}. returning true to avoid ACE.",
b.HttpStatusCode);return!0});return 0}function wac_dsb(a,b,c,d){for(var e=0;e<a.eua.length;e++)if(a.eua[e].rEc===b&&a.eua[e].pEc===c&&a.eua[e].UDc===d)return a.eua[e];return null}function wac_yZ(a){this.$$ge=this.GetEnumerator;this.Te=a}
wac_yZ.prototype={Te:null,mJb:function(a,b){a&&a===this.Te&&a.lQ(b)},GOa:function(){return this.Te},Ubc:function(){return this.Te},jJ:function(){return this.Te},mxc:function(){return this.Te},N6a:function(a,b,c,d,e,f){this.Te.N6a(a,b,c,d,e,f);return this.Te},Axa:function(a,b,c,d,e){return this.N6a(a,b,c,d,e,null)},ETc:function(){return this.Te.dv?1:0}};wac_yZ.prototype.GetEnumerator=function(){return new (wac_FZ.$$(wac_Nrb))(this.Te)};wac_yZ.prototype.GetEnumerator=wac_yZ.prototype.GetEnumerator;
function wac_FZ(a){this.L$=this.jb["PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.SingleEnumerator$1"].T===Number||Type.isEnum(this.jb["PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.SingleEnumerator$1"].T)?0:this.jb["PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.SingleEnumerator$1"].T===Boolean?!1:null;this.$$cu=this.get_Current;this.$$mn=this.MoveNext;this.$$rst=this.Reset;this.L$=a}
wac_FZ.$$=function(a){var b=wac_yZ.__tc=wac_yZ.__tc||{},c="SingleEnumerator$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_FZ.apply(this,a)};d.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.__tc."+c,null,Sys.Ny);d.prototype.jb={"PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.SingleEnumerator$1":{T:a},ctor:wac_FZ};a=wac_FZ.prototype;for(var e in a){var f={key:e,
value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};wac_FZ.prototype={k7b:!0};wac_FZ.prototype.Oi=function(){return this.L$};wac_FZ.prototype.get_Current=wac_FZ.prototype.Oi;wac_FZ.prototype.Wb=function(){return this.k7b?(this.k7b=!1,!0):!1};wac_FZ.prototype.MoveNext=wac_FZ.prototype.Wb;wac_FZ.prototype.jc=function(){this.k7b=!0};wac_FZ.prototype.Reset=wac_FZ.prototype.jc;
function wac_4rb(a,b,c,d,e){this.dispose=this.O;this.ix=a;this.kD=b;this.nD=c;this.Ej=e;this.mja=d;this.qe=!1}
wac_4rb.prototype={ix:null,kD:null,nD:null,Ej:null,mja:null,JHa:null,HWc:!1,aIa:!1,bT:null,Xt:!1,Cg:function(){return this.Xt},te:function(a){return this.Xt=a},qe:!1,Kn:function(){if(!this.qe){this.bT=new wac_FG;var a=new wac_asb(this.bT.Oa,this.mja.gh);a.Kn();this.JHa=a;this.kD&&!this.kD.Fu()&&this.kD.Gs&&(this.kD.Gs.Ce(this.bT),this.Ud(!1),this.aIa=!0,wac_eO(this.kD,this,3),this.Xt=wac_sK(this.kD)||this.kD.Mv());this.qe=!0}},Cm:function(){wac_Y(25306526,829,15,"ReplaceObjectSuggestionPreviewView::BuildDomElements - shouldn't be called")},
rE:function(){},Ur:function(){if(!this.qe)return wac_Y(36827549,829,15,"ReplaceObjectSuggestionPreviewView::GetVisibleBoundingRegion - called before setup"),null;if(!this.HWc||!this.JHa.qe||!this.JHa.R3)return null;var a=wac_OG(this.JHa.R3.Oa.style.left),b=wac_OG(this.JHa.R3.Oa.style.top),c=wac_OG(this.JHa.R3.Oa.style.width),d=wac_OG(this.JHa.R3.Oa.style.height);return new wac_eF(new wac_1(a,b),new wac_1(a+c,b),new wac_1(a+c,b+d),new wac_1(a,b+d))},JG:function(){return!1},ou:function(){},kv:function(){},
Vd:function(){},jj:function(){this.aIa=!0;this.jt()},mo:function(){this.aIa=!0;this.jt()},ur:function(){this.aIa=!0;this.jt()},Mo:function(a){this.bT&&this.bT.ht(a)},uv:function(){},gu:function(){return null},Sy:function(){return[]},Hy:function(){},O:function(){this.nD();this.qe&&(this.JHa.O(),this.bT.Oa.parentNode&&this.bT.Sr(),this.bT=null,this.qe=!1)},NQb:function(a){this.qe?(this.lfb(a),this.jt()):wac_Y(25306562,829,15,"ReplaceObjectSuggestionPreviewView::ShowSuggestionPreview - called before setup")},
WOa:function(){this.qe?this.m5():wac_Y(25306564,829,15,"ReplaceObjectSuggestionPreviewView::HideSuggestionPreview - called before setup")},lfb:function(a){this.qe?(this.JHa.jea(a),this.Ud(!0)):wac_Y(25306566,829,15,"ReplaceObjectSuggestionPreviewView::SetGlyph - called before setup")},m5:function(){this.qe?(this.JHa.sl(),this.Ud(!1)):wac_Y(25306568,829,15,"ReplaceObjectSuggestionPreviewView::ClearGlyph - called before setup")},Zb:function(){},jt:function(){if(this.HWc&&this.aIa){var a=wac_Znc(this.Ej,
this.ix),b=wac__nc(this.Ej,this.ix);this.qh(a,b);if(this.bT){a=this.ix;if(!a)throw Error.argumentNull("shape");a=wac_IGc(a);a=wac_3E(wac_GZ(a.TopLeft),wac_GZ(a.TopRight));wac_5ja(this.bT.Oa,wac_Qf(a))}this.aIa=!1}},Ud:function(a){this.HWc=a;this.bT.Ud(a)},qh:function(a,b){this.JHa&&this.JHa.qh(a,b)}};
function wac_Zrb(a,b,c,d,e,f,g,h,k,l,m){this.Tvb=Function.createDelegate(this,this.xMb);this.wJa=Function.createDelegate(this,this.DQa);this.Wvb=Function.createDelegate(this,this.AMb);this.Vvb=Function.createDelegate(this,this.zMb);this.Xvb=Function.createDelegate(this,this.BMb);this.Uvb=Function.createDelegate(this,this.yMb);this.TB=Function.createDelegate(this,this.pV);this.wT=Function.createDelegate(this,this.D6);this.F4a=Function.createDelegate(this,this.gJb);this.Nk=Function.createDelegate(this,
this.as);this.Ule=Function.createDelegate(this,this.tve);this.Y5b=-1;this.gh=a;this.oc=c;this.Xo=b;this.Ea=d;this.U=e;this.Gt=k;this.bP=f;this.Rp=g;this.Z2=h;this.ra=l;this.ua=m;this.nre=!wac_Ek();this.qe=this.Rva=!1}
wac_Zrb.prototype={ra:null,gh:null,oc:null,Xo:null,Ea:null,U:null,bP:null,Rp:null,Z2:null,Gt:null,ua:null,nre:!1,Zl:null,IKb:null,iqb:null,lja:null,iY:null,o6b:null,dub:0,Te:null,qe:!1,Rva:!1,If:function(){return this.Rva},Kn:function(){this.qe||(this.Zl=wac_eH(),this.Zl.setAttribute("Unselectable","on"),this.Zl.style.position="absolute",wac_aH(this.Zl,"replaceObjectContainer"),wac_esb(this,null),document.body.appendChild(this.Zl),this.pRa(),this.Gt.E_("EditingReplaceObjectSuggestionsGalleryFocus",
"main",this.Zl,function(){},function(){},!0,null),this.qe=!0)},O:function(){this.qe&&(this.sl(),this.CSa(),this.Zl&&this.Zl.parentNode&&this.Zl.parentNode.removeChild(this.Zl),this.qe=!1)},sl:function(){this.qe?(wac_r().ZD(!0),this.le(!1),this.y2().style.display="none",this.y2().style.zIndex=-1,this.o6b=this.iY=null,wac_esb(this,null)):wac_Y(25306570,829,15,"ReplaceObjectSuggestionsGalleryView::Dismiss - called before setup")},Ki:function(a,b,c){if(!this.qe)wac_Y(25306572,829,15,"ReplaceObjectSuggestionsGalleryView::Show - called before setup");
else if(a){var d=this.Rp.GOa(a);if(d&&d.Nd===a&&d.dv&&!d.UKa){this.Te=d;var e=this.Te.wLa();wac_esb(this,a);if(a)if(e&&e.length){d=document.createElement("ul");d.id=a;d.setAttribute("Unselectable","on");d.setAttribute("role","menu");wac_aH(d,"replaceObjectSuggestionsList");this.iY||(this.iY=new (wac_rb.$$(String)));this.o6b||(this.o6b=new (wac_rb.$$(String)));a=e.length;for(var f=0;f<a;++f){var g=e[f];!g.imageData||this.iY.vf(g.index,g.imageData);wac_r$(this)&&g.renderData&&this.o6b.vf(g.index,g.renderData);
var h=g.index,g=g.labelText,k=this.iY.mc(h),l=k?this.iY.K(h):wac_Le("progress.gif");k||wac_Y(38340484,829,15,"ReplaceObjectSuggestionsGalleryView::spinner shows up");var m=wac_SG();m.setAttribute("Unselectable","on");m.src=l;m.title=g;m.setAttribute("role","presentation");wac_aH(m,"replaceObjectSuggestionThumbnail");l=wac_0O();l.id="ROS_"+h;l.setAttribute("Unselectable","on");l.title=g;l.setAttribute("role","menuitem");var n=wac_r$(this)?"replaceIconObjectSuggestionContainer":"replaceObjectSuggestionContainer";
this.Te.YT&&this.Te.uxb.toString()===h&&(n+="Selected");wac_aH(l,n);k||wac_aH(l,"ReplaceObjectSuggestionLoading");l.appendChild(m);h=document.createElement("li");h.setAttribute("Unselectable","on");h.setAttribute("tabindex","-1");h.setAttribute("role","presentation");h.setAttribute("aria-label",g);h.appendChild(l);d.appendChild(h)}if(this.nre&&0<this.o6b.Ma()&&wac_r$(this)&&(this.Te.U$b||(e=this.Te,a=wac_bl().toString(),e.U$b=a),(e=wac_Wf(this.Te.U$b))&&!e.hasChildNodes())){e.style.position="absolute";
e.style.left="0px";e.style.top="0px";for(a=this.o6b.uB().$$ge();a.$$mn();)f=a.$$cu(),h=wac_SG(),h.src=f,h.style.display="block",h.style.position="absolute",e.appendChild(h);wac_Zf()}}else wac_Y(25012109,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Requires atleast one suggestion to display."),d=null;else wac_Y(25012107,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Empty correlationId"),d=null;d&&(e=wac_fH(),e.setAttribute("Unselectable","on"),wac_r$(this)?
(e.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryTitle,wac_aH(e,"replaceIconObjectContainerTitle")):(e.innerText=ResourceStrings.l_ReplaceObjectSuggestionGalleryTitle1,wac_mO(e,"replaceIconObjectContainerTitle")),wac_aH(e,"UIFont replaceObjectContainerTitle"),this.Zl.appendChild(e),this.Zl.appendChild(d),wac_r$(this)&&(this.IKb=wac_fH(),this.IKb.setAttribute("Unselectable","on"),this.IKb.setAttribute("tabindex","-1"),this.IKb.setAttribute("role","presentation"),wac_aH(this.IKb,"UIFont replaceObjectContainerLink"),
wac_r$(this)&&this.ua.LBc&&(this.iqb=wac_fH(),this.iqb.setAttribute("Unselectable","on"),this.iqb.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryLink,this.IKb.appendChild(this.iqb),this.oc.ya("click",this.iqb,this.Ule)),d=wac_eH(),d.appendChild(this.IKb),this.Zl.appendChild(d)));this.dub=this.Te.TZ;this.qE();wac_r().vG(!0);this.y2().style.zIndex=wac_r().Qra();this.Zl.style.zIndex=wac_r().oB();this.y2().style.visibility="hidden";this.y2().style.display="block";this.y2().style.visibility="visible";
wac_r$(this)?wac_aH(this.Zl,"replaceIconObjectContainer"):wac_mO(this.Zl,"replaceIconObjectContainer");this.GCd(b,c);this.le(!0)}}},GCd:function(a,b){var c,d;this.Vd(0,0);if(wac_r$(this)){c=a+32+7;d=b;var e=wac_tUa();c+this.Zl.offsetWidth>e.ac&&(c=a+32-this.Zl.offsetWidth,d=b-7-this.Zl.offsetHeight)}else c=a,d=b-7-this.Zl.offsetHeight;this.Vd(c,d)},gs:function(a,b){if(!this.qe)wac_Y(25306582,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus - called before setup");else if(!(0>a)&&
this.Rva)if(this.Zl)if(a>=this.dub)wac_Y(25306586,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, invalid suggestionIndex. SuggestionCount:{0}, SuggestionIndex:{1}",this.dub,a);else{var c=this.Zl.querySelector(".replaceObjectSuggestionsList");c?(c=c.children)?(c=c[a])?b?(this.Y5b=a,wac_Vj(c)&&wac_u1c(this,c.firstChild)):(this.qE(),wac_U3a(c)&&wac_v1c(this,c.firstChild)):wac_Y(25306592,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItem is null"):
wac_Y(25306590,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItems is null"):wac_Y(25306588,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestion list is null")}else wac_Y(25306584,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, m_suggestionsContainer is null")},Ggb:function(a){this.lja&&(this.lja.className="ReplaceObjectCorrelation "+a)},pRa:function(){this.Zl&&(this.oc.ya("click",this.Zl,this.Nk),this.Z2.xa(this.Zl,
"keydown",this.F4a),this.Xo.ya("msospPointerOver",this.Zl,this.wT),this.Xo.ya("msospPointerOut",this.Zl,this.TB))},CSa:function(){this.Zl&&(this.oc.ub("click",this.Zl,this.Nk),this.Z2.sb(this.Zl,"keydown",this.F4a),this.Xo.ub("msospPointerOver",this.Zl,this.wT),this.Xo.ub("msospPointerOut",this.Zl,this.TB))},D6:function(a){a=wac_hsb(a.Lb());wac_u1c(this,a);return!0},pV:function(a){a=wac_hsb(a.Lb());wac_v1c(this,a);return!0},gJb:function(a){if(this.Rva&&!a.ctrlKey&&!a.altKey&&(!a.shiftKey||9===a.keyCode&&
wac_r$(this)))if(13===a.keyCode||32===a.keyCode)a.preventDefault(),(a=this.Zl.querySelector(":focus"))&&a.firstChild.click();else if(9===a.keyCode&&wac_r$(this)){var b=this.Zl.querySelector(":focus");b&&this.IKb&&(b===this.IKb?(a.preventDefault(),a.stopPropagation(),this.gs(0,!0)):b.parentNode&&b.parentNode.className&&0<=b.parentNode.className.indexOf("replaceObjectSuggestionsList")&&(a.preventDefault(),a.stopPropagation(),this.gs(wac_t1c(this),!1),wac_Vj(this.IKb)))}},as:function(a){if(a.Km)return!1;
var b=wac_hsb(a.Lb());if(!wac_w1c(b)||!b||!b.className||-1!==b.className.indexOf("ReplaceObjectSuggestionLoading"))return!0;a=b?b.parentNode.parentNode.id:null;var c=this.gya(b),b=b?b.title:null;if(a&&c){var d;a=(d=new wac_Qa,d.SuggestionSid=window.parseInt(c),d.ShapeId=this.Te.Yc(),d.CorrelationId=a,d.ActiveSlideCid=this.Ea.Ja().fe(),d.ActiveSlideSid=this.Ea.Ja().Vc(),d.Label=b,d.SmartArtSubNodeId=this.Te.Gm()?this.Te.Gm().toString():null,d.ReplaceObjectType=this.Te.QN,d);this.U.os(4041021629,2,
a,null)}return!0},tve:function(){this.Te&&(this.Te.Fje=!0);wac_Fwc(this);this.U.yw(1332899609,2,null);return!0},gya:function(a){if(!a)return null;a=a.id.split("_");return 2!==a.length?null:a[1]},Vd:function(a,b){this.qe?(0>a&&(a=0),0>b&&(b=0),this.Zl.style.left=this.gh.CJ(a),this.Zl.style.top=this.gh.CJ(b)):wac_Y(25306626,829,15,"ReplaceObjectSuggestionsGalleryView::SetPosition - called before setup")},le:function(a){if(this.Zl){if(this.Te)if(a)this.Te.mDb=new Date,wac_0nc(this.Te,3,3);else{var b;
(b=this.Te).SLa=b.SLa+(new Date-this.Te.mDb)}this.Zl.style.visibility=a?"visible":"hidden";this.Rva=a;wac_iN(this.ra,"EditingReplaceObjectSuggestionsGalleryFocus",a)}},qE:function(){this.Y5b=-1},Ph:null,y2:function(){this.Ph&&"undefined"!==typeof this.Ph||(this.Ph=wac_eH(),this.Ph.setAttribute("id","ModalDiv"),wac_aH(this.Ph,"cui-modalDiv"),this.Ph.setAttribute("Unselectable","on"),document.body.appendChild(this.Ph),wac_8f().ya("msospPointerDown",this.Ph,this.Uvb),wac_8f().ya("msospPointerUp",this.Ph,
this.Xvb),wac_8f().ya("msospPointerMove",this.Ph,this.Vvb),wac_8f().ya("msospPointerOut",this.Ph,this.Wvb),wac_6f().ya("click",this.Ph,this.wJa),wac_4f().ya(wac__j(),this.Ph,this.Tvb));return this.Ph},yMb:function(){return!0},BMb:function(){return wac_Fwc(this)},zMb:function(){return!0},AMb:function(){return!0},DQa:function(){return wac_Fwc(this)},xMb:function(){return!0}};
function wac_Fwc(a){if(!a.Te||!a.Te.Ks)return!0;var b=a.Te.Ay;if(!b)return!0;var c;a.U.os(283636573,2,(c=new wac_1Y,c.action=2,c.shape=b,c),null);return!0}function wac_r$(a){return!!a.Te&&1===a.Te.QN}function wac_w1c(a){return!!a&&!!a.className&&-1!==a.className.indexOf("ObjectSuggestionContainer")}function wac_hsb(a){if(!a)throw Error.argumentNull("sourceElement");return"a"===a.nodeName.toLowerCase()?a:a.parentNode}
function wac_v1c(a,b){b&&wac_w1c(b)&&(b=new wac_0Y(a.Te.Yc(),a.Te.Gm()),a.bP.Koe(b))}function wac_u1c(a,b){b&&wac_w1c(b)&&(b=a.gya(b))&&(b=wac_r$(a)?a.o6b.mc(b)?a.o6b.K(b):"":a.iY.mc(b)?a.iY.K(b):"")&&(b=new wac__Y(a.Te.Yc(),b,a.Te.Gm()),a.bP.Loe(b))}
function wac_esb(a,b){a.Zl&&(a.iqb&&(a.oc.ub("click",a.iqb,a.Ule),a.iqb=null),a.IKb&&(a.IKb=null),wac_jd(a.Zl),a.lja=wac_eH(),a.lja.setAttribute("Unselectable","on"),a.lja.className=b?"ReplaceObjectCorrelation "+b:"ReplaceObjectCorrelation",a.lja.style.position="absolute",a.lja.style.display="none",a.Zl.appendChild(a.lja),a.Zl.style.zIndex=-1)}
function wac_t1c(a){return a.qe?a.Rva?a.Zl?a.Zl.querySelector(".replaceObjectSuggestionsList")?a.Y5b:(wac_Y(25306580,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, suggestion list is null"),-1):(wac_Y(25306578,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, m_suggestionsContainer is null"),-1):-1:(wac_Y(25306576,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex - called before setup"),0)}
function wac_wZ(a,b,c,d,e){this.f2c=a;this.Ej=b;this.za=c;this.Ea=d;this.ua=e}wac_wZ.prototype={f2c:null,Ej:null,za:null,Ea:null,ua:null,RSa:function(a){return!(a&&a.Yc()&&wac_2I(a)&&this.Ej.k6(a))||wac_3I(a)||a.gA||wac_jO(a)||wac_UI(a)||!this.f2c.xl(a)?!1:!0}};function wac_AZ(a,b,c,d,e,f,g){this.oc=a;this.Xo=b;this.gh=c;this.iT=d;this.ua=e;this.ed=f;this.Vke=g}wac_AZ.prototype={oc:null,Xo:null,gh:null,iT:null,ua:null,ed:null,Vke:null};function wac_vZ(a,b,c){this.gh=a;this.Ea=c;this.cac=b}
wac_vZ.prototype={cac:null,gh:null,Ea:null,Vs:function(a){return this.gh.M5(a)},k6:function(a){return a?!!this.Ea.Ja()&&wac_kJ(this.Ea.Ja()).Ka(a.mi()):!1}};function wac_GZ(a){return new wac_1(a.X,a.Y)}function wac_jsb(a){return(a=a.cac.lj())?a.xia:1}function wac_ksb(a){return a.Vs(a.cac.lj().xb.Oa)}function wac__nc(a,b){return wac_DZ(b)*wac_jsb(a)}function wac_Znc(a,b){return wac_CZ(b)*wac_jsb(a)}
function wac_DZ(a){if(!a)throw Error.argumentNull("shape");a=wac_IGc(a);return wac_1E(wac_GZ(a.TopRight),wac_GZ(a.BottomRight))}function wac_CZ(a){if(!a)throw Error.argumentNull("shape");a=wac_IGc(a);return wac_1E(wac_GZ(a.TopLeft),wac_GZ(a.TopRight))}function wac_5rb(a,b,c){this.uvb=Function.createDelegate(this,this.cKb);this.eJa=Function.createDelegate(this,this.BPa);this.Etb=["ShapeTextConvertable"];this.Ez=a;this.$ta=b;this.I2a=c}
wac_5rb.prototype={Ez:null,$ta:null,I2a:null,NX:null,RY:null,Hu:function(){return"ReplaceObjectWacALWorkflow"},$ob:function(){return'syntax="proto3";message ShapeTextConvertable { string Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; };'},sob:function(){if(!this.NX){var a;this.NX=(a=new wac_5Y,a.kA="LambdaBefore_ReplaceObjectWacAL",a.Aka="ShapeTextTile",a.Qka="ShapeTextTile",a.vka=this.eJa,a)}return this.NX},dpb:function(){if(!this.RY){var a;this.RY=(a=
new wac_5Y,a.kA="LambdaRemote_ReplaceObjectWacAL",a.Aka="ShapeTextTile",a.Qka="ShapeTextConvertable",a.vka=this.uvb,a)}return this.RY},BPa:function(a,b,c){if(b=a)b=this.$ta,b=b.q6b&&b.J6b;if(b)if(a){var d;try{d=wac_yl(a.ContextId)}catch(e){wac_Y(37041409,375,10,"{0}:LambdaBeforeDone - Try parse tile contextId failed",this.Hu());c(null);return}Array.contains(this.I2a.ua.Kne,d.t)?(wac_Y(38115527,375,50,"{0}:LambdaBeforeDone - trigger invalid",this.Hu()),c(null)):(b=this.I2a,d=d.shapeId,d=wac_fO(b.Ea.Ja(),
d),b.RSa(d)?c(a):(wac_Y(37041411,375,50,"{0}:LambdaBeforeDone - shape invalid",this.Hu()),c(null)))}else c(null),wac_Y(37041379,375,50,"{0}:LambdaBeforeDone -  ShapeTextTile null",this.Hu());else wac_Y(37041377,375,50,"{0}:LambdaBeforeDone -  input null or ineligible",this.Hu()),c(null)},cKb:function(a,b,c){if(a)if(a){var d=this;this.Ez.uc(function(b){b.zRa(a.Topic,a.Data,a.ContextId,function(a){d.S6(a)},function(a){d.R6(a)},c)})}else c(null);else c(null)},S6:function(a){if(!wac_.ke&&a&&a.Aa&&a.Aa.vl){var b=
window.$$as(Function,a.Aa.vl);if(b){var c;try{c=wac_yl(a.Aa.Be)}catch(d){b(null);wac_Y(36804442,375,10,"Try parse aug response failed:{0}",d.message);return}b(c)}}},R6:function(a){!wac_.ke&&a&&a.Aa&&a.Aa.vl&&(a=window.$$as(Function,a.Aa.vl))&&a(null)}};function wac__rb(a,b,c){this.ua=a;this.jd=b;this.sua=c;this.tb(this.ua.Yrc)}
wac__rb.prototype={lbc:null,ua:null,jd:null,sua:null,xl:function(a){return this.lbc?this.lbc.RSa(a):!0},tb:function(a){var b={};if(a){a=a.split(";");for(var c=a.length,d=0;d<c;++d){var e=a[d];if(e){var f=e.split(":");2===f.length?b[f[0]]=f[1]:wac_Y(25192154,829,10,"ReplaceObjectClientWalls::Parse - wall: {0}",e)}}}a=[];"MinParagraphCount"in b&&Array.add(a,new wac_lsb(wac_bG(b,"MinParagraphCount",0),this.jd));"MinShapeHeight"in b&&Array.add(a,new wac_msb(wac_dG(b,"MinShapeHeight",0),this.sua));"MaxShapeHeight"in
b&&Array.add(a,new wac_nsb(wac_dG(b,"MaxShapeHeight",Number.MAX_VALUE),this.sua));"MinShapeWidth"in b&&Array.add(a,new wac_osb(wac_dG(b,"MinShapeWidth",0),this.sua));"MaxShapeWidth"in b&&Array.add(a,new wac_psb(wac_dG(b,"MaxShapeWidth",Number.MAX_VALUE),this.sua));"MinShapeAreaRatio"in b&&Array.add(a,new wac_qsb(wac_dG(b,"MinShapeAreaRatio",0),this.sua));"MaxShapeAreaRatio"in b&&Array.add(a,new wac_rsb(wac_dG(b,"MaxShapeAreaRatio",Number.MAX_VALUE),this.sua));for(b=0;b<a.length-1;b++)a[b].rbc=a[b+
1];0<a.length&&(this.lbc=a[0])}};function wac_HZ(){}wac_HZ.prototype={rbc:null,RSa:function(a){return this.xl(a)?this.rbc?this.rbc.RSa(a):!0:!1}};function wac_lsb(a,b){wac_lsb.initializeBase(this);this.g0c=a;this.jd=b}wac_lsb.prototype={g0c:0,jd:null,xl:function(a){return wac_ssb(a)>=this.g0c}};function wac_ssb(a){if(!a)return 0;var b=0;wac_PN(a,function(a){a.Va(wac_In)&&(a=a.Za(String,wac_In))&&0<a.length&&b++});return b}function wac_msb(a,b){wac_msb.initializeBase(this);this.d0c=a;this.Ej=b}
wac_msb.prototype={d0c:0,Ej:null,xl:function(a){return wac__nc(this.Ej,a)>=this.d0c}};function wac_nsb(a,b){wac_nsb.initializeBase(this);this.S_c=a;this.Ej=b}wac_nsb.prototype={S_c:0,Ej:null,xl:function(a){return wac__nc(this.Ej,a)<=this.S_c}};function wac_osb(a,b){wac_osb.initializeBase(this);this.j0c=a;this.Ej=b}wac_osb.prototype={j0c:0,Ej:null,xl:function(a){return wac_Znc(this.Ej,a)>=this.j0c}};function wac_psb(a,b){wac_psb.initializeBase(this);this.Y_c=a;this.Ej=b}
wac_psb.prototype={Y_c:0,Ej:null,xl:function(a){return wac_Znc(this.Ej,a)<=this.Y_c}};function wac_IZ(){wac_IZ.initializeBase(this)}wac_IZ.prototype={Ej:null};function wac_tsb(a,b){var c=wac_Znc(a.Ej,b);b=wac__nc(a.Ej,b);var d=c*b,e=wac_ksb(a.Ej).width;a=wac_ksb(a.Ej).height;d=d/(e*a)*100;wac_Y(37041415,829,50,"ReplaceObjectValidationHelper::GetShapeAreaRatio - shapeWidth: {0}; shapeHeight{1}; slideWidth:{2}; slideHeight{3}; ratio: {4}",c,b,e,a,d);return d}
function wac_qsb(a,b){wac_qsb.initializeBase(this);this.h0c=a;this.Ej=b}wac_qsb.prototype={h0c:0,xl:function(a){return wac_tsb(this,a)>=this.h0c}};function wac_rsb(a,b){wac_rsb.initializeBase(this);this.W_c=a;this.Ej=b}wac_rsb.prototype={W_c:0,xl:function(a){return wac_tsb(this,a)<=this.W_c}};
function wac_3rb(a,b,c,d,e,f,g,h,k,l,m){this.Rt=Function.createDelegate(this,this.np);this.Sgd=Function.createDelegate(this,this.FPd);this.Rgd=Function.createDelegate(this,this.EPd);this.dispose=this.O;this.U=e;this.gh=f;this.Ae=g;this.Rp=h;this.bP=k;this.mja=d;this.nD=c;this.ix=a;this.kD=b;this.Yv=!1;this.ua=l;this.Ege=m;this.qe=this.Xt=!1}
wac_3rb.prototype={U:null,gh:null,Ae:null,Rp:null,bP:null,kD:null,mja:null,Ege:null,ore:!1,U4b:null,eI:null,Yv:!1,ix:null,ua:null,nD:null,Xt:!1,Cg:function(){return this.Xt},te:function(a){return this.Xt=a},qe:!1,Kn:function(){if(!this.qe){var a=wac_2nc(this),a=a?a.QN:0;this.ore=1===a;this.eI=new wac_FG;var b=this.mja,c=this.eI,d=this.Rgd,e=this.Sgd,f=b.ua.zCb,a=7<=f&&8>=f&&1!==a?new wac_Xnc(c,b.oc,b.Xo,d,e,b.ua,b.ed,0,b.Vke):new wac_6rb(c,32,"per","PowerPointDesigner_32x32x32",b,b.iT,b.oc,b.Xo,d,
e,b.gh,b.ua,a,b.Vke);a.Kn();this.U4b=a;this.kD&&!this.kD.Fu()&&this.kD.Gs&&(this.Cm(this.kD.Gs),wac_eO(this.kD,this,3));this.qe=!0}},pfe:function(){this.qe?this.U4b&&this.U4b.pfe():wac_Y(38397254,829,15,"ShapeReplaceObjectView::EnableFloatie - called before setup")},ofe:function(){this.qe?this.U4b&&this.U4b.ofe():wac_Y(34358810,829,15,"ShapeReplaceObjectView::DisableFloatie - called before setup")},qQ:function(){if(!this.qe)wac_Y(25306629,829,15,"ShapeReplaceObjectView::Display - called before setup");
else if(!this.Xt){this.jt();this.U4b.Ki();this.Xt=!0;this.DJ();var a=wac_2nc(this);if(a){a.Fzb=!0;var b=new Date;a.T4||(a.T4=b);a.$La=b;wac_Y(36500810,829,50,"ShapeReplaceObjectView::Display - trigger: {0}, correlationId: {1}",a.fM,a.Nd)}}},Uc:function(){return this.qe?this.eI.Oa:(wac_Y(25306631,829,15,"ShapeReplaceObjectView::Root - called before setup"),null)},sl:function(){if(this.qe){this.U4b.sl();this.Xt=!1;var a=wac_2nc(this);a&&(wac_Vrb(a,!1),a.$La&&(a.vva+=new Date-a.$La,wac_Y(26026273,829,
50,"ShapeReplaceObjectView::Dismiss - FloatieDisplayedForMs: {0}; TimeFloatieRenderedLast: {1}; trigger: {2}; correlation: {3}",a.vva,a.$La,a.fM,a.Nd)))}else wac_Y(25306633,829,15,"ShapeReplaceObjectView::Dismiss - called before setup")},Cm:function(){this.Xt=!1;wac_aH(this.eI.Oa,"replaceObjectBody");document.body.appendChild(this.eI.Oa);wac_6Lc(this.Ae,this.Rt);this.jt()},rE:function(){},Ur:function(){return null},JG:function(){return!1},ou:function(){},kv:function(){},Vd:function(){},jj:function(){},
mo:function(){},ur:function(){},Mo:function(){},uv:function(a){if(this.qe){if(a)this.Xt=!1,this.DJ();else if(this.Yv){var b=new wac_pqb(this.ix);this.bP.la.wa("ReplaceObjectViewDE",b,null)}this.Yv=a}else wac_Y(25306637,829,15,"ShapeReplaceObjectView::SetDrag - called before setup")},gu:function(){return null},Sy:function(){return[]},Hy:function(){this.qe?this.jt():wac_Y(25306639,829,15,"ShapeReplaceObjectView::Draw - called before setup")},Zb:function(){},O:function(){this.nD();this.qe&&(this.Ae.la.sb("SUHS",
this.Rt),this.eI&&(this.eI.Oa.parentNode&&this.eI.Sr(),wac_mO(this.eI.Oa,"replaceObjectBody")),this.sl(),this.U4b.O(),this.eI=null,this.qe=!1)},DJ:function(){this.eI.Oa.style.visibility=this.Xt?"visible":"hidden";var a=wac_2nc(this);a&&wac_Vrb(a,this.Xt)},jt:function(){var a=null,b=this.kD.Gs;b&&(a=this.gh.M5(b.Oa));if(a){if(b=a.x-42,this.ore&&this.kD&&this.kD.Sb&&(b=wac_Wv(this.kD.Sb.Df(),wac_3zc(this.ix),0),b=a.x+b+10),wac_ol(this.eI.Oa,1),this.eI.Vd(1*b,a.y),b*=1,a=a.y,this.Ege.If()){var c=wac_2nc(this),
d=this.Ege.Te;d&&c&&d.Nd===c.Nd&&this.Ege.GCd(b,a)}}else wac_Y(38557190,829,15,"ShapeReplaceObjectView::UpdateView - elementBound is null")},EPd:function(a){if(a.Km)return!1;var b;this.U.os(283636573,2,(b=new wac_1Y,b.shape=this.ix,b.action=0,b),null);return!0},FPd:function(){if(!this.ua.xCb)return!1;var a=wac_2nc(this);if(a&&1===a.QN)return!1;var b;this.U.os(283636573,2,(b=new wac_1Y,b.shape=this.ix,b.action=1,b),null);return!0},np:function(a,b){this.Xt&&(a=null,b&&b.WP&&(a=b.WP.fl()),a&&wac_kJ(a).Ka(this.ix.mi())&&
this.jt())}};function wac_2nc(a){return a.Rp.Ubc(a.ix.fsa())}function wac_usb(){}wac_usb.prototype={isTextConvertible:!1,smartArtInfo:null};wac_mZ.registerClass("PowerPointWebEditor.BaseReplaceObjectManager",null,wac_lZ,wac_jZ);wac_Qrb.registerClass("PowerPointWebEditor.ReplaceObject.AugmentationLoopReplaceObjectManager",wac_mZ);wac_Unc.registerClass("PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer");wac_Xnc.registerClass("PowerPointWebEditor.ReplaceObject.GifFlyoutAnchor",null,wac_Tnc,wac_jZ);
wac_Xrb.registerClass("PowerPointWebEditor.ReplaceObject.PPTWebEditorReplaceObjectPackage",null,wac_I,wac_i);wac_Ync.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceIconManager");wac_8$.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor");wac_BZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager");wac_1rb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectContext",null,wac_Nrb);
wac_Yrb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectEventSource",null,wac_ZY,wac_XY,wac_YY);wac_6rb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectFlyoutAnchor",null,wac_Tnc,wac_jZ);wac_2rb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectManager",wac_mZ);wac_xZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectMultipleContextManager",null,wac_rZ,Sys.Xs);wac_zZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter",null,wac_jZ);
wac_asb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectPreviewImageView",null,wac_jZ);wac_bsb.registerClass("PowerPointWebEditor.ReplaceObject.TaskItem");wac_0rb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectRequestManager",null,wac_Orb);wac_yZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager",null,wac_rZ,Sys.Xs);
wac_4rb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectSuggestionPreviewView",null,wac_dK,wac_4J,wac_XJ,Sys.IDisposable,wac_jZ);wac_Zrb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectSuggestionsGalleryView",null,wac_kZ,wac_jZ);wac_wZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper");wac_AZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory");wac_vZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper");
wac_5rb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectWacALWorkflow",null,wac_4Y);wac__rb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectWalls",null,wac_Prb);wac_HZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectWall");wac_lsb.registerClass("PowerPointWebEditor.ReplaceObject.MinParagraphCount",wac_HZ);wac_msb.registerClass("PowerPointWebEditor.ReplaceObject.MinShapeHeight",wac_HZ);
wac_nsb.registerClass("PowerPointWebEditor.ReplaceObject.MaxShapeHeight",wac_HZ);wac_osb.registerClass("PowerPointWebEditor.ReplaceObject.MinShapeWidth",wac_HZ);wac_psb.registerClass("PowerPointWebEditor.ReplaceObject.MaxShapeWidth",wac_HZ);wac_IZ.registerClass("PowerPointWebEditor.ReplaceObject.AreaRatioWall",wac_HZ);wac_qsb.registerClass("PowerPointWebEditor.ReplaceObject.MinAreaRatio",wac_IZ);wac_rsb.registerClass("PowerPointWebEditor.ReplaceObject.MaxAreaRatio",wac_IZ);
wac_3rb.registerClass("PowerPointWebEditor.ReplaceObject.ShapeReplaceObjectView",null,wac_cK,wac_4J,wac_XJ,Sys.IDisposable,wac_jZ);wac_usb.registerClass("PowerPointWebEditor.ReplaceObject.TextAnalysisHint");wac_J(wac_C(),wac_k4(new wac_Xrb,0),0,!1);
