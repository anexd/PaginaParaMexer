var versionHistory=function(e){function t(t){for(var o,s,a=t[0],l=t[1],c=t[2],d=0,u=[];d<a.length;d++)s=a[d],n[s]&&u.push(n[s][0]),n[s]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);for(p&&p(t);u.length;)u.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],o=!0,a=1;a<r.length;a++){var l=r[a];0!==n[l]&&(o=!1)}o&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var o={},n={20:0},i=[];function s(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.e=function(e){var t=[],r=n[e];if(0!==r)if(r)t.push(r[2]);else{var o=new Promise((function(t,o){r=n[e]=[t,o]}));t.push(r[2]=o);var i,a=document.createElement("script");a.charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.src=function(e){return s.p+""+({18:"uiFabricLazy"}[e]||e)+".min.js"}(e),0!==a.src.indexOf(window.location.origin+"/")&&(a.crossOrigin="anonymous"),i=function(t){a.onerror=a.onload=null,clearTimeout(l);var r=n[e];if(0!==r){if(r){var o=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src,s=new Error("Loading chunk "+e+" failed.\n("+o+": "+i+")");s.type=o,s.request=i,r[1](s)}n[e]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:a})}),12e4);a.onerror=a.onload=i,document.head.appendChild(a)}return Promise.all(t)},s.m=e,s.c=o,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(r,o,function(t){return e[t]}.bind(null,o));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var a=window.webpackJsonp_name_=window.webpackJsonp_name_||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var p=l;return i.push([971,0,1]),r()}({971:function(e,t,r){"use strict";r.r(t);var o=r(1),n=r(33),i=r(2),s=function(e,t,r,o){this.correlationId=e||"",this.errorType=t,this.status=r,this.statusText=o},a=function(){function e(e,t,r,o){this._theUri="",this._serviceBase="",this._docId="",this._retryCount=3,this._wdEnableDownloadTokens=!1,this._handlerName="versions.ashx",this._handlerQueryParam="DocID",this._userSessionId="",this._wacCluster="",this._latestStreamServiceBase="",this._useXhr=!1,this._serviceBase=e,this._docId=t,this._wdEnableDownloadTokens=!!r.wdEnableDownloadTokens&&r.wdEnableDownloadTokens,this._retryCount=r.retryCount?r.retryCount:3,this._userSessionId=r.userSessionId?r.userSessionId:"",this._wacCluster=r.wacCluster?r.wacCluster:"",this._latestStreamServiceBase=o||"",this._useXhr=!!r.useXhr&&r.useXhr,this.buildVersionHistoryRequestUri()}return e.prototype.versionInfoFromTipVersion=function(e){try{var t={};return t.DownloadUrl=e.data.downloadUrl,{correlationID:e.correlationID,data:t,isDirty:"true"===e.data.isDirty}}catch(e){i.c.sendTraceTag(595882753,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"Failed to convert tip version Latest response to version info object")}},e.prototype.requestTipVersion=function(){var e=this,t={method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster}},r="&waccluster="+this._wacCluster;return this.fetchRetry(this._latestStreamServiceBase+r,t,this._retryCount).then((function(t){return e.versionInfoFromTipVersion(t)}))},e.prototype.requestVersionHistory=function(){var e={method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster,"X-WacNoAuth":"1"}},t="&wdEnableDownloadTokens="+this._wdEnableDownloadTokens.toString();return this._useXhr?this.xhrRetry(e.method,this._theUri+t,e.headers,null,this._retryCount):this.fetchRetry(this._theUri+t,e,this._retryCount)},e.prototype.requestDownloadToken=function(e){var t={method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster,"X-WacNoAuth":"1"},body:JSON.stringify({RevisionIDs:e})},r="&action=GetDownloadToken&wdEnableDownloadTokens="+this._wdEnableDownloadTokens.toString();return this._useXhr?this.xhrRetry(t.method,this._theUri+r,t.headers,t.body,this._retryCount):this.fetchRetry(this._theUri+r,t,this._retryCount)},e.prototype.buildVersionHistoryRequestUri=function(){this._serviceBase.indexOf(this._handlerName)<0?this._theUri=this._serviceBase+this._handlerName+"?"+this._handlerQueryParam+"="+encodeURIComponent(this._docId):this._theUri=this._serviceBase+"?"+this._handlerQueryParam+"="+encodeURIComponent(this._docId)},e.prototype.xhrRetry=function(e,t,r,n,s){return o.__awaiter(this,void 0,void 0,(function(){var a=this;return o.__generator(this,(function(l){return[2,this.xhr(e,t,r,n).then((function(e){return e})).catch((function(l){return o.__awaiter(a,void 0,void 0,(function(){return o.__generator(this,(function(o){return i.c.sendTraceTag(595886220,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"VersionHistoryRequestManager\n            Error: "+l.errorType+"\n            Status: "+l.status+"\n            StatusText: "+l.statusText+"\n            CorrelationId: "+l.correlationId),1===s?[2,Promise.resolve({errorCode:l.errorType,correlationId:l.correlationId})]:[2,this.xhrRetry(e,t,r,n,s-1)]}))}))}))]}))}))},e.prototype.xhr=function(e,t,r,o){var n=this;return new Promise((function(i,a){var l=new XMLHttpRequest;l.open(e,t,!0),l.onload=function(){if(200===this.status)try{var e=JSON.parse(l.response);i({errorCode:0,data:e,correlationId:this.getResponseHeader("X-CorrelationId")})}catch(e){a(new s(this.getResponseHeader("X-CorrelationId"),102,this.status,this.statusText))}else a(new s(this.getResponseHeader("X-CorrelationId"),100,this.status,this.statusText))},l.onerror=function(){a(new s(this.getResponseHeader("X-CorrelationId"),103,this.status,this.statusText))},n.addXhrHeaders(r,l),l.send(o)}))},e.prototype.addXhrHeaders=function(e,t){if(e)for(var r in e)e.hasOwnProperty(r)&&t.setRequestHeader(r,e[r])},e.prototype.fetchRetry=function(e,t,r){return o.__awaiter(this,void 0,void 0,(function(){var n=this;return o.__generator(this,(function(a){switch(a.label){case 0:return[4,fetch(e,t).then((function(e){if(!e.ok)throw i.c.sendTraceTag(595899467,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"VersionHistoryRequestManager Status: "+e.status+", StatusText: "+e.statusText+", CorrelationId: "+e.headers.get("X-CorrelationId")),new s(e.headers.get("X-CorrelationId"),n.parseServerError(e),e.status,e.statusText);return e.json().then((function(t){return{correlationId:e.headers.get("X-CorrelationId"),data:t,errorCode:0}})).catch((function(){throw new s(e.headers.get("X-CorrelationId"),102,e.status,e.statusText)}))})).catch((function(a){return o.__awaiter(n,void 0,void 0,(function(){return o.__generator(this,(function(o){switch(o.label){case 0:return i.c.sendTraceTag(595906848,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"VersionHistoryRequestManager Error: "+(a&&a.message?a.message:"NA")),1===r?a instanceof s?[2,Promise.resolve({errorCode:a.errorType,correlationId:a.correlationId})]:[2,Promise.resolve({errorCode:103,correlationId:""})]:[4,this.fetchRetry(e,t,r-1)];case 1:return[2,o.sent()]}}))}))}))];case 1:return[2,a.sent()]}}))}))},e.prototype.parseServerError=function(e){var t;switch(e.headers.get("ErrorCode")){case"VersioningNotEnabled":t=104;break;case"FileNotFound":t=105;break;case"VersionTooOld":t=106;break;default:t=100}return t},e}(),l=["#0078d4","#4f6bed","#e3008c","#004e8c","#005b70","#750b1c","#0b6a0b","#8764b8","#a4262c","#038387","#c239b3","#d13438","#498205","#5c2e91","#ca5010","#986f0b","#881798","#8e562e"],c=function(){function e(){}return e.getInitialsColorFromName=function(e){if(!e)return this.getColorByIndex(0);for(var t=0;t<this.nameColorMap.length;t+=1){var r=this.nameColorMap[t];if(r.name===e)return this.getColorByIndex(r.colorIndex)}var o={name:e,colorIndex:this.getNextColorIndex()};return this.nameColorMap.push(o),this.getColorByIndex(o.colorIndex)},e.getNextColorIndex=function(){return this.currentColorIndex=(this.currentColorIndex+1)%l.length,this.currentColorIndex},e.getColorByIndex=function(e){return l[e%l.length]},e.currentColorIndex=0,e.nameColorMap=[],e}(),p=function(){function e(e,t,r,o,n,i,s,l,c,p){this.Versions=[],this._isDisposed=!1,this._versionHistoryRequestManager=c||new a(n,i,s,l),this._versionHistoryReadyEvent=e,this._perfTelemetryInfos=p,this._downloadTokenReadyEvent=t,this._fullAppErrorEvent=r,this._tipVersionTokenReadyEvent=o}return e.prototype.getTipVersion=function(){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(r){switch(r.label){case 0:return null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadTipVersionStart",TelemetryEventData:Date.now().toString()}),this._tipVersionResponse=null,[4,this._versionHistoryRequestManager.requestTipVersion()];case 1:return t=r.sent(),this._tipVersionResponse=t,null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadTipVersionEnd",TelemetryEventData:Date.now().toString()}),t&&t.data&&t.data.DownloadUrl?(this.Versions&&this.Versions.length>0&&!this.Versions[0].DownloadUrl&&!t.isDirty?(i.c.sendTraceTag(595882755,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"Storing First Version Download Url, sending TipVersionTokenReadyEvent"),e.updateVersionInfo(this.Versions[0],t.data)):i.c.sendTraceTag(595882756,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"No Versions list, sending TipVersionTokenReadyEvent"),this.fireTipVersionTokenReadyEvent(t.data,t.correlationID),[2,!0]):(i.c.sendTraceTag(595882754,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"getTipVersion failed"),[2,!1])}}))}))},e.prototype.getVersions=function(){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(r){switch(r.label){case 0:return null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadVersionListStart",TelemetryEventData:Date.now().toString()}),[4,this._versionHistoryRequestManager.requestVersionHistory()];case 1:return t=r.sent(),null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadVersionListEnd",TelemetryEventData:Date.now().toString()}),t?t.data?t.data.Versions?t.data.Versions[0]?this._isDisposed?[2,!1]:(this.Versions=t.data.Versions?t.data.Versions.filter((function(e){return e.Time=new Date(e.Time.toString())})):[],this.Versions.sort((function(e,t){return e&&t&&e.Time&&t.Time?t.Time.getTime()-e.Time.getTime():0})),this.Versions.forEach((function(t){return e.updateAuthorColorInfo(t)})),this.Versions.length>0&&(this.Versions[0].RevisionID&&!this.Versions[0].DownloadUrl&&this._tipVersionResponse&&this._tipVersionResponse.data.DownloadUrl&&!this._tipVersionResponse.isDirty&&(i.c.sendTraceTag(595882271,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"Using stored tip version as first version downloadurl"),this.Versions[0].DownloadUrl=this._tipVersionResponse.data.DownloadUrl,this.Versions[0].WopiInfo=this._tipVersionResponse.data.WopiInfo),this.fireVersionsReadyEvent(this.Versions,t.correlationID)),[2,!0]):(i.c.sendTraceTag(595682910,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"getVersions failed: !response.data.Versions[0]"),this.fireFullAppErrorEventWithDefaultCode(t.errorCode),[2,!1]):(i.c.sendTraceTag(595682909,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"getVersions failed: !response.data.Versions"),this.fireFullAppErrorEventWithDefaultCode(t.errorCode),[2,!1]):(i.c.sendTraceTag(595682908,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"getVersions failed: !response.data"),this.fireFullAppErrorEventWithDefaultCode(t.errorCode),[2,!1]):(i.c.sendTraceTag(595682907,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"getVersions failed: !response"),this.fireFullAppErrorEvent(100),[2,!1])}}))}))},e.prototype.getDownloadToken=function(t,r){return o.__awaiter(this,void 0,void 0,(function(){var n,s=this;return o.__generator(this,(function(o){switch(o.label){case 0:return null!=this._perfTelemetryInfos&&t.length>0&&this._perfTelemetryInfos.push({TelemetryEventKey:"GetDownloadTokenStart",TelemetryEventData:Date.now().toString()}),[4,this._versionHistoryRequestManager.requestDownloadToken(t)];case 1:return n=o.sent(),null!=this._perfTelemetryInfos&&t.length>0&&this._perfTelemetryInfos.push({TelemetryEventKey:"GetDownloadTokenEnd",TelemetryEventData:Date.now().toString()}),n&&n.data&&n.data.Versions&&n.data.Versions[0]?(r&&(r.correlationID=n.correlationID),this._isDisposed?[2,!1]:(n.data.Versions.forEach((function(t){t&&t.DownloadUrl&&(s.Versions.filter((function(e){return e.RevisionID===t.RevisionID}))[0].DownloadUrl=t.DownloadUrl,r&&(r.baseVersion&&r.baseVersion.RevisionID===t.RevisionID?e.updateVersionInfo(r.baseVersion,t):r.currentVersion&&r.currentVersion.RevisionID===t.RevisionID&&e.updateVersionInfo(r.currentVersion,t)))})),this.fireDownloadTokenReadyEvent(this.Versions,r),[2,!0])):(i.c.sendTraceTag(595907533,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"getDownloadToken failed"),n&&n.errorCode?this.fireFullAppErrorEvent(n.errorCode):this.fireFullAppErrorEvent(101),[2,!1])}}))}))},e.prototype.dispose=function(){this._isDisposed=!0,this.Versions=[]},e.prototype.fireTipVersionTokenReadyEvent=function(e,t){if(!this._isDisposed){var r={tipVersion:e,updatedVersions:this.Versions,containerDiv:document.getElementById("vhViewer"),correlationID:t};i.c.sendTraceTag(595882757,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"fireTipVersionTokenReadyEvent"),this._tipVersionTokenReadyEvent.fireEvent(r)}},e.prototype.fireVersionsReadyEvent=function(e,t){if(!this._isDisposed){var r={versions:e,containerDiv:document.getElementById("vhViewer"),correlationID:t};i.c.sendTraceTag(595914892,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"fireVersionsReadyEvent"),this._versionHistoryReadyEvent.fireEvent(r)}},e.prototype.fireDownloadTokenReadyEvent=function(e,t){if(!this._isDisposed){var r={updatedVersions:e,versionSelected:t};i.c.sendTraceTag(595907532,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"fireDownloadTokenReadyEvent"),this._downloadTokenReadyEvent.fireEvent(r)}},e.prototype.fireFullAppErrorEventWithDefaultCode=function(e){e?this.fireFullAppErrorEvent(e):this.fireFullAppErrorEvent(100)},e.prototype.fireFullAppErrorEvent=function(e){this._isDisposed||(i.c.sendTraceTag(595906849,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"fireFullAppErrorEvent, error code: "+e),this._fullAppErrorEvent.fireEvent(e))},e.updateVersionInfo=function(e,t){null!=e?null!=t?(e.DownloadUrl=t.DownloadUrl,e.WopiInfo=t.WopiInfo):i.c.sendTraceTag(595858567,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"updateVersionInfo, currentVersionInfo is null"):i.c.sendTraceTag(595858566,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"currentVersionInfo, currentVersionInfo is null")},e.updateAuthorColorInfo=function(e){e.Authors&&e.Authors.forEach((function(e){e&&(e.InitialsColor=c.getInitialsColorFromName(e.UserName))}))},e}(),d=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e}(),u=r(0),h=r(107),g=r(14),m=r(5),f=Object(g.b)((function(e){return void 0===e&&(e=!1),{root:Object(m.ab)({display:"flex",flexFlow:"row",width:"100%",height:"100%",direction:e?"rtl":"ltr"}),hidden:Object(m.ab)({display:"none"}),fullAppErrorDiv:Object(m.ab)({display:"flex",flexFlow:"column",width:"100%",height:"100%"})}})),v=r(36),y=r(618),b=r(154),C=Object(g.b)((function(e,t,r){return void 0===e&&(e="#B7472A"),void 0===t&&(t=!1),{root:Object(m.ab)({display:"flex",flexFlow:"column",flexBasis:"22%",flexGrow:1,flexShrink:1.5,maxWidth:"300px",minWidth:"220px",height:"calc(100% - 2px)",border:"1px solid #DEDEDE",backgroundColor:r?"white":"#EDEBE9"}),scrollRegion:Object(m.ab)({flexFlow:"column",overflowY:"auto",overflowX:"hidden",marginBottom:"40px",marginLeft:r?"10px":"",marginRight:r?"10px":""}),loadingDiv:Object(m.ab)({display:"flex",flexGrow:1,justifyContent:"center",alignItems:"center"}),loadingSpinner:Object(m.ab)({selectors:{"& .ms-Spinner-circle":{borderColor:"#dddddd",borderTopColor:e}}}),paneHeader:Object(m.ab)({width:"98px",color:"#505050",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",fontWeight:600,lineHeight:"19px",marginLeft:"11px",marginTop:"16px",marginBottom:"10px"}),showChangesDiv:Object(m.ab)({display:t?"flex":"none",height:t?"15px":"0px"}),hidden:Object(m.ab)({display:"none"})}})),S={overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},_=Object(g.b)((function(e,t){var r,o,n,i,s,a;return{root:Object(m.ab)({backgroundColor:t?e?"#D2D0CE":"#F3F2F1":e?"#A6A6A6":"#FFFFFF",marginLeft:"9px",marginRight:t?"9px":"12px",paddingBottom:t?"5px":"",display:"flex",flexFlow:"row",outline:"none",selectors:(r={},r[m.k]={backgroundColor:e?"Highlight":"Window",color:e?"HighlightText":"WindowText"},r[":hover"]={backgroundColor:"#f8f8f8",selectors:(o={},o[m.k]={backgroundColor:"Highlight",color:"HighlightText"},o)},r)},S),body:Object(m.ab)({display:"flex",flexFlow:"column",cursor:"pointer",selectors:(n={},n[m.k]={MsHighContrastAdjust:"none",color:"inherit"},n)}),author:Object(m.ab)({display:"inline-block",marginBottom:"8px"}),authorBold:Object(m.ab)({display:"inline-block",fontWeight:"bold",marginTop:"8px"}),authorDiv:Object(m.ab)({display:"flex",flexFlow:"row",marginLeft:"16px",marginTop:"4px"}),miniAuthorDiv:Object(m.ab)({display:"flex",flexFlow:"row",marginLeft:"30px",marginTop:"4px"}),authorName:Object(m.ab)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"11px",marginLeft:"6px",selectors:(i={},i[m.k]={MsHighContrastAdjust:"none",color:"inherit"},i)}),timestamp:Object(m.ab)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontWeight:e?"600":"normal",fontSize:"13px",lineHeight:"17px",marginLeft:"16px",marginTop:"8px",selectors:(s={},s[m.k]={MsHighContrastAdjust:"none",color:"inherit"},s)}),timestampSubtle:Object(m.ab)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontWeight:e?"600":"normal",fontSize:"11px",marginLeft:"42px",selectors:(a={},a[m.k]={MsHighContrastAdjust:"none",color:"inherit"},a)})}})),E=r(421),V=function(){function e(){}return Object.defineProperty(e,"UILocale",{get:function(){return null!=this.uiLocale&&""!==this.uiLocale?this.uiLocale:"en-us"},set:function(e){this.uiLocale=e},enumerable:!0,configurable:!0}),e.uiLocale="",e}(),T=864e5,w=36e5,I=6e4,x=1e3,D=60,A=3600;function k(e,t,r,o){void 0===o&&(o=!1);var n=t||new Date,s=(n.getTime()-e.getTime())/1e3,a=Math.floor((n.getTime()-n.getTimezoneOffset()*I)/T),l=Math.floor((e.getTime()-e.getTimezoneOffset()*I)/T),c=n.getTime()-(n.getHours()*w+n.getMinutes()*I+n.getSeconds()*x)-(n.getDay()+6)%7*T,p=c-7*T,d=p-7*T,u=d-7*T,h=E.namespace();if(h.setup({locale:F(),missingTranslation:"ignore"}),null!=r){if(e<=n){if(s<2*D)return{friendlyDateString:r.JustNow,friendlyGroupString:r.TodayVersionsLabel};if(s<1*A){var g=Math.floor(s/60);return{friendlyDateString:h(r.MinutesAgo,{mins:g}),friendlyGroupString:r.TodayVersionsLabel}}if(l===a){var m=Math.floor(s/A);return{friendlyDateString:h(r.HoursAgo,{hours:m}),friendlyGroupString:r.TodayVersionsLabel}}return l===a-1?{friendlyDateString:r.YesterdayAt.replace("{0}",H(e)),friendlyGroupString:r.YesterdayVersionsLabel}:e.getTime()>=c?{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(F(),{weekday:"long"}).format(e)).replace("{1}",H(e)),friendlyGroupString:o?Intl.DateTimeFormat(F(),{weekday:"long"}).format(e):r.ThisWeekVersionsLabel}:e.getTime()>=p?{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(F(),{month:"long",day:"numeric"}).format(e)).replace("{1}",H(e)),friendlyGroupString:o?Intl.DateTimeFormat(F(),{month:"long",day:"numeric"}).format(e):r.LastWeekVersionsLabel}:e.getTime()>=d&&e.getMonth()===n.getMonth()?{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(F(),{month:"long",day:"numeric"}).format(e)).replace("{1}",H(e)),friendlyGroupString:o?Intl.DateTimeFormat(F(),{month:"long",day:"numeric"}).format(e):r.TwoWeekVersionsLabel}:e.getTime()>=u&&e.getMonth()===n.getMonth()?{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(F(),{month:"long",day:"numeric"}).format(e)).replace("{1}",H(e)),friendlyGroupString:o?Intl.DateTimeFormat(F(),{month:"long",day:"numeric"}).format(e):r.ThreeWeekVersionsLabel}:function(e,t){return e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}(e,n)?{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(F(),{month:"long",day:"numeric"}).format(e)).replace("{1}",H(e)),friendlyGroupString:o?Intl.DateTimeFormat(F(),{month:"long",day:"numeric"}).format(e):r.ThisMonthVersionsLabel}:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()-1}(e,n)?{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(F(),{month:"long",day:"numeric"}).format(e)).replace("{1}",H(e)),friendlyGroupString:o?Intl.DateTimeFormat(F(),{month:"long",day:"numeric"}).format(e):r.LastMonthVersionsLabel}:e.getFullYear()===n.getFullYear()?{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(F(),{month:"long",day:"numeric"}).format(e)).replace("{1}",H(e)),friendlyGroupString:o?Intl.DateTimeFormat(F(),{month:"long",day:"numeric"}).format(e):Intl.DateTimeFormat(F(),{month:"long"}).format(e)}:{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(F(),{month:"long",day:"numeric",year:"numeric"}).format(e)).replace("{1}",H(e)),friendlyGroupString:o?Intl.DateTimeFormat(F(),{month:"long",day:"numeric",year:"numeric"}).format(e):Intl.DateTimeFormat(F(),{year:"numeric",month:"long"}).format(e)}}return i.c.sendTraceTag(595682911,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"Version date time > now: "+e.toUTCString()+" > "+n.toUTCString()),{friendlyDateString:r.JustNow,friendlyGroupString:r.TodayVersionsLabel}}return i.c.sendTraceTag(595682912,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"localizedStrings is null. Version date: "+e.toUTCString()+", Now: "+n.toUTCString()),{friendlyDateString:Intl.DateTimeFormat(F(),{month:"long",day:"numeric",year:"numeric"}).format(e>n?n:e),friendlyGroupString:o?Intl.DateTimeFormat(F(),{month:"long",day:"numeric",year:"numeric"}).format(e>n?n:e):Intl.DateTimeFormat(F(),{year:"numeric",month:"long"}).format(e>n?n:e)}}function H(e){return Intl.DateTimeFormat(F(),{hour:"numeric",minute:"numeric"}).format(e)}function F(){return V.UILocale}var R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.componentDidMount=function(){N.register(this)},t.prototype.componentWillUnmount=function(){N.unregister(this)},t.prototype.render=function(){return k(this.props.date,void 0,this.props.localizedStrings).friendlyDateString},t}(u.PureComponent),N=new(function(){function e(){this.components=[]}return e.prototype.register=function(e){var t=this;this.components.push(e),void 0===this.timerId&&(this.timerId=window.setInterval((function(){return t.onTimerFired()}),6e4))},e.prototype.unregister=function(e){this.components=this.components.filter((function(t){return t!==e})),this.components.length||window.clearInterval(this.timerId)},e.prototype.onTimerFired=function(){this.components.forEach((function(e){return e.forceUpdate()}))},e}()),B=Object(g.b)((function(){var e;return{authorDiv:Object(m.ab)({display:"flex",flexFlow:"row",marginLeft:"16px",marginTop:"4px"}),authorName:Object(m.ab)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"11px",marginLeft:"6px",selectors:(e={},e[m.k]={MsHighContrastAdjust:"none",color:"inherit"},e)})}})),L=Object(g.b)((function(e){var t;return{authorRole:Object(m.ab)({fontWeight:300,fontSize:"12px"}),authorName:Object(m.ab)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",fontWeight:600,selectors:(t={},t[m.k]={MsHighContrastAdjust:"none",color:"inherit"},t)}),colorBlock:Object(m.ab)({backgroundColor:e,width:"10px",height:"10px",marginLeft:"2px",marginRight:"2px",display:"inline-block"})}})),z=r(619),O=r(18),j=r(1109);function U(e,t){return t||e.GuestUserDisplayName}function W(e,t){return t||c.getInitialsColorFromName(e)}var P=u.memo((function(e){var t=B(),r=U(e.localizedStrings,e.name),o=W(r,e.color);return u.createElement("div",{key:e.key,className:t.authorDiv},u.createElement(z.a,{size:O.c.size16,coinSize:20,text:r,initialsColor:o,hidePersonaDetails:!0}),u.createElement("div",{className:t.authorName},r))})),M=u.memo((function(e){var t=U(e.localizedStrings,e.name),r=W(t,e.color),o=L(r);if(e.role){var n=Object(j.a)(e.localizedStrings.userActionComboString,(function(r){return"0"===r?u.createElement("span",{className:o.authorName},u.createElement("span",{className:o.colorBlock,"data-is-focusable":!1}),t):"1"===r?u.createElement("span",{className:o.authorRole},e.role):""}));return u.createElement("span",null,n)}return u.createElement("span",{className:o.authorName},u.createElement("span",{className:o.colorBlock}),t)})),G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._root=u.createRef(),t.onClick=function(){var e={currentVersion:t.props.currentVersion,baseVersion:t.props.baseVersion};t.props.onVersionSelectedAction(e)},t.stopPropagation=function(e){e.stopPropagation()},t}return o.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,r=t.currentVersion,o=t.isSelected,n=t.ariaPosinset,s=t.ariaSetsize,a=_(o,this.props.appSettings.wdEnableCompareVersionsByGroup);if(!r.Time)return i.c.sendTraceTag(595933193,i.a.msoulscat_Wac_VersionHistory,i.b.Warning,JSON.stringify({msg:"Version missing timestamp or author",id:r.RevisionID})),!1;var l=[];r.Authors&&r.Authors.length>0?r.Authors.forEach((function(t){if(t){var o=r.RevisionID+"_"+Object(h.a)();e.props.appSettings.wdEnableCompareVersionsByGroup?l.push(u.createElement("div",{className:a.miniAuthorDiv},u.createElement(M,{key:o,name:t.UserName,color:t.InitialsColor,role:e.props.localizedStrings.userAction,localizedStrings:e.props.localizedStrings}))):l.push(u.createElement(P,{key:o,name:t.UserName,color:t.InitialsColor,localizedStrings:e.props.localizedStrings}))}})):this.props.appSettings.wdEnableCompareVersionsByGroup?l.push(u.createElement("div",{className:a.miniAuthorDiv},u.createElement(M,{key:r.RevisionID,name:r.AuthorID,role:this.props.localizedStrings.userAction,localizedStrings:this.props.localizedStrings}))):l.push(u.createElement(P,{key:r.RevisionID,name:r.AuthorID,localizedStrings:this.props.localizedStrings}));var c=u.createElement(R,{date:r.Time,localizedStrings:this.props.localizedStrings});return this.props.appSettings.wdEnableCompareVersionsByGroup?u.createElement("div",{ref:this._root,onClick:this.onClick,onFocus:this.onClick,className:a.root,"data-is-focusable":!0,"data-automation-id":this.props.currentVersion.RevisionID,"data-unique-id":this.props.currentVersion.RevisionID,"aria-selected":o,role:"listitem","aria-posinset":n,"aria-setsize":s},u.createElement("div",{className:a.body,onClick:this.stopPropagation},u.createElement("div",{className:a.authorBold},l),u.createElement("div",{className:a.timestampSubtle},c))):u.createElement("div",{ref:this._root,onClick:this.onClick,onFocus:this.onClick,className:a.root,"data-is-focusable":!0,"data-automation-id":this.props.currentVersion.RevisionID,"data-unique-id":this.props.currentVersion.RevisionID,"aria-selected":o,role:"listitem","aria-posinset":n,"aria-setsize":s},u.createElement("div",{className:a.body,onClick:this.stopPropagation},u.createElement("div",{className:a.timestamp},c),u.createElement("div",{className:a.author},l)))},t}(u.PureComponent),K=r(1133),X=Object(g.b)((function(e){return void 0===e&&(e="#B7472A"),{sectionName:Object(m.ab)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",marginLeft:"16px",marginTop:"12px",marginBottom:"4px"}),versionCount:Object(m.ab)({color:e,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",fontWeight:"normal",lineHeight:"16px",marginTop:"12px",marginBottom:"4px",marginLeft:"auto",display:"none"}),sectionHeader:Object(m.ab)({display:"flex",fontWeight:600,selectors:{":focus":{fontWeight:"bold"}}}),expand:Object(m.ab)({height:"8px",width:"11px",color:"#303030",fontFamily:"FabricMDL2Icons-2",fontSize:"10px",lineHeight:"16px",marginLeft:"auto",marginRight:"16px",marginTop:"16px",marginBottom:"4px",display:"inline-block",cursor:"pointer"}),collapse:Object(m.ab)({height:"8px",width:"11px",color:"#303030",fontFamily:"FabricMDL2Icons-2",fontSize:"10px",lineHeight:"16px",marginLeft:"5px",marginRight:"16px",marginTop:"11px",marginBottom:"4px",display:"none",cursor:"pointer"})}})),q=r(94),J=r(317),Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._list=u.createRef(),t._id=Object(h.a)(),t._header=u.createRef(),t.getListItemKey=function(e,t){return e.RevisionID||""},t.getBaseVersion=function(e,t,r){var o=null;return t.forEach((function(n,i){n===e&&(i!==t.length-1?o=t[i+1]:i===t.length-1&&(o=r))})),o},t.onShouldVirtualize=function(){return!0},t._commonCardProps={localizedStrings:t.props.localizedStrings,onVersionSelectedAction:t.props.onVersionSelectedAction},t.onRenderListItem=function(e,r){if(void 0!==e)return u.createElement("div",null,u.createElement(G,o.__assign({currentVersion:e,baseVersion:t.getBaseVersion(e,t.props.versions,t.props.finalBaseVersion),isSelected:t.props.selectedVersionId===e.RevisionID,ariaPosinset:void 0!==r?r+1:0,ariaSetsize:t.props.versions.length,appSettings:t.props.appSettings},t._commonCardProps)))},t.onSectionIconClick=function(){t.isListVisible()?t.collapseSubsection():t.expandSubsection()},t.isListVisible=function(){var e=document.getElementById(t._id);return null!=e&&e.offsetWidth>0&&e.offsetHeight>0},t.onKeyDownInSectionHeader=function(e){(e.which===v.a.left&&!Object(q.a)()||e.which===v.a.right&&Object(q.a)())&&t.collapseSubsection(),(e.which===v.a.right&&!Object(q.a)()||e.which===v.a.left&&Object(q.a)())&&t.expandSubsection()},t.showElement=function(e){e&&(e.style.display="block")},t.hideElement=function(e){e&&(e.style.display="none")},t}return o.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.appSettings.appColor?this.props.appSettings.appColor:"#B7472A",r=X(t),o=this.props.versions,n=this.props.label+": "+this.versionCountString(o.length);return u.createElement(u.Fragment,null,o.length>0&&u.createElement("div",null,u.createElement("div",{className:r.sectionHeader,"data-is-focusable":!0,onKeyDown:function(t){return e.onKeyDownInSectionHeader(t)},"aria-label":n,role:"treeitem","aria-expanded":"true",ref:this._header},u.createElement("div",{className:r.sectionName},this.props.label),u.createElement("div",{className:r.versionCount,id:this._id+"verCount"},this.versionCountString(o.length)),u.createElement(J.a,{id:this._id+"IconExpand",className:r.expand,iconName:"FlickUp",onClick:function(){return e.onSectionIconClick()}}),u.createElement(J.a,{id:this._id+"IconCollapse",className:r.collapse,iconName:"FlickDown",onClick:function(){return e.onSectionIconClick()}})),u.createElement(K.a,{id:this._id,ref:this._list,items:o,onRenderCell:this.onRenderListItem,onShouldVirtualize:this.onShouldVirtualize,getKey:this.getListItemKey,role:"list","aria-label":this.props.label})))},t.prototype.UNSAFE_componentWillUpdate=function(e,t,r){return this._list.current&&this._list.current.forceUpdate(),null},t.prototype.componentDidUpdate=function(){},t.prototype.expandSubsection=function(){this.showElement(document.getElementById(this._id)),this.hideElement(document.getElementById(this._id+"IconCollapse")),this.showElement(document.getElementById(this._id+"IconExpand")),this.hideElement(document.getElementById(this._id+"verCount"));var e=this._header.current;e&&e.setAttribute("aria-expanded","true")},t.prototype.collapseSubsection=function(){this.hideElement(document.getElementById(this._id)),this.showElement(document.getElementById(this._id+"IconCollapse")),this.hideElement(document.getElementById(this._id+"IconExpand")),this.showElement(document.getElementById(this._id+"verCount"));var e=this._header.current;e&&e.setAttribute("aria-expanded","false")},t.prototype.versionCountString=function(e){return 1===e?this.props.localizedStrings.SingleVersionText:e>1?this.props.localizedStrings.MultiVersionsText.replace("{0}",e.toString()):""},t}(u.PureComponent),Q=Object(g.b)((function(e){var t,r,n,i,s,a={height:"8px",width:"11px",color:"#303030",fontFamily:"FabricMDL2Icons-2",fontSize:"10px",lineHeight:"16px",marginLeft:"5px",marginRight:"10px",verticalAlign:"center",display:"none",cursor:"pointer",selectors:(t={},t[m.k]={MsHighContrastAdjust:"none",color:"inherit"},t)};return{sectionName:Object(m.ab)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"15px",selectors:(r={},r[m.k]={MsHighContrastAdjust:"none",color:"inherit"},r)}),sectionHeader:Object(m.ab)({backgroundColor:e?"#E1DFDD":"",display:"flex",paddingTop:"10px",paddingBottom:"10px",selectors:(n={},n[m.k]={backgroundColor:e?"Highlight":"Window",color:e?"HighlightText":"WindowText"},n[":hover"]={backgroundColor:"#f8f8f8",selectors:(i={},i[m.k]={backgroundColor:"Highlight",color:"HighlightText"},i)},n)}),sectionNameDiv:Object(m.ab)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",verticalAlign:"center",lineHeight:"16px",cursor:"pointer",selectors:(s={},s[m.k]={MsHighContrastAdjust:"none",color:"inherit"},s)}),currentVersionDiv:Object(m.ab)({fontSize:"12px",paddingTop:"2px",paddingBottom:"2px"}),authorsList:Object(m.ab)({fontSize:"12px"}),expand:Object(m.ab)(o.__assign({},a,{display:"none"})),collapse:Object(m.ab)(o.__assign({},a,{display:"inline-block"})),versionList:Object(m.ab)({display:"none",backgroundColor:"#F3F2F1",paddingBottom:"5px"}),groupDiv:Object(m.ab)({marginTop:"5px",marginBottom:"5px"})}})),Z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._list=u.createRef(),t._id=Object(h.a)(),t._header=u.createRef(),t._groupVersion=void 0,t.renderAndSetAuthorList=function(){var e=Q(t.props.selectedGroupName===t.props.label),r=function(e,t){var r=[];return e.forEach((function(e){if(e.Authors&&e.Authors.length>0)e.Authors.forEach((function(e){if(e)if(e.UserName){var o=U(t,e.UserName);if(r.some((function(e){return e.UserName===o})))return;r.push(e)}else{var n=U(t,e.UserName);if(!r.some((function(e){return e.UserName===n}))){var i={UserName:n};r.push(i)}}}));else{var o=U(t,e.AuthorID);if(r.some((function(e){return e.UserName===o})))return;var n={UserName:o};r.push(n)}})),r}(t.props.versions,t.props.localizedStrings),o=[];switch(r.length){case 0:i.c.sendTraceTag(595644672,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"there were no authors to display");break;case 1:o=t.render1To4Authors(t.props.localizedStrings.oneUserAuthorList,r);break;case 2:o=t.render1To4Authors(t.props.localizedStrings.twoUserAuthorList,r);break;case 3:o=t.render1To4Authors(t.props.localizedStrings.threeUserAuthorList,r);break;case 4:o=t.render1To4Authors(t.props.localizedStrings.fourUserAuthorList,r);break;default:o=Object(j.a)(t.props.localizedStrings.fivePlusUserAuthorList,(function(e){return"3"===e?(r.length-3).toString():t.renderAuthor(r[parseInt(e,10)])}))}return t._groupVersion&&(t._groupVersion.Authors=r),u.createElement("div",{id:t._id+"AuthorList",className:e.authorsList},o)},t.render1To4Authors=function(e,r){return Object(j.a)(e,(function(e){return t.renderAuthor(r[parseInt(e,10)])}))},t.renderAuthor=function(e){return u.createElement(M,{name:e.UserName,color:e.InitialsColor,localizedStrings:t.props.localizedStrings})},t.getListItemKey=function(e,t){return e.RevisionID||""},t.getBaseVersion=function(e,t,r){var o=null;return t.forEach((function(n,i){n===e&&(o=i!==t.length-1?t[i+1]:r)})),o},t.onShouldVirtualize=function(){return!0},t._commonCardProps={localizedStrings:t.props.localizedStrings,onVersionSelectedAction:t.props.onVersionSelectedAction},t.onRenderListItem=function(e,r){if(void 0!==e)return u.createElement("div",null,u.createElement(G,o.__assign({currentVersion:e,baseVersion:t.getBaseVersion(e,t.props.versions,t.props.finalBaseVersion),isSelected:!t.props.selectedGroupName&&t.props.selectedVersionId===e.RevisionID,ariaPosinset:void 0!==r?r+1:0,ariaSetsize:t.props.versions.length,appSettings:t.props.appSettings},t._commonCardProps)))},t.onSectionIconClick=function(){t.expandOrCollapseSubsection(!t.isListVisible())},t.onSectionSelected=function(){var e={currentVersion:t._groupVersion?t._groupVersion:t.props.currentSectionVersion,baseVersion:t.props.finalBaseVersion,groupName:t.props.label};t.props.onVersionSelectedAction(e),t.expandOrCollapseSubsection(!1)},t.isListVisible=function(){var e=document.getElementById(t._id);return null!=e&&"block"===e.style.display},t.onKeyDownInSectionHeader=function(e){(e.which===v.a.left&&!Object(q.a)()||e.which===v.a.right&&Object(q.a)())&&t.expandOrCollapseSubsection(!1),(e.which===v.a.right&&!Object(q.a)()||e.which===v.a.left&&Object(q.a)())&&t.expandOrCollapseSubsection(!0)},t.displayElement=function(e,t){t&&(t.style.display=e?"block":"none")},t}return o.__extends(t,e),t.prototype.render=function(){var e=this,t=Q(this.props.selectedGroupName===this.props.label),r=this.props.versions;this._groupVersion=o.__assign({},this.props.currentSectionVersion);var n=this.renderAndSetAuthorList();return this.props.selectedGroupName===this._groupVersion.RevisionID&&this.onSectionSelected(),u.createElement(u.Fragment,null,r.length>0&&u.createElement("div",{id:this._id+"GroupDiv",className:t.groupDiv},u.createElement("div",{className:t.sectionHeader,"data-is-focusable":!0,onKeyDown:function(t){return e.onKeyDownInSectionHeader(t)},"aria-label":this.props.label,role:"treeitem","aria-expanded":"false",ref:this._header},u.createElement(J.a,{id:this._id+"IconExpand",className:t.expand,iconName:"FlickUp",onClick:function(){return e.onSectionIconClick()}}),u.createElement(J.a,{id:this._id+"IconCollapse",className:t.collapse,iconName:this.props.appSettings.isRtl?"FlickRight":"FlickLeft",onClick:function(){return e.onSectionIconClick()}}),u.createElement("div",{className:t.sectionNameDiv,"data-is-focusable":!0,onClick:function(){return e.onSectionSelected()}},u.createElement("div",{className:t.sectionName},this.props.clickableGroupDisplayString),this.props.containsTip&&u.createElement("div",{className:t.currentVersionDiv},this.props.localizedStrings.currentVersion),n)),u.createElement(K.a,{id:this._id,className:t.versionList,ref:this._list,items:r,onRenderCell:this.onRenderListItem,onShouldVirtualize:this.onShouldVirtualize,getKey:this.getListItemKey,role:"list","aria-label":this.props.label})))},t.prototype.UNSAFE_componentWillUpdate=function(e,t,r){return this._list.current&&this._list.current.forceUpdate(),null},t.prototype.componentDidUpdate=function(){},t.prototype.expandOrCollapseSubsection=function(e){this.displayElement(!e,document.getElementById(this._id+"IconCollapse")),this.displayElement(!e,document.getElementById(this._id+"AuthorList")),this.displayElement(e,document.getElementById(this._id)),this.displayElement(e,document.getElementById(this._id+"IconExpand"));var t=document.getElementById(this._id+"GroupDiv");t&&(t.style.background=e?"#F3F2F1":"white");var r=this._header.current;r&&r.setAttribute("aria-expanded",e?"true":"false")},t}(u.PureComponent);var $,ee=Object(g.b)((function(){return{nothingFoundRoot:Object(m.ab)({display:"flex",flex:"none",margin:"1px 8px"}),nothingFoundText:Object(m.ab)({padding:"14px",textAlign:"center",margin:"0 auto"})}})),te=r(988),re=r(108),oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._nothingFoundId=Object(h.a)(),t}return o.__extends(t,e),t.prototype.render=function(){var e=this,t=ee(),r=this.props,n=r.localizedStrings,i=r.versions,s=[];i.forEach((function(t){var r=k(t.Time,void 0,n,e.props.appSettings.wdEnableCompareVersionsByGroup),o=r.friendlyGroupString,i=s.length;0===i?s.push({versions:[t],label:o,clickableGroupDisplayString:r.friendlyDateString,finalBaseVersion:null,currentSectionVersion:t,containsTip:!0}):s[i-1].label!==o?(s[i-1].finalBaseVersion=t,s.push({versions:[t],label:o,clickableGroupDisplayString:r.friendlyDateString,finalBaseVersion:null,currentSectionVersion:t,containsTip:!1})):s[i-1].versions.push(t)}));var a={selectedVersionId:this.props.selectedVersionId,localizedStrings:this.props.localizedStrings,appSettings:this.props.appSettings,onVersionSelectedAction:this.props.onVersionSelectedAction};return u.createElement(u.Fragment,null,i.length?u.createElement(te.a,{direction:re.a.vertical},s.length>0&&s.map((function(t){return e.props.appSettings.wdEnableCompareVersionsByGroup?u.createElement(Z,o.__assign({key:t.label,label:t.label,clickableGroupDisplayString:t.clickableGroupDisplayString,versions:t.versions,finalBaseVersion:t.finalBaseVersion,currentSectionVersion:t.currentSectionVersion,selectedGroupName:e.props.selectedGroupName,containsTip:t.containsTip},a)):u.createElement(Y,o.__assign({key:t.label,label:t.label,versions:t.versions,finalBaseVersion:t.finalBaseVersion},a))}))):u.createElement("div",{className:t.nothingFoundRoot,tabIndex:0,"aria-labelledby":this._nothingFoundId,role:"note"},u.createElement("div",{className:t.nothingFoundText,id:this._nothingFoundId,"aria-hidden":!0},n.VersionHistoryTitle)))},t}(u.PureComponent),ne=r(1089),ie=r(1136),se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ftzone=u.createRef(),t._paneDescribedById="versionHistoryPane",t.getAppColor=function(){return t.props.appColors?t.props.appColors.primary:t.props.appSettings.appColor?t.props.appSettings.appColor:(i.c.sendTraceTag(595683400,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"Missing app colors."),"#B7472A")},t.getToggleStyles=function(){return{root:{height:14,marginLeft:16},label:{fontSize:13,order:0,marginLeft:0,marginRight:5,marginBottom:4},pill:{width:32,height:14,borderRadius:7,marginBottom:1},thumb:{width:4,height:4,borderRadius:"50%"},text:{display:"none"}}},t.getToggleTheme=function(e){return{palette:{themePrimary:e.primary,themeSecondary:e.tint10,themeDark:e.shade10,neutralDark:e.shade20},semanticColors:{bodyBackground:e.tint50,inputBackgroundChecked:e.tint10}}},t.renderStandardListView=function(){var e,r=C(t.getAppColor(),t.props.appSettings.wdEnableShowVersionChanges,t.props.appSettings.wdEnableCompareVersionsByGroup),n=t.props,i=n.paneLoading,s=n.versions,a={localizedStrings:t.props.localizedStrings,selectedVersionId:t.props.selectedVersionId,onVersionSelectedAction:t.props.onVersionSelectedAction,appSettings:t.props.appSettings};return e=void 0!==t.props.appColors?u.createElement(ie.a,{theme:Object(m.J)(t.getToggleTheme(t.props.appColors)),styles:t.getToggleStyles(),defaultChecked:!0,label:t.props.localizedStrings.ShowChangesText,inlineLabel:!0,onChange:t.onShowVersionChangesChange}):u.createElement(ie.a,{styles:t.getToggleStyles(),defaultChecked:!0,label:t.props.localizedStrings.ShowChangesText,inlineLabel:!0,onChange:t.onShowVersionChangesChange}),u.createElement(u.Fragment,null,u.createElement("div",{className:r.paneHeader},a.localizedStrings.VersionHistoryTitle),u.createElement("div",{className:r.showChangesDiv},e),i?u.createElement("div",{className:r.loadingDiv},u.createElement(y.a,{className:r.loadingSpinner,size:b.a.large})):u.createElement("div",{className:r.scrollRegion},u.createElement(oe,o.__assign({versions:s,selectedGroupName:t.props.selectedGroupName},a))))},t.focus=function(){return t._ftzone.current&&t._ftzone.current.focus()},t.onKeyDown=function(e){e.which!==v.a.up&&e.which!==v.a.down||e.preventDefault()},t.onShowVersionChangesChange=function(e,r){void 0!==r&&t.props.onShowVersionChangesToggledAction(r)},t}return o.__extends(t,e),t.prototype.render=function(){var e=C(this.getAppColor(),this.props.appSettings.wdEnableShowVersionChanges,this.props.appSettings.wdEnableCompareVersionsByGroup),t=this.props.localizedStrings;return u.createElement(ne.a,{ref:this._ftzone,onKeyDown:this.onKeyDown,className:e.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!0,"aria-label":t.VersionHistoryTitle,"aria-describedby":this._paneDescribedById,role:"group","aria-roledescription":this.props.localizedStrings.PaneRoleDescription},this.renderStandardListView(),u.createElement("div",{id:this._paneDescribedById,className:e.hidden,"aria-hidden":!0},t.VersionHistoryTitle))},t}(u.PureComponent),ae=r(142),le=Object(g.b)((function(e,t,r,o,n,i,s,a){var l,c,p,d;return void 0===r&&(r="#B7472A"),void 0===o&&(o=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===a&&(a=!1),{root:Object(m.ab)({display:"flex",flexBasis:"78%",flexFlow:"column",minWidth:"400px",flexGrow:1.5,flexShrink:1,height:"100%"}),vhHeader:Object(m.ab)({height:"48px",width:"100%",backgroundColor:"#F4F3F1",display:"flex"}),vhViewer:Object(m.ab)({backgroundColor:"#EDEBE9",flexDirection:"column",flexGrow:1,width:"100%",display:e||t?"none":"flex",position:i?"relative":"static"}),backArrow:Object(m.ab)({height:"16px",width:"16px",color:"#4A4A4A",fontFamily:"FabricMDL2Icons-0",fontSize:"16px",lineHeight:"16px",marginLeft:"19px",marginTop:"16px",cursor:"pointer"}),icon:Object(m.ab)({flex:"none",marginTop:"3px",width:"16px",height:"16px"}),backToDoc:Object(m.ab)({height:"16px",whiteSpace:"nowrap",color:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",marginLeft:"18px",alignSelf:"center",cursor:"pointer"}),selectedVersionTime:Object(m.ab)({color:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:a?"18px":"12px",lineHeight:"16px",marginTop:"16px"}),ChangesText:Object(m.ab)({display:s?"flex":"none",height:"16px",color:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",lineHeight:"16px",marginTop:"16px",marginLeft:"36px"}),ChangesCountText:Object(m.ab)({display:s?"flex":"none",height:"16px",width:"fill-content",color:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",marginLeft:"12px",marginTop:"16px",cursor:"pointer"}),IteratorIcon:Object(m.ab)({display:s?"flex":"none",height:"16px",width:"16px",color:"#4A4A4A",fontFamily:"FabricMDL2Icons-3",justifyContent:"center",fontSize:"16px",lineHeight:"16px",marginLeft:"12px",marginTop:"16px",cursor:"pointer"}),viewerError:Object(m.ab)({display:t?"flex":"none",flexFlow:"column",justifyContent:"center",alignItems:"center",backgroundColor:"#EDEBE9",height:"100%",width:"100%"}),viewerErrorMessage:Object(m.ab)({height:"16px",width:"371px",color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",textAlign:"center",marginTop:"22px"}),loadingDiv:Object(m.ab)({display:e&&!t?"flex":"none",justifyContent:"center",alignItems:"center",backgroundColor:"#EDEBE9",height:"100%",width:"100%",flexFlow:"column"}),loadingSpinner:Object(m.ab)({selectors:{"& .ms-Spinner-circle":{borderColor:"#dddddd",borderTopColor:r}}}),hidden:Object(m.ab)({display:"none"}),saveACopyButton:Object(m.ab)({display:o?"flex":"none",backgroundColor:r,color:"#FFFFFF",lineHeight:"16px",marginTop:"6px",marginLeft:a?"":"23px",marginRight:a?"16px":"",whiteSpace:a?"nowrap":""}),primarySaveACopyButton:Object(m.ab)({display:o?"flex":"none",lineHeight:"16px",marginTop:"6px",marginLeft:a?"":"23px",marginRight:a?"16px":"",whiteSpace:a?"nowrap":"",selectors:(l={},l[m.k]={backgroundColor:"Window",color:"WindowText",border:"1px solid WindowText"},l[":hover"]={selectors:(c={},c[m.k]={backgroundColor:"Highlight",color:"HighlightText"},c)},l)}),restoreButton:Object(m.ab)({display:n?"flex":"none",backgroundColor:r,color:"#FFFFFF",lineHeight:"16px",marginTop:"6px",marginLeft:"23px",marginRight:a?"16px":""}),primaryRestoreButton:Object(m.ab)({display:n?"flex":"none",lineHeight:"16px",marginTop:"6px",marginLeft:"23px",marginRight:a?"16px":"",selectors:(p={},p[m.k]={backgroundColor:"Window",color:"WindowText",border:"1px solid WindowText"},p[":hover"]={selectors:(d={},d[m.k]={backgroundColor:"Highlight",color:"HighlightText"},d)},p)}),headerContent:Object(m.ab)({display:"flex",flexGrow:"1",justifyContent:"center",width:"100%",overflow:a?"auto":"visible"}),headerContentRight:Object(m.ab)({display:"flex",flexGrow:"1",justifyContent:"flex-end"})}})),ce=r(391),pe=r(383),de=r(227),ue=r(592),he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.button=u.createRef(),t.focus=function(){if(t.button.current){t.button.current.focus();var e=document.getElementById(t.props.id);e&&Object(ue.a)(!0,e)}},t.getPrimaryButtonTheme=function(e){return{semanticColors:{primaryButtonBackground:e.primary,primaryButtonBackgroundHovered:e.shade10,primaryButtonBackgroundPressed:e.shade20}}},t}return o.__extends(t,e),t.prototype.render=function(){return this.props.appColors?u.createElement(pe.a,{componentRef:this.button,text:this.props.text,theme:Object(m.J)(this.getPrimaryButtonTheme(this.props.appColors)),className:this.props.primaryClassName,id:this.props.id,onClick:this.props.onClick,disabled:this.props.isDisabled,ariaDescription:this.props.ariaDescribedBy}):u.createElement(de.a,{componentRef:this.button,text:this.props.text,className:this.props.className,id:this.props.id,onClick:this.props.onClick,disabled:this.props.isDisabled,ariaDescription:this.props.ariaDescribedBy})},t}(u.PureComponent),ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ftzoneRoot=u.createRef(),t._ftzoneHeader=u.createRef(),t._ftzoneViewer=u.createRef(),t._headerDescribedById="versionHistoryHeader",t.onSaveAsClick=function(){t.getVersionInfoFromId(t.props.selectedVersionId,t.props)&&t.props.onSaveACopySelectedAction(t.getVersionInfoFromId(t.props.selectedVersionId,t.props).Version.DownloadUrl)},t.renderHeader=function(){var e,r=t.props.appSettings.fileExtension?t.props.appSettings.fileExtension:"",o=t.props.appSettings.appColor?t.props.appSettings.appColor:"#B7472A",n=!!t.getVersionInfoFromId(t.props.selectedVersionId,t.props),i=!!t.props.appSettings.wdEnableSaveACopy&&(t.props.appSettings.wdEnableSaveACopy&&!t.props.appSettings.disableSaveACopy),s=!!t.props.appSettings.wdEnableRestore&&t.props.appSettings.wdEnableRestore,a=!!t.props.appSettings.wdEnableIterator&&t.props.appSettings.wdEnableIterator,l=!!t.props.appSettings.wdEnableIteratorBasedHeaderAlignment&&t.props.appSettings.wdEnableIteratorBasedHeaderAlignment,c=t.props.appSettings.viewerRootPositionRelative,p=!!t.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete&&(t.props.viewerLoading||t.props.viewerError),d=a&&n&&t.props.totalChangesCount>=0&&t.props.currentChange<=t.props.totalChangesCount,h=le(t.props.viewerLoading,t.props.viewerError,o,i&&n,s&&n&&t.props.versions[0]&&t.props.selectedVersionId!==t.props.versions[0].RevisionID,c,d,l&&n);e=n?u.createElement(R,{date:t.getVersionInfoFromId(t.props.selectedVersionId,t.props).Version.Time,localizedStrings:t.props.localizedStrings}):u.createElement("div",null,t.props.localizedStrings.VersionHistoryTitle);var g=0===t.props.totalChangesCount?t.props.localizedStrings.IteratorNoChangesToolTip:"",m=0===t.props.totalChangesCount?g:t.props.localizedStrings.IteratorTotalChangesLabel.replace("{0}",t.props.localizedStrings.IteratorChangesCountLabel.replace("{0}",t.props.currentChange.toString()).replace("{1}",t.props.totalChangesCount.toString()));return 100!==t.props.appSettings.appName?t.createRenderWithoutFocusTrap(r,h,p,l,g,m,e):t.createRenderWithFocusTrap(r,h,p,l,g,m,e)},t.focus=function(){return t._ftzoneRoot.current&&t._ftzoneRoot.current.focus()},t.getVersionInfoFromId=function(e,t){if(e){var r=Object(ae.e)(t.versions,(function(t){return t.RevisionID===e}));return r>=0?{Version:t.versions[r]}:void 0}},t.onRestoreClick=function(){t.getVersionInfoFromId(t.props.selectedVersionId,t.props)&&t.props.onRestoreVersionAction(t.getVersionInfoFromId(t.props.selectedVersionId,t.props).Version.RevisionID)},t.onBackArrowKeyDown=function(e){e.which!==v.a.enter&&e.which!==v.a.space||t.props.onCloseSelectedAction()},t.onIteratorNextClick=function(){t.props.totalChangesCount>0&&(i.c.sendTraceTag(595648670,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"Iterator Next clicked-current count:"+t.props.currentChange.toString()+" ,total count:"+t.props.totalChangesCount.toString()),t.props.onIteratorSelectedAction(!0))},t.onIteratorPrevClick=function(){t.props.totalChangesCount>0&&(i.c.sendTraceTag(595648671,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"Iterator Previous clicked-current count:"+t.props.currentChange.toString()+" ,total count:"+t.props.totalChangesCount.toString()),t.props.onIteratorSelectedAction(!1))},t}return o.__extends(t,e),t.prototype.render=function(){var e=this.props.appSettings.appColor?this.props.appSettings.appColor:"#B7472A",t=le(this.props.viewerLoading,this.props.viewerError,e);return u.createElement(u.Fragment,null,u.createElement(ne.a,{ref:this._ftzoneRoot,className:t.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0,"aria-label":this.props.localizedStrings.HeaderAriaLabel,"aria-describedby":this._headerDescribedById,role:"group","aria-roledescription":this.props.localizedStrings.PaneRoleDescription},this.renderHeader()))},t.prototype.createRenderWithFocusTrap=function(e,t,r,o,n,i,s){u.createElement(u.Fragment,null);return o?u.createElement(u.Fragment,null,u.createElement(ne.a,{ref:this._ftzoneHeader,id:"vhHeader",className:t.vhHeader,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0},u.createElement(J.a,{id:"backArrow",className:t.backArrow,iconName:"Back",onClick:this.props.onCloseSelectedAction}),u.createElement("div",{id:"backToDoc",className:t.backToDoc,onKeyDown:this.onBackArrowKeyDown,onClick:this.props.onCloseSelectedAction,tabIndex:0,"aria-label":this.props.localizedStrings.ReturnToDoc,role:"button"},this.props.localizedStrings.ReturnToDoc),u.createElement("div",{className:t.headerContent},u.createElement("div",{id:"selectedVersionTime",className:t.selectedVersionTime},s),u.createElement("div",{id:"ChangesText",className:t.ChangesText},this.props.localizedStrings.IteratorChangesLabel),u.createElement(ce.a,{id:"iterateBack",className:t.IteratorIcon,title:n,"aria-label":this.props.localizedStrings.IteratorPreviousChangeButtonLabel,tabIndex:0,iconProps:{iconName:"ChevronLeftMed"},onClick:this.onIteratorPrevClick}),u.createElement("div",{id:"CountText",className:t.ChangesCountText,title:n,"aria-label":i,tabIndex:0},this.props.localizedStrings.IteratorChangesCountLabel.replace("{0}",this.props.currentChange.toString()).replace("{1}",this.props.totalChangesCount.toString())),u.createElement(ce.a,{id:"iterateFront",className:t.IteratorIcon,title:n,"aria-label":this.props.localizedStrings.IteratorNextChangeButtonLabel,tabIndex:0,iconProps:{iconName:"ChevronRightMed"},onClick:this.onIteratorNextClick})),u.createElement("div",{className:t.headerContentRight},u.createElement(he,{text:this.props.localizedStrings.RestoreLabel,className:t.restoreButton,primaryClassName:t.primaryRestoreButton,id:"VHRestoreButton",onClick:this.onRestoreClick,isDisabled:r,appColors:this.props.appColors}),u.createElement(he,{text:this.props.localizedStrings.SaveACopy,className:t.saveACopyButton,primaryClassName:t.primarySaveACopyButton,id:"VHSaveACopyButton",onClick:this.onSaveAsClick,isDisabled:r,appColors:this.props.appColors}))),u.createElement("div",{id:this._headerDescribedById,className:t.hidden,"aria-hidden":!0},"Version History Header"),u.createElement("div",{className:t.viewerError},u.createElement("img",{src:"https://static2.sharepointonline.com/files/fabric/assets/brand-icons/document/svg/"+e+"_48x1_5.svg",width:"62",height:"55"}),u.createElement("div",{className:t.viewerErrorMessage},this.props.localizedStrings.ViewerAreaErrorText)),u.createElement("div",{className:t.loadingDiv},u.createElement(y.a,{className:t.loadingSpinner,size:b.a.large})),u.createElement(ne.a,{ref:this._ftzoneViewer,className:t.vhViewer,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0},u.createElement("div",{id:"vhViewer",className:t.vhViewer}))):u.createElement(u.Fragment,null,u.createElement(ne.a,{ref:this._ftzoneHeader,id:"vhHeader",className:t.vhHeader,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!0},u.createElement(J.a,{id:"backArrow",className:t.backArrow,iconName:"Back",onClick:this.props.onCloseSelectedAction}),u.createElement("div",{id:"backToDoc",className:t.backToDoc,onKeyDown:this.onBackArrowKeyDown,onClick:this.props.onCloseSelectedAction,tabIndex:0,"aria-label":this.props.localizedStrings.ReturnToDoc,role:"button"},this.props.localizedStrings.ReturnToDoc),u.createElement("div",{className:t.headerContent},u.createElement("div",{id:"selectedVersionTime",className:t.selectedVersionTime},s),u.createElement(he,{text:this.props.localizedStrings.SaveACopy,className:t.saveACopyButton,primaryClassName:t.primarySaveACopyButton,id:"VHSaveACopyButton",onClick:this.onSaveAsClick,isDisabled:r,appColors:this.props.appColors}),u.createElement(he,{text:this.props.localizedStrings.RestoreLabel,className:t.restoreButton,primaryClassName:t.primaryRestoreButton,id:"VHRestoreButton",onClick:this.onRestoreClick,isDisabled:r,appColors:this.props.appColors}))),u.createElement("div",{id:this._headerDescribedById,className:t.hidden,"aria-hidden":!0},"Version History Header"),u.createElement("div",{className:t.viewerError},u.createElement("img",{src:"https://static2.sharepointonline.com/files/fabric/assets/brand-icons/document/svg/"+e+"_48x1_5.svg",width:"62",height:"55"}),u.createElement("div",{className:t.viewerErrorMessage},this.props.localizedStrings.ViewerAreaErrorText)),u.createElement("div",{className:t.loadingDiv},u.createElement(y.a,{className:t.loadingSpinner,size:b.a.large})),u.createElement(ne.a,{ref:this._ftzoneViewer,className:t.vhViewer,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0},u.createElement("div",{id:"vhViewer",className:t.vhViewer})))},t.prototype.createRenderWithoutFocusTrap=function(e,t,r,o,n,i,s){u.createElement(u.Fragment,null);return o?u.createElement(u.Fragment,null,u.createElement("div",{id:"vhHeader",className:t.vhHeader},u.createElement(J.a,{id:"backArrow",className:t.backArrow,iconName:"Back",onClick:this.props.onCloseSelectedAction}),u.createElement("div",{id:"backToDoc",className:t.backToDoc,onKeyDown:this.onBackArrowKeyDown,onClick:this.props.onCloseSelectedAction,tabIndex:0,"aria-label":this.props.localizedStrings.ReturnToDoc,role:"button"},this.props.localizedStrings.ReturnToDoc),u.createElement("div",{className:t.headerContent},u.createElement("div",{id:"selectedVersionTime",className:t.selectedVersionTime},s),u.createElement("div",{id:"ChangesText",className:t.ChangesText},this.props.localizedStrings.IteratorChangesLabel),u.createElement(ce.a,{id:"iterateBack",className:t.IteratorIcon,title:n,"aria-label":this.props.localizedStrings.IteratorPreviousChangeButtonLabel,tabIndex:0,iconProps:{iconName:"ChevronLeftMed"},onClick:this.onIteratorPrevClick}),u.createElement("div",{id:"CountText",className:t.ChangesCountText,title:n,"aria-label":i,tabIndex:0},this.props.localizedStrings.IteratorChangesCountLabel.replace("{0}",this.props.currentChange.toString()).replace("{1}",this.props.totalChangesCount.toString())),u.createElement(ce.a,{id:"iterateFront",className:t.IteratorIcon,title:n,"aria-label":this.props.localizedStrings.IteratorNextChangeButtonLabel,tabIndex:0,iconProps:{iconName:"ChevronRightMed"},onClick:this.onIteratorNextClick})),u.createElement("div",{className:t.headerContentRight},u.createElement(he,{text:this.props.localizedStrings.RestoreLabel,className:t.restoreButton,primaryClassName:t.primaryRestoreButton,id:"VHRestoreButton",onClick:this.onRestoreClick,isDisabled:r,appColors:this.props.appColors}),u.createElement(he,{text:this.props.localizedStrings.SaveACopy,className:t.saveACopyButton,primaryClassName:t.primarySaveACopyButton,id:"VHSaveACopyButton",onClick:this.onSaveAsClick,isDisabled:r,appColors:this.props.appColors}))),u.createElement("div",{id:this._headerDescribedById,className:t.hidden,"aria-hidden":!0},"Version History Header"),u.createElement("div",{className:t.viewerError},u.createElement("img",{src:"https://static2.sharepointonline.com/files/fabric/assets/brand-icons/document/svg/"+e+"_48x1_5.svg",width:"62",height:"55"}),u.createElement("div",{className:t.viewerErrorMessage},this.props.localizedStrings.ViewerAreaErrorText)),u.createElement("div",{className:t.loadingDiv},u.createElement(y.a,{className:t.loadingSpinner,size:b.a.large})),u.createElement("div",{id:"vhViewer",className:t.vhViewer})):u.createElement(u.Fragment,null,u.createElement("div",{id:"vhHeader",className:t.vhHeader},u.createElement(J.a,{id:"backArrow",className:t.backArrow,iconName:"Back",onClick:this.props.onCloseSelectedAction}),u.createElement("div",{id:"backToDoc",className:t.backToDoc,onKeyDown:this.onBackArrowKeyDown,onClick:this.props.onCloseSelectedAction,tabIndex:0,"aria-label":this.props.localizedStrings.ReturnToDoc,role:"button"},this.props.localizedStrings.ReturnToDoc),u.createElement("div",{className:t.headerContent},u.createElement("div",{id:"selectedVersionTime",className:t.selectedVersionTime},s),u.createElement(he,{text:this.props.localizedStrings.SaveACopy,className:t.saveACopyButton,primaryClassName:t.primarySaveACopyButton,id:"VHSaveACopyButton",onClick:this.onSaveAsClick,isDisabled:r,appColors:this.props.appColors}),u.createElement(he,{text:this.props.localizedStrings.RestoreLabel,className:t.restoreButton,primaryClassName:t.primaryRestoreButton,id:"VHRestoreButton",onClick:this.onRestoreClick,isDisabled:r,appColors:this.props.appColors}))),u.createElement("div",{id:this._headerDescribedById,className:t.hidden,"aria-hidden":!0},"Version History Header"),u.createElement("div",{className:t.viewerError},u.createElement("img",{src:"https://static2.sharepointonline.com/files/fabric/assets/brand-icons/document/svg/"+e+"_48x1_5.svg",width:"62",height:"55"}),u.createElement("div",{className:t.viewerErrorMessage},this.props.localizedStrings.ViewerAreaErrorText)),u.createElement("div",{className:t.loadingDiv},u.createElement(y.a,{className:t.loadingSpinner,size:b.a.large})),u.createElement("div",{id:"vhViewer",className:t.vhViewer}))},t}(u.PureComponent),me=Object(g.b)((function(e){var t,r;return void 0===e&&(e="#B7472A"),{modalButton:Object(m.ab)({backgroundColor:e,color:"#FFFFFF"}),primaryModalButton:Object(m.ab)({selectors:(t={},t[m.k]={backgroundColor:"Window",color:"WindowText",border:"1px solid WindowText"},t[":hover"]={selectors:(r={},r[m.k]={backgroundColor:"Highlight",color:"HighlightText"},r)},t)}),loadingSpinner:Object(m.ab)({selectors:{"& .ms-Spinner-circle":{borderColor:"#dddddd",borderTopColor:e}}})}})),fe=r(1124),ve=r(259),ye=r(643);!function(e){e[e.Hidden=1]="Hidden",e[e.CoauthRestoreDisplayed=2]="CoauthRestoreDisplayed",e[e.CoauthRestoreFailedServer=3]="CoauthRestoreFailedServer",e[e.CoauthRestoreInProgress=4]="CoauthRestoreInProgress"}($||($={}));var be=function(e){function t(t){return e.call(this,t)||this}return o.__extends(t,e),t.prototype.render=function(){var e=me(this.props.appSettings.appColor?this.props.appSettings.appColor:"#B7472A");switch(this.props.modalErrorState){case $.CoauthRestoreDisplayed:return u.createElement(fe.a,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{type:ve.a.normal,title:this.props.localizedStrings.OtherEditors,subText:this.props.localizedStrings.OtherEditorsSubtext}},u.createElement(ye.a,null,u.createElement(he,{text:this.props.localizedStrings.RestoreContinue,className:e.modalButton,primaryClassName:e.primaryModalButton,id:"VHRestorContinue",onClick:this.props.onDismiss,isDisabled:!1,appColors:this.props.appColors})));case $.CoauthRestoreInProgress:return u.createElement(fe.a,{hidden:!1,isBlocking:!0,onDismiss:this.props.onDismiss,dialogContentProps:{type:ve.a.normal,title:this.props.localizedStrings.RestoreInProgress}},u.createElement(y.a,{className:e.loadingSpinner,size:b.a.large,ariaLabel:this.props.localizedStrings.RestoreInProgress}));case $.CoauthRestoreFailedServer:return u.createElement(fe.a,{hidden:!1,isBlocking:!0,onDismiss:this.props.onDismiss,dialogContentProps:{type:ve.a.normal,title:this.props.localizedStrings.RestoreFailed,subText:this.props.localizedStrings.RestoreFailedSubtext}},u.createElement(ye.a,null,u.createElement(he,{text:this.props.localizedStrings.RestoreContinue,className:e.modalButton,primaryClassName:e.primaryModalButton,id:"VHRestorContinue",onClick:this.props.refreshCallback,isDisabled:!1,appColors:this.props.appColors})));case $.Hidden:default:return null}},t}(u.PureComponent),Ce=Object(g.b)((function(e){var t,r,o,n,i;return void 0===e&&(e="#B7472A"),{backArrow:Object(m.ab)({height:"16px",width:"16px",color:"#4A4A4A",fontFamily:"FabricMDL2Icons-0",fontSize:"16px",lineHeight:"16px",marginLeft:"19px",marginTop:"16px",cursor:"pointer"}),fullAppError:Object(m.ab)({display:"flex",flexFlow:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",backgroundColor:"#FFFFFF"}),fullAppErrorTop:Object(m.ab)({height:"24px",width:"284px",color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"18px",fontWeight:"300",lineHeight:"24px",textAlign:"center",marginTop:"38px"}),fullAppErrorSub:Object(m.ab)({height:"32px",width:"239px",color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",textAlign:"center",marginTop:"15px"}),fullAppErrorButtons:Object(m.ab)({display:"flex",flexFlow:"row",marginTop:"33px"}),vhHeader:Object(m.ab)({height:"48px",width:"100%",backgroundColor:"#F4F3F1",display:"flex"}),backToDoc:Object(m.ab)({height:"16px",width:"97px",color:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",marginLeft:"18px",marginTop:"16px",cursor:"pointer"}),backButton:Object(m.ab)({marginLeft:"9px"}),backButtonPrimaryColor:Object(m.ab)({backgroundColor:e,color:"#FFFFFF",marginLeft:"9px"}),backPrimaryButton:Object(m.ab)({marginLeft:"9px",selectors:(t={},t[m.k]={backgroundColor:"Window",color:"WindowText",border:"1px solid WindowText"},t[":hover"]={selectors:(r={},r[m.k]={backgroundColor:"Highlight",color:"HighlightText"},r)},t)}),tryAgainButton:Object(m.ab)({backgroundColor:e,color:"#FFFFFF"}),primaryTryAgainButton:Object(m.ab)({selectors:(o={},o[m.k]={backgroundColor:"Window",color:"WindowText",border:"1px solid WindowText"},o[":hover"]={selectors:(n={},n[m.k]={backgroundColor:"Highlight",color:"HighlightText"},n)},o)}),disabledPrimaryTryAgainButton:Object(m.ab)({selectors:(i={},i[m.k]={backgroundColor:"Window",color:"GrayText",border:"1px solid GrayText"},i)})}})),Se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.render=function(){var e=this.props.appSettings.fileExtension?this.props.appSettings.fileExtension:"",t=this.props.appSettings.appColor?this.props.appSettings.appColor:"#B7472A";return 104===this.props.fullAppError?this.renderVersioningDisabled(e,t):this.renderGenericError(e,t)},t.prototype.componentDidUpdate=function(){this.setFocusOnLoad()},t.prototype.componentDidMount=function(){this.setFocusOnLoad()},t.prototype.renderHeader=function(e){return u.createElement("div",{id:"vhHeader",className:e.vhHeader},u.createElement(J.a,{id:"backArrow",className:e.backArrow,iconName:"Back",onClick:this.props.onCloseSelectedAction}),u.createElement("div",{id:"backToDoc",className:e.backToDoc,onClick:this.props.onCloseSelectedAction},this.props.localizedStrings.ReturnToDoc))},t.prototype.renderErrorImage=function(e){return u.createElement("img",{src:"https://static2.sharepointonline.com/files/fabric/assets/brand-icons/document/svg/"+e+"_48x1_5.svg",role:"presentation",alt:"",width:"62",height:"55"})},t.prototype.renderVersioningDisabled=function(e,t){var r=Ce(t),o=this.props.localizedStrings.VersioningDisabledError,n=this.props.localizedStrings.VersioningDisabledDetails;return this._primaryButtonForFocus=new he({text:this.props.localizedStrings.BackLabel,className:r.backButtonPrimaryColor,primaryClassName:r.backPrimaryButton,id:"VHErrorBackButton",onClick:this.props.onCloseSelectedAction,isDisabled:!1,appColors:this.props.appColors,ariaDescribedBy:o}),u.createElement(u.Fragment,null,this.renderHeader(r),u.createElement("div",{className:r.fullAppError},this.renderErrorImage(e),u.createElement("div",{className:r.fullAppErrorTop}," ",o),u.createElement("div",{className:r.fullAppErrorSub},n),u.createElement("div",{className:r.fullAppErrorButtons},u.createElement(he,{text:this.props.localizedStrings.TryAgainLabel,className:"",primaryClassName:r.disabledPrimaryTryAgainButton,id:"VHTryAgainButton",onClick:this.props.getVersions,isDisabled:!0,appColors:this.props.appColors}),this._primaryButtonForFocus.render())))},t.prototype.renderGenericError=function(e,t){var r=Ce(t),o=this.props.localizedStrings.FullAppErrorTextTop,n=this.props.localizedStrings.FullAppErrorTextSub;return this._primaryButtonForFocus=new he({text:this.props.localizedStrings.TryAgainLabel,className:r.tryAgainButton,primaryClassName:r.primaryTryAgainButton,id:"VHTryAgainButton",onClick:this.props.getVersions,isDisabled:!1,appColors:this.props.appColors,ariaDescribedBy:o}),u.createElement(u.Fragment,null,this.renderHeader(r),u.createElement("div",{className:r.fullAppError},this.renderErrorImage(e),u.createElement("div",{className:r.fullAppErrorTop}," ",o),u.createElement("div",{className:r.fullAppErrorSub},n),u.createElement("div",{className:r.fullAppErrorButtons},this._primaryButtonForFocus.render(),u.createElement(de.a,{text:this.props.localizedStrings.BackLabel,id:"VHErrorBackButton",className:r.backButton,onClick:this.props.onCloseSelectedAction}))))},t.prototype.setFocusOnLoad=function(){this._primaryButtonForFocus&&this._primaryButtonForFocus.focus()},t}(u.PureComponent),_e=function(e){function t(t){var r=e.call(this,t)||this;return r._ftzone=u.createRef(),r._vhPane=u.createRef(),r._vhHeader=u.createRef(),r._dialogDescribedById=Object(h.a)(),r.renderVersionHistoryDialog=function(){var e=r.props.versions,t={localizedStrings:r.props.localizedStrings,selectedVersionId:r.props.selectedVersionId,selectedGroupName:r.props.selectedGroupName,totalChangesCount:r.props.totalChangesCount,currentChange:r.props.currentChange,onVersionSelectedAction:r.props.onVersionSelectedAction,onCloseSelectedAction:r.props.onCloseSelectedAction,onRestoreVersionAction:r.props.onRestoreVersionAction,paneLoading:r.props.paneLoading,viewerLoading:r.props.viewerLoading,viewerError:r.props.viewerError,fullAppError:r.props.fullAppError,appSettings:r.props.appSettings,appColors:r.props.appColors,modalErrorState:r.props.modalErrorState,refreshCallback:r.props.refreshCallback},n=f();return u.createElement(u.Fragment,null,r.props.fullAppError?u.createElement(u.Fragment,null,u.createElement("div",{className:n.fullAppErrorDiv},u.createElement(Se,o.__assign({versions:e},t,{getVersions:r.props.getVersions})))):u.createElement(u.Fragment,null,u.createElement(be,o.__assign({versions:e},t,{onDismiss:r._onDismiss})),u.createElement(ge,o.__assign({versions:e},t,{onSaveACopySelectedAction:r.props.onSaveACopySelectedAction,onRestoreVersionAction:r.props.onRestoreVersionAction,onIteratorSelectedAction:r.props.onIteratorSelectedAction,ref:r._vhHeader})),u.createElement(se,o.__assign({versions:e},t,{onShowVersionChangesToggledAction:r.props.onShowVersionChangesToggledAction,ref:r._vhPane}))))},r.focus=function(){return r._vhPane.current&&r._vhPane.current.focus()},r.focusHeader=function(){return r._vhHeader.current&&r._vhHeader.current.focus()},r._onDismiss=function(){t.setModalError($.Hidden)},r}return o.__extends(t,e),t.prototype.render=function(){var e=f(this.props.appSettings.isRtl),t=this.props.localizedStrings;return u.createElement(ne.a,{ref:this._ftzone,className:e.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!0,"aria-label":t.VersionHistoryTitle,"aria-describedby":this._dialogDescribedById,role:"group","aria-roledescription":t.VersionHistoryTitle},this.renderVersionHistoryDialog(),u.createElement("div",{id:this._dialogDescribedById,className:e.hidden,"aria-hidden":!0},t.VersionHistoryTitle))},t}(u.PureComponent),Ee=r(113),Ve=r(1119);function Te(e,t,r){return versionHistorySprite&&(Object(m.fb)({icons:Object(Ee.iconSpriteToReactMap)(versionHistorySprite)}),versionHistorySprite=void 0),Object(Ve.a)(),new Promise((function(i){n.render(u.createElement(we,o.__assign({ref:function(e){return i(e)}},t,r)),e)}))}var we=function(e){function t(t){var r=e.call(this,t)||this;return r._dialog=u.createRef(),r.selectedVersionId=null,r.onVersionSelectedAction=function(e){if(e.currentVersion&&e.currentVersion.RevisionID){if(i.c.sendTraceTag(595933192,i.a.msoulscat_Wac_VersionHistory,i.b.Info,r.getLoggableVersionInfoString("onVersionSelectedAction - Version selected in pane",e.currentVersion.RevisionID,r.state)),r.selectedVersionId=e.currentVersion.RevisionID?e.currentVersion.RevisionID:void 0,r.setState({selectedVersionId:e.currentVersion.RevisionID?e.currentVersion.RevisionID:void 0}),e.currentVersion.DownloadUrl)r.selectVersion(e);else{r.setViewerError(!1),r.setViewerLoading(!0);var t=[e.currentVersion.RevisionID];e.baseVersion&&e.baseVersion.RevisionID&&t.push(e.baseVersion.RevisionID),r.props.getDownloadToken(t,e)}if(e.currentVersion.DownloadUrl&&e.baseVersion&&e.baseVersion.RevisionID&&!e.baseVersion.DownloadUrl){t=[e.currentVersion.RevisionID,e.baseVersion.RevisionID];r.props.getDownloadToken(t,e)}}},r.onCloseSelectedAction=function(){r.props.onCloseSelectedAction()},r.onSaveACopySelectedAction=function(e){i.c.sendTraceTag(595903688,i.a.msoulscat_Wac_VersionHistory,i.b.Info,JSON.stringify({msg:"onSaveACopySelectedAction",url:e})),r.props.onSaveACopySelectedAction(e)},r.onRestoreVersionAction=function(e){i.c.sendTraceTag(595892446,i.a.msoulscat_Wac_VersionHistory,i.b.Info,r.getLoggableVersionInfoString("onRestoreVersionAction",e,r.state)),r.props.onRestoreVersionAction(e)},r.getAgeOfTime=function(e){return Date.now()-e.getTime()},r.getVersionInfoFromId=function(e,t){if(e){var r=Object(ae.e)(t.versions,(function(t){return t.RevisionID===e}));return r>=0?{version:t.versions[r],index:r}:void 0}},r.getLoggableVersionInfoString=function(e,t,o){var n=r.getVersionInfoFromId(t,o);if(n){var i=n.version,s=n.index,a=i.Time?r.getAgeOfTime(i.Time):"-1";return JSON.stringify({msg:e,revisionId:i.RevisionID,revisionAge:a,revisionIndex:s})}return""},r.state={versions:[],selectedVersionId:void 0,selectedGroupName:void 0,totalChangesCount:0,currentChange:0,paneLoading:!0,viewerLoading:!0,viewerError:!1,fullAppError:0,modalErrorState:$.Hidden,refreshCallback:function(){}},r.setModalError=r.setModalError.bind(r),r.setRefreshCallback=r.setRefreshCallback.bind(r),i.c.sendTraceTag(595933189,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"Pane constructed"),r}return o.__extends(t,e),t.prototype.insertVersions=function(e){i.c.sendTraceTag(595933190,i.a.msoulscat_Wac_VersionHistory,i.b.Info,JSON.stringify({msg:"insertVersions",count:e.length})),this.setState({versions:e})},t.prototype.selectSubSectionWithVersion=function(e){this._dialog&&this._dialog.current&&e&&this.setState({selectedGroupName:e.RevisionID?e.RevisionID:void 0})},t.prototype.setTotalChangesCount=function(e){this._dialog&&this._dialog.current&&this.setState({totalChangesCount:e})},t.prototype.setCurrentChangeCount=function(e){this._dialog&&this._dialog.current&&this.setState({currentChange:e})},t.prototype.setPaneLoading=function(e){this.setState({paneLoading:e})},t.prototype.setViewerLoading=function(e){this.setState({viewerLoading:e})},t.prototype.setViewerError=function(e){this.setState({viewerError:e})},t.prototype.setFullAppErrorCode=function(e){this.setState({fullAppError:e})},t.prototype.setModalError=function(e){this.setState({modalErrorState:e})},t.prototype.setRefreshCallback=function(e){this.setState({refreshCallback:e})},t.prototype.removeAllVersions=function(){i.c.sendTraceTag(595933191,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"removeAllVersions"),this.setState({versions:[]})},t.prototype.selectVersion=function(e){var t=this;e.currentVersion&&e.currentVersion.RevisionID&&(i.c.sendTraceTag(595907534,i.a.msoulscat_Wac_VersionHistory,i.b.Info,this.getLoggableVersionInfoString("selectVersion - Version selected in pane",e.currentVersion.RevisionID,this.state)),this.selectedVersionId=e.currentVersion.RevisionID?e.currentVersion.RevisionID:void 0,this.setState({selectedVersionId:this.selectedVersionId,selectedGroupName:e.groupName?e.groupName:void 0}),this.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete?this.setState({viewerLoading:!0,viewerError:!1},(function(){return t.props.onVersionSelectedAction(e)})):this.setState({viewerLoading:!1,viewerError:!1},(function(){return t.props.onVersionSelectedAction(e)})))},t.prototype.render=function(){return u.createElement(_e,o.__assign({ref:this._dialog,setModalError:this.setModalError,setRefreshCallback:this.setRefreshCallback},this.props,this.state,{onVersionSelectedAction:this.onVersionSelectedAction,onCloseSelectedAction:this.onCloseSelectedAction,onRestoreVersionAction:this.onRestoreVersionAction,getVersions:this.props.getVersions,appColors:this.props.appColors}))},t.prototype.enterFocusTrapZone=function(){this._dialog.current&&this._dialog.current.focus()},t.prototype.enterHeaderFocusTrapZone=function(){this._dialog.current&&this._dialog.current.focusHeader()},t}(u.PureComponent),Ie={shade20:"#002050",shade10:"#124078",primary:"#2b579a",tint10:"#3c65a4",tint20:"#4a78b0",tint30:"#7da3c6",tint40:"#a5b9d1",tint50:"#e3ecfa"},xe={shade20:"#740912",shade10:"#a92b1a",primary:"#b7472a",tint10:"#c75033",tint20:"#e86e58",tint30:"#ed9583",tint40:"#fdc9b5",tint50:"#fcf0ed"},De={shade20:"#004b1c",shade10:"#0e5c2f",primary:"#217346",tint10:"#3f8159",tint20:"#4e9668",tint30:"#6eb38a",tint40:"#9fcdb3",tint50:"#e9f5ee"},Ae=function(){function e(e,t,r,o,n,s,a,l){if(this._onVersionsReadyEvent=new d,this._onDownloadTokenReadyEvent=new d,this._fullAppErrorEvent=new d,this._onVersionSelectedEvent=new d,this._onTipVersionTokenReadyEvent=new d,this._onCloseSelectedEvent=new d,this._onSaveACopySelectedEvent=new d,this._onRestoreVersionSelectedEvent=new d,this._onIteratorSelectedEvent=new d,this._onAppRefreshTriggeredEvent=new d,this._onShowVersionChangesToggledEvent=new d,i.c.setLogger(t),this._perfTelemetryInfos=l,this._appSettings=a||{appColor:"#B7472A",appName:0,fileExtension:"",wdEnableDownloadTokens:!1,retryCount:3,wdEnableSaveACopy:!1,wdEnableRestore:!1,wdEnableIterator:!1,userSessionId:"",wacCluster:"",uiLocale:"en-us",isRtl:!1,useXhr:!1,viewerRootPositionRelative:!1,wdEnableIteratorBasedHeaderAlignment:!1,wdEnableHiddenButtonsUntilVersionLoadComplete:!1,wdEnableShowVersionChanges:!1,disableSaveACopy:!1,wdEnableCompareVersionsByGroup:!1},null==this._appSettings.appName||0===this._appSettings.appName){var c=this._appSettings.fileExtension;null!=c&&(c.toLowerCase().indexOf("pp")>=0?this._appSettings.appName=100:c.toLowerCase().indexOf("docx")>=0?this._appSettings.appName=110:c.toLowerCase().indexOf("xl")>=0&&(this._appSettings.appName=120))}V.UILocale=this._appSettings.uiLocale,this._versionHistoryStringsBag=e,this._versionHistoryCache=new p(this._onVersionsReadyEvent,this._onDownloadTokenReadyEvent,this._fullAppErrorEvent,this._onTipVersionTokenReadyEvent,r,o,this._appSettings,n,s,this._perfTelemetryInfos),this._onVersionsReadyEvent.addListener(this.onVersionsReady.bind(this)),this._onDownloadTokenReadyEvent.addListener(this.onDownloadTokenReady.bind(this)),this._fullAppErrorEvent.addListener(this.fullAppError.bind(this)),this._onTipVersionTokenReadyEvent.addListener(this.onTipVersionTokenReady.bind(this))}return e.prototype.createVersionHistoryDialog=function(e){var t=this;if(e){null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"CreateVersionHistoryDialogStart",TelemetryEventData:Date.now().toString()});var r={onVersionSelectedAction:this._onVersionSelectedEvent.fireEvent.bind(this._onVersionSelectedEvent),onCloseSelectedAction:this._onCloseSelectedEvent.fireEvent.bind(this._onCloseSelectedEvent),onSaveACopySelectedAction:this._onSaveACopySelectedEvent.fireEvent.bind(this._onSaveACopySelectedEvent),onRestoreVersionAction:this._onRestoreVersionSelectedEvent.fireEvent.bind(this._onRestoreVersionSelectedEvent),onIteratorSelectedAction:this._onIteratorSelectedEvent.fireEvent.bind(this._onIteratorSelectedEvent),onShowVersionChangesToggledAction:this._onShowVersionChangesToggledEvent.fireEvent.bind(this._onShowVersionChangesToggledEvent),getVersions:function(){return t.getVersions()},getDownloadToken:function(e,r){return t.getDownloadToken(e,r)}},o={localizedStrings:this._versionHistoryStringsBag,appSettings:this._appSettings};if(this._appSettings.appColor){var n=this._appSettings.appColor.toString().toLowerCase();n===Ie.primary.toString().toLowerCase()?o.appColors=Ie:n===xe.primary.toString().toLowerCase()?o.appColors=xe:n===De.primary.toString().toLowerCase()?o.appColors=De:i.c.sendTraceTag(595687505,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"invalid app colors used"+this._appSettings.appColor)}return Te(e,o,r).then((function(e){return t._versionHistoryDialog=e,t._versionHistoryDialog.insertVersions(t._versionHistoryCache.Versions),i.c.sendTraceTag(595933194,i.a.msoulscat_Wac_VersionHistory,i.b.Info,JSON.stringify({msg:"Pane initially populated",versionCount:t._versionHistoryCache.Versions.length})),null!=t._perfTelemetryInfos&&t._perfTelemetryInfos.push({TelemetryEventKey:"CreateVersionHistoryDialogEnd",TelemetryEventData:Date.now().toString()}),e}))}return Promise.reject(void 0)},e.prototype.getTipVersion=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return[4,this._versionHistoryCache.getTipVersion()];case 1:return e.sent(),[2]}}))}))},e.prototype.getVersions=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return this._versionHistoryDialog&&(this._versionHistoryDialog.setFullAppErrorCode(0),this._versionHistoryDialog.setPaneLoading(!0),this._versionHistoryDialog.setViewerLoading(!0)),[4,this._versionHistoryCache.getVersions()];case 1:return e.sent(),[2]}}))}))},e.prototype.setVersionLoadComplete=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){return this._versionHistoryDialog&&this._versionHistoryDialog.setViewerLoading(!1),[2]}))}))},e.prototype.setTotalChangesCount=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){return this._versionHistoryDialog&&(i.c.sendTraceTag(595658889,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"setTotalChangesCount with count:"+e.toString()),this._versionHistoryDialog.setTotalChangesCount(e)),[2]}))}))},e.prototype.setCurrentChangeCount=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){return this._versionHistoryDialog&&(i.c.sendTraceTag(595658890,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"setCurrentChangeCount with count:"+e.toString()),this._versionHistoryDialog.setCurrentChangeCount(e)),[2]}))}))},e.prototype.setFullAppError=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){return this._versionHistoryDialog&&this._versionHistoryDialog.setFullAppErrorCode(e?100:0),[2]}))}))},e.prototype.setFullAppErrorCode=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){return this._versionHistoryDialog&&this._versionHistoryDialog.setFullAppErrorCode(e),[2]}))}))},e.prototype.setViewerError=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){return this._versionHistoryDialog&&this._versionHistoryDialog.setViewerError(e),[2]}))}))},e.prototype.setCoauthRestoreError=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){return this._versionHistoryDialog&&this._versionHistoryDialog.setModalError($.CoauthRestoreDisplayed),[2]}))}))},e.prototype.setRestoreFailedAtServer=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){return this._versionHistoryDialog&&e&&(this._versionHistoryDialog.setModalError($.CoauthRestoreFailedServer),this._versionHistoryDialog.setRefreshCallback(e)),[2]}))}))},e.prototype.setRestoreInProgress=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){return this._versionHistoryDialog&&this._versionHistoryDialog.setModalError($.CoauthRestoreInProgress),[2]}))}))},e.prototype.setDisableSaveACopy=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){return this._appSettings&&(this._appSettings.disableSaveACopy=e),[2]}))}))},e.prototype.getDownloadToken=function(e,t){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(r){switch(r.label){case 0:return this._versionHistoryDialog?(this._versionHistoryDialog.setFullAppErrorCode(0),[4,this._versionHistoryCache.getDownloadToken(e,t)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},e.prototype.getVersionSelectedEvent=function(){return this._onVersionSelectedEvent},e.prototype.getCloseSelectedEvent=function(){return this._onCloseSelectedEvent},e.prototype.getSaveACopySelectedEvent=function(){return this._onSaveACopySelectedEvent},e.prototype.getRestoreVersionSelectedEvent=function(){return this._onRestoreVersionSelectedEvent},e.prototype.getIteratorSelectedEvent=function(){return this._onIteratorSelectedEvent},e.prototype.getVersionsReadyEvent=function(){return this._onVersionsReadyEvent},e.prototype.getAppRefreshTriggeredEvent=function(){return this._onAppRefreshTriggeredEvent},e.prototype.getDownloadTokenReadyEvent=function(){return this._onDownloadTokenReadyEvent},e.prototype.getTipVersionTokenReadyEvent=function(){return this._onTipVersionTokenReadyEvent},e.prototype.getFullAppErrorEvent=function(){return this._fullAppErrorEvent},e.prototype.getShowVersionChangesToggledEvent=function(){return this._onShowVersionChangesToggledEvent},e.prototype.onVersionsReady=function(e){var t=this;n.unstable_batchedUpdates((function(){if(t._versionHistoryDialog&&e&&e.versions&&(t._versionHistoryDialog.setPaneLoading(!1),t._versionHistoryDialog.insertVersions(e.versions.filter((function(e){return e}))),e.versions[0])){if(t._appSettings.wdEnableCompareVersionsByGroup)return void t._versionHistoryDialog.selectSubSectionWithVersion(e.versions[0]);var r=[];e.versions[0].DownloadUrl?(t._versionHistoryDialog.selectVersion({currentVersion:e.versions[0],baseVersion:e.versions[1]?e.versions[1]:null,correlationID:e.correlationID}),t._appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete||t._versionHistoryDialog.setViewerLoading(!1)):t._versionHistoryDialog.selectedVersionId=e.versions[0].RevisionID,(!e.versions[0].DownloadUrl||t._versionHistoryCache._tipVersionResponse&&t._versionHistoryCache._tipVersionResponse.data&&e.versions[0].DownloadUrl===t._versionHistoryCache._tipVersionResponse.data.DownloadUrl)&&r.push(e.versions[0].RevisionID),e.versions[1]&&!e.versions[1].DownloadUrl&&r.push(e.versions[1].RevisionID),r.length>0&&t._versionHistoryCache.getDownloadToken(r,{currentVersion:e.versions[0],baseVersion:e.versions[1]?e.versions[1]:null})}}))},e.prototype.onDownloadTokenReady=function(e){var t=this;n.unstable_batchedUpdates((function(){if(t._versionHistoryDialog&&e&&e.updatedVersions){var r=e.updatedVersions.filter((function(e){return e}));t._versionHistoryDialog.insertVersions(r),!e.versionSelected||!e.versionSelected.currentVersion||t._versionHistoryDialog.selectedVersionId&&t._versionHistoryDialog.selectedVersionId!==e.versionSelected.currentVersion.RevisionID||(t._versionHistoryDialog.selectVersion(e.versionSelected),t._appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete||t._versionHistoryDialog.setViewerLoading(!1))}}))},e.prototype.onTipVersionTokenReady=function(e){var t=this;n.unstable_batchedUpdates((function(){if(t._versionHistoryDialog&&e&&e.tipVersion&&e.tipVersion.DownloadUrl&&e.updatedVersions&&e.updatedVersions[0]&&e.tipVersion.DownloadUrl===e.updatedVersions[0].DownloadUrl){var r=e.updatedVersions.filter((function(e){return e}));t._versionHistoryDialog.insertVersions(r),t._versionHistoryDialog.selectedVersionId&&t._versionHistoryDialog.selectedVersionId!==e.updatedVersions[0].RevisionID||(t._versionHistoryDialog.selectVersion({currentVersion:e.updatedVersions[0]}),t._appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete||t._versionHistoryDialog.setViewerLoading(!1))}}))},e.prototype.fullAppError=function(e){var t=this;n.unstable_batchedUpdates((function(){t._versionHistoryDialog&&(t._versionHistoryDialog.setViewerLoading(!1),t._versionHistoryDialog.setPaneLoading(!1),t._versionHistoryDialog.setViewerError(!1),t._versionHistoryDialog.setFullAppErrorCode(e))}))},e}(),ke=function(){function e(){}return e.createVersionHistoryController=function(e,t,r,n,i,s,a){var l=o.__assign({},OfficeVersionHistoryStrings,FriendlyDatesStrings,{oneUserAuthorList:"Edited by {0}.",twoUserAuthorList:"Edited by {0} and {1}.",threeUserAuthorList:"Edited by {0}, {1}, and {2}.",fourUserAuthorList:"Edited by {0}, {1}, {2}, and {3}.",fivePlusUserAuthorList:"Edited by {0}, {1}, {2} and {3} others.",currentVersion:"Current Version",userAction:"edited",userActionComboString:"{0} {1}",yesterdayWithTime:"Yesterday, {0}",dateTimeComboNoAt:"{0} {1}"});return new Ae(l,e,t,r,n,i,s,a)},e}(),He=new(function(){function e(){}return e.prototype.getVersionHistoryControllerInstance=function(e){if(e&&e.docId&&e.ulsLogger)return ke.createVersionHistoryController(e.ulsLogger,null===e.serviceBase||void 0===e.serviceBase?"":e.serviceBase,e.docId,null===e.latestStreamServiceBase||void 0===e.latestStreamServiceBase?"":e.latestStreamServiceBase,void 0,e.appSettings,e.perfTelemetryInfos)},e}());r.d(t,"FactoryGlobal",(function(){return He}))}});
//# sourceMappingURL=versionHistory.min.js.map