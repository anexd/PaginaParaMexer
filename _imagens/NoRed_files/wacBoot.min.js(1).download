var wacBoot=function(e){function t(t){for(var n,s,l=t[0],r=t[1],d=t[2],u=0,p=[];u<l.length;u++)s=l[u],a[s]&&p.push(a[s][0]),a[s]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);for(c&&c(t);p.length;)p.shift()();return o.push.apply(o,d||[]),i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],n=!0,l=1;l<i.length;l++){var r=i[l];0!==a[r]&&(n=!1)}n&&(o.splice(t--,1),e=s(s.s=i[0]))}return e}var n={},a={10:0},o=[];function s(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=n,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var l=window.webpackJsonp_name_=window.webpackJsonp_name_||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var c=r;return o.push([295,0]),i()}({295:function(e,t,i){"use strict";i.r(t);var n,a={g_initialRequestMade:!1,g_initialRequestCompleted:!1,g_getCellsFromFrameRequest:void 0,g_initialRequestResponseObject:void 0,g_acquireLockStartTime:void 0,g_acquireLockEndTime:void 0,g_getDocumentStartTime:void 0,g_getDocumentEndTime:void 0,g_getCellsStartTime:void 0,g_getCellsEndTime:void 0,g_getInitializeLocalCobaltStartTime:void 0,g_getInitializeLocalCobaltEndTime:void 0,g_initialResponseTime:void 0,g_initialResponseReadyTime:void 0,g_fastViewOpenTime:void 0,g_initialRequestInvokedTime:void 0,g_onInitialResponseReady:void 0,g_isUserCreatingPersonalNotebookFirstTime:!1,g_networkType:void 0,g_bootSSRData:void 0,g_bootSSRHtmlStringLength:void 0},o={fastView:void 0,initialParaId:0,fastBootError:void 0},s=function(){function e(){}return e.ensureCookieCompliance=function(e,t){if(e){var i=[];t&&(i=JSON.parse(t)),WacCookieCompliance.requestConsentWithSettings(new CookieComplianceSettings(i))}},e.getCookie=function(e){if(!e)return"";if(e.indexOf("=")>=0)throw new RangeError(" = is not found in the cookie");var t=""+document.cookie,i=new RegExp("(?:^|; )"+e+"=([^;]*)"),n=t.match(i);return!n||n.length<2?"":n[1]},e.isDocumentEmpty=function(e){function t(e,t){return-1===(" "+e.className+" ").indexOf(" "+t+" ")}var i=e.querySelectorAll(".Paragraph");return!(!i||1!==i.length)&&(2===i[0].childElementCount&&!t(i[0].children[0],"TextRun")&&!t(i[0].children[1],"EOP")&&""===i[0].children[0].innerText)},e}(),l=function(){function e(){}return e.getElement=function(e){if(this.DOMElements.hasOwnProperty(e))return this.DOMElements[e];var t=document.getElementById(e);return t?this.DOMElements[e]=t:null},e.removeElement=function(e){e&&this.DOMElements.hasOwnProperty(e.id)&&delete this.DOMElements[e.id],e&&e.parentNode&&e.parentNode.removeChild(e)},e.removeElementById=function(e){this.removeElement(this.getElement(e))},e.DOMElements={},e}(),r=function(){function e(){}return e.initialize=function(e,t,i,n,a,o,l,r,d,c){this.isViewMode=e,this.isEmbedMode=t,this.isTeamsSession=i,this.isInTouchMode="ontouchstart"in window,this.isSimplifiedReactRibbonInTreatment=n,this.isOldRibbonCollapsedCookieOn="false"!==s.getCookie(a).toLowerCase(),this.isSimplifiedRibbonCookieOn="false"!==s.getCookie(o).toLowerCase(),this.isNewHeaderShown=!this.isViewMode,this.isSimplifiedReactRibbonShown=this.isSimplifiedReactRibbonInTreatment&&this.isSimplifiedRibbonCookieOn&&!this.isViewMode,this.isOldRibbonExpandedAndShown=!this.isSimplifiedReactRibbonShown&&!this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isOldRibbonCollapsedAndShown=!this.isSimplifiedReactRibbonShown&&this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isViewModeAndRibbonPanelSmall=this.isViewMode&&this.isOldRibbonCollapsedCookieOn&&!this.isSimplifiedReactRibbonInTreatment,this.isViewModeAndRibbonPanelLarge=this.isViewMode&&(!this.isOldRibbonCollapsedCookieOn||this.isSimplifiedReactRibbonInTreatment),this.isSnackbarNavPaneEnabled=l,this.isTwoPaneNavEnabled=r,this.isCssPositionRewriteEnabled=d,this.hideSkeletalHeader=c},e}();!function(e){e[e.HideAnimationTime=256]="HideAnimationTime",e[e.MinWidthToShowPageColumnPane=900]="MinWidthToShowPageColumnPane",e[e.MinWidthToShowNavpane=499]="MinWidthToShowNavpane",e[e.MinWidthToResizeTwoPaneNav=425]="MinWidthToResizeTwoPaneNav",e[e.MinWidthForTwoPaneNav=300]="MinWidthForTwoPaneNav"}(n||(n={}));var d=function(){function e(){}return e.clearAriaLoadingAttributes=function(){var e=document.getElementById("applicationOuterContainer");e&&(e.removeAttribute("aria-busy"),e.removeAttribute("aria-hidden"))},e.getFastViewSkeletalClass=function(){return r.isCssPositionRewriteEnabled?this.getPositionRewriteFastViewSkeletalClass():this.getAbsoluteFastViewSkeletalClass()},e.getPositionRewriteFastViewSkeletalClass=function(){return this.getAbsoluteFastViewSkeletalClass()},e.getAbsoluteFastViewSkeletalClass=function(){var e="";return this.isRtlMode()?e="SkeletalFastViewRtl":(e="SkeletalFastView",r.isTwoPaneNavEnabled&&!r.isEmbedMode?e="SkeletalFastView":r.isEmbedMode||this._clientWidth<=n.MinWidthToShowNavpane?e="SkeletalFastViewNoNavpane":this._clientWidth<=n.MinWidthToShowPageColumnPane&&(e="SkeletalFastViewPageColumnNavpane")),r.isViewModeAndRibbonPanelLarge&&(e+=" SkeletalFastViewViewMode"),r.isEmbedMode&&(e+=" SkeletalFastViewEmbedMode"),e},e.collapseSkeletalRibbon=function(){r.isCssPositionRewriteEnabled?this.collapsePositionRewriteSkeletalRibbon():this.collapseAbsoluteSkeletalRibbon()},e.collapsePositionRewriteSkeletalRibbon=function(){this.collapseAbsoluteSkeletalRibbon()},e.collapseAbsoluteSkeletalRibbon=function(){var e=l.getElement("SkeletalMainContent");e&&!r.isCssPositionRewriteEnabled&&(e.className+=r.isEmbedMode?" collapsedRibbonEmbedMode":" collapsedRibbon"),l.removeElementById("SkeletalRibbonExtension")},e.updateRibbonPanel=function(){r.isCssPositionRewriteEnabled&&r.isSimplifiedRibbonCookieOn?this.updatePositionRewriteRibbonPanel():this.updateAbsoluteRibbonPanel()},e.updatePositionRewriteRibbonPanel=function(){if(!this._ribbonPanelUpdated)if(r.isViewMode)this._ribbonPanelUpdated=!0;else{document.getElementById("WACRibbonPanel")&&(this._ribbonPanelUpdated=!0);var e=document.getElementsByClassName("WACReadingBarPanel").item(0);e&&(e.style.display="none")}},e.updateAbsoluteRibbonPanel=function(){if(!this._ribbonPanelUpdated){var e=document.getElementsByClassName("WACReadingBarPanel").item(0);if(r.isViewMode&&e)this._ribbonPanelUpdated=!0,r.isViewModeAndRibbonPanelLarge?e.className+=" RibbonPanelMaximizedViewMode":r.isViewModeAndRibbonPanelSmall&&(e.className+=" RibbonPanelMinimized");else{var t=document.getElementById("WACRibbonPanel");null!=t&&(this._ribbonPanelUpdated=!0,r.isSimplifiedReactRibbonShown?(t.className+=" RibbonPanelSLRMode",t.className+=" RibbonPanelNewSLRMode"):r.isOldRibbonExpandedAndShown&&!r.isInTouchMode?t.className+=" RibbonPanelMaximized":r.isOldRibbonExpandedAndShown&&r.isInTouchMode?t.className+=" RibbonPanelMaximizedTouchMode":r.isOldRibbonCollapsedAndShown&&(t.className+=" RibbonPanelMinimized")),e&&(e.style.display="none")}}},e.updateWacDocumentPanel=function(){r.isCssPositionRewriteEnabled&&r.isSimplifiedRibbonCookieOn?this.updatePositionRewriteWacDocumentPanel():this.updateAbsoluteWacDocumentPanel()},e.updatePositionRewriteWacDocumentPanel=function(){var e=document.getElementById("WACDocumentPanelContent");null!=e&&(e.style.border="unset")},e.updateAbsoluteWacDocumentPanel=function(){var e=document.getElementById("WACDocumentPanel"),t=document.getElementById("WACDocumentPanelContent");null!=e&&(e.className+=" skeletalEnabled",r.isViewModeAndRibbonPanelLarge?e.style.top="40px":r.isViewModeAndRibbonPanelSmall?e.style.top="30px":r.isSimplifiedReactRibbonShown?e.style.top="77px":r.isOldRibbonCollapsedCookieOn||r.isInTouchMode||(e.style.top="124px"),this.isRtlMode()?e.style.right="0px":r.isTwoPaneNavEnabled&&!r.isEmbedMode?this._clientWidth<n.MinWidthForTwoPaneNav?e.style.left=n.MinWidthToShowNavpane.toFixed()+"px":this._clientWidth<n.MinWidthToResizeTwoPaneNav?e.style.left=this._clientWidth.toFixed()+"px":e.style.left="426px":r.isEmbedMode||this._clientWidth<=n.MinWidthToShowNavpane?e.style.left="0px":this._clientWidth<=n.MinWidthToShowPageColumnPane?e.style.left="198px":r.isSnackbarNavPaneEnabled?e.style.left="426px":e.style.left="393px"),null!=t&&(t.style.border="unset")},e.customizeSkeletalExperience=function(){this._clientWidth=document.body.clientWidth,r.isSimplifiedReactRibbonShown?l.removeElementById("SkeletalAdditionOldRibbon"):l.removeElementById("SkeletalNewRibbon"),r.isEmbedMode&&!r.isTeamsSession?(l.removeElementById("SkeletalHeader"),l.removeElementById("SkeletalNewHeader")):r.isNewHeaderShown?l.removeElementById("SkeletalHeader"):l.removeElementById("SkeletalNewHeader"),this.customizeSkeletalExperienceLayout()},e.customizeSkeletalExperienceLayout=function(){var t=l.getElement("SkeletalMainContent"),i=l.getElement("SkeletalExperience"),a=l.getElement("SkeletalRibbon");if(r.hideSkeletalHeader&&i&&(i.className+=" noHeader"),r.isViewMode?(i&&r.isCssPositionRewriteEnabled&&i.classList.remove("skeletalSLRGridRows"),a&&(a.innerHTML=""),r.isViewModeAndRibbonPanelSmall?(t&&!r.isCssPositionRewriteEnabled&&(t.style.top=r.isEmbedMode?"30px":"78px"),i&&r.isCssPositionRewriteEnabled&&(i.className+=" skeletalLegacyRibbonGridRows"),a&&!r.isCssPositionRewriteEnabled&&(a.className="skeletalRibbon skeletalRibbonCollapsedViewMode")):r.isViewModeAndRibbonPanelLarge?(a&&!r.isCssPositionRewriteEnabled&&(a.className="skeletalRibbon skeletalRibbonExpandedViewMode"),r.isCssPositionRewriteEnabled&&i?i.className+=" skeletalReadingRibbonGridRows":!r.isCssPositionRewriteEnabled&&t&&(t.style.top=r.isEmbedMode?"40px":"88px")):i&&r.isCssPositionRewriteEnabled&&(i.className+=" skeletalReadingRibbonGridRows")):i&&!r.isSimplifiedReactRibbonShown&&r.isCssPositionRewriteEnabled&&(r.isOldRibbonExpandedAndShown&&!r.isInTouchMode?i.className+=" skeletalLegacyRibbonMaximizedGridRows":r.isOldRibbonExpandedAndShown&&r.isInTouchMode?i.className+=" skeletalLegacyRibbonMaximizedTouchModeGridRows":r.isOldRibbonCollapsedAndShown&&(i.className+=" skeletalLegacyRibbonGridRows")),r.isSimplifiedReactRibbonShown?a&&(a.className=r.isCssPositionRewriteEnabled?"skeletalPositionRewriteRibbon":"skeletalSLRNewVisual"):a&&r.isCssPositionRewriteEnabled&&(a.className="skeletalPositionRewriteRibbon",r.isViewMode&&(a.className+=" viewMode")),r.isEmbedMode){a&&(r.isCssPositionRewriteEnabled||(a.style.top="0px"));var o=l.getElement("SkeletalAdditionOldRibbon");o&&!r.isCssPositionRewriteEnabled&&(o.style.top="0px")}if(this.isRtlMode()&&this.loadSkeletalInRTL(),r.isOldRibbonCollapsedAndShown?e.collapseSkeletalRibbon():r.isOldRibbonExpandedAndShown&&r.isEmbedMode&&t&&!r.isCssPositionRewriteEnabled&&(t.style.top="125px"),r.isTwoPaneNavEnabled&&!r.isEmbedMode){var s=l.getElement("SkeletalNavpane"),d=l.getElement("SkeletalNavpaneSectionColumn"),c=l.getElement("SkeletalNavpanePageColumn"),u=l.getElement("SkeletalCanvas"),p=l.getElement("SkeletalExperience");if(null!=s&&null!=d&&null!=c&&null!=u&&null!=p)if(this._clientWidth<=n.MinWidthForTwoPaneNav)r.isCssPositionRewriteEnabled?p.className+=" skeletalOreoTwopaneShrunkGridColumns":(s.style.width="300px",u.style.left="299px"),d.style.width="124px",c.style.width="124px";else if(this._clientWidth<=n.MinWidthToResizeTwoPaneNav){r.isCssPositionRewriteEnabled?p.style.gridTemplateColumns=this._clientWidth.toFixed()+"px 100%":(s.style.width=this._clientWidth.toFixed()+"px",u.style.left=this._clientWidth-1+"px");var b=.5*this._clientWidth-24;d.style.width=b.toFixed()+"px",c.style.width=b.toFixed()+"px"}}else if(r.isEmbedMode||this._clientWidth<=n.MinWidthToShowNavpane){l.removeElementById("SkeletalNavpane");u=l.getElement("SkeletalCanvas");var h=l.getElement("SkeletalExperience");r.isCssPositionRewriteEnabled&&h?r.isTwoPaneNavEnabled?h.className+=" skeletalNoTwopaneGridColumns":h.className+=" skeletalNoNavpaneGridColumns":!r.isCssPositionRewriteEnabled&&u&&(u.style.left="0px")}else if(this._clientWidth<=n.MinWidthToShowPageColumnPane){s=l.getElement("SkeletalNavpane");var m=l.getElement("SkeletalNotebookName"),R=(u=l.getElement("SkeletalCanvas"),l.getElement("SkeletalExperience"));l.removeElementById("SkeletalNavpaneSectionColumn"),l.removeElementById("skeletalNavpaneTab"),r.isCssPositionRewriteEnabled&&R?R.className+=" skeletalLegacyNavpanePageOnlyGridColumns":r.isCssPositionRewriteEnabled&&null!=s&&null!=u&&(s.style.width="201px",u.style.left="200px"),m&&(m.style.right="42px")}if(r.isSimplifiedReactRibbonShown&&null!=t)r.isCssPositionRewriteEnabled||(t.style.paddingTop=r.isEmbedMode?"74px":"126px",t.style.top="0px");else if(r.isOldRibbonCollapsedAndShown){var f=document.getElementsByClassName("skeletalRibbonBoxContainer").item(0),g=l.getElement("SkeletalRibbonBar");null!=t&&null!=g&&null!=f&&(l.removeElement(f),g.style.height="29px",g.style.borderBottom="1px solid #d2d2d2",r.isCssPositionRewriteEnabled||(t.style.top="0px"))}else if(r.isOldRibbonExpandedAndShown&&r.isInTouchMode){var S=l.getElement("SkeletalRibbonExtension");null==t||null==S||r.isCssPositionRewriteEnabled||(S.style.height="108px",t.style.top="187px")}},e.isRtlMode=function(){var e=l.getElement("SkeletalExperience");return null!=e&&"rtl"===e.getAttribute("direction")},e.loadSkeletalInRTL=function(){var e=["SkeletalHeader","SkeletalNewHeader","SkeletalRibbonAppTitle","SkeletalSLRAppTitle","SkeletalRibbon","SkeletalAdditionOldRibbon","SkeletalMainContent","SkeletalCanvas"];for(var t in e){var i=l.getElement(e[t]);i&&(i.className+=" skeletalRTL")}var n=l.getElement("SkeletalCanvas");n&&(n.className+=" skeletalCanvasRtl")},e.bringFastViewToForegroundOfSkeletalCanvas=function(){var e=l.getElement("WACFastView");e&&(e.style.position="initial")},e.removeAllSubunitsFromSkeletalCanvas=function(){var e=l.getElement("SkeletalCanvas");if(e)for(var t=e.children.length-1;t>=0;t-=1){var i=e.children.item(t);i&&"WACFastView"!==i.id&&e.removeChild(i)}},e.fadeOutAndRemoveElement=function(e,t){var i=l.getElement(e);i&&(i.style.background="transparent",i.style.opacity="0",i.className+=" skeletalCover",window.setTimeout((function(){l.removeElement(i),t&&t()}),n.HideAnimationTime))},e.setMainContentEditable=function(){if(!this._isMainContentEditable){this._isMainContentEditable=!0,this.fadeOutAndRemoveElement("SkeletalNavpane"),this.fadeOutAndRemoveElement("SkeletalMainContent");var e=document.getElementById("load_back");e&&(e.style.height="auto")}},e._clientWidth=0,e._isMainContentEditable=!1,e._ribbonPanelUpdated=!1,e}(),c=function(){function e(){}return e.launchExperience=function(e){var t=this;r.initialize("false"===e.IsEditMode,"true"===e.IsEmbedMode,"true"===e.IsTeamsSession,"true"===e.SimplifiedReactRibbonUxIsEnabled,e.RibbonPreferenceCookieNameHint,e.IsSimplifiedRibbonOnCookieName,"true"===e.SnackbarNavPaneIsEnabled,"true"===e.OneNoteTwoPaneNavPaneIsEnabled,"true"===e.OneNoteCssPositionRewriteIsEnabled,"true"===e.HideHeaderEmbedded),d.customizeSkeletalExperience(),this.showSkeletalUx(),window.setTimeout((function(){return t.dismissSkeletalBootUx}),this.DISMISS_AFTER)},e.showSkeletalUx=function(){var e=l.getElement("SkeletalExperience");e&&(e.style.opacity="1",e.className+=" skeletalShow")},e.setRibbonReady=function(){this._isExperienceEnded||(this._isRibbonReady=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this._isContentReady&&d.fadeOutAndRemoveElement("SkeletalRibbon"))},e.setPageReady=function(){this._isExperienceEnded||(d.updateRibbonPanel(),d.updateWacDocumentPanel(),this._isContentReady=!0,this.tryDismissSkeletalBootUxIfAllComponentsReady()||this.dismissSkeletalCanvas())},e.setNavpaneReady=function(){this._isExperienceEnded||(d.updateRibbonPanel(),this._isNavpaneReady=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this._isContentReady&&d.fadeOutAndRemoveElement("SkeletalNavpane",(function(){d.setMainContentEditable()})))},e.setFastViewReady=function(){this._isExperienceEnded||this.dismissSkeletalCanvas()},e.showFastViewOnSkeletalCanvas=function(){d.bringFastViewToForegroundOfSkeletalCanvas(),d.removeAllSubunitsFromSkeletalCanvas()},e.tryDismissSkeletalBootUxIfAllComponentsReady=function(){return!!(this._isContentReady&&this._isNavpaneReady&&this._isRibbonReady)&&this.dismissSkeletalBootUx()},e.dismissSkeletalBootUx=function(){if(this._isExperienceEnded)return!1;var t=l.getElement("SkeletalExperience"),i=document.getElementById("load_back"),n=document.getElementById("WACDocumentPanel"),a=document.getElementById("WACRibbonPanel");return t&&i&&n&&a?(this.adjustWacRibbonAfterDismissSkeletal(a),this.adjustWacCanvasAfterDismissSkeletal(n),l.removeElement(t),e.endExperience(i),!0):(e.endExperience(i),!1)},e.adjustWacRibbonAfterDismissSkeletal=function(e){r.isCssPositionRewriteEnabled?this.adjustPositionRewriteWacRibbonAfterDismissSkeletal(e):this.adjustAbsoluteWacRibbonAfterDismissSkeletal(e)},e.adjustPositionRewriteWacRibbonAfterDismissSkeletal=function(e){e.style.height="auto"},e.adjustAbsoluteWacRibbonAfterDismissSkeletal=function(e){r.isSimplifiedReactRibbonShown?e.style.height="77px":e.style.height="auto"},e.adjustWacCanvasAfterDismissSkeletal=function(e){r.isCssPositionRewriteEnabled&&r.isSimplifiedReactRibbonShown||this.adjustAbsoluteWacCanvasAfterDismissSkeletal(e)},e.adjustAbsoluteWacCanvasAfterDismissSkeletal=function(e){e.className="SkeletalWacDocumentPanel skeletalEnabled "+e.className},e.dismissSkeletalCanvas=function(){var e=this,t=document.getElementById("WACFastView");if(!this._isExperienceEnded||t&&t.parentElement&&"SkeletalCanvas"===t.parentElement.id){this._isContentReady=!0;var i=document.getElementById("load_back");null!=i&&(this.preDismissSkeletalCanvas(i),d.fadeOutAndRemoveElement("SkeletalCanvas",(function(){e._isNavpaneReady&&d.setMainContentEditable()})))}},e.preDismissSkeletalCanvas=function(e){r.isCssPositionRewriteEnabled?this.preDismissPositionRewriteSkeletalCanvas(e):this.preDismissAbsoluteSkeletalCanvas(e)},e.preDismissPositionRewriteSkeletalCanvas=function(e){this.preDismissAbsoluteSkeletalCanvas(e)},e.preDismissAbsoluteSkeletalCanvas=function(e){var t=document.getElementById("WACRibbonPlaceholder"),i=l.getElement("SkeletalRibbonExtension");if(null!=t&&null!=i&&(t.style.height="124px"),e.style.background="transparent",d.isRtlMode()){var n=document.getElementById("application");n&&(n.style.minWidth="0px")}if(!r.isEmbedMode){var a=document.getElementById("AppHeaderPanel");a&&(a.style.height="48px")}},e.endExperience=function(e){e&&(this._isExperienceEnded=!0,e.style.display="none",e.style.height="1px",e.style.opacity="0",e.setAttribute("aria-hidden","true"),d.clearAriaLoadingAttributes())},e._isRibbonReady=!1,e._isContentReady=!1,e._isNavpaneReady=!1,e._isExperienceEnded=!1,e.DISMISS_AFTER=13e3,e}(),u=function(){function e(){}return e.browserSupportsPerformanceMarkAndMeasure=function(){return!!(window&&window.performance&&window.performance.mark&&window.performance.measure)},e.addMark=function(t){e.browserSupportsPerformanceMarkAndMeasure()&&window.performance.mark(t)},e.measureMarks=function(t,i,n){if(e.browserSupportsPerformanceMarkAndMeasure())try{window.performance.measure(t,i,n)}catch(e){}},e.measureNetworkType=function(){if(window&&window.navigator){var e=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection;if(e)return e.effectiveType}},e.getEntry=function(t,i){if(e.browserSupportsPerformanceMarkAndMeasure())try{var n=window.performance.getEntriesByName(t,i);if(n.length>0)return n[0]}catch(e){}},e.sendBeacon=function(e,t){window._bB&&window._bB.sendBeacon(e,t)},e}(),p=function(){this.positionAbsolute=!1,this.showRibbon=!1,this.showRibbonHeader=!0,this.showRibbonImage=!1,this.showNavPane=!1,this.showNavSections=!0,this.ribbonExpandedByDefault=!1,this.ribbonPreferenceCookieName="",this.ribbonImageBase="",this.appBrandedName="",this.shouldStretchPageToBottom=!1,this.editable=!1,this.pasteLoadingUI=!1,this.loadingUIGif="",this.simplifiedReactRibbonUxIsEnabled=!1,this.simplifiedReactRibbonAnimationIsEnabled=!1,this.skeletalBootUXIsEnabled=!1,this.snackbarNavPaneIsEnabled=!1,this.twoPaneNavIsEnabled=!1,this.reactSharedHeaderIsEnabled=!1,this.headerAppLauncherIsHidden=!1,this.headerBackgroundColorOverride="",this.headerTextColorOverride="",this.cssPositionRewriteIsEnabled=!1,this.wordIsSkeletalDeepLinkOn=!1,this.isDeepLinkScenario=!1,this.reactMultiLineRibbonIsVisible=!1,this.renderFastViewOnSkeletalUXIsEnabled=!1,this.isRegionComposerShown=!1},b=function(e,t){this.eventName=e,this.timeStamp=(new Date).getTime()-t},h=function(){function e(e,t,i,n,a,o,l){void 0===a&&(a="Default"),void 0===o&&(o=s.getCookie),void 0===l&&(l=!1),this.getTopbarContainerFunc=e,this.getRibbonContainerFunc=t,this.getDocumentContainerFunc=i,this.appearance=n,this.entry=a,this.getCookieFunc=o,this.fastViewOnSkeletal=l,this.touchSupport=this.isTouchSupport(),this.eventLogs=[],this.openTime=0}return e.prototype.handleKeyboardEvent=function(e){"Shift"!==e.key&&"Control"!==e.key&&"Alt"!==e.key&&this.logEventData(e.type)},e.prototype.handleEditableKeyboardEvent=function(e){(13===e.keyCode||e.ctrlKey&&(66===e.keyCode||73===e.keyCode||85===e.keyCode))&&(e.preventDefault(),this.logEventData(e.key))},e.prototype.handlePasteEvent=function(e){if(void 0!==this.isEditable&&void 0!==this.htmlElement&&void 0!==this.editableSpan&&this.isEditable&&this.appearance.pasteLoadingUI&&!this.isPasteLoading&&this.htmlElement.parentElement){this.isPasteLoading=!0;var t=function(e){var t=document.createElement("div");t.id="WACLoadingPasteUI";var i=document.createElement("div");i.className="WACFastLoadingBoxUI";var n,a=document.createElement("img");return a.src=e,a.className="WACProgressIcon",i.appendChild(a),t.appendChild(i),t.appendChild(((n=document.createElement("div")).className="WACFastLoadingOverlay WACDialogOverlay",n)),t.setAttribute("aria-busy","true"),t.setAttribute("role","progressbar"),t}(this.appearance.loadingUIGif);this.htmlElement.parentElement.appendChild(t),this.pasteData=function(e){var t={};if(null!=e&&null!=e.types){var i=e.types[0];t.type=i,t.data=e.getData(i)}else{var n=window.clipboardData,a=n.getData("text");null!==a?(t.type="text/plain",t.data=a):n.files.length>0&&(t.type="image/png",t.data=n.files[0])}return t}(e.clipboardData),this.editableSpan.removeAttribute("contentEditable"),e.preventDefault()}else this.blockEvent(e)},e.prototype.blockEvent=function(e){this.logEventData(e.type),e.preventDefault()},e.prototype.logEventData=function(e){this.eventLogs&&this.openTime&&this.eventLogs.push(new b(e,this.openTime))},e.prototype.logEvent=function(e){this.logEventData(e.type)},e.prototype.handleEditableMousedownEvent=function(e){if(this.logEventData(e.type),this.editableSpan&&e.target!==this.editableSpan){if(this.editableSpan.focus(),window.getSelection){var t=window.getSelection();t&&t.collapseToEnd()}e.preventDefault()}},e.prototype.removeKeypressEventListener=function(){this.keyboardEventHandler&&document.removeEventListener("keydown",this.keyboardEventHandler)},e.prototype.isTouchSupport=function(){return navigator.userAgent.indexOf("Android")>=0||navigator.userAgent.indexOf("iPad")>=0||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},e.prototype.showRibbonPlaceholder=function(){var e=this;function t(e,t){var i=document.createElement("div");return i.className="ribbonBar",i.setAttribute("unselectable","on"),i.appendChild(e),i.appendChild(t),i}if(!document.getElementById("ExternalHeaderFullTopBars")){var i=this.getTopbarContainerFunc();if(i&&this.appearance.showRibbonHeader){var n=document.createElement("div");n.className="cui-topBar1",this.appearance.reactSharedHeaderIsEnabled?n.className+=" cui-topBar1-transitionalReactHeaderUI":n.className+=" cui-topBar1-transistionalHeaderUI",n.setAttribute("unselectable","on");var a="",o="";this.appearance.headerBackgroundColorOverride&&(a="background-color:"+this.appearance.headerBackgroundColorOverride+";"),this.appearance.headerTextColorOverride&&(o="color:"+this.appearance.headerTextColorOverride+";"),this.appearance.reactSharedHeaderIsEnabled&&(a||o)&&n.setAttribute("style",""+a+o);var s=document.createElement("span");s.className="cui-QATRowLeft BreadcrumbContainer";var l=document.createElement("span");l.className="AppAndBrandContainer",this.appearance.reactSharedHeaderIsEnabled&&a&&l.setAttribute("style",a);var r=document.createElement("div");r.className="WACFastBootLoader";var d=document.createElement("span");d.className="BreadcrumbItem";var c=this.appearance.reactSharedHeaderIsEnabled&&this.appearance.headerAppLauncherIsHidden;c?d.setAttribute("style","width:8px;height:48px;display:inline-block;"):d.setAttribute("style","width:48px;height:48px;display:inline-block;"),document.createElement("span").className="OfficeOnlineBrandSwitcherSeparator";var u=document.createElement("span");u.className="headBrand",this.appearance.reactSharedHeaderIsEnabled?u.setAttribute("style","line-height:48px;margin-left:2px;"):u.setAttribute("style","line-height:48px;"),u.appendChild(document.createTextNode(this.appearance.appBrandedName)),l.appendChild(d),l.appendChild(u),c||l.appendChild(r),s.appendChild(l),n.appendChild(s);var p=document.createElement("div");p.className="cui-topBar2",p.setAttribute("unselectable","on");var b=document.createElement("div");b.id="WACTopbarPlaceholder",b.appendChild(n),b.appendChild(p),i.appendChild(b),this.topbarPlaceholderElement=b}var h=this.getRibbonContainerFunc();if(h&&0===h.children.length){var m=document.createElement("div");if(m.id="WACRibbonPlaceholder",m.className=m.id,this.appearance.showRibbon&&!this.appearance.skeletalBootUXIsEnabled)if(this.appearance.simplifiedReactRibbonUxIsEnabled)(R=function(e,i){var n=document.createElement("div");n.className=e?"oneLineRibbonUpperWithAnimation":"oneLineRibbonUpper",n.className+=" oneLineRibbonUpperWithTabHeaderRefresh";var a=document.createElement("div");return a.className=e?"oneLineRibbonLowerWithAnimation":"oneLineRibbonLower",i&&(a.style.height="90px"),t(n,a)}(this.appearance.simplifiedReactRibbonAnimationIsEnabled,this.appearance.reactMultiLineRibbonIsVisible)).addEventListener("click",(function(){e.logEventData("ribbonClick")})),m.appendChild(R);else if(this.appearance.showRibbonImage&&this.appearance.ribbonExpandedByDefault&&"true"!==this.getCookieFunc(this.appearance.ribbonPreferenceCookieName)){var R;(R=function(e,i){var n=document.createElement("div");n.className="ribbonUpper";var a=document.createElement("div");a.className="ribbonLower";var o=document.createElement("div");o.className="ribbonLeft";var s=function(e,t){var i=t;if(e){i=t.replace("bgapp_word_topleft","bgapp_word_topleft_touch")}return i}(e,i);return o.style.backgroundImage="url('"+s+"')",e&&(a.className+=" ribbonTouch",o.className+=" ribbonTouch"),n.appendChild(o),t(n,a)}(this.touchSupport,this.appearance.ribbonImageBase)).addEventListener("click",(function(){e.logEventData("ribbonClick")})),m.appendChild(R)}else m.style.height="30px";else m.className="cui-exth";h.appendChild(m),this.ribbonPlaceholderElement=m}}},e.prototype.makeInitialParaEditable=function(e){var t=this,i=e.querySelector(".PageContentContainer");i&&(i.className+=" WACFastViewEditor",i.addEventListener("mousedown",(function(e){t.handleEditableMousedownEvent(e)}))),this.editableSpan=e.querySelector(".NormalTextRun"),this.editableSpan&&(this.editableSpan.contentEditable="true",this.editableSpan.style.outline="0px",this.editableSpan.spellcheck=!1,this.editableSpan.setAttribute("aria-hidden","true"),this.editableSpan.focus(),this.editableSpan.addEventListener("paste",(function(e){t.handlePasteEvent(e)})),this.editableSpan.addEventListener("keydown",(function(e){t.handleEditableKeyboardEvent(e)})))},e.prototype.sendBeaconForBoot=function(e){u.sendBeacon(e,"BootPhaseCompleted")},e.prototype.open=function(t,i){var n=this;void 0===i&&(i=!1),this.appearance.showRibbonHeader||this.makeStyleChangesToHideHeader(),this.showRibbonPlaceholderIfRequired();var l=this.getDocumentContainerFunc();if(!l||!t)return!1;var r="canvasWrap"===l.id,p=document.createElement("div"),b=function(t,i,n,a){var o;if(o=t.cssPositionRewriteIsEnabled&&!a?e.cssPositionRewriteClass:e.cssClass,t.wordIsSkeletalDeepLinkOn&&t.isDeepLinkScenario&&(o+=" Deeplink"),t.positionAbsolute){if(o+=" "+e.cssClassAbsolute,t.showRibbon?t.showRibbonHeader||(o+=" HeaderHidden"):o+=" HeaderAndRibbonHidden",t.showNavPane?t.showNavSections||(o+=" SectionsHidden"):o+=" NavHidden",t.simplifiedReactRibbonUxIsEnabled)o+=" OneLineRibbon",o+=" OneLineRibbonWithTabHeaderRefresh";else{var s=i(t.ribbonPreferenceCookieName);(!t.ribbonExpandedByDefault&&"false"===s||t.ribbonExpandedByDefault&&"true"!==s)&&(o+=" RibbonPinned",n&&(o+=" Touch"))}t.skeletalBootUXIsEnabled&&(o+=" "+d.getFastViewSkeletalClass()),t.snackbarNavPaneIsEnabled&&(o+=" Snackbar"),t.twoPaneNavIsEnabled&&(o+=" TwoPaneNav")}return o}(this.appearance,this.getCookieFunc,this.touchSupport,r);if(p.className=b,p.id="WACFastView",this.appearance.isRegionComposerShown?p.style.top="0":this.appearance.reactMultiLineRibbonIsVisible&&(p.style.top="126px"),p.innerHTML=t,this.htmlElement=p,this.appearance.editable&&(this.isEditable=s.isDocumentEmpty(p)),i)p.style.visibility="hidden";else{this.keyboardEventHandler=this.handleKeyboardEvent,document.addEventListener("keydown",(function(e){n.keyboardEventHandler&&n.keyboardEventHandler(e)}));var h=function(e){n.logEvent(e)};if(p.firstChild)if(p.firstChild.addEventListener("scroll",h),p.firstChild.addEventListener("click",h),p.firstChild.addEventListener("dblclick",h),p.firstChild.addEventListener("contextmenu",(function(e){n.blockEvent(e)})),r)p.firstChild.classList.add("WACFastViewNavOreoGrid");l.appendChild(p),navigator.userAgent.indexOf("Macintosh")>=0&&document.body.classList.add("Mac"),this.appearance.wordIsSkeletalDeepLinkOn&&this.appearance.isDeepLinkScenario&&document.body.classList.add("Deeplink"),this.fastViewOnSkeletal?c.showFastViewOnSkeletalCanvas():a.g_isUserCreatingPersonalNotebookFirstTime||(this.appearance.skeletalBootUXIsEnabled?c.setFastViewReady():function(){var e=document.getElementById("load_img");e&&(e.style.opacity="0",e.style.height="1px");var t=document.getElementById("load_back");t&&(t.style.opacity="0",t.style.height="1px")}()),function(e,t){if(!(t.wordIsSkeletalDeepLinkOn&&t.isDeepLinkScenario||0===o.initialParaId)){var i=document.querySelector("p[paraid='"+o.initialParaId+"']");if(!i||!i.getBoundingClientRect)return;var n=i.getBoundingClientRect().bottom,a=e.getBoundingClientRect().bottom;e.firstElementChild&&(e.firstElementChild.scrollTop=n-a+70)}}(p,this.appearance),this.sendBeaconForBoot("RecordContentDisplayed"),this.isEditable&&(p.className+=" WACFastViewEditable",this.makeInitialParaEditable(p),this.sendBeaconForBoot("RecordAppInteractive"))}return this.openTime=(new Date).getTime(),u.addMark("ViewableEnd"),u.measureMarks("Viewable","StartWacBoot","ViewableEnd"),!0},e.prototype.showRibbonPlaceholderIfRequired=function(){this.appearance.positionAbsolute&&this.appearance.showRibbon&&!this.ribbonPlaceholderShown&&!this.appearance.skeletalBootUXIsEnabled&&(this.showRibbonPlaceholder(),this.ribbonPlaceholderShown=!0)},e.prototype.makeStyleChangesToHideHeader=function(){var e=document.getElementById("application");e&&(e.style.top="0")},e.prototype.isOpen=function(){return!(!this.htmlElement||!this.htmlElement.parentNode)},e.cssClassAbsolute="WACFastViewAbsolute",e.cssClass="WACFastView",e.cssPositionRewriteClass="WACFastViewPositionRewrite",e}(),m=function(e,t){this.pageHtml=e,this.editable=t},R=function(){function e(){}return e.getPageHtmlInfoFromGetCellsResponse=function(e){if(e&&e.Responses[0]&&e.Responses[0][1]&&e.Responses[0][1].Cells)for(var t=e.Responses[0][1].Cells,i=0;i<t.length;i+=1){var n=t[i];if(n&&n.PageHtml)return new m(n.PageHtml,!!n.IsPageHtmlEditable)}},e}(),f=function(){function e(){}return e.initialize=function(){this.metrics={initialVisibility:document.visibilityState,initializeTime:new Date,events:[]},document.addEventListener("visibilitychange",e.handleVisibilityChange)},e.stop=function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)},e.handleVisibilityChange=function(){var t={visibility:document.visibilityState,time:new Date};e.metrics.events.push(t)},e}();f.initialize();var g=function(){function e(){}return e.createRequestOptions=function(e,t,i){return{accessToken:i?i.AccessToken:e.AccessToken,accessTokenTtl:i?i.AccessTokenTtl:"",applicationModeExtended:e.SessionStartInfoJson?JSON.parse(e.SessionStartInfoJson).ApplicationModeExtended:"UNKNOWN",buildVersion:e.BuildVersion,canary:e.Canary,feMachineId:e.FEMachineId,logHostRequests:"true"===e.LogHostRequests?1:0,onenoteSyncEndpoint:e.ONOnlineSyncEndpoint,pageTarget:e.PageTarget,renderingMode:e.AddServerSideRenderingHeader,requestHeadMode:t,rootQuerySignature:e.RootQuerySignature,sessionOrigin:e.SessionOrigin?e.SessionOrigin:"UNKNOWN",url:e.WebServiceBase,userSessionId:e.SessionId,userType:e.UserType,wacCluster:e.WacCluster,wacUserAgent:e.WacUserAgent}},e.createWacBootOptions=function(e,t,i,n){return{baseDocId:e.BaseDocId,fastBootEnabled:"true"===e.FastBoot,getCachedSSR:"true"===e.GetCachedSSR,indexedDBPageTargetKey:"",initParagraphId:parseInt(e.InitialParaId,16),isIndexedDBEnabled:"true"===e.OneNoteIndexedDbCacheIsEnabled,isIndexedDBDefaultPageEnabled:"true"===e.OneNoteIndexedDBCacheDefaultPageIsEnabled,isOneNoteQuickloadCacheLocalStorageEnabled:"true"===e.OneNoteQuickloadCacheLocalStorageIsEnabled,isNewFile:"true"===e.CreateNew,isOneNoteHierarchyApiDryRunEnabled:"true"===e.OneNoteHierarchyApiDryRunEnabled,oneNoteHierarchBootEndpoint:e.OneNoteHierarchBootEndpoint,isOneNoteHierarchySyncOnBootEnabled:"true"===e.OneNoteHierarchySyncIsEnabled,isOneNoteSyncConnectOnBootEnabled:"true"===e.OneNoteSyncConnectOnBootEnabled,isOneNoteSyncHeartBeatEnabled:"true"===e.OneNoteSyncHeartBeatIsEnabled,isUserCreatingPersonalNotebookFirstTime:"true"===e.IsUserCreatingPersonalNotebookFirstTime,oneNoteShouldSendQuerySignatureOnSocketSetup:"true"===e.OneNoteShouldSendQuerySignatureOnSocketSetup,contentSyncVersion:parseInt(e.OneNoteContentSyncVersion,10),optimizedForNewFile:i,pageTarget:e.PageTarget,pageTargetHtml:e.PageTargetHtml,requestOptions:this.createRequestOptions(e,t,n),skipPageHtmlInGetCellsResponse:"true"===e.SkipPageHtmlInGetCellsResponse,slice0Name:e.Slice0Name,syncHeartBeatSendInterval:parseInt(e.OneNoteSyncHeartBeatSendIntervalMs,10),syncHeartBeatWaitInterval:parseInt(e.OneNoteSyncHeartBeatWaitIntervalMs,10),channelOutboundTimeoutInterval:parseInt(e.OneNoteSyncChannelOutboundTimeoutIntervalMs,10),userId:e.UserId}},e}(),S=function(){function e(t,i,n,a,o,l){this.fastBootEnabled="true"===o.FastBoot,e.slice0Name=o.Slice0Name,this.appearance={positionAbsolute:!("true"===o.OneNoteCssPositionRewriteIsEnabled&&e.isSimplifiedReactRibbonUxEnabled(o)),showRibbon:!("true"===o.HideRibbonEmbedded),ribbonExpandedByDefault:t,ribbonPreferenceCookieName:o.RibbonPreferenceCookieNameHint,showRibbonImage:i,ribbonImageBase:o.RibbonImageBase,shouldStretchPageToBottom:n,appBrandedName:o.BrandedWebAppName,showRibbonHeader:!("true"===o.HideHeaderEmbedded),showNavPane:a&&!("true"===o.ONHideNavEmbedded),showNavSections:!("true"===o.ONHideSectionsEmbedded),editable:!1,pasteLoadingUI:"true"===o.PasteInBootLoadingUIIsEnabled,loadingUIGif:o.ProgressGifResource,simplifiedReactRibbonUxIsEnabled:e.isSimplifiedReactRibbonUxEnabled(o),simplifiedReactRibbonAnimationIsEnabled:e.isSimplifiedReactRibbonAnimationEnabled(o),skeletalBootUXIsEnabled:"true"===o.OneNoteSkeletalBootUXIsEnabled,snackbarNavPaneIsEnabled:"true"===o.SnackbarNavPaneIsEnabled,twoPaneNavIsEnabled:"true"===o.OneNoteTwoPaneNavPaneIsEnabled,reactSharedHeaderIsEnabled:"true"===o.ReactSharedHeaderIsEnabled,headerAppLauncherIsHidden:"true"===o.AppLauncherIsHidden,headerBackgroundColorOverride:s.getCookie("ThemedHeaderBackgroundColor"),headerTextColorOverride:s.getCookie("ThemedHeaderTextColor"),cssPositionRewriteIsEnabled:"true"===o.OneNoteCssPositionRewriteIsEnabled&&e.isSimplifiedReactRibbonUxEnabled(o),wordIsSkeletalDeepLinkOn:"true"===o.WordIsSkeletalDeepLinkOn,isDeepLinkScenario:"true"===o.IsDeepLinkScenario,reactMultiLineRibbonIsVisible:e.isReactMultilineRibbonVisible(o),renderFastViewOnSkeletalUXIsEnabled:"true"===o.OneNoteRenderFastViewOnSkeletalIsEnabled,isRegionComposerShown:!!l}}return e.prototype.launchFastView=function(e,t,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=!1),u.sendBeacon("Launching FastView from entry point "+t,"BootLogs"),this.appearance.editable=i,this.fastBootEnabled&&!o.fastView&&!document.getElementById("PageContentContainer")){var a,l=document.getElementById("canvasWrap");if(this.appearance.isRegionComposerShown)a=document.getElementById("WACDocumentPanel");else if(null!=l&&this.appearance.cssPositionRewriteIsEnabled)a=l;else{var r=this.appearance.renderFastViewOnSkeletalUXIsEnabled&&n?"SkeletalCanvas":"WACInnerFrame";a=document.getElementById(r)}o.fastView=new h((function(){return document.getElementById("AppHeaderPanel")}),(function(){return document.getElementById("WACRibbonPanel")}),(function(){return a}),this.appearance,t,s.getCookie,n);try{return o.fastView.open(e)}catch(e){return o.fastBootError="FastView open failed: "+e.message+"\r\n"+e.stack,!1}}return!1},e.getSlice0=function(){if(null!=e.slice0Name&&e.slice0Name.length>0){var t=document.createElement("script");t.type="text/javascript",t.src=e.slice0Name,document.getElementsByTagName("head")[0].appendChild(t)}},e.isSimplifiedReactRibbonUxEnabled=function(t){return"true"===t.SimplifiedReactRibbonUxIsEnabled&&e.userDidNotOptOutOfSimplifiedUX(t)},e.isSimplifiedReactRibbonAnimationEnabled=function(t){return"true"===t.OneLineRibbonAnimationIsEnabled&&e.isSimplifiedReactRibbonUxEnabled(t)},e.userDidNotOptOutOfSimplifiedUX=function(e){return"false"===e.OptOutSupportForSimplifiedRibbonIsEnabled||"false"!==s.getCookie(e.IsSimplifiedRibbonOnCookieName).toLowerCase()},e.isReactMultilineRibbonVisible=function(t){return"true"===t.ReactMultilineRibbonIsEnabled&&(e.userHasMLRPreference(t)||"false"===s.getCookie(t.IsSimplifiedRibbonOnCookieName).toLowerCase())},e.userHasMLRPreference=function(e){return"true"===s.getCookie(e.ReactRibbonMLRPreferenceCookieName).toLowerCase()},e}(),E=i(0),w=function(){function e(t,i){var n=this;this.onGetCellsRequestCompleted=function(t){if(u.sendBeacon("Get cells response received:"+t.status,"BootLogs"),!a.g_initialRequestCompleted){if(e.onGetCellsRequestCompletedInternal(t.responseText,!1),!o.fastView){var i=R.getPageHtmlInfoFromGetCellsResponse(a.g_initialRequestResponseObject);i&&i.pageHtml&&n.fastViewFactory&&n.fastViewFactory.launchFastView(i.pageHtml,"WacBootGetCells",i.editable)}a.g_fastViewOpenTime=new Date}},this.onInitialResponseReady=function(){a.g_onInitialResponseReady&&a.g_onInitialResponseReady()},this.onRenderPageRequestCompleted=function(t){var i=t.responseText;if(!o.fastView){var a=function(t){var i=e.getResponseFromText(t);if(i&&i.Responses[0]&&i.Responses[0][1]&&i.Responses[0][1].Html)return i.Responses[0][1].Html}(i);a&&n.fastViewFactory&&n.fastViewFactory.launchFastView(a,"WacBootRenderPage")}},this.fastViewFactory=t,this.wacBootOptions=i}return e.prototype.makeGetCellsRequest=function(e){u.sendBeacon("Making GetCells Request","BootLogs"),o.initialParaId=this.wacBootOptions.initParagraphId||0;var t=JSON.stringify(window.location.href),i=',"SearchQuery":null,"IsNewFile":'+(this.wacBootOptions.isNewFile&&this.wacBootOptions.optimizedForNewFile).toString()+',"InitialParaId":'+o.initialParaId+',"RequestUrl":'+t+',"SkipPageHtmlInResponse":'+this.wacBootOptions.skipPageHtmlInGetCellsResponse.toString(),n=this.getRequestBody(1,i,{}),a=this.wacBootOptions.requestOptions.url+"OneNote.ashx";return this.makeRequest(a,n,e,this.setGetCellsRequestGlobals)},e.prototype.makeRenderPageRequest=function(e){if(!this.wacBootOptions.isNewFile||!this.wacBootOptions.optimizedForNewFile){var t=this.getRequestBody(46,"",e),i=this.wacBootOptions.requestOptions.url+"OneNote.ashx?IsRenderPage=1";this.makeRequest(i,t,this.onRenderPageRequestCompleted,(function(){}))}},e.prototype.makeStartSessionRequest=function(e,t){var i=this.wacBootOptions.requestOptions.url+e;this.makeRequest(i,"",t,(function(){}))},e.prototype.setGetCellsRequestGlobals=function(){a.g_initialRequestInvokedTime=new Date,a.g_initialRequestMade=!0,u.addMark("InitialRequestStart")},e.prototype.makeRequest=function(e,t,i,n){var a=new XMLHttpRequest,o={};for(var s in a.onreadystatechange=function(){if(a&&4===a.readyState){if(void 0===a.status||0===a.status)return;try{i&&i(a)}finally{null!=a&&(a.onreadystatechange=function(){},a=void 0)}}},a.open("Post",e,!0),this.buildRequestHeaderDict(o),o)a.setRequestHeader(s,o[s]);var l=t;return t||(l=""),n(),a.send(l),a},e.prototype.buildRequestHeaderDict=function(e){e["X-xhr"]="1",this.wacBootOptions.requestOptions.userSessionId&&(e["X-UserSessionId"]=this.wacBootOptions.requestOptions.userSessionId),this.wacBootOptions.requestOptions.buildVersion&&(e["X-OfficeVersion"]=this.wacBootOptions.requestOptions.buildVersion),e["Content-Type"]="application/json; charset=utf-8",this.wacBootOptions.requestOptions.canary&&(e["X-Key"]=this.wacBootOptions.requestOptions.canary),this.wacBootOptions.requestOptions.accessToken&&(e["X-AccessToken"]=this.wacBootOptions.requestOptions.accessToken),this.wacBootOptions.requestOptions.accessTokenTtl&&(e["X-AccessTokenTtl"]=this.wacBootOptions.requestOptions.accessTokenTtl),this.wacBootOptions.requestOptions.userType&&(e["X-UserType"]=this.wacBootOptions.requestOptions.userType),1===this.wacBootOptions.requestOptions.logHostRequests&&(e["X-LogHostRequests"]="1"),this.wacBootOptions.requestOptions.wacCluster&&(e["X-WacCluster"]=this.wacBootOptions.requestOptions.wacCluster),this.wacBootOptions.requestOptions.wacUserAgent&&(e["X-WacUserAgent"]=this.wacBootOptions.requestOptions.wacUserAgent),this.wacBootOptions.requestOptions.renderingMode&&(e["X-ServerSideRendering"]=this.wacBootOptions.requestOptions.renderingMode),this.wacBootOptions.requestOptions.feMachineId&&(e["X-FEMachineId"]=this.wacBootOptions.requestOptions.feMachineId),e["X-Requested-With"]="XMLHttpRequest"},e.prototype.getRequestBody=function(e,t,i){var n=JSON.stringify(this.wacBootOptions.requestOptions.rootQuerySignature);n&&(n=n.substring(1,n.length-1));var a=JSON.stringify(this.wacBootOptions.requestOptions.pageTarget);a&&(a=a.substring(1,a.length-1));var o='{"Mode":'+this.wacBootOptions.requestOptions.requestHeadMode+',"srs":[[',s=',{"FileId":"'+n+'","PageTarget":"'+a+'","OperationId":1';for(var l in i)s+=',"'+l+'":'+i[l];return o+e+s+t+"}]]}"},e.getResponseFromText=function(e){try{return JSON.parse(e)}catch(e){o.fastBootError="JSON.parse failed: "+e.message+"\r\n"+e.stack}},e.onGetCellsRequestCompletedInternal=function(t,i){a.g_getCellsFromFrameRequest=i,a.g_initialRequestCompleted=!0,a.g_initialResponseTime=new Date,u.addMark("InitialRequestEnd"),u.addMark("InitialResponseProcessStart"),u.measureMarks("InitialRequest","InitialRequestStart","InitialRequestEnd");var n=e.getResponseFromText(t);if(a.g_initialRequestResponseObject=n,n&&n.Responses&&n.Responses[0]&&n.Responses[0][1]){var o=n.Responses[0][1];a.g_acquireLockStartTime=o.AcquireLockStartTime,a.g_acquireLockEndTime=o.AcquireLockEndTime,a.g_acquireLockStartTime=o.AcquireLockStartTime,a.g_getDocumentStartTime=o.GetDocumentStartTime,a.g_getDocumentEndTime=o.GetDocumentEndTime,a.g_getCellsStartTime=o.GetCellsStartTime,a.g_getCellsEndTime=o.GetCellsEndTime,a.g_getInitializeLocalCobaltStartTime=o.InitializeLocalCobaltStartTime,a.g_getInitializeLocalCobaltEndTime=o.InitializeLocalCobaltEndTime}a.g_initialResponseReadyTime=new Date,u.addMark("InitialResponseProcessEnd"),u.measureMarks("InitialResponseProcess","InitialResponseProcessStart","InitialResponseProcessEnd")},e.getCellsFromFrameRequest=function(t){a.g_initialRequestCompleted||(e.onGetCellsRequestCompletedInternal(t,!0),a.g_fastViewOpenTime=new Date)},e}(),v={g_appSettings:void 0,g_bootOptions:void 0,g_fastViewLauncher:void 0,g_bootSSRData:void 0,g_bootSettings:void 0,g_initialResponseReceived:!1,g_onInitialResponseReceived:void 0},C="ContentRequestResponse",y="ContentRequestStart",k="ContentResponseEnd",O="ONOHierarchyDryRunRequestResponse",P="ONOHierarchyDryRunContentRequestStart",I="ONOHierarchyDryRunContentResponseEnd",N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onOneNoteGetCellsRequestCompleted=function(e){u.addMark(k),u.measureMarks(C,y,k),t.onGetCellsRequestCompleted(e);var i=R.getPageHtmlInfoFromGetCellsResponse(a.g_initialRequestResponseObject);a.g_bootSSRData=i,i&&i.pageHtml&&(a.g_bootSSRHtmlStringLength=i.pageHtml.length),t.onInitialResponseReady(),v.g_bootSSRData=a.g_bootSSRData,v.g_onInitialResponseReceived?v.g_onInitialResponseReceived():v.g_initialResponseReceived=!0},t.onOneNoteHierarchyApiDryrunRequestCompleted=function(){u.addMark(I),u.measureMarks(O,P,I)},t}return E.c(t,e),t.prototype.makeOneNoteGetCellsRequest=function(){this.makeGetCellsRequest(this.onOneNoteGetCellsRequestCompleted),u.addMark(y)},t.prototype.makeHierarchyApiDryRunRequest=function(){this.makeHierarchyBootRequest(this.wacBootOptions.oneNoteHierarchBootEndpoint+"?querySignature="+encodeURIComponent(this.wacBootOptions.requestOptions.rootQuerySignature),this.onOneNoteHierarchyApiDryrunRequestCompleted),u.addMark(P)},t.prototype.makeHierarchyBootRequest=function(e,t){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i&&4===i.readyState){if(void 0===i.status||0===i.status)return;try{t&&t(i)}finally{null!=i&&(i.onreadystatechange=function(){},i=void 0)}}},i.open("Get",e,!0),i.send()},t}(w);function B(e,t){if(t){u.addMark("StartWacBoot"),s.ensureCookieCompliance("true"===e.MSCCEnabled,e.MSCCCookies);var i=g.createWacBootOptions(e,1,!1);if(a.g_isUserCreatingPersonalNotebookFirstTime=i.isUserCreatingPersonalNotebookFirstTime,i.isNewFile)return;var n=new S(!1,!1,!1,!0,e),o=new N(n,i);i.isOneNoteHierarchySyncOnBootEnabled||o.makeOneNoteGetCellsRequest(),i.isOneNoteHierarchyApiDryRunEnabled&&o.makeHierarchyApiDryRunRequest(),"true"===e.OneNoteSkeletalBootUXIsEnabled&&c.launchExperience(e),a.g_networkType=u.measureNetworkType(),v.g_appSettings=e,v.g_bootOptions=i,v.g_fastViewLauncher=n,v.g_bootSettings=a}}i.d(t,"FastViewAppearance",(function(){return p})),i.d(t,"FastViewLogEntry",(function(){return b})),i.d(t,"FastView",(function(){return h})),i.d(t,"FastViewUtils",(function(){return s})),i.d(t,"PerfUtils",(function(){return u})),i.d(t,"bootSettings",(function(){return a})),i.d(t,"FastViewSettings",(function(){return o})),i.d(t,"SkeletalBoot",(function(){return c})),i.d(t,"SSRData",(function(){return m})),i.d(t,"SSRDataUtils",(function(){return R})),i.d(t,"WindowVisibilityMetrics",(function(){return f})),i.d(t,"startWacBoot",(function(){return B})),i.d(t,"settings",(function(){return v}))}});
//# sourceMappingURL=wacBoot.min.js.map