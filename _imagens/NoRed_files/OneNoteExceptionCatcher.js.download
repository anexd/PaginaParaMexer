!function(r){
/*!This code is a exception catcher to wrap all async function with try catch and trigger onerror when there is an exception
  from code base https://office.visualstudio.com/OneNote/Online/_git/OneNoteExceptionCatcher */
function e(r,e,n){var t=r[e];r[e]=n(t),r[e].__is_wrapped__=!0,r[e].__orig__=t}function n(r){return"function"==typeof r}function t(r){return void 0===r}_window=window;var o=!1;function i(){}i.prototype={wrapTryCatch:function(){var r=this;function t(e){return function(t,o){for(var i=new Array(arguments.length),a=0;a<i.length;++a)i[a]=arguments[a];var p=i[0];return n(p)&&(i[0]=r.wrap(p)),e.apply?e.apply(this,i):e(i[0],i[1])}}e(_window,"setTimeout",t),e(_window,"setInterval",t),_window.requestAnimationFrame&&e(_window,"requestAnimationFrame",function(e){return function(n){return e(r.wrap(n))}});for(var o,i,a=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],p=0;p<a.length;p++)o=a[p],i=void 0,(i=_window[o]&&_window[o].prototype)&&i.hasOwnProperty&&i.hasOwnProperty("addEventListener")&&(e(i,"addEventListener",function(e){return function(n,t,o,i){try{t&&t.handleEvent&&(t.handleEvent=r.wrap(t.handleEvent))}catch(r){}return e.call(this,n,r.wrap(t,void 0,void 0),o,i)}}),e(i,"removeEventListener",function(r){return function(e,n,t,o){try{n=n&&(n.__wrapper__?n.__wrapper__:n)}catch(r){}return r.call(this,e,n,t,o)}}));if("XMLHttpRequest"in _window){e(XMLHttpRequest.prototype,"send",function(t){return function(){for(var o,i,a=["onload","onerror","onprogress","onreadystatechange"],p=0;p<a.length;p++)(o=a[p])in(i=this)&&n(i[o])&&e(i,o,function(e){return r.wrap(e)});return t.apply(this,arguments)}})}},wrap:function(r,e){var i,a,p=this;if(t(e)&&!n(r))return r;if(n(r)&&(e=r,r=void 0),!n(e))return e;try{if(e.__is_wrapped__)return e;if(e.__wrapper__)return e.__wrapper__}catch(r){return e}function u(){for(var n,i=[],a=arguments.length,u=!r||r&&!1!==r.deep;a--;)i[a]=u?p.wrap(r,arguments[a]):arguments[a];try{return e.apply(this,i)}catch(r){throw n=r,"onerror"in _window&&0==o&&(o=!0,t(n)?_window.onerror("Error is undefined.","",0,0,new Error("Error is undefined.")):t(n.message)?_window.onerror("Error with no message.","",0,0,n):_window.onerror(n.message,"",0,0,n)),r}}for(var _ in e)i=e,a=_,Object.prototype.hasOwnProperty.call(i,a)&&(u[_]=e[_]);return u.prototype=e.prototype,e.__wrapper__=u,u.__is_wrapped__=!0,u.__orig__=e,u}},(new i).wrapTryCatch()}("undefined"==typeof OneNoteErrorLog?OneNoteErrorLog={}:OneNoteErrorLog);
