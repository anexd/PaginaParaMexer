(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[1],{124:function(e,t,n){"use strict";n.d(t,{g:function(){return r}});var i=n(4115),r=function(){function e(e){this._originalWord=null,this._originalWord=e}return e.prototype.fractionsAutoFormatedData=function(){if(!this._originalWord)return null;for(var t=0;t<e.get_FractionsList().length;t++)if(this._originalWord===e.get_FractionsList()[t])return e.get_FractionsAutoFormatedList()[t];return null},e.get_FractionsList=function(){return e._fractionsList||(e._fractionsList=["1/2","1/4","3/4"])},e.get_FractionsAutoFormatedList=function(){return e._fractionsAutoFormatedList||(e._fractionsAutoFormatedList=["\xbd","\xbc","\xbe"])},e._fractionsList=null,e._fractionsAutoFormatedList=null,e}();(0,i.l)(r,"bbdeec27$FractionsCollection",null,[])},736:function(e,t,n){"use strict";n.d(t,{u:function(){return r}});var i=n(4115),r=function(){function e(){}return e.Value="Value",e.MaxValue="MaxValue",e.Text="Text",e}();(0,i.l)(r,"eb03c368$SliderCommandProperties",null,[])},937:function(e,t,n){"use strict";n.d(t,{z:function(){return g}});var i=n(1817),r=n(8202),o=n(9375),a=n(8548),l=n(9368),s=n(7275),u=n(654),c=n(8399),d=n(4115),g=function(e){function t(t,n,i,r,o,a){return e.call(this,t,n,i,r,o,a)||this}return(0,i.t)(t,e),t.prototype.get_commandId=function(){return o.u.autoCorrectRomanList},t.prototype.doGraphCorrection=function(e){if(this.get_listCommands()){var n=u.g.createFromNode(e);if(n.tryToRootAtOutlineAncestor(),l.OutlineElementNavigator.returnToOutlineElement(n),this.get_listEditor().shouldAutocorrectList(n)){var i=this.matchResults[0],r=a.l.substring(i,0,i.indexOf(".")),o=t.NumberFromRomanString(r);if(!(o<=0)){var c=a.l.isUpperCase(i.charAt(0))?5:3,d=s.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchEndIndex()+1);this.get_listEditor().autocorrectNumberList(e,n,c,o,d,i,this.get_listCommands())}}}},t.CreateGraphCorrectionAction=function(e,n,i,r,o,a){return new t(null,e,n,i,r,o)},t.CreateHtmlCorrectionAction=function(e,n,i,r,o,a){return new t(e,c.j.getOwner(e).get_sourceNode(),n,i,r,o)},t.EnsureRomanValues=function(){t._romanValues||(t._romanValues={},t._romanValues.M=1e3,t._romanValues.D=500,t._romanValues.C=100,t._romanValues.L=50,t._romanValues.X=10,t._romanValues.V=5,t._romanValues.I=1)},t.NumberFromRomanString=function(e){if(!e)return 0;t.EnsureRomanValues();for(var n=a.l.toUpper(e),i=0,r=0,o=n.length-1;o>=0;o--){var l=t._romanValues[a.l.charAt(n,o).toString()];r=l<i?r-l:r+l,i=l}return r},t._romanValues=null,t}(r.n);(0,d.l)(g,"306ea70b$RomanListAction",r.n,[])},1057:function(e,t,n){"use strict";n.r(t),n.d(t,{ToolbarContainer:function(){return l}});var i=n(1817),r=n(4494),o=n(9958),a=n(4115),l=function(e){function t(){var t=e.call(this)||this;return t.set_elmContainer(o.k.createUnselectableElement("span")),t.get_elmContainer().className="cui-herobar-toolbarContainer",t.get_elmContainer().id="viewerChrome-ToolbarContainer",t}return(0,i.t)(t,e),t}(r.x);(0,a.l)(l,"57c36436$ToolbarContainer",r.x,[])},1061:function(e,t,n){"use strict";n.d(t,{h:function(){return c}});var i=n(1817),r=n(3295),o=n(9375),a=n(3910),l=n(7275),s=n(8399),u=n(4115),c=function(e){function t(t,n,i,r,o,a,l){var s=this;return s._actionManager=null,(s=e.call(this,t,n,i,r,o,a)||this)._actionManager=l,s}return(0,i.t)(t,e),t.prototype.get_commandId=function(){return o.u.autoCorrectEmoji},t.prototype.populateReplacementDictionary=function(){r.v._replacements.set_item(":)","\ud83d\ude0a"),r.v._replacements.set_item(":-)","\ud83d\ude0a"),r.v._replacements.set_item(":|","\ud83d\ude10"),r.v._replacements.set_item(":-|","\ud83d\ude10"),r.v._replacements.set_item(":(","\ud83d\ude41"),r.v._replacements.set_item(":-(","\ud83d\ude41"),r.v._replacements.set_item(";)","\ud83d\ude09"),r.v._replacements.set_item(";-)","\ud83d\ude09"),r.v._replacements.set_item(":D","\ud83d\ude00"),r.v._replacements.set_item(":-D","\ud83d\ude00"),r.v._replacements.set_item(":')","\ud83d\ude02"),r.v._replacements.set_item("=D","\ud83d\ude03"),r.v._replacements.set_item(":>","\ud83d\ude06"),r.v._replacements.set_item(":->","\ud83d\ude06"),r.v._replacements.set_item(":3","\ud83d\ude0a"),r.v._replacements.set_item(":-3","\ud83d\ude0a"),r.v._replacements.set_item("B-)","\ud83d\ude0e"),r.v._replacements.set_item("*-*","\ud83d\ude0d"),r.v._replacements.set_item(":*","\ud83d\ude19"),r.v._replacements.set_item(":-*","\ud83d\ude19"),r.v._replacements.set_item(":X","\ud83d\ude36"),r.v._replacements.set_item(":-X","\ud83d\ude36"),r.v._replacements.set_item(":O","\ud83d\ude2e"),r.v._replacements.set_item(":-O","\ud83d\ude2e"),r.v._replacements.set_item(":#","\ud83e\udd10"),r.v._replacements.set_item(":-#","\ud83e\udd10"),r.v._replacements.set_item(":P","\ud83d\ude1b"),r.v._replacements.set_item(":-P","\ud83d\ude1b"),r.v._replacements.set_item(";P","\ud83d\ude1c"),r.v._replacements.set_item(";-P","\ud83d\ude1c"),r.v._replacements.set_item(":-/","\ud83d\ude15"),r.v._replacements.set_item("$-$","\ud83e\udd11"),r.v._replacements.set_item(":S","\ud83d\ude16"),r.v._replacements.set_item(":-S","\ud83d\ude16"),r.v._replacements.set_item(":[","\ud83d\ude1f"),r.v._replacements.set_item(":-[","\ud83d\ude1f"),r.v._replacements.set_item(":\u2019(","\ud83d\ude22"),r.v._replacements.set_item(":'(","\ud83d\ude22"),r.v._replacements.set_item("@-@","\ud83d\ude31")},t.prototype.doGraphCorrection=function(e){var t=this;this.checkMatchAndCommit(a.ParagraphReader.text(e).substring(this.get_matchStartIndex(),this.get_matchEndIndex()),(function(n,i,r){var a=l.y.createTextRange(e,t.get_matchStartIndex()+n,t.get_matchStartIndex()+i),s={};s.MenuItemId=r,t._actionManager.processActionAgainstContext(a,o.u.insertEmoji,2,!1,null,s,null)}))},t.createGraphCorrectionAction=function(e,n,i,r,o,a){return new t(null,e,n,i,r,o,a)},t.createHtmlCorrectionAction=function(e,n,i,r,o,a){return new t(e,s.j.getOwner(e).get_sourceNode(),n,i,r,o,a)},t}(r.v);(0,u.l)(c,"990eac72$EmojiAction",r.v,[])},1705:function(e,t,n){"use strict";n.r(t),n.d(t,{Box4PasteSteward:function(){return O}});var i=n(1817),r=n(9981),o=n(23),a=n(7057),l=n(2562),s=n(4232),u=n(3660),c=n(9394),d=n(9730),g=n(9062),p=n(2927),h=n(2183),_=n(3116),m=n(6325),f=n(2601),y=n(8548),C=n(325),S=n(4670),b=n(4577),v=n(274),T=n(3910),A=n(2442),I=n(382),w=n(8950),x=n(9368),E=n(8182),F=n(5885),P=n(7101),D=n(313),R=n(7275),M=n(2822),k=n(7272),N=n(654),L=n(9192),B=n(4115),O=function(e){function t(n,i,r,o,a,l,s,u,c){void 0===u&&(u=null),void 0===c&&(c=null);var p=e.call(this,n,s,u,c)||this;return p._internalLinkManager=null,p._formatting=null,p._formattingInvalidated=!1,p._href=null,p._pastingIntoList=!1,p._nestedListCount=0,p._imageSteward=null,p._tableSteward=null,p.indentationEditor=null,p.listEditor=null,p.lstReader=null,p._hrefStartCp=-1,p._tablesToDelist=new d.c(L.k),g.r.shipAssertTag(4223754,307,F.OutlineElementReader.isOutlineElement(n)),p._imageSteward=i,p._imageSteward.bindToOwnerSteward(p),p._tableSteward=r,p._tableSteward.bindToOwnerSteward(p),p.indentationEditor=o,p.listEditor=a,p.lstReader=l,p._pastingIntoList=I.ListReader.isListOutlineElement(p._iterator),t.InitializeParagraphStyleStrings(),t.InitializeListStyles(),t.InitializeSupportedStyleSet(),p}return(0,i.t)(t,e),t.prototype.get_InternalLinkManager=function(){return this._internalLinkManager||(this._internalLinkManager=m.w.get_instance().tryResolve(r.v))},t.prototype.get_currentFormatting=function(){return this._formatting},t.prototype.get_continuingExistingList=function(){return this._pastingIntoList&&!this._tableSteward.get_currentlyInsidePastedTable()},t.prototype.get_currentlyUnderPastedList=function(){return this._nestedListCount>0},t.prototype.get_indentationEditor=function(){return this.indentationEditor},t.prototype.get_listEditor=function(){return this.listEditor},t.prototype.get_lstReader=function(){return this.lstReader},t.prototype.get_Box4EnsurePasteFormatOnTextIsEnabled=function(){return!!_.AFrameworkApplication.appSettingsManager&&_.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("Box4EnsurePasteFormatOnTextIsEnabled")},t.prototype.reset=function(){e.prototype.reset.call(this),this._formatting=this.getDefaultFormatting(!1)},t.prototype.appendNewParagraph=function(e){g.r.shipAssertTag(4223762,307,F.OutlineElementReader.isOutlineElement(this._iterator)||E.OutlineReader.isOutline(this._iterator)),this.moveToNextOutlineElementForHtmlImport(!1);var n=new N.g;n.setFrom(this._iterator);var i=c.a.get_outlineElementEditor().createParagraph(this._iterator,this.getNewOutlineElementInfo(e));if(this.applyPendingListAndIndentationInfo(n,!1),g.r.shipAssertTag(4223763,307,i===this._iterator.get_currentNode()),g.r.shipAssertTag(4223764,307,T.ParagraphReader.isParagraphNode(i)),-1!==this._formatting.get_justification()&&t.get_ParagraphEditor().setJustification(i,this._formatting.get_justification()),t.get_ParagraphEditor().getIndentationEditor()&&!this._box4PasteStewardBridge.get_shouldSkipSettingIndentation()){if(this._formatting.get_textIndent()){var r=0,o=void 0,a=!1;if((o=t.ParseCssValue(this._formatting.get_textIndent(),(0,u.m)((function(){return r}),(function(e){return r=e}))))||!I.ListReader.get_externalPasteImprovementsEnabled()){o<0&&(a=!0,o*=-1);var l=t.ConvertToTwips(o,r);a?t.get_ParagraphEditor().getIndentationEditor().setHangingIndent(i,l):t.get_ParagraphEditor().getIndentationEditor().setFirstLineIndent(i,l)}}if(this._formatting.get_marginLeft()&&!t.get_listSettings().isQoEListExternalPasteImprovementIsEnabled&&!I.ListReader.isListOutlineElement(n)){var s,d=0;s=t.ParseCssValue(this._formatting.get_marginLeft(),(0,u.m)((function(){return d}),(function(e){return d=e})));l=t.ConvertToTwips(s,d);t.get_ParagraphEditor().getIndentationEditor().setIndentLeftOnNode(i,1,l)}}(t.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&t.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()||A.n.get_instance().get_item(45)&&S.App.get_box4Bridge().get_trackedChangesEnabled())&&i.setValue(h.j.isNewEop,!0),this._formatting.get_lineSpacing()&&t.get_ParagraphEditor().setLineSpacing(i,this._formatting.get_lineSpacing()),this._formatting.set_paragraph(i),this._formattingInvalidated=!0},t.prototype.applyPendingListAndIndentationInfo=function(e,t){g.r.shipAssertTag(8128518,307,!t),this.get_pendingIndentationLevel()&&!A.n.get_instance().get_item(76)&&(this.get_pendingIndentationLevel()>0&&this.get_indentationEditor().demote(e,this.get_pendingIndentationLevel(),0),this.get_pendingIndentationLevel()<0&&this.get_indentationEditor().promote(e,this.get_pendingIndentationLevel(),0)),A.n.get_instance().get_item(29)&&(this._iterator.setFrom(e),x.OutlineElementNavigator.moveToContent(this._iterator)),!this.get_continuingExistingList()||2===S.App.get_mode()&&this.get_lstReader().get_qoEListInternalCCPImprovementIsEnabled()?e&&this.get_listEditor().setListInfoAndIndentAfterPaste(e,this.get_currentlyUnderPastedList()):this.get_listEditor().setProperPendingListInfoAfterPaste(e),this.set_pendingIndentationLevel(0)},t.prototype.trackTableToDelist=function(e){this._tablesToDelist.add(e)},t.prototype.clearPendingIndentation=function(){this.set_pendingIndentationLevel(0)},t.prototype.onText=function(e,t){void 0===t&&(t=null),g.r.shipAssertTag(4223772,307,T.ParagraphReader.isParagraph(this._iterator));var n=this._iterator.get_currentNode();if(this._formatting.tryApplyCharacterStyle(n),!this._box4PasteStewardBridge.tryHandlePageBreak(this._iterator,t,!1)){_.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.Common.Flighting.IBox4EnsurePasteFormatOnTextSettings");var i=n.get_characterProperties().get_last(),r=R.y.createIpContextAtEndOfParagraph(n),o=!1;if(this._formattingInvalidated&&(i.set_formatting(this._formatting.get_formattingObject().cloneUnderDifferentChp(i)),A.n.get_instance().get_item(57)&&n.updateRunIndices(),this._formattingInvalidated=!1,o=!0),e=this._box4PasteStewardBridge.handleParagraphEnd(e,t),this._box4PasteStewardBridge.setParagraphProperties(this._iterator.get_currentNode(),this._formatting.get_paragraphProperties(),t),this.get_characterPropertiesEditor().replaceTextRange(r,e),this.get_Box4EnsurePasteFormatOnTextIsEnabled()&&o){var a=n.ensureChPOnCp(r.get_cpBegin());a.set_formatting(this._formatting.get_formattingObject().cloneUnderDifferentChp(a))}if(A.n.get_instance().get_item(2)){var l=r.get_node();l.canChangeIdOnTextChange()&&l.get_anchor().changeNodeId()}}},t.prototype.onLineBreak=function(e){if(this._box4PasteStewardBridge.get_isPasteBrAsNewParagraphEnabled()&&this._box4PasteStewardBridge.isFormatless(e))this.onParagraphEnd(),this.onParagraphStart(e);else{g.r.shipAssertTag(4223773,307,T.ParagraphReader.isParagraph(this._iterator));var t=this._iterator.get_currentNode(),n=R.y.createIpContextAtEndOfParagraph(t);this.get_characterPropertiesEditor().insertBlobAtIp(n,(function(e){return new M.y(e,M.y.defaultLineBreakText)}),b.AParagraphNode.embeddedObjectText)}},t.prototype.onTab=function(e){this._box4PasteStewardBridge.handleTabCharacter(this._iterator,e)},t.prototype.onImage=function(e){this._imageSteward.onImage(e)},t.prototype.onFile=function(e){this._imageSteward.onFile(e)},t.prototype.onFormattingChange=function(e){this._formatting=e,this._formattingInvalidated=!0},t.prototype.onAnchorStart=function(e,t){g.r.shipAssertTag(4223774,307,T.ParagraphReader.isParagraph(this._iterator)),g.r.shipAssertTag(4223775,307,!this._href),g.r.shipAssertTag(4223776,307,this._hrefStartCp<0),this._href=e,this._hrefStartCp=T.ParagraphReader.textLength(this._iterator.get_currentNode())},t.prototype.onAnchorEnd=function(){g.r.shipAssertTag(4223777,307,T.ParagraphReader.isParagraph(this._iterator)),g.r.shipAssertTag(4223778,307,!!this._href),g.r.shipAssertTag(4223779,307,this._hrefStartCp>=0);var e=R.y.createTextRange(this._iterator.get_currentNode(),this._hrefStartCp,T.ParagraphReader.textLength(this._iterator.get_currentNode())),n=!1,i="",r="";this.get_InternalLinkManager()&&this.get_InternalLinkManager().tryConvertToRelativeLink(v.HyperlinkReader.getSanitizedUrl(this._href),(0,u.m)((function(){return i}),(function(e){return i=e})),!0,(0,u.m)((function(){return r}),(function(e){return r=e})))&&(this._href=i,n=!0,r&&(this.get_characterPropertiesEditor().replaceTextRange(e,r),e=R.y.createTextRange(this._iterator.get_currentNode(),this._hrefStartCp,T.ParagraphReader.textLength(this._iterator.get_currentNode())))),t.get_HyperlinkEditor().createHyperlink(e,this._href),n||this._box4PasteStewardBridge.processExternalHyperlink(e,this._href),this._formattingInvalidated=!0,this._href=null,this._hrefStartCp=-1},t.prototype.onParagraphStart=function(e){this.appendNewParagraph(e),this._formatting.tryApplyParagraphStyle(this._iterator.get_currentNode()),e&&"P"===e.get_ownerHtmlElementInfo().get_htmlElementType()&&t.get_ParagraphEditor().setParagraphSpacing(this._iterator.get_currentNode(),this._formatting.get_paragraphSpacing()),this._box4PasteStewardBridge.setParagraphProperties(this._iterator.get_currentNode(),this._formatting.get_paragraphProperties(),e,this._formatting.get_marginLeft(),this._formatting.get_textIndent())},t.prototype.onParagraphEnd=function(){g.r.shipAssertTag(4223808,307,T.ParagraphReader.isParagraph(this._iterator)),t.get_HyperlinkEditor().ensureHyperlinkObjectsCreatedInParagraph(this._iterator.get_currentNode()),x.OutlineElementNavigator.returnToOutlineElement(this._iterator)},t.prototype.onPreFormattedTextStart=function(){},t.prototype.onPreFormattedTextEnd=function(){},t.prototype.onMathStart=function(e,t){},t.prototype.onMathEnd=function(){},t.prototype.processMath=function(e,t,n,i,r){var o=this._iterator.get_currentNode(),a=o.get_characterProperties().get_last(),l=R.y.createIpContextAtEndOfParagraph(o);this._formattingInvalidated&&(a.set_formatting(this._formatting.get_formattingObject().cloneUnderDifferentChp(a)),A.n.get_instance().get_item(57)&&o.updateRunIndices(),this._formattingInvalidated=!1);var u=new k.r(t,n,i,this._formatting.get_formattingObject().get_formattingId(),r);D.s.insertMathObject((0,s.e)(b.AParagraphNode,l.get_node()),u)},t.prototype.onListStart=function(e){g.r.shipAssertTag(4223809,307,F.OutlineElementReader.isOutlineElement(this._iterator)||E.OutlineReader.isOutline(this._iterator));var t=!1;this.get_currentlyUnderPastedList()||(t=this.get_continuingExistingList()||this.get_lstReader().doListItemsAutoIndent()),t||this.set_pendingIndentationLevel(this.get_pendingIndentationLevel()+1),this._nestedListCount++},t.prototype.onListEnd=function(){this._nestedListCount--;var e=!1;this.get_currentlyUnderPastedList()||(e=this.get_continuingExistingList()||this.get_lstReader().doListItemsAutoIndent(),this.get_listEditor().removeListsFromTablesIfNecessary(this._tablesToDelist)),e||(this.set_pendingIndentationLevel(this.get_pendingIndentationLevel()-1),this.get_pendingIndentationLevel())},t.prototype.onListItemStart=function(e){g.r.shipAssertTag(4223810,307,F.OutlineElementReader.isOutlineElement(this._iterator)||E.OutlineReader.isOutline(this._iterator)),g.r.shipAssertTag(4223811,307,!!e.get_listStyleType());var t=e;this.get_listEditor().setListInfo(this.listInfoFromListSemanticArgs(t))},t.prototype.onListItemEnd=function(){if(g.r.shipAssertTag(4223813,307,F.OutlineElementReader.isOutlineElement(this._iterator)),_.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings"),t.get_listSettings().isQoEListExternalPasteImprovementIsEnabled&&I.ListReader.isListOutlineElement(this._iterator)){var e=T.ParagraphReader.getFirstParagraphUnderNode(this._iterator.get_currentNode()),n=this.get_lstReader().getListNodeFromOE(this._iterator);this.get_listEditor().setListFormatting(n,e,null)}},t.prototype.onRenderAugmentation=function(e){this._imageSteward.onRenderAugmentation(e)},t.prototype.onSpanStart=function(){},t.prototype.onSpanEnd=function(){},t.prototype.onTableStart=function(e){this._tableSteward.onTableStart(e)},t.prototype.onTableEnd=function(){this._tableSteward.onTableEnd()},t.prototype.onTableRowStart=function(e){this._tableSteward.onTableRowStart(e)},t.prototype.onTableRowEnd=function(){this._tableSteward.onTableRowEnd()},t.prototype.onTableCellStart=function(e){this._tableSteward.onTableCellStart(e)},t.prototype.onTableCellEnd=function(){this._tableSteward.onTableCellEnd()},t.prototype.onTablePartStart=function(e){this._tableSteward.onTablePartStart(e)},t.prototype.onTablePartEnd=function(){this._tableSteward.onTablePartEnd()},t.get_ParagraphEditor=function(){return t._paragraphEditor||(t._paragraphEditor=m.w.get_instance().resolve(o.g))},t.get_HyperlinkEditor=function(){return t._hyperlinkEditor||(t._hyperlinkEditor=m.w.get_instance().resolve(a.o))},t.get_TrackChangeManager=function(){return t._trackChangeManager||(t._trackChangeManager=m.w.get_instance().resolve(l.b).get_instance())},t.get_SupportedStyleSet=function(){return t._supportedStyleSet},t.get_listSettings=function(){return t._listSettings||(t._listSettings=m.w.get_instance().tryResolve(w.r))},t.InitializeParagraphStyleStrings=function(){var e=A.n.get_instance().get_item(61);t.ParagraphStyleStrings[1]=e?P.StyleReader.get_wordStyleIdHeading1():P.StyleReader.styleIdHeading1,t.ParagraphStyleStrings[2]=e?P.StyleReader.get_wordStyleIdHeading2():P.StyleReader.styleIdHeading2,t.ParagraphStyleStrings[3]=e?P.StyleReader.get_wordStyleIdHeading3():P.StyleReader.styleIdHeading3,t.ParagraphStyleStrings[4]=e?P.StyleReader.get_wordStyleIdHeading4():P.StyleReader.styleIdHeading4,t.ParagraphStyleStrings[5]=e?P.StyleReader.get_wordStyleIdHeading5():P.StyleReader.styleIdHeading5,t.ParagraphStyleStrings[6]=e?P.StyleReader.get_wordStyleIdHeading6():P.StyleReader.styleIdHeading6,t.ParagraphStyleStrings[7]=e?null:P.StyleReader.styleIdCitation},t.InitializeListStyles=function(){t.ListStyleMap.unspecified=0,t.ListStyleMap.defaultUnordered=1,t.ListStyleMap.defaultOrdered=1,t.ListStyleMap.none=0,t.ListStyleMap.disc=1,t.ListStyleMap.circle=2,t.ListStyleMap.square=3,t.ListStyleMap.decimal=1,t.ListStyleMap.lowerAlpha=2,t.ListStyleMap.lowerRoman=3,t.ListStyleMap.upperAlpha=4,t.ListStyleMap.upperRoman=5},t.InitializeSupportedStyleSet=function(){t._supportedStyleSet=P.StyleReader.getStyleSetFromActivePage()},t.ConvertRgbToBgr=function(e){var t=y.l.substring(e,0,2),n=y.l.substring(e,2,4);return y.l.substring(e,4,6)+n+t},t.ParseCssValue=function(e,t){var n=0;t.val=0;var i=e.length,r=y.l.substring(e,0,i-2);n=parseFloat(r);var o=y.l.substr(e,i-2,2);switch(o){case"in":t.val=3;break;case"px":t.val=7;break;case"cm":t.val=1;break;case"pt":t.val=5;break;default:p.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",o),n=0}return n},t.ConvertToTwips=function(e,t){var n=0;switch(t){case 3:n=C.r.inchesToTwips(e);break;case 7:n=f.j.pixelsToTwips(e,0);break;case 1:n=C.r.centimetersToTwips(e);break;case 5:var i=C.r.pointsToInches(e);n=C.r.inchesToTwips(i);break;default:p.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",e,t)}return n},t._paragraphEditor=null,t._hyperlinkEditor=null,t._trackChangeManager=null,t.ParagraphStyleStrings=new Array(8),t.ListStyleMap={},t._supportedStyleSet=null,t._listSettings=null,t}(c.a);(0,B.l)(O,"1b76455d$Box4PasteSteward",c.a,[])},1719:function(e,t,n){"use strict";n.d(t,{b:function(){return c}});var i=n(1817),r=n(9233),o=n(9375),a=n(8548),l=n(7275),s=n(8399),u=n(4115),c=function(e){function t(t,n,i,r,o,a){var l=e.call(this,t,n,i,r,a)||this;return l._characterPropertiesEditor$1=null,l._correctWord=null,l._correctWord=o,l._characterPropertiesEditor$1=a,l}return(0,i.t)(t,e),t.prototype.get_isGraphOnlyOperation=function(){return t._isGraphOnlyOperation},t.prototype.set_isGraphOnlyOperation=function(e){return t._isGraphOnlyOperation=e,e},t.prototype.get_commandId=function(){return o.u.autoCorrectStringReplace},t.prototype.validateAction=function(){return this._lastValidateResultIsMatchTextSame=this.checkMatchTextIsTheSame(),this._lastValidateResultIsMatchTextSame||(this._lastValidateResultIsValid=!1,this._invalidReason="MatchTextIsNotTheSame"),this._lastValidateResultIsValid},t.prototype.doHtmlCorrection=function(e){e.innerText=a.l.substring(e.innerText,0,this.get_matchStartIndex())+this._correctWord+a.l.right(e.innerText,this.get_matchEndIndex())},t.prototype.doGraphCorrection=function(e){this._characterPropertiesEditor$1.replaceTextRange(l.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchEndIndex()),this._correctWord,!0,!1)},t.CreateHtmlCorrectionAction=function(e,n,i,r,o){var a=s.j.getOwner(e);return new t(e,a?a.get_sourceNode():null,n,i,r,o)},t.CreateGraphCorrectionAction=function(e,n,i,r,o){return new t(null,e,n,i,r,o)},t._isGraphOnlyOperation=!1,t}(r.z);(0,u.l)(c,"20a241f1$StringReplaceCorrectAction",r.z,[])},1842:function(e,t,n){"use strict";n.d(t,{u:function(){return i}});var i=(0,n(4115).y)("483147c3$IMacOfficeOffer")},1882:function(__unusedmodule,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{d:function(){return AutoCorrectRules}});var _TextElements_IHyperlinkEditor__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7057),_AutoCorrect_IAutoCorrectRules__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(947),_lib_ScriptCore_DOMElementType__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1577),_browsertelemetry_diagnostics_core_ULS__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2927),_external_Box4_Commands__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9375),_msoserviceplatform_src_Browser_App_Scripts_AFrameworkApplication__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(3116),_msoserviceplatform_src_Browser_App_Scripts_Input_KeyCode__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6216),_msoserviceplatform_src_Browser_App_Scripts_Performance_PerfMetrics__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1549),_msoserviceplatform_src_Browser_App_Scripts_scriptsharp_CultureInfo__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(7560),_msoserviceplatform_src_CrossCompiled_Container_Container__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(6325),_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(8548),_Box4Path__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(7928),_AutoCorrectListFallback__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(7543),_BulletListAction__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(9485),_DashAction__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(5187),_EmojiAction__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(1061),_FirstLetterUpperCaseRules__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(9868),_FractionsCollection__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(124),_FractionsReplaceCorrectAction__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(4696),_LetterListAction__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(7629),_NumberListAction__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(7953),_OrdinalsReplaceCorrectAction__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(9676),_RandAction__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(3337),_RegexAutoCorrectEntry__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(4274),_RomanListAction__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(937),_SmartQuoteCorrectAction__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(4921),_StringReplaceCorrectAction__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(1719),_UpperFirstLetterAutoCorrect__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(8207),_ValidateOrdinalsRule__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(4664),_Selection_SelectionEditor__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(4841),_Selection_SelectionFactory__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(6596),_TextElements_HyperlinkReader__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(274),_TextElements_ParagraphReader__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(3910),_CrossCompiled_Core_AppFeaturesLookup__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(2442),_CrossCompiled_GraphEditors_BuildScriptSharp_Text_FormattingReader__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(3371),_lib_MicrosoftAjaxShim__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(4115),AutoCorrectRules=function(){function AutoCorrectRules(e,t,n,i,r,o,a){this._hyperlinkActionFactory=null,this._characterPropertiesEditor=null,this._lockedRangeEditor=null,this._actionManager=null,this._emoticonAutoCorrectIsEnabled=!1,this._replaceQuoteWithSmartQuoteIsEnabled=!1,this._hyperlinkUrlValidationIsEnabled=!1,this._autoCorrectOptionsInfo=null,this._trackChangeReader=null,this._regexEntries=[],this._autoCorrectLists=[],this._autoCorrectExceptions=[],this._autoCorrectListLoaded=[],this._incomingListLcid=-1,this._hyperlinkActionFactory=e,this._characterPropertiesEditor=t,this._lockedRangeEditor=n,this._actionManager=i,this._autoCorrectOptionsInfo=o,this._trackChangeReader=a,r?(this._emoticonAutoCorrectIsEnabled=r.getBooleanAppSetting("WordEditorEmoticonAutoCorrectIsEnabled")||r.getBooleanAppSetting("OneNoteInsertEmojiIsEnabled"),this._replaceQuoteWithSmartQuoteIsEnabled=r.getBooleanAppSetting("ReplaceQuoteWithSmartQuoteIsEnabled"),this._hyperlinkUrlValidationIsEnabled=r.getBooleanAppSetting("HyperlinkUrlValidationIsEnabled"),_browsertelemetry_diagnostics_core_ULS__WEBPACK_IMPORTED_MODULE_3__.ULS.sendTraceTag(23418953,324,50,"{0}",{WordEditorEmoticonAutoCorrectIsEnabled:this._emoticonAutoCorrectIsEnabled,ReplaceQuoteWithSmartQuoteIsEnabled:this._replaceQuoteWithSmartQuoteIsEnabled})):(_browsertelemetry_diagnostics_core_ULS__WEBPACK_IMPORTED_MODULE_3__.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this._emoticonAutoCorrectIsEnabled=!1,this._replaceQuoteWithSmartQuoteIsEnabled=!1)}return AutoCorrectRules.prototype.IsDelimiter=function(e){return AutoCorrectRules.AutoCorrectDelimiters.indexOf(e)>=0},AutoCorrectRules.prototype.isTrigger=function(e){return AutoCorrectRules.AutoCorrectTiggers.indexOf(e)>=0},AutoCorrectRules.prototype.IsLowerCase=function(e){return e.toLowerCase()===e},AutoCorrectRules.prototype.IsUpperCase=function(e){return e.toUpperCase()===e},AutoCorrectRules.prototype.IsAlpha=function(e){return e.toLowerCase()!==e.toUpperCase()},AutoCorrectRules.prototype.IsFirstLetterNeedUpper=function(e,t,n,i){return new _FirstLetterUpperCaseRules__WEBPACK_IMPORTED_MODULE_16__.y(e,t,n,i).checkCurrentWordWithAutoCorrectConditions()},AutoCorrectRules.prototype.GetCultureOfElement=function(e){do{if(e.getAttribute("xml:lang"))return _msoserviceplatform_src_Browser_App_Scripts_scriptsharp_CultureInfo__WEBPACK_IMPORTED_MODULE_8__.i.getCultureInfo(e.getAttribute("xml:lang"))||_msoserviceplatform_src_Browser_App_Scripts_scriptsharp_CultureInfo__WEBPACK_IMPORTED_MODULE_8__.i.get_invariantCulture();if(e.getAttribute("lang"))return _msoserviceplatform_src_Browser_App_Scripts_scriptsharp_CultureInfo__WEBPACK_IMPORTED_MODULE_8__.i.getCultureInfo(e.getAttribute("lang"))||_msoserviceplatform_src_Browser_App_Scripts_scriptsharp_CultureInfo__WEBPACK_IMPORTED_MODULE_8__.i.get_invariantCulture();e=e.parentNode}while(e&&e.nodeType===_lib_ScriptCore_DOMElementType__WEBPACK_IMPORTED_MODULE_2__.o.element);return _msoserviceplatform_src_Browser_App_Scripts_scriptsharp_CultureInfo__WEBPACK_IMPORTED_MODULE_8__.i.get_invariantCulture()},AutoCorrectRules.prototype.GetCultureOfContext=function(e){return _msoserviceplatform_src_Browser_App_Scripts_scriptsharp_CultureInfo__WEBPACK_IMPORTED_MODULE_8__.i.getCultureInfo(_CrossCompiled_GraphEditors_BuildScriptSharp_Text_FormattingReader__WEBPACK_IMPORTED_MODULE_34__.FormattingReader.language(_CrossCompiled_GraphEditors_BuildScriptSharp_Text_FormattingReader__WEBPACK_IMPORTED_MODULE_34__.FormattingReader.getFormattingObject(e)))||_msoserviceplatform_src_Browser_App_Scripts_scriptsharp_CultureInfo__WEBPACK_IMPORTED_MODULE_8__.i.get_invariantCulture()},AutoCorrectRules.prototype.FindLastIndexOfDelimiter=function(e,t){t<0&&(t=0);for(var n=-1,i=AutoCorrectRules.AutoCorrectDelimiters.length,r=0;r<i;++r){var o=e.lastIndexOf(_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.charAt(AutoCorrectRules.AutoCorrectDelimiters,r),t);o>n&&(n=o)}var a=_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.lastIndexOfWhiteSpace(e,t);return a>n&&(n=a),n},AutoCorrectRules.prototype.FindFirstAlphaChar=function(e){for(var t=0;t<e.length;++t)if(this.IsAlpha(_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.charAt(e,t)))return t;return-1},AutoCorrectRules.prototype.FindWordStartIndexAtCp=function(e,t){if(!e||t<0)return-1;var n=t;return n=(n=n?this.FindLastIndexOfDelimiter(e,n-1):-1)>_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.lastIndexOfWhiteSpace(e,t-1)?n:_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.lastIndexOfWhiteSpace(e,t-1),++n},AutoCorrectRules.prototype.FindStringMatch=function(e,t,n){if(!_CrossCompiled_Core_AppFeaturesLookup__WEBPACK_IMPORTED_MODULE_33__.n.get_instance().get_item(70))return null;if(this.ensureAutoCorrectListLoaded(t),!this._autoCorrectLists[t]){var i=_AutoCorrectListFallback__WEBPACK_IMPORTED_MODULE_12__.j.GetFallbackLcid(t);if(!(i>0))return null;if(this.ensureAutoCorrectListLoaded(i),!this._autoCorrectLists[i])return null;t=i}if(n){var r=e;if(r+=n,this._autoCorrectExceptions[t]&&Array.contains(this._autoCorrectExceptions[t],r))return null}var o=this._autoCorrectLists[t][_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.toLower(e)];if("string"!=typeof o)return null;var a=o;if(a===e)return null;if(a){var l=this.FindFirstAlphaChar(e);if(l<0)return a;var s=_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.charAt(e,l);if(this.IsLowerCase(s))return a;for(var u=!0,c=l+1;c<e.length;++c){var d=_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.charAt(e,c);u&&!this.IsUpperCase(d)&&(u=!1)}return u?_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.toUpper(a):_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.toUpper(_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.substring(a,0,1))+_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.right(a,1)}return null},AutoCorrectRules.prototype.findHtmlAutoCorrectMatch=function(e,t,n,i){_msoserviceplatform_src_Browser_App_Scripts_Performance_PerfMetrics__WEBPACK_IMPORTED_MODULE_7__.t.mark(4666);var r=this.GetCultureOfElement(t).get_LCID(),o=0,a=e,l=t.innerText,s=l.lastIndexOf(" ",e);if(this.IsExemption(l.substring(s+1,e)))return _msoserviceplatform_src_Browser_App_Scripts_Performance_PerfMetrics__WEBPACK_IMPORTED_MODULE_7__.t.mark(4667),null;var u=null,c=!1;do{if(-1===(a=a?this.FindLastIndexOfDelimiter(l,a-1):-1)&&!n){var d=t,g=null;if(!this.IsDelimiter(l.charAt(0))){do{for(;d&&!d.previousSibling;)d=d.parentNode;d&&(g=(d=d.previousSibling).innerText)}while(d&&!g);if(d&&g&&!this.IsDelimiter(_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.charAt(g,g.length-1)))return _msoserviceplatform_src_Browser_App_Scripts_Performance_PerfMetrics__WEBPACK_IMPORTED_MODULE_7__.t.mark(4667),null}c=!0}var p=_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.substring(l,a+1,e);++o;var h=this.FindStringMatch(p,r,i.toString());if(h)u=_StringReplaceCorrectAction__WEBPACK_IMPORTED_MODULE_26__.b.CreateHtmlCorrectionAction(t,a+1,e,h,this._characterPropertiesEditor);else for(var _=0;_<this._regexEntries.length;++_){var m=this._regexEntries[_];if((!(1&m.Flags)||n&&a<1)&&!(4&m.Flags)&&(!(2&m.Flags)||" "===i)){var f=m.Pattern.exec(p);if(f){u=m.HtmlFactoryMethod(t,a+1,e,f,this._characterPropertiesEditor,this._actionManager);break}}}}while(!c&&!u&&o<AutoCorrectRules.MaxAutoCorrectEntryDelimiterCount&&a>=0);return _msoserviceplatform_src_Browser_App_Scripts_Performance_PerfMetrics__WEBPACK_IMPORTED_MODULE_7__.t.mark(4667),u},AutoCorrectRules.prototype.findGraphFirstWordToUpper=function(e,t,n,i){var r=e.get_node(),o=_TextElements_ParagraphReader__WEBPACK_IMPORTED_MODULE_32__.ParagraphReader.text(r);t<0&&(t=e.get_cpBegin());var a=this.GetCultureOfContext(e).get_LCID();if(n&&!this.IsDelimiter(_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.charAt(o,t)))return null;var l=_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.lastIndexOfWhiteSpace(o,t);if(this.IsExemption(o.substring(l+1,t)))return null;for(var s=-1,u=_TextElements_HyperlinkReader__WEBPACK_IMPORTED_MODULE_31__.HyperlinkReader.getHyperlinksInParagraph(r),c=0;c<u.length;c++){if(!(t>u[c].cpEnd)){if(t>u[c].cpBegin)return null;break}s=u[c].cpEnd}var d=null,g=t;(g=g?this.FindLastIndexOfDelimiter(o,g-1):-1)<s&&(g=s-1);var p=_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.substring(o,g+1,t);if(p=p.trimStart(),g<1)for(c=0;c<this._regexEntries.length;++c){var h=o;if(" "!==i&&(h=o+i),this._regexEntries[c].Pattern.exec(h))return null}return o=o.substring(0,t),this.IsFirstLetterNeedUpper(o,i.toString(),p,a)?(p.charAt(0).toUpperCase()!==p.charAt(0)&&(d=_UpperFirstLetterAutoCorrect__WEBPACK_IMPORTED_MODULE_27__.l.CreateGraphCorrectionAction(r,g+1,t,this._characterPropertiesEditor,this._lockedRangeEditor,_CrossCompiled_Core_AppFeaturesLookup__WEBPACK_IMPORTED_MODULE_33__.n.get_instance().get_item(14),this._trackChangeReader)),d):null},AutoCorrectRules.prototype.findGraphFirstLetterUpperAtEnd=function(e,t,n){var i=_Selection_SelectionFactory__WEBPACK_IMPORTED_MODULE_30__.SelectionFactory.createCollapsedSelection(e,!1);if(!i)return null;var r=i.get_lastContext();return _Selection_SelectionEditor__WEBPACK_IMPORTED_MODULE_29__.SelectionEditor.isInsertionPointContext(r)?this.findGraphFirstWordToUpper(r,t,!1,n):null},AutoCorrectRules.prototype.IsExemption=function(e){return _msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.isLinkable(e)},AutoCorrectRules.prototype.findGraphAutoCorrectMatch=function(e,t,n,i){_msoserviceplatform_src_Browser_App_Scripts_Performance_PerfMetrics__WEBPACK_IMPORTED_MODULE_7__.t.mark(4666);var r=e.get_node(),o=this.GetCultureOfContext(e).get_LCID(),a=_TextElements_ParagraphReader__WEBPACK_IMPORTED_MODULE_32__.ParagraphReader.text(r);if(t<0&&(t=e.get_cpBegin()),n&&!this.IsDelimiter(_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.charAt(a,t)))return _msoserviceplatform_src_Browser_App_Scripts_Performance_PerfMetrics__WEBPACK_IMPORTED_MODULE_7__.t.mark(4667),null;var l=_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.lastIndexOfWhiteSpace(a,t);if(this.IsExemption(a.substring(l+1,t)))return _msoserviceplatform_src_Browser_App_Scripts_Performance_PerfMetrics__WEBPACK_IMPORTED_MODULE_7__.t.mark(4667),null;for(var s=-1,u=_TextElements_HyperlinkReader__WEBPACK_IMPORTED_MODULE_31__.HyperlinkReader.getHyperlinksInParagraph(r),c=0;c<u.length;c++){if(!(t>u[c].cpEnd)){if(t>u[c].cpBegin)return null;break}s=u[c].cpEnd}var d=0,g=t,p=null;do{(g=g?this.FindLastIndexOfDelimiter(a,g-1):-1)<s&&(g=s-1);var h=_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.substring(a,g+1,t);++d;var _=this.FindStringMatch(h,o,null);if(_)this._autoCorrectOptionsInfo.get_replaceTextAsYouType()&&(p=_StringReplaceCorrectAction__WEBPACK_IMPORTED_MODULE_26__.b.CreateGraphCorrectionAction(r,g+1,t,_,this._characterPropertiesEditor));else for(c=0;c<this._regexEntries.length;++c){var m=this._regexEntries[c];if(!(1&m.Flags&&!(g<1)||4&m.Flags&&i!==_msoserviceplatform_src_Browser_App_Scripts_Input_KeyCode__WEBPACK_IMPORTED_MODULE_6__.v.vK_Enter||2&m.Flags&&i!==_msoserviceplatform_src_Browser_App_Scripts_Input_KeyCode__WEBPACK_IMPORTED_MODULE_6__.v.vK_Space)){var f=m.Pattern.exec(h);if(f){((p=m.GraphFactoryMethod(r,g+1,t,f,this._characterPropertiesEditor,this._actionManager)).get_commandId()!==_external_Box4_Commands__WEBPACK_IMPORTED_MODULE_4__.u.autoCorrectDash&&!this._autoCorrectOptionsInfo.get_replaceTextAsYouType()||p.get_commandId()===_external_Box4_Commands__WEBPACK_IMPORTED_MODULE_4__.u.autoCorrectDash&&!this._autoCorrectOptionsInfo.get_replaceHyphensWithDash())&&(p=null);break}}}}while(g>=0&&g>=s&&!p&&d<AutoCorrectRules.MaxAutoCorrectEntryDelimiterCount);return _msoserviceplatform_src_Browser_App_Scripts_Performance_PerfMetrics__WEBPACK_IMPORTED_MODULE_7__.t.mark(4667),p},AutoCorrectRules.prototype.findGraphAutoCorrectMatchAtEnd=function(e,t,n){var i=_Selection_SelectionFactory__WEBPACK_IMPORTED_MODULE_30__.SelectionFactory.createCollapsedSelection(e,!1);if(!i)return null;var r=i.get_lastContext();return _Selection_SelectionEditor__WEBPACK_IMPORTED_MODULE_29__.SelectionEditor.isInsertionPointContext(r)?this.findGraphAutoCorrectMatch(r,t,!1,n):null},AutoCorrectRules.prototype.findLinkAutoCorrectMatchAtIdx=function(e,t){var n=_Selection_SelectionFactory__WEBPACK_IMPORTED_MODULE_30__.SelectionFactory.createCollapsedSelection(e,!1);if(!n)return null;var i=n.get_lastContext();if(!_Selection_SelectionEditor__WEBPACK_IMPORTED_MODULE_29__.SelectionEditor.isInsertionPointContext(i))return null;if(_TextElements_HyperlinkReader__WEBPACK_IMPORTED_MODULE_31__.HyperlinkReader.isIpInHyperlink(i,!1))return null;var r=_TextElements_ParagraphReader__WEBPACK_IMPORTED_MODULE_32__.ParagraphReader.text(i.get_node()),o=t>0?_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.lastIndexOfWhiteSpace(r,t-1)+1:_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.lastIndexOfWhiteSpace(r,r.length-1)+1,a=t>0?t:r.length,l=_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.substring(r,o,a);return l?this._hyperlinkUrlValidationIsEnabled&&!_TextElements_HyperlinkReader__WEBPACK_IMPORTED_MODULE_31__.HyperlinkReader.isValidUrl(l)?null:(_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.isLinkable(l)||_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.isEmail(l))&&AutoCorrectRules.get_HyperlinkEditor().removeOverlappingHyperlink(i,o,a)?this._hyperlinkActionFactory.createHyperlinkAction(null,i.get_node(),o,a):null:null},AutoCorrectRules.prototype.findOrdinalNumberAutoCorrectAction=function(e,t){var n=_Selection_SelectionFactory__WEBPACK_IMPORTED_MODULE_30__.SelectionFactory.createCollapsedSelection(e,!1);if(!n)return null;var i=n.get_lastContext();if(!_Selection_SelectionEditor__WEBPACK_IMPORTED_MODULE_29__.SelectionEditor.isInsertionPointContext(i))return null;t<0&&(t=i.get_cpBegin());for(var r=_TextElements_ParagraphReader__WEBPACK_IMPORTED_MODULE_32__.ParagraphReader.text(i.get_node()),o=this.FindWordStartIndexAtCp(r,t),a=AutoCorrectRules.AutoCorrectTiggers.length,l=0;l<a;++l){var s=r.lastIndexOf(_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.charAt(AutoCorrectRules.AutoCorrectTiggers,l),t-1);s>o&&(o=s+1)}var u=_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.substring(r,o,t);if(!u)return null;var c=this.GetCultureOfContext(i).get_LCID();return new _ValidateOrdinalsRule__WEBPACK_IMPORTED_MODULE_28__.g(u,c).isOrdinalNumber()?_OrdinalsReplaceCorrectAction__WEBPACK_IMPORTED_MODULE_21__.u.CreateGraphCorrectionAction(e,o,t,this._characterPropertiesEditor):null},AutoCorrectRules.prototype.findFractionsAutoCorrectAction=function(e,t){var n=_Selection_SelectionFactory__WEBPACK_IMPORTED_MODULE_30__.SelectionFactory.createCollapsedSelection(e,!1);if(!n)return null;var i=n.get_lastContext();if(!_Selection_SelectionEditor__WEBPACK_IMPORTED_MODULE_29__.SelectionEditor.isInsertionPointContext(i))return null;t<0&&(t=i.get_cpBegin());var r=_TextElements_ParagraphReader__WEBPACK_IMPORTED_MODULE_32__.ParagraphReader.text(i.get_node()),o=this.FindWordStartIndexAtCp(r,t),a=_msoserviceplatform_src_CrossCompiled_Utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__.l.substring(r,o,t);if(!a)return null;var l=new _FractionsCollection__WEBPACK_IMPORTED_MODULE_17__.g(a).fractionsAutoFormatedData();return l?_FractionsReplaceCorrectAction__WEBPACK_IMPORTED_MODULE_18__.z.CreateGraphCorrectionAction(e,o,t,l,this._characterPropertiesEditor):null},AutoCorrectRules.prototype.findSmartQuoteAutoCorrectAction=function(e,t,n,i,r){var o=_Selection_SelectionFactory__WEBPACK_IMPORTED_MODULE_30__.SelectionFactory.createCollapsedSelection(e,!1);if(!o)return null;var a=o.get_lastContext();if(n>t)return null;if(!_Selection_SelectionEditor__WEBPACK_IMPORTED_MODULE_29__.SelectionEditor.isInsertionPointContext(a))return null;if(t<0&&(t=a.get_cpBegin()),t<0)return null;var l=_TextElements_ParagraphReader__WEBPACK_IMPORTED_MODULE_32__.ParagraphReader.text(a.get_node()),s=r,u=t?l.charAt(t-1):"\0";return _SmartQuoteCorrectAction__WEBPACK_IMPORTED_MODULE_25__.l.CreateGraphCorrectionAction(e,n,s,u,this._characterPropertiesEditor,i)},AutoCorrectRules.prototype.addRegexPatternEntry=function(e,t,n,i){Array.add(this._regexEntries,new _RegexAutoCorrectEntry__WEBPACK_IMPORTED_MODULE_23__.m("^"+e+"$",t,n,i))},AutoCorrectRules.prototype.mergeAutoCorrectLists=function(e){if(this._autoCorrectLists[this._incomingListLcid]){var t=this._autoCorrectLists[this._incomingListLcid];for(var n in e){var i={key:n,value:e[n]};t[i.key]=i.value}}else this._autoCorrectLists[this._incomingListLcid]=e},AutoCorrectRules.prototype.mergeExceptions=function(e){this._autoCorrectExceptions[this._incomingListLcid]?Array.addRange(this._autoCorrectExceptions[this._incomingListLcid],e):this._autoCorrectExceptions[this._incomingListLcid]=e},AutoCorrectRules.prototype.LoadAutoCorrectList=function(listUri,lcid){var _this=this;this._autoCorrectListLoaded[lcid]||(this._autoCorrectListLoaded[lcid]=!0,_msoserviceplatform_src_Browser_App_Scripts_AFrameworkApplication__WEBPACK_IMPORTED_MODULE_5__.AFrameworkApplication.theClientRequestManager.addRequest(listUri,1,null,null,!1,3,(function(e){_this._incomingListLcid=lcid;try{eval(e.get_data().responseData)}catch(t){_browsertelemetry_diagnostics_core_ULS__WEBPACK_IMPORTED_MODULE_3__.ULS.sendTraceTag(5898336,324,50,"Failed to parse autocorrect: {0}",{ResponseData:e.get_data()?e.get_data().responseData:""})}_this._incomingListLcid=-1}),(function(){_this.EnsureFallbackAutoCorrectListLoaded(lcid)}),null,void 0,void 0,void 0,void 0,"27"))},AutoCorrectRules.prototype.EnsureFallbackAutoCorrectListLoaded=function(e){var t=_AutoCorrectListFallback__WEBPACK_IMPORTED_MODULE_12__.j.GetFallbackLcid(e);t>0&&this.ensureAutoCorrectListLoaded(t)},AutoCorrectRules.prototype.loadDefaultAutoCorrectList=function(){_CrossCompiled_Core_AppFeaturesLookup__WEBPACK_IMPORTED_MODULE_33__.n.get_instance().get_item(70)&&(this.ensureAutoCorrectListLoaded(1033),this.addRegexPatternEntry("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",_RandAction__WEBPACK_IMPORTED_MODULE_22__.n.CreateHtmlCorrectionAction,_RandAction__WEBPACK_IMPORTED_MODULE_22__.n.CreateGraphCorrectionAction,5),this.addRegexPatternEntry("(\\d+)\\.",_NumberListAction__WEBPACK_IMPORTED_MODULE_20__.r.CreateHtmlCorrectionAction,_NumberListAction__WEBPACK_IMPORTED_MODULE_20__.r.CreateGraphCorrectionAction,3),this.addRegexPatternEntry("(L|l|C|c|D|d|M|m){1}\\.",_LetterListAction__WEBPACK_IMPORTED_MODULE_19__.l.CreateHtmlCorrectionAction,_LetterListAction__WEBPACK_IMPORTED_MODULE_19__.l.CreateGraphCorrectionAction,3),this.addRegexPatternEntry("^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})\\.",_RomanListAction__WEBPACK_IMPORTED_MODULE_24__.z.CreateHtmlCorrectionAction,_RomanListAction__WEBPACK_IMPORTED_MODULE_24__.z.CreateGraphCorrectionAction,11),this.addRegexPatternEntry("([A-Za-z]){1}\\.",_LetterListAction__WEBPACK_IMPORTED_MODULE_19__.l.CreateHtmlCorrectionAction,_LetterListAction__WEBPACK_IMPORTED_MODULE_19__.l.CreateGraphCorrectionAction,3),this.addRegexPatternEntry("[\\*|-]",_BulletListAction__WEBPACK_IMPORTED_MODULE_13__.p.CreateHtmlCorrectionAction,_BulletListAction__WEBPACK_IMPORTED_MODULE_13__.p.CreateGraphCorrectionAction,3),this.addRegexPatternEntry("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",_DashAction__WEBPACK_IMPORTED_MODULE_14__.e.createHtmlCorrectionAction,_DashAction__WEBPACK_IMPORTED_MODULE_14__.e.createGraphCorrectionAction,0),this._emoticonAutoCorrectIsEnabled&&(this.addRegexPatternEntry("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",_EmojiAction__WEBPACK_IMPORTED_MODULE_15__.h.createHtmlCorrectionAction,_EmojiAction__WEBPACK_IMPORTED_MODULE_15__.h.createGraphCorrectionAction,0),this.addRegexPatternEntry("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",_EmojiAction__WEBPACK_IMPORTED_MODULE_15__.h.createHtmlCorrectionAction,_EmojiAction__WEBPACK_IMPORTED_MODULE_15__.h.createGraphCorrectionAction,0)))},AutoCorrectRules.prototype.ensureAutoCorrectListLoaded=function(e){this._autoCorrectListLoaded[e]||this.LoadAutoCorrectList(_Box4Path__WEBPACK_IMPORTED_MODULE_11__.f.box4Script(String.format("Acl/Acl{0}.js",e)),e)},AutoCorrectRules.get_HyperlinkEditor=function(){return AutoCorrectRules._hyperlinkEditor||(AutoCorrectRules._hyperlinkEditor=_msoserviceplatform_src_CrossCompiled_Container_Container__WEBPACK_IMPORTED_MODULE_9__.w.get_instance().resolve(_TextElements_IHyperlinkEditor__WEBPACK_IMPORTED_MODULE_0__.o))},AutoCorrectRules.AutoCorrectDelimiters=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\xa9\xae\u2122\ufffc\uc2a0\u2013\u2014",AutoCorrectRules.AutoCorrectTiggers=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\xa9\xae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'",AutoCorrectRules.SentenceDelimiters=".!?",AutoCorrectRules.MaxAutoCorrectEntryDelimiterCount=5,AutoCorrectRules._hyperlinkEditor=null,AutoCorrectRules}();(0,_lib_MicrosoftAjaxShim__WEBPACK_IMPORTED_MODULE_35__.l)(AutoCorrectRules,"ad8f7724$AutoCorrectRules",null,[_AutoCorrect_IAutoCorrectRules__WEBPACK_IMPORTED_MODULE_1__.r])},2057:function(e,t,n){"use strict";n.d(t,{n:function(){return i}});var i=(0,n(4115).y)("542852eb$IBox4PasteStewardBridge")},2071:function(e,t,n){"use strict";var i=n(4115),r=(0,i.y)("10caff25$IOICErrorDialogFactory"),o=n(1817),a=n(1842),l=n(2927),s=n(3116),u=n(5645),c=n(9847),d=n(6325),g=function(){function e(e,t,n,i){this._dialogCause=0,this._onLaunchDownload=null,this._onDialogDismissed=null,this._callbackData=null,this._shouldOfferMacOfficeTrial=!1,this._macOfficeOffer=null,this.macOfficePreLinkText=null,this.macOfficePostLinkText=null,this._dialogCause=i,this._onDialogDismissed=e,this._onLaunchDownload=t,this._callbackData=n,this._shouldOfferMacOfficeTrial=this.get_MacOfficeOffer().get_shouldOfferMacOfficeTrialInErrorDialog();var r=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.macOfficePreLinkText=r[0],this.macOfficePostLinkText=r[1]}return e.prototype.get_MacOfficeOffer=function(){return this._macOfficeOffer||(this._macOfficeOffer=d.w.get_instance().resolve(a.u))},e.prototype.get_id=function(){return"OICErrorDialog"},e.prototype.get_errorMessage=function(){return CommonUIStrings.l_OICErrorMessage},e.prototype.get_helpLinkText=function(){return CommonUIStrings.l_OICErrorHelpLink},e.prototype.get_shouldOfferMacOfficeTrial=function(){return this._shouldOfferMacOfficeTrial},e.prototype.get_macOfficePreLinkText=function(){return this.macOfficePreLinkText},e.prototype.get_macOfficePostLinkText=function(){return this.macOfficePostLinkText},e.prototype.get_macOfficeLinkText=function(){return CommonUIStrings.l_OICErrorMacOFficeLink},e.prototype.get_icon=function(){return this._shouldOfferMacOfficeTrial?3:2},e.prototype.get_errorFileDownloadOffer=function(){return CommonUIStrings.l_OICErrorFileDownloadOffer},e.prototype.get_containsOnLaunchDownload=function(){return!!this._onLaunchDownload},e.prototype.get_errorNoOfficeDownloadButtonText=function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton},e.prototype.get_dialogTitle=function(){return CommonUIStrings.l_DefaultDialogTitle},e.prototype.reactOICErrorDialogHandler=function(e,t){this.OICErrorDialogHandler(e)},e.prototype.legacyOICErrorDialogHandler=function(e,t){this.OICErrorDialogHandler(e)},e.prototype.OICErrorDialogHandler=function(e){var t=10;this._onLaunchDownload&&1===e&&(this._onLaunchDownload(this._callbackData),t=1),this._onDialogDismissed&&this._onDialogDismissed(this._callbackData),this.ReportError(t)},e.prototype.oicErrorHelpLinkHandler=function(e){c.Redirect.showHelp("OICFailure"),this.ReportError(2)},e.prototype.oicErrorMacOfferLinkHandler=function(e){this.get_MacOfficeOffer().launchMacOfficeTrialWindow(),this.ReportError(4)},e.prototype.ReportError=function(e){l.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this._dialogCause,e),s.AFrameworkApplication.reportErrorWithCauseAndResolution(u.p.openInClientFailed,this._dialogCause,e)},e.prototype.dispose=function(){this._onLaunchDownload=null,this._onDialogDismissed=null,this._callbackData=null},e}();(0,i.l)(g,"9e140e59$AOICErrorDialog",null,[Sys.IDisposable]);var p=n(7503),h=n(6121),_=function(e){function t(n,r,o,a){var l=this;l._helpLink=null,l._macOfferLink=null,l=e.call(this,n,r,o,a)||this;var s=document.createElement("span");s.id=t._dialogContentId,s.innerText=l.get_errorMessage(),c.Redirect.isHelpAvailable()&&(s.appendChild(document.createElement("br")),s.appendChild(document.createElement("br")),l._helpLink=document.createElement("a"),l._helpLink.href="#",l._helpLink.innerText=l.get_helpLinkText(),s.appendChild(l._helpLink),p.n.addHandler(l._helpLink,"click",i.i(l,l.oicErrorHelpLinkHandler,"oicErrorHelpLinkHandler")));var u=new h.StandardDialog;if(u.set_dialogId(l.get_id()),l.get_shouldOfferMacOfficeTrial()){var d=document.createElement("span"),g=document.createElement("span");d.innerText=l.get_macOfficePreLinkText(),g.innerText=l.get_macOfficePostLinkText(),l._macOfferLink=document.createElement("a"),l._macOfferLink.href="#",l._macOfferLink.innerText=l.get_macOfficeLinkText(),s.appendChild(document.createElement("br")),s.appendChild(d),s.appendChild(l._macOfferLink),s.appendChild(g),p.n.addHandler(l._macOfferLink,"click",i.i(l,l.oicErrorMacOfferLinkHandler,"oicErrorMacOfferLinkHandler"))}else if(l.get_containsOnLaunchDownload()){s.appendChild(document.createElement("br")),s.appendChild(document.createElement("br"));var _=document.createElement("span");_.innerText=l.get_errorFileDownloadOffer(),s.appendChild(_)}return l.get_containsOnLaunchDownload()?(u.set_buttonsOption(1),u.setButtonText(1,l.get_errorNoOfficeDownloadButtonText())):u.set_buttonsOption(0),u.messageBox(l.get_dialogTitle(),null,l.get_icon(),i.i(l,l.legacyOICErrorDialogHandler,"legacyOICErrorDialogHandler"),s),u.setDescribedByForDialog(t._dialogContentId),l}return(0,o.t)(t,e),t.prototype.dispose=function(){this._helpLink&&(p.n.removeHandler(this._helpLink,"click",i.i(this,this.oicErrorHelpLinkHandler,"oicErrorHelpLinkHandler")),this._helpLink=null),this._macOfferLink&&(p.n.removeHandler(this._macOfferLink,"click",i.i(this,this.oicErrorMacOfferLinkHandler,"oicErrorMacOfferLinkHandler")),this._macOfferLink=null),e.prototype.dispose.call(this)},t._dialogContentId="errorMessageText",t}(g);(0,i.l)(_,"c020c078$OICErrorDialog",g,[]);var m=function(){function e(e,t,n){this._onDialogDismissed=null,this._onLaunchDownload=null,this._callbackData=null,this._onDialogDismissed=t,this._onLaunchDownload=e,this._callbackData=n}return e.prototype.get_id=function(){return"OICErrorDialogWithDownload"},e.prototype.get_errorMessageNoOfficeDetected=function(){return CommonUIStrings.l_OICErrorNoOfficeDetected},e.prototype.get_helpLinkText=function(){return CommonUIStrings.l_OICErrorHelpLink},e.prototype.get_errorFileDownloadOffer=function(){return CommonUIStrings.l_OICErrorFileDownloadOffer},e.prototype.get_errorNoOfficeDownloadButtonText=function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton},e.prototype.get_icon=function(){return 2},e.prototype.get_dialogTitle=function(){return CommonUIStrings.l_DefaultDialogTitle},e.prototype.reactOICErrorDialogHandler=function(e,t){this.OICErrorDialogHandler(e)},e.prototype.legacyOICErrorDialogHandler=function(e,t){this.OICErrorDialogHandler(e)},e.prototype.OICErrorDialogHandler=function(e){var t=10;1===e&&(this._onLaunchDownload(this._callbackData),t=1),this._onDialogDismissed&&this._onDialogDismissed(this._callbackData),this.ReportError(t)},e.prototype.oicErrorHelpLinkHandler=function(e){c.Redirect.showHelp("OICFailure"),this.ReportError(2)},e.prototype.ReportError=function(e){s.AFrameworkApplication.reportErrorWithCauseAndResolution(u.p.openInClientSecondaryFailed,3,e)},e.prototype.dispose=function(){this._onDialogDismissed=null,this._onLaunchDownload=null,this._callbackData=null},e}();(0,i.l)(m,"1faa1faf$AOICErrorDialogWithDownload",null,[Sys.IDisposable]);var f=function(e){function t(n,r,o){var a=e.call(this,n,r,o)||this;a._helpLink=null;var l=document.createElement("span");l.id=t._dialogContentId,l.innerText=a.get_errorMessageNoOfficeDetected(),c.Redirect.isHelpAvailable()&&(l.appendChild(document.createElement("br")),l.appendChild(document.createElement("br")),a._helpLink=document.createElement("a"),a._helpLink.href="#",a._helpLink.innerText=a.get_helpLinkText(),l.appendChild(a._helpLink),p.n.addHandler(a._helpLink,"click",i.i(a,a.oicErrorHelpLinkHandler,"oicErrorHelpLinkHandler"))),l.appendChild(document.createElement("br")),l.appendChild(document.createElement("br"));var s=document.createElement("span");s.innerText=a.get_errorFileDownloadOffer(),l.appendChild(s);var u=new h.StandardDialog;return u.set_dialogId(a.get_id()),u.set_buttonsOption(1),u.setButtonText(1,a.get_errorNoOfficeDownloadButtonText()),u.messageBox(a.get_dialogTitle(),null,a.get_icon(),i.i(a,a.legacyOICErrorDialogHandler,"legacyOICErrorDialogHandler"),l),u.setDescribedByForDialog(t._dialogContentId),a}return(0,o.t)(t,e),t.prototype.dispose=function(){this._helpLink&&(p.n.removeHandler(this._helpLink,"click",i.i(this,this.oicErrorHelpLinkHandler,"oicErrorHelpLinkHandler")),this._helpLink=null),e.prototype.dispose.call(this)},t._dialogContentId="errorMessageText",t}(m);(0,i.l)(f,"647a508e$OICErrorDialogWithDownload",m,[]);var y=n(6618),C=function(e){function t(t,n,r,o){var a=e.call(this,t,n,r,o)||this,l={errorMessage:a.get_errorMessage()};if(c.Redirect.isHelpAvailable()){l.helpLink={type:"AppLinkProps",id:"helpLink",text:a.get_helpLinkText(),handler:function(e){a.oicErrorHelpLinkHandler(e)}}}if(a.get_shouldOfferMacOfficeTrial()){l.macOfficePreLinkText=a.get_macOfficePreLinkText();l.macOfficeLink={type:"AppLinkProps",id:"macOfficeLink",text:a.get_macOfficeLinkText(),handler:function(e){a.oicErrorMacOfferLinkHandler(e)}},l.macOfficePostText=a.get_macOfficePostLinkText()}else a.get_containsOnLaunchDownload()&&(l.errorFileDownloadOffer=a.get_errorFileDownloadOffer());var s=new y.o(!1,!1,!0);a.get_containsOnLaunchDownload()?(s.set_buttonsOption(1),s.setButtonText(1,a.get_errorNoOfficeDownloadButtonText())):s.set_buttonsOption(0),s.set_dialogId(a.get_id());var u={id:a.get_id(),dialogIcon:a.get_icon(),bodyControls:l};return s.initializeAndShow(a.get_dialogTitle(),i.i(a,a.reactOICErrorDialogHandler,"reactOICErrorDialogHandler"),u),a}return(0,o.t)(t,e),t}(g);(0,i.l)(C,"afa1bd9$ReactOICErrorDialog",g,[]);var S=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this,a={errorMessage:o.get_errorMessageNoOfficeDetected(),errorFileDownloadOffer:o.get_errorFileDownloadOffer()};if(c.Redirect.isHelpAvailable()){a.helpLink={type:"AppLinkProps",id:"helpLink",text:o.get_helpLinkText(),handler:function(e){o.oicErrorHelpLinkHandler(e)}}}var l=new y.o(!1,!1,!0);l.set_buttonsOption(1),l.setButtonText(1,o.get_errorNoOfficeDownloadButtonText()),l.set_dialogId(o.get_id());var s={id:o.get_id(),dialogIcon:o.get_icon(),bodyControls:a};return l.initializeAndShow(o.get_dialogTitle(),i.i(o,o.reactOICErrorDialogHandler,"reactOICErrorDialogHandler"),s),o}return(0,o.t)(t,e),t}(m);(0,i.l)(S,"88fe94af$ReactOICErrorDialogWithDownload",m,[]),n.d(t,{p:function(){return b}});var b=function(){function e(){this._isReactDialogEnabled=!1,this._isReactDialogEnabled=!!s.AFrameworkApplication.get_activeFrame()&&s.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactDialogEnabled()}return e.prototype.createOICErrorDialog=function(e,t,n,i){return this._isReactDialogEnabled?new C(e,t,n,i):new _(e,t,n,i)},e.prototype.createOICErrorDialogWithDownload=function(e,t,n){return this._isReactDialogEnabled?new S(e,t,n):new f(e,t,n)},e.prototype.createOICErrorDialogWithTrial=function(e,t,i,r,o,a){return this._isReactDialogEnabled?new(n(6813).ReactOICErrorDialogWithTrial)(e,t,i,r,o,a):new(n(4028).OICErrorDialogWithTrial)(e,t,i,r,o,a)},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();(0,i.l)(b,"d4cc514c$OICErrorDialogFactory",null,[r])},2130:function(e,t,n){"use strict";var i=n(1817),r=n(4115),o=(0,r.y)("46adfcd0$IScalableViewerChromeItemContainer"),a=n(8901),l=n(4494);n.d(t,{m:function(){return s}});var s=function(e){function t(){var t=e.call(this)||this;return t._elementToTruncate=null,t}return(0,i.t)(t,e),t.prototype.hide=function(){this.get_elmContainer()&&(this._isVisible=!1,this.get_elmContainer().style.display="none")},t.prototype.undoScaling=function(){this._elementToTruncate&&(this._elementToTruncate.style.width="auto",this._elementToTruncate.style.maxWidth="none"),this.get_elmContainer()&&(this._isVisible=!0,this.get_elmContainer().style.display="inline-block")},t.prototype.truncateWidth=function(e){this._elementToTruncate&&(this._elementToTruncate.style.maxWidth=e+"px")},t}(l.x);(0,r.l)(s,"b6c392f9$ScalableViewerChromeItemContainer",l.x,[o,a.m])},2310:function(e,t,n){"use strict";n.r(t),n.d(t,{AudioPlaybackActor:function(){return _}});var i=n(4115),r=n(2927),o=n(7386),a=n(3116),l=n(6325),s=n(736),u=n(4670),c=n(8028),d=n(2280),g=n(5309),p=n(9369),h=n(6628),_=function(){function e(){this._attachedAudioNode=null}return e.prototype.get_IsAudioAttached=function(){return!!this._attachedAudioNode&&!!this._attachedAudioNode.audioElement},e.prototype.get_IsAttachedAudioSeekable=function(){return this.get_AttachedAudioElement().get_readyState()>0&&!this.get_AttachedAudioElement().get_error()},e.prototype.get_AttachedAudioElement=function(){return this._attachedAudioNode.audioElement},e.prototype.registerActions=function(e){var t=this;u.App.get_activeAppFrame().workspace.add_activePageChanged((function(e,n){t.unattachAudioPlaybackControls()})),e.addAction(o.u.seekMedia,d.d.view,i.i(this,this.SeekMedia,"SeekMedia")),e.addActionWithFlags(o.u.querySeekMedia,d.d.view,i.i(this,this.QuerySeekMedia,"QuerySeekMedia"),96),e.addAction(o.u.playMedia,d.d.embeddedFile,i.i(this,this.PlayEmbeddedMedia,"PlayEmbeddedMedia")),e.addAction(o.u.playMedia,d.d.floatingEmbeddedFile,i.i(this,this.PlayEmbeddedMedia,"PlayEmbeddedMedia")),e.addAction(o.u.playMedia,d.d.view,i.i(this,this.ResumeEmbeddedMedia,"ResumeEmbeddedMedia")),e.addAction(o.u.pauseMedia,d.d.embeddedFile,i.i(this,this.PauseEmbeddedMedia,"PauseEmbeddedMedia")),e.addAction(o.u.pauseMedia,d.d.floatingEmbeddedFile,i.i(this,this.PauseEmbeddedMedia,"PauseEmbeddedMedia")),e.addAction(o.u.pauseMedia,d.d.view,i.i(this,this.PauseEmbeddedMedia,"PauseEmbeddedMedia")),e.addAction(o.u.skipForwardOnMedia,d.d.embeddedFile,i.i(this,this.SkipForwardOnEmbeddedMedia,"SkipForwardOnEmbeddedMedia")),e.addAction(o.u.skipForwardOnMedia,d.d.floatingEmbeddedFile,i.i(this,this.SkipForwardOnEmbeddedMedia,"SkipForwardOnEmbeddedMedia")),e.addAction(o.u.skipForwardOnMedia,d.d.view,i.i(this,this.SkipForwardOnEmbeddedMedia,"SkipForwardOnEmbeddedMedia")),e.addAction(o.u.skipBackwardOnMedia,d.d.embeddedFile,i.i(this,this.SkipBackwardOnEmbeddedMedia,"SkipBackwardOnEmbeddedMedia")),e.addAction(o.u.skipBackwardOnMedia,d.d.floatingEmbeddedFile,i.i(this,this.SkipBackwardOnEmbeddedMedia,"SkipBackwardOnEmbeddedMedia")),e.addAction(o.u.skipBackwardOnMedia,d.d.view,i.i(this,this.SkipBackwardOnEmbeddedMedia,"SkipBackwardOnEmbeddedMedia"))},e.prototype.unattachAudioPlaybackControls=function(){this._attachedAudioNode=null},e.prototype.PlayEmbeddedMedia=function(e,t,n,i,o){if(c.EmbeddedFileReader.isEmbeddedFileOrFloatingEmbeddedFileContext(t)&&c.EmbeddedFileReader.isPlayableAudio(t.get_node())){var l=t.get_node();if(1===n)return!l.audioElement.get_paused()||this.get_IsAudioAttached()&&!this.get_AttachedAudioElement().get_paused()?8:32;if(2===n){if(this.get_IsAudioAttached()&&!this.get_AttachedAudioElement().get_error()&&this._attachedAudioNode!==l&&(this.get_AttachedAudioElement().pause(),this.get_AttachedAudioElement().set_currentTime(0)),this._attachedAudioNode=l,this.get_AttachedAudioElement().play(),o){var s=g.n.getOneNoteBox4BridgeCommandUi();a.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()||s.isRibbonMinimized((function(e){e&&s.ribbonToggleMinimizedState(2)})),s.ribbonActivateTab("ContextualTabs.Audio.Tools")}return r.ULS.sendTraceTag(8725076,339,50,"AudioPlayback:Play"),32}}return 8},e.prototype.PauseEmbeddedMedia=function(e,t,n,i,o){if(this.get_IsAudioAttached()){if(1===n)return this.get_AttachedAudioElement().get_paused()||this.get_AttachedAudioElement().get_error()?8:32;if(2===n)return this.get_AttachedAudioElement().pause(),r.ULS.sendTraceTag(8725077,339,50,"AudioPlayback:Pause"),32}return 8},e.prototype.SkipForwardOnEmbeddedMedia=function(t,n,i,o,a){if(this.get_IsAudioAttached()&&this.get_IsAttachedAudioSeekable()){if(1===i)return 32;if(2===i){var l=this.get_AttachedAudioElement().get_currentTime()+e.SkipAmountSeconds;return l>=this.get_AttachedAudioElement().get_duration()&&(l=0,this.get_AttachedAudioElement().pause()),this.get_AttachedAudioElement().set_currentTime(l),r.ULS.sendTraceTag(8725078,339,50,"AudioPlayback:SkipForward"),32}}return 8},e.prototype.SkipBackwardOnEmbeddedMedia=function(t,n,i,o,a){if(this.get_IsAudioAttached()&&this.get_IsAttachedAudioSeekable()){if(1===i)return 32;if(2===i)return this.get_AttachedAudioElement().set_currentTime(Math.max(this.get_AttachedAudioElement().get_currentTime()-e.SkipAmountSeconds,0)),r.ULS.sendTraceTag(8725079,339,50,"AudioPlayback:SkipBack"),32}return 8},e.prototype.SeekMedia=function(e,t,n,i,o){if(this.get_IsAudioAttached()&&this.get_IsAttachedAudioSeekable()){if(1===n)return 32;if(2===n){var a=o[s.u.Value];return this.get_AttachedAudioElement().set_currentTime(a),r.ULS.sendTraceTag(8725080,339,50,"AudioPlayback:Seek"),32}}return 8},e.prototype.QuerySeekMedia=function(t,n,i,r,o){if(1===i){if(this.get_IsAudioAttached()||h.c.get_isRecordingAudio())return 32}else if(2===i){var a=0,u=0,c="00:00 / 00:00",d=o;return this.get_IsAudioAttached()?(a=this.get_AttachedAudioElement().get_currentTime(),u=this.get_AttachedAudioElement().get_duration(),c=this.get_AttachedAudioElement().get_error()?OneNoteIntl.OneNoteStrings.L_FileUnplayable:e.FormatProgressString(a,u)):h.c.get_isRecordingAudio()&&(a=l.w.get_instance().resolve(p.h).get_recordingDuration(),u=l.w.get_instance().resolve(p.h).get_maxDuration(),c=e.FormatProgressString(a,u)),d[s.u.Value]=a,d[s.u.MaxValue]=u,d[s.u.Text]=c,32}return 8},e.prototype.ResumeEmbeddedMedia=function(e,t,n,i,o){var a="boolean"==typeof o&&o;if(this.get_IsAudioAttached()&&this.get_AttachedAudioElement().get_paused()&&!a){if(1===n)return 32;if(2===n)return this.get_AttachedAudioElement().play(),r.ULS.sendTraceTag(9217553,339,50,"AudioPlayback:Resume"),32}return 2},e.FormatProgressString=function(t,n){if(isNaN(n))return OneNoteIntl.OneNoteStrings.L_Loading;var i=e.GetTimeSpanStringFromSeconds(t),r=e.GetTimeSpanStringFromSeconds(n);return r.startsWith("00:")&&(i=i.substr(3),r=r.substr(3)),i+" / "+r},e.GetTimeSpanStringFromSeconds=function(e){var t=new Date(1e3*e);return t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),t.format("HH:mm:ss")},e.SkipAmountSeconds=15,e}();(0,i.l)(_,"5426fb6b$AudioPlaybackActor",null,[])},2743:function(e,t,n){"use strict";n.d(t,{m:function(){return i}});var i=(0,n(4115).y)("1a6d240e$ISemanticEventAcceptor")},3295:function(e,t,n){"use strict";n.d(t,{v:function(){return c}});var i=n(1817),r=n(8202),o=n(42),a=n(8548),l=n(3910),s=n(7275),u=n(4115),c=function(e){function t(n,i,r,a,l,s){var u=e.call(this,n,i,r,a,l,s)||this;return u._characterPropertiesEditor=null,u.$$pf_IsGraphOnlyOperation=!1,u.set_isGraphOnlyOperation(!n),u._characterPropertiesEditor=s,t._replacements=new o.w(String),u}return(0,i.t)(t,e),t.prototype.onAfterGraphCorrection=function(e,t){},t.prototype.get_isGraphOnlyOperation=function(){return this.$$pf_IsGraphOnlyOperation},t.prototype.set_isGraphOnlyOperation=function(e){return this.$$pf_IsGraphOnlyOperation=e,e},t.prototype.doHtmlCorrection=function(e){this.checkMatchAndCommit(e.innerText,(function(t,n,i){e.innerText=a.l.substring(e.innerText,0,t)+i+a.l.right(e.innerText,n)}))},t.prototype.doGraphCorrection=function(e){var t=this,n=this.get_matchEndIndex();this.checkMatchAndCommit(l.ParagraphReader.text(e).substring(this.get_matchStartIndex(),this.get_matchEndIndex()),(function(i,r,o){t._characterPropertiesEditor.replaceTextRange(s.y.createTextRange(e,t.get_matchStartIndex()+i,t.get_matchStartIndex()+r),o,!0,!1),n-=r-i-o.length})),this.onAfterGraphCorrection(e,n)},t.prototype.checkMatchAndCommit=function(e,n){if(!(this.matchResults.length<2)&&this.matchResults[1]){var i=this.matchResults[1];if(t._replacements.get_count()||this.populateReplacementDictionary(),t._replacements.containsKey(i)){var r=e.lastIndexOf(i);-1!==r&&n(r,r+i.length,t._replacements.get_item(i))}}},t._replacements=null,t}(r.n);(0,u.l)(c,"8073154f$DictionarySequenceReplacerAction",r.n,[])},3337:function(e,t,n){"use strict";n.d(t,{n:function(){return C}});var i=n(1817),r=n(5315),o=n(2846),a=n(8202),l=n(2183),s=n(9375),u=n(6325),c=n(4670),d=n(6596),g=n(3910),p=n(3371),h=n(9368),_=n(7275),m=n(654),f=n(8399),y=n(4115),C=function(e){function t(n,i,r,o,a,l){var s=e.call(this,n,i,r,o,a,l)||this;return s._characterPropertiesEditor$2=null,t._randSentence||t.StaticConstructor(),s._characterPropertiesEditor$2=l,s}return(0,i.t)(t,e),t.prototype.get_commandId=function(){return s.u.autoCorrectRandAction},t.prototype.doGraphCorrection=function(e){if(!e.get_hasContentControl()){var n=this._graphSelection.get_firstContext().get_node()===e,i=-1,r=3;if(this.matchResults[2]&&(i=parseInt(this.matchResults[2])),this.matchResults[1]&&(r=parseInt(this.matchResults[1])),!(i>20||r>100)){e.getGraphSpace().get_graphTransactionOperations().blockRttSend(7);var o=m.g.createFromNode(e);o.tryToRootAtOutlineAncestor(),h.OutlineElementNavigator.returnToOutlineElement(o),t.get_OutlineElementEditor().insertOutlineElementAsSibling(o,!1,!1),t.get_OutlineElementEditor().createParagraph(o);for(var a=0;a<r;++a){for(var s=[],u=a%t._randSentence.length,f=i>0?i:t._randSentence[u].length,y=0;y<f;++y)Array.add(s,t._randSentence[u][y%t._randSentence[u].length]);var C=_.y.createIpContext(o.get_currentNode(),0),S=p.FormattingReader.getFormattingObject(C);2!==c.App.get_mode()?t.get_FormattingEditor().setLanguageOnParagraph(S,1142):t.get_FormattingEditor().setTextProperty(S,l.j.noProof,!0),this._characterPropertiesEditor$2.replaceTextRange(C,s.join(" "),!0,!1),a<r-1&&(h.OutlineElementNavigator.returnToOutlineElement(o),t.get_OutlineElementEditor().insertOutlineElementAsSibling(o,!1,!1),t.get_OutlineElementEditor().createParagraph(o))}var b=o.get_currentNode();(o=m.g.createFromNode(e)).tryToRootAtOutlineAncestor(),h.OutlineElementNavigator.returnToOutlineElement(o),o.disconnectNodeAndReturnToParent(),n&&(this._graphSelection=d.SelectionFactory.createIpSelection(b,g.ParagraphReader.textLength(b)))}}},t.get_OutlineElementEditor=function(){return t._outlineElementEditor||(t._outlineElementEditor=u.w.get_instance().resolve(r.p))},t.get_FormattingEditor=function(){return t._formattingEditor||(t._formattingEditor=u.w.get_instance().resolve(o.z))},t.StaticConstructor=function(){t._randSentence=[["Lorem ipsum dolor sit amet, consectetuer adipiscing elit.","Maecenas porttitor congue massa.","Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna."],["Nunc viverra imperdiet enim.","Fusce est.","Vivamus a tellus."],["Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.","Proin pharetra nonummy pede.","Mauris et orci."]]},t.CreateGraphCorrectionAction=function(e,n,i,r,o,a){return new t(null,e,n,i,r,o)},t.CreateHtmlCorrectionAction=function(e,n,i,r,o,a){return new t(e,f.j.getOwner(e).get_sourceNode(),n,i,r,o)},t._randSentence=null,t._outlineElementEditor=null,t._formattingEditor=null,t}(a.n);(0,y.l)(C,"58d3968f$RandAction",a.n,[])},3516:function(e,t,n){"use strict";n.d(t,{p:function(){return u}});var i=n(3147),r=n(2071),o=n(3116),a=n(5645),l=n(6325),s=n(4115),u=function(){function e(e,t,n,i,r,o){this._onDialogDismissed=null,this._onLaunchDownload=null,this._callbackData=null,this._iHaveOfficeHandler=null,this._application=0,this._dialogCause=0,this._onDialogDismissed=e,this._onLaunchDownload=t,this._iHaveOfficeHandler=n,this._callbackData=i,this._dialogCause=r,this._application=o}return e.prototype.get_showHelpLink=function(){return!this._onLaunchDownload&&!this._iHaveOfficeHandler},e.prototype.get_offerString=function(){return 2===this._application?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer},e.prototype.get_id=function(){return"OICErrorDialogWithTrial"},e.prototype.get_errorMessageNoOffice=function(){return CommonUIStrings.l_OICErrorMessageNoOffice},e.prototype.get_iHaveOfficeButtonText=function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton},e.prototype.get_helpLinkText=function(){return CommonUIStrings.l_OICErrorHelpLink},e.prototype.get_helpLinkContentId=function(){return"OICFailure"},e.prototype.get_icon=function(){return 3},e.prototype.get_actionButtonText=function(){return 2===this._application?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton},e.prototype.get_dialogTitle=function(){return CommonUIStrings.l_DefaultDialogTitle},e.prototype.reactOICErrorDialogWithTrialHandler=function(e,t){this.OICErrorDialogWithTrialHandler(e)},e.prototype.legacyOICErrorDialogWithTrialHandler=function(e,t){this.OICErrorDialogWithTrialHandler(e)},e.prototype.OICErrorDialogWithTrialHandler=function(e){var t=10;1===e?(l.w.get_instance().resolve(i.v).launchOffer(this._application),t=3):2===e&&(this._iHaveOfficeHandler&&!this._iHaveOfficeHandler(this._callbackData)||this._onLaunchDownload&&r.p.get_instance().createOICErrorDialogWithDownload(this._onLaunchDownload,this._onDialogDismissed,this._callbackData),t=5);e&&1!==e||this._onDialogDismissed&&this._onDialogDismissed(this._callbackData),o.AFrameworkApplication.reportErrorWithCauseAndResolution(a.p.openInClientWithC2RFailed,this._dialogCause,t),this.dispose()},e.prototype.dispose=function(){this._onDialogDismissed=null,this._onLaunchDownload=null,this._callbackData=null},e}();(0,s.l)(u,"8e34e579$AOICErrorDialogWithTrial",null,[Sys.IDisposable])},3740:function(e,t,n){"use strict";n.r(t);var i=n(4115),r=n(3460),o=n(4232),a=n(3822),l=n(8108),s=n(2927),u=n(370),c=n(9375),d=n(3116),g=n(608),p=n(8663),h=n(8928),_=n(3874),m=n(4670),f=n(6849),y=n(1817),C=n(2689),S=function(e){function t(t,n,i,r,o,a){var l=e.call(this)||this;return l._context=null,l.init(t),l.setDebugName("DummyClipboardOperation"),l.initAction(d.AFrameworkApplication.get_theActionManager(),n,r,o,a),l._context=i,l.set_response(8),l.setIsCompleted(),l}return(0,y.t)(t,e),t.prototype.run=function(){this._isCompleted=!0,this.setCurrentOperationFromContext(this._context),this.processCurrentOperation(),this.set_response(32)},t}(C.g);(0,i.l)(S,"bf286d3$DummyClipboardOperation",C.g,[]);var b=n(9796),v=function(e){function t(t,n,i,r){var o=e.call(this,t,n)||this;return o._shouldGetHtmlFromClipboardData=!1,o._clipboardDataHelper=null,o._clipboardDataHelper=i,o._shouldGetHtmlFromClipboardData=r,o}return(0,y.t)(t,e),t.prototype.tryParseFromString=function(e,t){if(t.val=null,this._shouldGetHtmlFromClipboardData){var i=this.properties.getValueWithDefault(String,u.k.pastedHtmlContentFromClipboardData,"");i&&(t.val=this._clipboardDataHelper.parseHtmlUsingDomParser(i))}return t.val||(t.val=n(3740).ClipboardActor.get_pasteScratchPad(),t.val.innerHTML=e),!0},t}(b.e);(0,i.l)(v,"3cafee4c$HtmlStringImportStrategy",b.e,[]);var T=n(5254),A=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,y.t)(t,e),t.prototype.getPastedString=function(){return this.properties.getValueWithDefault(String,u.k.pastedPlainTextContent,"")},t.prototype.lineToInnerText=function(t){var n=e.prototype.lineToInnerText.call(this,t);return n.length&&" "!==n?n:"\xa0"},t}(T.b);(0,i.l)(A,"9c173c64$MultiLinePlainTextImportStrategy",T.b,[]);var I=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,y.t)(t,e),t.prototype.tryParseFromString=function(e,t){return t.val=n(3740).ClipboardActor.get_pasteScratchPad(),t.val.innerText=e,!0},t}(b.e);(0,i.l)(I,"299cfba3$PlainTextImportStrategy",b.e,[]);var w=n(1838),x=n(1749),E=n(9199),F=function(){function e(e){this.isPreparing=!1,this.isReady=!1,this._systemClipboard=null,this._systemClipboard=e}return e.prototype.prepare=function(){var e=this;return this.isPreparing||(this.isPreparing=!0,this.isReady=!1,this._systemClipboard.prepareForPaste((function(){e.isReady=!0}))),this.isReady},e.prototype.tryGetContentDom=function(t){return this.isPreparing=!1,t.val=this._systemClipboard.paste(),t.val?!!t.val.hasChildNodes()||(s.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),e.get_ActivityManager().recordEvent(x.f.unexpectedState,{Reason:E.i.expectedData}),!1):(s.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),e.get_ActivityManager().recordEvent(x.f.failedResult,{Reason:E.i.systemClipboardFailed}),!1)},e.get_ActivityManager=function(){return w.y.get_instance()},e}();(0,i.l)(F,"afd0bc6d$SystemClipboardImportStrategy",null,[r.v]);var P=n(4917),D=n(2442),R=n(7275),M=n(2280);n.d(t,{ClipboardActor:function(){return k}});var k=function(){function e(e,t,n,i,r,o,l,s){this._clipboardOperationFactory=null,this._systemClipboard=null,this._activityManager=null,this._clipboardDataHelper=null,this._selectionManager=null,this._actionManager=null,this._undoManager=null,this._flagLookupTable=null,this._cachedActionData=null,this._lastPasteCommand=0,this._isSupportImageDragDropExternalEnabled=!1,this._showKeepSourceFormattingOnPasteFloatieIsEnabled=!1,this._clipboardOperationFactory=e,this._systemClipboard=t,this._activityManager=n,this._clipboardDataHelper=i,this._selectionManager=r,this._actionManager=o,this._undoManager=l,this._isSupportImageDragDropExternalEnabled=!!s&&s.getBooleanAppSetting("SupportImageDragDropExternalIsEnabled"),this._showKeepSourceFormattingOnPasteFloatieIsEnabled=!!s&&s.getBooleanAppSetting("ShowKeepSourceFormattingOnPasteFloatieIsEnabled"),this._flagLookupTable=new a.w(f.u),this._flagLookupTable.set_item(c.u.paste,257),this._flagLookupTable.set_item(c.u.pasteTextOnly,8449),this._flagLookupTable.set_item(c.u.browserPasted,1),this._flagLookupTable.set_item(c.u.internalPaste,513),this._flagLookupTable.set_item(c.u.reformatPastedContent,4097),this._flagLookupTable.set_item(c.u.reformatPastedContentToPlainText,12289),this._flagLookupTable.set_item(c.u.pasteGivenText,7),this._flagLookupTable.set_item(c.u.pasteGivenHtml,1),this._flagLookupTable.set_item(c.u.pasteGivenHtmlAsPlainText,8193),this._flagLookupTable.set_item(c.u.copy,272),this._flagLookupTable.set_item(c.u.browserCopied,16),this._flagLookupTable.set_item(c.u.cut,304),this._flagLookupTable.set_item(c.u.browserCut,48),this._flagLookupTable.set_item(c.u.moveSelectedContent,64),this._flagLookupTable.set_item(c.u.moveSelectedContentWithinCurrentParagraph,64),this._flagLookupTable.set_item(c.u.showPlaceholderGlossary,65536),this._isSupportImageDragDropExternalEnabled&&this._flagLookupTable.set_item(c.u.dragDropBrowserContent,1)}return e.prototype.get_ClipboardOperationFactory=function(){return this._clipboardOperationFactory.get_value()},e.prototype.get_SystemClipboard=function(){return this._systemClipboard},e.prototype.RegisterActions=function(){this._actionManager.addActionWithFlags(c.u.queryPaste,M.d.application,i.i(this,this.QueryPasteOptions,"QueryPasteOptions"),97),this._actionManager.addActionWithFlags(c.u.queryPasteTextOnly,M.d.application,i.i(this,this.QueryPasteOptions,"QueryPasteOptions"),97),this._showKeepSourceFormattingOnPasteFloatieIsEnabled?this._actionManager.addActionWithFlags(c.u.queryPasteReformatOptionKeepSource,M.d.application,i.i(this,this.QueryReformatPasteOptions,"QueryReformatPasteOptions"),97):this._actionManager.addActionWithFlags(c.u.queryPasteReformatOptionMerge,M.d.application,i.i(this,this.QueryReformatPasteOptions,"QueryReformatPasteOptions"),97),this._actionManager.addActionWithFlags(c.u.queryPasteReformatOptionTextOnly,M.d.application,i.i(this,this.QueryReformatPasteOptions,"QueryReformatPasteOptions"),97),this._actionManager.addAsyncActionWithFlags(c.u.browserCut,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(c.u.cut,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction"),1028),this._actionManager.addAsyncAction(c.u.browserCopied,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction")),this._actionManager.addAsyncAction(c.u.copy,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction")),this._isSupportImageDragDropExternalEnabled&&this._actionManager.addAsyncActionWithFlags(c.u.dragDropBrowserContent,M.d.view,i.i(this,this.DropBrowserContent,"DropBrowserContent"),1028),this._actionManager.addAsyncActionWithFlags(c.u.browserPasted,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(c.u.paste,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(c.u.pasteTextOnly,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(c.u.pasteGivenHtmlAsPlainText,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(c.u.pasteGivenHtml,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(c.u.pasteGivenText,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(c.u.reformatPastedContent,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(c.u.reformatPastedContentToPlainText,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction"),1028),this._actionManager.addAction(c.u.requestImages,M.d.view,g.ActionManager.doNothingButReportHandler),this._actionManager.addAction(c.u.pastedTooManyPictures,M.d.view,g.ActionManager.doNothingButReportHandler),this._actionManager.addAction(c.u.pastedPictureWithDataUri,M.d.view,g.ActionManager.doNothingButReportHandler),this._actionManager.addAction(c.u.pastedPictureWithNoSrc,M.d.view,g.ActionManager.doNothingButReportHandler),this._actionManager.addAction(c.u.pastedPictureWithRelativeSrc,M.d.view,g.ActionManager.doNothingButReportHandler),this._actionManager.addAction(c.u.pastedLocalPictureFromSafari,M.d.view,g.ActionManager.doNothingButReportHandler),this._actionManager.addAsyncAction(c.u.moveSelectedContent,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction")),this._actionManager.addAsyncAction(c.u.moveSelectedContentWithinCurrentParagraph,M.d.view,i.i(this,this.MoveSelectedContentWithinCurrentParagraph,"MoveSelectedContentWithinCurrentParagraph")),this._actionManager.addAsyncAction(c.u.internalPaste,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction")),this._actionManager.addAsyncAction(c.u.showPlaceholderGlossary,M.d.view,i.i(this,this.ClipboardAction,"ClipboardAction")),this._actionManager.addAction(c.u.ctrlShiftV,M.d.view,g.ActionManager.doNothingButReportHandler),this._actionManager.addAction(c.u.cutCopyPasteDialog,M.d.view,g.ActionManager.doNothingButReportHandler)},e.prototype.QueryPasteOptions=function(e,t,n,i,r){return 1===n?32:(r[_.u.On]=!1,32)},e.prototype.DropBrowserContent=function(e,t,n,i,o,a){var c=this;s.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var d=a.DataTransfer,g=d.getData("text/html"),p=d.getData("text/plain"),_=!1,m=new h.DictionaryPropertySet;if(g.length>0?(s.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),m.setValue(u.k.pastedHtmlContent,g),_=!0):p.length>0&&(s.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),m.setValue(u.k.pastedPlainTextContent,p),_=!0),_){var f=this._flagLookupTable.get_item(t);return this.get_ClipboardOperationFactory().create(e,t,f,new l.q(r.v,(function(){return c.DetermineGetHtmlImportDomProvider(f,m)})),n,i,o,m)}return null},e.prototype.QueryReformatPasteOptions=function(e,t,n,i,r){var a=(0,o.e)(Object,r);if(a)if(d.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordShowKeepSourceFormattingOnPasteFloatieSettings"),!this._showKeepSourceFormattingOnPasteFloatieIsEnabled&&e===c.u.queryPasteReformatOptionMerge||this._showKeepSourceFormattingOnPasteFloatieIsEnabled&&e===c.u.queryPasteReformatOptionKeepSource){var l=this._lastPasteCommand!==c.u.reformatPastedContent&&this._lastPasteCommand!==c.u.reformatPastedContentToPlainText;a[_.u.On]=this._lastPasteCommand===c.u.reformatPastedContent||l}else e===c.u.queryPasteReformatOptionTextOnly&&(a[_.u.On]=this._lastPasteCommand===c.u.reformatPastedContentToPlainText);return 32},e.prototype.ClipboardAction=function(e,t,n,i,o,a){var s=this;if(d.AFrameworkApplication.get_protectFile()||D.n.get_instance().get_item(83))return new S(e,t,n,i,o,a);var u=this._flagLookupTable.get_item(t);return 1!==i&&1&u&&(this._lastPasteCommand=t),1!==i&&a&&1&u&&(this._cachedActionData=a),1!==i&&!a&&4096&u&&(a=this._cachedActionData),this.get_ClipboardOperationFactory().create(e,t,u,new l.q(r.v,(function(){return s.DetermineGetHtmlImportDomProvider(u,a)})),n,i,o,a)},e.prototype.MoveSelectedContentWithinCurrentParagraph=function(e,t,n,i,r,o){var a=o,l=P.SelectionManager.get_instance().get_selectionCollection().get_currentSelection().get_firstContext().get_node(),s=R.y.createIpContext(l,a);return this.ClipboardAction(e,t,n,i,r,s)},e.prototype.DetermineGetHtmlImportDomProvider=function(e,t){if(256&e)return new F(this.get_SystemClipboard());var n=t;return 2&e?4096&e?new v(n,this._activityManager,this._clipboardDataHelper,m.App.get_instance().get_isHtmlImportFromClipboardDataEnable()):new I(n,this._activityManager):n.hasProperty(u.k.pastedPlainTextContent)?new A(n,this._activityManager):new v(n,this._activityManager,this._clipboardDataHelper,m.App.get_instance().get_isHtmlImportFromClipboardDataEnable())},e.get_pasteScratchPad=function(){return p.q.getScratchPad("Box4PasteScratchPad")},e}();(0,i.l)(k,"c5047385$ClipboardActor",null,[])},4028:function(e,t,n){"use strict";n.r(t),n.d(t,{OICErrorDialogWithTrial:function(){return l}});var i=n(1817),r=n(4115),o=n(3516),a=n(6121),l=function(e){function t(t,n,i,o,l,s){var u=e.call(this,t,n,i,o,l,s)||this,c=document.createElement("span");c.innerText=u.get_errorMessageNoOffice(),c.appendChild(document.createElement("br")),c.appendChild(document.createElement("br"));var d=document.createElement("span");d.innerText=u.get_offerString(),c.appendChild(d);var g=new a.StandardDialog;return u.get_showHelpLink()?(g.set_buttonsOption(1),g.addHelpLink(u.get_helpLinkText(),u.get_helpLinkContentId())):(g.set_buttonsOption(4),g.setButtonText(2,u.get_iHaveOfficeButtonText())),g.setButtonText(1,u.get_actionButtonText()),g.set_dialogId(u.get_id()),g.messageBox(u.get_dialogTitle(),null,u.get_icon(),r.i(u,u.legacyOICErrorDialogWithTrialHandler,"legacyOICErrorDialogWithTrialHandler"),c),u}return(0,i.t)(t,e),t}(o.p);(0,r.l)(l,"7e4e2898$OICErrorDialogWithTrial",o.p,[])},4136:function(e,t,n){"use strict";n.r(t),n.d(t,{DocumentTitleContainer:function(){return u}});var i=n(1817),r=n(2130),o=n(417),a=n(9958),l=n(3116),s=n(4115),u=function(e){function t(){var t=e.call(this)||this;return t.set_elmContainer(a.k.createUnselectableElement("span")),t.get_elmContainer().id="viewerChrome-documentTitleContainer",t.get_elmContainer().className="cui-herobar-documentTitleContainer",l.AFrameworkApplication.docPropertiesProvider.get_breadcrumbDocName()&&(t._elementToTruncate=o.CuiHelper.CreateDocumentTitleElementInternal(t.get_elmContainer(),!1)),t}return(0,i.t)(t,e),t.prototype.dispose=function(){o.CuiHelper.disposeTitleElement()},t}(r.m);(0,s.l)(u,"da85cf10$DocumentTitleContainer",r.m,[])},4274:function(e,t,n){"use strict";n.d(t,{m:function(){return r}});var i=n(4115),r=function(){return function(e,t,n,i){this.Pattern=null,this.HtmlFactoryMethod=null,this.GraphFactoryMethod=null,this.Flags=0,this.Pattern=8&i?new RegExp(e,"i"):new RegExp(e),this.HtmlFactoryMethod=t,this.GraphFactoryMethod=n,this.Flags=i}}();(0,i.l)(r,"c489ac60$RegexAutoCorrectEntry",null,[])},4355:function(e,t,n){"use strict";n.d(t,{c:function(){return i}});var i=(0,n(4115).y)("caea179d$IListCommands")},4494:function(e,t,n){"use strict";n.d(t,{x:function(){return a}});var i=n(8901),r=n(9229),o=n(4115),a=function(){function e(){this.elmContainer=null,this._isVisible=!0}return e.prototype.get_elmContainer=function(){return this.elmContainer},e.prototype.set_elmContainer=function(e){return this.elmContainer=e,e},e.prototype.get_containerBounds=function(){return r.g.getElementBounds(this.get_elmContainer())},e.prototype.get_isVisible=function(){return this._isVisible},e.prototype.dispose=function(){},e}();(0,o.l)(a,"529ed28e$ViewerChromeItemContainer",null,[i.m])},4631:function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var i,r=n(4115);!function(e){e[e.chrome=0]="chrome",e[e.edge=1]="edge",e[e.firefox=2]="firefox",e[e.IE=3]="IE",e[e.safari=4]="safari",e[e.others=5]="others",e[e.unknown=6]="unknown",e[e.electron=7]="electron"}(i||(i={})),(0,r.h)("b9669d6f$BrowserCode",i)},4664:function(e,t,n){"use strict";n.d(t,{g:function(){return o}});var i=n(7560),r=n(4115),o=function(){function e(e,t){this._languageId=0,this._originalWord=null,this._languageId=t,this._originalWord=e}return e.prototype.ValidateDataInOriginalWord=function(){var t=Number.parseInvariant(this._originalWord.substring(0,this._originalWord.length-2));switch(Number.parseInvariant(this._originalWord.charAt(this._originalWord.length-3).toString())){case 1:return 11===t?e.Fourth:e.First;case 2:return 12===t?e.Fourth:e.Second;case 3:return 13===t?e.Fourth:e.Third;case 4:case 5:case 6:case 7:case 8:case 9:case 0:return e.Fourth;default:return""}},e.prototype.isOrdinalNumber=function(){var t=i.i.getCultureInfo(this._languageId);if(!t||!t.get_name().toLowerCase().startsWith("en"))return!1;if(!this._originalWord)return!1;if(this._originalWord.length<=2)return!1;for(var n=0;n<e.get_OrdinalNumberSuffixList().length;n++)if(this._originalWord.toLowerCase().endsWith(e.get_OrdinalNumberSuffixList()[n])){var r=this._originalWord.substr(0,this._originalWord.length-2);if(new RegExp("^\\d+$").test(r)){var o=this.ValidateDataInOriginalWord();if(this._originalWord.toLowerCase().endsWith(e.get_OrdinalNumberSuffixList()[n])&&o===e.get_OrdinalNumberSuffixList()[n])return!0}break}return!1},e.get_OrdinalNumberSuffixList=function(){return e._ordinalNumberSuffix||(e._ordinalNumberSuffix=[e.First,e.Second,e.Third,e.Fourth])},e._ordinalNumberSuffix=null,e.First="st",e.Second="nd",e.Third="rd",e.Fourth="th",e}();(0,r.l)(o,"b16a93e0$ValidateOrdinalsRule",null,[])},4696:function(e,t,n){"use strict";n.d(t,{z:function(){return u}});var i=n(1817),r=n(9233),o=n(9375),a=n(8548),l=n(7275),s=n(4115),u=function(e){function t(t,n,i,r,o,a){var l=e.call(this,t,n,i,r,a)||this;return l._characterPropertiesEditor$1=null,l._correctWord=null,l._correctWord=o,l._characterPropertiesEditor$1=a,l}return(0,i.t)(t,e),t.prototype.get_isGraphOnlyOperation=function(){return!0},t.prototype.get_commandId=function(){return o.u.autoCorrectFractionsReplace},t.prototype.get_CorrectWord=function(){return this._correctWord},t.prototype.doHtmlCorrection=function(e){e.innerText=a.l.substring(e.innerText,0,this.get_matchStartIndex())+this._correctWord+a.l.right(e.innerText,this.get_matchEndIndex())},t.prototype.doGraphCorrection=function(e){this._characterPropertiesEditor$1.replaceTextRange(l.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchEndIndex()),this._correctWord,!0,!1)},t.CreateGraphCorrectionAction=function(e,n,i,r,o){return new t(null,e,n,i,r,o)},t}(r.z);(0,s.l)(u,"c9d60bdd$FractionsReplaceCorrectAction",r.z,[])},4821:function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var i=(0,n(4115).y)("5c6dc9c7$IStyleEditor")},4921:function(e,t,n){"use strict";n.d(t,{l:function(){return g}});var i=n(1817),r=n(9233),o=n(9375),a=n(8548),l=n(9368),s=n(5885),u=n(7275),c=n(654),d=n(4115),g=function(e){function t(t,n,i,r,o,a){var l=e.call(this,t,n,i,i+1,a)||this;return l._characterPropertiesEditor$1=null,l._typedChar=null,l._correctedQuote=null,l._characterPropertiesEditor$1=a,l._typedChar=r,l._correctedQuote=o,l.set_needToCheckOriginalString(!1),l}return(0,i.t)(t,e),t.prototype.get_isGraphOnlyOperation=function(){return!1},t.prototype.get_commandId=function(){return o.u.autoCorrectSmartQuote},t.prototype.doHtmlCorrection=function(e){e.innerText=a.l.substring(e.innerText,0,this.get_matchStartIndex())+this._correctedQuote+a.l.right(e.innerText,this.get_matchEndIndex())},t.prototype.doGraphCorrection=function(e){this._characterPropertiesEditor$1.replaceTextRange(u.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchEndIndex()),this._typedChar,!0,!1),this._characterPropertiesEditor$1.replaceTextRange(u.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchStartIndex()+1),this._correctedQuote,!0,!1)},t.CreateGraphCorrectionAction=function(e,n,i,r,o,u){if("'"!==i&&'"'!==i)return null;var d=c.g.createFromNode(e);if(d.tryToRootAtOutlineAncestor(),l.OutlineElementNavigator.returnToOutlineElement(d),s.OutlineElementReader.isRtlForView(d.get_currentNode()))return null;var g="'"===i;return new t(u,e,n,i+"",!n||a.l.isWhitespaceUnicode(r)||-1!==Array.indexOf(t.OpenBrackets,r)?g?"\u2018":"\u201c":g?"\u2019":"\u201d",o)},t.OpenBrackets=["[","{","("],t}(r.z);(0,d.l)(g,"ae5a760b$SmartQuoteCorrectAction",r.z,[])},5187:function(e,t,n){"use strict";n.d(t,{e:function(){return s}});var i=n(1817),r=n(3295),o=n(9375),a=n(8399),l=n(4115),s=function(e){function t(t,n,i,r,o,a){return e.call(this,t,n,i,r,o,a)||this}return(0,i.t)(t,e),t.prototype.get_commandId=function(){return o.u.autoCorrectDash},t.prototype.populateReplacementDictionary=function(){r.v._replacements.set_item("--","\u2014"),r.v._replacements.set_item(" -- "," \u2013 "),r.v._replacements.set_item(" - "," \u2013 "),r.v._replacements.set_item("-- ","\u2014"),r.v._replacements.set_item(" --"," \u2013"),r.v._replacements.set_item(" -"," \u2013")},t.createGraphCorrectionAction=function(e,n,i,r,o,a){return new t(null,e,n,i,r,o)},t.createHtmlCorrectionAction=function(e,n,i,r,o,l){return new t(e,a.j.getOwner(e).get_sourceNode(),n,i,r,o)},t}(r.v);(0,l.l)(s,"aebf1448$DashAction",r.v,[])},5320:function(e,t,n){"use strict";n.r(t);var i=n(8121),r=n(7844),o=n(4115),a=(0,o.y)("46dc8a5d$IActivityAggregationSchemes"),l=n(2602),s=n(2676),u=n(9865),c=n(6956),d=n(3822),g=n(3660),p=n(42),h=function(){function e(){this._aggregationMethods=null,this._aggregationMethods=new p.w(Function)}return e.prototype.SetAggregationMethod=function(e,t){this._aggregationMethods.set_item(e,t)},e.prototype.GetAggregationMethod=function(e){var t;return this._aggregationMethods.tryGetValue(e,(0,g.m)((function(){return t}),(function(e){return t=e}))),t},e}();(0,o.l)(h,"67f3c90d$AggregationMethodsForActivityName",null,[]);var _=function(){function e(){this._primaryPropertiesForActivity=new d.w(c.j),this._aggregationMethods=new d.w(h)}return e.prototype.setAggregationMethod=function(e,t,n){this._aggregationMethods.containsKey(e)&&this._aggregationMethods.get_item(e)||this._aggregationMethods.set_item(e,new h),this._aggregationMethods.get_item(e).SetAggregationMethod(t,n)},e.prototype.getAggregationMethod=function(e,t){return this._aggregationMethods.containsKey(e)&&this._aggregationMethods.get_item(e)?this._aggregationMethods.get_item(e).GetAggregationMethod(t):null},e.prototype.getPrimaryProperties=function(e){return this._primaryPropertiesForActivity.containsKey(e)&&this._primaryPropertiesForActivity.get_item(e)||this._primaryPropertiesForActivity.set_item(e,new c.j),this._primaryPropertiesForActivity.get_item(e)},e.prototype.declarePrimaryProperty=function(e,t){this.getPrimaryProperties(e).add(t)},e}();(0,o.l)(_,"955d5fbc$ActivityAggregationInfo",null,[r.s]);var m,f=n(7089),y=n(4232),C=n(9730),S=n(2927),b=n(3960),v=n(1817),T=n(8795),A=n(260),I=function(e){function t(t,n){var i=this;return i.activityCollection=null,(i=e.call(this,t)||this).activityCollection=n,i.set_uniqueID(n?n.getFirstUniqueID():A.b.generateUniqueID()),i}return(0,v.t)(t,e),t.prototype.get_activityCollection=function(){return this.activityCollection},t.prototype.get_activityName=function(){return this.get_activityCollection().get_name()},t.prototype.get_startTime=function(){return this.get_activityCollection().get_startTime()},t.prototype.get_endTime=function(){return this.get_activityCollection().get_endTime()},t.prototype.end=function(){},t.prototype.cancel=function(){},t.prototype.forceEnd=function(){},t.prototype.updateFrameworkProperties=function(){this.frameworkProperties.set_item("AM",this.get_activityCollection().get_mode().toString()),this.frameworkProperties.set_item("C",this.get_activityCollection().get_count().toString()),this.frameworkProperties.set_item("DA",this.get_activityCollection().get_durationAverage().toFixed(2)),this.frameworkProperties.set_item("DV",this.get_activityCollection().get_durationVariance().toFixed(2))},t.prototype.getPropertyValues=function(e){return this.get_activityCollection().getPropertyValues(e)},t.prototype.getSecondaryProperties=function(){return this.get_activityCollection().getSecondaryProperties()},t.prototype.addToCompletedActivities=function(){for(var e=this.get_activityCollection().get_activityList().$$lge();e.$$mn();){e.$$cu().addToCompletedActivities()}},t}(T.c);(0,o.l)(I,"a733111b$AggregatedActivity",T.c,[]),function(e){e[e.none=0]="none",e[e.primaryProperties=1]="primaryProperties",e[e.secondaryProperites=2]="secondaryProperites"}(m||(m={})),(0,o.h)("88f1279c$AggregationMode",m);var w=function(){function e(e,t){this._activityName=0,this._activityAggregationInfo=null,this._aggregationMode=0,this._activityName=e,this._activityAggregationInfo=t}return e.prototype.AggregateProperties=function(e,t){this._aggregationMode=t;for(var n=0;n<e.get_count();n++){var i=e.get_item(n);this.AggregatePropertiesForActivity(i)}},e.prototype.AggregatePropertiesForActivity=function(e){var t=(0,y.e)(I,e);if(t)if(1===this._aggregationMode)this.AggregatePrimaryProperties(t);else if(2===this._aggregationMode){this.AggregateSecondaryProperties(t);for(var n=this._activityAggregationInfo.getPrimaryProperties(this._activityName).getEnumerator();n.$$mn();){var i=n.$$cu(),r=t.get_activityCollection().get_activityList().get_item(0);r.get_properties().containsKey(i)&&e.get_properties().set_item(i,r.get_properties().get_item(i))}}},e.prototype.AggregatePrimaryProperties=function(e){for(var t=this._activityAggregationInfo.getPrimaryProperties(this._activityName).getEnumerator();t.$$mn();){var n=t.$$cu();this.RunAggregationMethod(e,n)}},e.prototype.AggregateSecondaryProperties=function(e){for(var t=e.getSecondaryProperties().getEnumerator();t.$$mn();){var n=t.$$cu();this.RunAggregationMethod(e,n)}},e.prototype.RunAggregationMethod=function(e,t){var n=this._activityAggregationInfo.getAggregationMethod(this._activityName,t);if(n){var i=e.getPropertyValues(t);e.get_properties().set_item(t,n(i))}},e}();(0,o.l)(w,"3b5de9de$PropertyAggregationHelper",null,[]);var x=n(1320),E=function(){function e(e,t,n,i,r){this._activityAggregationInfo=null,this._aggregationParams=null,this._lazyActivityAggregationSchemes=null,this._completedActivitiesHelper=null,this._activityThrottler=null,this._aggregationParams=e,this._activityAggregationInfo=t,this._completedActivitiesHelper=r,this._activityThrottler=i,this._lazyActivityAggregationSchemes=n}return e.prototype.get_ActivityAggregationSchemes=function(){return this._lazyActivityAggregationSchemes.get_value()},e.prototype.CompleteActivity=function(e){if(o.r(b.p,e))e.completeActivity();else if(o.r(I,e)){if(!this._activityThrottler.canLogActivity(e.get_activityName().toString()))return;var t=(0,y.e)(I,e);t.updateFrameworkProperties();var n=t.makeSerializable(),i=[];Array.add(i,n);var r=x.x.serialize(i);S.ULS.sendTraceTag(6907266,213,50,r)}},e.prototype.Aggregate=function(e,t){var n=(new Date).getTime(),i=this._completedActivitiesHelper.get_list().get_item(e),r=null,o=this.GetAggregationMode(i,(0,g.m)((function(){return r}),(function(e){return r=e})));(this._completedActivitiesHelper.get_list().set_item(e,new C.c(f.n)),t&&(r=this.CorrectForGraceWindow(r,n,this._aggregationParams.graceWindow)),r.get_count()>0)&&new w(e,this._activityAggregationInfo).AggregateProperties(r,o);return r},e.prototype.CorrectForGraceWindow=function(e,t,n){for(var i=new C.c(f.n),r=0;r<e.get_count();r++){var o=e.get_item(r);o.get_startTime()>t-n?o.addToCompletedActivities():i.add(o)}return i},e.prototype.GetAggregationMode=function(e,t){var n=this.get_ActivityAggregationSchemes().timeRangeAggregationOverPrimaryProperties(e),i=this.get_ActivityAggregationSchemes().timeRangeAggregationOverSecondaryProperties(e),r=this.AggregationMode(n,i);return t.val=1===r?n:i,r},e.prototype.AggregationMode=function(e,t){return e.get_count()*this._aggregationParams.modeFactor<t.get_count()?1:2},e.prototype.flushCompletedActivities=function(){},e.prototype.get_enabled=function(){return this._aggregationParams.enabled},e.prototype.addToCompletedActivities=function(e){},e}();(0,o.l)(E,"418bba41$ActivityAggregationManager",null,[i.e]);var F=function(){function e(e){this.enabled=!1,this.maxInterval=500,this.minChain=2,this.modeFactor=5,this.taskInterval=6e4,this.graceWindow=3e4,this.extractSettings(e.get_appSettings())}return e.prototype.extractSettings=function(t){this.enabled=Boolean.parse(t[e.EnabledKey]||"false"),this.maxInterval=parseInt(t[e.MaxIntervalKey]||"500"),this.minChain=parseInt(t[e.MinChainKey]||"2"),this.taskInterval=parseInt(t[e.TaskIntervalKey]||"60000"),this.modeFactor=parseInt(t[e.ModeFactorKey]||"5"),this.graceWindow=parseInt(t[e.GraceWindowKey]||"30000")},e.EnabledKey="ActivityAggregationEnabled",e.MaxIntervalKey="ActivityAggregationMaxInterval",e.MinChainKey="ActivityAggregationMinChain",e.TaskIntervalKey="ActivityAggregationTaskInterval",e.ModeFactorKey="ActivityAggregationModeFactor",e.GraceWindowKey="ActivityAggregationGraceWindow",e}();(0,o.l)(F,"30498aee$ActivityAggregationParams",null,[]);var P=n(6639),D=function(){function e(e,t){this._activityAggregationInfo=null,this._activityCollectionFactory=null,this._activityAggregationInfo=e,this._activityCollectionFactory=t}return e.prototype.timeRangeAggregationOverPrimaryProperties=function(e,t){if(void 0===t&&(t=1),!e||!e.get_count())return e;for(var n=new C.c(f.n),i=null,r=0;r<e.get_count();r++){var o=e.get_item(r);if(o){var a=o.get_activityName();if(i)if(i.isWithinTimeRange(o))i.add(o);else{var l=i.process();n.addRange(l),(i=this._activityCollectionFactory(a,t)).add(o)}else(i=this._activityCollectionFactory(a,t)).add(o)}}if(i){l=i.process();n.addRange(l)}return n},e.prototype.timeRangeAggregationOverSecondaryProperties=function(e){if(!e||!e.get_count())return e;for(var t={},n=null,i=0;i<e.get_count();i++){var r=e.get_item(i);if(r){if(!n){n=new C.c(String);for(var o=r.get_activityName(),a=this._activityAggregationInfo.getPrimaryProperties(o).getEnumerator();a.$$mn();){var l=a.$$cu();n.add(l)}}var s=this.getPropertyValueString(r,n);null!==s&&(s in t&&t[s]||(t[s]=new C.c(f.n)),t[s].add(r))}}for(var u=new C.c(f.n),c=0,d=P.j.getKeys(t);c<d.length;c++){var g=d[c],p=this.timeRangeAggregationOverPrimaryProperties(t[g],2);u.addRange(p)}return u},e.prototype.getPropertyValueString=function(e,t){for(var n="",i=t.$$ge();i.$$mn();){var r=i.$$cu();n+=r,e.get_properties().containsKey(r)&&void 0!==e.get_properties().get_item(r)&&null!==e.get_properties().get_item(r)?n+=e.get_properties().get_item(r):n+="null"}return n},e}();(0,o.l)(D,"71189d14$ActivityAggregationSchemes",null,[a]);var R=(0,o.y)("c706ad41$IActivityCollection"),M=function(){function e(e,t,n,i,r){this._activityFactory=null,this._activityAggregationInfo=null,this._aggregationParams=null,this.$$pf_ActivityList=null,this.$$pf_Mode=0,this.$$pf_Name=0,this.$$pf_StartTime=0,this.$$pf_EndTime=0,this._aggregationParams=n,this._activityFactory=i,this._activityAggregationInfo=r,this.set_name(e),this.set_mode(t),this.set_activityList(new C.c(f.n))}return e.prototype.get_activityList=function(){return this.$$pf_ActivityList},e.prototype.set_activityList=function(e){return this.$$pf_ActivityList=e,e},e.prototype.get_mode=function(){return this.$$pf_Mode},e.prototype.set_mode=function(e){return this.$$pf_Mode=e,e},e.prototype.get_count=function(){return this.get_activityList().get_count()},e.prototype.get_name=function(){return this.$$pf_Name},e.prototype.set_name=function(e){return this.$$pf_Name=e,e},e.prototype.get_startTime=function(){return this.$$pf_StartTime},e.prototype.set_startTime=function(e){return this.$$pf_StartTime=e,e},e.prototype.get_endTime=function(){return this.$$pf_EndTime},e.prototype.set_endTime=function(e){return this.$$pf_EndTime=e,e},e.prototype.get_durationAverage=function(){if(!this.get_count())return 0;for(var e=0,t=this.get_activityList().$$lge();t.$$mn();){var n=t.$$cu();e+=n.get_endTime()-n.get_startTime()}return e/this.get_count()},e.prototype.get_durationVariance=function(){if(!this.get_count())return 0;for(var e=0,t=this.get_durationAverage(),n=this.get_activityList().$$lge();n.$$mn();){var i=n.$$cu(),r=i.get_endTime()-i.get_startTime();e+=(r-t)*(r-t)}return e/this.get_count()},e.prototype.add=function(e){this.get_count()?this.set_endTime(e.get_endTime()>this.get_endTime()?e.get_endTime():this.get_endTime()):(this.set_startTime(e.get_startTime()),this.set_endTime(e.get_endTime())),this.get_activityList().add(e)},e.prototype.isWithinTimeRange=function(e){return!(this.get_count()<=0)&&e.get_startTime()-this.get_endTime()<=this._aggregationParams.maxInterval},e.prototype.process=function(){if(this.get_count()>=this._aggregationParams.minChain){var e=new C.c(f.n),t=this._activityFactory(this);return e.add(t),e}return this.get_activityList()},e.prototype.getPropertyValues=function(e){for(var t=new C.c(String),n=this.get_activityList().$$lge();n.$$mn();){var i=n.$$cu();if(i.get_properties().containsKey(e)){var r=i.get_properties().get_item(e);t.add(r)}else t.add(null)}return t},e.prototype.getSecondaryProperties=function(){for(var e=this._activityAggregationInfo.getPrimaryProperties(this.get_name()),t=new c.j,n=this.getAllProperties().getEnumerator();n.$$mn();){var i=n.$$cu();e.contains(i)||t.add(i)}return t},e.prototype.getAllProperties=function(){var e=new c.j;if(!this.get_activityList())return e;for(var t=this.get_activityList().$$lge();t.$$mn();)for(var n=t.$$cu().get_properties().get_keys().$$ge();n.$$mn();){var i=n.$$cu();e.add(i)}return e},e.prototype.getFirstUniqueID=function(){return this.get_activityList().get_item(0).get_uniqueID()},e}();(0,o.l)(M,"43dfd888$ActivityCollection",null,[R]);var k=(0,o.y)("1af2fa$ICompletedActivitiesHelper"),N=function(){function e(){this._completedActivityList=new d.w(C.c.$$(f.n))}return e.prototype.get_list=function(){return this._completedActivityList},e.prototype.add=function(e){var t=e.get_activityName();if(this._completedActivityList.containsKey(t)&&this._completedActivityList.get_item(t)){var n=this.GetIndexForInsertion(this._completedActivityList.get_item(t),e);this._completedActivityList.get_item(t).insert(n,e)}else this._completedActivityList.set_item(t,new C.c(f.n)),this._completedActivityList.get_item(t).add(e)},e.prototype.GetIndexForInsertion=function(e,t){for(var n=e.get_count()-1;n>=0;n--)if(t.get_startTime()>e.get_item(n).get_startTime())return n+1;return 0},e}();(0,o.l)(N,"f2d78d53$CompletedActivitiesHelper",null,[k]);var L=n(3116),B=n(6959),O=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.ActivityAggregator"},e.prototype.init=function(){var e=this;L.AFrameworkApplication.subscribeToBeforeAppShutDown((function(t,n){e._container.resolve(E).flushCompletedActivities()}))},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e;var t=function(t){return new I((function(){return e.tryResolve(i.e)}),t)},n=function(n,i){return new M(n,i,e.resolve(F),t,e.resolve(r.s))};e.register(E).as(i.e).singleInstance().usingFactory((function(){return new E(e.resolve(F),e.resolve(r.s),e.resolveLazy(a),e.resolve(l.l),e.resolve(N))})),e.register(F).singleInstance().usingFactory((function(){return new F(L.AFrameworkApplication.appSettingsManager)})),e.register(_).as(r.s).singleInstance().usingFactory((function(){return new _})),e.register(D).as(a).singleInstance().usingFactory((function(){return new D(e.resolve(r.s),n)})),e.register(N).singleInstance().usingFactory((function(){return new N}))},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(O,"b54ff2fd$ActivityAggregatorPackage",null,[s.u,u.s]);var U=n(9126),H=function(){return function(){this.ScreenWidth=0,this.ScreenHeight=0,this.WinInnerWidth=0,this.WinInnerHeight=0,this.WinOuterHeight=0,this.WinOuterWidth=0,this.WinDevicePixelRatio=0,this.CalculatedDevicePixelRatio=0,this.ScreenDeviceXdpi=0,this.ScreenDeviceYdpi=0,this.ScreenLogicalXdpi=0,this.ScreenLogicalYdpi=0,this.ScreenAvailHeight=0,this.ScreenAvailWidth=0,this.DocElemOffsetWidth=0,this.DocElemOffsetHeight=0,this.DocElemClientWidth=0,this.DocElemClientHeight=0,this.WinOrientation=0,this.SupportsTouch=!1,this.NavPlugins=null,this.NavUserAgent=null,this.NavPlatform=null,this.NavAppName=null,this.NavAppVersion=null,this.NavLanguage=null,this.Error=null}}();(0,o.l)(H,"f43303d3$BrowserInfo",null,[]);var G=function(){return function(){this.Name=null,this.Version=null}}();(0,o.l)(G,"ac39a1f6$PluginInfo",null,[]);var W=n(8871),V=function(){function e(){}return e.logInfo=function(){if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LogBrowserInfoIsEnabled")){var t=e.gatherAllInfo();try{var n=JSON.stringify(t);S.ULS.sendTraceTag(6903563,102,50,n)}catch(e){S.ULS.sendTraceTag(6903564,102,15,e.message)}}else S.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")},e.GetPlugins=function(){var e=window.navigator.plugins;if(!e||!e.length)return null;for(var t=new Array(0),n=0;n<e.length;n++){var i=e[n].name,r=e[n].version;Array.add(t,(0,U.m)(new G,{Name:i,Version:r}))}return t},e.gatherAllInfo=function(){var t=new H,n=new Sys.StringBuilder;return e.GetInfoOrLogError(Number,(function(e){t.DocElemClientHeight=e}),(function(){return document.documentElement.clientHeight}),n),e.GetInfoOrLogError(Number,(function(e){t.DocElemClientWidth=e}),(function(){return document.documentElement.clientWidth}),n),e.GetInfoOrLogError(Number,(function(e){t.DocElemOffsetHeight=e}),(function(){return document.documentElement.offsetHeight}),n),e.GetInfoOrLogError(Number,(function(e){t.DocElemOffsetWidth=e}),(function(){return document.documentElement.offsetWidth}),n),e.GetInfoOrLogError(Number,(function(e){t.ScreenAvailHeight=e}),(function(){return window.screen.availHeight}),n),e.GetInfoOrLogError(Number,(function(e){t.ScreenAvailWidth=e}),(function(){return window.screen.availWidth}),n),e.GetInfoOrLogError(Number,(function(e){t.ScreenWidth=e}),(function(){return window.screen.width}),n),e.GetInfoOrLogError(Number,(function(e){t.ScreenHeight=e}),(function(){return window.screen.height}),n),e.GetInfoOrLogError(Number,(function(e){t.ScreenLogicalXdpi=e}),(function(){return window.screen.logicalXDPI}),n),e.GetInfoOrLogError(Number,(function(e){t.ScreenLogicalYdpi=e}),(function(){return window.screen.logicalYDPI}),n),e.GetInfoOrLogError(Number,(function(e){t.ScreenDeviceXdpi=e}),(function(){return window.screen.deviceXDPI}),n),e.GetInfoOrLogError(Number,(function(e){t.ScreenDeviceYdpi=e}),(function(){return window.screen.deviceYDPI}),n),e.GetInfoOrLogError(Number,(function(e){t.WinInnerHeight=e}),(function(){return window.self.innerHeight}),n),e.GetInfoOrLogError(Number,(function(e){t.WinInnerWidth=e}),(function(){return window.self.innerWidth}),n),e.GetInfoOrLogError(Number,(function(e){t.WinOuterHeight=e}),(function(){return window.self.outerHeight}),n),e.GetInfoOrLogError(Number,(function(e){t.WinOuterWidth=e}),(function(){return window.self.outerWidth}),n),e.GetInfoOrLogError(Number,(function(e){t.WinOrientation=e}),(function(){return window.self.orientation}),n),e.GetInfoOrLogError(Number,(function(e){t.WinDevicePixelRatio=e}),(function(){return window.self.devicePixelRatio}),n),e.GetInfoOrLogError(Boolean,(function(e){t.SupportsTouch=e}),(function(){return W.y.get_supportsTouch()}),n),e.GetInfoOrLogError(String,(function(e){t.NavAppName=e}),(function(){return window.navigator.appName}),n),e.GetInfoOrLogError(String,(function(e){t.NavAppVersion=e}),(function(){return window.navigator.appVersion}),n),e.GetInfoOrLogError(String,(function(e){t.NavLanguage=e}),(function(){return window.navigator.browserLanguage||window.navigator.language}),n),e.GetInfoOrLogError(String,(function(e){t.NavUserAgent=e}),(function(){return window.navigator.userAgent}),n),e.GetInfoOrLogError(String,(function(e){t.NavPlatform=e}),(function(){return window.navigator.platform}),n),e.GetInfoOrLogError(Array,(function(e){t.NavPlugins=e}),e.GetPlugins,n),e.GetInfoOrLogError(Number,(function(e){t.CalculatedDevicePixelRatio=e}),(function(){return e.get_devicePixelRatio()}),n),t.Error=n.toString(),t},e.get_devicePixelRatio=function(){var e=window.devicePixelRatio;return isNaN(e)?window.screen.deviceXDPI/window.screen.logicalXDPI:e},e.GetInfoOrLogError=function(e,t,n,i){try{t(n())}catch(e){i.isEmpty()||i.append(" | "),i.append(e.message||"null")}},e}();(0,o.l)(V,"d65331a7$BrowserInfoLogger",null,[]);var $=function(){function e(){}return e.prototype.get_name=function(){return"Common.App.BrowserInfoLogger"},e.prototype.configure=function(e){},e.prototype.init=function(){V.logInfo()},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)($,"f4a2f29d$BrowserInfoLoggerPackage",null,[s.u,u.s]);var z,K=n(7785),q=n(5583),j=n(1635),Q=n(3992),J=n(1859);!function(e){e[e.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler",e[e.cloudPolicySettings=1]="cloudPolicySettings"}(z||(z={})),(0,o.h)("50abc64e$ApplicationFeatureHelperRequestType",z);var X=n(3092),Y=n(8116),Z=function(){function e(e,t){this._appSettingsManager=null,this._clientRequestManager=null,this._appSettingsManager=e,this._clientRequestManager=t}return e.prototype.createHttpResponsePromise=function(t,n,i,r,o){var a=this,l=z[o];return new Promise((function(s,u){n?(S.ULS.sendTraceTag(50622688,e.LogCategory,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing."),a.RecordKpiUsage(o),a._clientRequestManager.addRequest(i,2,null,a.GetHeaders(),!1,0,(function(t){S.ULS.sendTraceTag(50622689,e.LogCategory,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",l);try{if(null==t||void 0===t.get_data()||null===t.get_data()||void 0===t.get_data().responseData||null===t.get_data().responseData)return u(String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",l)),void a.RecordKPIFailure("NullResponseData",o);if(t.get_data().httpStatus!==Y.k.oK_200)return a.RecordKPIFailure("NonSuccessStatusCode",o),void u(String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",t.get_data().httpStatus,l));var n=r(t.get_data().responseData);if(null==n)return a.RecordKPIFailure("ParseResponseFailure",o),void u(String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",l));S.ULS.sendTraceTag(50622690,e.LogCategory,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",l),s(n)}catch(e){a.RecordKPIFailure("UnhandledExceptionDuringRequest",o),u(String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",e,l))}}),(function(t){S.ULS.sendTraceTag(50622691,e.LogCategory,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",l),a.RecordKPIFailure("RequestFailed",o),null!=t&&void 0!==t.get_data()&&null!==t.get_data()?u(String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",t.get_data().httpStatus,t.get_data().responseData||"No Data",l)):u(String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",l))}),null,void 0,void 0,a._appSettingsManager.getIntAppSetting("ApplicationFeatureHelperRequestQueueTimeout",5e3),a._appSettingsManager.getIntAppSetting("ApplicationFeatureHelperRequestSentTimeout",5e3))):s(new t)}))},e.prototype.GetHeaders=function(){var e={};return e["x-UserDataSignature"]=this._appSettingsManager.getStringAppSetting("UserDataSignature"),e["x-LicensingIsEnabled"]=this._appSettingsManager.getBooleanAppSetting("LicensingIsEnabled").toString(),e["x-CacheIsEnabled"]=this._appSettingsManager.getBooleanAppSetting("LicensingRedisIsEnabled").toString(),e["x-OcpsIsEnabled"]=this._appSettingsManager.getBooleanAppSetting("OcpsIsEnabled").toString(),e["x-LicensingAADIdIsEnabled"]=this._appSettingsManager.getBooleanAppSetting("LicensingAadIdIsEnabled").toString(),e},e.prototype.RecordKpiUsage=function(e){var t=this.GetKpiName(e);t&&""!==t&&X.Health.recordKpiUsage(t,0,"stbrown",null)},e.prototype.RecordKPIFailure=function(e,t){var n=this.GetKpiName(t);n&&""!==n&&X.Health.recordKpiFailure(n,e,!1,!0,null)},e.prototype.GetKpiName=function(e){switch(e){case 0:return"AFHSLicensingSuccessfulHTTPResponse";case 1:return"AFHSCloudPolicySuccessfulHTTPResponse";default:return""}},e.LogCategory=3004,e}();(0,o.l)(Z,"4d6fdca2$HttpRequestToPromiseUtility",null,[]);var ee=function(){function e(t,n,i,r,a){void 0===i&&(i=null),void 0===r&&(r=null),void 0===a&&(a=null),this._httpRequestToPromise=null,this._appSettingsManager=null,this._cloudPolicySettingsHelper=null,this._userPrivacySettingsHelper=null,this._licensingIsEnabled=!1,this._ocpsIsEnabled=!1,this._userPrivacySettingsEnabled=!1,this._isO365ConsumerHost=!1,this._isO365CommercialHost=!1,this._licensedControlledFeatureSet=null,this.FalseBooleanPromise=null,this.TrueBooleanPromise=null,this.FeaturesPromise=null,this._httpRequestToPromise=new Z(t,n),this._appSettingsManager=t,this._isO365ConsumerHost=t.getBooleanAppSetting("IsO365ConsumerHost"),this._isO365CommercialHost=t.getBooleanAppSetting("IsO365CommercialHost"),this._cloudPolicySettingsHelper=i,this._userPrivacySettingsHelper=r,this._licensingIsEnabled=t.getBooleanAppSetting("LicensingIsEnabled"),this._ocpsIsEnabled=t.getBooleanAppSetting("OcpsIsEnabled")&&this._isO365CommercialHost,this._userPrivacySettingsEnabled=(t.getBooleanAppSetting("ShowPrivacyDialog")||t.getBooleanAppSetting("TrustCenterDialogIsEnabled"))&&!!r,this.FalseBooleanPromise=new Promise((function(e,t){e(!1)})),this.TrueBooleanPromise=new Promise((function(e,t){e(!0)})),this._licensedControlledFeatureSet=this.GetLicensedControlledFeatures(),this.IsO365Host()?this.FeaturesPromise=this.TryInitializeLicensing(this._licensingIsEnabled,this.GetEndpointUrl(e.ApplicationFeatureHelperBaseUrl),o.i(this,this.ParseApplicationFeatureHelperResponse,"ParseApplicationFeatureHelperResponse")):this.FeaturesPromise=new Promise((function(e){e({})})),this.FeaturesPromise.catch((function(t){S.ULS.sendTraceTag(42513088,e.LogCategory,10,t)}))}return e.prototype.GetLicensedControlledFeatures=function(){for(var e=this._appSettingsManager.containsAppSetting("AllLicensedFeatures")?this._appSettingsManager.getListAppSetting("AllLicensedFeatures"):new Array(0),t=new Q.e(String,J.b.get_ordinal()),n=0;n<e.length;n++)t.add(e[n]);return t},e.prototype.IsO365Host=function(){return this._isO365CommercialHost||this._isO365ConsumerHost},e.prototype.TryInitializeLicensing=function(t,n,i){return S.ULS.sendTraceTag(51185368,e.LogCategory,50,"ApplicationFeatureHelper_TryInitializeLicensing"),this._httpRequestToPromise.createHttpResponsePromise(Object,t,n,i,0)},e.prototype.ParseApplicationFeatureHelperResponse=function(t){var n=x.x.deserialize(t);return n?(S.ULS.sendTraceTag(50436170,e.LogCategory,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),S.ULS.sendTraceTag(50938594,e.LogCategory,50,"{0}",n)):S.ULS.sendTraceTag(50436171,e.LogCategory,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set. Response was {0}",t),n.Features},e.prototype.GetEndpointUrl=function(e){return String.format("{0}{1}?{2}",this._appSettingsManager.getStringAppSetting("WebServiceBase"),e,L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion)},e.prototype.isFeatureEnabled=function(t,n){var i=this;if(!this._ocpsIsEnabled&&!this._userPrivacySettingsEnabled&&"ConnectedServices"===t||!this._licensingIsEnabled&&"ConnectedServices"!==t)return this.TrueBooleanPromise;if(S.ULS.sendTraceTag(42513091,e.LogCategory,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",t),"ConnectedServices"===t){var r=this._ocpsIsEnabled?this._cloudPolicySettingsHelper.getBooleanPolicySetting("ControllerConnectedServicesEnabled"):this.TrueBooleanPromise,o=this._userPrivacySettingsEnabled?this._userPrivacySettingsHelper.getSettings().then((function(e){return 2!==e.controllerServicesStateRoaming}),(function(e){return n})):this.TrueBooleanPromise;return r.then((function(e){return e?o:i.FalseBooleanPromise}))}var a=null;a=this._ocpsIsEnabled?this._cloudPolicySettingsHelper.isFeatureEnabled(t):this.TrueBooleanPromise;var l=null;l=this._licensingIsEnabled?this.IsFeatureAllowedByUserLicense(t,n):this.TrueBooleanPromise;var s=null;return s=this._userPrivacySettingsEnabled?this._userPrivacySettingsHelper.isFeatureEnabled(t):this.TrueBooleanPromise,a.then((function(e){return e?s.then((function(e){return e?l:i.FalseBooleanPromise})):i.FalseBooleanPromise})).then((function(e){return e}),(function(e){return n}))},e.prototype.getFeatureTier=function(t,n){var i=this;return this._licensingIsEnabled?(S.ULS.sendTraceTag(42804871,e.LogCategory,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",t),this.FeaturesPromise.then((function(e){return t in e?i.ParseTierName(e[t],n):n}),(function(e){return n}))):new Promise((function(e,t){e(2)}))},e.prototype.ParseTierName=function(e,t){switch(e.toLowerCase()){case"unknown":return 0;case"basic":return 1;case"premium":return 2;default:return t}},e.prototype.IsFeatureAllowedByUserLicense=function(e,t){return this._licensingIsEnabled&&this._licensedControlledFeatureSet.contains(e)?this.FeaturesPromise.then((function(t){return e in t}),(function(e){return t})):this.TrueBooleanPromise},e.LogCategory=3004,e.ApplicationFeatureHelperBaseUrl="/afhs/ApplicationFeatureHelperHandler.ashx",e}();(0,o.l)(ee,"30aa93c7$ApplicationFeatureHelper",null,[j.a]);var te=function(){return function(){this.PolicySettings=null,this.ControllerConnectedServicesFeatureNames=null}}();(0,o.l)(te,"f9191224$CloudPolicySettingsData",null,[]);var ne=function(){function e(t,n){this._httpRequestToPromise=null,this._appSettingsManager=null,this._controllerConnectedServicesSet=null,this._ocpsIsEnabled=!1,this.CloudPolicySettingsPromise=null,this._ocpsPolicyDefaults={},this._httpRequestToPromise=new Z(t,n),this._appSettingsManager=t,this._ocpsIsEnabled=t.getBooleanAppSetting("OcpsIsEnabled")&&t.getBooleanAppSetting("IsO365CommercialHost"),this._ocpsPolicyDefaults=x.x.secureDeserialize(t.getStringAppSetting("OcpsDefaultSettings")||"{}");var i=this._appSettingsManager.containsAppSetting("ServicesControlsMicrosoftControllerServicesList")?this._appSettingsManager.getListAppSetting("ServicesControlsMicrosoftControllerServicesList"):new Array(0);this._controllerConnectedServicesSet=new Q.e(String,J.b.get_ordinal());for(var r=0;r<i.length;r++)this._controllerConnectedServicesSet.add(i[r]);this.CloudPolicySettingsPromise=this.TryInitialize(this._ocpsIsEnabled,this.GetEndpointUrl(e.CloudPolicySettingsBaseUrl),o.i(this,this.ParseCloudPolicySettingsResponse,"ParseCloudPolicySettingsResponse")),this.CloudPolicySettingsPromise.catch((function(t){S.ULS.sendTraceTag(50622685,e.LogCategory,10,t)}))}return e.prototype.getBooleanPolicySetting=function(t,n){var i=this;if(void 0===n&&(n=!0),!this._ocpsIsEnabled)return new Promise((function(e,n){e(i.GetOcpsBooleanPolicyDefault(t))}));var r=this.CloudPolicySettingsPromise.then((function(e){try{var r=e.PolicySettings.unknown;return new Promise((function(e,n){e("0"!==r[t])}))}catch(e){return S.ULS.sendTraceTag(50622686,306,10,"Failed to get "+t+" policy value. Error Message: {0}",e.message),i.HandleError(e.toString(),n,i.GetOcpsBooleanPolicyDefault(t))}}),(function(e){return i.HandleError(e,n,i.GetOcpsBooleanPolicyDefault(t))}));return r.then((function(n){return S.ULS.sendTraceTag(50651667,e.LogCategory,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",t,n),null})),r},e.prototype.isFeatureEnabled=function(t,n){void 0===n&&(n=!0);var i=new Promise((function(e,t){e(!0)})),r="";return this._controllerConnectedServicesSet.contains(t)&&(r=e.ControllerConnectedServiceEnabledPolicy,i=this.getBooleanPolicySetting(r,n)),i.then((function(n){return S.ULS.sendTraceTag(50651668,e.LogCategory,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",t,n,r),null})),i},e.prototype.HandleError=function(e,t,n){return t?new Promise((function(e,t){e(n)})):new Promise((function(t,n){n(e)}))},e.prototype.TryInitialize=function(e,t,n){return this._httpRequestToPromise.createHttpResponsePromise(te,e,t,n,1)},e.prototype.GetEndpointUrl=function(e){return String.format("{0}{1}?{2}",this._appSettingsManager.getStringAppSetting("WebServiceBase"),e,L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion)},e.prototype.ParseCloudPolicySettingsResponse=function(t){var n=null;return x.x.tryDeserialize(te,t,(0,g.m)((function(){return n}),(function(e){return n=e}))),S.ULS.sendTraceTag(50622687,e.LogCategory,n?50:10,"ParseApplicationFeatureHelperResponse: fetched CloudPolicySettingsData from {0}",t),n},e.prototype.GetOcpsBooleanPolicyDefault=function(e){return!(e in this._ocpsPolicyDefaults)||"0"!==this._ocpsPolicyDefaults[e]},e.LogCategory=3004,e.CloudPolicySettingsBaseUrl="/afhs/CloudPolicySettings.ashx",e.ControllerConnectedServiceEnabledPolicy="ControllerConnectedServicesEnabled",e}();(0,o.l)(ne,"e68ec75d$CloudPolicySettingsHelper",null,[K.c]);var ie=function(){function e(){this.controllerServicesStateRoaming=0,this.userContentStateRoaming=0,this.downloadContentStateRoaming=0,this.controllerServicesTimeRoaming=null,this.userContentTimeRoaming=null,this.downloadContentTimeRoaming=null,this.userPrivacySettingsRoamedNoticeShown=0,this._source=0,this.controllerServicesStateRoaming=0,this.userContentStateRoaming=0,this.downloadContentStateRoaming=0,this.controllerServicesTimeRoaming="",this.userContentTimeRoaming="",this.downloadContentTimeRoaming="",this.userPrivacySettingsRoamedNoticeShown=2,this._source=2}return e.prototype.clone=function(){var t=new e;return t.controllerServicesStateRoaming=this.controllerServicesStateRoaming,t.userContentStateRoaming=this.userContentStateRoaming,t.downloadContentStateRoaming=this.downloadContentStateRoaming,t.controllerServicesTimeRoaming=this.controllerServicesTimeRoaming,t.userContentTimeRoaming=this.userContentTimeRoaming,t.downloadContentTimeRoaming=this.downloadContentTimeRoaming,t.userPrivacySettingsRoamedNoticeShown=this.userPrivacySettingsRoamedNoticeShown,t._source=this._source,t},e.prototype.get_src=function(){return this._source},e.prototype.set_src=function(e){return this._source=e,e},e.prototype.serialize=function(t){void 0===t&&(t=null);var n={};return t&&!t.contains(e.officePrivacyControllerConnectedServicesKey)||(n[e.officePrivacyControllerConnectedServicesKey]=this.controllerServicesStateRoaming),t&&!t.contains(e.officePrivacyControllerConnectedServicesTimeKey)||(n[e.officePrivacyControllerConnectedServicesTimeKey]=this.controllerServicesTimeRoaming),t&&!t.contains(e.officePrivacyRoamedNoticeShownKey)||(n[e.officePrivacyRoamedNoticeShownKey]=this.userPrivacySettingsRoamedNoticeShown),JSON.stringify(n)},e.create=function(t,n){void 0===n&&(n=null);var i=new e;return i._source=t,null!=n&&(e.officePrivacyControllerConnectedServicesKey in n&&(i.controllerServicesStateRoaming=n[e.officePrivacyControllerConnectedServicesKey]),e.officePrivacyControllerConnectedServicesTimeKey in n&&(i.controllerServicesTimeRoaming=n[e.officePrivacyControllerConnectedServicesTimeKey]),e.officePrivacyRoamedNoticeShownKey in n&&(i.userPrivacySettingsRoamedNoticeShown=n[e.officePrivacyRoamedNoticeShownKey])),i},e.deserialize=function(t,n){try{var i=JSON.parse(t);if(null!=i)return e.create(n,i);throw S.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",t),Error.argument("settingsData")}catch(e){throw S.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",e.toString()),e}},e.officePrivacyControllerConnectedServicesKey="CCS",e.officePrivacyControllerConnectedServicesTimeKey="CCSTime",e.officePrivacyRoamedNoticeShownKey="OfficePrivacyRoamedNoticeShown",e}();(0,o.l)(ie,"56a97f48$UserPrivacySettings",null,[]);var re=n(8977),oe=function(){function e(e,t){if(this._settings=null,this._settingsPromise=null,this._appSettingsManager=null,this._clientRequestManager=null,null==e||null==t)throw Error.argumentNull("appSettingsManager/clientRequestManager");this._appSettingsManager=e,this._clientRequestManager=t,this._settings=null,this._settingsPromise=null}return e.prototype.GetEndpointUrl=function(t){var n=this._appSettingsManager.get_appSettings().RoamingServiceHandlerWebServiceBase||"",i=String.format(e.RoamingServiceHandlerBaseUrl,n),r=new Sys.StringBuilder(i);return r.append(t),r.append("&"),r.append(L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion),r.toString()},e.prototype.ExecuteRequest=function(t,n,i,r){return void 0===r&&(r=null),this._clientRequestManager.addRequestWithTaskAndStopWatch(t,n,r,null,!1,2,null,i,"33",!1,null,e.GetUserPrivacySettingsRequestSentTimeoutMs)},e.prototype.saveSettings=function(t){var n=this;return new Promise((function(i,r){try{if(void 0===n._settings||null===n._settings||null==t)return S.ULS.sendTraceTag(51258443,e.LogCategory,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),void r("Can't determine setting changes to save");var o=n._settings.controllerServicesStateRoaming!==t.controllerServicesStateRoaming;if(2===n._settings.get_src()&&o)return n.SaveSettingsToQueryParam(t),void i(!0);var a=n.SerializeSettingUpdates(t);if(null==a||!a.length)return S.ULS.sendTraceTag(50917389,e.LogCategory,15,"SaveUserPrivacySettings: returning since nothing changed"),void r("No changes to save");if(1===n._settings.get_src())return void i(n.TrySaveSettingsToCookie(a));if(!n._settings.get_src()){S.ULS.sendTraceTag(51258444,e.LogCategory,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",a);var l=n.ExecuteRequest(n.GetEndpointUrl(e.RoamingSaveHandlerAction),2,"SaveUserPrivacySettingsRequest",a);l.CW((function(t){if(l.get_isCanceled()||l.get_isFaulted())return S.ULS.sendTraceTag(50860929,e.LogCategory,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),void i(!1);var n=l.get_result();void 0!==n.get_args()&&null!==n.get_args()&&void 0!==n.get_args().get_data()&&null!==n.get_args().get_data()&&n.get_args().get_data().httpStatus===Y.k.oK_200?(S.ULS.sendTraceTag(51258445,e.LogCategory,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),i(!0)):(S.ULS.sendTraceTag(51258446,e.LogCategory,10,"SaveUserPrivacySettings: Roaming Request Failed"),i(!1))}))}}catch(t){S.ULS.sendTraceTag(50860930,e.LogCategory,10,"SaveUserPrivacySettings: Exception = {0}",t.toString()),i(!1)}}))},e.prototype.SerializeSettingUpdates=function(t){if(void 0===this._settings||null===this._settings||null==t)throw Error.invalidOperation("User Privacy settings have not been initialized");var n=new C.c(String);return t.get_src()?1===t.get_src()&&this._settings.controllerServicesStateRoaming!==t.controllerServicesStateRoaming&&n.add(ie.officePrivacyControllerConnectedServicesKey):(this._settings.controllerServicesStateRoaming!==t.controllerServicesStateRoaming&&(n.add(ie.officePrivacyControllerConnectedServicesKey),n.add(ie.officePrivacyControllerConnectedServicesTimeKey)),this._settings.userPrivacySettingsRoamedNoticeShown!==t.userPrivacySettingsRoamedNoticeShown&&n.add(ie.officePrivacyRoamedNoticeShownKey)),n.get_count()?t.serialize(n):(S.ULS.sendTraceTag(50860931,e.LogCategory,50,"SaveUserPrivacySettings: returning since nothing changed"),null)},e.prototype.getSettings=function(){var t=this;return this._settingsPromise||(this._settingsPromise=new Promise((function(n,i){try{if(t._settings)return void n(t._settings.clone());t.TryGetSettingsFromRoaming().then((function(e){return t._settings=e,n(t._settings.clone()),null}),(function(i){return t.TryGetSettingsFromCookie().then((function(e){return t._settings=e,n(t._settings.clone()),null}),(function(i){return t.TryGetSettingsFromQueryParams().then((function(e){return t._settings=e,n(t._settings.clone()),null}),(function(i){return S.ULS.sendTraceTag(50967430,e.LogCategory,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)"),t._settings=new ie,n(t._settings.clone()),null})),null})),null}))}catch(i){S.ULS.sendTraceTag(50860932,e.LogCategory,10,"UserPrivacySettings GetSettings: Exception = {0}",i.toString()),t._settings=new ie,n(t._settings.clone())}}))),this._settingsPromise},e.prototype.TryGetSettingsFromRoaming=function(){var t=this;return new Promise((function(n,i){try{var r=-1!==window.location.href.indexOf("&wd_pn=2");if(!t._appSettingsManager.getBooleanAppSetting("PrivacyDialogShouldCheckRoaming")&&!r)return S.ULS.sendTraceTag(50860933,e.LogCategory,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),void i("Roaming should not be used");var o=t.ExecuteRequest(t.GetEndpointUrl(e.RoamingGetHandlerAction),1,"GetUserPrivacySettingsRequest");o.CW((function(t){try{if(!o.get_isCanceled()&&!o.get_isFaulted()){var r=o.get_result();if(r&&r.get_args()&&r.get_args().get_data())if(r.get_args().get_data().httpStatus!==Y.k.oK_200)S.ULS.sendTraceTag(50860936,e.LogCategory,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",r.get_args().get_data().httpStatus);else{if(r.get_args().get_data().responseData)return n(e.Parse(r.get_args().get_data().responseData,0)),void S.ULS.sendTraceTag(51258447,e.LogCategory,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",r.get_args().get_data().responseData);S.ULS.sendTraceTag(50860937,e.LogCategory,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else S.ULS.sendTraceTag(50860935,e.LogCategory,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");return void i("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}S.ULS.sendTraceTag(50860934,e.LogCategory,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure")}catch(t){return S.ULS.sendTraceTag(50860938,e.LogCategory,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",t.toString()),void i("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}}))}catch(t){return S.ULS.sendTraceTag(50860939,e.LogCategory,10,"TryGetSettingsFromRoaming Exception = {0}",t.toString()),void i("UserPrivacySettings TryGetSettingsFromRoaming Exception")}}))},e.prototype.TryGetSettingsFromCookie=function(){var t=this;return new Promise((function(n,i){try{var r=re.z.get(e.UserPrivacySettingsCookieName),o=null;if(null!=r&&r.length>0&&(o=decodeURIComponent(r)),null!=o&&o.length>0){var a=e.Parse(o,1);return S.ULS.sendTraceTag(51258448,e.LogCategory,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",a.toString()),void n(a)}var l=ie.create(1),s=new C.c(String);s.add(ie.officePrivacyControllerConnectedServicesKey);var u=l.serialize(s);return t.TrySaveSettingsToCookie(u)?(S.ULS.sendTraceTag(51258449,e.LogCategory,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",l.toString()),void n(l)):(S.ULS.sendTraceTag(51258450,e.LogCategory,10,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",l.toString()),void i("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}catch(t){S.ULS.sendTraceTag(50860941,e.LogCategory,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",t.toString()),i("UserPrivacySettings TryGetSettingsFromCookie Eception")}}))},e.prototype.TryGetSettingsFromQueryParams=function(){return new Promise((function(t,n){try{var i=-1!==window.location.href.indexOf("&wdccsoff=1"),r=ie.create(2);return i?(r.controllerServicesStateRoaming=2,L.AFrameworkApplication.disableControllerServicesViaQueryParam(),S.ULS.sendTraceTag(51258451,e.LogCategory,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",r.toString())):(r.controllerServicesStateRoaming=1,S.ULS.sendTraceTag(51258452,e.LogCategory,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",r.toString())),void t(r)}catch(n){S.ULS.sendTraceTag(50967431,e.LogCategory,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",n.toString()),(r=ie.create(2)).controllerServicesStateRoaming=1,t(r)}}))},e.prototype.SaveSettingsToQueryParam=function(t){return S.ULS.sendTraceTag(51258453,e.LogCategory,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam"),2===t.controllerServicesStateRoaming?L.AFrameworkApplication.disableControllerServicesViaQueryParam():L.AFrameworkApplication.enableControllerServicesViaQueryParam(),S.ULS.sendTraceTag(51258454,e.LogCategory,50,"SaveSettingsToQueryParam saved settings = {0}",t),!0},e.prototype.TrySaveSettingsToCookie=function(t){try{S.ULS.sendTraceTag(51258455,e.LogCategory,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",t);var n=this._appSettingsManager.getStringAppSetting("PrivacyCookieDomain")||"";if(!n||!n.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");return S.ULS.sendTraceTag(51258456,e.LogCategory,50,"SaveUserPrivacySettings to Cookie {0}",t),re.z.setWithAllTheThings(e.UserPrivacySettingsCookieName,t,re.z.maxComplianceAllowedRetentionInDays,"/",n)}catch(t){return S.ULS.sendTraceTag(50860942,e.LogCategory,50,"SaveUserPrivacySettings to Cookie Exception = {0}",t.toString()),!1}},e.prototype.isFeatureEnabled=function(t){var n=this;return this.getSettings().then((function(e){for(var i=n._appSettingsManager.containsAppSetting("ServicesControlsMicrosoftControllerServicesList")?n._appSettingsManager.getListAppSetting("ServicesControlsMicrosoftControllerServicesList"):new Array(0),r=new Q.e(String,J.b.get_ordinal()),o=0;o<i.length;o++)r.add(i[o]);return!r.contains(t)||2!==e.controllerServicesStateRoaming}),(function(n){return S.ULS.sendTraceTag(50860945,e.LogCategory,10,"Failed to get privacy setting for feature {0}",t),!0}))},e.Parse=function(t,n){try{return S.ULS.sendTraceTag(50860943,e.LogCategory,50,"Parsing user privacy settings {0} from {1}",t,n),ie.deserialize(t,n)}catch(t){throw S.ULS.sendTraceTag(50860944,e.LogCategory,10,"GetUserPrivacySettings Exception = {0}",t.toString()),t}},e.LogCategory=3004,e.RoamingGetHandlerAction="getUserPrivacySettings",e.RoamingSaveHandlerAction="saveUserPrivacySettings",e.RoamingServiceHandlerBaseUrl="{0}RoamingServiceHandler.ashx?action=",e.GetUserPrivacySettingsRequestSentTimeoutMs=6e4,e.UserPrivacySettingsCookieName="WacUPToggleState",e}();(0,o.l)(oe,"702286db$UserPrivacySettingsHelper",null,[q.l]);var ae=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register(K.c).singleInstance().usingFactory((function(){return new ne(L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.theClientRequestManager)})),this._container.register(q.l).singleInstance().usingFactory((function(){return new oe(L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.theClientRequestManager)})),this._container.register(j.a).singleInstance().usingFactory((function(){return new ee(L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.theClientRequestManager,t._container.resolve(K.c),t._container.resolve(q.l),L.AFrameworkApplication.get_theActionManager())}))},e.prototype.init=function(){var t=this;L.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){var n=t._container.resolve(j.a);L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LicensingIsEnabled")&&(n.isFeatureEnabled("LicensingTestFeature",!1).then((function(t){return S.ULS.sendTraceTag(42513092,e.LogCategory,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",t,L.AFrameworkApplication.appSettingsManager.getStringAppSetting("IsAnonymousUser")),null})),n.getFeatureTier("LicensingTestFeature",0).then((function(t){return S.ULS.sendTraceTag(42804872,e.LogCategory,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",t,L.AFrameworkApplication.appSettingsManager.getStringAppSetting("IsAnonymousUser")),null})))}))},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e.LogCategory=3004,e}();(0,o.l)(ae,"a897343d$ApplicationFeatureHelperPackage",null,[s.u,u.s]);var le=(0,o.y)("da21b5f6$IUserActivityHostNotificationManager"),se=n(1771),ue=n(7376),ce=n(3427),de=n(6968),ge=n(4952),pe=n(8311),he=n(4401),_e=function(){function e(e,t,n,i,r,a,l){void 0===l&&(l=0),this._editHappenedInTimeWindow=!1,this._hostPostmessengerTask=null,this._notificationTask=null,this._taskManager=null,this._notificationIntervalInMs=0,this._editNotificationEventSource=null,this._userActivityHostNotificationManager=null,this._editNotificationPostMessageIsEnabled=!1,this._editDocumentTelemetryReportingTask=null,this._editDocumentUserActionReportingIntervalInMs=0,this._hasAnotherEditBeenMadeSinceLastEditDocumentTelemetryReport=!1,this.$$pf_UserEverEdited=!1,this._taskManager=t,this._notificationIntervalInMs=e,this._hostPostmessengerTask=n,this._editNotificationEventSource=i,this._userActivityHostNotificationManager=r,this._editNotificationPostMessageIsEnabled=a,this._editDocumentUserActionReportingIntervalInMs=0,this._hasAnotherEditBeenMadeSinceLastEditDocumentTelemetryReport=!1;try{l>0&&(this._editDocumentUserActionReportingIntervalInMs=l,this._editDocumentUserActionReportingIntervalInMs<3e5&&(this._editDocumentUserActionReportingIntervalInMs=3e5),this._taskManager&&!this._editDocumentTelemetryReportingTask&&(this._editDocumentTelemetryReportingTask=new ge.c(3,2,this._editDocumentUserActionReportingIntervalInMs,o.i(this,this.ReportEditDocumentUserActionTelemetryIfNecessary,"ReportEditDocumentUserActionTelemetryIfNecessary")),this._taskManager.addTask(this._editDocumentTelemetryReportingTask)))}catch(e){S.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+e)}}return e.prototype.get_userEverEdited=function(){return this.$$pf_UserEverEdited},e.prototype.set_userEverEdited=function(e){return this.$$pf_UserEverEdited=e,e},e.prototype.editHappened=function(){this.get_userEverEdited()?this._hasAnotherEditBeenMadeSinceLastEditDocumentTelemetryReport=!0:(this.set_userEverEdited(!0),X.Health.get_instance().addQosPillar("Save"),pe.k.sendUserActionEvent(de.j.createUserActionEvent("EditDocument"))),this._editHappenedInTimeWindow=!0,this._userActivityHostNotificationManager&&this._userActivityHostNotificationManager.activityHappened(),this._editNotificationEventSource&&this._editNotificationEventSource.raiseEditHappenedEvent(),L.AFrameworkApplication.dataPlumber&&L.AFrameworkApplication.dataPlumber.markAsRealEditSession(),this._editNotificationPostMessageIsEnabled&&(this._notificationTask||(this.SendPostMessageIfNecessary(null),this._notificationTask=new ge.c(3,2,this._notificationIntervalInMs,o.i(this,this.SendPostMessageIfNecessary,"SendPostMessageIfNecessary"),113),this._taskManager.addTask(this._notificationTask)))},e.prototype.SendPostMessageIfNecessary=function(e){var t=this;this._editHappenedInTimeWindow&&(this._hostPostmessengerTask.CWR(Boolean,(function(e){return t._hostPostmessengerTask.get_result().sendMessage(he.a.editNotification,null)})),S.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this._editHappenedInTimeWindow=!1)},e.prototype.ReportEditDocumentUserActionTelemetryIfNecessary=function(e){try{this._hasAnotherEditBeenMadeSinceLastEditDocumentTelemetryReport&&(pe.k.sendUserActionEvent(de.j.createUserActionEvent("EditDocument")),this._hasAnotherEditBeenMadeSinceLastEditDocumentTelemetryReport=!1)}catch(e){this._hasAnotherEditBeenMadeSinceLastEditDocumentTelemetryReport=!1,S.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+e)}},e}();(0,o.l)(_e,"891a8d08$EditNotificationManager",null,[ue.w]);var me=n(2017),fe=function(){function e(e,t,n,i,r){this._hostPostmessengerTask=null,this._mouseInputManager=null,this._notificationTask=null,this._handlerTask=null,this._taskManager=null,this._notificationIntervalInMs=0,this._activityHappenedInTimeWindow=!1,this.$$pf_UserWasEverActive=!1,this._handlerRegistered=!1,this._onBeforeShutdownSubscriber=null,this._taskManager=t,this._notificationIntervalInMs=e,this._hostPostmessengerTask=n,this._mouseInputManager=i,this._onBeforeShutdownSubscriber=r,this.RegisterHandlerTask(null)}return e.prototype.get_userWasEverActive=function(){return this.$$pf_UserWasEverActive},e.prototype.set_userWasEverActive=function(e){return this.$$pf_UserWasEverActive=e,e},e.prototype.RegisterHandlerTask=function(e){var t=this,n=document.getElementById(L.AFrameworkApplication.applicationOuterContainerId);!this._handlerRegistered&&this._mouseInputManager&&n&&(this._mouseInputManager.registerHandler(me.d.mouseOver,n,o.i(this,this.MouseActivityHandler,"MouseActivityHandler"),null),this._handlerRegistered=!0),this._onBeforeShutdownSubscriber((function(e,n){t.dispose()}))},e.prototype.MouseActivityHandler=function(e){return this._handlerRegistered&&(this._mouseInputManager.unregisterHandler(me.d.mouseOver,document.getElementById(L.AFrameworkApplication.applicationOuterContainerId),o.i(this,this.MouseActivityHandler,"MouseActivityHandler")),this._handlerRegistered=!1),this.activityHappened(),!1},e.prototype.activityHappened=function(){this.set_userWasEverActive(!0),this._activityHappenedInTimeWindow=!0,this._handlerTask||(this._handlerTask=new ge.c(3,2,this._notificationIntervalInMs,o.i(this,this.RegisterHandlerTask,"RegisterHandlerTask"),112),this._taskManager.addTask(this._handlerTask)),this._notificationTask||(this.SendPostMessageIfNecessary(null),this._notificationTask=new ge.c(3,2,this._notificationIntervalInMs,o.i(this,this.SendPostMessageIfNecessary,"SendPostMessageIfNecessary"),111),this._taskManager.addTask(this._notificationTask))},e.prototype.SendPostMessageIfNecessary=function(e){var t=this;this._activityHappenedInTimeWindow&&(this._hostPostmessengerTask.CWR(Boolean,(function(e){return t._hostPostmessengerTask.get_result().sendMessage(he.a.userActivity,null)})),S.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this._activityHappenedInTimeWindow=!1)},e.prototype.dispose=function(){this._handlerRegistered&&(this._mouseInputManager.unregisterHandler(me.d.mouseOver,document.getElementById(L.AFrameworkApplication.applicationOuterContainerId),o.i(this,this.MouseActivityHandler,"MouseActivityHandler")),this._handlerRegistered=!1)},e}();(0,o.l)(fe,"7f531688$UserActivityHostNotificationManager",null,[le,Sys.IDisposable]);var ye=n(9741),Ce=n(4336),Se=n(1436),be=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.EditNotification"},e.prototype.init=function(){L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady(o.i(this,this.OnFullAppSettingsReady,"OnFullAppSettingsReady"))},e.prototype.OnFullAppSettingsReady=function(){var t=this;e.get_EditNotificationIsEnabled()&&e.get_EditNotificationInterval()>0&&(this._container.register(ce.n).singleInstance(),this._container.register(fe).as(le).singleInstance().usingFactory((function(){return new fe(6e4,Ce.y.get_instance(),Se.q.taskFromFuture(se.i,t._container.resolveFuture(se.i)),ye.p.get_instance(),L.AFrameworkApplication.subscribeToBeforeAppShutDown)})),this._container.register(_e).as(ue.w).singleInstance().usingFactory((function(){return new _e(e.get_EditNotificationInterval(),Ce.y.get_instance(),Se.q.taskFromFuture(se.i,t._container.resolveFuture(se.i)),t._container.resolve(ce.n),t._container.tryResolve(le),e.get_EditNotificationPostMessageIsEnabled(),e.get_EditDocumentUserActionTelemetryReportingIntervalInMilliseconds())})),this._container.resolve(ue.w),S.ULS.shipAssertTag(38086291,209,e.get_EditNotificationInterval()>0,"EditNotification Interval is less than or equal to 0."))},e.prototype.configure=function(e){this._container=e},e.prototype.dispose=function(){},e.get_EditNotificationInterval=function(){return L.AFrameworkApplication.appSettingsManager?parseInt(L.AFrameworkApplication.appSettingsManager.get_appSettings().EditNotificationTimeIntervalMs||"300000"):3e5},e.get_EditDocumentUserActionTelemetryReportingIntervalInMilliseconds=function(){return L.AFrameworkApplication.appSettingsManager?parseInt(L.AFrameworkApplication.appSettingsManager.get_appSettings().EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0},e.get_EditNotificationIsEnabled=function(){return!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EditNotificationIsEnabled")},e.get_EditNotificationPostMessageIsEnabled=function(){return!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EditNotificationPostMessageIsEnabled")},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(be,"d19361d0$CommonHostNotificationPackage",null,[s.u,u.s]);var ve=(0,o.y)("f4bfe6a9$IUpsellActor"),Te=(0,o.y)("7606625c$IChatManager"),Ae=(0,o.y)("6588c279$IReactSharedHeaderFocusManager"),Ie=n(5403),we=function(){function e(){}return e.meControlFlexPaneFocusId="ReactSharedHeaderMeControlFlexPane",e.headerUiFocusId="headerui",e.chatFocusId="chat_wrapper_pane",e}();(0,o.l)(we,"6ca38ca9$ReactSharedHeaderConstants",null,[]);var xe=function(){function e(e){this._reactSharedHeaderFocusManager=null,this._previousNumberOfChats=0,this._chatContainerId=null,this._reactSharedHeaderFocusManager=e}return e.prototype.get_Chat=function(){return window.swc},e.prototype.get_IsInitialized=function(){return!!this.get_Chat()},e.prototype.get_SharedHeaderFocusManager=function(){return this._reactSharedHeaderFocusManager.get_value()},e.prototype.registerActions=function(){this.get_IsInitialized()?this.RegisterActionsInternal():this.RegisterOnChatReady(o.i(this,this.RegisterActionsInternal,"RegisterActionsInternal"))},e.prototype.RegisterActionsInternal=function(){var e=this;S.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.get_IsInitialized()&&(this.get_Chat().getContainerProvider().then((function(t){t.getChatsContainer(o.i(e,e.OnChatContainerReady,"OnChatContainerReady"))})).catch((function(e){S.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",e)})),this.get_Chat().getChatsCounter().then((function(t){t.onChatsCountChange(o.i(e,e.ChatCountChanged,"ChatCountChanged"))})).catch((function(e){S.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",e)})),this.get_Chat().getKeyboard().then((function(t){t.onKeyDown(o.i(e,e.OnChatKeyPress,"OnChatKeyPress"))})).catch((function(e){S.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",e)})))}catch(e){S.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",e)}},e.prototype.ChatCountChanged=function(e){if(S.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",e),e){if(1===e&&!this._previousNumberOfChats){var t=document.getElementById(this._chatContainerId?this._chatContainerId:we.chatFocusId);t?this.get_SharedHeaderFocusManager().onChatOpen(t,o.i(this,this.TransferFocusToChat,"TransferFocusToChat")):S.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}}else this.get_SharedHeaderFocusManager().onChatClose();this._previousNumberOfChats=e},e.prototype.OnChatContainerReady=function(e){this._chatContainerId=e},e.prototype.OnChatKeyPress=function(e){e.ctrlKey&&"f6"===e.key.toLowerCase()&&this.TransferFocusFromChat(e.shiftKey)},e.prototype.RegisterOnChatReady=function(e){Ie.z.get_instance().registerHandler(me.d.swcReady,window.self,(function(t){return e(),!0}))},e.prototype.TransferFocusToChat=function(){S.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.get_IsInitialized()&&this.get_Chat().getFocuser().then((function(e){e.focusConversationInput()})).catch((function(e){S.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",e)}))}catch(e){S.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",e)}},e.prototype.TransferFocusFromChat=function(e){S.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat"),this.get_SharedHeaderFocusManager().onChatCtrlF6(e)},e}();(0,o.l)(xe,"7cadcdf5$ChatManager",null,[Te]);var Ee=n(2877),Fe=n(6573),Pe=n(3297),De=n(4802),Re=n(6216),Me=n(2338),ke=function(){function e(e,t,n,i,r){this._focusManager=null,this._f6Manager=null,this._mouseInputManager=null,this._touchInputManager=null,this._actionManager=null,this._transferFocusToChat=null,this._focusManager=e,this._f6Manager=t,this._mouseInputManager=n,this._touchInputManager=i,this._actionManager=r}return e.prototype.RegisterF6=function(e,t,n,i){void 0===i&&(i=null);var r=this._focusManager.getScope(t);r.parent=n,r.set_keyDownHandledExternally(!0),i&&r.addOnFocus(i),this._mouseInputManager.addControlFocus(t,e,!1),this._touchInputManager.addControlFocus(t,e,!1);var o=new De.DOMFocusListing((function(){return e}));o.addValidTag(2),o.addValidTag(1),o.addValidTag(8),o.addValidTag(5),o.addValidTag(3),o.addValidTag(6),this._focusManager.buildRegionWithDelegate((function(){return e}),r,o).looped=!0;var a=Me.KeyInputManager.hashKey(Re.v.vK_Tab,0),l=Me.KeyInputManager.hashKey(Re.v.vK_Tab,4);r.unBindAction(a),r.unBindAction(l)},e.prototype.onFlexPaneOpen=function(e){this.RegisterF6(e,we.meControlFlexPaneFocusId,we.headerUiFocusId),this._focusManager.setScope(we.meControlFlexPaneFocusId),this._f6Manager.addF6(we.meControlFlexPaneFocusId)},e.prototype.onFlexPaneClose=function(e){this._f6Manager.deactivateFocus(we.meControlFlexPaneFocusId),this._focusManager.setScope(we.headerUiFocusId)},e.prototype.onChatOpen=function(e,t){this._transferFocusToChat||(this._transferFocusToChat=t,this.RegisterF6(e,we.chatFocusId,Pe.AFrame.appFocusId,o.i(this,this.OnChatFocus,"OnChatFocus"))),this._focusManager.setScope(we.chatFocusId),this._f6Manager.addF6(we.chatFocusId)},e.prototype.OnChatFocus=function(e,t){this._transferFocusToChat&&this._transferFocusToChat()},e.prototype.onChatClose=function(){this._f6Manager.deactivateFocus(we.chatFocusId),this._focusManager.forceScopeChange(Pe.AFrame.documentFocusID)},e.prototype.onChatCtrlF6=function(e){this._actionManager.processAction(e?Fe.b.f6shift:Fe.b.f6,2)},e}();(0,o.l)(ke,"a522b0b0$ReactSharedHeaderFocusManager",null,[Ae]);var Ne,Le=n(608);!function(e){e[e[void 0]=0]="undefined",e[e.wordViewer=37]="wordViewer",e[e.wordEditor=38]="wordEditor",e[e.excelViewer=39]="excelViewer",e[e.excelEditor=40]="excelEditor",e[e.powerPointViewer=41]="powerPointViewer",e[e.powerPointEditor=42]="powerPointEditor",e[e.oneNoteEditor=43]="oneNoteEditor",e[e.oneNoteViewer=44]="oneNoteViewer",e[e.wordViewerDialog=45]="wordViewerDialog",e[e.wordEditorDialog=46]="wordEditorDialog",e[e.excelViewerDialog=47]="excelViewerDialog",e[e.excelEditorDialog=48]="excelEditorDialog",e[e.powerPointViewerDialog=49]="powerPointViewerDialog",e[e.powerPointEditorDialog=50]="powerPointEditorDialog"}(Ne||(Ne={})),(0,o.h)("e989737c$FreemiumUpsellTelemetryPath",Ne);var Be=function(){function e(){}return e.getTelemetryPath=function(t){var n=0,i=L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType(),r=L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppMode();switch(i){case 1:n=1!==L.AFrameworkApplication.get_activeFrame().get_mode()?40:39;break;case 2:n=1===r?42:41;break;case 3:n=1===r?38:37;break;case 4:n=1!==L.AFrameworkApplication.get_activeFrame().get_mode()?43:44}return 1!==t||1!==i&&2!==i&&3!==i?n:n+e.telemetryPathOffset},e.telemetryPathOffset=8,e}();(0,o.l)(Be,"1d90723a$FreemiumUtils",null,[]);var Oe=n(2684),Ue=n(1235),He=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.registerActions=function(){this._actionManager.addAction(Fe.b.freemiumUpsellEligible,Ue.m.frame,o.i(this,this.NavigateToUpsellPage,"NavigateToUpsellPage")),this._actionManager.addAction(Fe.b.reportFreemiumUpsellEligibleDisplayed,Ue.m.frame,Le.ActionManager.doNothingButReportHandler),this._actionManager.addAction(Fe.b.reportFreemiumUpsellEligibleClicked,Ue.m.frame,Le.ActionManager.doNothingButReportHandler)},e.prototype.NavigateToUpsellPage=function(e,t,n,i,r){if(1===n)return 32;var o=8;if(2===n){var a=Be.getTelemetryPath(0);if(a){var l=Oe.n.getFwLinkForUpsellFeatures(a);window.open(l,"_blank"),o=32,this._actionManager.processAction(Fe.b.reportFreemiumUpsellEligibleClicked,2),S.ULS.sendTraceTag(38929747,340,50,"Go Premium button was clicked in {0}",Ne[a])}}return o},e}();(0,o.l)(He,"b65f5860$UpsellActor",null,[ve]);var Ge=n(6325),We=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.Header"},e.prototype.init=function(){Ge.w.get_instance().resolve(ve).registerActions(),Ge.w.get_instance().resolve(Te).registerActions()},e.prototype.dispose=function(){},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register(Ee.p).singleInstance(),this._container.register(He).as(ve).singleInstance().usingFactory((function(){return new He(L.AFrameworkApplication.get_theActionManager())})),this._container.register(ke).as(Ae).singleInstance().usingFactory((function(){return new ke(L.AFrameworkApplication.get_activeFrame().get_theFocusManager(),L.AFrameworkApplication.get_activeFrame().get_theF6Manager(),L.AFrameworkApplication.get_activeFrame().get_theMouseInputManager(),L.AFrameworkApplication.get_activeFrame().get_theTouchInputManager(),L.AFrameworkApplication.get_theActionManager())})),this._container.register(xe).as(Te).singleInstance().usingFactory((function(){return new xe(t._container.resolveLazy(Ae))}))},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(We,"b199f991$CommonAppHeaderPackage",null,[s.u,u.s]);var Ve=n(4197),$e=n(6975),ze=(0,o.y)("bc6b07a5$IBasicChatActor"),Ke=(0,o.y)("cc3ff517$ISkypeWebExperienceController"),qe=n(7710),je=(0,o.y)("6081b8d$IFlexPaneFactory"),Qe=n(1935),Je=n(2386),Xe=n(1162),Ye=n(9622),Ze=n(8868),et=(0,o.y)("c353005f$IChatNotificationHandler"),tt=(0,o.y)("ef80ba1c$IChatToastFactory"),nt=n(8108),it=n(417),rt=function(){function e(e,t,n,i,r,o){this._actionManager=null,this._chatClient=null,this._chatClientFactory=null,this._headerEventSourceTask=null,this._headerEventSource=null,this._perfManager=null,this._onBeforeShutdownSubscriber=null,this._appSettingsManager=null,this._disposed=!1,this._unreadConversations=0,this._skypeButton=null,this._secondSkypeButton=null,this._actionManager=e,this._chatClientFactory=t,this._headerEventSourceTask=n,this._perfManager=i,this._onBeforeShutdownSubscriber=r,this._appSettingsManager=o}return e.prototype.initialize=function(){var e=this;this.RegisterActions(),this.InitializeChatClient(),this._onBeforeShutdownSubscriber((function(t,n){e.dispose()}))},e.prototype.OnInitializeComplete=function(e){var t=this;e&&this._headerEventSourceTask.CW((function(e){t.ChatClientAndHeaderReady()}))},e.prototype.ChatClientAndHeaderReady=function(){this._headerEventSource=this._headerEventSourceTask.get_result(),this._headerEventSource.get_topRowControlsCreated()&&this.OnTopRowControlsCreatedEventHandler(null,null),this._headerEventSource.add_onTopRowControlsCreated(o.i(this,this.OnTopRowControlsCreatedEventHandler,"OnTopRowControlsCreatedEventHandler")),this._headerEventSource.add_onTopRowControlsDisposing(o.i(this,this.OnTopRowControlsDisposingEventHandler,"OnTopRowControlsDisposingEventHandler"))},e.prototype.OnTopRowControlsCreatedEventHandler=function(e,t){this.TryEnableSkypeButtonOrButtons(this._headerEventSource.get_standaloneRootControlManager())&&this._chatClient.disable(!1)},e.prototype.OnTopRowControlsDisposingEventHandler=function(e,t){this._skypeButton=null,this._secondSkypeButton=null,this._chatClient.disable(!0)},e.prototype.TryEnableSkypeButtonOrButtons=function(e){return!!e&&(this._skypeButton=this.TryEnableButton(e,it.CuiHelper.skypeButtonId),this._secondSkypeButton=this.TryEnableButton(e,it.CuiHelper.secondSkypeButtonId),this._perfManager.get_userExperienceLoadStopwatch()&&this._perfManager.get_userExperienceLoadStopwatch().stop(),!!this._skypeButton||!!this._secondSkypeButton)},e.prototype.TryEnableButton=function(e,t){var n=null;if(t){try{n=e.getDOMElementForControlDisplayMode(t,it.CuiHelper.skypeButtonDisplayMode)}catch(e){S.ULS.sendTraceTag(18465952,333,10,"Couldn't find the button. Basic Chat will be disabled, message: {0} Callstack: {1}.",e.message,e.stack)}n&&(e.pollForControlState(t),n.style.display="",this.UpdatedUnreadConversationsCount(n,this._unreadConversations))}return n},e.prototype.RegisterActions=function(){this._actionManager.addAction(Fe.b.openBasicChatPane,Ue.m.frame,o.i(this,this.ToggleChatPane,"ToggleChatPane"))},e.prototype.InitializeChatClient=function(){var e=this;this._chatClient=this._chatClientFactory.create(null),this._chatClient.add_paneStateChanged(o.i(this,this.OnPaneStateChanged,"OnPaneStateChanged"));var t=this._chatClient.init();t.CW((function(n){e.OnInitializeComplete(t.get_result())})),this._chatClient.add_unreadConversationsChanged(o.i(this,this.OnUnreadConversationsChanged,"OnUnreadConversationsChanged"))},e.prototype.OnPaneStateChanged=function(e,t){this.TryToggleSkypeButton(this._skypeButton),this.TryToggleSkypeButton(this._secondSkypeButton)},e.prototype.OnUnreadConversationsChanged=function(e,t){var n=t.unreadConversations;n!==this._unreadConversations&&(this.UpdatedUnreadConversationsCount(this._skypeButton,n),this.UpdatedUnreadConversationsCount(this._secondSkypeButton,n),this._unreadConversations=n)},e.prototype.ToggleChatPane=function(e,t,n,i,r){return this._disposed?32:2!==n?32:(this._chatClient.get_chatPaneVisible()?this.HideChatPane():this.ShowChatPane(),32)},e.prototype.ShowChatPane=function(){this._chatClient.showChatPane()},e.prototype.HideChatPane=function(){this._chatClient.hideChatPane()},e.prototype.TryToggleSkypeButton=function(e){if(e){var t=e.querySelector("img");if(!t)return;var n=void 0,i="";t.getAttribute("class")&&((n=t.getAttribute("class").toString()).indexOf(it.CuiHelper.skypeConsumerButtonBlack)>0?i=n.replace(it.CuiHelper.skypeConsumerButtonBlack,it.CuiHelper.skypeConsumerButtonWhite):n.indexOf(it.CuiHelper.skypeConsumerButtonWhite)>0?i=n.replace(it.CuiHelper.skypeConsumerButtonWhite,it.CuiHelper.skypeConsumerButtonBlack):n.indexOf(it.CuiHelper.skypeBusinessButtonBlack)>0?i=n.replace(it.CuiHelper.skypeBusinessButtonBlack,it.CuiHelper.skypeBusinessButtonWhite):n.indexOf(it.CuiHelper.skypeBusinessButtonWhite)>0&&(i=n.replace(it.CuiHelper.skypeBusinessButtonWhite,it.CuiHelper.skypeBusinessButtonBlack)),i.length&&t.setAttribute("class",i),this._appSettingsManager.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled")||(Sys.UI.DomElement.containsCssClass(e,"activated")?Sys.UI.DomElement.removeCssClass(e,"activated"):Sys.UI.DomElement.addCssClass(e,"activated")))}},e.prototype.UpdatedUnreadConversationsCount=function(t,n){if(t){n+=0;var i=t.querySelector("."+it.CuiHelper.skypeUnreadConversationsBubbleClass);if(i)if(n<=0)i.style.display="none",i.innerText="";else{var r=n>99,o=n.toString();r?(o="99+",Sys.UI.DomElement.containsCssClass(i,e.SkypeUnreadBubbleWideClass)||Sys.UI.DomElement.addCssClass(i,e.SkypeUnreadBubbleWideClass)):Sys.UI.DomElement.containsCssClass(i,e.SkypeUnreadBubbleWideClass)&&Sys.UI.DomElement.removeCssClass(i,e.SkypeUnreadBubbleWideClass),i.innerText=o,i.style.display=""}}},e.prototype.dispose=function(){this._disposed||(this._headerEventSource&&(this._headerEventSource.remove_onTopRowControlsCreated(o.i(this,this.OnTopRowControlsCreatedEventHandler,"OnTopRowControlsCreatedEventHandler")),this._headerEventSource.remove_onTopRowControlsDisposing(o.i(this,this.OnTopRowControlsDisposingEventHandler,"OnTopRowControlsDisposingEventHandler")),this._headerEventSource=null),this._chatClient&&(this._chatClient.dispose(),this._chatClient=null),this._skypeButton=null,this._secondSkypeButton=null,this._actionManager=null,this._disposed=!0)},e.SkypeUnreadBubbleWideClass="SkypeUCBWide",e}();(0,o.l)(rt,"1478b38c$BasicChatActor",null,[ze,Sys.IDisposable]);var ot=function(){function e(e){this._stopwatchBuilder=null,this._chatClientAuthStopwatch=null,this._chatClientLoadStopwatch=null,this._chattableStopwatch=null,this._userExperienceLoadStopwatch=null,this._stopwatchBuilder=e}return e.prototype.get_chatClientAuthStopwatch=function(){return this._chatClientAuthStopwatch||(this._chatClientAuthStopwatch=this._stopwatchBuilder.makeStopwatch("WebServiceCall","SkypeBasicChatClientAuth"))},e.prototype.get_chatClientLoadStopwatch=function(){return this._chatClientLoadStopwatch||(this._chatClientLoadStopwatch=this._stopwatchBuilder.makeStopwatch("LoadResource","SkypeBasicChatClientLoad"))},e.prototype.get_chattableStopwatch=function(){return this._chattableStopwatch||(this._chattableStopwatch=this._stopwatchBuilder.makeStopwatch("CommandTask","SkypeBasicChatTimeToChattable"))},e.prototype.get_userExperienceLoadStopwatch=function(){return this._userExperienceLoadStopwatch||(this._userExperienceLoadStopwatch=this._stopwatchBuilder.makeStopwatch("CommandTask","SkypeUserExperienceLoad"))},e}();(0,o.l)(ot,"d9edb42c$BasicChatPerformanceManager",null,[]);var at=n(6963),lt=function(){function e(e,t,n,i){this._chatClientMockFactory=null,this._skypeClientFactory=null,this._appSettingsManager=null,this._lastKnownAvailability=null,this._taskManager=null,this._eventSource=new at.f,this._chatClientMockFactory=t,this._skypeClientFactory=n,this._appSettingsManager=e,this._taskManager=i}return e.prototype.add_AvailabilityChanged=function(t){this._eventSource.addHandler(e.AvailabilityChangedEventKey,t)},e.prototype.remove_AvailabilityChanged=function(t){this._eventSource.removeHandler(e.AvailabilityChangedEventKey,t)},e.prototype.create=function(t){var n=this;return t&&e._clientInstance?(this._lastKnownAvailability&&this._taskManager.addTask(new ge.c(0,1,0,(function(e){t(n._eventSource,n._lastKnownAvailability)}),115)),this.add_AvailabilityChanged(t),e._clientInstance):(e._clientInstance=this._chatClientMockFactory(),e._clientInstance||(e._clientInstance=this._skypeClientFactory()),e._clientInstance.add_availabilityChanged(o.i(this,this.OnAvailabilityChanged,"OnAvailabilityChanged")),t&&this.add_AvailabilityChanged(t),e._clientInstance)},e.prototype.OnAvailabilityChanged=function(t,n){this._lastKnownAvailability=n,this._eventSource.raiseEvent(e.AvailabilityChangedEventKey,n)},e.AvailabilityChangedEventKey="ACEK",e._clientInstance=null,e}();(0,o.l)(lt,"4a53f150$ChatClientFactory",null,[$e.n]);var st=(0,o.y)("6ec65393$IChatClient"),ut=n(2349),ct=n(7069),dt=function(){function e(){}return e.prototype.createDomElementAppendToParent=function(e,t){var n=document.createElement(t);return e.appendChild(n),n},e.SkypeToastManagerClass="SkypeToastManagerContainer",e.SkypeToastDivClass="SkypeToastDiv",e.SkypePresenceAreaClass="SkypePresenceArea",e.SkypePresenceClass="SkypePresenceIndicator",e.SkypePresenceClass_Unknown="skPresenceUnknown",e.SkypePresenceClass_Available="skPresenceAvailable",e.SkypePresenceClass_Away="skPresenceAway",e.SkypePresenceClass_Busy="skPresenceBusy",e.SkypePresenceImageClass="SkypePresenceImage",e.SkypeNotificationAreaClass="SkypeNotificationArea",e.SkypeNotificationTopBar="SkypeNotificationTopBar",e.SkypeNotificationTextClass="SkypeNotificationText",e.SkypeNotificationSenderClass="SkypeNotificationSender",e.SkypeNotificationTitleClass="SkypeNotificationTitle",e.SkypeNotificationMessageClass="SkypeNotificationMessage",e.SkypeNotificationTypeClass="SkypeNotificationType",e.SkypeNotificationActionAreaClass="SkypeNotificationActionArea",e.SkypeNotificationButtonClass="SkypeNotificationButton",e}();(0,o.l)(dt,"3635534d$SkypeToastDomObjectBase",null,[]);var gt=function(e){function t(t,n){var i=e.call(this)||this;return i._toastContainerLazy=null,i._lastToast=null,i._getAppContainer=null,i._toastFactory=null,i._chatNotificationsTemporarilyDisabled=!1,i._getAppContainer=t,i._toastContainerLazy=new nt.q(Object,o.i(i,i.RenderToastContainer,"RenderToastContainer")),i._toastFactory=n,i}return(0,v.t)(t,e),t.prototype.RenderToastContainer=function(){var e=this._getAppContainer(),t=this.createDomElementAppendToParent(e,"div");return Sys.UI.DomElement.addCssClass(t,dt.SkypeToastManagerClass),t},t.prototype.handleNotification=function(e,t){var n=e;if(S.ULS.shipAssertTag(17114644,333,!!n),this.CanHandleNotification(n,t))if(this.ShouldShowToast(n,t)){var i=this._toastFactory.create(t);i.add_onDismiss(o.i(this,this.OnToastDismiss,"OnToastDismiss")),this.AddNewToast(i)}else this.ShouldPlaySound(t)&&t.playSound&&t.playSound()},t.prototype.disable=function(e){this._chatNotificationsTemporarilyDisabled=e},t.prototype.AddNewToast=function(e){this.DismissLastToast(),this.ToggleToastContainerDisplay(!0),this._toastContainerLazy.get_value().appendChild(e.get_element()),this._lastToast=e},t.prototype.DismissLastToast=function(){this._lastToast&&(S.ULS.sendTraceTag(17114645,333,100,"About to show new toast over existing one..."),this._lastToast.dismiss())},t.prototype.CanHandleNotification=function(e,t){return!this._chatNotificationsTemporarilyDisabled&&(3!==e.get_chatClientState()&&(!!t.type&&(!this.get_CurrentlyShowingStickyToast()||(S.ULS.sendTraceTag(17114646,333,100,"Ignoring new [{0}] notification while last A/V toast is still up...",t.type),!1))))},t.prototype.ShouldPlaySound=function(e){return!0},t.prototype.ShouldShowToast=function(e,t){var n;switch(t.level){case 0:n=!1;break;case 1:n=!e.get_chatPaneVisible();break;case 2:n=!0;break;default:n=!1}return S.ULS.sendTraceTag(17118549,333,100,"{0}toast for notification level {1}. Chat Pane was visible: {2}.",n?"SHOW ":"SKIP ",t.level,e.get_chatPaneVisible()),n},t.prototype.get_CurrentlyShowingStickyToast=function(){return!!this._lastToast&&this._lastToast.get_sticky()},t.prototype.ToggleToastContainerDisplay=function(e){this._toastContainerLazy.get_value().style.display=e?"block":"none"},t.prototype.OnToastDismiss=function(e,t){this._lastToast&&(this._toastContainerLazy.get_value().removeChild(this._lastToast.get_element()),this._lastToast.dispose(),this._lastToast=null),this.ToggleToastContainerDisplay(!1)},t.prototype.dispose=function(){this.DismissLastToast()},t.ParseNotificationType=function(e){switch(e.toLowerCase()){case"unreadmessage":return 1;case"chat":return 2;case"audio":return 3;case"contactrequest":return 4;default:return 0}},t}(dt);(0,o.l)(gt,"e3e90158$SkypeToastManager",dt,[et,Sys.IDisposable]);var pt=function(e){function t(t){var n=e.call(this)||this;return n.clientState=0,n.clientState=t,n}return(0,v.t)(t,e),t.prototype.get_clientState=function(){return this.clientState},t}(Sys.EventArgs);(0,o.l)(pt,"b6f6e165$AvailabilityChangedEventArgs",Sys.EventArgs,[]);var ht=function(e){function t(){var t=e.call(this)||this;return t.type=0,t.avatar=null,t.displayName=null,t.presence=null,t.title=null,t.description=null,t.accept=null,t.acceptWithModality=null,t.open=null,t.decline=null,t.playSound=null,t.stopSound=null,t.subscribeToActiveStateChanged=null,t.level=0,t}return(0,v.t)(t,e),t}(Sys.EventArgs);(0,o.l)(ht,"a6fac1c5$ChatNotificationEventArgs",Sys.EventArgs,[]);var _t=function(e){function t(t){var n=e.call(this)||this;return n.paneState=0,n.paneState=t,n}return(0,v.t)(t,e),t.prototype.get_paneState=function(){return this.paneState},t}(Sys.EventArgs);(0,o.l)(_t,"aa295df9$PaneStateChangedEventArgs",Sys.EventArgs,[]);var mt=n(5004),ft=function(){function e(e,t){this._flexPaneFactory=null,this._chatNotificationHandler=null,this._flexPane=null,this._textBox=null,this._chatClientState=0,this._chatClientStateBeforeDisabled=0,this._btnSendNotification1=null,this._btnSendNotification2=null,this.chatPane=null,this._eventSource=new at.f,this._initializeTcs=new ct.z(Boolean),this._flexPaneFactory=e,this._chatNotificationHandler=t,this.set_chatClientState(0)}return e.prototype.get_idAsync=function(){return ut.Task.fromResult(String,L.AFrameworkApplication.userSessionId)},e.prototype.get_chatPane=function(){return this.chatPane},e.prototype.get_chatClientState=function(){return this._chatClientState},e.prototype.set_chatClientState=function(t){return this._chatClientState!==t&&(this._chatClientState=t,this._eventSource.raiseEvent(e.AvailabilityEventKey,new pt(this.get_chatClientState()))),t},e.prototype.get_chatPaneVisible=function(){return!!this._flexPane&&this._flexPane.get_visible()},e.prototype.set_chatPaneVisible=function(t){return this._flexPane?this._flexPane.get_visible()!==t&&(this._flexPane.set_visible(t),this._eventSource.raiseEvent(e.PaneStateChangedEventKey,new _t(t?1:0))):t&&S.ULS.sendTraceTag(8782405,333,15,"Trying to set visible while flexpane is null"),t},e.prototype.add_availabilityChanged=function(t){this._eventSource.addHandler(e.AvailabilityEventKey,t)},e.prototype.remove_availabilityChanged=function(t){this._eventSource.removeHandler(e.AvailabilityEventKey,t)},e.prototype.add_paneStateChanged=function(t){this._eventSource.addHandler(e.PaneStateChangedEventKey,t)},e.prototype.remove_paneStateChanged=function(t){this._eventSource.removeHandler(e.PaneStateChangedEventKey,t)},e.prototype.add_unreadConversationsChanged=function(t){this._eventSource.addHandler(e.UnreadConversationsChangedEventKey,t)},e.prototype.remove_unreadConversationsChanged=function(t){this._eventSource.removeHandler(e.UnreadConversationsChangedEventKey,t)},e.prototype.get_id=function(){return ut.Task.fromResult(String,mt.h.create().toString())},e.prototype.init=function(){return this.EnsureSkypePane(),this.set_chatClientState(2),this._eventSource.raiseEvent(e.AvailabilityEventKey,new pt(2)),this._initializeTcs.setResult(!0),this._initializeTcs.get_task()},e.prototype.showChatPane=function(){this.set_chatPaneVisible(!0),this.get_chatPaneVisible()||this.set_chatPaneVisible(!0)},e.prototype.EnsureSkypePane=function(){this._flexPane||(this._flexPane=this._flexPaneFactory.create("Mock Chat Pane",null,null,Fe.b.openBasicChatPane),this.EnsureMockDom())},e.prototype.EnsureMockDom=function(){var e=document.createElement("div");e.innerText="Notification types: unreadmessage | chat | contactrequest | audio\n\n",e.innerText+="Type in the mock notif type:\n",this._flexPane.get_element().appendChild(e),this._textBox=document.createElement("input"),this._textBox.setAttribute("type","text"),this._textBox.setAttribute("data-lpignore","true"),this._textBox.style.width="100px",this._textBox.style.display="block",this._flexPane.get_element().appendChild(this._textBox);var t=document.createElement("div");t.innerText="\n",this._flexPane.get_element().appendChild(t),this._btnSendNotification1=document.createElement("button"),this._btnSendNotification1.id="chatNotif",this._btnSendNotification1.innerText="Send Chat Notification",this._flexPane.get_element().appendChild(this._btnSendNotification1),$addHandler(this._btnSendNotification1,"mousedown",o.i(this,this.FireMockNotification,"FireMockNotification")),this._flexPane.get_element().appendChild(t),this._btnSendNotification2=document.createElement("input"),this._btnSendNotification2.id="hideThenChatNotif",this._btnSendNotification2.type="button",this._btnSendNotification2.value="Dismiss then Send Chat Notif",this._flexPane.get_element().appendChild(this._btnSendNotification2),$addHandler(this._btnSendNotification2,"mousedown",o.i(this,this.HideThenFireMockNotification,"HideThenFireMockNotification"))},e.prototype.HideThenFireMockNotification=function(e){var t=this;this.hideChatPane(),window.setTimeout((function(){t.FireMockNotification(null)}),0),e.stopPropagation()},e.prototype.FireMockNotification=function(e){var t=this;e.stopPropagation();var n=gt.ParseNotificationType(this._textBox.value),i=(0,U.m)(new ht,{type:n,avatar:null,displayName:"mock name",presence:null,title:"mock title",description:"mock description",accept:function(){t.showChatPane(),t.LogString("notification accepted")},acceptWithModality:function(e){t.showChatPane(),t.LogString("notification accepted with "+e)},open:function(){t.showChatPane(),t.LogString("notification opened")},decline:function(){t.LogString("notification declined")},playSound:function(){t.LogString("notification sound played")},stopSound:function(){t.LogString("notification sound stopped")},subscribeToActiveStateChanged:function(e){},level:1===n?0:2});this._chatNotificationHandler.handleNotification(this,i)},e.prototype.hideChatPane=function(){this.set_chatPaneVisible(!1)},e.prototype.joinConversation=function(e,t,n,i,r){void 0===i&&(i=null),void 0===r&&(r=null),this.LogString(String.format("Trying to join conversation {0}",e)),"mockChatThread"===e&&t()},e.prototype.disable=function(e){e?(this._chatClientStateBeforeDisabled=this.get_chatClientState(),this.set_chatClientState(3),this.hideChatPane()):3===this.get_chatClientState()&&this.set_chatClientState(this._chatClientStateBeforeDisabled)},e.prototype.LogString=function(e){if(this._flexPane&&this._flexPane.get_element()){var t=document.createElement("div");t.innerText=e+"\n",this._flexPane.get_element().appendChild(t)}else alert(String.format("Mock Chat Client: {0}",e))},e.prototype.dispose=function(){this._flexPane&&(this.hideChatPane(),$removeHandler(this._btnSendNotification1,"mousedown",o.i(this,this.FireMockNotification,"FireMockNotification")),$removeHandler(this._btnSendNotification2,"mousedown",o.i(this,this.HideThenFireMockNotification,"HideThenFireMockNotification")),this._flexPane=null),this._chatNotificationHandler&&(this._chatNotificationHandler.dispose(),this._chatNotificationHandler=null)},e.getAnInstance=function(t,n,i){return 3===t.getIntAppSetting("SkypeExperience",0)?new e(n,i):null},e.AvailabilityEventKey="cam",e.PaneStateChangedEventKey="PSCH",e.UnreadConversationsChangedEventKey="unreadConvEventKey",e}();(0,o.l)(ft,"1ea302ce$ChatClientMock",null,[st,Sys.IDisposable]);var yt=(0,o.y)("86546139$IFlexPane"),Ct=n(3213),St=n(7893),bt=n(9229),vt=n(1554),Tt=function(){function e(e,t,n,i,r,o,a,l,s,u,c){this._flexPaneFocusScope=null,this._focusManager=null,this._f6Manager=null,this._mouseInputManager=null,this._touchInputManager=null,this._clickInputManager=null,this._keyInputManager=null,this._appFrame=null,this._container=null,this._appFramePane=null,this._onFocus=null,this._onBlur=null,this._escapeActionId=0,this._visible=!1,this._escapeKeyHash=null,this._closeButtonEnabled=!1,this._closeIcon=null,this._closeButton=null,this._anchorClose=null,this._topBar=null,this._pane=null,this._closeTitle=null,this.$$pf_Element=null,this._focusManager=e,this._f6Manager=t,this._mouseInputManager=n,this._touchInputManager=i,this._clickInputManager=r,this._keyInputManager=o,this._appFrame=a,this._container=a.get_element().parentNode,this._appFramePane=a.get_element(),this._onFocus=s,this._onBlur=u,this._escapeActionId=c,this._escapeKeyHash=Me.KeyInputManager.hashKey(Re.v.vK_Escape,0),this._closeButtonEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled")&&!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled(),this.EnsureDom(l)}return e.prototype.get_visible=function(){return this._visible},e.prototype.set_visible=function(e){return e===this._visible?e:(this.Toggle(e),this._visible=e,e)},e.prototype.get_element=function(){return this.$$pf_Element},e.prototype.set_element=function(e){return this.$$pf_Element=e,e},e.prototype.EnsureGroupChatButton=function(){this._closeButtonEnabled&&(this._closeTitle=document.createElement("span"),this._closeTitle.className="cui-taskPaneTitle",this._closeTitle.innerText=CommonUIStrings.l_ChatTooltip,this._anchorClose=document.createElement("a"),this._anchorClose.tabIndex=0,this._anchorClose.className="cui-taskPaneClose cui-ctl",this._anchorClose.title=CommonUIStrings.l_DialogClose,this._anchorClose.style.position="absolute",this._anchorClose.style.right="0px",this._anchorClose.setAttribute(vt.t.ariaRoleAttribute,vt.t.ariaButtonRole),this._clickInputManager.registerHandler(me.d.click,this._anchorClose,o.i(this,this.Hide,"Hide")),this._keyInputManager.registerHandler(me.d.keyUp,this._anchorClose,o.i(this,this.OnKeyHide,"OnKeyHide")),this._closeButton=document.createElement("span"),this._closeButton.className="cui-taskPaneCloseButton cui-ctl-iconContainer",this._closeIcon=Ct.ImageClusteringHelper.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","",!0,""),this._closeButton.appendChild(this._closeIcon),this._anchorClose.appendChild(this._closeButton),this._topBar=document.createElement("div"),this._topBar.className="cui-flexPaneTitle",this._topBar.appendChild(this._closeTitle),this._topBar.appendChild(this._anchorClose),this._pane.appendChild(this._topBar))},e.prototype.EnsureDom=function(t){if(!this.get_element()){var n=!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled();this._closeButtonEnabled&&(this._pane=document.createElement("div"),this._pane.className="cui-flexpane"),this.set_element(document.createElement("div")),this.get_element().id=e.flexPaneId,this.get_element().className=e.FlexPaneClassName+(n?" FlexBoxLayout":""),this.get_element().style.display="none",this.get_element().setAttribute("tabindex",0),vt.t.setAriaAttribute(this.get_element(),vt.t.ariaRoleAttribute,vt.t.ariaRegionRole),vt.t.setAriaAttribute(this.get_element(),vt.t.ariaLabelAttribute,t),this.EnsureGroupChatButton(),n?this._closeButtonEnabled?(this.get_element().style.height="100%",this._pane.appendChild(this.get_element()),this._appFramePane.parentNode.appendChild(this._pane)):this._appFramePane.parentNode.appendChild(this.get_element()):this._container.insertBefore(this.get_element(),this._appFramePane),this.EnsureFocusScope()}},e.prototype.OnKeyHide=function(e){var t=e.innerEvent.keyCode;return(t===Sys.UI.Key.enter||t===Sys.UI.Key.space)&&(this.set_visible(!1),!0)},e.prototype.Hide=function(e){return S.ULS.sendTraceTag(40969411,333,50,"Chat pane closed with X"),this.set_visible(!1),!0},e.prototype.Toggle=function(t){t?(this.get_element().style.display="block",this._closeButtonEnabled&&(this._pane.style.display="flex"),Sys.UI.DomElement.addCssClass(this._appFramePane,e.FlexPaneUpClassName),this._f6Manager.activateFocus(e.FlexPaneFocusId),this._focusManager.pushScope(e.FlexPaneFocusId,!0)):(this.get_element().style.display="none",this._closeButtonEnabled&&(this._pane.style.display="none"),Sys.UI.DomElement.removeCssClass(this._appFramePane,e.FlexPaneUpClassName),this._f6Manager.deactivateFocus(e.FlexPaneFocusId),this._focusManager.popScope(e.FlexPaneFocusId)),this._appFrame.notifyResize(),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&this.FireWindowResizeEvent()},e.prototype.FireWindowResizeEvent=function(){if(window.document.dispatchEvent){var e=null;window.document.createEvent&&(e=window.document.createEvent("UIEvents")).initUIEvent("resize",!0,!0,bt.g.getParentWindow(window.document),0),e&&window.document.dispatchEvent(e)}},e.prototype.EnsureFocusScope=function(){var t=this;this._flexPaneFocusScope||(this._flexPaneFocusScope=this._focusManager.getScope(e.FlexPaneFocusId),this._flexPaneFocusScope.parent=Pe.AFrame.mainAppFocusId,this._flexPaneFocusScope.addOnFocus((function(e,n){St.FocusManager.tryFocus(t.get_element()),t._onFocus&&t._onFocus()})),this._onBlur&&this._flexPaneFocusScope.addOnBlur((function(e,n){t._onBlur()})),this._flexPaneFocusScope.bindAction(this._escapeKeyHash,this._escapeActionId),this._mouseInputManager.addControlFocus(e.FlexPaneFocusId,this.get_element(),!1,!0),this._touchInputManager.addControlFocus(e.FlexPaneFocusId,this.get_element(),!1,!0),this._f6Manager.addF6(e.FlexPaneFocusId))},e.prototype.dispose=function(){this._container.removeChild(this.get_element()),this.set_element(null),this._appFrame=null,this._flexPaneFocusScope.unBindAction(this._escapeKeyHash),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled")&&(this._clickInputManager.unregisterHandler(me.d.click,this._anchorClose,o.i(this,this.Hide,"Hide")),this._keyInputManager.unregisterHandler(me.d.keyUp,this._anchorClose,o.i(this,this.OnKeyHide,"OnKeyHide")))},e.FlexPaneClassName="FlexPane",e.FlexPaneUpClassName="FlexPaneUp",e.FlexPaneFocusId="FlexPane",e.flexPaneId="FlexPane",e}();(0,o.l)(Tt,"daa2068e$FlexPane",null,[yt,Sys.IDisposable]);var At=function(){function e(e,t,n,i,r,o,a){this._appFrameLazy=null,this._focusManagerLazy=null,this._f6ManagerLazy=null,this._mouseInputManagerLazy=null,this._touchInputManagerLazy=null,this._clickInputManagerLazy=null,this._keyInputManagerLazy=null,this._focusManagerLazy=e,this._f6ManagerLazy=t,this._mouseInputManagerLazy=n,this._touchInputManagerLazy=i,this._clickInputManagerLazy=r,this._keyInputManagerLazy=o,this._appFrameLazy=a}return e.prototype.create=function(e,t,n,i){return new Tt(this._focusManagerLazy.get_value(),this._f6ManagerLazy.get_value(),this._mouseInputManagerLazy.get_value(),this._touchInputManagerLazy.get_value(),this._clickInputManagerLazy.get_value(),this._keyInputManagerLazy.get_value(),this._appFrameLazy.get_value(),e,t,n,i)},e}();(0,o.l)(At,"557383ba$Factory",null,[je]);var It=function(){return function(e,t,n,i){this.displayName=null,this.conferenceUri=null,this.discoverUri=null,this.discoveryUri=null,this.useInternalAnonFlow=!1,this.displayName=e,this.conferenceUri=t,this.discoverUri=n,this.discoveryUri=n,this.useInternalAnonFlow=i}}();(0,o.l)(It,"a8be018f$SkypeAnonymousJoinOptions",null,[]);var wt=function(){return function(e,t,n,i,r,o){void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===o&&(o=null),this.type=null,this.username=null,this.password=null,this.token=null,this.product=null,this.options=null,this.type=e,this.username=t,this.password=n,this.token=i,this.product=r,this.options=o}}();(0,o.l)(wt,"6d61a026$SkypeAuth",null,[]);var xt=function(){function e(e,t,n,i){this.experience=0,this.culture=null,this.workload=null,this.userid=null,this.sessionid=null,this.tabid=null,this.experience=e,this.culture=t,this.workload=n,this.sessionid=i}return e.prototype.get_experience=function(){return this.experience},e.prototype.get_culture=function(){return this.culture},e}();(0,o.l)(xt,"9e70f409$SkypeSettings",null,[]);var Et=function(e){function t(t){var n=e.call(this)||this;return n.unreadConversations=0,n.unreadConversations=t,n}return(0,v.t)(t,e),t}(Sys.EventArgs);(0,o.l)(Et,"54656623$UnreadConversationsChangedEventArgs",Sys.EventArgs,[]);var Ft=n(7560),Pt=function(){function e(e,t,n,i,r,o,a){this._chatClientState=0,this._chatClientStateOverridenWhileDisabled=0,this._skypeApi=null,this._eventSource=null,this._loader=null,this._flexPaneFactory=null,this._flexPane=null,this._initialized=!1,this._uxController=null,this._basicChatCapabilities=null,this._perfManager=null,this._chatNotificationHandler=null,this._waitingForAnonymousSignInConfirmation=!1,this._applicationInstance=null,this._appSettingsManager=null,this._initializeTcs=new ct.z(Boolean),this._userIdTcs=new ct.z(String),this._applicationInstance=e,this._appSettingsManager=t,this._loader=i,this._eventSource=new at.f,this._flexPaneFactory=n,this._uxController=r,this._perfManager=o,this._chatNotificationHandler=a,this._chatClientState=0}return e.prototype.get_idAsync=function(){return this._userIdTcs.get_task()},e.prototype.get_chatPaneVisible=function(){return!!this._flexPane&&this._flexPane.get_visible()},e.prototype.set_chatPaneVisible=function(t){return this._flexPane?this._flexPane.get_visible()!==t&&(this._flexPane.set_visible(t),this._eventSource.raiseEvent(e.PaneStateChangedEventKey,new _t(t?1:0))):t&&S.ULS.sendTraceTag(8728835,333,10,"Trying to set visible while flexpane is null"),t},e.prototype.add_paneStateChanged=function(t){this._eventSource.addHandler(e.PaneStateChangedEventKey,t)},e.prototype.remove_paneStateChanged=function(t){this._eventSource.removeHandler(e.PaneStateChangedEventKey,t)},e.prototype.add_unreadConversationsChanged=function(t){this._eventSource.addHandler(e.UnreadConversationsChangedEventKey,t)},e.prototype.remove_unreadConversationsChanged=function(t){this._eventSource.removeHandler(e.UnreadConversationsChangedEventKey,t)},e.prototype.showChatPane=function(){this._skypeApi?(this.EnsureSkypePaneInternal(),this.set_chatPaneVisible(!0)):S.ULS.sendTraceTag(8696157,333,10,"SkypeApi is null so will not render content.")},e.prototype.EnsureSkypePaneInternal=function(){var t=this;if(!this._flexPane){this._flexPane=this._flexPaneFactory.create(CommonUIStrings.l_SkypeTooltip,(function(){t._skypeApi.SetFocus(!0)}),(function(){t._skypeApi.SetFocus(!1)}),Fe.b.openBasicChatPane),S.ULS.sendTraceTag(8696156,333,15,"Setting Chat pane to visible and attempting to create the divs."),this.CreateContentAndTimelineDiv();try{this._skypeApi.renderContent("#"+e.BasicChatContentId),this._skypeApi.renderSidebar("#"+e.BasicChatTimelineId)}catch(e){S.ULS.sendTraceTag(8728836,333,10,"Failure to render the skype api. Message: {0}, Callstack: {1}",e.message,e.stack)}}},e.prototype.hideChatPane=function(){this.set_chatPaneVisible(!1)},e.prototype.init=function(){var t=this;if(this._initialized)return this._initializeTcs.get_task();this._initialized=!0,this._basicChatCapabilities=this._uxController.get_capabilitiesAsync().get_result();var n=this._uxController.get_experience();1===n&&(S.ULS.sendTraceTag(8757720,333,50,"Starting skype experience for Consumers users."),window.setTimeout((function(){S.ULS.sendTraceTag(18655443,333,50,"Starting skype experience for Consumer users with longer sessions.")}),e.SessionLengthTime)),2===n&&(S.ULS.sendTraceTag(8757721,333,50,"Starting skype experience for Enterprise users."),window.setTimeout((function(){S.ULS.sendTraceTag(18655444,333,50,"Starting skype experience for Enterprise users with longer sessions.")}),e.SessionLengthTime));var i=this._appSettingsManager.get_appSettings().SkypeBootstrapUrl.toString(),r=this._appSettingsManager.get_appSettings().SkypeApiKey.toString(),o=this.BuildSkypeSettings(n);this._perfManager.get_chatClientLoadStopwatch().start();var a=this._loader.load(i,r,!1,o);return a.CW((function(e){t.OnLoadFinished(a.get_result())})),this._initializeTcs.get_task()},e.prototype.BuildSkypeSettings=function(e){var t=Ft.i.getCultureInfo(this._appSettingsManager.getIntAppSetting("Lcid",1033)),n=t?t.get_name():null,i=this.BuildWorkloadString(),r=this._appSettingsManager.get_appSettings().SessionId;return new xt(e,n,i,r)},e.prototype.BuildWorkloadString=function(){var e;switch(this._applicationInstance.get_officeAppType()){case 3:e="Word";break;case 4:e="OneNote";break;case 1:e="Excel";break;case 2:e="PowerPoint";break;default:e="UnknownWAC"}switch(this._applicationInstance.get_officeAppMode()){case 1:e+=" Edit";break;case 2:e+=" View"}return e},e.prototype.OnLoadFinished=function(e){if(e){if(this._perfManager.get_chatClientLoadStopwatch()&&this._perfManager.get_chatClientLoadStopwatch().stop(),this._skypeApi=e,S.ULS.sendTraceTag(8696158,333,50,"The Skype api version we are using is: {0}.",this._skypeApi.GetVersion()),!this._skypeApi.IsAvailable())return S.ULS.sendTraceTag(17440902,333,50,"The Skype api is not available for this browser."),this.UpdateChatClientState(1),void this._initializeTcs.setResult(!0);this._basicChatCapabilities.get_fullExperienceIsEnabled()?this.AuthenticateUser():this._basicChatCapabilities.get_anonymousExperienceSupport()&&this.UpdateChatClientState(4),this.SubscribeToNotifications(),this._initializeTcs.setResult(!0)}else S.ULS.sendTraceTag(8947682,333,10,"Skype client unavailable. Failed to initialize SWX api."),this.UpdateChatClientState(0),this._initializeTcs.setResult(!1)},e.prototype.AuthenticateUser=function(){this.UpdateChatClientState(1),this.TrackUserId(),this.TrackAuthenticationState();try{S.ULS.sendTraceTag(8947683,333,50,"Calling Skype Api auth provider for implicit auth."),this._perfManager.get_chatClientAuthStopwatch().start(),this._skypeApi.SetAuthProvider(new wt("implicitOAuth"),o.i(this,this.OnAuthSuccess,"OnAuthSuccess"),o.i(this,this.OnAuthFailure,"OnAuthFailure"))}catch(e){S.ULS.sendTraceTag(8947712,333,10,"Error setting auth provider {0}. Callstack: {1}.",e.message,e.stack)}},e.prototype.TrackAuthenticationState=function(){var e=this;this._skypeApi.get_me().authenticated.subscribe((function(t){t?(e.UpdateChatClientState(2),S.ULS.sendTraceTag(8947713,333,50,"Authenticated and setting signed in.")):(e.UpdateChatClientState(1),S.ULS.sendTraceTag(8947714,333,10,"Skype authentication error, authentication failed or disconnected from SWX."))}))},e.prototype.TrackUserId=function(){var e=this;this._skypeApi.get_me().uri.subscribe((function(t){t?(S.ULS.sendTraceTag(8947716,333,50,"Successfully got an user identifier from Skype client."),e._userIdTcs.setResult(t)):S.ULS.sendTraceTag(8947715,333,10,"Skype client lost the user URI!")}))},e.prototype.OnAuthSuccess=function(){this.UpdateChatClientState(2),S.ULS.sendTraceTag(8947717,333,50,"Authentication is successful."),this.EndPerfMeasurement()},e.prototype.OnAuthFailure=function(e){this.UpdateChatClientState(1),this.LogAuthenticationFailure(e)},e.prototype.LogAuthenticationFailure=function(e){this._uxController.get_isAuthFailureUnexpected()?W.y.get_isInternetExplorerOrEdge()?S.ULS.sendTraceTag(17126927,333,10,"Skype authentication failing for Internet Explorer. Error: {0}",e):S.ULS.sendTraceTag(8947718,333,10,"Skype authentication failing. Error: {0}",e):S.ULS.sendTraceTag(16831619,333,15,"MSIT user failed to authenticate with Skype. Error: {0}",e)},e.prototype.AuthenticateAnonymous=function(e,t,n,i,r){var o=this;i?r?(e||S.ULS.sendTraceTag(17846557,333,15,"Attempting to sign in  anonymously without a user friendly name..."),this.TrackAnonymousSignInState(),this._perfManager.get_chatClientAuthStopwatch().start(),S.ULS.sendTraceTag(18200788,333,15,"Start anonymous sign in."),this._waitingForAnonymousSignInConfirmation=!0,this._skypeApi.SetAuthProvider(new wt("anonymous",void 0,void 0,void 0,void 0,new It(e,r,i,!0)),(function(){o._waitingForAnonymousSignInConfirmation=!1,o.OnAnonymousAuthSuccess(),t()}),(function(e){o._waitingForAnonymousSignInConfirmation=!1,o.OnAnonymousAuthFailure(e),n()}))):S.ULS.sendTraceTag(17846556,333,10,"Cannot attempt to sign in  anonymously with conversation uri being null or empty."):S.ULS.sendTraceTag(17846555,333,10,"Cannot attempt to sign in anonymously with conversation discovery uri being null or empty.")},e.prototype.TrackAnonymousSignInState=function(){var e=this;this._skypeApi.get_me().authenticated.subscribe((function(t){t?(e.UpdateChatClientState(5),S.ULS.sendTraceTag(18121751,333,50,"Successfully authenticated as ANONYMOUS and setting state to AnonymousChatConnected.")):(e.UpdateChatClientState(4),S.ULS.sendTraceTag(18121752,333,10,"Skype authentication error, ANONYMOUS authentication failed or got disconnected."))}))},e.prototype.OnAnonymousAuthSuccess=function(){this.UpdateChatClientState(5),S.ULS.sendTraceTag(17846558,333,50,"Skype anonymous authentication was successful."),this.EndPerfMeasurement()},e.prototype.OnAnonymousAuthFailure=function(e){this.UpdateChatClientState(4),S.ULS.sendTraceTag(17846559,333,10,"Skype anonymous authentication failed. Error: {0}",e)},e.prototype.add_availabilityChanged=function(t){this._eventSource.addHandler(e.AvailabilityEventKey,t)},e.prototype.remove_availabilityChanged=function(t){this._eventSource.removeHandler(e.AvailabilityEventKey,t)},e.prototype.get_chatClientState=function(){return this._chatClientState},e.prototype.UpdateChatClientState=function(t,n){void 0===n&&(n=!1),n||3!==this._chatClientState?this._chatClientState!==t&&(this._chatClientState=t,this._eventSource.raiseEvent(e.AvailabilityEventKey,new pt(this.get_chatClientState())),S.ULS.sendTraceTag(17052561,333,50,"client state {0}",t)):this._chatClientStateOverridenWhileDisabled=t},e.prototype.joinConversation=function(e,t,n,i,r){var o=this;if(void 0===i&&(i=null),void 0===r&&(r=null),!e)return S.ULS.sendTraceTag(16832196,333,50,"Not performing join operation as convUri is null"),void n();2===this.get_chatClientState()||5===this.get_chatClientState()?this.JoinConversationInternal(e,t,n):4===this.get_chatClientState()?this._waitingForAnonymousSignInConfirmation||this.AuthenticateAnonymous(i,(function(){o.JoinConversationInternal(e,t,n)}),n,r,e):(S.ULS.sendTraceTag(18900673,333,50,"Cannot perform join operation when client is not signed in!"),n())},e.prototype.JoinConversationInternal=function(e,t,n){1===this._uxController.get_experience()?S.ULS.sendTraceTag(18699104,333,15,"Joining Conversation for Consumer"):S.ULS.sendTraceTag(18699105,333,15,"Joining Conversation for Business");var i=1===this._uxController.get_experience()?String.format("19:{0}",e):e;this._skypeApi.joinConversation(i,t,n)},e.prototype.disable=function(e){e?(this._chatClientStateOverridenWhileDisabled=this.get_chatClientState(),this.UpdateChatClientState(3,!0),this.hideChatPane()):3===this.get_chatClientState()&&this.UpdateChatClientState(this._chatClientStateOverridenWhileDisabled,!0)},e.prototype.CreateContentAndTimelineDiv=function(){if(this._flexPane.get_element()){var t=document.createElement("div");Sys.UI.DomElement.addCssClass(t,e.ChatPaneClassName),Sys.UI.DomElement.addCssClass(t,e.SkypeWebExperienceClassName),Sys.UI.DomElement.addCssClass(t,e.SelectableTextClassName),!this._basicChatCapabilities.get_fullExperienceIsEnabled()&&this._basicChatCapabilities.get_anonymousExperienceSupport()&&Sys.UI.DomElement.addCssClass(t,e.DocChatOnlyClassName),this._flexPane.get_element().appendChild(t),this.CreateContentElement(t),this.CreateTimelineElement(t)}else S.ULS.sendTraceTag(8696159,333,10,"Failed to get chatpane Element so not creating content and timeline divs.")},e.prototype.SubscribeToNotifications=function(){this._skypeApi.get_activity().unreadConversations.subscribe(o.i(this,this.OnUnreadConversationsChanged,"OnUnreadConversationsChanged")),this._skypeApi.SetNotificationHandler(o.i(this,this.OnSkypeNativeNotification,"OnSkypeNativeNotification"))},e.prototype.OnUnreadConversationsChanged=function(t){3!==this.get_chatClientState()&&this._eventSource.raiseEvent(e.UnreadConversationsChangedEventKey,new Et(t))},e.prototype.OnSkypeNativeNotification=function(t){var n=this;if(3!==this.get_chatClientState()){var i=gt.ParseNotificationType(t.type),r=(0,U.m)(new ht,{type:i,avatar:t.sender.avatar(),displayName:t.sender.displayName(),presence:t.sender.status(),title:t.title(),description:t.description(),accept:function(){n.showChatPane(),t.accept()},acceptWithModality:function(e){n.showChatPane(),t.accept(e)},open:function(){n.showChatPane(),t.open()},decline:function(){t.decline()},playSound:function(){t.sound.play()},stopSound:function(){t.sound.stop()},subscribeToActiveStateChanged:function(e){t.active.subscribe(e)},level:e.GetChatNotificationLevel(i,this._uxController.get_experience())});this._chatNotificationHandler.handleNotification(this,r)}},e.prototype.CreateContentElement=function(t){var n=document.createElement("div");return n.className=e.ChatContentDivClassName,n.id=e.BasicChatContentId,t.appendChild(n),n},e.prototype.CreateTimelineElement=function(t){var n=document.createElement("div");return n.id=e.BasicChatTimelineId,n.className=e.ChatTimelineDivClassName,t.appendChild(n),n},e.prototype.EndPerfMeasurement=function(){this._perfManager.get_chatClientAuthStopwatch()&&this._perfManager.get_chatClientAuthStopwatch().stop(),this._perfManager.get_chattableStopwatch()&&this._perfManager.get_chattableStopwatch().stop()},e.prototype.dispose=function(){this.hideChatPane(),this._chatNotificationHandler&&(this._chatNotificationHandler.dispose(),this._chatNotificationHandler=null),this._skypeApi=null,this._flexPane=null},e.GetChatNotificationLevel=function(e,t){var n;switch(e){case 2:case 4:case 3:n=2;break;default:n=1}return n},e.SessionLengthTime=15e3,e.ChatPaneClassName="ChatPane",e.DocChatOnlyClassName="DocChatOnly",e.SelectableTextClassName="Selectable",e.BasicChatContentId="SkypePaneContent",e.BasicChatTimelineId="SkypePaneTimeline",e.SkypeWebExperienceClassName="skypeWX",e.ChatContentDivClassName="ChatContent",e.ChatTimelineDivClassName="ChatTimeline",e.AvailabilityEventKey="availEventKey",e.PaneStateChangedEventKey="PSCH",e.UnreadConversationsChangedEventKey="unreadConvEventKey",e}();(0,o.l)(Pt,"58d2ef0b$SkypeChatClient",null,[st,Sys.IDisposable]);var Dt=function(){function e(e){this.me=null,this.activity=null,this.skypeNativeApi=null,this.skypeNativeApi=e,this.me=this.skypeNativeApi.me,this.activity=this.skypeNativeApi.activity}return e.prototype.get_me=function(){return this.me||S.ULS.sendTraceTag(17105566,333,10,"Skype Native Contact ME is null."),this.me},e.prototype.get_activity=function(){return this.activity||S.ULS.sendTraceTag(17105567,333,10,"Skype Native Contact activity is null"),this.activity},e.prototype.GetVersion=function(){try{return this.skypeNativeApi.getVersion()}catch(e){return S.ULS.sendTraceTag(8947681,333,10,"Skype GetVersion error. Message: {0}, Callstack: {1}",e.message,e.stack),""}},e.prototype.IsAvailable=function(){try{return this.skypeNativeApi.isAvailable()}catch(e){return S.ULS.sendTraceTag(17440901,333,10,"Skype IsAvailable error. Message: {0}, Callstack: {1}",e.message,e.stack),!1}},e.prototype.renderContent=function(e){try{this.skypeNativeApi.renderContent(e)}catch(e){S.ULS.sendTraceTag(8757717,333,10,"Skype render content error. Message: {0}, Callstack {1}",e.message,e.stack)}},e.prototype.joinConversation=function(t,n,i){try{S.ULS.sendTraceTag(9209431,333,50,"Joining Conversation"),this.skypeNativeApi.joinConversation(t,[e.SkypeModalityChat],n,(function(e){S.ULS.sendTraceTag(9209432,333,10,"JoinConversation Failed. Error: {0}",e),i()}))}catch(e){S.ULS.sendTraceTag(8913495,333,10,"Skype join request error. Message: {0}, Callstack: {1}",e.message,e.stack),i()}},e.prototype.renderSidebar=function(e){try{this.skypeNativeApi.renderSidebar(e)}catch(e){S.ULS.sendTraceTag(8757718,333,10,"Skype render sidebar error. Message: {0}, Callstack: {1}",e.message,e.stack)}},e.prototype.SetAuthProvider=function(e,t,n){try{this.skypeNativeApi.setAuthProvider(e,t,n)}catch(e){S.ULS.sendTraceTag(8757719,333,10,"Skype SetAuthProvider error. Message: {0}, Callstack: {1}",e.message,e.stack)}},e.prototype.SetNotificationHandler=function(e){try{this.skypeNativeApi.setNotificationHandler(e)}catch(e){S.ULS.sendTraceTag(8979149,333,10,"Skype SetNotificationHandler error. Message: {0}, Callstack: {1}",e.message,e.stack)}},e.prototype.SetFocus=function(e){try{this.skypeNativeApi.setFocus(e)}catch(e){S.ULS.sendTraceTag(16799060,333,10,"Skype SetFocus error. Message: {0}, Callstack: {1}",e.message,e.stack)}},e.TryGetInstance=function(t,n){try{return n.val=new e(t),!0}catch(e){return S.ULS.sendTraceTag(8757716,333,10,"SkypeApi initialization error. Message: {0}, Callstack: {1}",e.message,e.stack),n.val=null,!1}},e.SkypeModalityChat="Chat",e.SkypeModalityAudio="Audio",e.SkypeModalityVideo="Video",e}();(0,o.l)(Dt,"7a992794$SkypeApi",null,[]);var Rt=function(){return function(e,t,n,i,r){this.correlationIds=null,this.apiKey=null,this.locale=null,this.jsonp=!1,this.business=!1,this.apiKey=e,this.locale=t,this.correlationIds=i,this.jsonp=n,this.business=r}}();(0,o.l)(Rt,"be009fc9$SkypeNativeInitParams",null,[]);var Mt,kt=function(){return function(){this.hostProperty=null,this.userId=null,this.sessionId=null,this.userAppId=null,this.experienceId=null}}();(0,o.l)(kt,"9e56068f$SkypeNativeInitParamsCorrelationIds",null,[]),function(e){e[e.unknown=0]="unknown",e[e.consumer=1]="consumer",e[e.enterprise=2]="enterprise",e[e.test=3]="test"}(Mt||(Mt={})),(0,o.h)("683b14fd$ChatExperience",Mt);var Nt=n(5538),Lt=n(8541),Bt=function(){function e(){this._correlationIds=null,this._apiKey=null,this._uiCulture=null,this._jsonp=!1,this._business=!1,this._tcs=new ct.z(Dt)}return e.prototype.load=function(t,n,i,r){var a=t;if(!a)return S.ULS.sendTraceTag(19726497,333,10,"Cannot initialize Skype. Invalid setting for Skypebootstrap url."),this._tcs.setResult(null),this._tcs.get_task();this._apiKey=n,this._uiCulture=r.get_culture(),this._jsonp=i,this._correlationIds=new kt,this._correlationIds.userAppId=r.tabid,this._correlationIds.hostProperty=r.workload,this._correlationIds.userId=r.userid,this._correlationIds.sessionId=r.sessionid,this._correlationIds.experienceId=Mt[r.get_experience()],this._business=2===r.get_experience();try{e.DownloadSwxBootStrapper(a,o.i(this,this.OnLoaded,"OnLoaded"))}catch(e){S.ULS.sendTraceTag(8245794,333,10,"Exception loading the api Message: {0} Callstack: {1}.",e.message,e.stack)}return this._tcs.get_task()},e.prototype.OnLoaded=function(e,t){if(t.get_succeeded()){S.ULS.sendTraceTag(8210202,333,50,"Calling the Skype initialized method.");try{Skype.initialize(new Rt(this._apiKey,this._uiCulture,this._jsonp,this._correlationIds,this._business),o.i(this,this.OnSkypeInitSuccess,"OnSkypeInitSuccess"),o.i(this,this.OnSkypeInitError,"OnSkypeInitError"))}catch(e){S.ULS.sendTraceTag(8245795,333,10,"Exception in initializing the Skype SWX api Message: {0} Callstack: {1}.",e.message,e.stack),this._tcs.setResult(null)}}else S.ULS.sendTraceTag(8210203,333,10,"Failed to download the SkypBootstrapper."),this._tcs.setResult(null)},e.prototype.OnSkypeInitSuccess=function(e){return e?Dt.TryGetInstance(e,(0,g.m)((function(){return t}),(function(e){return t=e})))?(S.ULS.sendTraceTag(8245825,333,50,"Initializing succeeded and about to create the api instance."),void this._tcs.setResult(t)):(this.OnSkypeInitError("This is not real success. Invalid native api object."),void this._tcs.setResult(null)):(this.OnSkypeInitError("This is not real success. Null native api object."),void this._tcs.setResult(null));var t},e.prototype.OnSkypeInitError=function(e){S.ULS.sendTraceTag(8210207,333,10,"Skype Api error: {0}",e),this._tcs.setResult(null)},e.DownloadSwxBootStrapper=function(e,t){var n=e?Lt.v.create(e,null,null,null,!1):null;n&&n.add_loadFinished(t);try{Nt.z.enqueueResourceWithoutEnabling(n)}catch(e){S.ULS.sendTraceTag(8757722,333,10,"Failure downloading the skype api bootstrapper: Message: {0}, Callstack: {1}",e.message,e.stack)}S.ULS.sendTraceTag(8254435,333,100,"Downloading SWX bootstrapper from: {0}",e)},e}();(0,o.l)(Bt,"e407d6bd$SkypeLoader",null,[]);var Ot=function(){function e(e,t){this.fullExperienceIsEnabled=!1,this.anonymousExperienceSupport=!1,this.fullExperienceIsEnabled=e,this.anonymousExperienceSupport=t}return e.prototype.get_fullExperienceIsEnabled=function(){return this.fullExperienceIsEnabled},e.prototype.get_anonymousExperienceSupport=function(){return this.anonymousExperienceSupport},e.prototype.get_supportsAnonymousChatOnly=function(){return!this.get_fullExperienceIsEnabled()&&this.get_anonymousExperienceSupport()},e}();(0,o.l)(Ot,"3781e60f$BasicChatCapabilities",null,[]);var Ut=function(){function e(e){this._capabilitiesTcs=null,this._appHasFlexPaneUISupport=!1,this._experience=0,this.settingsManager=null,this.basicChatBrsIsEnabled=!1,this.chatIsEnabledTcs=null,this.settingsManager=e,this._appHasFlexPaneUISupport=!this.settingsManager.getBooleanAppSetting("HeaderInsideRibbonIsEnabled"),this.basicChatBrsIsEnabled=this.settingsManager.getBooleanAppSetting("SkypeAutomationModeIsEnabled")||this.settingsManager.getBooleanAppSetting("BasicChatIsEnabled")&&!this.settingsManager.getBooleanAppSetting("ReactSharedHeaderIsEnabled"),this._experience=this.settingsManager.getIntAppSetting("SkypeExperience",0)}return e.prototype.get_capabilitiesAsync=function(){return this.InitCapabilitiesCheck(),this._capabilitiesTcs.get_task()},e.prototype.get_HasAnonymousChatSupport=function(){return this._appHasFlexPaneUISupport&&this.get_customChecksForAnonymousSupport()},e.prototype.InitCapabilitiesCheck=function(){var e=this;this._capabilitiesTcs||(this._capabilitiesTcs=new ct.z(Ot),this.InitFullExperienceCheck(),this.chatIsEnabledTcs.get_task().CW((function(t){var n=e.chatIsEnabledTcs.get_task().get_result(),i=!n&&e.get_HasAnonymousChatSupport();e._capabilitiesTcs.setResult(new Ot(n,i))})))},e.prototype.InitFullExperienceCheck=function(){this.chatIsEnabledTcs||(this.chatIsEnabledTcs=new ct.z(Boolean),this._appHasFlexPaneUISupport&&this.basicChatBrsIsEnabled?this.customChecksForFullExperienceSupport():this.chatIsEnabledTcs.setResult(!1))},e.prototype.get_experience=function(){return this._experience},e}();(0,o.l)(Ut,"e6a82e34$BasicChatUserExperienceController",null,[Ve.l]);var Ht=function(e){function t(t,n){var i=this;return i._shellActorAsync=null,i._shellActor=null,i._shellInfoAsync=null,i._isBrowserSupportedLazy=null,i._isAuthFailureUnexpected=!1,(i=e.call(this,t)||this)._shellActorAsync=n,i._isAuthFailureUnexpected=!0,i._isBrowserSupportedLazy=new nt.q(Boolean,o.i(i,i.IsBrowserSupportedForSkypeExperience,"IsBrowserSupportedForSkypeExperience")),i}return(0,v.t)(t,e),t.prototype.get_customChecksForAnonymousSupport=function(){if(!this._isBrowserSupportedLazy.get_value())return!1;var e=this.settingsManager.getBooleanAppSetting("DocChatIsEnabled");return!this.basicChatBrsIsEnabled&&e&&(2===this.get_experience()||3===this.get_experience())},t.prototype.customChecksForFullExperienceSupport=function(){this.CheckIfSkypeExperienceIsEnabled()},t.prototype.CheckIfSkypeExperienceIsEnabled=function(){var e=this;this._isBrowserSupportedLazy.get_value()?2===this.get_experience()?this._shellActorAsync.execute((function(t){e._shellActor=t,t.get_shellServiceDataAsync().CW((function(t){e.CheckIfSkypeForBusinessIsEnabled()}))})):1===this.get_experience()||3===this.get_experience()?this.chatIsEnabledTcs.setResult(!0):this.chatIsEnabledTcs.setResult(!1):this.chatIsEnabledTcs.setResult(!1)},t.prototype.get_isAuthFailureUnexpected=function(){return this._isAuthFailureUnexpected},t.prototype.CheckIfSkypeForBusinessIsEnabled=function(){if(this._shellInfoAsync=this._shellActor.get_shellServiceDataAsync(),this._shellInfoAsync.get_isCanceled()||!this._shellInfoAsync.get_isCompleted())return S.ULS.sendTraceTag(17949148,333,15,"Shell info task was canceled or was not completed"),void this.chatIsEnabledTcs.setResult(!1);var e=this._shellActor.get_shellServiceDataAsync().get_result(),n=!1;try{var i;if(x.x.tryDeserialize(Object,e[t.NavBarDataJson_Property_ClientData].toString(),(0,g.m)((function(){return i}),(function(e){return i=e}))))if(this.settingsManager.getBooleanAppSetting("BasicChatIsForced"))n=!0,this._isAuthFailureUnexpected=!1;else{var r=i[t.ClientData_Property_IsTenantHybrid],o=i[t.ClientData_Property_HasSkypeLicense];n=!r&&o,S.ULS.sendTraceTag(17949149,333,50,"Suite UX Skype check resulted in Enabled:{0}, from: Tenant Hybrid:{1}; License:{2}",n,r,o)}}catch(e){S.ULS.sendTraceTag(17949150,333,15,"object format is incorrect. Error {0}",e.message)}this.chatIsEnabledTcs.setResult(n)},t.prototype.IsBrowserSupportedForSkypeExperience=function(){return!W.y.get_isMobile()&&(!(W.y.get_isInternetExplorer()&&!W.y.get_isInternetExplorer10Up())&&(!(W.y.get_isWebKit()&&!W.y.get_isChrome()&&!W.y.isSafariAtLeast(8))&&!W.y.get_isOpera()))},t.NavBarDataJson_Property_ClientData="ClientData",t.ClientData_Property_IsTenantHybrid="IsTenantDirSyncEnabled",t.ClientData_Property_HasSkypeLicense="HasSkypeLicense",t}(Ut);(0,o.l)(Ht,"7416dde$SkypeWebExperienceController",Ut,[Ke,Ve.l]);var Gt=(0,o.y)("bebd9428$IChatToast"),Wt=function(e){function t(t,n){var i=e.call(this)||this;return i._actionAreaElement=null,i._answerButton=null,i._ignoreButton=null,i._answerWithIMButton=null,i._ignoreButtonAction=null,i._answerWithIMButtonAction=null,i._clickInputManager=null,i._actionAreaElement=t,Sys.UI.DomElement.addCssClass(i._actionAreaElement,dt.SkypeNotificationActionAreaClass),i._clickInputManager=n,i.CreateButtonsDom(),i}return(0,v.t)(t,e),t.prototype.CreateButtonsDom=function(){this._answerButton=this.createDomElementAppendToParent(this._actionAreaElement,"div"),Sys.UI.DomElement.addCssClass(this._answerButton,dt.SkypeNotificationButtonClass),this._ignoreButton=this.createDomElementAppendToParent(this._actionAreaElement,"div"),Sys.UI.DomElement.addCssClass(this._ignoreButton,dt.SkypeNotificationButtonClass),this._clickInputManager.registerHandler(me.d.click,this._ignoreButton,o.i(this,this.OnIgnoreButtonClick,"OnIgnoreButtonClick")),this._answerWithIMButton=this.createDomElementAppendToParent(this._actionAreaElement,"div"),Sys.UI.DomElement.addCssClass(this._answerWithIMButton,dt.SkypeNotificationButtonClass),this._answerWithIMButton.style.display="none",this._clickInputManager.registerHandler(me.d.click,this._answerWithIMButton,o.i(this,this.OnAnswerWithIMButtonClick,"OnAnswerWithIMButtonClick"))},t.prototype.OnIgnoreButtonClick=function(e){return this._ignoreButtonAction&&this._ignoreButtonAction(),!0},t.prototype.OnAnswerWithIMButtonClick=function(e){return this._answerWithIMButtonAction&&this._answerWithIMButtonAction(),!0},t.prototype.setButtons=function(e,n,i){var r=CommonUIStrings.l_NotificationRespond,o=CommonUIStrings.l_NotificationIgnore,a=CommonUIStrings.l_NotificationAnswerWithIM;switch(e){case 3:r=CommonUIStrings.l_NotificationAnswer,this._answerWithIMButton.style.display="",this._answerWithIMButton.style.maxWidth=t.LargeButtonsMaxWidthOverride,this._answerButton.style.maxWidth=this._ignoreButton.style.maxWidth=t.SmallButtonsMaxWidthOverride;break;default:this._answerWithIMButton.style.display="none",this._answerButton.style.maxWidth=this._ignoreButton.style.maxWidth=""}this._answerButton.innerText=r,this._ignoreButton.innerText=o,this._answerWithIMButton.innerText=a,this._ignoreButtonAction=n,this._answerWithIMButtonAction=i},t.prototype.dispose=function(){this._clickInputManager.unregisterHandler(me.d.click,this._ignoreButton,o.i(this,this.OnIgnoreButtonClick,"OnIgnoreButtonClick")),this._clickInputManager.unregisterHandler(me.d.click,this._answerWithIMButton,o.i(this,this.OnAnswerWithIMButtonClick,"OnAnswerWithIMButtonClick"))},t.SmallButtonsMaxWidthOverride="65px",t.LargeButtonsMaxWidthOverride="120px",t}(dt);(0,o.l)(Wt,"9f14d2a3$SkypeToastNotificationButtons",dt,[Sys.IDisposable]);var Vt,$t=function(e){function t(t){var n=e.call(this)||this;return n._textAreaElement=null,n._senderElement=null,n._senderTitleElement=null,n._messageElement=null,n._textAreaElement=t,Sys.UI.DomElement.addCssClass(n._textAreaElement,dt.SkypeNotificationTextClass),n.CreateTextAreaDom(),n}return(0,v.t)(t,e),t.prototype.CreateTextAreaDom=function(){this._senderElement=this.createDomElementAppendToParent(this._textAreaElement,"span"),Sys.UI.DomElement.addCssClass(this._senderElement,dt.SkypeNotificationSenderClass),this._senderTitleElement=this.createDomElementAppendToParent(this._textAreaElement,"span"),Sys.UI.DomElement.addCssClass(this._senderTitleElement,dt.SkypeNotificationTitleClass),this._messageElement=this.createDomElementAppendToParent(this._textAreaElement,"span"),Sys.UI.DomElement.addCssClass(this._messageElement,dt.SkypeNotificationMessageClass)},t.prototype.setNotificationText=function(e,t,n,i){var r=n;switch(i){case 3:r=CommonUIStrings.l_NotificationIncomingCall}this._senderElement.innerText=e,this._senderTitleElement.innerText=t,this._messageElement.innerText=r},t}(dt);(0,o.l)($t,"4b8944db$SkypeToastNotificationText",dt,[]),function(e){e[e.unknown=0]="unknown",e[e.unreadMessage=1]="unreadMessage",e[e.chatRequest=2]="chatRequest",e[e.voiceCall=3]="voiceCall",e[e.contactRequest=4]="contactRequest"}(Vt||(Vt={})),(0,o.h)("c2bfb76$ChatNotificationType",Vt);var zt=function(e){function t(n){var i=e.call(this)||this;i._notificationTypeElement=null,i._notificationIcon=null,i._imageDictionary={},i._notificationTypeElement=n,Sys.UI.DomElement.addCssClass(i._notificationTypeElement,dt.SkypeNotificationTypeClass),i.CreateTypeDom();var r=L.AFrameworkApplication.get_imageClusterName(),o=Ct.ImageClusteringHelper.getImageClassWithCluster(r,t.ChatImageClassName);return i._imageDictionary.unknown=o,i._imageDictionary.unreadMessage=o,i._imageDictionary.chatRequest=o,i._imageDictionary.contactRequest=o,i._imageDictionary.voiceCall=Ct.ImageClusteringHelper.getImageClassWithCluster(r,t.VoiceImageClassName),i}return(0,v.t)(t,e),t.prototype.CreateTypeDom=function(){this._notificationIcon=this.createDomElementAppendToParent(this._notificationTypeElement,"span")},t.prototype.setToastTypeButton=function(e){var t=Ct.ImageClusteringHelper.createClusteredImageFromClusterWithImageClass(40,40,this._imageDictionary[Vt[e]],L.AFrameworkApplication.get_imageClusterPath(),"cui-img-cont-float","",!1,"",this._notificationTypeElement.ownerDocument);this._notificationIcon&&this._notificationTypeElement.removeChild(this._notificationIcon),this._notificationTypeElement.appendChild(t),this._notificationIcon=t},t.ChatImageClassName="WACSkypeChatRequest_40x40x32",t.VoiceImageClassName="WACSkypeVoiceRequest_40x40x32",t.VideoImageClassName="WACSkypeVideoRequest_40x40x32",t}(dt);(0,o.l)(zt,"1702f25e$SkypeToastNotificationType",dt,[]);var Kt=function(e){function t(t,n){var i=e.call(this)||this;return i._notificationAreaElement=null,i._notificationTopBar=null,i._notificationText=null,i._notificationType=null,i._notificationButtons=null,i._clickInputManager=null,i._notificationAreaElement=t,Sys.UI.DomElement.addCssClass(i._notificationAreaElement,dt.SkypeNotificationAreaClass),i._clickInputManager=n,i.ConstructNotificationAreaDom(),i}return(0,v.t)(t,e),t.prototype.ConstructNotificationAreaDom=function(){this._notificationTopBar=this.createDomElementAppendToParent(this._notificationAreaElement,"div"),Sys.UI.DomElement.addCssClass(this._notificationTopBar,dt.SkypeNotificationTopBar);var e=this.createDomElementAppendToParent(this._notificationTopBar,"div");this._notificationText=new $t(e);var t=this.createDomElementAppendToParent(this._notificationTopBar,"div");this._notificationType=new zt(t);var n=this.createDomElementAppendToParent(this._notificationAreaElement,"div");this._notificationButtons=new Wt(n,this._clickInputManager)},t.prototype.setNotificationArea=function(e,t,n,i,r,o){this._notificationText.setNotificationText(e,t,n,i),this._notificationType.setToastTypeButton(i),this._notificationButtons.setButtons(i,r,o)},t.prototype.dispose=function(){this._notificationButtons&&(this._notificationButtons.dispose(),this._notificationButtons=null)},t}(dt);(0,o.l)(Kt,"6c4318d1$SkypeToastNotificationArea",dt,[Sys.IDisposable]);var qt=function(e){function t(t){var n=e.call(this)||this;return n._imageAreaElement=null,n._imageElement=null,n._imageAreaElement=t,Sys.UI.DomElement.addCssClass(n._imageAreaElement,dt.SkypePresenceImageClass),n._imageElement=n.createDomElementAppendToParent(n._imageAreaElement,"img"),Sys.UI.DomElement.addCssClass(n._imageElement,dt.SkypePresenceImageClass),n}return(0,v.t)(t,e),t.prototype.setImage=function(e){this._imageElement.src=e},t}(dt);(0,o.l)(qt,"f7975fb5$SkypeToastPresenceImage",dt,[]);var jt=function(e){function t(t){var n=e.call(this)||this;return n._presenceAreaElement=null,n._presenceElement=null,n._presenceImage=null,n._currentPresenceClass=null,n._presenceAreaElement=t,Sys.UI.DomElement.addCssClass(n._presenceAreaElement,dt.SkypePresenceAreaClass),n.ConstructPresenceAreaDom(),n}return(0,v.t)(t,e),t.prototype.ConstructPresenceAreaDom=function(){this._presenceElement=this.createDomElementAppendToParent(this._presenceAreaElement,"div"),Sys.UI.DomElement.addCssClass(this._presenceElement,dt.SkypePresenceClass);var e=this.createDomElementAppendToParent(this._presenceAreaElement,"div");this._presenceImage=new qt(e)},t.prototype.setPresenceArea=function(e,t){this.switchPresence(t),this._presenceImage.setImage(e)},t.prototype.switchPresence=function(e){var t;switch(e){case 1:t=dt.SkypePresenceClass_Available;break;case 2:t=dt.SkypePresenceClass_Away;break;case 3:t=dt.SkypePresenceClass_Busy;break;default:t=dt.SkypePresenceClass_Unknown}this._currentPresenceClass&&Sys.UI.DomElement.removeCssClass(this._presenceElement,this._currentPresenceClass),Sys.UI.DomElement.addCssClass(this._presenceElement,t),this._currentPresenceClass=t},t}(dt);(0,o.l)(jt,"1e20fde5$SkypeToastPresenceArea",dt,[]);var Qt=function(e){function t(t,n){var i=e.call(this)||this;return i._toastElement=null,i._presenceArea=null,i._notificationArea=null,i._mainRespondAction=null,i._notification=null,i._hideToastTaskIsPending=!1,i._hideToastTask=null,i._eventSource=null,i._clickInputManager=null,i._disposed=!1,i._dismissed=!1,i._clickInputManager=t,i._eventSource=new at.f,i.CreateToastDom(),i._hideToastTaskIsPending=!1,i.Bind(n),i}return(0,v.t)(t,e),t.prototype.get_element=function(){return this._toastElement},t.prototype.CreateToastDom=function(){this._toastElement=document.createElement("div"),this.CreatePresenceDom(),this.CreateNotificationAreaDom(),Sys.UI.DomElement.addCssClass(this._toastElement,dt.SkypeToastDivClass)},t.prototype.CreatePresenceDom=function(){var e=this.createDomElementAppendToParent(this._toastElement,"div");this._presenceArea=new jt(e)},t.prototype.CreateNotificationAreaDom=function(){var e=this.createDomElementAppendToParent(this._toastElement,"div");this._notificationArea=new Kt(e,this._clickInputManager)},t.prototype.Bind=function(e){var n=this;this._notification=e,S.ULS.sendTraceTag(17114639,333,100,"Building toast type: <{0}>.",this._notification.type);var i=this.ParseSkypePresence(e.presence);this._presenceArea.setPresenceArea(e.avatar,i),this._mainRespondAction=this.ExecuteActionAndHide(t.GetMainRespondAction(e));var r=t.TryGetSecondaryRespondAction(e);this._notificationArea.setNotificationArea(e.displayName,e.title,e.description,e.type,this.ExecuteActionAndHide(e.decline),r?this.ExecuteActionAndHide(r):null),e.playSound&&e.playSound(),this.ScheduleHideToastTask(e.type),this._notification.subscribeToActiveStateChanged((function(e){e||(S.ULS.sendTraceTag(17114640,333,100,"Notification inactive triggered..."),n.dismiss())})),this._clickInputManager.registerHandler(me.d.click,this._toastElement,o.i(this,this.OnToastClick,"OnToastClick"))},t.prototype.ScheduleHideToastTask=function(e){var n=this;this.CancelPendingHideToastTask(),this._hideToastTask=new ge.c(2,1,t.ToastDisplayTimeInMilliseconds(e),(function(e){n._hideToastTaskIsPending=!1,S.ULS.sendTraceTag(17114641,333,100,"Auto-hide toast task executing..."),n.dismiss()}),73),Ce.y.get_instance().addTask(this._hideToastTask),this._hideToastTaskIsPending=!0},t.prototype.CancelPendingHideToastTask=function(){this._hideToastTaskIsPending&&(Ce.y.get_instance().deleteTask(this._hideToastTask),this._hideToastTaskIsPending=!1)},t.prototype.dismiss=function(){this._dismissed||(S.ULS.sendTraceTag(17114642,333,100,"Dismissing toast type: <{0}>.",this._notification.type),this._dismissed=!0,this.CancelPendingHideToastTask(),this._notification.stopSound&&this._notification.stopSound(),this._eventSource.raiseEvent(t.ToastOnDismissEventKey))},t.prototype.get_sticky=function(){return 3===this._notification.type},t.prototype.add_onDismiss=function(e){this._eventSource.addHandler(t.ToastOnDismissEventKey,e)},t.prototype.remove_onDismiss=function(e){this._eventSource.removeHandler(t.ToastOnDismissEventKey,e)},t.prototype.ParseSkypePresence=function(e){return 0},t.prototype.OnToastClick=function(e){return this._mainRespondAction&&this._mainRespondAction(),!0},t.prototype.ExecuteActionAndHide=function(e){var t=this;return function(){e&&e(),S.ULS.sendTraceTag(17114643,333,100,"Toast action taken..."),t.dismiss()}},t.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._clickInputManager.unregisterHandler(me.d.click,this._toastElement,o.i(this,this.OnToastClick,"OnToastClick")),this._notificationArea.dispose(),this._notificationArea=null,this._presenceArea=null,this._toastElement=null)},t.GetMainRespondAction=function(e){switch(e.type){case 2:return e.accept;case 1:case 4:return e.open;case 3:return function(){e.acceptWithModality(Dt.SkypeModalityAudio)};default:return Function.emptyFunction}},t.TryGetSecondaryRespondAction=function(e){switch(e.type){case 3:return function(){e.acceptWithModality(Dt.SkypeModalityChat)};default:return null}},t.ToastDisplayTimeInMilliseconds=function(e){switch(e){case 2:return 25e3;case 1:case 4:return 7e3;case 3:return 6e4;default:return 7e3}},t.ToastOnDismissEventKey="toastDismissedEventKey",t}(dt);(0,o.l)(Qt,"629fa00b$SkypeToast",dt,[Gt,Sys.IDisposable]);var Jt=function(){function e(e){this._clickInputManager=null,this._clickInputManager=e}return e.prototype.create=function(e){return new Qt(this._clickInputManager,e)},e}();(0,o.l)(Jt,"cb1bd93f$Factory",null,[tt]);var Xt=n(1505),Yt=n(9858),Zt=n(1748),en=function(){function e(){this._container=null,this._perfManager=null}return e.prototype.get_name=function(){return"Common.App.BasicChat"},e.prototype.init=function(){var e=this;Zt.m.get_instance().get_appIsInteractiveTask().CW((function(t){L.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){e.InitializeBasicChatPackage()}))}))},e.prototype.InitializeBasicChatPackage=function(){var e=this;this._perfManager=this._container.resolve(ot),this._perfManager.get_userExperienceLoadStopwatch().start(),this._perfManager.get_chattableStopwatch().start();var t=this._container.resolve(Ve.l).get_capabilitiesAsync();t.CW((function(n){var i=t.get_result();i.get_fullExperienceIsEnabled()?(e._container.resolve($e.n),e._container.resolve(ze).initialize()):i.get_anonymousExperienceSupport()&&e._container.resolve($e.n)}))},e.prototype.dispose=function(){},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register(Ht).singleInstance().as(Ke).as(Ve.l).usingFactory((function(){return new Ht(L.AFrameworkApplication.appSettingsManager,t._container.resolveFuture(qe.u))})),this._container.register(ot).singleInstance().usingFactory((function(){return new ot(L.AFrameworkApplication.get_activeFrame().get_theStopwatchBuilder())})),this._container.register(At).as(je).singleInstance().usingFactory((function(){return new At(new nt.q(Qe.k,(function(){return St.FocusManager.instance()})),new nt.q(Je.k,(function(){return L.AFrameworkApplication.get_activeFrame().get_theF6Manager()})),new nt.q(ye.p,(function(){return ye.p.get_instance()})),new nt.q(Yt.v,(function(){return Yt.v.get_instance()})),new nt.q(Xe.p,(function(){return Xt.s.get_instance()})),new nt.q(Ye.i,(function(){return Me.KeyInputManager.get_instance()})),new nt.q(Ze.l,(function(){return L.AFrameworkApplication.get_activeFrame()})))})),this._container.register(Bt).singleInstance(),this._container.register(Pt).singleInstance().usingFactory((function(){return new Pt(L.AFrameworkApplication.get_activeFrame().get_applicationInstance(),L.AFrameworkApplication.appSettingsManager,t._container.resolve(je),t._container.resolve(Bt),t._container.resolve(Ke),t._container.resolve(ot),t._container.resolve(et))})),this._container.register(ft).singleInstance().usingFactory((function(){return ft.getAnInstance(L.AFrameworkApplication.appSettingsManager,t._container.resolve(je),t._container.resolve(et))})),this._container.register($e.n).singleInstance().usingFactory((function(){return new lt(L.AFrameworkApplication.appSettingsManager,(function(){return t._container.resolve(ft)}),(function(){return t._container.resolve(Pt)}),Ce.y.get_instance())})),this._container.register(ze).singleInstance().usingFactory((function(){return new rt(L.AFrameworkApplication.get_theActionManager(),t._container.resolve($e.n),Se.q.taskFromFuture(Ee.p,t._container.resolveFuture(Ee.p)),t._container.resolve(ot),L.AFrameworkApplication.subscribeToBeforeAppShutDown,L.AFrameworkApplication.appSettingsManager)})),this._container.register(tt).singleInstance().usingFactory((function(){return new Jt(Xt.s.get_instance())})),this._container.register(et).singleInstance().usingFactory((function(){return new gt((function(){return L.AFrameworkApplication.get_activeFrame().get_element().parentNode}),t._container.resolve(tt))}))},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(en,"bcfe5e70$CommonBasicChatPackage",null,[s.u,u.s]);var tn=n(3010),nn=(0,o.y)("e4a86ebb$IUsageLogger"),rn=function(){function e(){}return e.serializeUsageData=function(e,t){var n={},i=function(e,t){null!=t&&(n[e]=t)},r=null;switch(e){case 0:var o=t;r="ResourceTiming",i("Url",o.a),i("InitiatorType",o.b),i("RedirectStart",null==o.c?null:o.c.toString()),i("RedirectEnd",null==o.d?null:o.d.toString()),i("FetchStart",null==o.e?null:o.e.toString()),i("DomainLookupStart",null==o.f?null:o.f.toString()),i("DomainLookupEnd",null==o.g?null:o.g.toString()),i("ConnectStart",null==o.h?null:o.h.toString()),i("ConnectEnd",null==o.i?null:o.i.toString()),i("SecureConnectionStart",null==o.j?null:o.j.toString()),i("RequestStart",null==o.k?null:o.k.toString()),i("ResponseStart",null==o.l?null:o.l.toString()),i("ResponseEnd",null==o.m?null:o.m.toString()),i("CustomText",o.n),i("DecodedBodySize",null==o.o?null:o.o.toString()),i("EncodedBodySize",null==o.p?null:o.p.toString()),i("TransferSize",null==o.q?null:o.q.toString());break;case 1:var a=t;r="PerformanceTiming",i("Url",a.a),i("NavigationStart",null==a.b?null:a.b.toString()),i("UnloadEventStart",null==a.c?null:a.c.toString()),i("UnloadEventEnd",null==a.d?null:a.d.toString()),i("RedirectStart",null==a.e?null:a.e.toString()),i("RedirectEnd",null==a.f?null:a.f.toString()),i("FetchStart",null==a.g?null:a.g.toString()),i("DomainLookupStart",null==a.h?null:a.h.toString()),i("DomainLookupEnd",null==a.i?null:a.i.toString()),i("ConnectStart",null==a.j?null:a.j.toString()),i("ConnectEnd",null==a.k?null:a.k.toString()),i("SecureConnectionStart",null==a.l?null:a.l.toString()),i("RequestStart",null==a.m?null:a.m.toString()),i("ResponseStart",null==a.n?null:a.n.toString()),i("ResponseEnd",null==a.o?null:a.o.toString()),i("DomLoading",null==a.p?null:a.p.toString()),i("DomInteractive",null==a.q?null:a.q.toString()),i("DomContentLoadedEventStart",null==a.r?null:a.r.toString()),i("DomContentLoadedEventEnd",null==a.s?null:a.s.toString()),i("DomComplete",null==a.t?null:a.t.toString()),i("LoadEventStart",null==a.u?null:a.u.toString()),i("LoadEventEnd",null==a.v?null:a.v.toString()),i("CustomText",a.w)}return n.Table=r,Sys.Serialization.JavaScriptSerializer.serialize(n)},e}();(0,o.l)(rn,"c397b2b8$UsageDataSerialization",null,[]);var on=function(){function e(e){this._allowedDomainEndings=null,this._allowedDomainEndings=e}return e.prototype.isDomainAllowed=function(e){if(!this._allowedDomainEndings)return!0;var t=Oe.n.getHost(e);if(!t)return!1;t=t.toLowerCase();for(var n=0;n<this._allowedDomainEndings.length;n++)if(t.endsWith(this._allowedDomainEndings[n]))return!0;return!1},e}();(0,o.l)(on,"df7c31a1$DomainAllowListManager",null,[]);var an=function(){function e(e,t){this.url=null,this.timings=null,this.customText=null,this.timings=e,this.url=t}return e.prototype.get_UsageReadyUrl=function(){return Oe.n.removeAllUrlParameters(this.url)},e.prototype.get_timings=function(){return this.timings},e.prototype.ToUsageData=function(){var e={},t=this.get_timings();return e.a=this.get_UsageReadyUrl(),e.b=this.Round(t.navigationStart),e.c=this.Round(t.unloadEventStart),e.d=this.Round(t.unloadEventEnd),e.e=this.Round(t.redirectStart),e.f=this.Round(t.redirectEnd),e.g=this.Round(t.fetchStart),e.h=this.Round(t.domainLookupStart),e.i=this.Round(t.domainLookupEnd),e.j=this.Round(t.connectStart),e.k=this.Round(t.connectEnd),e.l=void 0!==t.secureConnectionStart&&null!==t.secureConnectionStart?this.Round(t.secureConnectionStart):0,e.m=this.Round(t.requestStart),e.n=this.Round(t.responseStart),e.o=this.Round(t.responseEnd),e.q=this.Round(t.domInteractive),e.r=this.Round(t.domContentLoadedEventStart),e.s=this.Round(t.domContentLoadedEventEnd),e.t=this.Round(t.domComplete),e.u=this.Round(t.loadEventStart),e.v=this.Round(t.loadEventEnd),e.w=this.customText,e},e.prototype.Round=function(e){return Math.round(1e3*e)/1e3},e}();(0,o.l)(an,"bcfd995$PerformanceTimingEntry",null,[]);var ln=n(7919),sn=n(5787),un=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this._pageLoadPerfRecorder=null,this._getCurrentUrlDelegate=null,this._domainAllowListManager=null,this.usageLogger=null,this._pageLoadPerfRecorder=e,this.usageLogger=this,this._getCurrentUrlDelegate=t||function(){return window.location.href},this._domainAllowListManager=new on(n)}return e.prototype.run=function(){if(e.get_BrowserSupportsPerformanceTiming())try{var t=this._getCurrentUrlDelegate();if(!e._transportRegEx.exec(t))return;if(!this._domainAllowListManager.isDomainAllowed(t))return;var n=new an(window.performance.timing,t);Zt.m.get_instance().recordBrowserFetchStart(n.get_timings().fetchStart),Zt.m.get_instance().recordBrowserNavigationStart(n.get_timings().navigationStart),Zt.m.get_instance().measureMarks(ln.c.frameConnect,"connectStart","requestStart"),Zt.m.get_instance().measureMarks(ln.c.frameRequest,"requestStart","responseStart"),Zt.m.get_instance().measureMarks(ln.c.frameResponse,"responseStart","responseEnd"),this.usageLogger.logData(1,n.ToUsageData()),this._pageLoadPerfRecorder.addMetric(ln.c.frameFetchStart,n.get_timings().fetchStart),this._pageLoadPerfRecorder.addMetric(ln.c.frameDomainLookupStart,n.get_timings().domainLookupStart),this._pageLoadPerfRecorder.addMetric(ln.c.frameDomainLookupEnd,n.get_timings().domainLookupEnd),this._pageLoadPerfRecorder.addMetric(ln.c.frameConnectStart,n.get_timings().connectStart),this._pageLoadPerfRecorder.addMetric(ln.c.frameSecureConnectionStart,n.get_timings().secureConnectionStart),this._pageLoadPerfRecorder.addMetric(ln.c.frameConnectEnd,n.get_timings().connectEnd),this._pageLoadPerfRecorder.addMetric(ln.c.frameRequestStart,n.get_timings().requestStart),this._pageLoadPerfRecorder.addMetric(ln.c.frameResponseStart,n.get_timings().responseStart),this._pageLoadPerfRecorder.addMetric(ln.c.frameDownloadDuration,n.get_timings().responseEnd-n.get_timings().responseStart),this._pageLoadPerfRecorder.addMetric(ln.c.frameRequestStartToFirstByteDuration,n.get_timings().responseStart-n.get_timings().requestStart);var i=0,r=0,o=0;this.TryNavigationSize(t,(0,g.m)((function(){return i}),(function(e){return i=e})),(0,g.m)((function(){return r}),(function(e){return r=e})),(0,g.m)((function(){return o}),(function(e){return o=e})))&&(this._pageLoadPerfRecorder.addMetric(ln.c.frameTransferSize,i),this._pageLoadPerfRecorder.addMetric(ln.c.frameDecodedSize,o),this._pageLoadPerfRecorder.addMetric(ln.c.frameEncodedSize,r)),this._pageLoadPerfRecorder.addMetric(ln.c.frameNavigationStart,n.get_timings().navigationStart)}catch(e){S.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",e)}},e.prototype.TryNavigationSize=function(e,t,n,i){if(t.val=-1,n.val=-1,i.val=-1,void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return!1;var r=window.performance.getEntriesByName(e,"navigation");if(null==r||1!==r.length)return!1;var o=r[0],a=o.transferSize;void 0!==t.val&&null!==t.val&&(t.val=a);var l=o.decodedBodySize;null!=l&&(i.val=l);var s=o.encodedBodySize;return null!=s&&(n.val=s),!0},e.prototype.logData=function(e,t,n){void 0===n&&(n=!1),S.ULS.sendTraceTag(4551815,306,50,rn.serializeUsageData(e,t))},e.get_instance=function(){return e._instance||(e._instance=new e(sn.e.get_instance(),null,L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PerfTimingLoggerFilterDomainsIsEnabled")?L.AFrameworkApplication.appSettingsManager.getListAppSetting("ResourceLoggerDomainAllowList"):null))},e.get_BrowserSupportsPerformanceTiming=function(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.timing||null===window.performance.timing)},e._instance=null,e._transportRegEx=new RegExp("^https?://.*","i"),e}();(0,o.l)(un,"71da9375$PerformanceTimingLogger",null,[nn]);var cn=(0,o.y)("cc72bd0c$IResourceTimingEntry"),dn=function(){function e(e,t){this.$$pf_Url=null,this.$$pf_Timings=null,this.$$pf_Behavior=0,this.$$pf_CustomText=null,this.set_timings(e),this.set_behavior(t),this.set_url(this.get_timings().name)}return e.prototype.get_url=function(){return this.$$pf_Url},e.prototype.set_url=function(e){return this.$$pf_Url=e,e},e.prototype.get_UsageReadyUrl=function(){return 2===this.get_behavior()?this.get_url():Oe.n.removeAllUrlParameters(this.get_url())},e.prototype.get_timings=function(){return this.$$pf_Timings},e.prototype.set_timings=function(e){return this.$$pf_Timings=e,e},e.prototype.get_behavior=function(){return this.$$pf_Behavior},e.prototype.set_behavior=function(e){return this.$$pf_Behavior=e,e},e.prototype.get_customText=function(){return this.$$pf_CustomText},e.prototype.set_customText=function(e){return this.$$pf_CustomText=e,e},e.prototype.ToUsageData=function(){var t={},n=this.get_timings();return t.a=this.get_UsageReadyUrl(),t.b=n.initiatorType,t.c=this.Round(n.redirectStart),t.d=this.Round(n.redirectEnd),t.e=this.Round(n.fetchStart),t.f=this.Round(n.domainLookupStart),t.g=this.Round(n.domainLookupEnd),t.h=this.Round(n.connectStart),t.i=this.Round(n.connectEnd),t.j=void 0!==n.secureConnectionStart&&null!==n.secureConnectionStart?this.Round(n.secureConnectionStart):0,t.k=this.Round(n.requestStart),t.l=this.Round(n.responseStart),t.m=this.Round(n.responseEnd),t.o=this.Round(e.GetRawField(n,"decodedBodySize")),t.p=this.Round(e.GetRawField(n,"encodedBodySize")),t.q=this.Round(e.GetRawField(n,"transferSize")),t.n=this.get_customText(),t},e.prototype.Round=function(e){return Math.round(1e3*e)/1e3},e.GetRawField=function(e,t){return e[t]},e}();(0,o.l)(dn,"f2358ee7$ResourceTimingEntry",null,[cn]);var gn=function(e){function t(t){var n=e.call(this)||this;return n.entries=null,n.entries=t,n}return(0,v.t)(t,e),t.prototype.get_entries=function(){return this.entries},t}(Sys.EventArgs);(0,o.l)(gn,"e993918b$EntriesAvailableEventArgs",Sys.EventArgs,[]);var pn=function(){function e(e,t){void 0===t&&(t=null),this._taskManager=null,this._isTaskSet=!1,this._task=null,this._currentEntryIndex=0,this._domainAllowListManager=null,this.defaultBehavior=0,this.isActive=!1,this.timerInterval=0,this.usageLogger=null,this._eventSource=new at.f,this._taskManager=e,this.defaultBehavior=0,this.usageLogger=this,this._domainAllowListManager=new on(t)}return e.prototype.get_defaultBehavior=function(){return this.defaultBehavior},e.prototype.get_isActive=function(){return this.isActive},e.prototype.get_timerInterval=function(){return this.timerInterval},e.prototype.add_entriesAvailable=function(t){this._eventSource.addHandler(e.EntriesAvailableEventKey,t)},e.prototype.remove_entriesAvailable=function(t){this._eventSource.removeHandler(e.EntriesAvailableEventKey,t)},e.prototype.configure=function(e,t){var n=this.get_timerInterval()!==e;this.timerInterval=e,this.get_isActive()&&this._taskManager&&n&&(this.DeleteTask(),this.AddTask()),this.defaultBehavior=t},e.prototype.activate=function(){this.get_isActive()||e.get_BrowserSupportsPerformanceTimeline()&&(this.AddTask(),this.isActive=!0)},e.prototype.deactivate=function(e){this.get_isActive()&&(this.DeleteTask(),e&&this.flush(),this.isActive=!1)},e.prototype.flush=function(){if(this.get_isActive()&&e.get_BrowserSupportsPerformanceTimeline())try{var t=window.performance.getEntriesByType("resource");t.length-this._currentEntryIndex>0&&S.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",t.length-this._currentEntryIndex);var n=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);n&&(window.performance.clearResourceTimings(),this._currentEntryIndex=0);for(var i=[],r=this._currentEntryIndex;r<t.length;r++)this._domainAllowListManager.isDomainAllowed(t[r].name)&&i.push(new dn(t[r],this.get_defaultBehavior()));n||(this._currentEntryIndex=t.length),this._eventSource.raiseEvent(e.EntriesAvailableEventKey,new gn(i));for(r=0;r<i.length;r++)i[r].get_behavior()&&2!==i[r].get_behavior()||this.usageLogger.logData(0,i[r].ToUsageData());i.length>0&&S.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",i.length)}catch(e){S.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",e)}},e.prototype.logData=function(e,t,n){void 0===n&&(n=!1),S.ULS.sendTraceTag(4310804,306,50,rn.serializeUsageData(e,t))},e.prototype.AddTask=function(){var e=this;this._taskManager&&this.get_timerInterval()>0&&(this._task=new ge.c(3,2,1e3*this.get_timerInterval(),(function(){e.flush()}),5),this._taskManager.addTask(this._task),this._isTaskSet=!0)},e.prototype.DeleteTask=function(){this._isTaskSet&&(this._taskManager.deleteTask(this._task),this._task=null,this._isTaskSet=!1)},e.get_BrowserSupportsPerformanceTimeline=function(){try{return!(void 0===window.performance||null===window.performance||void 0===window.performance.getEntriesByType||null===window.performance.getEntriesByType)}catch(e){return S.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",e),!1}},e.EntriesAvailableEventKey="EntriesAvailable",e}();(0,o.l)(pn,"df661707$ResourceTimingLogger",null,[tn.t,nn]);var hn=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.ResourceTiming"},e.prototype.init=function(){this._container.resolve(tn.t),un.get_instance().run()},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e;var t=null;L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ResourceLoggerFilterDomainsIsEnabled")&&(t=L.AFrameworkApplication.appSettingsManager.getListAppSetting("ResourceLoggerDomainAllowList")),e.register(tn.t).singleInstance().usingFactory((function(){return new pn(L.AFrameworkApplication.get_theTaskManager(),t)}))},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(hn,"c8384d49$ResourceTimingPackage",null,[s.u,u.s]);var _n,mn=(0,o.y)("7018d30f$INewAndOpenCommonHelpers"),fn=(0,o.y)("e7a69f50$IGetMoreInfoResult"),yn=(0,o.y)("d7ac0bb7$IMruResult"),Cn=(0,o.e)("407cc66e$IEventEmitter$1"),Sn=function(){function e(t){o.m(this,e.$$(t)),this._activeEventReceivers={}}return e.prototype.ActivateEventReceiver=function(e){this._activeEventReceivers[e.get_id().toString()]=e},e.prototype.NotifyAndDeactivateActiveEventReceivers=function(e){var t=this._activeEventReceivers;for(var n in t){({key:n,value:t[n]}).value.notify(e,!1)}this._activeEventReceivers={}},e.prototype.queryForResult=function(e,t){return t&&this.ActivateEventReceiver(t),this.onResultRequested(e,t)},e.prototype.EmitDeferredResultToWaitingReceivers=function(e){this.NotifyAndDeactivateActiveEventReceivers(e)},e.prototype.EmitAvailableResultToReceiver=function(e,t){e.notify(t,!0)},e.$$=function(t){return o.o("Common.App.NewAndOpen.Core.AEventEmitter$1",e,[{T:t}],null,[Cn.$$(t)],{})},e}(),bn=(0,o.y)("11c1571$IEventResult");!function(e){e[e.notStarted=0]="notStarted",e[e.waiting=1]="waiting",e[e.shouldRetry=2]="shouldRetry",e[e.complete=3]="complete"}(_n||(_n={})),(0,o.h)("152b0caf$EventResultState",_n);var vn=function(){function e(){this._state=0}return e.prototype.get_state=function(){return this._state},e.prototype.set_state=function(e){return S.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{OldState:_n[this._state],NewState:_n[e]},"ResultType",this.getResultLogString()),this._state=e,e},e}();(0,o.l)(vn,"48b22094$AEventResult",null,[bn]);var Tn=function(e){function t(){var t=e.call(this)||this;return t.$$pf_PersonalFileStorageUrl=null,t.$$pf_StorageServiceDisplayName=null,t.$$pf_InstantiatingPersonalStorage=!1,t.$$pf_InvalidResponse=!1,t.set_state(0),t.set_instantiatingPersonalStorage(!1),t.set_invalidResponse(!1),t}return(0,v.t)(t,e),t.prototype.get_personalFileStorageUrl=function(){return this.$$pf_PersonalFileStorageUrl},t.prototype.set_personalFileStorageUrl=function(e){return this.$$pf_PersonalFileStorageUrl=e,e},t.prototype.get_storageServiceDisplayName=function(){return this.$$pf_StorageServiceDisplayName},t.prototype.set_storageServiceDisplayName=function(e){return this.$$pf_StorageServiceDisplayName=e,e},t.prototype.get_instantiatingPersonalStorage=function(){return this.$$pf_InstantiatingPersonalStorage},t.prototype.set_instantiatingPersonalStorage=function(e){return this.$$pf_InstantiatingPersonalStorage=e,e},t.prototype.get_invalidResponse=function(){return this.$$pf_InvalidResponse},t.prototype.set_invalidResponse=function(e){return this.$$pf_InvalidResponse=e,e},t.prototype.getResultLogString=function(){return"GetMoreInfo Result"},t}(vn);(0,o.l)(Tn,"dba32d4$GetMoreInfoResult",vn,[fn,bn]);var An=n(1597),In=n(8734),wn=n(3592),xn=n(4367),En=n(6923),Fn=n(3642),Pn=function(){function e(e,t,n,i,r,o,a,l){this._actionManager=null,this._clientRequestManager=null,this._appFrame=null,this._appType=null,this._taskManager=null,this._getCurrentTime=null,this._handlerUrlPrefix=null,this._supportsGetMoreInfoForPersonalStorage=null,this._actionManager=e,this._clientRequestManager=t,this._appFrame=n,this._appType=i,this._taskManager=r,this._getCurrentTime=o,this._handlerUrlPrefix=a,this._supportsGetMoreInfoForPersonalStorage=l}return e.prototype.RegisterCommonActions=function(){this.get_newAndOpenActionManager().addAction(Fe.b.openUrlInNewTab,Ue.m.frame,o.i(this,this.OpenUrlInNewTab,"OpenUrlInNewTab")),this.get_newAndOpenActionManager().addAction(Fe.b.rebootUrlOnUiHost,Ue.m.frame,o.i(this,this.RebootUrlOnUiHost,"RebootUrlOnUiHost")),L.AFrameworkApplication.get_documentLoadedTime()?this.LogNewAndOpenPerfStats():this.get_newAndOpenActionManager().addActionWithFlags(Fe.b.documentLoaded,Ue.m.frame,o.i(this,this.DocumentLoaded,"DocumentLoaded"),96)},e.prototype.OpenUrlInNewTab=function(e,t,n,i,r){var o=r;if(r&&o.MenuItemId){S.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{Id:o.SourceControlId,AppType:Fn.k[this.get_newAndOpenOfficeAppType()]});var a=o.MenuItemId.toString();window.open(a,"_blank")}return 32},e.prototype.RebootUrlOnUiHost=function(e,t,n,i,r){var o=r;if(o&&o.MenuItemId){var a={};a[En.t.rebootMode]="1",a[En.t.documentUrl]=o.MenuItemId.toString(),S.ULS.sendTraceTag(51247010,202,50,"Send PostMessage to the UI host to reboot a document"),L.AFrameworkApplication.get_hostPostmessengerFuture().execute((function(e){e.sendMessageWithRetry(he.a.documentRefresh,a)}))}return 32},e.prototype.DocumentLoaded=function(e,t,n,i,r){return this.LogNewAndOpenPerfStats(),32},e.prototype.logRequest=function(e,t,n){if(void 0===n&&(n=""),t&&t.invokedTime){var i=xn.e[t.status],r=t.invokedTime.getTime(),o=this.get_getCurrentTime()()-r;S.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{Caller:e,RequestStatus:i,ElapsedMs:o,StartTime:r,Notes:n})}else S.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{Caller:e})},e.prototype.LogNewAndOpenPerfStats=function(){var e=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("QPGVCI"),t=Oe.n.getParameterValue(document.URL,"wdNewAndOpenCt",e);if(t){var n=parseInt(t),i=Oe.n.getParameterValue(document.URL,"wdPreviousSession",e),r=Oe.n.getParameterValue(document.URL,"wdPreviousCorrelation",e),o=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NAOPLP");if(L.AFrameworkApplication.get_documentLoadedTime()){var a=L.AFrameworkApplication.get_documentLoadedTime().getTime();!n||n>a?S.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{ClickTimestamp:n,DocumentLoadedTime:a,SessionId:i,Correlation:r}):S.ULS.sendTraceTag(5849683,202,o?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{ClickToLoadTime:a-n,ClickTimestamp:n,SessionId:i,Correlation:r})}else S.ULS.sendTraceTag(5849681,202,o?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{ClickTimestamp:n,SessionId:i,Correlation:r})}},e.prototype.get_newAndOpenActionManager=function(){return this._actionManager.get_value()},e.prototype.get_newAndOpenClientRequestManager=function(){return this._clientRequestManager.get_value()},e.prototype.get_newAndOpenAppFrame=function(){return this._appFrame.get_value()},e.prototype.get_newAndOpenOfficeAppType=function(){return this._appType.get_value()},e.prototype.get_newAndOpenTaskManager=function(){return this._taskManager.get_value()},e.prototype.get_getCurrentTime=function(){return this._getCurrentTime},e.prototype.get_newAndOpenHandlerUrlPrefix=function(){return this._handlerUrlPrefix.get_value()},e.prototype.get_supportsGetMoreInfoForPersonalStorage=function(){return this._supportsGetMoreInfoForPersonalStorage.get_value()},e.get_instance=function(){return e._instance||(e._instance=e.GetAnInstanceWithResolvedDependencies())},e.GetAnInstanceWithResolvedDependencies=function(){return new e(new nt.q(An.v,(function(){return L.AFrameworkApplication.get_theActionManager()})),new nt.q(In.u,(function(){return L.AFrameworkApplication.theClientRequestManager})),new nt.q(Ze.l,(function(){return L.AFrameworkApplication.get_activeFrame()})),new nt.q(Fn.k,(function(){return L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()})),new nt.q(wn.h,(function(){return L.AFrameworkApplication.get_theTaskManager()})),(function(){return(new Date).getTime()}),new nt.q(String,(function(){return L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_newAndOpenHandlerUrlPrefix()})),new nt.q(Boolean,(function(){return L.AFrameworkApplication.get_supportsGetMoreInfoForPersonalStorage()})))},e._instance=null,e}();(0,o.l)(Pn,"4ace5a8b$NewAndOpenCommonHelpers",null,[mn]);var Dn=function(){function e(e,t,n){this._task=null,this._serverRetryIntervalsInMsString=null,this._serverRetryIntervalsInMsIntList=null,this._descriptionString="",this._taskManager=null,this.retryIndex=0,this._serverRetryIntervalsInMsString=e,this._taskManager=t,this._descriptionString=n}return e.prototype.AdvanceRetryIndex=function(){this.retryIndex=this.get_retryIndex()+1},e.prototype.ResetRetryState=function(e){this._task&&(this._taskManager.deleteTask(this._task),this._task=null),e&&(this.retryIndex=0)},e.prototype.StartNextRetryTask=function(e){var t=this.get_TimeUntilNextRetryInMs(),n=t>=0;return n?(this.AdvanceRetryIndex(),this.ResetRetryState(!1),this._task=new ge.c(4,1,t,e,107),this._taskManager.addTask(this._task)):(this.ResetRetryState(!0),S.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{Action:this._descriptionString})),n},e.prototype.get_retryIndex=function(){return this.retryIndex},e.prototype.get_TimeUntilNextRetryInMs=function(){return this.get_retryIndex()>=this.get_ServerRetryIntervalsInMsIntList().length?-1:this.get_ServerRetryIntervalsInMsIntList()[this.get_retryIndex()]},e.prototype.get_ServerRetryIntervalsInMsIntList=function(){if(!this._serverRetryIntervalsInMsIntList){var e=(this._serverRetryIntervalsInMsString.get_value()||"0").split(",");this._serverRetryIntervalsInMsIntList=[];for(var t=0;t<e.length;t++){var n=parseInt(e[t]);isNaN(n)?S.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{Action:this._descriptionString,Entry:e[t]}):Array.add(this._serverRetryIntervalsInMsIntList,n)}}return this._serverRetryIntervalsInMsIntList},e}();(0,o.l)(Dn,"a5e3dd5e$RetryHelper",null,[]);var Rn=n(8548),Mn=function(e){function t(t,n){var i=e.call(this,fn)||this;return i._newAndOpenCommonHelpers=null,i._retryHelper=null,i._result=null,i._newAndOpenCommonHelpers=t,i._retryHelper=new Dn(n,i.get_MoreInfoNewAndOpenCommonHelpers().get_newAndOpenTaskManager(),"GetMoreInfo"),i._result=new Tn,i}return(0,v.t)(t,e),t.prototype.makeGetMoreInfoRequestOpenDocumentTrigger=function(){this.MakeGetMoreInfoRequestInternal("Document opened")},t.prototype.CreateMakeGetMoreInfoRequestRetryTask=function(e){var t=this;return function(n){t.MakeGetMoreInfoRequestInternal(e,!0)}},t.prototype.onResultRequested=function(e,t){return void 0===t&&(t=null),S.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{Trigger:e}),3===this._result.get_state()?(t&&this.EmitAvailableResultToReceiver(t,this._result),S.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{Trigger:e})):this.MakeGetMoreInfoRequestInternal(e),this._result},t.prototype.MakeGetMoreInfoRequestInternal=function(e,n){if(void 0===n&&(n=!1),this._retryHelper.ResetRetryState(!n),1!==this._result.get_state()){S.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{Trigger:e,RetryIndex:this._retryHelper.get_retryIndex()}),this._result.set_state(1);var i=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.get_MoreInfoNewAndOpenCommonHelpers().get_newAndOpenHandlerUrlPrefix(),L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion);this.get_MoreInfoNewAndOpenCommonHelpers().get_newAndOpenClientRequestManager().addRequestWithHeaderForwarding(i,1,null,null,[t._personalFileStorageUrlHeaderName,t._storageServiceDisplayNameHeaderName],!1,4,this.CreateGetMoreInfoFromServerSuccessCallback(e),this.CreateGetMoreInfoFromServerFailureCallback(e),null)}else S.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{Trigger:e,RetryIndex:this._retryHelper.get_retryIndex()})},t.prototype.CreateGetMoreInfoFromServerSuccessCallback=function(e){var n=this;return function(e){var i=!1,r=!1,o=!1,a=null;if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("GetMoreInfoDataFromResponseBody"))if(e.get_data().responseData)if(x.x.tryDeserialize(Object,e.get_data().responseData,(0,g.m)((function(){return a}),(function(e){return a=e})))){var l=a;l?(o=!0,n._result.set_storageServiceDisplayName(l.StorageServiceDisplayName),n._result.set_personalFileStorageUrl(t.IsValidStorageHostUrl(l.PersonalFileStorageUrl)?l.PersonalFileStorageUrl:"")):S.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers")}else S.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers");else S.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");if(!o){var s=e.get_data().responseHeaders;if(s){n._result.set_storageServiceDisplayName((s[t._storageServiceDisplayNameHeaderName]||"").toString());var u=(s[t._personalFileStorageUrlHeaderName]||"").toString();n._result.set_personalFileStorageUrl(t.IsValidStorageHostUrl(u)?u:""),i=""===u&&""!==n._result.get_storageServiceDisplayName()}else S.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),r=!0}var c=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",n._retryHelper.get_retryIndex(),r,i,o);n.get_MoreInfoNewAndOpenCommonHelpers().logRequest("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",e.get_data(),c),n.SetAndEmitResultState(3,i,r)}},t.prototype.CreateGetMoreInfoFromServerFailureCallback=function(e){var t=this;return function(n){t.get_MoreInfoNewAndOpenCommonHelpers().logRequest("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",n.get_data(),"Failure"),t.SetAndEmitResultState(2),t._retryHelper.StartNextRetryTask(t.CreateMakeGetMoreInfoRequestRetryTask(e))}},t.prototype.SetAndEmitResultState=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),this._result.set_state(e),this._result.set_instantiatingPersonalStorage(t),this._result.set_invalidResponse(n),this.EmitDeferredResultToWaitingReceivers(this._result)},t.prototype.get_MoreInfoNewAndOpenCommonHelpers=function(){return this._newAndOpenCommonHelpers.get_value()},t.get_instance=function(){return t._instance||(t._instance=t.GetAnInstanceWithResolvedDependencies())},t.GetAnInstanceWithResolvedDependencies=function(){return new t(new nt.q(mn,(function(){return Pn.get_instance()})),new nt.q(String,(function(){return L.AFrameworkApplication.get_getMoreInfoRetryIntervalsInMs()})))},t.IsValidStorageHostUrl=function(e){return e?!!Rn.l.toLower(e).startsWith("https://")||(S.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme."),!1):(S.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1)},t._personalFileStorageUrlHeaderName="PersonalFileStorageUrl",t._storageServiceDisplayNameHeaderName="StorageServiceDisplayName",t._instance=null,t}(Sn);(0,o.l)(Mn,"b0e127b6$GetMoreInfoActor",Sn.$$(fn),[]);var kn=function(){function e(e,t,n,i,r){this._lastActivityTime=0,this._taskManager=null,this._getLatestActivityTime=null,this._getCurrentTime=null,this._timeUntilInactiveInMs=null,this._eventSource=null,this.InactiveActionId="inactive",this.ActiveActionId="active",this._isActive=!0,this._inactivityCheckInterval=6e4,this._taskManager=e,this._getLatestActivityTime=t,this._getCurrentTime=n,this._timeUntilInactiveInMs=i,this._eventSource=new at.f,r&&this.StartInactiveLoop(),this._lastActivityTime=this.get_GetLatestActivityTime()()}return e.prototype.addBackFromInactiveAction=function(e){this._eventSource.addHandler(this.ActiveActionId,e)},e.prototype.addOnInactiveAction=function(e){this._eventSource.addHandler(this.InactiveActionId,e)},e.prototype.StartInactiveLoop=function(){var e=new ge.c(4,2,this._inactivityCheckInterval,o.i(this,this.InactiveLoop,"InactiveLoop"),108);this.get_InactivityTaskManager().addTask(e)},e.prototype.InactiveLoop=function(e){var t=this.get_GetLatestActivityTime()(),n=this.get_GetCurrentTime()()-t;n>this.get_TimeUntilInactiveInMs()&&this._isActive&&(S.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{TimeSinceLastActive:n}),this._isActive=!1,this._eventSource.raiseEvent(this.InactiveActionId)),t-this._lastActivityTime>this.get_TimeUntilInactiveInMs()&&(this._isActive=!0,this._eventSource.raiseEvent(this.ActiveActionId)),this._lastActivityTime=t},e.prototype.get_InactivityTaskManager=function(){return this._taskManager.get_value()},e.prototype.get_GetLatestActivityTime=function(){return this._getLatestActivityTime},e.prototype.get_GetCurrentTime=function(){return this._getCurrentTime},e.prototype.get_TimeUntilInactiveInMs=function(){return this._timeUntilInactiveInMs.get_value()},e.get_instance=function(){return e._instance||(e._instance=e.GetAnInstanceWithResolvedDependencies())},e.GetAnInstanceWithResolvedDependencies=function(){return new e(new nt.q(wn.h,(function(){return Ce.y.get_instance()})),(function(){return L.AFrameworkApplication.get_latestActivityTime().getTime()}),(function(){return(new Date).getTime()}),new nt.q(Number,(function(){return L.AFrameworkApplication.get_timeUntilInactiveInMs()})),!0)},e._instance=null,e}();(0,o.l)(kn,"7bd727a9$InactivityManager",null,[]);var Nn=function(e){function t(){var t=e.call(this)||this;return t.$$pf_MruEntries=null,t.$$pf_TimestampOfLastUpdate=0,t.$$pf_InvalidResponse=!1,t.set_state(0),t.set_invalidResponse(!1),t}return(0,v.t)(t,e),t.prototype.get_mruEntries=function(){return this.$$pf_MruEntries},t.prototype.set_mruEntries=function(e){return this.$$pf_MruEntries=e,e},t.prototype.get_timestampOfLastUpdate=function(){return this.$$pf_TimestampOfLastUpdate},t.prototype.set_timestampOfLastUpdate=function(e){return this.$$pf_TimestampOfLastUpdate=e,e},t.prototype.get_invalidResponse=function(){return this.$$pf_InvalidResponse},t.prototype.set_invalidResponse=function(e){return this.$$pf_InvalidResponse=e,e},t.prototype.getResultLogString=function(){return"MruActor Result"},t}(vn);(0,o.l)(Nn,"ccfdd2f3$MruResult",vn,[yn,bn]);var Ln=n(4762),Bn=function(e){function t(t,n,i,r,o){var a=e.call(this,yn)||this;return a._newAndOpenCommonHelpers=null,a._localeName=null,a._writeFileIdInHeader=!1,a._mruResult=null,a._readRetryHelper=null,a._writeRetryHelper=null,a.writeHeaders=null,a.RenameMruEntryAction="RenameMruEntry",a.UpdateMruEntryAction="UpdateMruEntry",a._newAndOpenCommonHelpers=t,a._localeName=n,a._readRetryHelper=new Dn(i,a.get_OpenMenuNewAndOpenCommonHelpers().get_newAndOpenTaskManager(),"Read"),a._writeRetryHelper=new Dn(r,a.get_OpenMenuNewAndOpenCommonHelpers().get_newAndOpenTaskManager(),"Write"),a._writeFileIdInHeader=o,a.writeHeaders={},a._mruResult=new Nn,a}return(0,v.t)(t,e),t.prototype.get_writeHeaders=function(){return this.writeHeaders},t.prototype.RegisterWriteMruActions=function(){this.get_OpenMenuNewAndOpenCommonHelpers().get_newAndOpenActionManager().addAction(Fe.b.renameMostRecentlyUsedFileEntry,Ue.m.frame,o.i(this,this.RenameMruEntry,"RenameMruEntry"))},t.prototype.RenameMruEntry=function(e,n,i,r,o){var a=o;return a?a.newDocumentDAVUrl?a.newFileName?a.currentDocumentDAVUrl?(this.get_writeHeaders()[t.CurrentDocumentDAVUrlHeaderName]=this.get_writeHeaders()[t.CurrentDocumentDAVUrlHeaderName]||Rn.l.urlKeyValueEncode(a.currentDocumentDAVUrl),this.get_writeHeaders()[t.NewDocumentDAVUrlHeaderName]=Rn.l.urlKeyValueEncode(a.newDocumentDAVUrl),this.get_writeHeaders()[t.NewFileNameHeaderName]=Rn.l.urlKeyValueEncode(a.newFileName),S.ULS.sendTraceTag(5849669,202,50,"Starting rename of MRU entry {0}",{Trigger:"Rename"}),this.WriteToMruInternal("Rename",this.RenameMruEntryAction)):(S.ULS.sendTraceTag(5849668,202,15,"Failure to rename MRU entry {0}",{Error:"Null CurrentDocumentDAVUrl"}),8):(S.ULS.sendTraceTag(5849667,202,15,"Failure to rename MRU entry {0}",{Error:"Null NewFileName"}),8):(S.ULS.sendTraceTag(5849666,202,15,"Failure to rename MRU entry {0}",{Error:"Null NewDocumentDAVUrl"}),8):32},t.prototype.MakeUpdateMruRequestOpenTrigger=function(){this.MakeUpdateMruRequestInternal("File Opened")},t.prototype.MakeUpdateMruRequestInactivityTrigger=function(){this.MakeUpdateMruRequestInternal("Inactivity")},t.prototype.MakeUpdateMruRequestBackFromInactivityTrigger=function(){this.MakeUpdateMruRequestInternal("Back from Inactivity")},t.prototype.MakeUpdateMruRequestInternal=function(e){S.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{Trigger:e}),this.WriteToMruInternal(e,this.UpdateMruEntryAction)},t.prototype.WriteToMruInternal=function(e,n,i){if(void 0===i&&(i=!1),4===this.get_OpenMenuNewAndOpenCommonHelpers().get_newAndOpenOfficeAppType()&&!L.AFrameworkApplication.get_documentIsFolder())return 2;var r;this.get_writeHeaders()[t.NewDocumentDAVUrlHeaderName]&&this.get_writeHeaders()[t.CurrentDocumentDAVUrlHeaderName]!==this.get_writeHeaders()[t.NewDocumentDAVUrlHeaderName]?r=this.RenameMruEntryAction:(r=this.UpdateMruEntryAction,delete this.get_writeHeaders()[t.NewDocumentDAVUrlHeaderName]),S.ULS.sendTraceTag(5849673,202,50,"Writing to MRU {0}",{Trigger:e,IntendedActionType:n,ActualActionType:r}),this._writeRetryHelper.ResetRetryState(!i);var a=String.format(this.get_OpenMenuNewAndOpenCommonHelpers().get_newAndOpenHandlerUrlPrefix()+"MruServiceHandler.ashx?action={0}&app={1}&lc={2}",r,this.get_OpenMenuNewAndOpenCommonHelpers().get_newAndOpenOfficeAppType(),this.get_LocaleName());return this._writeFileIdInHeader?this.get_writeHeaders()["X-FileId"]=L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion:a+=String.format("&{0}",L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion),this.get_OpenMenuNewAndOpenCommonHelpers().get_newAndOpenClientRequestManager().addRequest(a,2,null,this.get_writeHeaders(),!0,4,o.i(this,this.WriteMruEntryOnServerSuccessCallback,"WriteMruEntryOnServerSuccessCallback"),this.CreateWriteMruEntryOnServerFailureCallback(n),null,void 0,void 0,void 0,void 0,"4")},t.prototype.WriteMruEntryOnServerSuccessCallback=function(e){this.get_OpenMenuNewAndOpenCommonHelpers().logRequest("MruActor.WriteMruEntryOnServerSuccessCallback",e.get_data(),"Success"),this._writeRetryHelper.ResetRetryState(!0);var n=(e.get_data().request.get_headers()[t.NewDocumentDAVUrlHeaderName]||"").toString();""!==n&&(this.get_writeHeaders()[t.CurrentDocumentDAVUrlHeaderName]=n)},t.prototype.CreateWriteMruEntryOnServerFailureCallback=function(e){var t=this;return function(n){t.get_OpenMenuNewAndOpenCommonHelpers().logRequest("MruActor.WriteMruEntryOnServerFailureCallback",n.get_data(),"Failure"),n.get_data().httpStatus!==Y.k.forbidden_403&&t._writeRetryHelper.StartNextRetryTask(t.CreateWriteRetryTask(e))}},t.prototype.CreateWriteRetryTask=function(e){var t=this;return function(n){t.WriteToMruInternal("Retry",e,!0)}},t.prototype.GetMruFromServerTask=function(e){this.MakeGetMruRequestInternal("Polling")},t.prototype.GetMruFromServerRetryTask=function(e){this.MakeGetMruRequestInternal("Retry",!0)},t.prototype.MakeGetMruRequestOpenTrigger=function(){this.MakeGetMruRequestInternal("Open")},t.prototype.MakeGetMruRequestActivityTrigger=function(){this.MakeGetMruRequestInternal("Activity")},t.prototype.MakeGetMruRequestInternal=function(e,t){void 0===t&&(t=!1),S.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{Trigger:e}),this._readRetryHelper.ResetRetryState(!t),this.CreateGetMruServerRequest(o.i(this,this.GetMruFromServerSuccessCallback,"GetMruFromServerSuccessCallback"),o.i(this,this.GetMruFromServerFailureCallback,"GetMruFromServerFailureCallback"),"getmru")},t.prototype.GetMruFromServerSuccessCallback=function(e){var t=e.get_data().responseData;L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactFileMenuUxEnabled()&&Ln.AppChromeUtils.appChromeAlreadyLoaded()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(t)),this._readRetryHelper.ResetRetryState(!0);var n=null;t&&(n=this.TryDeserializeJson(t)),n?(this.UpdateMruResultState(3,n),this.get_OpenMenuNewAndOpenCommonHelpers().logRequest("MruActor.GetMruFromServerSuccessCallback",e.get_data(),"Success")):(this.get_OpenMenuNewAndOpenCommonHelpers().logRequest("MruActor.GetMruFromServerSuccessCallback",e.get_data(),"Failure: Invalid JSON"),this.UpdateMruResultState(3,null,!0)),this.EmitDeferredResultToWaitingReceivers(this._mruResult)},t.prototype.GetMruFromServerFailureCallback=function(e){this.get_OpenMenuNewAndOpenCommonHelpers().logRequest("MruActor.GetMruFromServerFailureCallback",e.get_data(),"Failure"),this.UpdateMruResultState(2),this._readRetryHelper.StartNextRetryTask(o.i(this,this.GetMruFromServerRetryTask,"GetMruFromServerRetryTask"))||this._readRetryHelper.ResetRetryState(!0),this.EmitDeferredResultToWaitingReceivers(this._mruResult)},t.prototype.UpdateMruResultState=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1),3===this._mruResult.get_state()&&3!==e||(this._mruResult.set_mruEntries(t),this._mruResult.set_state(e),this._mruResult.set_invalidResponse(n),this._mruResult.set_timestampOfLastUpdate(this.get_OpenMenuNewAndOpenCommonHelpers().get_getCurrentTime()()))},t.prototype.onResultRequested=function(e,t){return S.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{Trigger:e,ResultState:this._mruResult.get_state()}),t&&3===this._mruResult.get_state()&&this.EmitAvailableResultToReceiver(t,this._mruResult),this._mruResult},t.prototype.CreateGetMruServerRequest=function(e,t,n){this.UpdateMruResultState(1);var i=String.format(this.get_OpenMenuNewAndOpenCommonHelpers().get_newAndOpenHandlerUrlPrefix()+"MruServiceHandler.ashx?action={0}&app={1}&lc={2}",n,this.get_OpenMenuNewAndOpenCommonHelpers().get_newAndOpenOfficeAppType(),this.get_LocaleName()),r=null;this._writeFileIdInHeader?(r={})["X-FileId"]=L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion:i+=String.format("&{0}",L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion),this.get_OpenMenuNewAndOpenCommonHelpers().get_newAndOpenClientRequestManager().addRequest(i,1,null,r,!0,4,e,t,null)},t.prototype.TryDeserializeJson=function(e){var t;try{t=x.x.secureDeserialize(e)}catch(e){t=null,S.ULS.sendTraceTag(5849675,202,10,"MruActor.TryDeserializeJson: Exception thrown from JsonSerializer.SecureDeserialize Exception: {0}",e)}return t},t.prototype.get_OpenMenuNewAndOpenCommonHelpers=function(){return this._newAndOpenCommonHelpers.get_value()},t.prototype.get_LocaleName=function(){return this._localeName.get_value()},t.get_instance=function(){return t._instance||(t._instance=t.GetAnInstanceWithResolvedDependencies())},t.GetAnInstanceWithResolvedDependencies=function(){return new t(new nt.q(mn,(function(){return Pn.get_instance()})),new nt.q(String,(function(){return Ft.i.getCultureInfo(L.AFrameworkApplication.lcid).get_name()})),new nt.q(String,(function(){return L.AFrameworkApplication.appSettingsManager.getStringAppSetting("MruServerReadRetryIntervalsInMs")})),new nt.q(String,(function(){return L.AFrameworkApplication.appSettingsManager.getStringAppSetting("MruServerWriteRetryIntervalsInMs")})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("MruWriteFileIdInHeader"))},t.CurrentDocumentDAVUrlHeaderName="CurrentDocumentDAVUrl",t.NewDocumentDAVUrlHeaderName="NewDocumentDAVUrl",t.NewFileNameHeaderName="NewFileName",t._instance=null,t}(Sn);(0,o.l)(Bn,"91ed1cd1$MruActor",Sn.$$(yn),[]);var On=function(){function e(){this._container=null,this._readFromMruTask=null}return e.prototype.get_name=function(){return"Common.App.NewAndOpen.Core"},e.prototype.configure=function(e){this._container=e,e.register(mn).singleInstance().usingFactory((function(){return Pn.get_instance()})),e.register(Cn.$$(fn)).singleInstance().usingFactory((function(){return Mn.get_instance()})),e.register(Cn.$$(yn)).singleInstance().usingFactory((function(){return Bn.get_instance()}))},e.prototype.init=function(){var e=this;L.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){e.InitOnFullAppSettingsReady()}))},e.prototype.InitOnFullAppSettingsReady=function(){this._container.resolve(mn),this._container.resolve(Cn.$$(fn)),this._container.resolve(Cn.$$(yn));var e=!1;if(Pn.get_instance().RegisterCommonActions(),L.AFrameworkApplication.get_newDocumentDestinationHost()&&(e=!0),L.AFrameworkApplication.get_readFromMruIsEnabled()&&(Bn.get_instance().MakeGetMruRequestOpenTrigger(),L.AFrameworkApplication.get_mruPollingIntervalInMs()>0&&this.AddGetMruFromServerTask(),this.SetupReadFromMruInactivityActions(),e=!0),L.AFrameworkApplication.get_supportsGetMoreInfoForPersonalStorage()&&e&&Mn.get_instance().makeGetMoreInfoRequestOpenDocumentTrigger(),L.AFrameworkApplication.get_updateMruIsEnabled()){var t=Bn.get_instance();t.RegisterWriteMruActions(),t.MakeUpdateMruRequestOpenTrigger(),this.SetupWriteToMruInactivityActions()}},e.prototype.SetupReadFromMruInactivityActions=function(){kn.get_instance().addBackFromInactiveAction(o.i(Bn.get_instance(),Bn.get_instance().MakeGetMruRequestActivityTrigger,"MakeGetMruRequestActivityTrigger")),kn.get_instance().addBackFromInactiveAction(o.i(this,this.AddGetMruFromServerTask,"AddGetMruFromServerTask")),kn.get_instance().addOnInactiveAction(o.i(this,this.DeleteGetMruFromServerTask,"DeleteGetMruFromServerTask"))},e.prototype.SetupWriteToMruInactivityActions=function(){kn.get_instance().addOnInactiveAction(o.i(Bn.get_instance(),Bn.get_instance().MakeUpdateMruRequestInactivityTrigger,"MakeUpdateMruRequestInactivityTrigger")),kn.get_instance().addBackFromInactiveAction(o.i(Bn.get_instance(),Bn.get_instance().MakeUpdateMruRequestBackFromInactivityTrigger,"MakeUpdateMruRequestBackFromInactivityTrigger"))},e.prototype.DeleteGetMruFromServerTask=function(){Ce.y.get_instance().deleteTask(this.get_MruReadTask())},e.prototype.AddGetMruFromServerTask=function(){Ce.y.get_instance().addTask(this.get_MruReadTask())},e.prototype.get_MruReadTask=function(){return this._readFromMruTask||(this._readFromMruTask=new ge.c(4,2,L.AFrameworkApplication.get_mruPollingIntervalInMs(),o.i(Bn.get_instance(),Bn.get_instance().GetMruFromServerTask,"GetMruFromServerTask"),109))},e.prototype.dispose=function(){},e}();(0,o.l)(On,"4a180a22$CorePackageManager",null,[s.u,u.s,Sys.IDisposable]);var Un=function(){function e(){}return e.main=function(){B.o.get_instance().registerPackage(new On)},e}();(0,o.l)(Un,"20a7e964$Program",null,[]);var Hn=(0,o.y)("e2bd125d$IOneDriveFilePickerApiManager"),Gn=(0,o.y)("a111baab$IOneDriveApiEndpointHelper"),Wn=(0,o.y)("c35ee48e$IErrorDialog"),Vn=n(6121),$n=function(e){function t(){var t=e.call(this)||this;return t.set_buttonsOption(0),t.setButtonText(1,CommonUIStrings.l_DialogClose),t}return(0,v.t)(t,e),t.prototype.displayError=function(e){this.showError(e,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)},t.prototype.displayWarning=function(e){this.showError(e,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)},t}(Vn.StandardDialog);(0,o.l)($n,"ee980de7$ErrorDialog",Vn.StandardDialog,[Wn]);var zn=function(){function e(){}return e.prototype.getApiEndpoint=function(){S.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var e=new ct.z(String);return e.setResult("api.onedrive.com"),e.get_task()},e}();(0,o.l)(zn,"2bc42204$OneDriveConsumerEndpointHelper",null,[Gn]);var Kn=n(5645),qn=function(){function e(e,t,n,i){this._errorDialogFactory=null,this.appEnvironment=0,this.appSettingsManager=null,this.onFilePickerClosedCallback=null,this._limitedEdit=!1,this._onApiReadyCallback=null,this._setup=!1,this._settingUp=!1,this._oneDriveApiScript=null,this.appSettingsManager=e,this.appEnvironment=t,this._limitedEdit=n,this._errorDialogFactory=i}return e.prototype.get_appEnvironment=function(){return this.appEnvironment},e.prototype.get_appSettingsManager=function(){return this.appSettingsManager},e.prototype.getOneDriveApi=function(){return this._oneDriveApiScript||(this._oneDriveApiScript=this.get_oneDriveApiUrl()?Lt.v.create(this.get_oneDriveApiUrl(),null,null,null,!1):null),this._oneDriveApiScript},e.prototype.setup=function(e){var t=this;if(this._onApiReadyCallback=e,this._setup||this._settingUp)this._setup&&this._onApiReadyCallback&&this._onApiReadyCallback(!0);else{var n=this.getOneDriveApi();if(!n)return S.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),void this._onApiReadyCallback(!1);this._settingUp=!0,n.get_loadFinishedTask().CW((function(e){t.OnOneDriveApiScriptLoaded(e)})),Nt.z.enqueueResourceWithoutEnabling(n)}},e.prototype.onJsDownloadFail=function(e){S.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",e.get_exception()?e.get_exception().toString():"No error detail.")},e.prototype.OnOneDriveApiScriptLoaded=function(e){if(this._settingUp=!1,e.get_isFaulted())return this.onJsDownloadFail(e),void this._onApiReadyCallback(!1);try{this._setup=!0,S.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.initializeApi(),S.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this._onApiReadyCallback(!0)}catch(e){S.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",e.toString()),this._onApiReadyCallback(!1)}},e.prototype.startPicker=function(e){this.onFilePickerClosedCallback=e,this._limitedEdit?S.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(S.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(o.i(this,this.onApiReady,"onApiReady")))},e.prototype.onApiReady=function(e){e?this.launchFilePicker():this.showErrorDialog()},e.prototype.showErrorDialog=function(){this._errorDialogFactory().displayError(Kn.p.oneDriveFilePickerNotJSON)},e.prototype.onSuccess=function(e){S.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function."),this.onFilePickerClosedCallback&&this.onFilePickerClosedCallback(!0,e)},e.prototype.dispose=function(){this._oneDriveApiScript&&this._oneDriveApiScript.dispose()},e}();(0,o.l)(qn,"9599af55$AOneDriveFilePickerApiManager",null,[Hn,Sys.IDisposable]);var jn=function(e){function t(t,n,i,r,o,a){var l=e.call(this,n,i,r,a)||this;return l._signOutResponse=null,l._showRequireSignInDialog=null,l._options=null,l._signOutResponse=t,l._showRequireSignInDialog=o,l}return(0,v.t)(t,e),t.prototype.get_oneDriveApiUrl=function(){return this.get_appSettingsManager().getStringAppSetting("OneDriveApiUrl")},t.prototype.start=function(e,t){this._options=e,this.startPicker(t)},t.prototype.initializeApi=function(){var e=1===this.get_appEnvironment()||2===this.get_appEnvironment()?{client_id:this.get_appSettingsManager().get_appSettings().UploadToSkyDriveClientId}:{client_id:this.get_appSettingsManager().get_appSettings().UploadToSkyDriveClientId,env:"INT"};WL.init(e)},t.prototype.startPicker=function(e){this.onFilePickerClosedCallback=e,!this._limitedEdit&&this._signOutResponse.get_isAuthenticated()?(S.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(o.i(this,this.onApiReady,"onApiReady"))):(S.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this._showRequireSignInDialog())},t.prototype.launchFilePicker=function(){try{S.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this._options).then(o.i(this,this.onSuccess,"onSuccess"),o.i(this,this.onFailure,"onFailure"))}catch(e){S.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",e,e.stack),this.showErrorDialog()}},t.prototype.onFailure=function(e){var t=e;if(e&&t.error){if("user_canceled"===t.error.code)return void S.ULS.sendTraceTag(17909058,352,50,"User canceled.");S.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",t.error.code,t.error.message)}else S.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.onFilePickerClosedCallback&&this.onFilePickerClosedCallback(!1,e),this.showErrorDialog()},t}(qn);(0,o.l)(jn,"7b7a8e77$OneDriveFilePickerApiManagerV5",qn,[]);var Qn=n(8599),Jn=function(e){function t(t,n,i,r,a){var l=e.call(this,t,n,i,r)||this;return l._endpointHelper=null,l._oneDriveApiEndpoint=null,l._hostDivElement=null,l.options=null,l._endpointHelper=a,l.options={},l.options.clientId=l.get_appSettingsManager().getStringAppSetting("OneDriveApiV7ClientId"),l.options.cancel=o.i(l,l.ToggleHostDivVisibility,"ToggleHostDivVisibility"),l}return(0,v.t)(t,e),t.prototype.get_oneDriveApiUrl=function(){return this.get_appSettingsManager().getStringAppSetting("OneDriveApiV72Url")},t.prototype.start=function(e,t){var n=this;this._hostDivElement=t;var i=this._endpointHelper.getApiEndpoint();i.CWo((function(t){S.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker"),n._oneDriveApiEndpoint=i.get_result(),n.startPicker((function(t,i){n.ToggleHostDivVisibility(),e(t,i)}))}),Qn.d.onlyOnRanToCompletion),i.CWo((function(e){S.ULS.sendTraceTag(24134242,352,15,i.get_exception().message),n.ToggleHostDivVisibility()}),Qn.d.onlyOnFaulted)},t.prototype.initializeApi=function(){var e=this;this.options.success=function(t){var n={};n.data=t,e.onSuccess(n)},this.options.error=function(t){var n={};n.error=t,e.onFailure(n)},this.options.advanced={},this.options.advanced.linkType="share",this.options.advanced.endpointHint=this._oneDriveApiEndpoint,this.options.advanced.iframeParentDiv=this._hostDivElement},t.prototype.launchFilePicker=function(){try{S.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.ToggleHostDivVisibility(),OneDrive.open(this.options)}catch(e){S.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",e.message),this.showErrorDialog()}},t.prototype.onFailure=function(e){this.onFilePickerClosedCallback&&this.onFilePickerClosedCallback(!1,e),this.showErrorDialog()},t.prototype.ToggleHostDivVisibility=function(){this._hostDivElement.style.visibility="hidden"===this._hostDivElement.style.visibility?"":"hidden"},t}(qn);(0,o.l)(Jn,"e300c8f5$OneDriveFilePickerApiManagerV7",qn,[]);var Xn=function(e){function t(n,i,r,o){var a=e.call(this,n,i,r,o)||this;return a.options=null,a.options={},a.options.advanced={},a.options.action=t.QueryAction,a.options.clientId=a.get_appSettingsManager().getStringAppSetting("OneDriveApiV72ClientId"),a.options.advanced.trapFocus=!0,a}return(0,v.t)(t,e),t.prototype.get_oneDriveApiUrl=function(){return this.get_appSettingsManager().getStringAppSetting("OneDriveApiV72Url")},t.prototype.start=function(e,t,n,i){this.options.advanced.iframeParentDiv=n,this.options.advanced.endpointHint=i,this.options.cancel=t,this.startPicker(e)},t.prototype.startPicker=function(e){this.onFilePickerClosedCallback=e,this._limitedEdit?S.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(S.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(o.i(this,this.onApiReady,"onApiReady")))},t.prototype.initializeApi=function(){var e=this;this.options.success=function(t){var n={};n.data=t,e.onSuccess(n)},this.options.error=function(t){var n={};n.error=t,e.onFailure(n)}},t.prototype.launchFilePicker=function(){try{S.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(e){S.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",e.message,e.stack),this.showErrorDialog()}},t.prototype.onJsDownloadFail=function(e){S.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",e.get_exception()?e.get_exception().toString():"No error detail."),Nt.z.removeReferenceForRetryDownload(this.get_oneDriveApiUrl()),this._oneDriveApiScript=null},t.prototype.showErrorDialog=function(){this._errorDialogFactory().displayWarning(Kn.p.saveAsToOneDriveFailed_FilePicker)},t.prototype.onFailure=function(e){this.onFilePickerClosedCallback&&this.onFilePickerClosedCallback(!1,e)},t.QueryAction="query",t}(qn);(0,o.l)(Xn,"890b07$OneDriveFilePickerApiManagerV72",qn,[]);var Yn=function(e){function t(n,i,r,o){var a=e.call(this,n,i,r,o)||this;return a.options.advanced.filter=n.getStringAppSetting("OneDriveApiV72Filter")||t.MediaFilter,a.options.advanced.linkType="download",a.options.multiSelect=L.AFrameworkApplication.appSupportsMultiInsertOnlinePictureFromHost,n.getBooleanAppSetting("OneDriveApiV72CommandModeEnabled")&&(a.options.commandMode=n.getStringAppSetting("OneDriveApiV72CommandMode")||t.CommandMode),a}return(0,v.t)(t,e),t.prototype.get_oneDriveApiUrl=function(){return this.get_appSettingsManager().getStringAppSetting("OneDriveApiV72Url")},t.prototype.launchFilePicker=function(){try{S.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}",this.options.advanced.filter,this.options.commandMode),OneDrive.open(this.options)}catch(e){S.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",e.message,e.stack),this.showErrorDialog()}},t.MediaFilter="folder,photo",t.CommandMode="none",t}(Xn);(0,o.l)(Yn,"28ed6d33$OneDriveFilePickerApiOpenManagerV72",Xn,[]);var Zn=function(){function e(e){this._tcs=null,this._clientRequestManager=null,this._retriesRemaining=0,this._clientRequestManager=e,this._retriesRemaining=3}return e.prototype.getApiEndpoint=function(){return this._tcs=new ct.z(String),S.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint"),this.SendGetMoreInfoRequest(),this._tcs.get_task()},e.prototype.SendGetMoreInfoRequest=function(t){void 0===t&&(t=null);var n=String.format("GetMoreInfoHandler.ashx?{0}",L.AFrameworkApplication.currentFileBaseDocQuerySignatureWithoutVersion);this._clientRequestManager.addRequestWithHeaderForwarding(n,1,null,t,[e.PersonalFileStorageUrlHeaderName,e.CanaryNewValueHeaderName],!1,2,o.i(this,this.GetMoreInfoSucceeded,"GetMoreInfoSucceeded"),o.i(this,this.GetMoreInfoFailed,"GetMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")},e.prototype.GetMoreInfoFailed=function(t){if(t.get_data().httpStatus===Y.k.preconditionFailed_412&&e.CanaryNewValueHeaderName in t.get_data().responseHeaders){S.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var n={};n[e.CanaryHeaderName]=t.get_data().responseHeaders[e.CanaryNewValueHeaderName],this.SendGetMoreInfoRequest(n)}else this._retriesRemaining>0?(S.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this._retriesRemaining),this._retriesRemaining--,this.SendGetMoreInfoRequest()):(S.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this._tcs.SX(Error.create("GetMoreInfo request failed and no more retries remain")))},e.prototype.GetMoreInfoSucceeded=function(t){e.PersonalFileStorageUrlHeaderName in t.get_data().responseHeaders&&""!==t.get_data().responseHeaders[e.PersonalFileStorageUrlHeaderName]?(S.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this._tcs.setResult(t.get_data().responseHeaders[e.PersonalFileStorageUrlHeaderName])):(S.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this._tcs.SX(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))},e.PersonalFileStorageUrlHeaderName="PersonalFileStorageUrl",e.CanaryNewValueHeaderName="X-NewKey",e.CanaryHeaderName="X-Key",e}();(0,o.l)(Zn,"da8aa1c7$OneDriveForBusinessEndpointHelper",null,[Gn]);var ei=n(5826),ti=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.OneDriveFilePickerApi"},e.prototype.init=function(){},e.prototype.dispose=function(){},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register(jn).as(Hn).singleInstance().usingFactory((function(){return new jn(ei.t.get_instance(),L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.get_environment(),L.AFrameworkApplication.limitedEdit,L.AFrameworkApplication.showRequiresSignInDialog,(function(){return new $n}))})),L.AFrameworkApplication.get_isSkyDrive()?this._container.register(Gn).singleInstance().usingFactory((function(){return new zn})):this._container.register(Gn).singleInstance().usingFactory((function(){return new Zn(L.AFrameworkApplication.theClientRequestManager)})),this._container.register(Jn).singleInstance().usingFactory((function(){return new Jn(L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.get_environment(),L.AFrameworkApplication.limitedEdit,(function(){return new $n}),t._container.resolve(Gn))})),this._container.register(Xn).singleInstance().usingFactory((function(){return new Xn(L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.get_environment(),L.AFrameworkApplication.limitedEdit,(function(){return new $n}))})),this._container.register(Yn).singleInstance().usingFactory((function(){return new Yn(L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.get_environment(),L.AFrameworkApplication.limitedEdit,(function(){return new $n}))}))},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(ti,"8c00a4fe$PackageManager",null,[s.u,u.s]);var ni=n(6146),ii=function(){return function(e,t,n,i,r){this.WebAffinitizedUrl=null,this.PolicyCookie=null,this.PolicyCookieTTL=0,this.WasServiceDown=!1,this.expirationTime=null,this.IsSafeLinksEnabled=e,this.WebAffinitizedUrl=t,this.PolicyCookie=n,this.PolicyCookieTTL=i,this.WasServiceDown=r}}();(0,o.l)(ii,"b38874b7$SafeLinksData",null,[]);var ri=function(){function e(){this._localStorageNotWorking=!1}return e.prototype.GetItem=function(e){var t=this.GetLocalStorage();if(!t)return null;try{return t.getItem(e)}catch(e){return null}},e.prototype.SetItem=function(e,t){var n=this.GetLocalStorage();if(n)try{n.setItem(e,t)}catch(e){}},e.prototype.RemoveItem=function(e){var t=this.GetLocalStorage();if(t)try{t.removeItem(e)}catch(e){}},e.prototype.GetLocalStorage=function(){var e=null;if(!this._localStorageNotWorking)try{localStorage&&(e=localStorage)}catch(e){this._localStorageNotWorking=!0}return e},e.get_Instance=function(){return e._instance||(e._instance=new e),e._instance},e._instance=null,e}();(0,o.l)(ri,"1bc6fe82$SafeLinksLocalStorage",null,[]);var oi=n(1712),ai=n(706),li=function(){function e(t,n,i,r,o){var a=this;if(void 0===r&&(r=!1),void 0===o&&(o=null),this._appSettingsManager=null,this._clientRequestManager=null,this.workloadId=null,this._webServiceBaseUrl=null,this._userId=null,this._appName=null,this._maxGetPolicyBootRetries=0,this._maxGetPolicyOnLinkClickRetries=0,this._getPolicyOnBootRetries=0,this._getPolicyOnLinkClickRetries=0,this._getPolicyRequestPending=!1,this.isGetPolicyBootRequest=!1,this._pendingUrlToFollow=null,this._isUserLicensedForSafeLinks=!0,S.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager."),this._appSettingsManager=t,this.IsSafeLinksEnabledForUser()&&this.IsSafeLinksEnabledForBrowser()){S.ULS.sendTraceTag(26019599,378,50,"Safelinks is enabled for the user."),this._clientRequestManager=n,this._appName=i,this._webServiceBaseUrl=r?this._appSettingsManager.getStringAppSetting("SafeLinksHandlerWebServiceBase"):this._appSettingsManager.getStringAppSetting("WebServiceBase"),this._userId=this._appSettingsManager.getStringAppSetting("SafeLinksHashedUserId"),this.workloadId=this._appSettingsManager.getStringAppSetting("SafeLinksWorkloadIdHeaderValue"),this._maxGetPolicyBootRetries=this._appSettingsManager.getIntAppSetting("SafeLinksMaxGetPolicyBootRetries",2),this._maxGetPolicyOnLinkClickRetries=this._appSettingsManager.getIntAppSetting("SafeLinksMaxGetPolicyOnLinkClickRetries",1);var l=this.GetCachedData(),s=l?l.IsSafeLinksEnabled.toLowerCase():"",u=this.IsPolicyCookieExpired();S.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",s,u),(!l||"unknown"===s||l.WasServiceDown||u)&&this.GetSafeLinksDataFromServerAsync(!0),!!this._appSettingsManager.containsAppSetting("LicensingForSafeLinksIsEnabled")&&this._appSettingsManager.getBooleanAppSetting("LicensingForSafeLinksIsEnabled")&&o&&o.execute((function(t){t.isFeatureEnabled(e.MsoUrlReputation,!0).then((function(e){return a._isUserLicensedForSafeLinks=e,null}))}))}}return e.prototype.get_appName=function(){return this._appName},e.prototype.get_webServiceBaseUrl=function(){return this._webServiceBaseUrl},e.prototype.get_userId=function(){return this._userId},e.prototype.get_GetPolicyHandlerUrl=function(){var t=this.get_webServiceBaseUrl()?this.get_webServiceBaseUrl()+"/":"",n=new oi.QueryStringBuilder(e.GetSafeLinksDataName);return n.addParam("app",this.get_appName()),this._appSettingsManager.getBooleanAppSetting("SafeLinksUseDebugHeader")&&n.addParam("action","debug"),String.format("{0}{1}&{2}",t,n.toString(),L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion)},e.prototype.tryNavigate=function(e){return this._isUserLicensedForSafeLinks&&this.IsSafeLinksEnabledForUser()&&this.ShouldTryUsingSafeLinksService()?this.IsHyperLinkTypeSupportedBySafeLinks(e)?(S.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink"),this.IsPolicyCookieExpired()?(this._pendingUrlToFollow=e,S.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired."),this.isGetPolicyBootRequest=!1,this.GetSafeLinksDataFromServerAsync(),!0):(this.TryNavigateInternal(e),!0)):(S.ULS.sendTraceTag(37065607,378,50,"Hyperlink type is not supported by SafeLinks."),!1):(S.ULS.sendTraceTag(26019600,378,50,"SafeLinks not enabled for this user."),!1)},e.prototype.IsHyperLinkTypeSupportedBySafeLinks=function(e){e=e.toLowerCase();var t=this._appSettingsManager.getListAppSetting("SafeLinksUnsupportedProtocols");if(t)for(var n=0;n<t.length;n++)if(e.startsWith(t[n]))return!1;return!0},e.prototype.GetSafeLinksDataFromServerAsync=function(t){void 0===t&&(t=!1),this._clientRequestManager.addRequest(this.get_GetPolicyHandlerUrl(),1,null,null,!0,2,o.i(this,this.OnSuccessCallback,"OnSuccessCallback"),o.i(this,this.OnFailureCallback,"OnFailureCallback"),null,void 0,void 0,void 0,e.GetPolicyRequestTimeoutInMs,"23"),this.isGetPolicyBootRequest=t,this._getPolicyRequestPending=!0,t?this._getPolicyOnBootRetries++:this._getPolicyOnLinkClickRetries++},e.prototype.OnSuccessCallback=function(t){this.isGetPolicyBootRequest=!1,this._getPolicyRequestPending=!1;var n=t&&t.get_data()?t.get_data().responseData:null;if(!n||!n.length)return S.ULS.sendTraceTag(23900183,378,10,"No response data from Safelinks Service: {0}",t?t.get_data():null),void this.HandleGetPolicyRequestError(e.DefaultErrorHttpStatus);try{var i=x.x.secureDeserialize(n);if(!i)return S.ULS.sendTraceTag(23900184,378,10,"Error when serializing response into SafeLinksSessionData. SafeLinksSessionData is null."),void this.HandleGetPolicyRequestError(t.get_data().httpStatus);var r=i.IsSafeLinksEnabled,o=e.ParseSafeLinksEnabledForUser(r),a=o?i.WebAffinitizedUrl:null,l=o?i.PolicyCookie:null,s=new Date;if(o){var u=i.PolicyCookieTTL>e.TtlBufferInMinutes?i.PolicyCookieTTL-e.TtlBufferInMinutes:0;s.setMinutes(s.getMinutes()+u)}var c=s.getTime(),d=new ii(r,a,l,c,!1);this.WriteValuesToLocalStorage(d),this._pendingUrlToFollow&&(o?(this.TryNavigateInternal(this._pendingUrlToFollow),this._getPolicyOnBootRetries=0,this._getPolicyOnLinkClickRetries=0):(S.ULS.sendTraceTag(26019602,378,50,"SafeLinks is no longer enabled; Navigating without SafeLinks"),bt.g.followHyperlinkWithNoReferrer(this._pendingUrlToFollow)),this._pendingUrlToFollow=null)}catch(e){S.ULS.sendTraceTag(23900185,378,10,"Error when serializing response into SafeLinksSessionData: {0}.",e.toString()),this.HandleGetPolicyRequestError(t.get_data().httpStatus)}},e.prototype.OnFailureCallback=function(t){this._getPolicyRequestPending=!1,S.ULS.sendTraceTag(23900186,378,10,"Request to Safelinks Service failed with error response: {0}.",t&&t.get_data()?t.get_data().responseXml:null);var n=t&&t.get_data()?t.get_data().httpStatus:e.DefaultErrorHttpStatus;this.HandleGetPolicyRequestError(n)},e.prototype.HandleGetPolicyRequestError=function(t){if(this._getPolicyOnBootRetries<this._maxGetPolicyBootRetries&&this._getPolicyOnLinkClickRetries<this._maxGetPolicyOnLinkClickRetries)this.GetSafeLinksDataFromServerAsync(this.isGetPolicyBootRequest);else{this.isGetPolicyBootRequest=!1,this._getPolicyRequestPending=!1,S.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}.",this._getPolicyOnBootRetries,this._getPolicyOnLinkClickRetries);var n=new ii("false","","",0,t>=e.DefaultErrorHttpStatus);this.WriteValuesToLocalStorage(n),this._pendingUrlToFollow&&(S.ULS.sendTraceTag(26019603,378,50,"Error occured during GetPolicy call; Navigating without SafeLinks"),bt.g.followHyperlinkWithNoReferrer(this._pendingUrlToFollow),this._pendingUrlToFollow=null)}},e.prototype.TryNavigateInternal=function(e){var t=this.GetPolicyCookieFromCache(),n=this.GetWebAffinitizedUrlFromCache(),i={};i.Url=e,i.SafeLinksCookie=t,i.CorrelationId=ai.l.create().toString(),i.WorkloadId=this.workloadId,i.UserAgentInfo=W.y.get_browserNameForlogging()+"|"+this.get_appName(),S.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",i.CorrelationId),bt.g.postToWindow(bt.g.windowTargetToString(4),n,i)},e.prototype.IsSafeLinksEnabledForUser=function(){var t=this._appSettingsManager.getStringAppSetting("IsSafeLinksEnabledForUser");return!!t&&e.ParseSafeLinksEnabledForUser(t)},e.prototype.IsSafeLinksEnabledForBrowser=function(){var e=this._appSettingsManager.getListAppSetting("SafeLinksDisabledBrowsers");return!(e&&W.y.get_isElectron()&&Array.contains(e,"Electron"))},e.prototype.ShouldTryUsingSafeLinksService=function(){var t=this.GetCachedData(),n=t?t.IsSafeLinksEnabled:"";if(""!==n)return e.ParseSafeLinksEnabledForUser(n);if(this._getPolicyRequestPending||this._getPolicyOnBootRetries>=this._maxGetPolicyBootRetries||this._getPolicyOnLinkClickRetries>=this._maxGetPolicyOnLinkClickRetries)return!1;var i=this._getPolicyOnBootRetries+this._getPolicyOnLinkClickRetries;return S.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over.",this._maxGetPolicyBootRetries+this._maxGetPolicyOnLinkClickRetries-i),!0},e.prototype.WriteValuesToLocalStorage=function(e){if(ri.get_Instance()){var t=JSON.stringify(e);ri.get_Instance().SetItem(this.get_userId(),t)}else S.ULS.sendTraceTag(24462657,378,10,"LocalStorage instance is null.")},e.prototype.GetPolicyCookieFromCache=function(){var e=this.GetCachedData();return e?e.PolicyCookie:""},e.prototype.GetWebAffinitizedUrlFromCache=function(){var e=this.GetCachedData();return e?e.WebAffinitizedUrl:""},e.prototype.GetExpirationTimeFromCache=function(){var e=new Date;try{var t=this.GetCachedData(),n=t?t.PolicyCookieTTL:0;e.setTime(n)}catch(e){S.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",e)}return e},e.prototype.IsPolicyCookieExpired=function(){var e=this.GetExpirationTimeFromCache();return!!e&&e.getTime()<Date.now()},e.prototype.GetCachedData=function(){if(!ri.get_Instance())return S.ULS.sendTraceTag(24462659,378,10,"LocalStorage instance is null."),null;var e=ri.get_Instance().GetItem(this.get_userId());return e&&""!==e?JSON.parse(e):null},e.ParseSafeLinksEnabledForUser=function(e){return"false"!==e.toLowerCase()},e.GetSafeLinksDataName="SafeLinksHandler.ashx",e.IsSafeLinksEnabledForSession="IsSafeLinksEnabledForSession",e.SafeLinksSessionPolicyCookie="SafeLinksSessionPolicyCookie",e.SafeLinksSessionPolicyCookieExpirationMins="SafeLinksSessionPolicyCookieExpirationMins",e.SafeLinksSessionWebAffinitizedUrl="SafeLinksSessionWebAffinitizedUrl",e.MsoUrlReputation="MsoUrlreputation",e.TtlBufferInMinutes=5,e.GetPolicyRequestTimeoutInMs=7e3,e.DefaultErrorHttpStatus=500,e}();(0,o.l)(li,"fd26ef4$SafeLinksManager",null,[ni.o]);var si=function(){function e(){}return e.appTypeToString=function(e){switch(e){case 3:return"Word";case 2:return"PowerPoint";case 1:return"Excel";default:return"Unknown"}},e.appModeToString=function(e){switch(e){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}},e}();(0,o.l)(si,"bff069a3$SafeLinksUtil",null,[]);var ui=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.SafeLinks"},e.prototype.configure=function(e){var t=this;this._container=e,L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WACSafeLinksIsEnabled")&&e.register(li).as(ni.o).singleInstance().usingFactory((function(){return new li(L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.theClientRequestManager,String.format("{0}-{1}",si.appTypeToString(L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()),si.appModeToString(L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppMode())),!1,t._container.resolveFuture(j.a))}))},e.prototype.init=function(){Zt.m.get_instance().get_appIsInteractiveTask().CWR(ni.o,(function(e){return Ge.w.get_instance().tryResolve(ni.o)}))},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(ui,"78580ffd$SafeLinksPackage",null,[s.u,u.s]);var ci=n(927),di=(0,o.y)("5ea805b0$IBusinessBarEntryFactory"),gi=n(1959),pi=function(){function e(t,n,i,r){var a=this;this._signoutResponse=null,this._businessBarEntry=null,this._dialog=null,this._task=null,this._showCloseButton=!1,this._businessBar=null,this._businessBarEntryFactory=null,this._signoutResponse=t,this._showCloseButton=r,this._signoutResponse.get_isAuthenticated()&&(this._task=new ge.c(3,2,e.TaskInterval,o.i(this,this.AuthenticationCheckTask,"AuthenticationCheckTask"),2),L.AFrameworkApplication.get_theTaskManager().addTask(this._task),this.RegisterActions(n,i)),this._signoutResponse.add_authenticationLost((function(e,t){a.OnAuthenticationLost()})),this._signoutResponse.add_authenticationRestored((function(e,t){a.OnAuthenticationRestored()}))}return e.prototype.get_BusinessBar=function(){return this._businessBar||(this._businessBar=Ge.w.get_instance().tryResolve(ci.c))},e.prototype.get_BusinessBarEntryFactory=function(){return this._businessBarEntryFactory||(this._businessBarEntryFactory=Ge.w.get_instance().tryResolve(di))},e.prototype.verifyAuthentication=function(){this._signoutResponse.get_isAuthenticated()||this.OnAuthenticationLost()},e.prototype.RegisterActions=function(e,t){var n=L.AFrameworkApplication.get_theActionManager();n.addActionWithFlags(Fe.b.authenticationLost,Ue.m.frame,e,96),n.addActionWithFlags(Fe.b.authenticationRestored,Ue.m.frame,t,96),n.addAction(Fe.b.cancelSigninBusinessBar,Ue.m.frame,Le.ActionManager.doNothingHandler),n.addAction(Fe.b.cancelSigninDialog,Ue.m.frame,Le.ActionManager.doNothingHandler),n.addAction(Fe.b.launchSigninWindow,Ue.m.frame,Le.ActionManager.doNothingHandler)},e.prototype.OnAuthenticationLost=function(){this.ShowDialog(CommonUIStrings.l_AuthenticationLostMessage),L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.authenticationLost,2)},e.prototype.OnAuthenticationRestored=function(){this.TeardownUI(),L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.authenticationRestored,2)},e.prototype.AuthenticationCheckTask=function(e){this._signoutResponse.authenticationCheck()},e.prototype.TeardownUI=function(){this._dialog&&(this._dialog.hide(),this._dialog.dispose(),this._dialog=null),this._businessBarEntry&&this.get_BusinessBar()&&(L.AFrameworkApplication.isShuttingDown||this.get_BusinessBar().removeEntry(this._businessBarEntry),this._businessBarEntry.dispose(),this._businessBarEntry=null)},e.prototype.ShowDialog=function(e){gi.d.safeDispose(this._dialog),this._dialog=new Vn.StandardDialog,this._showCloseButton||(this._dialog.set_hasCloseGlyph(!1),this._dialog.set_buttonsOption(0)),this._dialog.setButtonText(1,CommonUIStrings.l_SignIn),this._dialog.showWarning(CommonUIStrings.l_DefaultDialogTitle,e,o.i(this,this.DialogHandler,"DialogHandler"))},e.prototype.DialogHandler=function(e,t){1===e?(ei.t.performSignIn(),this.ShowDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.launchSigninWindow,2)):(this.ShowBusinessBar(),L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.cancelSigninDialog,2))},e.prototype.ShowBusinessBar=function(){this.get_BusinessBar()&&this.get_BusinessBarEntryFactory()&&(this._businessBarEntry=this.get_BusinessBarEntryFactory().create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this._businessBarEntry.set_closeable(!0),this._businessBarEntry.addButton(CommonUIStrings.l_SignIn,e.BusinessBarButtonHandler,""),this._businessBarEntry.set_closeHandler(o.i(this,this.BusinessBarEntryCloseHandler,"BusinessBarEntryCloseHandler")),this.get_BusinessBar().addEntry(this._businessBarEntry,!1))},e.prototype.BusinessBarEntryCloseHandler=function(e){this.DisableTask(),L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.cancelSigninBusinessBar,2)},e.prototype.DisableTask=function(){this._task&&(L.AFrameworkApplication.get_theTaskManager().deleteTask(this._task),this._task=null)},e.prototype.dispose=function(){this._businessBarEntry=null,this._dialog=null,this._task=null},e.BusinessBarButtonHandler=function(e){ei.t.performSignIn(),L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.launchSigninWindow,2)},e.TaskInterval=5e3,e}();(0,o.l)(pi,"a281ddd8$SignOutResponseUI",null,[Sys.IDisposable]);var hi=function(){function e(){}return e.prototype.get_name=function(){return"Common.App.UI"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){gi.d.safeDispose(e._signOutResponse),e._signOutResponse=null},e.main=function(){B.o.get_instance().registerPackage(new e)},e.initSignOutResponseUI=function(t,n,i,r){e.ShouldUseSignoutResponseUI(t)&&(e._signOutResponse=new pi(ei.t.get_instance(),n,i,r))},e.ShouldUseSignoutResponseUI=function(e){return L.AFrameworkApplication.needsSignOutChecking&&!L.AFrameworkApplication.get_isEmbedded()},e._signOutResponse=null,e}();(0,o.l)(hi,"66837630$CommonAppUIPackage",null,[s.u,u.s]);var _i=n(9913),mi=n(7328),fi=n(2125),yi=n(4670),Ci=n(8518),Si=n(3948),bi=function(){function e(e,t,n,i){this._inputCallback=null,this._keyDownCallback=null,this._resetCallback=null,this._isListening=!1,this._inCharGatheringMode=!1,this._editingDomManager=null,this._caretPositionManager=null,this._inputRegistered=!1,this._backspaceDeleteEventSource=null,this._mostRecentlyTypedKeyCode=0,this._interactiveViewManager=null,this._keyInputManager=null,this._editingDomManager=e,this._caretPositionManager=t,this._backspaceDeleteEventSource=n,this._interactiveViewManager=i,this.reset()}return e.prototype.beginListening=function(e,t){var n=this;this._isListening||(e.get_isAppInteractive()?(this.BeginListeningInternal(e,t),this._isListening=!0):e.add_appIsInteractive((function(i,r){n._isListening||(n.BeginListeningInternal(e,t),n._isListening=!0)})))},e.prototype.dispose=function(){this._inputRegistered&&(yi.App.get_activeAppFrame().get_theTextInputEventManager().unregisterHandler(me.d.input,this._interactiveViewManager.get_editingView().get_editingElement(),o.i(this,this.TextInputHandler,"TextInputHandler")),this._inputRegistered=!1);this.StopCharGatheringMode(),yi.App.get_activeAppFrame().remove_onResize(o.i(this,this.OnWindowResize,"OnWindowResize"))},e.prototype.OnWindowResize=function(){this.reset()},e.prototype.registerInputCallback=function(e){this._inputCallback=e},e.prototype.registerResetCallback=function(e){this._resetCallback=e},e.prototype.registerKeyDownCallback=function(e){this._keyDownCallback=e},e.prototype.BeginCharGatheringMode=function(){this._keyInputManager&&!this._inCharGatheringMode&&(this._inCharGatheringMode=!0,this._keyInputManager.registerHandler(me.d.beforeKeyDown,this._interactiveViewManager.get_editingView().get_editingElement(),o.i(this,this.BeforeKeyDownHandler,"BeforeKeyDownHandler")),this._keyInputManager.registerHandler(me.d.keyUp,this._interactiveViewManager.get_editingView().get_editingElement(),o.i(this,this.KeyUpHandler,"KeyUpHandler")))},e.prototype.StopCharGatheringMode=function(){this._keyInputManager&&this._inCharGatheringMode&&(this._keyInputManager.unregisterHandler(me.d.beforeKeyDown,this._interactiveViewManager.get_editingView().get_editingElement(),o.i(this,this.BeforeKeyDownHandler,"BeforeKeyDownHandler")),this._keyInputManager.unregisterHandler(me.d.keyUp,this._interactiveViewManager.get_editingView().get_editingElement(),o.i(this,this.KeyUpHandler,"KeyUpHandler")),this._inCharGatheringMode=!1)},e.prototype.BeginListeningInternal=function(e,t){if(this._keyInputManager=t,this._interactiveViewManager.get_selectionView().get_isPageView()){if(yi.App.box4TypingTaskTriggeredByInput&&W.y.get_supportsInputEvent()||W.y.get_isInternetExplorerEdge())yi.App.get_activeAppFrame().get_theTextInputEventManager().registerHandler(me.d.input,this._interactiveViewManager.get_editingView().get_editingElement(),o.i(this,this.TextInputHandler,"TextInputHandler"),null),this._inputRegistered=!0;this._backspaceDeleteEventSource.add_onBackspaceDelete(o.i(this,this.BackspaceDeleteHandler,"BackspaceDeleteHandler")),yi.App.get_activeAppFrame().add_onResize(o.i(this,this.OnWindowResize,"OnWindowResize"))}},e.prototype.BeforeKeyDownHandler=function(e){return this._mostRecentlyTypedKeyCode=e.innerEvent.keyCode,!!this._keyDownCallback&&(e.innerEvent.keyCode===Re.v.vK_Escape||e.innerEvent.keyCode===Re.v.vK_Enter?(e.innerEvent.keyCode===Re.v.vK_Escape?S.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"):e.innerEvent.keyCode===Re.v.vK_Enter&&S.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"),this._keyDownCallback(e),this.reset(),!0):(e.innerEvent.keyCode===Re.v.vK_DownArrow||e.innerEvent.keyCode===Re.v.vK_UpArrow||e.innerEvent.keyCode===Re.v.vK_PageDown||e.innerEvent.keyCode===Re.v.vK_PageUp)&&(this._keyDownCallback(e),!0))},e.prototype.TextInputHandler=function(e){var t=this.GetParagraphOfCurrentCursorLocation(),n=this.GetCursorPosition(e.innerEvent.target),i=e.innerEvent.rawEvent.inputType;return(null!=i||this._mostRecentlyTypedKeyCode!==Re.v.vK_Backspace&&this._mostRecentlyTypedKeyCode!==Re.v.vK_Delete)&&("deleteContentBackward"!==i&&"deleteContentForward"!==i&&this.HandleTextInput(t,n,e.innerEvent.target))},e.prototype.HandleTextInput=function(t,n,i){if(n<1)return!1;var r=t.charAt(n-1);return this._inCharGatheringMode&&r!==e.At?this.HandleKeyword(t,n,i):this._inCharGatheringMode||r!==e.At?this._inCharGatheringMode&&r===e.At&&S.ULS.sendTraceTag(41178052,324,50,"Tried to type @ while already in at mention mode"):this._inputCallback&&(this.reset(),this.PreviousCharacterIsValidForAtMentionMode(n,t)&&(this.BeginCharGatheringMode(),this.HandleKeyword(t,n,i),S.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===n?"true":"false"))),this._inCharGatheringMode},e.prototype.KeyUpHandler=function(e){var t=this.GetParagraphOfCurrentCursorLocation(),n=this.GetCursorPosition(e.innerEvent.target);return e.innerEvent.keyCode!==Re.v.vK_Backspace&&e.innerEvent.keyCode!==Re.v.vK_Delete||this.HandleKeyword(t,n,e.innerEvent.target),!1},e.prototype.reset=function(){this._isListening=!1,this.StopCharGatheringMode(),this._resetCallback&&this._resetCallback()},e.prototype.GetCursorPosition=function(e){return this._caretPositionManager.getCaretPosition(2,e)},e.prototype.GetParagraphOfCurrentCursorLocation=function(){return this._editingDomManager.getEditingElement().innerText.trimEnd()},e.prototype.PreviousCharacterIsValidForAtMentionMode=function(e,t){if(e-2<0)return!0;var n=t.charAt(e-2);return!!this.CharacterIsValidToBeBeforeAt(n)},e.prototype.CharacterIsValidToBeBeforeAt=function(e){return this.CharacterIsEqualToSpace(e)||"("===e},e.prototype.CharacterIsEqualToSpace=function(e){return"\xa0"===e||" "===e},e.prototype.HandleKeyword=function(e,t,n){if(!e||""===e||t<0)this.reset();else{var i=this.keywordFromCurrentSelection(e,t);this._inputCallback(i,n)}},e.prototype.keywordFromCurrentSelection=function(t,n){for(var i=-1,r=n;r>=0&&n-r<=63;r--)if(t.charAt(r)===e.At){i=r;break}var o=t.length;for(r=n;r<t.length;r++)if(this.CharacterIsEqualToSpace(t.charAt(r))){o=r;break}return i>=0&&o<=t.length?t.substring(i,o):(this.reset(),"")},e.prototype.HandleBackspaceKeydown=function(t){var n=this.GetCursorPosition(t.innerEvent.target),i=this.GetParagraphOfCurrentCursorLocation().charAt(n-1);this._inCharGatheringMode&&i===e.At&&this.reset()},e.prototype.HandleDeleteKeydown=function(t){var n=this.GetCursorPosition(t.innerEvent.target),i=this.GetParagraphOfCurrentCursorLocation().charAt(n);this._inCharGatheringMode&&i===e.At&&this.reset()},e.prototype.BackspaceDeleteHandler=function(e,t){this._mostRecentlyTypedKeyCode=t.get_isBackspace()?Re.v.vK_Backspace:t.get_isDelete()?Re.v.vK_Delete:this._mostRecentlyTypedKeyCode,this._inCharGatheringMode&&(t.get_isBackspace()?this.HandleBackspaceKeydown(t.get_keyEvent()):t.get_isDelete()&&this.HandleDeleteKeydown(t.get_keyEvent()))},e.At="@",e}();(0,o.l)(bi,"2d0270a7$AtMentionsListener",null,[_i.w]);var vi=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.AtMentions"},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register(_i.w).singleInstance().usingFactory((function(){return new bi(t._container.resolve(mi.q),t._container.resolve(fi.t),t._container.resolve(Ci.t),Si.InteractiveViewManager.get_instance())}))},e.prototype.init=function(){var e=this;L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CanvasAtMentionDetectionIsEnabled")&&L.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){e._container.resolve(_i.w).beginListening(yi.App.get_activeAppFrame().workspace,Me.KeyInputManager.get_instance())}))},e.prototype.dispose=function(){this._container.resolve(_i.w).dispose()},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(vi,"c9706e62$Box4AtMentionsPackage",null,[s.u,u.s]);var Ti=n(1637),Ai=n(5199),Ii=n(8923),wi=n(9680),xi=n(7578),Ei=n(9469),Fi=function(){function e(e,t,n,i,r,a,l){this._forceOutboundMinIntervalInMs=0,this._forceOutboundMaxIntervalInMs=0,this._intervalIncreaseStepInMs=0,this._intervalDecreaseFactor=0,this._forceOutboundIntervalInMs=0,this.TaskManager=null,this.TaskItem=null,this.Workspace=null,this.LastForceOutbound=null,this.PendingOutbound=!1,this.Workspace=t,this.LastForceOutbound=new Date(0),this.PendingOutbound=!1,this._forceOutboundMinIntervalInMs=i,this._forceOutboundMaxIntervalInMs=r,this._forceOutboundIntervalInMs=this._forceOutboundMinIntervalInMs,this._intervalIncreaseStepInMs=a,this._intervalDecreaseFactor=l,this.TaskManager=e,this.TaskItem=new ge.c(2,2,n,o.i(this,this.MonitorChanges,"MonitorChanges")),this.TaskManager.addTask(this.TaskItem)}return e.prototype.MonitorChanges=function(e){var t=new Date;!this.PendingOutbound&&+t-+this.LastForceOutbound>=this._forceOutboundIntervalInMs&&this.ForceFasterOutboundIfNecessary(t)},e.prototype.ForceFasterOutboundIfNecessary=function(t){var n,i,r=!0,a=-1,l=this.Workspace.get_activePage();if(i=this.GetReplicatorForFasterOutbound(l,(0,g.m)((function(){return n}),(function(e){return n=e})),(0,g.m)((function(){return r}),(function(e){return r=e})))){a=n;var s=i.getDependency(),u=e.GetCheckedReplicator(s);u&&(a=(n=i.replicationTimer.requestIntervalRemaining())>a?n:a,u.forceOutbound(null,null,null))}else if((i=this.GetReplicatorForFasterOutbound(this.Workspace.get_activeSection(),(0,g.m)((function(){return n}),(function(e){return n=e})),(0,g.m)((function(){return r}),(function(e){return r=e}))))||(i=this.GetReplicatorForFasterOutbound((0,y.e)(wi.n,this.Workspace.get_activeFolder()),(0,g.m)((function(){return n}),(function(e){return n=e})),(0,g.m)((function(){return r}),(function(e){return r=e})))))a=n;else if(l){var c=Ii.PageNavigator.get_instance().getVersionHistoryNode(l),d=!0;(i=this.GetReplicatorForFasterOutbound(c,(0,g.m)((function(){return n}),(function(e){return n=e})),(0,g.m)((function(){return d}),(function(e){return d=e}))))&&(a=n)}return i?(i.forceOutbound(o.i(this,this.ForceOutboundSuccessfulCallback,"ForceOutboundSuccessfulCallback"),o.i(this,this.ForceOutboundFailedCallback,"ForceOutboundFailedCallback"),null),this.PendingOutbound=!0,this.LastForceOutbound=t,this._forceOutboundIntervalInMs=Math.min(this._forceOutboundIntervalInMs+this._intervalIncreaseStepInMs,this._forceOutboundMaxIntervalInMs),S.ULS.sendTraceTag(18961026,339,50,"Faster outbound saved {0}ms.",a),!0):(r&&this._forceOutboundIntervalInMs>this._forceOutboundMinIntervalInMs+e.BrowserTimerAdjustmentInMs&&(this._forceOutboundIntervalInMs=this._forceOutboundIntervalInMs-e.CalculateDecrease(this._forceOutboundIntervalInMs,this._forceOutboundMinIntervalInMs,this._intervalDecreaseFactor),this._forceOutboundIntervalInMs=Math.max(this._forceOutboundMinIntervalInMs,this._forceOutboundIntervalInMs)),!1)},e.prototype.GetReplicatorForFasterOutbound=function(t,n,i){n.val=-1;var r=e.GetCheckedReplicator(t);return!r||r.get_isUsingOneNoteContentSync()||1!==r.get_state()||e.IsReplicationHappeningSoon(r,this._forceOutboundIntervalInMs,n)?(i.val=!1,null):e.HasChangesMiniCheck(t)?(i.val=!1,r):null},e.prototype.ForceOutboundSuccessfulCallback=function(e){this.PendingOutbound=!1,this.LogForceOutboundSpentTime(0)},e.prototype.ForceOutboundFailedCallback=function(e,t){this.PendingOutbound=!1,this.LogForceOutboundSpentTime(t)},e.prototype.LogForceOutboundSpentTime=function(e){var t=new Date;S.ULS.sendTraceTag(19244304,339,50,"Faster outbound finished in {0}ms, status code: {1}",+t-+this.LastForceOutbound,Ai.r[e])},e.prototype.dispose=function(){this.TaskManager&&this.TaskManager.deleteTask(this.TaskItem)},e.GetCheckedReplicator=function(t){var n=t?t.get_contentReplicator():null;return e.IsLastReplicationSuccessful(n)?n:null},e.IsLastReplicationSuccessful=function(e){return!!e&&(e.get_lastReplicationSuccessful()||e.get_lastReplicated().equals(mt.h.get_nil()))},e.IsReplicationHappeningSoon=function(e,t,n){return n.val=e.replicationTimer.requestIntervalRemaining(),n.val<t},e.HasChangesMiniCheck=function(e){var t=new Ei.m;t.set(e);var n=xi.r.moveToContentIfLoaded(t),i=e.get_contentObjectSpace();return!(!n||!i)&&(!!(t.get_isCoreChannelOpen()&&2&t.get_invalidSubGraphCoreState()||e.get_cachedMetadata()&&e.get_cachedMetadata().get_isDirty())||!(!i.get_currentRevision()||i.get_currentRevision().get_id().equals(e.get_contentReplicator().get_lastReplicated())))},e.CalculateDecrease=function(e,t,n){return 1e3*Math.log((e-t+1e3)/1e3)/Math.log(n)},e.BrowserTimerAdjustmentInMs=5,e}();(0,o.l)(Fi,"29ac5081$FasterOutbound",null,[Sys.IDisposable]);var Pi=function(){function e(){this._FasterOutbound=null}return e.prototype.configure=function(e){},e.prototype.get_name=function(){return"OneNote.FasterOutbound"},e.prototype.init=function(){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteFasterOutboundIsEnabled")&&(this._FasterOutbound=new Fi(L.AFrameworkApplication.get_theTaskManager(),Ti.App.get_activeOneNoteFrame().workspace,L.AFrameworkApplication.appSettingsManager.getIntAppSetting("OneNoteFasterOutboundCheckIntervalInMs",400),L.AFrameworkApplication.appSettingsManager.getIntAppSetting("OneNoteFasterOutboundMinForceIntervalInMs",2e3),L.AFrameworkApplication.appSettingsManager.getIntAppSetting("OneNoteFasterOutboundMaxForceIntervalInMs",5e3),L.AFrameworkApplication.appSettingsManager.getIntAppSetting("OneNoteFasterOutboundForceIntervalIncreaseStepInMs",1500),L.AFrameworkApplication.appSettingsManager.getIntAppSetting("OneNoteFasterOutboundForceDecreaseFactor",100)))},e.prototype.dispose=function(){this._FasterOutbound&&gi.d.safeDispose(this._FasterOutbound)},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Pi,"5a1f46ef$OneNoteFasterOutboundPackage",null,[s.u,u.s]);var Di=n(1032),Ri=(0,o.y)("e6a01758$ISessionExpirationManagerWithDialog"),Mi=n(9353),ki=function(){function e(){this._sessionExpiredDialogAlreadyDisplayed=!1,this._sessionExpiringDialogAlreadyDisplayed=!1,this.accessTokenTtl=0;var e=L.AFrameworkApplication.get_accessTokenTtl();if(!(e<=0)){this.accessTokenTtl=e;var t=new Date;S.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{AccessTokenTtl:this.accessTokenTtl,NowGetTime:t.getTime(),BootTime:L.AFrameworkApplication.bootTime}),Mi.c.get_instance().add_sessionExpiredDetected(o.i(this,this.OnSessionExpiredDetected,"OnSessionExpiredDetected")),Mi.c.get_instance().add_sessionAboutToExpireDetected(o.i(this,this.OnSessionExpiringDetected,"OnSessionExpiringDetected"))}}return e.prototype.OnSessionExpiredDetected=function(e,t){Mi.c.get_instance().remove_sessionExpiredDetected(o.i(this,this.OnSessionExpiredDetected,"OnSessionExpiredDetected")),S.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected"),this.HandleSessionExpired()},e.prototype.OnSessionExpiringDetected=function(e,t){Mi.c.get_instance().remove_sessionAboutToExpireDetected(o.i(this,this.OnSessionExpiringDetected,"OnSessionExpiringDetected")),this._sessionExpiringDialogAlreadyDisplayed||this._sessionExpiredDialogAlreadyDisplayed||(S.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this._sessionExpiringDialogAlreadyDisplayed=!0,this.showSessionExpiringDialog())},e.prototype.HandleSessionExpired=function(){this._sessionExpiredDialogAlreadyDisplayed||(L.AFrameworkApplication.reportError(Kn.p.sessionAccessTokenExpired),this._sessionExpiredDialogAlreadyDisplayed=!0,this.showSessionExpiredDialog())},e}();(0,o.l)(ki,"a85ed475$ASessionExpirationManager",null,[]);var Ni=n(3977),Li=n(5390),Bi=n(6618),Oi=n(9375),Ui=function(){function e(){}return e.sessionExpirationDialogHtmlForceToRefresh="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>",e.sessionExpirationSaveDataInstructionDialogHtml="<div class='WACDialogRow' id='SessionExpirationParagraph1'> <label id='OneNoteSessionExpirationActionRequired' class='WACDialogLabel' >L_SessionExpiredActionRequiredText</label> </div> <div class='WACDialogRow' id='SessionExpirationParagraph2'> <label id='OneNoteSessionExpirationSaveWorkInstruction' class='WACDialogLabel' >L_SessionExpiredSaveWorkInstructionText</label> </div> <div class='WACDialogRow' id='SessionExpirationParagraph3'> <label id='OneNoteSessionExpirationHighlightedText' class='WACDialogLabel UnsavedChangesExample' >L_SessionExpiredUnsavedWork</label> </div>",e}();(0,o.l)(Ui,"452c4ff5$OneNoteSessionExpirationDialogHtml",null,[]);var Hi=n(4380),Gi=function(e){function t(t,n,i,r){var o=this;if(o._isExpiredDialog=!1,o._accessTokenTtl=0,o._sessionRefreshCallback=null,o._sessionDisposeCallback=null,o._businessBarControllerFuture=null,o=e.call(this,!0)||this,n){S.ULS.sendTraceTag(20201729,217,50,"User session has expired");var a=yi.App.get_activeAppFrame().workspace.get_activePage();if(a)if(a.get_contentReplicator().hasChangesToOutbound())return S.ULS.sendTraceTag(20201730,217,50,"User session has expired with unsaved changes"),void o.SetupSaveDataInstructionDialog(t,i,r)}return o.SetupForceToRefreshDialog(t,n,i,r),o}return(0,v.t)(t,e),t.prototype.get_businessBarControllerFuture=function(){return this._businessBarControllerFuture||(this._businessBarControllerFuture=Ge.w.get_instance().resolveFuture(Li.d))},t.prototype.SetupSaveDataInstructionDialog=function(e,n,i){this.set_dialogHtml(Ui.sessionExpirationSaveDataInstructionDialogHtml),this._sessionRefreshCallback=n,this._sessionDisposeCallback=i;var r={};this.set_buttonsOption(0),this.setButtonText(1,OneNoteIntl.OneNoteStrings.l_SessionExpiredDialogButtonContinue),r[t.OneNoteSessionExpirationActionRequiredId]=OneNoteIntl.OneNoteStrings.l_SessionExpiredActionRequiredText,r[t.OneNoteSessionExpirationSaveWorkInstructionId]=OneNoteIntl.OneNoteStrings.l_SessionExpiredSaveWorkInstructionText,r[t.OneNoteSessionExpirationHighlightedTextId]=OneNoteIntl.OneNoteStrings.l_SessionExpiredUnsavedWork,this.initializeAndShow(OneNoteIntl.OneNoteStrings.l_SessionExpiredDialogTitle,o.i(this,this.SessionExpirationSaveDataInstructionDialogHandler,"SessionExpirationSaveDataInstructionDialogHandler"),r),this.setDescribedByForDialog(this.myId(t.OneNoteSessionExpirationActionRequiredId))},t.prototype.SetupForceToRefreshDialog=function(e,n,i,r){this.set_dialogHtml(Ui.sessionExpirationDialogHtmlForceToRefresh),this._accessTokenTtl=e,this._sessionRefreshCallback=i,this._sessionDisposeCallback=r,this._isExpiredDialog=n;var a={};L.AFrameworkApplication.get_canExecuteCloseAction()?(this.set_buttonsOption(1),this.setButtonText(0,CommonUIStrings.l_DialogClose)):(this.set_buttonsOption(0),this.set_hasCloseGlyph(!1)),this.setButtonText(1,this._isExpiredDialog||1===L.AFrameworkApplication.get_activeFrame().get_mode()?CommonUIStrings.l_SessionExpirationRefreshButton:CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);var l=new Date(this._accessTokenTtl).format(L.AFrameworkApplication.shortTimeFormat);a[t.SessionExpirationForceToRefreshTextId]=this._isExpiredDialog?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,l),this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,o.i(this,this.SessionExpirationForceToRefreshDialogHandler,"SessionExpirationForceToRefreshDialogHandler"),a),this.setDescribedByForDialog(this.myId(t.SessionExpirationForceToRefreshTextId))},t.prototype.SessionExpirationForceToRefreshDialogHandler=function(e,t){1===e?this._sessionRefreshCallback&&this._sessionRefreshCallback(this._isExpiredDialog):e||L.AFrameworkApplication.get_theActionManager().processActionWithData(Fe.b.close,2,Hi.z.sessionExpiration)},t.prototype.SessionExpirationSaveDataInstructionDialogHandler=function(e,t){this.get_businessBarControllerFuture().execute((function(e){e.checkSessionExpirationBusinessBar(yi.App.get_activeAppFrame().get_mode(),!0)})),L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.readingMode,2)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._sessionDisposeCallback&&this._sessionDisposeCallback()},t.SessionExpirationForceToRefreshTextId="WACSessionExpirationText",t.OneNoteSessionExpirationActionRequiredId="OneNoteSessionExpirationActionRequired",t.OneNoteSessionExpirationSaveWorkInstructionId="OneNoteSessionExpirationSaveWorkInstruction",t.OneNoteSessionExpirationHighlightedTextId="OneNoteSessionExpirationHighlightedText",t}(Bi.o);(0,o.l)(Gi,"e6a96dfd$OneNoteSessionExpirationDialog",Bi.o,[]);var Wi=function(e){function t(t){var n=e.call(this)||this;return n._appFrame=null,n._showDialogOnKickout=!0,n._showDialogOnExpiring=!0,n._sessionExpirationDialog=null,n._eventSource=new at.f,n._appFrame=t,n}return(0,v.t)(t,e),t.prototype.add_onSessionExpired=function(e){this._eventSource.addHandler(t.sessionExpiredEventKey,e)},t.prototype.remove_onSessionExpired=function(e){this._eventSource.removeHandler(t.sessionExpiredEventKey,e)},t.prototype.add_onSessionExpiring=function(e){this._eventSource.addHandler(t.sessionExpiringEventKey,e)},t.prototype.remove_onSessionExpiring=function(e){this._eventSource.removeHandler(t.sessionExpiringEventKey,e)},t.prototype.add_onTokenRefreshed=function(e){this._eventSource.addHandler(t.tokenRefreshedEventKey,e)},t.prototype.remove_onTokenRefreshed=function(e){this._eventSource.removeHandler(t.tokenRefreshedEventKey,e)},t.prototype.showDialogOnKickout=function(e){this._showDialogOnKickout=e},t.prototype.showDialogOnExpiring=function(e){this._showDialogOnExpiring=e},t.prototype.showSessionExpiringDialog=function(){if(!this._sessionExpirationDialog&&!Ni.h.get_currentDialog()){var e=o.i(this,this.DisposeCallback,"DisposeCallback");this._sessionExpirationDialog=new Gi(this.accessTokenTtl,!1,o.i(this,this.SessionExpirationHandler,"SessionExpirationHandler"),e)}},t.prototype.showSessionExpiredDialog=function(){if(this._sessionExpirationDialog&&(this._sessionExpirationDialog.get_isShowing()&&this._sessionExpirationDialog.hide(),this._sessionExpirationDialog=null),this._showDialogOnKickout){var e=o.i(this,this.DisposeCallback,"DisposeCallback");this._sessionExpirationDialog=new Gi(this.accessTokenTtl,!0,o.i(this,this.SessionExpirationHandler,"SessionExpirationHandler"),e)}this._eventSource.raiseEvent(t.sessionExpiredEventKey)},t.prototype.DisposeCallback=function(){this._sessionExpirationDialog=null},t.prototype.SessionExpirationHandler=function(e){(e||this._appFrame.beforeRefreshDocument())&&this._appFrame.refreshDocument(null)},t.sessionExpiredEventKey="SE",t.sessionExpiringEventKey="SEP",t.tokenRefreshedEventKey="SER",t}(ki);(0,o.l)(Wi,"c7f973a6$OneNoteSessionExpirationManager",ki,[Ri,Di.k]);var Vi=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"OneNote.SessionExpiration"},e.prototype.init=function(){var e=this;L.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){e.InitOnFullAppSettingsReady()}))},e.prototype.InitOnFullAppSettingsReady=function(){this._container.resolve(Wi)},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e,e.register(Wi).as(Di.k).as(Ri).singleInstance().usingFactory((function(){return new Wi(L.AFrameworkApplication.get_activeFrame())}))},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Vi,"44f170ef$OneNoteSessionExpirationPackage",null,[s.u,u.s]);var $i=n(6242),zi=function(){function e(e){this._editNotificationEventSource=null,this._savedStatusText=null,this._savingStatusText=null,this._readOnlyStatusText=null,this._reviewModeStatusText=null,this._appPermissionMode=0,this._isContentSaved=!1,this._isHidden=!1,this._editNotificationEventSource=e,this._appPermissionMode=3,this._isContentSaved=!0}return e.prototype.Initialize=function(e,t){var n=this;return this._savedStatusText=this.GetSavedStatusText(e,t),this._savingStatusText=CommonUIStrings.l_SavingStatus,this._readOnlyStatusText=CommonUIStrings.l_ReadOnlyStatus,this._reviewModeStatusText=CommonUIStrings.l_ReviewModeStatus,this._editNotificationEventSource&&this._editNotificationEventSource.execute((function(e){e.add_onEditHappened(o.i(n,n.UpdateToSavingStatus,"UpdateToSavingStatus"))})),!0},e.prototype.updateSaveStatusDisplay=function(e,t){this._isHidden=e,this._appPermissionMode=t,this.updateSaveStatusText(this._isContentSaved)},e.prototype.updateSaveStatusText=function(e){this._isContentSaved=e;var t=null;3===this._appPermissionMode&&(t=this._isContentSaved?this._savedStatusText:this._savingStatusText),this.DispatchSaveStatusAction(t)},e.prototype.updateToFailStatus=function(e){this._isContentSaved=!1,this.DispatchSaveStatusAction(e)},e.prototype.updateStatusText=function(e){this.DispatchSaveStatusAction(e)},e.prototype.GetSavedStatusText=function(e,t){return e?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):t&&t.length?String.format(CommonUIStrings.l_SavedToStatus,t):CommonUIStrings.l_SavedStatus},e.prototype.UpdateToSavingStatus=function(e,t){this.updateSaveStatusText(!1)},e.prototype.GetModeText=function(){switch(this._appPermissionMode){case 1:return this._readOnlyStatusText;case 2:return this._reviewModeStatusText;default:return null}},e.prototype.DispatchSaveStatusAction=function(e){Ln.AppChromeUtils.appChromeAlreadyLoaded()?appChrome.api.dispatch(appChrome.actions.updateDocumentTitleStatus(this._isHidden,e,this.GetModeText())):S.ULS.sendTraceTag(51212686,340,15,"DispatchSaveStatusAction, AppChrome is not defined.")},e}();(0,o.l)(zi,"fcde9ec2$ReactSaveStatusUIHandler",null,[$i.i]);var Ki=function(){function e(e,t){this.hostPostmessenger=null,this._hostPostmessengerFuture=null,this._editNotificationEventSource=null,this._saveStatus=!1,this._appPermissionMode=0,this._savedStatusText=CommonUIStrings.l_SavedStatus,this._savingStatusText=CommonUIStrings.l_SavingStatus,this._readOnlyStatusText=CommonUIStrings.l_ReadOnlyStatus,this._reviewModeStatusText=CommonUIStrings.l_ReviewModeStatus,this._hostPostmessengerFuture=t,this._editNotificationEventSource=e,this._appPermissionMode=3,this._saveStatus=!0}return e.prototype.RegisterHandlers=function(){var e=this;this._editNotificationEventSource&&this._editNotificationEventSource.execute((function(t){t.add_onEditHappened(o.i(e,e.UpdateToSavingStatus,"UpdateToSavingStatus"))})),this._hostPostmessengerFuture.execute((function(t){e.hostPostmessenger=t}))},e.prototype.updateSaveStatusDisplay=function(e,t){this._appPermissionMode=t,3===t?this.updateSaveStatusText(this._saveStatus):2===t?this.TrySendPostMessageToHost(this._reviewModeStatusText):this.TrySendPostMessageToHost(this._readOnlyStatusText)},e.prototype.UpdateToSavingStatus=function(e,t){this.updateSaveStatusText(!1)},e.prototype.updateSaveStatusText=function(e){this._saveStatus=e;var t=this._saveStatus?this._savedStatusText:this._savingStatusText;this.TrySendPostMessageToHost(t)},e.prototype.updateToFailStatus=function(e){this._saveStatus=!1,this.TrySendPostMessageToHost(e)},e.prototype.updateStatusText=function(e){this.TrySendPostMessageToHost(e)},e.prototype.TrySendPostMessageToHost=function(e){this.hostPostmessenger&&this.hostPostmessenger.sendMessage(he.a.uI_SaveStatus,this.ConstructPostMessageData(e))},e.prototype.ConstructPostMessageData=function(e){var t={};return t.StatusText=e,t},e}();(0,o.l)(Ki,"bd06b2ac$SaveStatusPostMessageHandler",null,[$i.i]);var qi=n(6154),ji=n(5866),Qi=function(){function e(e,t,n,i){this._eventHandlerManager=null,this._headerEventSource=null,this._editNotificationEventSource=null,this._savedStatusText=null,this._savingStatusText=null,this._readOnlyStatusText=null,this._reviewModeStatusText=null,this._isFirstTextUpdate=!1,this._isRtl=!1,this._isHidden=!1,this._appPermissionMode=0,this._saveStatus=!1,this._maxElementWidth=0,this._titleElement=null,this._appModeDashElement=null,this._appModeStatusElement=null,this._saveStatusDashElement=null,this._saveStatusElement=null,this._eventHandlerManager=e,this._headerEventSource=t,this._editNotificationEventSource=n,this._isRtl=i,this._isFirstTextUpdate=!0,this._isHidden=!1,this._appPermissionMode=3,this._saveStatus=!0}return e.prototype.Initialize=function(e,t){return!!this._eventHandlerManager&&(this._savedStatusText=this.GetSavedStatusText(e,t),this._savingStatusText=CommonUIStrings.l_SavingStatus,this._readOnlyStatusText=CommonUIStrings.l_ReadOnlyStatus,this._reviewModeStatusText=CommonUIStrings.l_ReviewModeStatus,this.RegisterHandlers(),!0)},e.prototype.GetSavedStatusText=function(e,t){return e?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):t&&t.length?String.format(CommonUIStrings.l_SavedToStatus,t):CommonUIStrings.l_SavedStatus},e.prototype.RegisterHandlers=function(){var e=this;this._headerEventSource&&this._headerEventSource.execute((function(t){t.add_onTopRowControlsCreated(o.i(e,e.CreateStatusAndModeElements,"CreateStatusAndModeElements")),t.add_onRenameTextboxStatusChanged(o.i(e,e.ShowHideSaveStatusElement,"ShowHideSaveStatusElement")),t.get_topRowControlsCreated()&&e.CreateStatusAndModeElements(null,null)})),this._editNotificationEventSource&&this._editNotificationEventSource.execute((function(t){t.add_onEditHappened(o.i(e,e.UpdateToSavingStatus,"UpdateToSavingStatus"))}))},e.prototype.UnregisterHandlers=function(){this._saveStatusElement&&this._eventHandlerManager&&this._eventHandlerManager.unregisterAllHandlers(this._saveStatusElement)},e.prototype.ShowHideSaveStatusElement=function(e,t){this.updateSaveStatusDisplay("true"===t,this._appPermissionMode)},e.prototype.updateSaveStatusDisplay=function(e,t){this._isHidden=e,this._appPermissionMode=t,this._appModeDashElement&&(this._appModeDashElement.style.display=this._isHidden||3===this._appPermissionMode||!this._titleElement?"none":""),this._appModeStatusElement&&(this._appModeStatusElement.style.display=this._isHidden||3===this._appPermissionMode?"none":"",this._appModeStatusElement.innerText=1===this._appPermissionMode?this._readOnlyStatusText:this._reviewModeStatusText,this._appModeStatusElement.title=1===this._appPermissionMode?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip),this._saveStatusDashElement&&(this._saveStatusDashElement.style.display=this._isHidden||1===this._appPermissionMode||!this._titleElement&&!this._appModeStatusElement?"none":""),this._saveStatusElement&&(this._saveStatusElement.style.display=this._isHidden||1===this._appPermissionMode?"none":"",this.updateSaveStatusText(this._saveStatus),this._saveStatusElement.title=CommonUIStrings.l_SaveStatusTooltip)},e.prototype.CreateStatusAndModeElements=function(t,n){var i=document.getElementById(it.CuiHelper.headerDocumentTitleSpanId);!(!!n&&n.withoutSaveStatus)&&i&&""!==this._savedStatusText&&""!==this._savingStatusText&&""!==this._readOnlyStatusText&&""!==this._reviewModeStatusText&&(this._titleElement=document.getElementById(it.CuiHelper.breadcrumbTitleId),this._appModeDashElement=it.CuiHelper.createBreadcrumbItem(i,e._breadcrumbAppModeDashId,"-",null,!1),this._appModeStatusElement=it.CuiHelper.createBreadcrumbItem(i,e._breadcrumbAppModeStatusId,1===this._appPermissionMode?this._readOnlyStatusText:this._reviewModeStatusText,null,!1),this.UpdateElementStyle(this._appModeStatusElement),this._saveStatusDashElement=it.CuiHelper.createBreadcrumbItem(i,e._breadcrumbSaveStatusDashId,"-",null,!1),this._saveStatusElement=it.CuiHelper.createBreadcrumbItem(i,e._breadcrumbSaveStatusId,this._savedStatusText,null,!1),this.UpdateElementStyle(this._saveStatusElement),this.updateSaveStatusDisplay(this._isHidden,this._appPermissionMode))},e.prototype.UpdateToSavingStatus=function(e,t){this.updateSaveStatusText(!1)},e.prototype.updateSaveStatusText=function(e){this._saveStatus=e,this.updateSaveElementText(this._saveStatus?this._savedStatusText:this._savingStatusText)},e.prototype.updateToFailStatus=function(e){this._saveStatus=!1,this.UpdateAndAdjustStatusElementWidth(e)},e.prototype.updateStatusText=function(e){this.UpdateAndAdjustStatusElementWidth(e)},e.prototype.updateSaveElementText=function(e){!this._saveStatusElement||3!==this._appPermissionMode&&2!==this._appPermissionMode||(this._isFirstTextUpdate&&!this._saveStatus?(this._maxElementWidth=this._saveStatusElement.offsetWidth<this._maxElementWidth?this._maxElementWidth:this._saveStatusElement.offsetWidth,this.UpdateAndAdjustStatusElementWidth(this._savingStatusText),this._isFirstTextUpdate=!1):this._saveStatusElement.innerText=e)},e.prototype.UpdateElementStyle=function(e){e.style.direction=this._isRtl?"rtl":"ltr",e.style.width="auto",e.style.textAlign=this._isRtl?"right":"left",e.style.display=this._isHidden?"none":"",e.setAttribute("Unselectable","on")},e.prototype.UpdateAndAdjustStatusElementWidth=function(e){if(this._saveStatusElement){this._saveStatusElement.style.width="",this._saveStatusElement.innerText=e,this._maxElementWidth=this._saveStatusElement.offsetWidth<this._maxElementWidth?this._maxElementWidth:this._saveStatusElement.offsetWidth;var t=qi.o.getCurrentStyle(this._saveStatusElement);this._saveStatusElement.style.width=this._maxElementWidth-ji.s.parseCssSize(t.paddingLeft)-ji.s.parseCssSize(t.paddingRight)+1+"px"}},e._breadcrumbAppModeDashId="BreadcrumbAppModeDash",e._breadcrumbAppModeStatusId="BreadcrumbAppModeStatus",e._breadcrumbSaveStatusDashId="BreadcrumbSaveStatusDash",e._breadcrumbSaveStatusId="BreadcrumbSaveStatus",e}();(0,o.l)(Qi,"71aea1a3$SaveStatusUIHandler",null,[$i.i]);var Ji=n(2946),Xi=function(){function e(){this._container=null,this._saveStatusUIHandler=null,this._reactSaveStatusUIHandler=null,this._saveStatusPostMessageHandler=null}return e.prototype.get_name=function(){return"Common.App.SaveStatus"},e.prototype.configure=function(e){var t=this;this._container=e,L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PostMessageEmbedded")&&L.AFrameworkApplication.hideHeaderEmbedded?this._container.register(Ki).as($i.i).singleInstance().usingFactory((function(){return new Ki(t._container.resolveFuture(ce.n),t._container.resolveFuture(se.i))})):L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSyncUxFeatureEnabled()||(L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderUxEnabled()?this._container.register(zi).as($i.i).singleInstance().usingFactory((function(){return new zi(t._container.resolveFuture(ce.n))})):this._container.register(Qi).as($i.i).singleInstance().usingFactory((function(){return new Qi(Ji.EventHandlerManager.get_instance(),t._container.resolveFuture(Ee.p),t._container.resolveFuture(ce.n),L.AFrameworkApplication.get_isRtl())})))},e.prototype.init=function(){L.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady(o.i(this,this.OnFullAppSettingsReady,"OnFullAppSettingsReady"))},e.prototype.OnFullAppSettingsReady=function(){var e=L.AFrameworkApplication.appSettingsManager,t=!!L.AFrameworkApplication.get_activeFrame().get_applicationInstance()&&4===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType();(e.getBooleanAppSetting("WordEditorAutoSaveImprovementIsEnabled")||e.getBooleanAppSetting("PptEditorSaveStatusInHeaderEnabled")||t&&e.getBooleanAppSetting("SimplifiedReactRibbonUxIsEnabled")||e.getBooleanAppSetting("ExcelSaveStatusInHeaderEnabled")||e.getBooleanAppSetting("VisioSaveStatusInHeaderEnabled"))&&(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PostMessageEmbedded")&&L.AFrameworkApplication.hideHeaderEmbedded?(this._saveStatusPostMessageHandler=this._container.resolve(Ki),this._saveStatusPostMessageHandler&&this._saveStatusPostMessageHandler.RegisterHandlers()):L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSyncUxFeatureEnabled()||(L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderUxEnabled()?(this._reactSaveStatusUIHandler=this._container.resolve(zi),this._reactSaveStatusUIHandler&&this._reactSaveStatusUIHandler.Initialize(e.getBooleanAppSetting("IsSkyDrive"),e.getStringAppSetting("HostNameToIncludeInSavedStatus"))):(this._saveStatusUIHandler=this._container.resolve(Qi),this._saveStatusUIHandler&&this._saveStatusUIHandler.Initialize(e.getBooleanAppSetting("IsSkyDrive"),e.getStringAppSetting("HostNameToIncludeInSavedStatus")))))},e.prototype.dispose=function(){this._saveStatusUIHandler&&this._saveStatusUIHandler.UnregisterHandlers()},e}();(0,o.l)(Xi,"db3bfc1b$PackageManager",null,[s.u,u.s]);var Yi=function(){function e(){}return e.main=function(){B.o.get_instance().registerPackage(new Xi)},e}();(0,o.l)(Yi,"55945b26$Program",null,[]);var Zi=n(3470),er=function(){function e(){}return e.prototype.get_name=function(){return"Common.App.EventsCachePackage"},e.prototype.configure=function(e){},e.prototype.init=function(){Zi.a.get_instance().init()},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(er,"55eb16ee$EventsCachePackage",null,[s.u,u.s]);var tr=n(9742),nr=n(3119),ir=n(2658),rr=(0,o.y)("737543a7$IPresenceContextMenuSectionBuilder"),or=n(6760),ar=n(1854),lr=n(8223),sr=(0,o.y)("c06bacc6$IControlBehaviorFactory"),ur=(0,o.y)("2ff7de32$IControlBehavior"),cr=n(1509),dr=n(3038),gr=n(1468),pr=n(4676),hr=n(9134),_r=n(3239),mr=n(4483),fr=n(8730),yr=function(){function e(e){this.control=null,this._isCommitChangeFixEnabled=!1,this._activeElement=null,this._activeElementBounds=null,this._activeElementHovered=!1,this.control=e}return e.prototype.get_control=function(){return this.control},e.prototype.get_stateProperties=function(){return this.get_control().get_stateProperties()},e.prototype.get_root=function(){return this.get_control().get_root()},e.prototype.get_parentMenu=function(){return this.get_control().get_parentMenu()},e.prototype.get_ActivatesOnPress=function(){return this.get_control().get_activatesOnPress()},e.prototype.get_displayedComponent=function(){return this.get_control().get_displayedComponent()},e.prototype.get_controlComponentDomCache=function(){return this.get_control().get_controlComponentDomCache()},e.prototype.attachEvents=function(e){},e.prototype.initialize=function(){},e.prototype.doDefaultAction=function(e,t,n){this.get_control().doDefaultActionPublic(e,t,n)},e.prototype.pollForStateAndUpdate=function(){_r.n.isNullOrUndefined(this.get_control().get_controlProperties().Command)||this.pollForStateAndUpdateInternal(this.get_control().get_controlProperties().Command,null,null)},e.prototype.pollForStateAndUpdateInternal=function(e,t,n){var i=0;return this.get_root()&&(i=this.get_root().pollForCommandState(e,t,n)),this.get_control().set_enabled((1&i)>0),i},e.prototype.updateVisibility=function(){var e=this.get_control().get_visible();return this.get_root().get_supportsInvisibleControls()&&(e=this.get_stateProperties()[mr.b.visible])!==this.get_control().get_visible()&&(this.get_control().set_visible(e),this.get_root().needRefresh=!0),e},e.prototype.updateLabelText=function(){var e=fr.n.validateStringProperty(this.get_stateProperties()[mr.b.labelText],this.get_control().get_controlProperties().LabelText);this.setLabelText(e)},e.prototype.setLabelText=function(e){this.get_control().labelText!==e&&(this.get_controlComponentDomCache().forEach((function(t){t.setLabelText(e)})),this.get_control().labelText=e,this.get_root().needScaling=!0)},e.prototype.updateTooltip=function(){var e=fr.n.validateStringProperty(this.get_stateProperties()[mr.b.alt],this.get_control().get_controlProperties().Alt);this.setTooltip(e)},e.prototype.setTooltip=function(e){this.get_control().tooltip!==e&&(this.get_controlComponentDomCache().forEach((function(t){t.setTooltip(e)})),this.get_control().tooltip=e)},e.prototype.updateImage=function(){var e=fr.n.validateStringProperty(this.get_stateProperties()[dr.f.Image16by16Class],this.get_control().get_controlProperties().Image16by16Class),t=fr.n.validateStringProperty(this.get_stateProperties()[dr.f.Image32by32Class],this.get_control().get_controlProperties().Image32by32Class),n=fr.n.validateStringProperty(this.get_stateProperties()[dr.f.Image48by48Class],this.get_control().get_controlProperties().Image48by48Class),i=_r.n.isNullOrEmptyString(n)?t:n;this.ApplyImageCssClass(this.get_controlComponentDomCache().get_small(),e),this.ApplyImageCssClass(this.get_controlComponentDomCache().get_medium(),e),this.ApplyImageCssClass(this.get_controlComponentDomCache().get_large(),t),this.ApplyImageCssClass(this.get_controlComponentDomCache().get_smallMenu(),e),this.ApplyImageCssClass(this.get_controlComponentDomCache().get_largeMenu(),i)},e.prototype.ApplyImageCssClass=function(e,t){e&&(_r.n.isNullOrUndefined(e.elmImage)||_r.n.isNullOrUndefined(t)||e.elmImage.className===t||(e.elmImage.className=t))},e.prototype.updateDisplayMode=function(e){if(!_r.n.isNullOrEmptyString(e)&&this.get_root().get_supportsDynamicDisplayMode()){for(var t=0,n=this.get_control().get_components();t<n.length;t++){var i=n[t],r=i.get_displayMode()===e;r&&(!0,this.get_control().set_activeComponentWhenVisible(i)),this.get_control().get_visible()&&i.set_visibleInDOM(r)}this.get_control().get_visible()&&(this.get_root().needScaling=!0)}},e.prototype.adjustLayoutForLargeMenu=function(){if(this.get_controlComponentDomCache().get_largeMenu()&&this.get_controlComponentDomCache().get_largeMenu().elmLabel&&this.get_controlComponentDomCache().get_largeMenu().elmDescription){var e=this.get_controlComponentDomCache().get_largeMenu().elmLabel,t=fr.n.validateStringProperty(this.get_stateProperties()[gr.e.Description],this.get_control().get_controlProperties().Description);_r.n.isNullOrEmptyString(t)&&(e.style.position="relative",e.style.top=(e.parentNode.offsetHeight-e.offsetHeight)/2+"px",e.style.padding="0px")}},e.prototype.OnFocus=function(e){var t=this.get_displayedComponent();return o.r(pr.m,t)?this.get_parentMenu().updateFocusedIndex(t):this.get_root().set_controlWithFocus(this.get_control()),!1},e.prototype.OnBlur=function(e){var t=this.get_displayedComponent();return this.get_control().isStandardMenuItem()&&fr.n.removeCSSClassFromElement(t.get_elementInternal(),"cui-ctl-menu-hovered-without-focus"),this.get_root().set_controlWithFocus(null),!1},e.prototype.OnPointerOver=function(e){if(this.get_control().isStandardMenuItem()){var t=this.get_parentMenu().get_stackIndex(),n=t===this.get_root().get_menuStackDepth()-1,i=n?null:this.get_root().get_menuLauncherStack()[t+1];this.closeChildMenus(!1),n||this.get_control()===i||fr.n.removeCSSClassFromElement(i.get_launcher(),hr.MenuLauncher.menuDroppedClassName),this.get_control().get_enabled()&&this.get_control().get_focusableElement()?n?this.get_control().setFocusOnControl():(fr.n.ensureCSSClassOnElement(this.get_displayedComponent().get_elementInternal(),"cui-ctl-menu-hovered-without-focus"),i.set_elmHadFocus(this.get_control().get_focusableElement())):n?this.get_parentMenu().setFocus(e.get_inputSource()):(i.set_elmHadFocus(this.get_parentMenu().get_elementInternal()),this.get_parentMenu().resetFocusedIndex())}return!1},e.prototype.OnPointerOut=function(e){return this.get_control().isStandardMenuItem()&&fr.n.removeCSSClassFromElement(this.get_displayedComponent().get_elementInternal(),"cui-ctl-menu-hovered-without-focus"),!1},e.prototype.onKeyDown=function(e){var t=!1;if(!_r.n.isNullOrUndefined(e.innerEvent)&&!_r.n.isNullOrUndefined(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,i=e.innerEvent.keyCode,r=n.shiftKey;if(i===Sys.UI.Key.enter&&(t=!0),o.r(pr.m,this.get_displayedComponent())){var a=this.get_parentMenu();if(!_r.n.isNullOrUndefined(a)){var l=a.get_stackIndex(),s=!this.get_root().get_textDirection(),u=!_r.n.isNullOrUndefined(this.get_control().get_parentGrid());if(i!==Sys.UI.Key.tab&&i!==Sys.UI.Key.left&&i!==Sys.UI.Key.right&&i!==Sys.UI.Key.up&&i!==Sys.UI.Key.down&&i!==Sys.UI.Key.esc)return t;bt.g.clearSelectionIfNecessary(),i!==Sys.UI.Key.tab||r?i===Sys.UI.Key.tab&&r?(a.focusNext(1),t=!0):i===Sys.UI.Key.left&&s||i===Sys.UI.Key.right&&!s?(u?a.focusNext(2):l>0&&this.get_root().closeMenuStackAtIndex(l,!0,!1),t=!0):i===Sys.UI.Key.right&&s||i===Sys.UI.Key.left&&!s?(u&&a.focusNext(4),t=!0):i===Sys.UI.Key.up?(a.focusNext(5),t=!0):i===Sys.UI.Key.down?(a.focusNext(6),t=!0):i===Sys.UI.Key.esc&&(this.get_root().closeMenuStackAtIndex(l,!0,!1),t=!0):(a.focusNext(0),t=!0)}}}return t},e.prototype.onKeyUp=function(e){var t=!1;if(!_r.n.isNullOrUndefined(e.innerEvent)&&!_r.n.isNullOrUndefined(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,i=e.innerEvent.keyCode;n.shiftKey;Me.KeyInputManager.hasKeyModifiers(e)||i!==Sys.UI.Key.enter&&i!==Sys.UI.Key.space||(t=this.handleDefaultActionWithKeytips(e))||(this.doDefaultAction(e.get_sourceElement(),1,e.innerEvent),t=!0)}return t},e.prototype.onPointerDown=function(e){if(this.commitRootPendingChanges(),this.get_ActivatesOnPress()){var t=!0;2===e.get_inputSource()&&(t=!e.get_mouseButton()),t&&this.get_displayedComponent()&&this.ActivateElement(this.get_displayedComponent().get_elementInternal())}return(e.innerEvent.type.toLowerCase()!==me.d.touchStart||this.get_ActivatesOnPress())&&e.innerEvent.preventDefault(),!1},e.prototype.get_isCommitChangeFixEnabled=function(){return this._isCommitChangeFixEnabled},e.prototype.enableCommitChangeFix=function(){this._isCommitChangeFixEnabled=!0},e.prototype.commitRootPendingChanges=function(){this.get_isCommitChangeFixEnabled()&&this.get_control().get_root().commitAnyPendingChange()},e.prototype.OnPointerUp=function(e){var t=!1;return!o.r(pr.m,this.get_displayedComponent())||this.get_ActivatesOnPress()||2!==e.get_inputSource()||e.get_mouseButton()?t=this.get_control().deactivateElement(e):(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),t=!0),t},e.prototype.OnClick=function(e){var t=!1;return o.r(pr.m,this.get_displayedComponent())&&!this.get_ActivatesOnPress()&&3===e.get_inputSource()&&(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),t=!0),!W.y.get_isIPad()&&t},e.prototype.OnTouchMove=function(e){return this.OnActivePointerMove(e)},e.prototype.OnTouchEnd=function(e){return this.deactivateElement(e),!1},e.prototype.OnActivePointerMove=function(e){if(!_r.n.isNullOrUndefined(this._activeElement)){var t=bt.g.isPointInBounds(this.get_activeElementBounds(),e.get_clientPoint());return this.setActiveElementHovered(t),!0}return!1},e.prototype.onModalBodyPointerDown=function(e){var t=!1;return this.deactivateElement(e)&&(t=!0),3!==e.get_inputSource()&&(this.get_root().closeAllMenus(),t=!0),t},e.prototype.onModalBodyPointerUp=function(e){return this.deactivateElement(e)},e.prototype.onModalBodyPointerMove=function(e){return this.OnActivePointerMove(e)},e.prototype.onModalBodyPointerOut=function(e){return this.deactivateElement(e)},e.prototype.onModalBodyClick=function(e){return 3===e.get_inputSource()&&(this.get_root().closeAllMenus(),!0)},e.prototype.onModalBodyMouseWheel=function(e){return!1},e.prototype.get_activeElementBounds=function(){return!_r.n.isNullOrUndefined(this._activeElement)&&_r.n.isNullOrUndefined(this._activeElementBounds)&&(this._activeElementBounds=bt.g.getElementBounds(this._activeElement)),this._activeElementBounds},e.prototype.setActiveElementHovered=function(e){this._activeElementHovered!==e&&(this._activeElementHovered=e,this.ActiveElementStateChanged(this._activeElementHovered))},e.prototype.ActiveElementStateChanged=function(e){_r.n.isNullOrUndefined(this._activeElement)||fr.n.toggleCSSClassOnElement(this._activeElement,cr.Control.activeClassName,e)},e.prototype.ActivateElement=function(e){this.get_control().get_enabled()&&(this._activeElement=e,this.get_root().set_activeControl(this.get_control()),this.setActiveElementHovered(!0),this.get_root().beginModal(this.get_control(),!1))},e.prototype.deactivateElement=function(e){if(!_r.n.isNullOrUndefined(this._activeElement)){if(this.setActiveElementHovered(!1),this.get_root()&&this.get_root().endModal(this.get_control(),!1),!_r.n.isNullOrUndefined(e)){var t=e.get_clientPoint();bt.g.isPointInBounds(this.get_activeElementBounds(),t)&&this.doDefaultAction(this._activeElement,e.get_inputSource(),e.innerEvent)}return this.get_root()&&this.get_root().set_activeControl(null),this._activeElement=null,this._activeElementBounds=null,!0}return!1},e.prototype.focusNext=function(e){var t=this.get_displayedComponent();return!(!o.r(pr.m,t)||2===e||4===e||bt.g.isActiveElement(this.get_control().get_focusableElement()))&&this.setFocusOnControl()},e.prototype.setFocusOnControl=function(){try{if(this.get_control().get_visible()){var e=this.get_control().get_focusableElement();if(!_r.n.isNullOrUndefined(e))return e.focus(),!0}}catch(e){}return!1},e.prototype.closeChildMenus=function(e){var t=this.get_parentMenu();_r.n.isNullOrUndefined(t)||this.get_root().closeMenuStackAtIndex(t.get_stackIndex()+1,e)},e.prototype.onMenuClosed=function(){},e.prototype.handleDefaultActionWithKeytips=function(e){return!1},e.prototype.getTelemetryData=function(t){var n=null;return t&&t.rawEvent&&((n={})[e.triggerTime]=t.rawEvent.timeStamp),n},e.triggerTime="TriggerTime",e}();(0,o.l)(yr,"52830a6a$ControlBehavior",null,[ur]);var Cr=function(e){function t(t){return e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.get_Button=function(){return this.get_control()},t.prototype.get_Properties=function(){return this.get_control().get_controlProperties()},t.prototype.attachEvents=function(e){var t=e.elmControl,n=e.get_displayMode();_r.n.isNullOrUndefined(t)||(Ie.z.get_instance().registerHandler(me.d.focus,t,o.i(this,this.OnFocus,"OnFocus")),Ie.z.get_instance().registerHandler(me.d.blur,t,o.i(this,this.OnBlur,"OnBlur")),lr.z.get_instance().registerHandler(me.d.pointerOver,t,o.i(this,this.OnPointerOver,"OnPointerOver")),lr.z.get_instance().registerHandler(me.d.pointerOut,t,o.i(this,this.OnPointerOut,"OnPointerOut")),Me.KeyInputManager.get_instance().registerHandlerWithData(me.d.keyDown,t,o.i(this,this.onKeyDown,"onKeyDown"),n),Me.KeyInputManager.get_instance().registerHandlerWithData(me.d.keyPress,t,o.i(this,this.OnKeyPress,"OnKeyPress"),n),Me.KeyInputManager.get_instance().registerHandlerWithData(me.d.keyUp,t,o.i(this,this.onKeyUp,"onKeyUp"),n),lr.z.get_instance().registerHandler(me.d.pointerDown,t,o.i(this,this.onPointerDown,"onPointerDown")),lr.z.get_instance().registerHandler(me.d.pointerUp,t,o.i(this,this.OnPointerUp,"OnPointerUp")),Xt.s.get_instance().registerHandler(me.d.click,t,o.i(this,this.OnClick,"OnClick")),Yt.v.get_instance().registerHandler(me.d.touchMove,t,o.i(this,this.OnTouchMove,"OnTouchMove")),Yt.v.get_instance().registerHandler(me.d.touchEnd,t,o.i(this,this.OnTouchEnd,"OnTouchEnd")))},t.prototype.doDefaultAction=function(e,t,n){if(this.get_control().get_enabled()){var i=null;if(this.get_displayedComponent()&&this.get_displayedComponent().isMenuItem()&&this.get_parentMenu()){var r=this.get_parentMenu().get_stackIndex();(i=this.get_root().get_menuLauncherStack()[r])&&!this.get_isCommitChangeFixEnabled()&&(i.selectDropdownItem(this.get_Button()),i=null)}this.ExecuteCommand(this.get_control().get_controlProperties().Command,t,!0,n),i&&i.selectDropdownItem(this.get_Button())}},t.prototype.ExecuteCommand=function(e,t,n,i){if(!_r.n.isNullOrUndefined(e)){var r=this.get_stateProperties();r.CommandValueId=this.get_Button().getCommandValueId(),r.MenuItemId=this.get_Button().getMenuItemId(),r.SourceControlId=this.get_control().get_id(),this.get_root().executeCommand(e,r,this.get_displayedComponent(),t,n,null,this.getTelemetryData(i))}},t.prototype.pollForStateAndUpdate=function(){_r.n.isNullOrUndefined(this.get_control().get_controlProperties().Command)||(2&this.pollForStateAndUpdateInternal(this.get_Properties().Command,this.get_Properties().QueryCommand,this.get_stateProperties()))>0&&this.updateVisibility()&&this.UpdateHtml()},t.prototype.UpdateHtml=function(){this.updateLabelText(),this.updateTooltip(),this.updateImage()},t.prototype.OnFocus=function(t){return e.prototype.OnFocus.call(this,t),this.StartLivePreview(),!1},t.prototype.OnBlur=function(t){return e.prototype.OnBlur.call(this,t),this.EndLivePreview(),!1},t.prototype.onKeyDown=function(t){var n=e.prototype.onKeyDown.call(this,t);if(!_r.n.isNullOrUndefined(t.innerEvent)){var i=t.userData,r=t.innerEvent.keyCode;this.ShouldDoDefaultActionOnKeyPress(i,r)&&(n=!1)}return n},t.prototype.OnKeyPress=function(e){var t=!1;if(!_r.n.isNullOrUndefined(e.innerEvent)&&!_r.n.isNullOrUndefined(e.innerEvent.rawEvent)){var n=e.userData,i=e.innerEvent.rawEvent.keyCode;this.ShouldDoDefaultActionOnKeyPress(n,i)?(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),t=!0):e.innerEvent.preventDefault()}return t},t.prototype.ShouldDoDefaultActionOnKeyPress=function(e,t){if(W.y.get_isInternetExplorerNonEdge()&&t===Sys.UI.Key.enter)switch(e){case"MenuMru":case"MenuTemplate":case"MenuHeader":case"MenuFooter":return!0}return!1},t.prototype.onKeyUp=function(t){var n=!1;if(!_r.n.isNullOrUndefined(t.innerEvent)){var i=t.userData,r=t.innerEvent.keyCode;this.ShouldDoDefaultActionOnKeyPress(i,r)||(n=e.prototype.onKeyUp.call(this,t))}return n},t.prototype.StartLivePreview=function(){this.get_control().get_enabled()&&this.ExecuteCommand(this.get_Properties().CommandPreview,0,!1,null)},t.prototype.EndLivePreview=function(){this.get_control().get_enabled()&&this.ExecuteCommand(this.get_Properties().CommandRevert,0,!1,null)},t}(yr);(0,o.l)(Cr,"1ebdc6db$ButtonBehavior",yr,[]);var Sr=n(7476),br=function(){function e(){}return e.Color="Color",e.IndexColorSelected="ColorSelected",e}();(0,o.l)(br,"64ee9676$ColorPickerCommandProperties",null,[]);var vr=function(e){function t(t){var n=e.call(this,t)||this;return n._focusedIndex=-1,n._selectedIndex=-1,n}return(0,v.t)(t,e),t.prototype.get_ColorPicker=function(){return this.get_control()},t.prototype.get_ColorCells=function(){return this.get_ColorPicker().get_colorPickerDom().colorCells},t.prototype.get_Properties=function(){return this.get_ColorPicker().get_controlProperties()},t.prototype.doDefaultAction=function(e,n,i){if(this.get_control().get_enabled()){var r=t.GetNearestContainingParentElementOfType(e,"td"),o=this.get_stateProperties();o.Color=r[Sr.ColorPicker.colorInformation];var a=null;if(fr.n.isTrue(this.get_Properties().Stateful)&&this.get_displayedComponent()&&this.get_displayedComponent().isMenuItem()&&this.get_parentMenu()){var l=this.get_parentMenu().get_stackIndex();a=this.get_root().get_menuLauncherStack()[l]}this.get_root().executeCommand(this.get_Properties().Command,o,this.get_displayedComponent(),n,!0,null,this.getTelemetryData(i)),a&&a.selectDropdownItem(this.get_ColorPicker())}},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties();if(e.SourceControlId=this.get_Properties().Id,(2&this.pollForStateAndUpdateInternal(this.get_Properties().Command,this.get_Properties().QueryCommand,e))>0){var t=-1;if(br.IndexColorSelected in this.get_stateProperties()&&(t=this.get_stateProperties()[br.IndexColorSelected]),t!==this._selectedIndex){var n=this.get_ColorCells();0<=t&&t<n.length&&this.UpdateCellSelection(n[t],!0),0<=this._selectedIndex&&this._selectedIndex<n.length&&this.UpdateCellSelection(n[this._selectedIndex],!1),this._selectedIndex=t}}},t.prototype.UpdateCellSelection=function(e,n){n?fr.n.ensureCSSClassOnElement(e,t.SelectedCellClassName):fr.n.removeCSSClassFromElement(e,t.SelectedCellClassName)},t.prototype.attachEvents=function(e){for(var t=e,n=0;n<t.aTags.length;++n){var i=t.aTags[n];Ie.z.get_instance().registerHandler(me.d.focus,i,o.i(this,this.OnCellFocus,"OnCellFocus")),Ie.z.get_instance().registerHandler(me.d.blur,i,o.i(this,this.OnCellBlur,"OnCellBlur")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyDown,i,o.i(this,this.onKeyDown,"onKeyDown")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyUp,i,o.i(this,this.onKeyUp,"onKeyUp")),Xt.s.get_instance().registerHandler(me.d.click,i,o.i(this,this.OnCellClick,"OnCellClick")),lr.z.get_instance().registerHandler(me.d.pointerUp,i,o.i(this,this.OnCellPointerUp,"OnCellPointerUp")),lr.z.get_instance().registerHandler(me.d.pointerOver,i,o.i(this,this.OnCellPointerOver,"OnCellPointerOver")),lr.z.get_instance().registerHandler(me.d.pointerDown,i,o.i(this,this.OnCellPointerDown,"OnCellPointerDown"))}},t.prototype.OnCellFocus=function(e){var n=t.GetNearestContainingParentElementOfType(e.get_sourceElement(),"td");return this.get_parentMenu().updateFocusedIndex(this.get_displayedComponent()),this.UpdateCellFocus(n,!0),!0},t.prototype.OnCellBlur=function(e){var n=t.GetNearestContainingParentElementOfType(e.get_sourceElement(),"td");return this.UpdateCellFocus(n,!1),!0},t.prototype.UpdateCellFocus=function(e,n){n?(this._focusedIndex=parseInt(e.getAttribute("arrayPosition")),fr.n.ensureCSSClassOnElement(e,t.HoverCellClassName),this.StartLivePreview(e)):(this._focusedIndex=-1,this.EndLivePreview(e),fr.n.removeCSSClassFromElement(e,t.HoverCellClassName))},t.prototype.OnCellClick=function(e){return 3===e.get_inputSource()&&this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),!0},t.prototype.OnCellPointerUp=function(e){return 3!==e.get_inputSource()&&this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),!0},t.prototype.OnCellPointerOver=function(e){this.closeChildMenus(!1);var n=t.GetNearestContainingParentElementOfType(e.get_sourceElement(),"td"),i=parseInt(n.getAttribute("arrayPosition"));return this.SetFocusOnCell(i),!0},t.prototype.OnCellPointerDown=function(e){return!1},t.prototype.StartLivePreview=function(e){if(this.get_control().get_enabled()){var t=this.get_Properties().CommandPreview;if(!_r.n.isNullOrEmptyString(t)){var n=this.get_stateProperties();n.Color=e[Sr.ColorPicker.colorInformation],this.get_root().executeCommand(t,n,this.get_displayedComponent(),0,!1)}}},t.prototype.EndLivePreview=function(e){if(this.get_control().get_enabled()){var t=this.get_Properties().CommandRevert;if(!_r.n.isNullOrEmptyString(t)){var n=this.get_stateProperties();n.Color=e[Sr.ColorPicker.colorInformation],this.get_root().executeCommand(t,n,this.get_displayedComponent(),0,!1)}}},t.prototype.focusNext=function(e){var t=cr.Control.focusNextIndexInGrid(this._focusedIndex,this.get_ColorPicker().get_width(),this.get_ColorCells().length,e);return!(t===this._focusedIndex||!this.SetFocusOnCell(t))||(this.UpdateCellFocus(this.get_ColorCells()[this._focusedIndex],!1),!1)},t.prototype.setFocusOnControl=function(){return this.SetFocusOnCell(0)},t.prototype.SetFocusOnCell=function(e){if(this.get_ColorCells()&&this.get_ColorCells().length>e){var t=this.get_ColorCells()[e];if(t.firstChild)return t.firstChild.focus(),!0}return!1},t.prototype.onMenuClosed=function(){-1!==this._focusedIndex&&this.UpdateCellFocus(this.get_ColorCells()[this._focusedIndex],!1)},t.GetNearestContainingParentElementOfType=function(e,n){return t.GetNearestContainingParentElementOfTypes(e,[n])},t.GetNearestContainingParentElementOfTypes=function(e,t){var n=t.length;if(!e)return null;for(var i=0;i<n;i++)if(e.tagName.toLowerCase()===t[i].toLowerCase())return e;for(var r=e.parentNode;r;){for(i=0;i<n;i++)if(r.tagName.toLowerCase()===t[i].toLowerCase())return r;r=r.parentNode}return null},t.HoverCellClassName="cui-colorpicker-hoveredOver",t.SelectedCellClassName="cui-colorpicker-selected",t}(yr);(0,o.l)(vr,"ac961056$ColorPickerBehavior",yr,[]);var Tr=n(3552),Ar=n(8638),Ir=n(5762),wr=(0,o.y)("700768cc$IMenuLauncherBehavior"),xr=n(1838),Er=n(2369),Fr=n(3825),Pr=n(6104),Dr=n(1549),Rr=n(7877),Mr=n(5467),kr=n(1242),Nr=function(){function e(e,t){this._textDirectionLtr=!1,this._isAppDivSyndicated=!1,this._textDirectionLtr=e,this._isAppDivSyndicated=t}return e.prototype.setFlyoutCoordinates=function(t,n,i,r){if(_r.n.isNullOrUndefined(t)||_r.n.isNullOrUndefined(n))return null;var o,a,l=new kr.w,s=r.x,u=r.y,c=r.width,d=r.height,p=e.DictToInt(n,"flyoutWidth"),h=e.DictToInt(n,"flyoutRealHeight"),_=e.DictToInt(n,"viewportWidth"),m=e.DictToInt(n,"viewportHeight"),f=e.DictToInt(n,"viewableLeft"),y=e.DictToInt(n,"viewableTop"),C=this._textDirectionLtr,S=!1,b=!1,v=1===i,T=4===i,A=this._isAppDivSyndicated;if(t.style.maxHeight="none",t.style.top="0px",t.style.overflowY="visible",t.style.width="auto",p=this.measureWidth(t),l.viewPortHeight=m,l.viewPortWidth=_,v)C?o=s+c:(o=s-p,l.launchedLeft=!0),a=u;else{var I="";c>p&&(I=((p=c)-2*Mr.Menu.menuBorderPx).toString()),C?o=s:(o=s+c-p,l.launchedLeft=!0),a=u+d,""!==I&&(t.style.minWidth=I+"px")}A&&(a+=y,o+=f),t.style.top=a+"px",t.style.left=o+"px";var w=!1,x=!1;p<=_?o+p>f+_?(v&&C&&s-p>f||T&&s-p>f?(o=s-p,A&&(o+=f),l.launchedLeft=!0,x=!0):(o=f+_-p,S=!0),w=!0):o<f&&(v&&!C&&s+c+p<f+_?(o=s+c,A&&(o+=f),l.launchedLeft=!1,x=!0):(o=f,b=!0,l.launchedLeft=!0),w=!0):C?(o=f,w=!0,l.launchedLeft=!0):(o=f+_-p,w=!0,l.launchedLeft=!1),w&&(t.style.left=o+"px");var E,F,P,D,R=a+h<=y+m;(l.flyoutTop=a,R&&3!==i)||(l.launchedUp=!0,this.FitFlyoutVertically(i,a,h,u,y,m,(0,g.m)((function(){return E}),(function(e){return E=e})),(0,g.m)((function(){return F}),(function(e){return F=e})),(0,g.m)((function(){return P}),(function(e){return P=e})),(0,g.m)((function(){return D}),(function(e){return D=e}))),a!==E&&(t.style.top=E+"px",l.flyoutTop=E),F>-1&&(t.style.maxHeight=F+"px"),P&&(t.style.bottom="0px",t.style.height="auto"),D&&this.MakeFlyoutScrollable(t,C,v,x,b,S,_,s,c));return l.flyoutLeft=o,l.flyoutWidth=p,l.flyoutHeight=h,l},e.prototype.FitFlyoutVertically=function(e,t,n,i,r,o,a,l,s,u){a.val=t,l.val=-1,s.val=!1,u.val=!1;var c=t,d=r+o-t;t=i-n;var g=this._isAppDivSyndicated,p=!1;t<0&&(t=r);var h=i;(g||(h-=r),n<=h&&1!==e)||(4===e||1===e?n<o?(t=o-n,s.val=!0):(t=r,s.val=!0,u.val=!0,p=!0):(h<d&&3!==e?(t=c,s.val=!0):l.val=h,u.val=!0));g&&(s.val=!1,p?l.val=o:t+=r),a.val=t},e.prototype.MakeFlyoutScrollable=function(e,t,n,i,r,o,a,l,s){if(e.style.overflowY="scroll",e.style.width="auto",t){if(o||i){var u=o?0:a-l;e.style.left="",e.style.right=u+"px"}}else if(!r&&!i){u=n?a-l:a-l-s;e.style.left="",e.style.right=u+"px"}},e.prototype.GetDimensionsForMenu=function(e){var t={};if(_r.n.isNullOrUndefined(e))return t;t.viewportWidth=ji.s.getViewPortWidth(),t.viewportHeight=ji.s.getViewPortHeight(),_r.n.isNullOrUndefined(t.viewportWidth)&&(t.viewportWidth=document.documentElement.clientWidth,t.viewportHeight=document.documentElement.clientHeight),_r.n.isNullOrUndefined(t.viewportWidth)&&(t.viewportWidth=document.body.clientWidth,t.viewportHeight=document.body.clientHeight),t.viewableTop=window.pageYOffset,t.viewableLeft=window.pageXOffset,_r.n.isNullOrUndefined(t.viewableTop)&&(t.viewableTop=document.documentElement.scrollTop,t.viewableLeft=document.documentElement.scrollLeft),_r.n.isNullOrUndefined(t.viewableTop)&&(t.viewableTop=document.body.scrollTop,t.viewableLeft=document.body.scrollLeft),e.scrollHeight!==e.offsetHeight?t.flyoutRealHeight=e.scrollHeight+2*Mr.Menu.menuBorderPx:t.flyoutRealHeight=e.scrollHeight;var n=e.style.overflowY;return e.style.overflowY="visible",t.flyoutWidth=this.measureWidth(e),e.style.overflowY=n,t},e.prototype.measureWidth=function(e){return e.offsetWidth},e.DictToInt=function(e,t){return _r.n.isNullOrUndefined(e)?0:e[t]},e}();(0,o.l)(Nr,"855de718$MenuPositioner",null,[]);var Lr=n(7801),Br=n(6558),Or=n(5080),Ur=n(8475),Hr=n(1932),Gr=n(9257),Wr=n(188),Vr=n(7045),$r=n(7143),zr=function(e){function t(t){var n=e.call(this,t)||this;return n.menuPositioner=null,n._menuInvocationMethod=0,n._lastDynamicPopulationXml=null,n._elmBackFrame=null,n._hasAsyncCallbackBeenSentToHandler=!1,n.polledOnce=!1,n._pendingBackFrameTimeoutId=-1,n.menuPositioner=new Nr(!n.get_root().get_textDirection(),fr.n.isTrue(n.get_root().get_properties().DivSyndicated)),n}return(0,v.t)(t,e),t.prototype.get_menuPositioner=function(){return this.menuPositioner},t.prototype.get_menuLauncher=function(){return this.get_control()},t.prototype.get_Properties=function(){return this.get_control().get_controlProperties()},t.prototype.get_menu=function(){return this.get_menuLauncher().get_menu()},t.prototype.set_menu=function(e){return this.get_menuLauncher().set_menu(e),e},t.prototype.get_menuLaunched=function(){return this.get_menuLauncher().menuLaunched},t.prototype.set_menuLaunched=function(e){return this.get_menuLauncher().menuLaunched=e,e},t.prototype.get_BackFrame=function(){return _r.n.isNullOrUndefined(this._elmBackFrame)&&(this._elmBackFrame=t.CreateHiddenIframeElement()),this._elmBackFrame},t.prototype.get_ShouldRestoreFocusToApp=function(){var e=!this.get_root().get_inModalMode();return o.r(Ir.u,this.get_root())&&1===this.get_root().get_menuStackDepth()&&(e=!0),e},t.prototype.doDefaultAction=function(e,t,n){o.r(Ir.u,this.get_root())&&this.get_root().ensureContextMenuDismissed(),this.get_menuLauncher().launchMenu(t)},t.prototype.launchMenu=function(e){if(this.get_menuLauncher().get_enabled()&&!this.get_menuLaunched()){var t=xr.y.get_instance().startActivity(Fe.b.launchMenu);t.get_properties().add("Id",this.get_menuLauncher().get_controlProperties().Id),t.get_properties().add("InputMethod",Fr.s[e]),t.end(),Dr.t.mark(10326),bt.g.measureTimeToNextFrame(this.get_menuLauncher().get_controlProperties().Id,"MenuOpen"),this.get_menuLauncher().get_focusableElement()&&this.get_menuLauncher().set_elmHadFocus(bt.g.getActiveElement(this.get_menuLauncher().get_focusableElement().ownerDocument)),this._menuInvocationMethod=e,this.PopulateAndPositionMenu(e),this.sendNotifyAsyncMenuTrigger(),this.get_menuLauncher().updateAriaMenuLauncherAttributes(this.get_menuLauncher().get_focusableElement(),!0)}},t.prototype.sendNotifyAsyncMenuTrigger=function(){_r.n.isNullOrUndefined(this.get_Properties().PopulateAsyncTriggerCommand)||this._hasAsyncCallbackBeenSentToHandler||(this.NotifyAsyncMenuTrigger(),this._hasAsyncCallbackBeenSentToHandler=!0)},t.prototype.NotifyAsyncMenuTrigger=function(){var e={};e[Pr.o.Callback]=o.i(this,this.refreshMenuCallback,"refreshMenuCallback"),this.get_root().executeCommand(this.get_Properties().PopulateAsyncTriggerCommand,e,this.get_displayedComponent(),0,!1)},t.prototype.refreshMenuCallback=function(){this.get_menuLauncher().refreshMenu()},t.prototype.refreshMenu=function(){this.get_menuLaunched()&&this.PopulateAndPositionMenu(this._menuInvocationMethod,!0)},t.prototype.PopulateAndPositionMenu=function(e,t){void 0===t&&(t=!1);var n=!0;if(fr.n.isTrue(this.get_Properties().PopulateDynamically)){var i=!1,r=this.pollForDynamicMenu(e);r!==this._lastDynamicPopulationXml&&(i=this.populateMenuFromXml(r,t)),n=i||!this.get_menuLaunched()}if(n){var o=L.AFrameworkApplication.get_activeFrame().get_theStopwatchBuilder(),a=null;o&&(a=o.makeAndStartStopwatch("LoadResource","Menu Initialization")),this.InitializeMenu(e),a&&a.stop(),this.onMenuChanged()}},t.prototype.InitializeMenu=function(e){if(_r.n.isNullOrUndefined(this.get_menu()))Dr.t.mark(10327);else{if(this.get_menuLauncher().parentKeytipsIds){var t=this.get_menuLauncher().get_displayedComponent();if(t&&t.get_keytip()){var n=t.get_keytip().get_key().toLocaleLowerCase();this.get_menu().setParentKeytipsIdsForMenuItems(String.format("{0} {1}",this.get_menuLauncher().parentKeytipsIds,t.get_keytip().get_elementId()),this.get_menuLauncher().parentKeytipsKeys&&""!==this.get_menuLauncher().parentKeytipsKeys?String.format("{0}-{1}",this.get_menuLauncher().parentKeytipsKeys,n):n)}}this.get_menu().ensureRefreshed(),fr.n.ensureCSSClassOnElement(this.get_menu().get_elementInternal(),this.get_menuLauncher().get_additionalMenuCssClass());var i=3===e||this.get_root().get_touchModeForcedOn();if(fr.n.toggleCSSClassOnElement(this.get_menu().get_elementInternal(),"cui-touch",i),this.get_menu().hasItems()){this.get_menu().attachEvents();var r=this.get_displayedComponent();r.ensureChildren(),r.set_ignoreDirtyingEvents(!0),r.addChild(this.get_menu()),r.set_ignoreDirtyingEvents(!1),this.get_menu().pollIfRootPolledSinceLastPoll();var a=o.r($r.b,this.get_root()),l=null,s=!1;a&&(s=(l=this.get_root()).shouldHandleElementResize,l.shouldHandleElementResize=!1);var u=this.get_menu().get_elementInternal();u.style.visibility="hidden",u.style.position="absolute",u.style.top="0px",u.style.left="0px",W.y.get_isInternetExplorerNonEdge()&&!W.y.get_isInternetExplorer9Up()&&(u.style.maxHeight="100px",u.style.overflowY="scroll"),document.body.appendChild(u),this.AdjustMenuLayout(),this.PositionMenu(u),Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.AddAndPositionBackFrame(),fr.n.ensureCSSClassOnElement(this.get_menuLauncher().get_launcher(),hr.MenuLauncher.menuDroppedClassName);var c=this.get_root().get_menuStackDepth();this.get_ShouldGoModal()&&this.get_root().beginModal(this.get_control(),!0),u.style.zIndex=String(L.AFrameworkApplication.get_activeFrame().get_activeModalUIZIndex()),this.get_root().addMenuLauncherToStack(this.get_menuLauncher()),this.get_menu().set_stackIndex(c),u.style.visibility="visible";var d=this.GetChildElementsToAnimate();if(o.r(Gr.m,this.get_menu())){u.style.position="fixed";var g=this.get_root().get_menuLauncherStack()[0];g&&g.get_menu()&&g.get_menu().get_elementInternal()?100!==bt.g.getOpacity(this.get_root().get_menuLauncherStack()[0].get_menu().get_elementInternal())&&Er.j.showMenu(u,d,o.i(this,this.AfterShowMenu,"AfterShowMenu")):Er.j.showMenu(u,d,o.i(this,this.AfterShowMenu,"AfterShowMenu"))}else Er.j.showMenu(u,d,o.i(this,this.AfterShowMenu,"AfterShowMenu"));this.set_menuLaunched(!0),this.get_menu().set_launched(!0),!W.y.get_isIPad()&&this.get_menuLauncher().get_sendFocusToMenuDrop()&&this.get_menu().setFocus(e),a&&(l.shouldHandleElementResize=s);var p=this.get_Properties().CommandMenuOpen;_r.n.isNullOrEmptyString(p)||this.get_root().executeCommand(p,null,r,e,!1),Dr.t.mark(10327)}else Dr.t.mark(10327)}},t.prototype.onMenuChanged=function(){},t.prototype.AddAndPositionBackFrame=function(){var e=this;fr.n.cancelPendingTimeout((0,g.m)((function(){return e._pendingBackFrameTimeoutId}),(function(t){return e._pendingBackFrameTimeoutId=t}))),this._pendingBackFrameTimeoutId=window.setTimeout(o.i(this,this.AddAndPositionBackFrameInternal,"AddAndPositionBackFrameInternal"),50)},t.prototype.AddAndPositionBackFrameInternal=function(){this.get_menu()&&this.get_menu().get_elementInternal()&&(document.body.appendChild(this.get_BackFrame()),this.PositionBackFrame())},t.prototype.PositionBackFrame=function(){var e=this.get_BackFrame(),t=this.get_menu().get_elementInternal();e.style.position="absolute",e.style.visibility="hidden",e.style.left=t.style.left,e.style.right=t.style.right,e.style.top=t.style.top,e.style.bottom=t.style.bottom;var n=t.offsetWidth,i=t.offsetHeight;W.y.get_isInternetExplorer9Up()&&(n-=4,i-=4),e.style.width=n.toString()+"px",e.style.height=i.toString()+"px",e.style.visibility="visible"},t.prototype.get_ShouldGoModal=function(){return!this.get_root().get_menuStackDepth()},t.prototype.AfterShowMenu=function(e){e.get_element()&&(e.get_element().style.filter="",e.get_element().style.opacity="",this.get_menu()&&this.get_menu().get_elementInternal()===e.get_element()&&o.r(Hr.y,this.get_menu())&&Er.j.animateJewelMenuContents(this.get_menu().get_elementInternal(),this.GetChildElementsToAnimate()))},t.prototype.GetChildElementsToAnimate=function(){var e=this.get_menu().get_children(),t=[];if(o.r(Hr.y,this.get_menu()))for(var n=0;n<e.get_count();n++){var i=e.get_item(n);Array.add(t,i.get_separator());for(var r=0;r<i.get_children().get_count();r++){var a=i.get_children().get_item(r);Array.add(t,a.get_elementInternal())}}return t},t.prototype.AdjustMenuLayout=function(){for(var e=this.get_menu().get_children(),t=0;t<e.get_count();t++)for(var n=e.get_item(t).get_children(),i=0;i<n.get_count();i++){var r=n.get_item(i);if(o.r(pr.m,r)){var a=r;if("Menu32"===a.get_displayMode()||"Menu48"===a.get_displayMode()){var l=r.get_control();l.behavior&&(o.r(Br.d,l)||o.r(Ur.g,l))&&l.behavior.adjustLayoutForLargeMenu()}}}if(e.get_count()>0){var s=e.get_item(0);_r.n.isNullOrUndefined(s.get_separator())||(s.get_separator().style.display="none"),_r.n.isNullOrUndefined(s.get_titleElement())||fr.n.ensureCSSClassOnElement(s.get_titleElement(),"cui-menusection-titleAtTop")}},t.prototype.PositionMenu=function(e){if(!_r.n.isNullOrUndefined(e)){e.style.top="0px",e.style.left="0px",e.style.bottom="",e.style.right="",e.style.width="",e.style.minWidth="";var t=Rr.k.create();try{var n=this.get_menuPositioner().GetDimensionsForMenu(e),i=this.getLauncherBounds(),r=this.get_root().setFlyoutCoordinates(e,n,this.get_menuLauncher().get_menuDirection(),i);r||(r=this.get_menuPositioner().setFlyoutCoordinates(e,n,this.get_menuLauncher().get_menuDirection(),i)),this.get_root().menuPositioningInfo=r}finally{t&&t.dispose()}}},t.prototype.getLauncherBounds=function(){var e=bt.g.getElementBounds(this.get_menuLauncher().get_launcher()),t=this.get_parentMenu();if(!_r.n.isNullOrUndefined(t)&&!_r.n.isNullOrUndefined(t.get_elementInternal())){var n=bt.g.getElementBounds(t.get_elementInternal());e.x=n.x+Mr.Menu.menuBorderPx,e.width=n.width-2*Mr.Menu.menuBorderPx}return o.r(Vr.l,this.get_menuLauncher().get_launcherComponent())&&(e.height=0),e},t.prototype.closeMenu=function(){if(this.get_menuLauncher().menuLaunched){S.ULS.sendTraceTag(6688860,207,50,"Menu closing {0}",{Id:this.get_menuLauncher().get_controlProperties().Id}),this.get_menu().onMenuClosed(),this.RemoveMenuFromHierarchy(),this.set_menuLaunched(!1),this.get_menu().set_launched(!1),this.get_root().endModal(this.get_control(),!0),this.get_ShouldRestoreFocusToApp()?L.AFrameworkApplication.get_activeFrame().restoreFocusAfterDismissingPopup(this.get_menuLauncher().get_elmHadFocus(),this._menuInvocationMethod):this.RestoreFocusToElmHadFocus(),this.get_menuLauncher().set_elmHadFocus(null);var e=this.get_menuLauncher().get_launcher();fr.n.removeCSSClassFromElement(e,hr.MenuLauncher.menuDroppedClassName),this.get_menuLauncher().updateAriaMenuLauncherAttributes(this.get_menuLauncher().get_focusableElement(),!1),fr.n.removeCSSClassFromElement(e,"cui-ctl-menu-hovered-without-focus"),this.get_menu().resetFocusedIndex();var t=this.get_Properties().CommandMenuClose;_r.n.isNullOrEmptyString(t)||this.get_root().executeCommand(this.get_Properties().CommandMenuClose,null,this.get_displayedComponent(),0,!1),this.RemoveMenuFromDom()}},t.prototype.RestoreFocusToElmHadFocus=function(){var e=this.get_menuLauncher().get_elmHadFocus();if(e)try{e.focus()}catch(e){}else;},t.prototype.RemoveMenuFromDom=function(){ji.s.removeElement(this.get_menu().get_elementInternal()),ji.s.removeElement(this._elmBackFrame),fr.n.unregisterAllHandlers(this.get_menu().get_elementInternal())},t.prototype.pollForDynamicMenu=function(e){if(this.polledOnce&&fr.n.isTrue(this.get_Properties().PopulateOnlyOnce))return null;if(_r.n.isNullOrUndefined(this.get_Properties().PopulateQueryCommand))return null;null==e&&(e=0);var t=this.get_menuLauncher().getCommandPopulateProperties();return(1&this.get_root().pollForCommandState(this.get_Properties().PopulateQueryCommand,this.get_Properties().PopulateQueryCommand,t,e))>0?t.PopulationXML:null},t.prototype.populateMenuFromXml=function(e,t){if(void 0===t&&(t=!1),this.polledOnce&&fr.n.isTrue(this.get_Properties().PopulateOnlyOnce))return!0;var n=null;if(this._lastDynamicPopulationXml=e,_r.n.isNullOrUndefined(e)||(n=this.CreateMenuFromXml(e)),_r.n.isNullOrUndefined(n)||(this.polledOnce=!0),t){if(this.get_root().clearMenuStack(this.get_menuLauncher()),_r.n.isNullOrUndefined(n)||!n.hasItems())return this.closeMenu(),!1;this.RemoveMenuFromHierarchy(),this.RemoveMenuFromDom()}return this.SetMenu(n),!0},t.prototype.onDynamicMenuPopulated=function(){},t.prototype.CreateMenuFromXml=function(e){var t=Lr.Builder.convertXMLStringToJSON(e);if(!_r.n.isNullOrUndefined(t)){var n=new Wr.g;n.cloneControlsForMenu=!0,n.parentId=this.get_control().get_id();var i;return i=o.r(Or.y,this.get_control()),this.get_root().get_builder().buildMenu(t,n,i)}return null},t.prototype.SetMenu=function(e){_r.n.isNullOrUndefined(e)||(_r.n.isNullOrUndefined(this.get_menu())||this.get_menu().dispose(),this.set_menu(e),this.onDynamicMenuPopulated())},t.prototype.RemoveMenuFromHierarchy=function(){var e=this.get_menu().get_parent();e.set_ignoreDirtyingEvents(!0),e.removeChild(this.get_menu().get_id()),e.set_ignoreDirtyingEvents(!1)},t.prototype.onKeyDown=function(t){var n=!1;_r.n.isNullOrUndefined(t.innerEvent)||_r.n.isNullOrUndefined(t.innerEvent.rawEvent)||(o.r(pr.m,this.get_displayedComponent())||t.innerEvent.rawEvent.altKey&&t.innerEvent.keyCode===Sys.UI.Key.down&&(this.doDefaultAction(t.get_sourceElement(),1,t.innerEvent),n=!0));return n||(n=e.prototype.onKeyDown.call(this,t)),n},t.prototype.onPointerDown=function(e){return this.commitRootPendingChanges(),2===e.get_inputSource()&&e.get_mouseButton()||this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),e.innerEvent.preventDefault(),!1},t.prototype.handleDefaultActionWithKeytips=function(e){return!!(this.get_parentMenu()&&this.get_parentMenu().get_inKeytipMode()&&this.get_menuLauncher().onMenuLaunchCallback)&&(this.get_menuLauncher().onMenuLaunchCallback(this.get_displayedComponent(),e),!0)},t.CreateHiddenIframeElement=function(){var e=fr.n.createElement("iframe");return e.style.position="absolute",e.style.visibility="hidden",e.style.borderWidth="0px",e},t}(yr);(0,o.l)(zr,"421bfbd4$MenuLauncherBehavior",yr,[wr,ur]);var Kr=n(9860),qr=function(e){function t(t){return e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.get_Properties$2=function(){return this.get_DropDown().get_properties()},t.prototype.get_DropDown=function(){return this.get_control()},t.prototype.get_DropDownDom=function(){return this.get_DropDown().get_dropDownDom()},t.prototype.attachEvents=function(e){lr.z.get_instance().registerHandler(me.d.pointerDown,this.get_DropDownDom().elmControl,o.i(this,this.onPointerDown,"onPointerDown")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyDown,this.get_DropDownDom().elmControl,o.i(this,this.onKeyDown,"onKeyDown")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyUp,this.get_DropDownDom().elmControl,o.i(this,this.onKeyUp,"onKeyUp"))},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[Kr.v.SelectedItemId];if((2&this.pollForStateAndUpdateInternal(this.get_Properties$2().Command,this.get_Properties$2().QueryCommand,this.get_stateProperties()))>0){var t=this.get_stateProperties()[Kr.v.SelectedItemId];_r.n.isNullOrUndefined(t)||e===t||this.get_DropDown().selectDropdownItemById(t)||(this.get_stateProperties()[Kr.v.SelectedItemId]=null)}},t}(zr);(0,o.l)(qr,"844818d6$DropDownBehavior",zr,[]);var jr=n(8330),Qr=n(9755),Jr=function(e){function t(t){var n=this;return n._elmHadFocus=null,n._mouseupOnTextboxSinceFocus=!1,n._inputFocused=!1,n._needMenuContentsForAutocomplete=!1,n._pendingDropdownItemId=null,n._pendingAutoCompleteTimeoutId=-1,n=e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.get_ComboBox=function(){return this.get_control()},t.prototype.get_ComboBoxDom=function(){return this.get_ComboBox().get_comboBoxDom()},t.prototype.get_CBProperties=function(){return this.get_ComboBox().get_cbProperties()},t.prototype.get_IsFreeForm=function(){return this.get_stateProperties()[jr.g.IsFreeForm]},t.prototype.set_IsFreeForm=function(e){return this.get_stateProperties()[jr.g.IsFreeForm]=e,e},t.prototype.attachEvents=function(e){var t=e;lr.z.get_instance().registerHandler(me.d.pointerDown,t.elmControl,o.i(this,this.onPointerDown,"onPointerDown"));var n=t.elmInput;Ie.z.get_instance().registerHandler(me.d.focus,n,o.i(this,this.onInputFocus,"onInputFocus")),Ie.z.get_instance().registerHandler(me.d.blur,n,o.i(this,this.onInputBlur,"onInputBlur")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyDown,n,o.i(this,this.OnInputKeyDown,"OnInputKeyDown")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyPress,n,o.i(this,this.OnInputKeyPress,"OnInputKeyPress")),ye.p.get_instance().registerHandler(me.d.mouseUp,n,o.i(this,this.OnInputMouseUp,"OnInputMouseUp")),lr.z.get_instance().registerHandler(me.d.pointerDown,n,o.i(this,this.onInputPointerDown,"onInputPointerDown")),lr.z.get_instance().registerHandler(me.d.pointerDown,t.elmBtnA,o.i(this,this.OnMenuButtonPointerDown,"OnMenuButtonPointerDown"))},t.prototype.pollForStateAndUpdate=function(){(2&this.pollForStateAndUpdateInternal(this.get_CBProperties().Command,this.get_CBProperties().QueryCommand,this.get_stateProperties()))>0&&(this._inputFocused||this.UpdateValueAndSelectedControl(),this.UpdateFontStyle())},t.prototype.onDynamicMenuPopulated=function(){this.get_ComboBox().set_menuItems(null);var e=null,t=null,n=null;if(!_r.n.isNullOrUndefined(this.get_menu())){this.SetAriaOwnsAttributeWithMenuId();for(var i=this.get_menu().get_children().getEnumerator();i.moveNext();)for(var r=i.get_current().get_children().getEnumerator();r.moveNext();){var a=r.get_current();o.r(pr.m,a)&&(e=a.get_control(),o.r(Tr.a,e)&&(t=e.getMenuItemId()),o.r(Ar.x,e)&&(n=e.getTextValue()),_r.n.isNullOrUndefined(t)||_r.n.isNullOrUndefined(n)||(this.get_ComboBox().get_menuItems()[n]=t,n=null,t=null))}}},t.prototype.onInputPointerDown=function(e){return o.r(Ir.u,this.get_root())&&2===e.get_inputSource()&&(this._elmHadFocus=bt.g.getActiveElement(this.get_control().get_focusableElement().ownerDocument),this.get_control().get_focusableElement().focus()),!1},t.prototype.onPointerDown=function(t){this.commitRootPendingChanges();var n=!1;return 3===t.get_inputSource()&&(n=e.prototype.onPointerDown.call(this,t),this.SetAriaOwnsAttributeWithMenuId()),n&&t.innerEvent.preventDefault(),!1},t.prototype.OnMenuButtonPointerDown=function(e){var t=!1;return 2===e.get_inputSource()&&e.get_mouseButton()||(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),this.SetAriaOwnsAttributeWithMenuId(),t=!0),t&&e.innerEvent.preventDefault(),!1},t.prototype.OnInputKeyDown=function(e){var t=!1;if(!_r.n.isNullOrUndefined(e.innerEvent)&&!_r.n.isNullOrUndefined(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,i=e.innerEvent.keyCode,r=n.shiftKey;n.altKey,fr.n.isTrue(this.get_CBProperties().AutoComplete);if(i===Sys.UI.Key.enter)this.commitPendingChange(),this.RestoreFocusFromFloatie(),o.r(Qr.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),t=!0;else if(i===Sys.UI.Key.tab){if(this.commitPendingChange(),this.RestoreFocusFromFloatie(),o.r(Qr.Ribbon,this.get_root())&&(t=this.get_root().wrapKeyboardFocus(this.get_displayedComponent().get_elementInternal(),!r)),o.r(Ir.u,this.get_root()))return!0}else i===Sys.UI.Key.backspace||i===Sys.UI.Key.del?this.get_control().get_enabled()?(this.CancelPendingAutoComplete(),this._pendingDropdownItemId=null):t=!0:i===Sys.UI.Key.esc?(this.RestoreToKnownValue(),this.RestoreFocusFromFloatie(),o.r(Qr.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),t=!0):i===Sys.UI.Key.down&&(this.launchMenu(1),this.SetAriaOwnsAttributeWithMenuId(),t=!0)}return t},t.prototype.OnInputKeyPress=function(e){return!this.get_control().get_enabled()||(!_r.n.isNullOrUndefined(e.innerEvent)&&e.innerEvent.charCode&&this.DelayAutoComplete(),!1)},t.prototype.OnInputMouseUp=function(e){return!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0)},t.prototype.executeAutoComplete=function(){this._pendingAutoCompleteTimeoutId=-1;var e=this.get_ComboBoxDom().elmInput,t=e.value,n=this.GetFirstMenuItemThatBeginsWith(t);if(n){if(e.value=n.key,e.setSelectionRange)e.setSelectionRange(t.length,e.value.length);else if(e.createTextRange){var i=e.createTextRange();i.moveStart("character",t.length),i.moveEnd("character",e.value.length),i.select()}this._pendingDropdownItemId=n.value}else this._pendingDropdownItemId=null},t.prototype.GetFirstMenuItemThatBeginsWith=function(e){var t=this.get_ComboBox().get_menuItems();for(var n in t){var i={key:n,value:t[n]};if(i.key.toLowerCase().startsWith(e.toLowerCase()))return i}return null},t.prototype.DelayAutoComplete=function(){fr.n.isTrue(this.get_CBProperties().AutoComplete)&&-1===this._pendingAutoCompleteTimeoutId&&(this._needMenuContentsForAutocomplete&&(this.pollForDynamicMenu(0),this._needMenuContentsForAutocomplete=!1),this._pendingAutoCompleteTimeoutId=window.setTimeout(o.i(this,this.executeAutoComplete,"executeAutoComplete"),this.get_ComboBox().get_autoCompleteDelay()))},t.prototype.CancelPendingAutoComplete=function(){var e=this;fr.n.isTrue(this.get_CBProperties().AutoComplete)&&fr.n.cancelPendingTimeout((0,g.m)((function(){return e._pendingAutoCompleteTimeoutId}),(function(t){return e._pendingAutoCompleteTimeoutId=t})))},t.prototype.onInputFocus=function(t){return this.get_menuLaunched()?(this.get_menu().setFocus(0),!0):(o.r(Ir.u,this.get_root())&&(St.FocusManager.instance().scopeChanged("ribbon"),this.get_root().set_hasShynessBehavior(!1)),e.prototype.OnFocus.call(this,t),this._inputFocused=!0,fr.n.ensureCSSClassOnElement(this.get_ComboBoxDom().elmControl,"cui-cb-focus"),fr.n.isTrue(this.get_CBProperties().PopulateDynamically)&&(this._needMenuContentsForAutocomplete=!0),bt.g.selectAllTextInInput(this.get_ComboBoxDom().elmInput),_r.n.isNullOrUndefined(this.get_menu())||this.get_menu().refreshInternal(),this._mouseupOnTextboxSinceFocus=!1,!1)},t.prototype.onInputBlur=function(e){return this._inputFocused=!1,this.commitPendingChange(),fr.n.removeCSSClassFromElement(this.get_ComboBoxDom().elmControl,"cui-cb-focus"),!1},t.prototype.RestoreFocusFromFloatie=function(){o.r(Ir.u,this.get_root())&&(void 0!==this._elmHadFocus&&null!==this._elmHadFocus&&L.AFrameworkApplication.get_activeFrame().restoreFocusAfterDismissingPopup(this._elmHadFocus,2),this._elmHadFocus=null)},t.prototype.commitPendingChange=function(){if(this.get_control().get_enabled()){this.CancelPendingAutoComplete();var e=this.get_ComboBoxDom().elmInput;if(void 0!==this.get_stateProperties()[jr.g.Value]&&null!==this.get_stateProperties()[jr.g.Value]&&e.value===this.get_stateProperties()[jr.g.Value].toString())return;if(this.get_ComboBox().selectDropdownItemById(this._pendingDropdownItemId)){this.set_IsFreeForm(!1),this.get_stateProperties()[jr.g.Value]=e.value;n={IsFreeForm:!1,CommandValueId:this.get_ComboBox().get_selectedControl().getCommandValueId(),MenuItemId:this.get_ComboBox().get_selectedControl().getMenuItemId()};this.get_root().executeCommand(this.get_CBProperties().Command,n,this.get_displayedComponent(),0,!1)}else{if(!fr.n.isTrue(this.get_CBProperties().AutoComplete)){var t=this.get_ComboBox().get_menuItems()[e.value];if(!_r.n.isNullOrEmptyString(t)&&this.get_ComboBox().selectDropdownItemById(t)){this.set_IsFreeForm(!1),this.get_stateProperties()[jr.g.Value]=e.value;var n={IsFreeForm:!1,CommandValueId:this.get_ComboBox().get_selectedControl().getCommandValueId(),MenuItemId:t};return void this.get_root().executeCommand(this.get_CBProperties().Command,n,this.get_displayedComponent(),0,!1)}}var i=!_r.n.isNullOrEmptyString(e.value)&&""!==Rn.l.removeAllWhitespace(e.value);if(!this.get_ComboBox().get_allowFreeForm()||!i)return void this.RestoreToKnownValue();this.set_IsFreeForm(!0),this.get_stateProperties()[jr.g.Value]=e.value;var n={IsFreeForm:!0,Value:e.value};this.get_root().executeCommand(this.get_CBProperties().Command,n,this.get_displayedComponent(),0,!1)}}else this.RestoreToKnownValue()},t.prototype.RestoreToKnownValue=function(){this.CancelPendingAutoComplete(),this._pendingDropdownItemId=null,this.UpdateValueAndSelectedControl()},t.prototype.UpdateValueAndSelectedControl=function(){var e=this.get_stateProperties()[jr.g.Value]||"";e!==this.get_ComboBoxDom().elmInput.value&&(this.get_ComboBoxDom().elmInput.value=e),this.get_ComboBox().selectDropdownItemById(this.get_ComboBox().get_menuItems()[e])},t.prototype.UpdateFontStyle=function(){var e=this.get_stateProperties()[jr.g.FontStyle]||"normal";e!==this.get_ComboBoxDom().elmInput.style.fontStyle&&(this.get_ComboBoxDom().elmInput.style.fontStyle=e)},t.prototype.SetAriaOwnsAttributeWithMenuId=function(){this.get_control().get_focusableElement()&&this.get_menu()&&this.get_control().get_focusableElement().setAttribute(vt.t.ariaOwnsAttribute,this.get_menu().get_id())},t}(qr);(0,o.l)(Jr,"9822f814$ComboBoxBehavior",qr,[]);var Xr=function(e){function t(t){return e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.get_ContextMenuLauncher=function(){return this.get_control()},t.prototype.getLauncherBounds=function(){var e=0;return this.get_menu()&&this.get_menu().get_elementInternal()&&2===this.get_menu().get_horizontalAlignment()&&(e=this.get_menu().get_elementInternal().clientWidth),new Sys.UI.Bounds(this.get_ContextMenuLauncher().get_x()-e,this.get_ContextMenuLauncher().get_y(),this.get_ContextMenuLauncher().get_launcherWidth(),this.get_ContextMenuLauncher().get_launcherHeight())},t}(zr);(0,o.l)(Xr,"fd9ee22b$ContextMenuLauncherBehavior",zr,[]);var Yr=function(e){function t(t){return e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.get_DialogMenuLauncher=function(){return this.get_control()},t.prototype.getLauncherBounds=function(){return new Sys.UI.Bounds(this.get_DialogMenuLauncher().get_x(),this.get_DialogMenuLauncher().get_y(),this.get_DialogMenuLauncher().get_launcherWidth(),this.get_DialogMenuLauncher().get_launcherHeight())},t}(zr);(0,o.l)(Yr,"4e22273c$DialogMenuLauncherBehavior",zr,[]);var Zr=n(2482),eo=function(e){function t(t){var n=this;return n._shouldRefreshWhenDropped=!1,n._needToRefreshAfterMenuClose=!1,(n=e.call(this,t)||this)._shouldRefreshWhenDropped=!fr.n.isFalse(n.get_Properties$2().ShouldRefreshWhenDropped),n}return(0,v.t)(t,e),t.prototype.get_FlyoutAnchor=function(){return this.get_control()},t.prototype.get_Properties$2=function(){return this.get_control().get_controlProperties()},t.prototype.attachEvents=function(e){var t=e.elmControl;_r.n.isNullOrUndefined(t)||(Ie.z.get_instance().registerHandler(me.d.focus,t,o.i(this,this.OnFocus,"OnFocus")),Ie.z.get_instance().registerHandler(me.d.blur,t,o.i(this,this.OnBlur,"OnBlur")),lr.z.get_instance().registerHandler(me.d.pointerOver,t,o.i(this,this.OnPointerOver,"OnPointerOver")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyDown,t,o.i(this,this.onKeyDown,"onKeyDown")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyUp,t,o.i(this,this.onKeyUp,"onKeyUp")),lr.z.get_instance().registerHandler(me.d.pointerDown,t,o.i(this,this.onPointerDown,"onPointerDown")))},t.prototype.pollForStateAndUpdate=function(){if(!_r.n.isNullOrUndefined(this.get_control().get_controlProperties().Command))if(!this.get_FlyoutAnchor().menuLaunched||this._shouldRefreshWhenDropped){if((2&this.pollForStateAndUpdateInternal(this.get_Properties$2().Command,this.get_Properties$2().QueryCommand,this.get_stateProperties()))>0)this.updateVisibility()&&this.UpdateHtml();fr.n.isTrue(this.get_Properties$2().RefreshableMenu)&&this.get_menuLaunched()&&this.get_menu().pollMenuState()}else this._needToRefreshAfterMenuClose=!0},t.prototype.UpdateHtml=function(){this.UpdateFlyoutLabelText(),this.updateImage(),this.UpdateImageBackgroundColor(),this.get_FlyoutAnchor().set_imageIsVisible(this.get_stateProperties()[Zr.g.ImageIsVisible])},t.prototype.UpdateFlyoutLabelText=function(){var e=fr.n.validateStringProperty(this.get_stateProperties()[Zr.g.LabelText],this.get_Properties$2().LabelText),t=this.get_stateProperties()[Zr.g.LabelTextUserGeneratedPlaceholderReplacements];this.get_control().labelText===e&&this.get_Properties$2().LabelTextUserGeneratedPlaceholderReplacements===t||(this.get_controlComponentDomCache().get_medium()&&this.UpdateFlyoutLabelTextDom(this.get_controlComponentDomCache().get_medium().elmLabel,e,t),this.get_controlComponentDomCache().get_large(),this.get_root().needScaling=!0,this.get_control().labelText=e,this.get_Properties$2().LabelTextUserGeneratedPlaceholderReplacements=t)},t.prototype.UpdateFlyoutLabelTextDom=function(e,t,n){var i=e.lastChild;fr.n.setControlText(e,t+" ",n);var r=_r.n.isNullOrUndefined(i);S.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",r?"":i.nodeType.toString()),r||e.appendChild(i)},t.prototype.UpdateImageBackgroundColor=function(){var e=this.get_stateProperties()[Zr.g.ImageBackColor];this.get_controlComponentDomCache().forEach((function(n){t.ApplyColorToImage(n.elmImage,e)}))},t.prototype.launchMenu=function(t){"faPrint"===this.get_control().get_id()&&"jewelWordEditor"===this.get_control().get_root().get_id()&&(L.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.digitalPrintToSwaySlabClicked,2)),"faRemix"!==this.get_control().get_id()&&"faTransform"!==this.get_control().get_id()&&"faPublish"!==this.get_control().get_id()||"jewelWordEditor"!==this.get_control().get_root().get_id()||L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.digitalPrintToSwaySlabClicked,2),o.r(pr.m,this.get_displayedComponent())&&(this.get_menuLaunched()||this.closeChildMenus(!0),this.get_control().get_enabled()&&this.setFocusOnControl()),e.prototype.launchMenu.call(this,t)},t.prototype.closeMenu=function(){e.prototype.closeMenu.call(this),this._needToRefreshAfterMenuClose&&(this._needToRefreshAfterMenuClose=!1,this.pollForStateAndUpdate())},t.prototype.OnPointerOver=function(t){return this.get_control().isStandardMenuItem()?(this.get_FlyoutAnchor().menuLaunched?(this.get_root().cancelPendingCloseMenuStack(),fr.n.ensureCSSClassOnElement(this.get_FlyoutAnchor().get_launcher(),hr.MenuLauncher.menuDroppedClassName),this.get_FlyoutAnchor().set_elmHadFocus(this.get_control().get_focusableElement())):(e.prototype.OnPointerOver.call(this,t),this.doDefaultAction(t.get_sourceElement(),t.get_inputSource(),t.innerEvent)),!1):e.prototype.OnPointerOver.call(this,t)},t.prototype.onKeyDown=function(t){var n=!1;if(!_r.n.isNullOrUndefined(t.innerEvent)&&!_r.n.isNullOrUndefined(t.innerEvent.rawEvent)){if(o.r(pr.m,this.get_displayedComponent())){var i=t.innerEvent.rawEvent,r=t.innerEvent.keyCode,a=!this.get_root().get_textDirection();i.shiftKey||i.ctrlKey||!(r===Sys.UI.Key.right&&a||r===Sys.UI.Key.left&&!a)||(n=this.handleDefaultActionWithKeytips(t))||(this.doDefaultAction(t.get_sourceElement(),1,t.innerEvent),n=!0)}n||(n=e.prototype.onKeyDown.call(this,t))}return n},t.ApplyColorToImage=function(e,t){_r.n.isNullOrUndefined(e)||_r.n.isNullOrUndefined(t)||e.style.backgroundColor===t||(e.style.backgroundColor=t)},t}(zr);(0,o.l)(eo,"2b3249e9$FlyoutAnchorBehavior",zr,[]);var to=n(3874),no=function(e){function t(t){return e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.get_GalleryButton=function(){return this.get_control()},t.prototype.get_Properties=function(){return this.get_GalleryButton().get_properties()},t.prototype.get_ComponentDom=function(){return this.get_GalleryButton().componentDom},t.prototype.attachEvents=function(e){var t=e.elmA;Ie.z.get_instance().registerHandler(me.d.focus,t,o.i(this,this.OnFocus,"OnFocus")),Ie.z.get_instance().registerHandler(me.d.blur,t,o.i(this,this.OnBlur,"OnBlur")),lr.z.get_instance().registerHandler(me.d.pointerOver,t,o.i(this,this.OnPointerOver,"OnPointerOver")),lr.z.get_instance().registerHandler(me.d.pointerOut,t,o.i(this,this.OnPointerOut,"OnPointerOut")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyDown,t,o.i(this,this.onKeyDown,"onKeyDown")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyUp,t,o.i(this,this.onKeyUp,"onKeyUp")),lr.z.get_instance().registerHandler(me.d.pointerDown,t,o.i(this,this.onPointerDown,"onPointerDown")),lr.z.get_instance().registerHandler(me.d.pointerUp,t,o.i(this,this.OnPointerUp,"OnPointerUp")),Yt.v.get_instance().registerHandler(me.d.touchMove,t,o.i(this,this.OnTouchMove,"OnTouchMove")),Yt.v.get_instance().registerHandler(me.d.touchEnd,t,o.i(this,this.OnTouchEnd,"OnTouchEnd"))},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[to.u.On],t=this.get_stateProperties()[to.u.IsRtl];if(this.UpdateStateProperties(),(2&this.pollForStateAndUpdateInternal(this.get_Properties().Command,this.get_Properties().QueryCommand,this.get_stateProperties()))>0){var n=!_r.n.isNullOrUndefined(this.get_stateProperties()[to.u.InnerHTML])||!_r.n.isNullOrUndefined(this.get_Properties().InnerHTML),i=!_r.n.isNullOrUndefined(this.get_Properties().Image);n||i||this.get_control().set_enabled(!1);var r=this.get_ComponentDom().elmA;if(!_r.n.isNullOrUndefined(r)){if(n){var o=fr.n.validateStringProperty(this.get_stateProperties()[to.u.InnerHTML],this.get_Properties().InnerHTML);null!==r.innerHTML&&null!==o&&Rn.l.toLower(r.innerHTML)===Rn.l.toLower(o)||(r.innerHTML=o),""===o&&this.get_control().set_enabled(!1)}var a=r.title,l=fr.n.validateStringProperty(this.get_stateProperties()[to.u.Alt],this.get_Properties().Alt);l===a||this.get_control().get_shouldIgnoreTitle()||(r.title=l)}var s=this.get_stateProperties()[to.u.On],u=this.get_stateProperties()[to.u.IsRtl];e===s&&t===u||this.get_control().onStateChanged()}},t.prototype.UpdateStateProperties=function(){var e=this.get_stateProperties();e[to.u.CommandValueId]=this.get_control().getCommandValueId(),e.MenuItemId=this.get_control().getMenuItemId(),e.SourceControlId=this.get_Properties().Id},t.prototype.doDefaultAction=function(e,t,n){var i=this.get_displayedComponent();if(i&&this.get_control().get_enabled()){var r=this.get_root();if(L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExcelBorderMenuCompactionEnabled")&&i.isMenuItem()&&this.get_parentMenu()){var o=this.get_parentMenu().get_stackIndex(),a=r.get_menuLauncherStack()[o];a?a.selectDropdownItem(this.get_GalleryButton()):S.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.UpdateStateProperties(),this.get_stateProperties()[to.u.On]||(this.get_stateProperties()[to.u.On]=!0,this.get_control().onStateChanged()),"Menu"===i.get_displayMode()&&fr.n.removeCSSClassFromElement(this.get_ComponentDom().elmControl,"cui-gallerybutton-focused"),r.executeCommand(this.get_Properties().Command,this.get_stateProperties(),i,t,!0,null,this.getTelemetryData(n))}},t.prototype.OnFocus=function(t){return e.prototype.OnFocus.call(this,t),fr.n.ensureCSSClassOnElement(this.get_ComponentDom().elmControl,"cui-gallerybutton-focused"),!1},t.prototype.OnBlur=function(t){return e.prototype.OnBlur.call(this,t),fr.n.removeCSSClassFromElement(this.get_ComponentDom().elmControl,"cui-gallerybutton-focused"),!1},t}(yr);(0,o.l)(no,"9e3bac73$GalleryButtonBehavior",yr,[]);var io=n(9451),ro=function(){function e(){}return e.Rows="Rows",e.Columns="Columns",e}();(0,o.l)(ro,"674540a4$InsertTableCommandProperties",null,[]);var oo=n(6481),ao=function(e){function t(t){var n=e.call(this,t)||this;return n._oldIdx=-1,n}return(0,v.t)(t,e),t.prototype.get_InsertTableControl=function(){return this.get_control()},t.prototype.get_Properties=function(){return this.get_InsertTableControl().get_controlProperties()},t.prototype.get_CommandProperties=function(){return this.get_InsertTableControl().get_commandProperties()},t.prototype.get_HostMenuSection=function(){var e=null;if(this.get_displayedComponent()){var t=this.get_displayedComponent().get_parent();if(!o.r(oo.z,t))throw Error.create("InsertTable must live inside of a MenuSection.");e=t}return e},t.prototype.get_InnerDivs=function(){return this.get_InsertTableControl().get_insertTableDom().innerDivs},t.prototype.get_OuterDivs=function(){return this.get_InsertTableControl().get_insertTableDom().outerDivs},t.prototype.doDefaultAction=function(e,t,n){if(this.get_control().get_enabled()){var i=this.GetIndexFromElement(this.GetCellOuterDiv(e)),r=this.GetColFromIndex(i),o=this.GetRowFromIndex(i);this.get_CommandProperties()[ro.Rows]=o+1,this.get_CommandProperties()[ro.Columns]=r+1,this.get_root().executeCommand(this.get_Properties().Command,this.get_CommandProperties(),this.get_displayedComponent(),t,!0,null,this.getTelemetryData(n))}},t.prototype.attachEvents=function(e){var t=e,n=t.elmControl,i=t.cellATags,r=t.cells;lr.z.get_instance().registerHandler(me.d.pointerOut,n,o.i(this,this.OnControlPointerOut,"OnControlPointerOut")),Yt.v.get_instance().registerHandler(me.d.touchMove,n,o.i(this,this.OnControlTouchMove,"OnControlTouchMove")),Yt.v.get_instance().registerHandler(me.d.touchEnd,n,o.i(this,this.OnControlTouchEnd,"OnControlTouchEnd"));for(var a=0;a<r.length;++a)this.AttachCellEvents(i[a],r[a])},t.prototype.AttachCellEvents=function(e,t){Ie.z.get_instance().registerHandler(me.d.focus,e,o.i(this,this.OnCellFocus,"OnCellFocus")),lr.z.get_instance().registerHandler(me.d.pointerOver,t,o.i(this,this.OnCellPointerOver,"OnCellPointerOver")),lr.z.get_instance().registerHandler(me.d.pointerUp,t,o.i(this,this.OnCellPointerUp,"OnCellPointerUp")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyDown,t,o.i(this,this.onKeyDown,"onKeyDown")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyUp,t,o.i(this,this.onKeyUp,"onKeyUp")),Yt.v.get_instance().registerHandler(me.d.touchStart,t,o.i(this,this.OnCellTouchStart,"OnCellTouchStart"))},t.prototype.GetIndexFromElement=function(e){return parseInt(e.id.substr(this.get_InsertTableControl().get_id().length+1))},t.prototype.HandleHighlightingTitle=function(e){this.HandleHighlightingAndTitleForIndex(this.GetIndexFromElement(e))},t.prototype.GetRowFromIndex=function(e){return Math.floor(e/io.o.numCols)},t.prototype.GetColFromIndex=function(e){return e%io.o.numCols},t.prototype.HandleHighlightingAndTitleForIndex=function(e){if(e!==this._oldIdx){var t=this.GetColFromIndex(e),n=this.GetRowFromIndex(e),i=-1,r=-1;for(-1!==this._oldIdx&&(i=this.GetRowFromIndex(this._oldIdx),r=this.GetColFromIndex(this._oldIdx));i!==n||r!==t;)i<n?this.SetRowHighlighting(++i,r,!0):i>n?(this.SetRowHighlighting(i,r,!1),i--):r<t?this.SetColHighlighting(++r,i,!0):r>t&&(this.SetColHighlighting(r,i,!1),r--);if(this.get_HostMenuSection())this.get_HostMenuSection().setTitleImmediate(this.GetCellTitle(n+1,t+1));else{var o=this.get_control().get_components(),a=o&&o.length>0?o[0]:null,l=this.get_displayedComponent();S.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",{CtrlComps:!!o,FirstComp:!!a,FirstCompPar:!!a&&!!a.get_parent(),DispComp:!!l,DispCompPar:!!l&&!!l.get_parent()})}this._oldIdx=e}},t.prototype.SetRowHighlighting=function(e,t,n){for(var i=0;i<=t;i++)this.SetCellHighlighting(e,i,n)},t.prototype.SetColHighlighting=function(e,t,n){for(var i=0;i<=t;i++)this.SetCellHighlighting(i,e,n)},t.prototype.SetCellHighlighting=function(e,t,n){var i=e*io.o.numCols+t,r=this.get_InnerDivs()[i],o=this.get_OuterDivs()[i];n?(r.className="cui-it-activeCell",o.className="cui-it-activeCellOuter"):(r.className="cui-it-inactiveCell",o.className="cui-it-inactiveCellOuter")},t.prototype.OnCellPointerUp=function(e){return this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),!0},t.prototype.GetCellOuterDiv=function(e){for(;e.hasChildNodes();)e=e.childNodes[0];return _r.n.isNullOrUndefined(e.tagName)||"a"!==e.tagName.toLowerCase()?null:e.parentNode.parentNode},t.prototype.SetTitleOnAnchor=function(e){var t=e.childNodes[0].childNodes[0],n=this.GetIndexFromElement(e);t.title=this.GetCellTitle(this.GetRowFromIndex(n)+1,this.GetColFromIndex(n)+1)},t.prototype.GetCellTitle=function(e,t){var n=this.get_Properties().Alt;return _r.n.isNullOrUndefined(n)&&(n=this.get_Properties().MenuSectionTitle),n=String.format(n,t.toString(),e.toString())},t.prototype.ResetAll=function(){if(this.get_displayedComponent()){for(var e=0;e<io.o.numCells;e++)this.get_InnerDivs()[e].className="cui-it-inactiveCell",this.get_OuterDivs()[e].className="cui-it-inactiveCellOuter";this._oldIdx=-1;var t=this.get_Properties().MenuSectionInitialTitle;_r.n.isNullOrUndefined(t)&&(t=""),this.get_HostMenuSection().setTitleImmediate(t)}},t.prototype.OnCellPointerOver=function(e){if(this.get_control().get_enabled()){var t=this.GetCellOuterDiv(e.get_sourceElement());this.SetFocusOnCell(t),this.DoCellHover(t)}return!1},t.prototype.DoCellHover=function(e){this.SetTitleOnAnchor(e),this.HandleHighlightingTitle(e)},t.prototype.OnCellFocus=function(e){if(!this.get_control().get_enabled())return!1;var t=this.GetCellOuterDiv(e.get_sourceElement());return this.SetTitleOnAnchor(t),this.HandleHighlightingTitle(t),!1},t.prototype.OnControlPointerOut=function(e){return bt.g.isPointInElement(this.get_InsertTableControl().get_insertTableDom().elmControl,e.get_clientPoint())||this.ResetAll(),!1},t.prototype.OnCellTouchStart=function(e){if(!this.get_control().get_enabled())return!1;var t=this.GetCellOuterDiv(e.get_sourceElement());return this.DoCellHover(t),!0},t.prototype.OnControlTouchMove=function(e){if(!this.get_control().get_enabled())return!1;var t=e.get_clientPoint(),n=bt.g.getElementAtPoint(t);if(!n||"table"===n.tagName.toLowerCase())return!1;var i=this.GetCellOuterDiv(n);return i?this.DoCellHover(i):this.ResetAll(),!0},t.prototype.OnControlTouchEnd=function(e){if(!this.get_control().get_enabled())return!1;var t=e.get_clientPoint(),n=bt.g.getElementAtPoint(t);if(!n||"table"===n.tagName.toLowerCase())return this.ResetAll(),!0;var i=this.GetCellOuterDiv(n);return i?this.doDefaultAction(i,3,e.innerEvent):this.ResetAll(),!0},t.prototype.focusNext=function(e){var t=cr.Control.focusNextIndexInGrid(this._oldIdx,io.o.numCols,io.o.numCells,e);return t!==this._oldIdx?(this.get_InnerDivs()[t].firstChild.focus(),this.HandleHighlightingAndTitleForIndex(t),!0):(this.ResetAll(),this._oldIdx=-1,!1)},t.prototype.setFocusOnControl=function(){var e=this.get_InnerDivs()[0];return!_r.n.isNullOrUndefined(e)&&(e.firstChild.focus(),!0)},t.prototype.SetFocusOnCell=function(e){return!_r.n.isNullOrUndefined(e)&&(e.firstChild.firstChild.focus(),!0)},t.prototype.onMenuClosed=function(){this.ResetAll()},t}(yr);(0,o.l)(ao,"25ade784$InsertTableBehavior",yr,[]);var lo=function(e){function t(t){return e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.pollForStateAndUpdate=function(){this.get_control().set_enabled(!!this.get_menu())},t.prototype.doDefaultAction=function(e,t,n){L.AFrameworkApplication.get_theActionManager().processActionWithData(Fe.b.launchFileMenu,2,t,this.getTelemetryData(n))},t}(zr);(0,o.l)(lo,"26074085$JewelMenuLauncherBehavior",zr,[]);var so=n(6973),uo=function(e){function t(t){return e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.get_Properties=function(){return this.get_control().get_controlProperties()},t.prototype.pollForStateAndUpdate=function(){(2&this.pollForStateAndUpdateInternal(this.get_Properties().Command,this.get_Properties().QueryCommand,this.get_stateProperties()))>0&&(this.updateVisibility()&&this.UpdateHtml())},t.prototype.UpdateHtml=function(){this.UpdateTextForLabelControl(),this.updateImage(),this.updateTooltip()},t.prototype.UpdateTextForLabelControl=function(){var e=this.get_control().labelText,t=this.get_stateProperties()[so.i.Value];_r.n.isNullOrUndefined(t)&&(t=this.get_Properties().LabelText,_r.n.isNullOrUndefined(t)&&(t="")),t!==e&&this.setLabelText(t)},t.prototype.attachEvents=function(e){var t=e.elmControl;_r.n.isNullOrUndefined(t)||(lr.z.get_instance().registerHandler(me.d.pointerDown,t,o.i(this,this.onPointerDown,"onPointerDown")),lr.z.get_instance().registerHandler(me.d.pointerOver,t,o.i(this,this.OnPointerOver,"OnPointerOver")),lr.z.get_instance().registerHandler(me.d.pointerOut,t,o.i(this,this.OnPointerOut,"OnPointerOut")))},t}(yr);(0,o.l)(uo,"875d36cb$LabelBehavior",yr,[]);var co=(0,o.y)("f59fe1f5$ISearchBoxBehavior"),go=n(1744),po=n(6806),ho=n(4768),_o=function(e){function t(t){var n=this;return n._closingMenu=!1,n._inActiveInteraction=!1,n._isRedesignFlightEnabled=!1,n._activeIconClass=null,n._inactiveIconClass=null,(n=e.call(this,t)||this)._isRedesignFlightEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TellMeRedesignIsEnabled"),n._isRedesignFlightEnabled&&(n._activeIconClass=n.get_SearchBox().get_sbProperties().LightImage16by16Class,n._inactiveIconClass=n.get_SearchBox().get_sbProperties().DarkImage16by16Class),n}return(0,v.t)(t,e),t.prototype.get_SearchBox=function(){return this.get_control()},t.prototype.notifyCommandExecuted=function(e,t,n,i){if(t&&(this.get_SearchBox().set_elmHadFocus(n),L.AFrameworkApplication.get_activeFrame().setFocusOnDocument()),o.r(po.r,e)&&i){var r=new go.f;r.CommandLocation=this.get_root().get_rootType(),r.InvocationMethod=0;var a={},l=e.get_control();if(l&&l.get_controlProperties()){if(a.CommandId=l.get_controlProperties().Command,a.ControlId=l.get_controlProperties().Id,a.CloseAllMenus=t,l.get_parentMenu()&&l.get_parentMenu().get_parent()&&l.get_parentMenu().get_parent().get_id()){var s=l.get_parentMenu().get_parent().get_id();a.ParentControlId=s.split("-")[0]}this.get_root().get_rootUser()&&this.get_root().get_rootUser().executeRootCommand(i,a,r)}}},t.prototype.closeMenu=function(){this.get_SearchBox().get_elmHadFocus()||this.get_SearchBox().set_elmHadFocus(this.get_SearchBox().get_inputField()),this.get_SearchBox().get_mouseIsOver()||this._isRedesignFlightEnabled&&(fr.n.removeCSSClassFromElement(this.get_SearchBox().get_inputField(),"cui-sb-focus"),fr.n.removeCSSClassFromElement(this.get_SearchBox().get_topLevelElement(),"cui-sb-focus"),fr.n.removeCSSClassFromElement(this.get_SearchBox().searchIcon,this._activeIconClass),fr.n.ensureCSSClassOnElement(this.get_SearchBox().searchIcon,this._inactiveIconClass)),this._closingMenu=!0,e.prototype.closeMenu.call(this),this._closingMenu=!1,this.raiseInteractionEnd()},t.prototype.get_ShouldRestoreFocusToApp=function(){return!this.get_SearchBox().get_processingKeystroke()},t.prototype.onMenuChanged=function(){this.get_SearchBox().onMenuChanged()},t.prototype.raiseInteractionBegin=function(){this._inActiveInteraction||this._closingMenu||(this._inActiveInteraction=!0,this.get_SearchBox().raiseEvent(ho.t.interactionBegin,null))},t.prototype.raiseInteractionEnd=function(){this.get_menuLaunched()||this.get_SearchBox().get_inputHasFocus()||(this._inActiveInteraction=!1,this.get_SearchBox().raiseEvent(ho.t.interactionEnd,null))},t.prototype.onInputBoxBlur=function(e){return fr.n.removeCSSClassFromElement(this.get_SearchBox().get_inputField(),"cui-sb-focus"),fr.n.removeCSSClassFromElement(this.get_SearchBox().get_topLevelElement(),"cui-sb-focus"),this._isRedesignFlightEnabled&&!this.get_SearchBox().menuLaunched&&(fr.n.removeCSSClassFromElement(this.get_SearchBox().searchIcon,this._activeIconClass),fr.n.ensureCSSClassOnElement(this.get_SearchBox().searchIcon,this._inactiveIconClass)),this.get_SearchBox().raiseEvent(ho.t.blur,e),this.raiseInteractionEnd(),this.get_SearchBox().set_elmHadFocus(this.get_SearchBox().get_inputField()),!1},t.prototype.onInputBoxFocus=function(e){return fr.n.ensureCSSClassOnElement(this.get_SearchBox().get_inputField(),"cui-sb-focus"),fr.n.ensureCSSClassOnElement(this.get_SearchBox().get_topLevelElement(),"cui-sb-focus"),this._isRedesignFlightEnabled&&(fr.n.removeCSSClassFromElement(this.get_SearchBox().searchIcon,this._inactiveIconClass),fr.n.ensureCSSClassOnElement(this.get_SearchBox().searchIcon,this._activeIconClass)),this.get_SearchBox().raiseEvent(ho.t.focus,e),this.raiseInteractionBegin(),!1},t.prototype.onSearchContainerMouseOver=function(e){return this._isRedesignFlightEnabled&&(fr.n.ensureCSSClassOnElement(this.get_SearchBox().get_topLevelElement(),"cui-sb-hover"),fr.n.ensureCSSClassOnElement(this.get_SearchBox().get_inputField(),"cui-sb-hover"),fr.n.removeCSSClassFromElement(this.get_SearchBox().searchIcon,this._inactiveIconClass),fr.n.ensureCSSClassOnElement(this.get_SearchBox().searchIcon,this._activeIconClass)),!1},t.prototype.onSearchContainerMouseOut=function(e){return this._isRedesignFlightEnabled&&(fr.n.removeCSSClassFromElement(this.get_SearchBox().get_topLevelElement(),"cui-sb-hover"),fr.n.removeCSSClassFromElement(this.get_SearchBox().get_inputField(),"cui-sb-hover"),this.get_SearchBox().menuLaunched||this.get_SearchBox().get_inputHasFocus()||(fr.n.removeCSSClassFromElement(this.get_SearchBox().searchIcon,this._activeIconClass),fr.n.ensureCSSClassOnElement(this.get_SearchBox().searchIcon,this._inactiveIconClass))),!1},t}(zr);(0,o.l)(_o,"4d04016$SearchBoxBehavior",zr,[co,ur]);var mo=n(736),fo=function(e){function t(t){return e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.get_Slider=function(){return this.get_control()},t.prototype.get_SliderDom=function(){return this.get_Slider().get_sliderDom()},t.prototype.get_Properties=function(){return this.get_control().get_controlProperties()},t.prototype.initialize=function(){},t.prototype.doDefaultAction=function(e,t,n){},t.prototype.attachEvents=function(e){var t=e.elmInput;Ie.z.get_instance().registerHandler(me.d.focus,t,o.i(this,this.OnFocus,"OnFocus")),Ie.z.get_instance().registerHandler(me.d.blur,t,o.i(this,this.OnBlur,"OnBlur")),Ie.z.get_instance().registerHandler(me.d.change,t,o.i(this,this.OnChange,"OnChange")),Ie.z.get_instance().registerHandler(me.d.input,t,o.i(this,this.OnChange,"OnChange"))},t.prototype.OnFocus=function(n){return this.get_SliderDom().elmControl&&Sys.UI.DomElement.addCssClass(this.get_SliderDom().elmControl,t.sliderOnFocusClassName),e.prototype.OnFocus.call(this,n)},t.prototype.OnBlur=function(n){return this.get_SliderDom().elmControl&&Sys.UI.DomElement.removeCssClass(this.get_SliderDom().elmControl,t.sliderOnFocusClassName),e.prototype.OnBlur.call(this,n)},t.prototype.OnChange=function(e){return this.CommitValue(this.get_SliderDom().elmInput.value),!0},t.prototype.CommitValue=function(e){this.get_stateProperties()[mo.u.Value]=parseFloat(e),this.get_root().executeCommand(this.get_Properties().Command,this.get_stateProperties(),this.get_displayedComponent(),0,!1)},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[mo.u.Value],t=this.get_stateProperties()[mo.u.MaxValue],n=this.get_stateProperties()[mo.u.Text],i=this.pollForStateAndUpdateInternal(this.get_Properties().Command,this.get_Properties().QueryCommand,this.get_stateProperties());if(this.get_SliderDom()&&this.get_SliderDom().elmInput&&(this.get_SliderDom().elmInput.disabled=!this.get_control().get_enabled()),(2&i)>0){var r=this.get_stateProperties()[mo.u.Value],o=this.get_stateProperties()[mo.u.MaxValue],a=this.get_stateProperties()[mo.u.Text];o===t&&r===e&&n===a||this.get_SliderDom()&&this.get_SliderDom().elmInput&&(this.get_SliderDom().elmInput.setAttribute(vt.t.ariaValueMaxAttribute,String.format("{0}",o)),this.get_SliderDom().elmInput.setAttribute("max",String.format("{0}",o)),this.get_SliderDom().elmInput.value=r,this.get_SliderDom().elmLabel.innerText=this.get_stateProperties()[mo.u.Text])}},t.sliderOnFocusClassName="cui-sldr-onfocus",t}(yr);(0,o.l)(fo,"80ba8988$SliderBehavior",yr,[]);var yo,Co=(0,o.y)("70e3c273$ISpinnerBehavior");!function(e){e[e.none=0]="none",e[e.centimeter=1]="centimeter",e[e.character=2]="character",e[e.inch=3]="inch",e[e.line=4]="line",e[e.point=5]="point",e[e.percent=6]="percent",e[e.pixels=7]="pixels",e[e.timespan=8]="timespan",e[e.degree=9]="degree"}(yo||(yo={})),(0,o.h)("1d8c8141$UnitType",yo);var So=function(){function e(){}return e.Alt="Alt",e.Number="Number",e.UnitType="UnitType",e.Text="Text",e.MaxValue="MaxValue",e}();(0,o.l)(So,"e25e68f0$SpinnerCommandProperties",null,[]);var bo=function(e){function t(t){var n=e.call(this,t)||this;return n._numericalValue=0,n._unit=null,n._isSpecialText=!1,n._validUnitTypes=null,n._spinningUp=!1,n._mouseupOnTextboxSinceFocus=!1,n._pendingDelaySpinTimeoutId=-1,n._repeatSpinIntervalId=-1,n}return(0,v.t)(t,e),t.prototype.get_Spinner=function(){return this.get_control()},t.prototype.get_SpinnerDom=function(){return this.get_Spinner().get_spinnerDom()},t.prototype.get_Properties=function(){return this.get_control().get_controlProperties()},t.prototype.initialize=function(){var e=this.get_Spinner().get_validUnits();this._validUnitTypes=this.UnitTypeArrayFromUnitArray(e),this._numericalValue=e[0].get_min(),this._unit=e[0],this._isSpecialText=!1},t.prototype.doDefaultAction=function(e,t,n){},t.prototype.attachEvents=function(e){var t=e,n=t.elmInput,i=t.elmUpArrow,r=t.elmDownArrow;Ie.z.get_instance().registerHandler(me.d.focus,n,o.i(this,this.OnFocus,"OnFocus")),Ie.z.get_instance().registerHandler(me.d.blur,n,o.i(this,this.OnBlur,"OnBlur")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyDown,n,o.i(this,this.onKeyDown,"onKeyDown")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyPress,n,o.i(this,this.OnKeyPress,"OnKeyPress")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyUp,n,o.i(this,this.onKeyUp,"onKeyUp")),Ie.z.get_instance().registerHandler(me.d.change,n,o.i(this,this.OnChange,"OnChange")),ye.p.get_instance().registerHandler(me.d.mouseUp,n,o.i(this,this.OnInputMouseUp,"OnInputMouseUp")),lr.z.get_instance().registerHandler(me.d.pointerDown,i,o.i(this,this.OnArrowPointerDown,"OnArrowPointerDown")),lr.z.get_instance().registerHandler(me.d.pointerDown,r,o.i(this,this.OnArrowPointerDown,"OnArrowPointerDown")),lr.z.get_instance().registerHandler(me.d.pointerUp,i,o.i(this,this.OnArrowPointerUp,"OnArrowPointerUp")),lr.z.get_instance().registerHandler(me.d.pointerUp,r,o.i(this,this.OnArrowPointerUp,"OnArrowPointerUp")),Yt.v.get_instance().registerHandler(me.d.touchMove,i,o.i(this,this.onArrowTouchMove,"onArrowTouchMove")),Yt.v.get_instance().registerHandler(me.d.touchMove,r,o.i(this,this.onArrowTouchMove,"onArrowTouchMove")),Yt.v.get_instance().registerHandler(me.d.touchEnd,i,o.i(this,this.onArrowTouchEnd,"onArrowTouchEnd")),Yt.v.get_instance().registerHandler(me.d.touchEnd,r,o.i(this,this.onArrowTouchEnd,"onArrowTouchEnd"))},t.prototype.OnFocus=function(t){return e.prototype.OnFocus.call(this,t),fr.n.ensureCSSClassOnElement(this.get_SpinnerDom().elmControl,"cui-spn-focus"),this.get_control().get_enabled()&&bt.g.selectAllTextInInput(this.get_SpinnerDom().elmInput),this._mouseupOnTextboxSinceFocus=!1,!1},t.prototype.OnBlur=function(t){return e.prototype.OnBlur.call(this,t),fr.n.removeCSSClassFromElement(this.get_SpinnerDom().elmControl,"cui-spn-focus"),!1},t.prototype.onKeyDown=function(e){var t=!1;if(!_r.n.isNullOrUndefined(e.innerEvent)&&!_r.n.isNullOrUndefined(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,i=e.innerEvent.keyCode,r=n.shiftKey;i===Sys.UI.Key.up||i===Sys.UI.Key.down?(this.get_root().isCurrentModalController(this.get_control())||this.StartSpin(i===Sys.UI.Key.up,e.get_inputSource()),t=!0):i===Sys.UI.Key.enter?(this.commitPendingChange(),o.r(Qr.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),t=!0):i===Sys.UI.Key.tab?(this.commitPendingChange(),o.r(Qr.Ribbon,this.get_root())&&(t=this.get_root().wrapKeyboardFocus(this.get_displayedComponent().get_elementInternal(),!r))):i===Sys.UI.Key.esc?(this.ResetInputToPreviousValue(),o.r(Qr.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),t=!0):i!==Sys.UI.Key.backspace&&i!==Sys.UI.Key.del||(t=!this.get_control().get_enabled())}return t},t.prototype.OnKeyPress=function(e){return!this.get_control().get_enabled()},t.prototype.onKeyUp=function(e){return this.DeactivateElementFromKeyboard(),!1},t.prototype.OnChange=function(e){return this.commitPendingChange(),!1},t.prototype.OnInputMouseUp=function(e){return!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0)},t.prototype.OnArrowPointerDown=function(e){var t=!1,n=!0;if(2===e.get_inputSource()&&(n=!e.get_mouseButton()),n){var i=e.get_sourceElement(),r=i===this.get_SpinnerDom().elmUpArrow||i===this.get_SpinnerDom().elmUpArrowImageContainer||i===this.get_SpinnerDom().elmUpArrowImage;this.StartSpin(r,e.get_inputSource()),t=!0}return t},t.prototype.OnArrowPointerUp=function(e){return this.deactivateElement(e)},t.prototype.onArrowTouchMove=function(e){return this.OnActivePointerMove(e)},t.prototype.onArrowTouchEnd=function(e){return this.deactivateElement(e)},t.prototype.IncDecValue=function(e){if(this.get_control().get_enabled()){var t=!1;if(!this._isSpecialText){var n=this.GetIncDecStartingValue(e),i=e?n+this._unit.get_step():n-this._unit.get_step();i=Math.min(i,this._unit.get_max()),(i=Math.max(i,this._unit.get_min()))!==this._numericalValue&&(this.CommitNumericalValue(i,this._unit),this.get_root().executeCommand(this.get_Properties().Command,this.get_stateProperties(),this.get_displayedComponent(),0,!1),t=!0)}if(!t){var r=this.get_Properties().SpinCommand,o=this.get_stateProperties();o.Increment=e,_r.n.isNullOrUndefined(r)||this.get_root().executeCommand(r,o,this.get_displayedComponent(),0,!1)}}},t.prototype.GetIncDecStartingValue=function(e){var t=Math.pow(10,L.AFrameworkApplication.get_numberFormat().numberDecimalDigits),n=Math.round(this._numericalValue*t),i=Math.round(this._unit.get_step()*t),r=n/i;return(r=e?Math.floor(r):Math.ceil(r))*i/t},t.prototype.StartSpin=function(e,t){if(this.get_control().get_enabled()){this.commitPendingChange();var n=e?this.get_SpinnerDom().elmUpArrow:this.get_SpinnerDom().elmDownArrow;switch(t){case 2:case 3:this._spinningUp=e,this.ActivateElement(n);break;case 1:this._spinningUp=e,this.ActivateElementFromKeyboard(n)}}},t.prototype.StopSpin=function(){this.CancelPendingDelaySpin(),this.CancelRepeatSpin()},t.prototype.DelaySpin=function(){-1===this._pendingDelaySpinTimeoutId&&(this._pendingDelaySpinTimeoutId=window.setTimeout(o.i(this,this.RepeatSpin,"RepeatSpin"),t.incDecRepeatDelay))},t.prototype.CancelPendingDelaySpin=function(){var e=this;fr.n.cancelPendingTimeout((0,g.m)((function(){return e._pendingDelaySpinTimeoutId}),(function(t){return e._pendingDelaySpinTimeoutId=t})))},t.prototype.RepeatSpin=function(){this.CancelPendingDelaySpin(),-1===this._repeatSpinIntervalId&&(this.Spin(),this._repeatSpinIntervalId=window.setInterval(o.i(this,this.Spin,"Spin"),t.incDecRepeatFrequency))},t.prototype.CancelRepeatSpin=function(){var e=this;fr.n.cancelInterval((0,g.m)((function(){return e._repeatSpinIntervalId}),(function(t){return e._repeatSpinIntervalId=t})))},t.prototype.Spin=function(){this.IncDecValue(this._spinningUp)},t.prototype.ActivateElementFromKeyboard=function(e){this.get_root().beginModal(this.get_control(),!1),fr.n.ensureCSSClassOnElement(e,cr.Control.activeClassName),this.Spin(),this.DelaySpin()},t.prototype.DeactivateElementFromKeyboard=function(){this.get_root().endModal(this.get_control(),!1),this.StopSpin(),fr.n.removeCSSClassFromElement(this.get_SpinnerDom().elmUpArrow,cr.Control.activeClassName),fr.n.removeCSSClassFromElement(this.get_SpinnerDom().elmDownArrow,cr.Control.activeClassName)},t.prototype.SetInputValue=function(e){this.get_SpinnerDom().elmInput.value!==e&&(this.get_SpinnerDom().elmInput.value=e)},t.prototype.ResetInputToPreviousValue=function(){this.SetInputValue(this.get_stateProperties()[So.Text])},t.prototype.SetCurrentValueToSpecialText=function(e){this.SetInputValue(e),this.get_stateProperties()[So.Text]=e,this._isSpecialText=!0},t.prototype.SetCurrentValueToNumber=function(e,t,n){this.SetInputValue(n),this.get_stateProperties()[So.Text]=n,this.get_stateProperties()[So.Number]=e,this.get_stateProperties()[So.UnitType]=t.get_type(),this._numericalValue=e,this._unit=t,this.get_SpinnerDom().elmInput.setAttribute(vt.t.ariaValueNowAttribute,n),this.get_SpinnerDom().elmInput.setAttribute(vt.t.ariaValueMinAttribute,String.format("{0}",t.get_min())),this.get_SpinnerDom().elmInput.setAttribute(vt.t.ariaValueMaxAttribute,String.format("{0}",t.get_max())),this._isSpecialText=!1},t.prototype.CommitTextValue=function(e){var t;if(this.IsSpecialText(e,(0,g.m)((function(){return t}),(function(e){return t=e}))))this.SetCurrentValueToSpecialText(t);else{var n=0,i=0;Rn.l.parseNumberAndUnitsFromString(e,this._validUnitTypes,L.AFrameworkApplication.get_numberFormat(),(0,g.m)((function(){return n}),(function(e){return n=e})),(0,g.m)((function(){return i}),(function(e){return i=e})));var r=this.UnitFromUnitType(i);!i&&_r.n.isNullOrUndefined(r)&&(r=this.UnitFromUnitType(this.get_stateProperties()[So.UnitType])),this.CommitNumericalValue(n,r)}},t.prototype.CommitNumericalValue=function(e,t){if(e=this.NormalizeNumber(e,t),isNaN(e)||_r.n.isNullOrUndefined(t))this.ResetInputToPreviousValue();else{var n=L.AFrameworkApplication.get_numberFormat(),i="";Rn.l.formatNumberToString(e,t.get_type(),n,(0,g.m)((function(){return i}),(function(e){return i=e})));var r=6===t.get_type()?n.numberGroupSeparator:n.percentGroupSeparator;i=i.replace(r,""),this.SetCurrentValueToNumber(e,t,i)}},t.prototype.IsSpecialText=function(e,t){var n=!1;t.val="",e=e.trim();var i=this.get_Spinner().get_validSpecialStrings();if(!_r.n.isNullOrUndefined(i))for(var r=0;r<i.length;r++)if(i[r].toLowerCase()===e.toLowerCase()){t.val=i[r],n=!0;break}return n},t.prototype.NormalizeNumber=function(e,t){return isNaN(e)||_r.n.isNullOrUndefined(t)?Number.NaN:t.normalizeNumber(e)},t.prototype.UnitFromUnitType=function(e){for(var t=null,n=this.get_Spinner().get_validUnits(),i=0;i<n.length;i++)if(n[i].get_type()===e){t=n[i];break}return t},t.prototype.UnitTypeArrayFromUnitArray=function(e){for(var t=e.length,n=new Array(t),i=0;i<t;i++)n[i]=e[i].get_type();return n},t.prototype.commitPendingChange=function(){if(this.get_control().get_enabled()){var e=this.get_stateProperties()[So.Text],t=this.get_SpinnerDom().elmInput.value;if(t!==e)this.CommitTextValue(t),this.get_stateProperties()[So.Text]!==e&&this.get_root().executeCommand(this.get_Properties().Command,this.get_stateProperties(),this.get_displayedComponent(),0,!1)}else this.ResetInputToPreviousValue()},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[So.Text],t=this.get_stateProperties()[So.Number],n=this.get_stateProperties()[So.UnitType],i=this.get_stateProperties()[So.MaxValue];if((2&this.pollForStateAndUpdateInternal(this.get_Properties().Command,this.get_Properties().QueryCommand,this.get_stateProperties()))>0){var r=this.get_stateProperties()[So.Text],o=this.get_stateProperties()[So.Number],a=this.get_stateProperties()[So.UnitType],l=this.get_stateProperties()[So.MaxValue];l!==i&&(this.UnitFromUnitType(a).set_max(l),this.get_SpinnerDom().elmInput.setAttribute(vt.t.ariaValueMaxAttribute,String.format("{0}",l))),r!==e?""===r?this.SetCurrentValueToSpecialText(r):this.CommitTextValue(r):isNaN(o)||o===t&&a===n||this.CommitNumericalValue(o,this.UnitFromUnitType(a));var s=this.get_SpinnerDom().elmControl.title,u=fr.n.validateStringProperty(this.get_stateProperties()[So.Alt],this.get_Properties().Alt);u!==s&&(this.get_SpinnerDom().elmInput.title=u,this.get_SpinnerDom().elmUpArrow.title=u,this.get_SpinnerDom().elmDownArrow.title=u)}},t.prototype.ActiveElementStateChanged=function(t){e.prototype.ActiveElementStateChanged.call(this,t),t?(this.Spin(),this.DelaySpin()):this.StopSpin()},t.incDecRepeatDelay=500,t.incDecRepeatFrequency=50,t}(yr);(0,o.l)(bo,"ffa2b7d0$SpinnerBehavior",yr,[Co,ur]);var vo=n(7122),To=n(7313),Ao=function(e){function t(t){var n=this;return n._menuButtonEnabled=!0,n._buttonEnabled=!1,n=e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.get_SplitButton=function(){return this.get_control()},t.prototype.get_Properties$2=function(){return this.get_SplitButton().get_properties()},t.prototype.attachEvents=function(e){var t=e,n=t.elmControl,i=t.elmButtonPart,r=t.elmMenuLauncherPart;Ie.z.get_instance().registerHandler(me.d.focus,n,o.i(this,this.OnFocus,"OnFocus")),Ie.z.get_instance().registerHandler(me.d.blur,n,o.i(this,this.OnBlur,"OnBlur")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyDown,n,o.i(this,this.onKeyDown,"onKeyDown")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyUp,n,o.i(this,this.onKeyUp,"onKeyUp")),W.y.get_isInternetExplorerEdge()&&this.GetEdgeMajorVersion()<16&&(lr.z.get_instance().registerHandler(me.d.pointerDown,n,o.i(this,this.OnSplitbuttonPointerDownPointerUp,"OnSplitbuttonPointerDownPointerUp")),lr.z.get_instance().registerHandler(me.d.pointerUp,n,o.i(this,this.OnSplitbuttonPointerDownPointerUp,"OnSplitbuttonPointerDownPointerUp"))),lr.z.get_instance().registerHandler(me.d.pointerOver,i,o.i(this,this.onButtonPointerOver,"onButtonPointerOver")),lr.z.get_instance().registerHandler(me.d.pointerOut,i,o.i(this,this.onButtonPointerOut,"onButtonPointerOut")),lr.z.get_instance().registerHandler(me.d.pointerDown,i,o.i(this,this.OnButtonPointerDown,"OnButtonPointerDown")),lr.z.get_instance().registerHandler(me.d.pointerUp,i,o.i(this,this.OnButtonPointerUp,"OnButtonPointerUp")),Yt.v.get_instance().registerHandler(me.d.touchMove,i,o.i(this,this.onButtonTouchMove,"onButtonTouchMove")),Yt.v.get_instance().registerHandler(me.d.touchEnd,i,o.i(this,this.onButtonTouchEnd,"onButtonTouchEnd")),lr.z.get_instance().registerHandler(me.d.pointerDown,r,o.i(this,this.onMenuButtonPointerDown,"onMenuButtonPointerDown")),lr.z.get_instance().registerHandler(me.d.pointerOver,r,o.i(this,this.onMenuButtonPointerOver,"onMenuButtonPointerOver")),lr.z.get_instance().registerHandler(me.d.pointerOut,r,o.i(this,this.onMenuButtonPointerOut,"onMenuButtonPointerOut"))},t.prototype.doDefaultAction=function(t,n,i){if(Sys.UI.DomElement.containsCssClass(t,"cui-ctl-a1")){if(this._buttonEnabled){this.get_SplitButton().set_on(!this.get_SplitButton().get_on());var r=this.get_stateProperties();r.CommandValueId=this.get_control().getCommandValueId(),this.get_root().executeCommand(this.get_Properties$2().Command,r,this.get_displayedComponent(),n,!0,null,this.getTelemetryData(i))}}else this._menuButtonEnabled&&e.prototype.doDefaultAction.call(this,t,n,i)},t.prototype.onKeyUp=function(t){var n=t.innerEvent.keyCode;if(n===Sys.UI.Key.enter||n===Sys.UI.Key.space){var i=this.get_stateProperties();return i.CommandValueId=this.get_control().getCommandValueId(),this.get_root().executeCommand(this.get_Properties$2().Command,i,this.get_displayedComponent(),1,!0),!0}return e.prototype.onKeyUp.call(this,t)},t.prototype.pollForStateAndUpdate=function(){var e=this.get_root().pollForCommandState(this.get_Properties$2().Command,this.get_Properties$2().QueryCommand,this.get_stateProperties()),n=(1&e)>0,i=!0;_r.n.isNullOrUndefined(this.get_Properties$2().CommandMenuOpen)?i=n:i=(1&this.get_root().pollForCommandState(this.get_Properties$2().CommandMenuOpen,null,null))>0;if(i===this._menuButtonEnabled&&n===this._buttonEnabled&&(i||n)===this.get_control().get_enabled()||(this.get_control().set_enabled(i||n),n!==this._buttonEnabled&&this.onEnabledChangedForButton(n),i!==this._menuButtonEnabled&&this.onEnabledChangedForMenu(i),this._menuButtonEnabled=i,this._buttonEnabled=n),(2&e)>0){this.updateImage();var r=fr.n.validateStringProperty(this.get_stateProperties()[To.z.LabelText],this.get_Properties$2().LabelText);if(this.get_stateProperties()[To.z.ApplyLabelTextToControlOnly]?this.get_SplitButton().forEachSplitButtonComponentDom((function(e){e.elmControl.title=r,e.elmButtonPart.removeAttribute(t.TitleAttribute),e.elmMenuLauncherPart.removeAttribute(t.TitleAttribute)})):this.get_SplitButton().forEachSplitButtonComponentDom((function(e){e.elmButtonPart.title=r})),this.get_stateProperties()[To.z.EnsureControlRoleIsButton]&&this.get_SplitButton().forEachSplitButtonComponentDom((function(e){vt.t.setAriaAttribute(e.elmControl,vt.t.ariaRoleAttribute,vt.t.ariaButtonRole)})),!_r.n.isNullOrUndefined(this.get_stateProperties()[To.z.Visible]))this.updateVisibility()&&this.UpdateHtml()}this.get_SplitButton().setState(this.get_SplitButton().get_on()&&n)},t.prototype.UpdateHtml=function(){this.updateLabelText(),this.updateTooltip(),this.updateImage()},t.prototype.onEnabledChangedForMenu=function(e){this.get_SplitButton().forEachSplitButtonComponentDom((function(t){fr.n.setEnabledOnElement(t.elmMenuLauncherPart,e)})),this.RemoveControlHighlight(),this._menuButtonEnabled=e},t.prototype.onEnabledChangedForButton=function(e){this.get_SplitButton().forEachSplitButtonComponentDom((function(t){fr.n.setEnabledOnElement(t.elmButtonPart,e)})),this.RemoveControlHighlight(),this._buttonEnabled=e},t.prototype.RemoveControlHighlight=function(){var e=this.get_SplitButton().getDisplayedComponentElement();_r.n.isNullOrUndefined(e)||(fr.n.removeCSSClassFromElement(e.childNodes[0],t.FocusedPrimaryClass),fr.n.removeCSSClassFromElement(e.childNodes[0],t.FocusedSecondaryClass),fr.n.removeCSSClassFromElement(e.childNodes[1],t.FocusedPrimaryClass),fr.n.removeCSSClassFromElement(e.childNodes[1],t.FocusedSecondaryClass))},t.prototype.OnSplitbuttonPointerDownPointerUp=function(e){if(vo.j.getMsPointerTypeFromEvent(e.innerEvent))return!1;var t=!1;return e.eventName===me.d.pointerDown?t=this.OnButtonPointerDown(e):e.eventName===me.d.pointerUp&&(t=this.OnButtonPointerUp(e)),t},t.prototype.OnButtonPointerDown=function(e){var t=!1,n=e.get_inputSource();switch(n){case 3:this.ShouldUseFlyoutBehaviorOnTouch()?(this.doDefaultAction(this.get_displayedComponent().get_elementInternal(),n,e.innerEvent),t=!0):(this.ActivateElement(this.get_SplitButton().get_displayedButtonElement()),t=!0);break;case 2:e.get_mouseButton()||(this.ActivateElement(this.get_SplitButton().get_displayedButtonElement()),t=!0)}return t&&e.innerEvent.preventDefault(),!1},t.prototype.ShouldUseFlyoutBehaviorOnTouch=function(){var e=this.get_displayedComponent().get_displayMode();return"Small"===e||"Medium"===e||"Menu16"===e||"MenuTellMe"===e},t.prototype.OnButtonPointerUp=function(e){return this.deactivateElement(e)},t.prototype.onButtonTouchMove=function(e){return this.OnActivePointerMove(e)},t.prototype.onButtonTouchEnd=function(e){return this.deactivateElement(e)},t.prototype.OnFocus=function(t){return e.prototype.OnFocus.call(this,t),this.HighlightControl(!0,!0),!1},t.prototype.OnBlur=function(t){return e.prototype.OnFocus.call(this,t),this.RemoveControlHighlight(),!1},t.prototype.onButtonPointerOver=function(e){return this.get_control().get_enabled()&&this._buttonEnabled&&this.HighlightControl(!0,this.get_SplitButton().get_on()),!1},t.prototype.onButtonPointerOut=function(e){return this.get_control().get_enabled()&&this._buttonEnabled&&this.RemoveControlHighlight(),!1},t.prototype.onMenuButtonPointerDown=function(e){var t=!1;return 2===e.get_inputSource()&&e.get_mouseButton()||(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),t=!0),t&&e.innerEvent.preventDefault(),!1},t.prototype.onMenuButtonPointerOver=function(e){return this.get_control().get_enabled()&&this._menuButtonEnabled&&this.HighlightControl(this.get_SplitButton().get_on(),!0),!1},t.prototype.onMenuButtonPointerOut=function(e){return this.RemoveControlHighlight(),!1},t.prototype.HighlightControl=function(e,n){var i=this.get_control().getDisplayedComponentElement();_r.n.isNullOrUndefined(i)||(fr.n.ensureCSSClassOnElement(i.childNodes[0],e?t.FocusedPrimaryClass:t.FocusedSecondaryClass),fr.n.ensureCSSClassOnElement(i.childNodes[1],n?t.FocusedPrimaryClass:t.FocusedSecondaryClass))},t.prototype.GetEdgeMajorVersion=function(){var e=W.y.get_edgeVersion();if(e){var t=e.split(".");if(2===t.length)return parseInt(t[0])}return 0},t.FocusedPrimaryClass="cui-ctl-split-hovered-primary",t.FocusedSecondaryClass="cui-ctl-split-hovered-secondary",t.TitleAttribute="title",t}(zr);(0,o.l)(Ao,"be085ce9$SplitButtonBehavior",zr,[]);var Io=(0,o.y)("ec544466$ITextBoxBehavior"),wo=n(7503),xo=function(){function e(){}return e.Text="Text",e}();(0,o.l)(xo,"c5c7f1c5$TextBoxCommandProperties",null,[]);var Eo=function(e){function t(t){var n=e.call(this,t)||this;return n._mouseupOnTextboxSinceFocus=!1,n._inputFocused=!1,n._excelTableRenameEnabled=!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExcelTableRenameEnabled"),n}return(0,v.t)(t,e),t.prototype.get_TextBox=function(){return this.get_control()},t.prototype.get_TextBoxDom=function(){return this.get_TextBox().get_textBoxDom()},t.prototype.get_TBProperties=function(){return this.get_TextBox().get_controlProperties()},t.prototype.attachEvents=function(e){var t=e.elmInput;Ie.z.get_instance().registerHandler(me.d.focus,t,o.i(this,this.OnFocus,"OnFocus")),Ie.z.get_instance().registerHandler(me.d.blur,t,o.i(this,this.OnBlur,"OnBlur")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyDown,t,o.i(this,this.onKeyDown,"onKeyDown")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyPress,t,o.i(this,this.OnKeyPress,"OnKeyPress")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyUp,t,o.i(this,this.onKeyUp,"onKeyUp")),Ie.z.get_instance().registerHandler(me.d.change,t,o.i(this,this.OnChange,"OnChange")),ye.p.get_instance().registerHandler(me.d.mouseUp,t,o.i(this,this.OnMouseUp,"OnMouseUp"))},t.prototype.OnFocus=function(t){return e.prototype.OnFocus.call(this,t),this._inputFocused=!0,fr.n.ensureCSSClassOnElement(this.get_TextBoxDom().elmControl,"cui-tb-focus"),this.get_control().get_enabled()&&bt.g.selectAllTextInInput(this.get_TextBoxDom().elmInput),this._mouseupOnTextboxSinceFocus=!1,!1},t.prototype.OnBlur=function(t){return this._inputFocused=!1,e.prototype.OnBlur.call(this,t),fr.n.removeCSSClassFromElement(this.get_TextBoxDom().elmControl,"cui-tb-focus"),!1},t.prototype.onKeyDown=function(t){var n=e.prototype.onKeyDown.call(this,t);if(!_r.n.isNullOrUndefined(t.innerEvent)&&!_r.n.isNullOrUndefined(t.innerEvent.rawEvent)){var i=t.innerEvent.rawEvent,r=t.innerEvent.keyCode,a=i.shiftKey;r===Sys.UI.Key.tab?(this.commitPendingChange(),o.r(Qr.Ribbon,this.get_root())&&(n=this.get_root().wrapKeyboardFocus(this.get_displayedComponent().get_elementInternal(),!a))):r===Sys.UI.Key.enter?this._excelTableRenameEnabled&&(this.commitPendingChange(),o.r(Qr.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),n=!0):r===Sys.UI.Key.esc?(this.ResetInputToPreviousValue(),o.r(Qr.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),n=!0):r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?n=!this.get_control().get_enabled():t.get_commandKey()&&(wo.n.cancelEventNoPreventDefault(t.innerEvent),n=!1)}return n},t.prototype.OnKeyPress=function(e){return!this.get_control().get_enabled()},t.prototype.onKeyUp=function(e){return!1},t.prototype.OnChange=function(e){return this.commitPendingChange(),!1},t.prototype.OnMouseUp=function(e){return this.get_TextBoxDom().isEditable?!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0):(bt.g.selectAllTextInInput(this.get_TextBoxDom().elmInput),!0)},t.prototype.SetInputValue=function(e){this.get_TextBoxDom().elmInput.value!==e&&(this.get_TextBoxDom().elmInput.value=e)},t.prototype.ResetInputToPreviousValue=function(){this.SetInputValue(this.get_stateProperties()[xo.Text])},t.prototype.commitPendingChange=function(){if(this.get_control().get_enabled()&&this.get_TextBoxDom().isEditable){var e=this.get_stateProperties()[xo.Text],t=this.get_TextBoxDom().elmInput.value;t!==e&&(this.get_stateProperties()[xo.Text]=t,this.get_root().executeCommand(this.get_TBProperties().Command,this.get_stateProperties(),this.get_displayedComponent(),0,!1))}else this.ResetInputToPreviousValue()},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[xo.Text];if((2&this.pollForStateAndUpdateInternal(this.get_TBProperties().Command,this.get_TBProperties().QueryCommand,this.get_stateProperties()))>0&&!this._inputFocused){var t=this.get_stateProperties()[xo.Text];t!==e&&this.SetInputValue(t)}},t}(yr);(0,o.l)(Eo,"9f6e77e5$TextBoxBehavior",yr,[Io,ur]);var Fo=n(9475),Po=function(e){function t(t){return e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.get_ToggleButton=function(){return this.get_control()},t.prototype.get_Properties=function(){return this.get_control().get_controlProperties()},t.prototype.doDefaultAction=function(e,t,n){var i=this;this.get_control().get_enabled()&&(fr.n.isFalse(this.get_Properties().TogglesWhenExecuted)||this.Toggle(),this.get_stateProperties().CommandValueId=this.get_ToggleButton().getCommandValueId(),this.get_stateProperties().MenuItemId=this.get_ToggleButton().getMenuItemId(),this.get_stateProperties().SourceControlId=this.get_control().get_id(),this.get_root().executeCommand(this.get_Properties().Command,this.get_stateProperties(),this.get_displayedComponent(),t,!fr.n.isFalse(this.get_Properties().CloseMenuWhenExecuted),(function(e){fr.n.isTrue(i.get_Properties().UpdateHtmlPostToggle)&&(32===e?i.ToggleUx():i.ToggleState())}),this.getTelemetryData(n)))},t.prototype.ToggleState=function(){var e=!this.get_stateProperties()[gr.e.On];this.get_stateProperties()[gr.e.On]=e},t.prototype.ToggleUx=function(){var e=this.get_stateProperties()[gr.e.On];this.get_ToggleButton().setState(e),(this.get_ToggleButton().get_useCheckMark()&&this.get_ToggleButton().get_useUncheckedImage()||fr.n.isTrue(this.get_Properties().UpdateHtmlPostToggle))&&this.UpdateHtml()},t.prototype.Toggle=function(){this.ToggleState(),fr.n.isTrue(this.get_Properties().UpdateHtmlPostToggle)||this.ToggleUx()},t.prototype.onKeyDown=function(t){var n=e.prototype.onKeyDown.call(this,t);if(!n&&!_r.n.isNullOrUndefined(t.innerEvent)&&this.get_parentMenu()){var i=t.innerEvent.keyCode;i!==Sys.UI.Key.enter&&i!==Sys.UI.Key.space||t.innerEvent.preventDefault()}return n},t.prototype.pollForStateAndUpdate=function(){(_r.n.isNullOrUndefined(this.get_Properties().MenuItemId)||(this.get_stateProperties().MenuItemId=this.get_Properties().MenuItemId),(2&this.pollForStateAndUpdateInternal(this.get_Properties().Command,this.get_Properties().QueryCommand,this.get_stateProperties()))>0)&&(this.updateVisibility()&&this.UpdateHtml())},t.prototype.UpdateHtml=function(){this.get_ToggleButton().setState(this.get_stateProperties()[gr.e.On]),this.updateDisplayMode(fr.n.validateStringProperty(this.get_stateProperties()[gr.e.DisplayMode],"")),this.updateLabelText(),this.updateImage(),this.UpdateLargeMenu(),gr.e.Alt in this.get_stateProperties()&&this.updateTooltip()},t.prototype.UpdateLargeMenu=function(){var e=this.get_controlComponentDomCache().get_largeMenu();if(e&&e.elmDescription){var t=fr.n.validateStringProperty(this.get_stateProperties()[gr.e.Description],this.get_Properties().Description);if(t!==e.elmDescription.innerText&&(e.elmDescription.innerText=t,e.elmLabel&&!o.r(Fo.Jewel,this.get_root()))){var n=!_r.n.isNullOrEmptyString(t);fr.n.toggleCSSClassOnElement(e.elmLabel,"UIFontBold",n),fr.n.toggleCSSClassOnElement(e.elmLabel,"cui-ctl-mediumlabel-nodescription",!n)}}},t.prototype.attachEvents=function(e){var t=e.elmControl;Ie.z.get_instance().registerHandler(me.d.focus,t,o.i(this,this.OnFocus,"OnFocus")),Ie.z.get_instance().registerHandler(me.d.blur,t,o.i(this,this.OnBlur,"OnBlur")),lr.z.get_instance().registerHandler(me.d.pointerOver,t,o.i(this,this.OnPointerOver,"OnPointerOver")),lr.z.get_instance().registerHandler(me.d.pointerOut,t,o.i(this,this.OnPointerOut,"OnPointerOut")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyDown,t,o.i(this,this.onKeyDown,"onKeyDown")),Me.KeyInputManager.get_instance().registerHandler(me.d.keyUp,t,o.i(this,this.onKeyUp,"onKeyUp")),lr.z.get_instance().registerHandler(me.d.pointerDown,t,o.i(this,this.onPointerDown,"onPointerDown")),lr.z.get_instance().registerHandler(me.d.pointerUp,t,o.i(this,this.OnPointerUp,"OnPointerUp")),Xt.s.get_instance().registerHandler(me.d.click,t,o.i(this,this.OnClick,"OnClick")),Yt.v.get_instance().registerHandler(me.d.touchMove,t,o.i(this,this.OnTouchMove,"OnTouchMove")),Yt.v.get_instance().registerHandler(me.d.touchEnd,t,o.i(this,this.OnTouchEnd,"OnTouchEnd"))},t}(yr);(0,o.l)(Po,"dc4c1a89$ToggleButtonBehavior",yr,[]);var Do=function(){function e(e){this._factoryMethods=null,this._commitChangeFixEnabled=!1,this._commitChangeFixEnabled=e,this._factoryMethods={Button:function(e){return new Cr(e)},FileMenuButton:function(e){return new Cr(e)},ColorPicker:function(e){return new vr(e)},ComboBox:function(e){return new Jr(e)},ContextMenuControl:function(e){return new Xr(e)},ContextMenuLauncher:function(e){return new Xr(e)},DialogMenuLauncher:function(e){return new Yr(e)},DropDown:function(e){return new qr(e)},FlyoutAnchor:function(e){return new eo(e)},GalleryButton:function(e){return new no(e)},StatefulColorFlyoutAnchor:function(e){return new eo(e)},JewelMenuLauncher:function(e){return new lo(e)},Label:function(e){return new uo(e)},Placeholder:function(e){return new yr(e)},SearchBox:function(e){return new _o(e)},Separator:function(e){return new yr(e)},SplitButton:function(e){return new Ao(e)},StatefulColorSplitButton:function(e){return new Ao(e)},StatefulImageSplitButton:function(e){return new Ao(e)},TextBox:function(e){return new Eo(e)},ToggleButton:function(e){return new Po(e)}}}return e.prototype.enableInsertTable=function(){this._factoryMethods[cr.Control.insertTableControlType]=function(e){return new ao(e)}},e.prototype.enableSlider=function(){this._factoryMethods[cr.Control.sliderControlType]=function(e){return new fo(e)}},e.prototype.enableSpinner=function(){this._factoryMethods[cr.Control.spinnerControlType]=function(e){return new bo(e)}},e.prototype.getBehaviorForControl=function(e){var t=this._factoryMethods[e.get_controlType()],n=t?t(e):null;return n&&this._commitChangeFixEnabled&&n.enableCommitChangeFix(),n},e.get_instance=function(){return e._instance||(e._instance=new e(!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CUICommitChangeFixIsEnabled")))},e._instance=null,e}();(0,o.l)(Do,"11154dde$ControlBehaviorFactory",null,[sr]);var Ro=(0,o.y)("f9bfcfa3$IRootUser"),Mo=n(9132),ko=n(1521),No=function(e){function t(t,n,i,r){var o=this;return o._launcherElement=null,o.x=0,o.y=0,o.launcherHeight=0,o.launcherWidth=0,o._rootUser=null,(o=e.call(this,t,n,i,r)||this).launcherHeight=0,o.launcherWidth=0,o.addDisplayMode("Menu"),o.set_enabled(!0),o}return(0,v.t)(t,e),t.prototype.get_x=function(){return this.x},t.prototype.get_y=function(){return this.y},t.prototype.get_launcherHeight=function(){return this.launcherHeight},t.prototype.get_launcherWidth=function(){return this.launcherWidth},t.prototype.get_rootUser=function(){return this._rootUser},t.prototype.set_rootUser=function(e){return this._rootUser=e,e},t.prototype.get_controlType=function(){return"DialogMenuLauncher"},t.prototype.setInitialAriaMenuLauncherAttributes=function(e){},t.prototype.updateAriaMenuLauncherAttributes=function(e,t){},t.prototype.getCommandPopulateProperties=function(){var e={};return e.MenuId=this.get_id(),e.DialogMoveCommand=this.get_Properties$2().DialogMoveCommand,e.DialogCloseCommand=this.get_Properties$2().DialogCloseCommand,e},t.prototype.LaunchDialogMenuAtLauncher=function(e,t){this.x=e.x,this.y=e.y,this.launcherHeight=e.height,this.launcherWidth=e.width,this.launchMenu(t)},t.prototype.createComponentDomForDisplayMode=function(e){return this._launcherElement=fr.n.createElement("span"),new ko.d(e,this._launcherElement)},t.prototype.get_Properties$2=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.constructClonedMenuLauncher=function(e,n,i){return new t(e,this.get_id(),n,i)},t}(hr.MenuLauncher);(0,o.l)(No,"f52f4495$DialogMenuLauncher",hr.MenuLauncher,[]);var Lo=n(3930),Bo=function(e){function t(t,n){var i=this;return i._activeMenu=null,i=e.call(this,t,n)||this}return(0,v.t)(t,e),t.prototype.get_activeMenu=function(){return this._activeMenu},t.prototype.get_dialogMenuRootProperties=function(){return this.get_properties()},t.prototype.get_rootType=function(){return 20},t.prototype.refreshInternal=function(){e.prototype.refreshInternal.call(this),_r.n.isNullOrUndefined(this.get_elementInternal())&&this.ensureDOMElement(),this.set_elementInternal(fr.n.removeChildNodes(this.get_elementInternal())),this.appendChildrenToElement(this.get_elementInternal()),this.set_dirty(!1)},t.prototype.ensureCorrectChildType=function(e){if(!o.r(Lo.z,e))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot")},t.prototype.createDialogMenu=function(e,t,n,i){var r=new Mr.Menu(this,t,n,i,null);e||(e={}),e.CommandMenuOpen=this.get_dialogMenuRootProperties().CommandMenuOpen,e.CommandMenuClose=this.get_dialogMenuRootProperties().CommandMenuClose;var o=new No(this,t,e,r);this.get_createdControls()[t]=o;var a=new Lo.z(this,"dock"+t);a.addChild(o.createComponentForDisplayMode("Menu")),this.addChild(a),this.refresh()},t.prototype.showDialogMenuAt=function(e,t,n,i){var r=this.get_createdControls()[e];if(_r.n.isNullOrUndefined(r))throw Error.create('The dialog menu "'+e+'" does not exist');r.LaunchDialogMenuAtLauncher(new Sys.UI.Bounds(t,n,0,0),i),this._activeMenu=r.get_menu()},t.prototype.closeDialogMenu=function(e){var t=this.get_createdControls()[e];_r.n.isNullOrUndefined(t)||(t.CloseMenu(),this._activeMenu=null)},t.prototype.OnMenuStackCleared=function(){this._activeMenu=null},t.prototype.dispose=function(){var t=this.get_createdControls();for(var n in t){({key:n,value:t[n]}).value.dispose()}e.prototype.dispose.call(this)},t}(Mo.w);(0,o.l)(Bo,"ec650d9$DialogMenuRoot",Mo.w,[]);var Oo=function(){return function(){this.DivSyndicated=null,this.ImageDownArrow=null,this.ImageDownArrowClass=null,this.ImageDownArrow8by8=null,this.ImageDownArrow8by8Class=null,this.ImageSideArrow=null,this.ImageSideArrowClass=null,this.ImageUpArrow=null,this.ImageUpArrowClass=null,this.ImageUpArrow8by8=null,this.ImageUpArrow8by8Class=null,this.ImageCheckMark=null,this.ImageCheckMarkClass=null,this.ImageUncheckMark=null,this.ImageUncheckMarkClass=null,this.ImageCollapsedArrow=null,this.ImageCollapsedArrowClass=null,this.ImageExpandedArrow=null,this.ImageExpandedArrowClass=null,this.ImageSpinner=null,this.TextDirection=null,this.LabelText=null}}();(0,o.l)(Oo,"da10b77$RootProperties",null,[]);var Uo=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t}(Oo);(0,o.l)(Uo,"16e6e758$StandaloneRootProperties",Oo,[]);var Ho=function(e){function t(){var t=e.call(this)||this;return t.CommandMenuOpen=null,t.CommandMenuClose=null,t}return(0,v.t)(t,e),t}(Uo);(0,o.l)(Ho,"25ccd8d8$DialogMenuRootProperties",Uo,[]);var Go=function(){function e(){this._root=null;var t=new Ho;t.ImageSideArrow=L.AFrameworkApplication.get_imageClusterPath(),t.ImageSideArrowClass=Ct.ImageClusteringHelper.getImageClass("SubmenuFlyoutArrow_13x13x32"),t.TextDirection=L.AFrameworkApplication.get_isRtl()?"rtl":"ltr",this._root=new Bo(e.DialogMenuRootId,t),this._root.set_rootUser(this),this._root.refresh(),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(Fe.b.populateDialogMenu,Ue.m.frame,o.i(this,this.PopulateDialogMenu,"PopulateDialogMenu"),96)}return e.prototype.get_theRoot=function(){return this._root},e.prototype.executeRootCommand=function(e,t,n,i,r){void 0===i&&(i=null),void 0===r&&(r=null);var o=parseInt(e),a=L.AFrameworkApplication.get_theActionManager();n&&(a.set_commandLocation(n.CommandLocation),a.set_invocationMethod(n.InvocationMethod));var l=t,s=a.processActionWithData(o,2,l,r);return this._root.refresh(),32===s},e.prototype.isRootCommandEnabled=function(e){if(!e)return!0;var t=parseInt(e);return 32===L.AFrameworkApplication.get_theActionManager().processAction(t,1)},e.prototype.PollForStateAndUpdateInternal=function(){this.get_theRoot().get_root().pollForStateAndUpdate()},e.prototype.createDialogMenu=function(e,t,n){var i={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};i.DialogMoveCommand=t,i.DialogCloseCommand=n,this.get_theRoot().createDialogMenu(i,e,"","")},e.prototype.showDialogMenuAt=function(e,t,n,i){this.get_theRoot().showDialogMenuAt(e,t,n,i)},e.prototype.closeDialogMenu=function(e){this.get_theRoot().closeDialogMenu(e)},e.prototype.PopulateDialogMenu=function(e,t,n,i,r){if(1===n)return 32;var o=r,a=new Sys.StringBuilder;a.append('<Menu Id="dialogMenu">'),a.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');var l=o.DialogMoveCommand;a.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',l,CommonUIStrings.l_DialogMove));var s=o.DialogCloseCommand;return a.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',s,CommonUIStrings.l_DialogClose)),a.append("</Controls></MenuSection>"),a.append("</Menu>"),o.PopulationXML=a.toString(),32},e.prototype.dispose=function(){this._root&&(this._root.dispose(),this._root=null)},e.DialogMenuRootId="DialogMenuRootId",e}();(0,o.l)(Go,"55bc7ccd$DialogMenuRootUser",null,[Ro,Sys.IDisposable,tr.x]);var Wo=function(){function e(e,t,n){this._target=null,this._moveIcon=null,this._startingPosition=null,this._currentPosition=null,this._inMoveMode=!1,this._shouldExit=!1,this._isRTL=!1,this._frameElement=null,this._keyInputManager=null,this._pointerInputManager=null,this._frameElement=e,this._keyInputManager=t,this._pointerInputManager=n,this._isRTL=L.AFrameworkApplication.get_isRtl()}return e.prototype.get_inMoveMode=function(){return this._inMoveMode},e.prototype.enterMoveMode=function(e){e?(this._target=e,this._inMoveMode=!0,this._shouldExit=!1,this._keyInputManager.capture(o.i(this,this.KeyEventHandler,"KeyEventHandler"),null),this._pointerInputManager.registerHandler(me.d.pointerDown,this._frameElement,o.i(this,this.PointerDownHandler,"PointerDownHandler")),this._moveIcon||this.CreateMoveIcon(),this._target.appendChild(this._moveIcon),this.InitializeCurrentPosition()):S.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")},e.prototype.exitMoveMode=function(){this._inMoveMode=!1,this._currentPosition=null,this._startingPosition=null,this.RemoveMoveIcon(),this.ReleaseHandlers(),this._target=null},e.prototype.ReleaseHandlers=function(){this._keyInputManager.releaseCapture(),this._pointerInputManager.unregisterHandler(me.d.pointerDown,this._frameElement,o.i(this,this.PointerDownHandler,"PointerDownHandler"))},e.prototype.InitializeCurrentPosition=function(){if(this._target.style.left.endsWith("px")&&this._target.style.right.endsWith("px"))this._currentPosition=new Sys.UI.Point(qi.o.parseIntDefaultZero(this._isRTL?this._target.style.right:this._target.style.left),qi.o.parseIntDefaultZero(this._target.style.top));else{var e=this._isRTL?this._frameElement.offsetWidth-(this._target.offsetLeft+this._target.offsetWidth+qi.o.parseIntDefaultZero(this._target.style.marginRight)):this._target.offsetLeft-qi.o.parseIntDefaultZero(this._target.style.marginLeft),t=this._target.offsetTop-qi.o.parseIntDefaultZero(this._target.style.marginTop);this.SetStylePosition(e,t),this._currentPosition=new Sys.UI.Point(e,t)}this._startingPosition=this._currentPosition},e.prototype.CreateMoveIcon=function(){this._moveIcon=Ct.ImageClusteringHelper.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")},e.prototype.RemoveMoveIcon=function(){this._moveIcon.parentNode===this._target&&this._target.removeChild(this._moveIcon)},e.prototype.KeyEventHandler=function(t){if(!this.get_inMoveMode())return!1;if(t.innerEvent.preventDefault(),t.eventName===me.d.keyDown){var n=t.innerEvent.ctrlKey?e.PIXEL_SPEED_SLOW:e.PIXEL_SPEED,i=void 0;switch(t.innerEvent.keyCode){case Re.v.vK_UpArrow:this.MoveElement(0,-1*n);break;case Re.v.vK_DownArrow:this.MoveElement(0,1*n);break;case Re.v.vK_LeftArrow:i=this._isRTL?1:-1,this.MoveElement(i*n,0);break;case Re.v.vK_RightArrow:i=this._isRTL?-1:1,this.MoveElement(i*n,0);break;case Re.v.vK_Esc:this.MoveElementTo(this._startingPosition.x,this._startingPosition.y),this._shouldExit=!0;break;case Re.v.vK_Enter:this._shouldExit=!0}}return t.eventName===me.d.keyUp&&this._shouldExit&&this.exitMoveMode(),!0},e.prototype.PointerDownHandler=function(e){return!!this.get_inMoveMode()&&(e.innerEvent.preventDefault(),this.exitMoveMode(),!0)},e.prototype.MoveElement=function(e,t){var n=this._currentPosition.x+e,i=this._currentPosition.y+t;this.MoveElementTo(n,i)},e.prototype.MoveElementTo=function(e,t){var n=this.adjustPositionForAppFrameBounds(e,t);this.SetStylePosition(n.x,n.y),this._currentPosition=n},e.prototype.SetStylePosition=function(e,t){this._isRTL?this._target.style.right=e+"px":this._target.style.left=e+"px",this._target.style.top=t+"px"},e.prototype.adjustPositionForAppFrameBounds=function(e,t){var n=this._isRTL?qi.o.parseIntDefaultZero(this._target.style.marginRight):qi.o.parseIntDefaultZero(this._target.style.marginLeft),i=this._frameElement.offsetWidth-this._target.offsetWidth-n,r=Math.min(Math.max(-n,e),i),o=qi.o.parseIntDefaultZero(this._target.style.marginTop),a=this._frameElement.offsetHeight-this._target.offsetHeight-o,l=Math.min(Math.max(-o,t),a);return new Sys.UI.Point(r,l)},e.PIXEL_SPEED=10,e.PIXEL_SPEED_SLOW=1,e}();(0,o.l)(Wo,"48811150$KeyMoveAdapter",null,[nr.o]);var Vo=n(634),$o=n(8310),zo=n(7531),Ko=n(2839),qo=function(e){function t(){var t=e.call(this)||this;return t.DisplayName=null,t.PersonaId=null,t}return(0,v.t)(t,e),t}(Ko.k);(0,o.l)(qo,"4b732a51$PersonaButtonProps",Ko.k,[]);var jo=function(){function e(){}return e.prototype.createProps=function(t,n){if(t&&!(t.length<1)&&n){var i=(0,U.m)(new zo.x,{ExternalId:e.MENU_SECTION_ID,ControlList:[]});t.length<=2?this.CreatePersonaButtonProps(t,i.ControlList,!1):this.CreateFlyoutAnchorProps(t,i.ControlList),n.push(i)}},e.prototype.CreateFlyoutAnchorProps=function(t,n){var i=(0,U.m)(new Vo.b,{ExternalId:e.FLYOUT_ANCHOR_ID,LabelText:this.GetFlyoutLabel(t),Menu:(0,U.m)(new $o.b,{ExternalId:e.SUBMENU_SECTION_ID,UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(n,i);var r=(0,U.m)(new zo.x,{Title:"",ControlList:[]});Array.add(i.Menu.MenuSectionList,r),this.CreatePersonaButtonProps(t,r.ControlList,!0)},e.prototype.CreatePersonaButtonProps=function(t,n,i){for(var r=0;r<t.length;r++){var o=(0,U.m)(new qo,{ExternalId:String.format(e.PERSONA_BUTTON_ID,r),Command:"336231556",DisplayName:t[r].get_userName(),LabelText:this.GetPersonaLabel(t[r],i),ImageBackColor:t[r].get_color(),PersonaId:t[r].get_email()});Array.add(n,o)}},e.prototype.GetFlyoutLabel=function(e){return String.format(CommonUIStrings.l_PresenceMenuSectionTitle,e[0].get_userName(),e.length-1)},e.prototype.GetPersonaLabel=function(e,t){return t?e.get_userName():String.format(CommonUIStrings.l_PersonaButtonTitle,e.get_userName())},e.MENU_SECTION_ID="msPresenceOuter",e.SUBMENU_SECTION_ID="msPresenceInner",e.FLYOUT_ANCHOR_ID="ContextCoauthors",e.PERSONA_BUTTON_ID="CoauthorPersona_{0}",e}();(0,o.l)(jo,"adc1584e$PresenceContextMenuSectionBuilder",null,[rr]);var Qo=n(1493),Jo=n(7374),Xo=function(){function e(){}return e.prototype.get_name=function(){return"CUI.Behavior"},e.prototype.configure=function(e){L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AccessibleMovingDialogsEnabled")&&(e.register(tr.x).singleInstance().usingFactory((function(){return new Go})),e.register(nr.o).singleInstance().usingFactory((function(){return new Wo(L.AFrameworkApplication.get_activeFrame().getDOMElement(),Me.KeyInputManager.get_instance(),lr.z.get_instance())}))),e.register(Jo.f).as(ir.b).singleInstance().usingFactory((function(){return Jo.f.get_instance()})),e.register(rr).singleInstance().usingFactory((function(){return new jo}))},e.prototype.init=function(){Qo.b.set_controlBehaviorFactory(Do.get_instance());for(var e=Jo.f.get_instance().get_roots(),t=0;t<e.length;++t){var n=(0,y.e)(or.s,e[t]);n&&n.ensureBehaviorAttached()}ar.r.get_instance().setAppInitializationStatus(6)},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e,5)},e}();(0,o.l)(Xo,"ea3e282c$CuiBehaviorPackage",null,[s.u,u.s]);var Yo,Zo,ea=n(4571),ta=(0,o.y)("c43fc544$IEditingViewOnAfterValidateEventsConsolidator"),na=n(61),ia=n(3171),ra=n(9464),oa=(0,o.y)("af83aa6f$IStructuralContentDetailsProvider"),aa=n(1025),la=n(1985),sa=n(5905),ua=n(4730),ca=n(5546),da=function(){function e(){this.$$pf_ProviderKey=null,this.$$pf_ContentObject=null,this.contentId=null,this.description=null}return e.prototype.get_providerKey=function(){return this.$$pf_ProviderKey},e.prototype.set_providerKey=function(e){return this.$$pf_ProviderKey=e,e},e.prototype.get_contentObject=function(){return this.$$pf_ContentObject},e.prototype.set_contentObject=function(e){return this.$$pf_ContentObject=e,e},e}();(0,o.l)(da,"e8873e7$StructuralContentDetails",null,[ca.s]),function(e){e[e.entering=0]="entering",e[e.leaving=1]="leaving"}(Yo||(Yo={})),(0,o.h)("52c832c7$ContextTransition",Yo),function(e){e[e.cp=0]="cp",e[e.word=1]="word",e[e.line=2]="line",e[e.paragraph=3]="paragraph"}(Zo||(Zo={})),(0,o.h)("3a70e751$ContextTransitionLevel",Zo);var ga=n(4841),pa=n(9986),ha=n(654),_a=function(){function e(e,t,n){this._editingViewOnAfterValidateEventsConsolidator=null,this._selectionManager=null,this._ariaNotifier=null,this._lastSelectionContext=null,this._registeredCpContentDetailsProviders=null,this._oldCpContentPerProvider=null,this._registeredStructuralContentDetailsProviders=null,this._oldStructuralContentPath=null,this._ariaNotifier=e,this._editingViewOnAfterValidateEventsConsolidator=t,this._selectionManager=n,this.Init()}return e.prototype.Init=function(){this._editingViewOnAfterValidateEventsConsolidator.registerHandler(o.i(this,this.handleEditingViewUpdatesSafe,"handleEditingViewUpdatesSafe")),this._registeredCpContentDetailsProviders=new aa.e(String,ra.q),this._oldCpContentPerProvider=new aa.e(String,ua.e),this._registeredStructuralContentDetailsProviders=new aa.e(String,oa),this._oldStructuralContentPath=new la.o(da)},e.prototype.registerCpContentDetailsProvider=function(e){this._registeredCpContentDetailsProviders.add(e.get_key(),e)},e.prototype.registerStructuralContentDetailsProvider=function(e){this._registeredStructuralContentDetailsProviders.add(e.get_key(),e)},e.prototype.handleEditingViewUpdatesSafe=function(e,t){try{this.handleEditingViewUpdates(e,t)}catch(e){var n=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",e.message,e.stack);S.ULS.sendTraceTag(5285580,334,10,n)}},e.prototype.handleEditingViewUpdates=function(t,n){var i;if(e.TryGetValidSelectionContext(this._selectionManager.get_selectionCollection().get_currentSelection(),(0,g.m)((function(){return i}),(function(e){return i=e})))){var r=e.GetContextTransitionLevels(t,this._lastSelectionContext,i);this.ProcessContextChanged(r,i),this._lastSelectionContext=i}},e.prototype.ProcessContextChanged=function(t,n){var i,r=this.getAllAccessibleContextChanges(t,n);e.TryGetNewNotification(r,(0,g.m)((function(){return i}),(function(e){return i=e})))&&this._ariaNotifier.sendNotification(i,!1)},e.prototype.getAllAccessibleContextChanges=function(e,t){var n=this,i=new aa.e(Yo,sa.u.$$(String));return i.set_item(1,new la.o(String)),i.set_item(0,new la.o(String)),e.forEach((function(e){return 3===e?(pa.ImageReader.isImageNode(t.get_node())||n.resetAllContentDetailsProviders(t),n.getParagraphLevelContextChanges(i,t)):e||n.getCpLevelContextChanges(i,t),!0})),i},e.prototype.resetAllContentDetailsProviders=function(e){this._registeredCpContentDetailsProviders.forEach((function(t,n){return n.reset(e),!0}))},e.prototype.getCpLevelContextChanges=function(t,n){var i=new aa.e(String,ua.e);pa.ImageReader.isImageNode(n.get_node())||(i=this.GetCpContentDetails(n.get_cpBegin())),this.getCpContentDetailsDiff(t,this._oldCpContentPerProvider,i,e.SelectionContextChanged(this._lastSelectionContext,n)),this._oldCpContentPerProvider=i},e.prototype.GetCpContentDetails=function(e){var t=new aa.e(String,ua.e);return this._registeredCpContentDetailsProviders.forEach((function(n,i){var r=null;return i.tryGetCpContext(e,(0,g.m)((function(){return r}),(function(e){return r=e})))&&t.set_item(i.get_key(),r),!0})),t},e.prototype.getCpContentDetailsDiff=function(e,t,n,i){var r=this,o=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;t.forEach((function(t,a){var l,s=r._registeredCpContentDetailsProviders.get_item(t).get_contentTitle()||a.title;if(n.tryGetValue(t,(0,g.m)((function(){return l}),(function(e){return l=e})))){if(i&&l.get_contentObject()!==a.get_contentObject()){s&&e.get_item(1).add(s);var u=r._registeredCpContentDetailsProviders.get_item(t).get_contentTitle(),c=String.format(o,l.title,u);l.description&&(c+=", "+l.description),e.get_item(0).add(c)}}else s&&e.get_item(1).add(s);return!0})),n.forEach((function(n,i){if(!t.containsKey(n)){var a=r._registeredCpContentDetailsProviders.get_item(n).get_contentTitle(),l=String.format(o,i.title,a);i.description&&(l+=", "+i.description),e.get_item(0).add(l)}return!0}))},e.prototype.getParagraphLevelContextChanges=function(e,t){var n=this.GetStructuralContentDetails(t.get_node());n=this.collapseNestedContent(n),this.getStructuralContentDetailsDiff(e,this._oldStructuralContentPath,n),this._oldStructuralContentPath=n},e.prototype.GetStructuralContentDetails=function(e){var t=new ha.g;if(t.set(e),!t.tryToRootAtAncestorOfType(1))return null;for(var n=new la.o(da);1!==t.get_currentNodeType();)this._registeredStructuralContentDetailsProviders.forEach((function(e,i){var r;return i.tryGetDocumentStructureDetails(t,(0,g.m)((function(){return r}),(function(e){return r=e})))&&n.add(r),!0})),t.returnToParent();return n.reverse(),n},e.prototype.collapseNestedContent=function(e){for(var t=e.toArray(),n=0,i=function(){var e,i=t[n],o=t[n+1];if(i.get_providerKey()===o.get_providerKey()&&r._registeredStructuralContentDetailsProviders.get_item(i.get_providerKey()).tryCollapseNestedContent(i,o,(0,g.m)((function(){return e}),(function(t){return e=t}))))return t.splice(n,2,e),"continue";n++},r=this;n<t.length-1;)i();return new la.o(da,t)},e.prototype.getStructuralContentDetailsDiff=function(e,t,n){var i;for(i=0;i<Math.min(n.get_length(),t.get_length())&&n.get_item(i).contentId.equals(t.get_item(i).contentId);i++){(o=this._registeredStructuralContentDetailsProviders.get_item(n.get_item(i).get_providerKey()).getContentIncrementalDetails(n.get_item(i),t.get_item(i)))&&(n.get_item(i).description&&(o+=", "+n.get_item(i).description),e.get_item(0).add(o))}for(var r=i;r<n.get_length();r++){(o=this._registeredStructuralContentDetailsProviders.get_item(n.get_item(r).get_providerKey()).getContentIncrementalDetails(n.get_item(r),null))&&(n.get_item(r).description&&(o+=", "+n.get_item(r).description),e.get_item(0).add(o))}for(r=i;r<t.get_length();r++){var o;(o=this._registeredStructuralContentDetailsProviders.get_item(t.get_item(r).get_providerKey()).get_contentTitle())&&e.get_item(1).add(o)}},e.GetContextTransitionLevels=function(t,n,i){var r=new la.o(Zo);(t=t||e.SelectionParagraphChanged(n,i))?(r.add(3),r.add(0)):e.SelectionContextChanged(n,i)&&r.add(0);return r},e.SelectionParagraphChanged=function(e,t){return!e||!e.get_node().get_id().equals(t.get_node().get_id())},e.SelectionContextChanged=function(e,t){return!e||!e.equals(t)},e.TryGetValidSelectionContext=function(e,t){return t.val=null,!!e&&(!!(ga.SelectionEditor.isInsertionPointSelection(e)||(e=ga.SelectionEditor.collapseToIp(e,!0,!1),ga.SelectionEditor.isInsertionPointSelection(e)||e.get_firstContext()&&pa.ImageReader.isImageNode(e.get_firstContext().get_node())))&&(t.val=e.get_firstContext(),!!t.val))},e.TryGetNewNotification=function(e,t){var n=new la.o(String);return e.get_item(1).forEach((function(e){var t=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,e);return n.add(t),!0})),e.get_item(0).forEach((function(e){var t=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,e);return n.add(t),!0})),t.val=n.toArray().join(" "),n.get_length()>0},e}();(0,o.l)(_a,"846d52f5$AccessibilityContextManager",null,[ea.t]);var ma=function(){function e(e,t){this._taskManager=null,this._contentEditableViewEventSource=null,this._isRegisteredWithTheEditingView=!1,this._scheduledHandlingTask=null,this._updatedView=!1,this._selectionChanged=!1,this._editingViewUpdatesHandler=null,this._taskManager=e,this._contentEditableViewEventSource=t}return e.prototype.get_HasScheduledHandlingTask=function(){return!!this._scheduledHandlingTask},e.prototype.registerHandler=function(e){this._isRegisteredWithTheEditingView||(this._contentEditableViewEventSource.add_onAfterValidated(o.i(this,this.AfterEditingViewValidateEventHandler,"AfterEditingViewValidateEventHandler")),this._isRegisteredWithTheEditingView=!0),this._editingViewUpdatesHandler=e},e.prototype.AfterEditingViewValidateEventHandler=function(e,t){(t.get_updatedView()||t.get_selectionChanged())&&this.NotifyEditingViewUpdates(t.get_updatedView(),t.get_selectionChanged())},e.prototype.NotifyEditingViewUpdates=function(t,n){var i=this;this.get_HasScheduledHandlingTask()&&this._taskManager.deleteTask(this._scheduledHandlingTask),this._updatedView=this._updatedView||t,this._selectionChanged=this._selectionChanged||n,this._scheduledHandlingTask=new ge.c(4,1,e.EventsConsolidationInterval,(function(e){i._editingViewUpdatesHandler(i._updatedView,i._selectionChanged),i.Reset()}),126),this._taskManager.addTask(this._scheduledHandlingTask)},e.prototype.Reset=function(){this._scheduledHandlingTask=null,this._updatedView=!1,this._selectionChanged=!1},e.EventsConsolidationInterval=100,e}();(0,o.l)(ma,"f940810d$EditingViewOnAfterValidateEventsConsolidator",null,[ta]);var fa=n(4917),ya=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.Accessibility"},e.prototype.init=function(){yi.App.ariaNotificationsIsEnabled&&this._container.resolve(ea.t)},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e,e.register(ma).as(ta).singleInstance().usingFactory((function(){return new ma(L.AFrameworkApplication.get_theTaskManager(),e.resolve(ia.a))})),e.register(_a).as(ea.t).singleInstance().usingFactory((function(){return new _a(e.resolve(na.u),e.resolve(ta),fa.SelectionManager.get_instance())}))},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(ya,"160bafa2$Box4AccessibilityPackage",null,[s.u,u.s]);var Ca=n(947),Sa=n(1291),ba=n(6315),va=(0,o.y)("9bdbaf48$IAutoCorrectOptionsInfo"),Ta=n(7021),Aa=n(3632),Ia=n(846),wa=n(5622),xa=n(2562),Ea=function(){function e(e,t){this._roamingServiceManager=null,this._replaceQuoteWithSmartQuoteIsEnabled=!1,this.$$pf_ReplaceTextAsYouType=!1,this.$$pf_CapitalizeFirstLetterOfSentences=!1,this.$$pf_ReplaceOrdianalsWithSuperscript=!1,this.$$pf_ReplaceHyphensWithDash=!1,this.$$pf_ReplaceFractionsWithFractionCharacter=!1,this.$$pf_ReplaceQuoteWithSmartQuote=!1,this._roamingServiceManager=e,this._replaceQuoteWithSmartQuoteIsEnabled=t,this.set_replaceTextAsYouType(!0),this.set_capitalizeFirstLetterOfSentences(!0),this.set_replaceOrdianalsWithSuperscript(!0),this.set_replaceHyphensWithDash(!0),this.set_replaceFractionsWithFractionCharacter(!0),this.set_replaceQuoteWithSmartQuote(!0)}return e.prototype.get_replaceTextAsYouType=function(){return this.$$pf_ReplaceTextAsYouType},e.prototype.set_replaceTextAsYouType=function(e){return this.$$pf_ReplaceTextAsYouType=e,e},e.prototype.get_capitalizeFirstLetterOfSentences=function(){return this.$$pf_CapitalizeFirstLetterOfSentences},e.prototype.set_capitalizeFirstLetterOfSentences=function(e){return this.$$pf_CapitalizeFirstLetterOfSentences=e,e},e.prototype.get_replaceOrdianalsWithSuperscript=function(){return this.$$pf_ReplaceOrdianalsWithSuperscript},e.prototype.set_replaceOrdianalsWithSuperscript=function(e){return this.$$pf_ReplaceOrdianalsWithSuperscript=e,e},e.prototype.get_replaceHyphensWithDash=function(){return this.$$pf_ReplaceHyphensWithDash},e.prototype.set_replaceHyphensWithDash=function(e){return this.$$pf_ReplaceHyphensWithDash=e,e},e.prototype.get_replaceFractionsWithFractionCharacter=function(){return this.$$pf_ReplaceFractionsWithFractionCharacter},e.prototype.set_replaceFractionsWithFractionCharacter=function(e){return this.$$pf_ReplaceFractionsWithFractionCharacter=e,e},e.prototype.get_replaceQuoteWithSmartQuote=function(){return this.$$pf_ReplaceQuoteWithSmartQuote},e.prototype.set_replaceQuoteWithSmartQuote=function(e){return this.$$pf_ReplaceQuoteWithSmartQuote=e,e},e.prototype.CacheAutoCorrectOptions=function(t){if(t)for(var n in t){var i={key:n,value:t[n]},r=Boolean.parse(i.value.toString()||"false");switch(i.key){case e.ReplaceTextAsYouTypeKey:this.set_replaceTextAsYouType(r);break;case e.CapitalizeFirstLetterOfSentencesKey:this.set_capitalizeFirstLetterOfSentences(r);break;case e.ReplaceOrdianalsWithSuperscriptKey:this.set_replaceOrdianalsWithSuperscript(r);break;case e.ReplaceHyphensWithDashKey:this.set_replaceHyphensWithDash(r);break;case e.ReplaceFractionsWithFractionCharacterKey:this.set_replaceFractionsWithFractionCharacter(r);break;case e.ReplaceQuoteWithSmartQuoteKey:this.set_replaceQuoteWithSmartQuote(this._replaceQuoteWithSmartQuoteIsEnabled&&r)}}},e.prototype.getAutoCorrectOptions=function(){var t=[e.ReplaceTextAsYouTypeKey,e.CapitalizeFirstLetterOfSentencesKey,e.ReplaceOrdianalsWithSuperscriptKey,e.ReplaceHyphensWithDashKey,e.ReplaceFractionsWithFractionCharacterKey,e.ReplaceQuoteWithSmartQuoteKey];this._roamingServiceManager.getUserSettings("getAutoCorrectOptionsSettings",t).CWo(o.i(this,this.OnGetRequestFinished,"OnGetRequestFinished"),Qn.d.executeSynchronously),S.ULS.sendTraceTag(24523491,324,50,"Load to get autocorrect options from Roaming Service.")},e.prototype.saveAutoCorrectOptions=function(e){this._roamingServiceManager.setUserSettings("saveAutoCorrectOptionsSettings",e),S.ULS.sendTraceTag(24523520,324,50,"Try to save autocorrect options to Roaming Service."),this.CacheAutoCorrectOptions(e)},e.prototype.OnGetRequestFinished=function(e){if(e.get_isFaulted())S.ULS.sendTraceTag(24523522,324,15,"Fail to get autocorrect options from Roaming Service.");else{var t=e.get_result();t&&this.CacheAutoCorrectOptions(t),S.ULS.sendTraceTag(24523521,324,50,"Load to get autocorrect options from Roaming Service successfully, isUserSettingsEmpty: {0}",!t||!P.j.count(t))}},e.ReplaceTextAsYouTypeKey="ReplaceTextAsYouType",e.CapitalizeFirstLetterOfSentencesKey="CapitalizeFirstLetterOfSentences",e.ReplaceOrdianalsWithSuperscriptKey="ReplaceOrdianalsWithSuperscript",e.ReplaceHyphensWithDashKey="ReplaceHyphensWithDash",e.ReplaceFractionsWithFractionCharacterKey="ReplaceFractionsWithFractionCharacter",e.ReplaceQuoteWithSmartQuoteKey="ReplaceQuoteWithSmartQuote",e}();(0,o.l)(Ea,"8983cba7$AutoCorrectOptionsInfo",null,[va]);var Fa=n(1882),Pa=(0,o.y)("d3d0c1ca$IAutoCorrectMatchActionRegistration"),Da=n(1129),Ra=n(6998),Ma=n(3285),ka=function(){function e(e,t,n,i,r,a){this._autoCorrectRules=null,this._pendingAutoCorrectActions=null,this._selectionManager=null,this._autoCorrectForFirstLetterEnabled=!1,this._activityManager=null,this._autoFormatOrdinalNumberAndFractionsEnabled=!1,this._replaceQuoteWithSmartQuoteIsEnabled=!1,this._optionsInfo=null,this._allowAutoCorrectUndoByBackspace=!1,this._undoManager=null,this._registeredMatchActions=null,this._nextTokenForRegisteringMatch=0,this._lastUndoableActionCommandId=null,this._autoCorrectRules=e,this._selectionManager=t,this._activityManager=n,this._autoCorrectForFirstLetterEnabled=i.getBooleanAppSetting("AutoCorrectFirstLetterUpperCaseEnabled"),this._autoFormatOrdinalNumberAndFractionsEnabled=i.getBooleanAppSetting("AutoFormatOrdinalNumberAndFractionsEnabled"),this._replaceQuoteWithSmartQuoteIsEnabled=i.getBooleanAppSetting("ReplaceQuoteWithSmartQuoteIsEnabled"),this._optionsInfo=r,this._allowAutoCorrectUndoByBackspace=!!a,this._undoManager=a,this._registeredMatchActions=new Da.u(Pa),this._allowAutoCorrectUndoByBackspace&&this._selectionManager.add_processSetSelectionFinished(o.i(this,this.OnSetSelectionFinished,"OnSetSelectionFinished"))}return e.prototype.tryToAutocorrectAtTextBreak=function(e,t,n){if(void 0===n&&(n=-1),this._optionsInfo.get_replaceTextAsYouType()||this._optionsInfo.get_replaceHyphensWithDash()){var i=this._autoCorrectRules.findLinkAutoCorrectMatchAtIdx(e,n)||this._autoCorrectRules.findGraphAutoCorrectMatchAtEnd(e,n,t);i&&(this._pendingAutoCorrectActions||(this._pendingAutoCorrectActions=new Ra.r),this._pendingAutoCorrectActions.addAction(i))}if(this._autoCorrectForFirstLetterEnabled&&this._optionsInfo.get_capitalizeFirstLetterOfSentences()){var r=this._autoCorrectRules.findGraphFirstLetterUpperAtEnd(e,n," ");r&&(this._pendingAutoCorrectActions||(this._pendingAutoCorrectActions=new Ra.r),this._pendingAutoCorrectActions.get_listLength()>0&&(this._pendingAutoCorrectActions.getAction(0).set_isGraphOnlyOperation(!0),r.set_needToCheckOriginalString(!1)),this._pendingAutoCorrectActions.addAction(r))}if(this._autoFormatOrdinalNumberAndFractionsEnabled){if(this._optionsInfo.get_replaceOrdianalsWithSuperscript()&&4!==yi.App.get_mode()){var o=this._autoCorrectRules.findOrdinalNumberAutoCorrectAction(e,n);o&&(this._pendingAutoCorrectActions||(this._pendingAutoCorrectActions=new Ra.r),this._pendingAutoCorrectActions.addAction(o),S.ULS.sendTraceTag(8271383,324,50,"Ordinal number autoformat action is created."))}if(this._optionsInfo.get_replaceFractionsWithFractionCharacter()){var a=this._autoCorrectRules.findFractionsAutoCorrectAction(e,n);a&&(this._pendingAutoCorrectActions||(this._pendingAutoCorrectActions=new Ra.r),this._pendingAutoCorrectActions.addAction(a),S.ULS.sendTraceTag(8271384,324,50,"Fractions autoformat action is created."))}}},e.prototype.createAutoCorrectMatchActions=function(e,t,n,i,r,o){var a=new Ra.r;if(t>0){if(!this._autoCorrectForFirstLetterEnabled&&this._optionsInfo.get_replaceTextAsYouType()){var l=this._autoCorrectRules.findHtmlAutoCorrectMatch(n,i,r,o);l&&a.addAction(l)}else{if(this._optionsInfo.get_replaceTextAsYouType()||this._optionsInfo.get_replaceHyphensWithDash()){var s=0;" "===o&&(s=Re.v.vK_Space);var u=null;(u=this._autoCorrectRules.findGraphAutoCorrectMatchAtEnd(e,t,s))&&(u.set_isGraphOnlyOperation(!0),a.addAction(u))}if(this._optionsInfo.get_capitalizeFirstLetterOfSentences()){var c=null;(c=this._autoCorrectRules.findGraphFirstLetterUpperAtEnd(e,t,o))&&(a.get_listLength()>0&&c.set_needToCheckOriginalString(!1),a.addAction(c))}}if(this._autoFormatOrdinalNumberAndFractionsEnabled){if(this._optionsInfo.get_replaceOrdianalsWithSuperscript()&&4!==yi.App.get_mode()){var d=this._autoCorrectRules.findOrdinalNumberAutoCorrectAction(e,t);d&&(a.addAction(d),S.ULS.sendTraceTag(8704786,324,50,"Ordinal number autoformat action is created."))}if(this._optionsInfo.get_replaceFractionsWithFractionCharacter()){var g=this._autoCorrectRules.findFractionsAutoCorrectAction(e,t);g&&(a.addAction(g),S.ULS.sendTraceTag(8271385,324,50,"Fractions autoformat action is created."))}}}if(t>=0&&("'"===o||'"'===o)&&this._replaceQuoteWithSmartQuoteIsEnabled&&this._optionsInfo.get_replaceQuoteWithSmartQuote()){var p=this._autoCorrectRules.findSmartQuoteAutoCorrectAction(e,t,n,i,o);p&&(a.addAction(p),S.ULS.sendTraceTag(37363807,324,50,"Smart quote action is created."))}for(var h=this._registeredMatchActions.get_values().$$ge();h.$$mn();){var _=h.$$cu().createAutoCorrectMatchActions(e,t,n,i,r,o);if(_&&!_.isEmpty())for(var m=0;m<_.get_listLength();m++)a.addAction(_.getAction(m))}return a},e.prototype.registerAutoCorrectMatchAction=function(e){return this._nextTokenForRegisteringMatch++,this._registeredMatchActions.set_item(this._nextTokenForRegisteringMatch,e),this._nextTokenForRegisteringMatch},e.prototype.unregisterAutoCorrectMatchAction=function(e){this._registeredMatchActions.remove(e)},e.prototype.makeItALink=function(e,t){return this._autoCorrectRules.findLinkAutoCorrectMatchAtIdx(e,t)},e.prototype.tryMakeItALink=function(e,t){var n=this.makeItALink(e,t);return!!n&&(this._pendingAutoCorrectActions||(this._pendingAutoCorrectActions=new Ra.r),this._pendingAutoCorrectActions.addAction(n),!0)},e.prototype.scheduleAction=function(e){this._pendingAutoCorrectActions||(this._pendingAutoCorrectActions=new Ra.r),this._pendingAutoCorrectActions.addAction(e)},e.prototype.invokePendingAction=function(e){if(this._pendingAutoCorrectActions){for(var t=!1,n=0;n<this._pendingAutoCorrectActions.get_listLength();n++){if(!(a=this._pendingAutoCorrectActions.getAction(n)))return;if(!a.get_isFired()){t=!0;break}}if(t){this._lastUndoableActionCommandId=null;var i=null,r=new Ma.GraphTransaction(15);r.set_undoActionId(e);var o=!1;for(n=0;n<this._pendingAutoCorrectActions.get_listLength();n++){var a;if(!(a=this._pendingAutoCorrectActions.getAction(n)))return;if(!a.get_isFired()){this._allowAutoCorrectUndoByBackspace&&a.get_isGraphOnlyOperation()&&a.get_isUndoableByBackspace()&&(i=a),o||(o=!0,r.setFromNode(a.get_graphTarget())),a.set_currentSelection(this._selectionManager.get_selectionCollection().get_currentSelection());var l=this._activityManager.startActivity(a.get_commandId());a.invoke(),l.end(),this._selectionManager.setSelection(a.get_currentSelection())}}this._pendingAutoCorrectActions=null,this._lastUndoableActionCommandId=i?i.get_commandId():null,o&&r.dispose()}}},e.prototype.invokePendingActionWithGraphUpdate=function(e){this._lastUndoableActionCommandId=null;var t=e,n=new Ma.GraphTransaction(15);n.setFromNode(t.get_graphTarget()),n.set_undoActionId(t.get_commandId()),t.set_currentSelection(this._selectionManager.get_selectionCollection().get_currentSelection());var i=this._activityManager.startActivity(t.get_commandId());t.invoke(),i.end(),this._selectionManager.setSelection(t.get_currentSelection()),this._allowAutoCorrectUndoByBackspace&&t.get_isGraphOnlyOperation()&&t.get_isUndoableByBackspace()&&(this._lastUndoableActionCommandId=t.get_commandId()),n.dispose()},e.prototype.invokePendingActionWithHtmlUpdate=function(e){var t=e;return this._lastUndoableActionCommandId=null,t.invoke()},e.prototype.hasUndoableAutoCorrectAction=function(){return this._allowAutoCorrectUndoByBackspace&&!!this._lastUndoableActionCommandId},e.prototype.onBeforeKeyDown=function(e){if(!this._allowAutoCorrectUndoByBackspace||!this._lastUndoableActionCommandId)return!1;var t=this._lastUndoableActionCommandId;return this._lastUndoableActionCommandId=null,!(!e||!this._undoManager.get_hasUndoEntries()||this._undoManager.get_currentUndoActionId()!==t)&&(this._undoManager.undo(),!0)},e.prototype.OnSetSelectionFinished=function(e,t){this._lastUndoableActionCommandId=null},e.prototype.get_AutoCorrectActions=function(){return this._pendingAutoCorrectActions},e}();(0,o.l)(ka,"21811b2e$AutoCorrectScheduler",null,[Ia.g]);var Na=n(9981),La=(0,o.y)("690e3525$IPostHyperlinkAutoCorrectStrategy"),Ba=n(7057),Oa=n(9233),Ua=n(6596),Ha=n(274),Ga=n(3910),Wa=n(7275),Va=function(e){function t(t,n,i,r,o,a){var l=e.call(this,t,n,i,r,o)||this;return l._characterPropertiesEditor$1=null,l._trackChangeManager=null,l._internalLinkManager=null,l._postHyperlinkAutoCorrectStrategy=null,l._characterPropertiesEditor$1=o,l._trackChangeManager=a,l}return(0,v.t)(t,e),t.prototype.get_InternalLinkManager=function(){return this._internalLinkManager||(this._internalLinkManager=Ge.w.get_instance().tryResolve(Na.v))},t.prototype.get_PostHyperlinkAutoCorrectStrategy=function(){return this._postHyperlinkAutoCorrectStrategy||(this._postHyperlinkAutoCorrectStrategy=Ge.w.get_instance().tryResolve(La))},t.prototype.get_isGraphOnlyOperation=function(){return!0},t.prototype.get_commandId=function(){return Oi.u.autoCorrectHyperLink},t.prototype.doGraphCorrection=function(e){Dr.t.mark(7012);var n=new Ma.GraphTransaction(15);n.setFromNode(e);var i,r=this.get_matchStartIndex(),o=this.get_matchEndIndex(),a=Ga.ParagraphReader.text(e),l=a.substring(r,o),s=Rn.l.stripIgnoredLinkChars(l,(0,g.m)((function(){return i}),(function(e){return i=e})));l!==s&&(o=(r+=i)+s.length);var u=Wa.y.createTextRange(e,r,o),c=a.substring(r,o);if(t.IsInsideDoubleQuotes(a,r,o)){this._characterPropertiesEditor$1.replaceTextRange(Wa.y.createTextRange(e,r-1,o+1),c,!0,!1),--r,--o,u=Wa.y.createTextRange(e,r,o);var d=Ua.SelectionFactory.createIpSelection(e,o);fa.SelectionManager.get_instance().setSelection(d)}var p=Ha.HyperlinkReader.getSanitizedUrl(c);t.get_HyperlinkEditor().createHyperlink(u,p);var h="",_="",m=!1;if(this.get_InternalLinkManager()&&this.get_InternalLinkManager().tryConvertToRelativeLink(p,(0,g.m)((function(){return h}),(function(e){return h=e})),!0,(0,g.m)((function(){return _}),(function(e){return _=e})))){p=h,m=!0;var f=Ha.HyperlinkReader.getHyperlinksInRange(u,!1);if(t.get_HyperlinkEditor().removeHyperlink(f[0].paragraph,f[0].hyperlink),""!==_){this._characterPropertiesEditor$1.replaceTextRange(u,_,!0,!1),u=Wa.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchStartIndex()+_.length);d=Ua.SelectionFactory.createIpSelection(e,this.get_matchStartIndex()+this.get_matchStartIndex()+_.length);fa.SelectionManager.get_instance().setSelection(d)}t.get_HyperlinkEditor().createHyperlink(u,p)}!this._trackChangeManager.get_trackHyperlinkIsEnabled()&&this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&this._trackChangeManager.trimTrackChangeOnTextRange(u),n.dispose(),!m&&this.get_PostHyperlinkAutoCorrectStrategy()&&this.get_PostHyperlinkAutoCorrectStrategy().postProcessHyperlink(u,p),this._trackChangeManager.get_trackHyperlinkIsEnabled()||this._trackChangeManager.alertUntrackedChange(4),Dr.t.mark(7013)},t.get_HyperlinkEditor=function(){return t._hyperlinkEditor||(t._hyperlinkEditor=Ge.w.get_instance().resolve(Ba.o))},t.IsInsideDoubleQuotes=function(e,t,n){var i=!!t&&('"'===e.charAt(t-1)||"\u201c"===e.charAt(t-1)),r=n!==e.length&&('"'===e.charAt(n)||"\u201d"===e.charAt(n));return i&&r},t._hyperlinkEditor=null,t}(Oa.z);(0,o.l)(Va,"c3851640$HyperlinkAction",Oa.z,[]);var $a=function(){function e(e,t){this._characterPropertiesEditor=null,this._trackChangeManager=null,this._characterPropertiesEditor=e,this._trackChangeManager=t}return e.prototype.createHyperlinkAction=function(e,t,n,i){return new Va(e,t,n,i,this._characterPropertiesEditor,this._trackChangeManager)},e}();(0,o.l)($a,"a868ae74$Factory",null,[Sa.s]);var za=n(3315),Ka=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.AutoCorrect"},e.prototype.configure=function(e){this._container=e,e.register(Fa.d).as(Ca.r).singleInstance().usingFactory((function(){return new Fa.d(e.resolve(Sa.s),e.resolve(ba.x),za.k.get_instance(),L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.appSettingsManager,e.resolve(va),e.resolve(Ta.p).get_instance())})),e.register(Ea).as(va).singleInstance().usingFactory((function(){return new Ea(e.resolve(Aa.t),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReplaceQuoteWithSmartQuoteIsEnabled"))})),e.register(ka).as(Ia.g).singleInstance().usingFactory((function(){return new ka(e.resolve(Ca.r),fa.SelectionManager.get_instance(),xr.y.get_instance(),L.AFrameworkApplication.appSettingsManager,e.resolve(va),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AutoCorrectUndoByBackspaceIsEnabled")?e.resolve(wa.n):null)})),e.register($a).as(Sa.s).singleInstance().usingFactory((function(){return new $a(e.resolve(ba.x),e.resolve(xa.b).get_instance())}))},e.prototype.init=function(){this._container.resolve(Ca.r).loadDefaultAutoCorrectList();var e=L.AFrameworkApplication.appSettingsManager;e.getBooleanAppSetting("AutoCorrectOptionSettingIsEnabledForWordOnline")&&e.getBooleanAppSetting("IsRoamingServiceEnabled")&&this._container.resolve(va).getAutoCorrectOptions()},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Ka,"6e38b262$Box4AutoCorrectPackage",null,[s.u,u.s]);var qa=function(){function e(){}return e.prototype.get_name=function(){return"Box4.Clipboard"},e.prototype.init=function(){},e.prototype.dispose=function(){},e.prototype.configure=function(e){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(qa,"4b9b6122$Box4ClipboardPackage",null,[s.u,u.s]);var ja=function(){function e(){}return e.prototype.get_name=function(){return"Box4.ImageEditors"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(ja,"cd960fc2$Box4ImageEditorsPackage",null,[s.u,u.s]);var Qa=function(){function e(){}return e.prototype.get_name=function(){return"Box4.ListEditors"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Qa,"de2d22e2$Box4ListEditorsPackage",null,[s.u,u.s]);var Ja=(0,o.y)("1ef28144$IInsertMediaFromHostOneDriveHostFrame"),Xa=(0,o.y)("69f78f9a$IOneDriveFilePickerHelper"),Ya=(0,o.y)("f394191$IInsertMediaCrossDocumentMessengerFactory"),Za=n(3864),el=(0,o.y)("4070f0fb$IInsertMediaDialogFactory"),tl=(0,o.y)("a775d276$IInsertMediaFromHostManagerFactory"),nl=n(3858),il=n(577),rl=n(8906),ol=n(2280),al=function(){function e(e,t,n,i,r,o,a,l,s,u,c,d,g,p,h,_){this._actionManager=null,this._appSettingsManager=null,this._insertMediaSettingsManager=null,this._imageEditor=null,this._insertMediaDialogFactory=null,this._insertMediaFromHostManagerFactory=null,this._insertMediaHelper=null,this._insertOnlineImageHelper=null,this._insertOneDriveFileLinkHelper=null,this._hostName=null,this._isLimitedEdit=!1,this._isOneDrive=!1,this._corelationId=null,this._insertOnlinePictureUrl=null,this._insertPictureTelemetryEndpoint=null,this._oneDriveHostFrame=null,this._oneDriveFilePickerHelper=null,this.isFakeHostFrameListening=!1,this._oneDriveFilePickerHelper=i,this._oneDriveHostFrame=r,this._insertMediaDialogFactory=a,this._insertMediaFromHostManagerFactory=l,this._insertMediaHelper=s,this._actionManager=e,this._appSettingsManager=t,this._imageEditor=o,this._isOneDrive=d,this._isLimitedEdit=g,this._hostName=p,this._insertMediaSettingsManager=n,this._insertOnlineImageHelper=u,this._insertOneDriveFileLinkHelper=c,this._insertOnlinePictureUrl=h,this._insertPictureTelemetryEndpoint=_}return e.prototype.registerActions=function(){(this._insertMediaSettingsManager.isInsertOnlinePictureFromHostEnabled||this._insertMediaSettingsManager.isInsertOneDriveFileLinkEnabled)&&this._insertMediaSettingsManager.isInsertOnlinePictureFromEmulatedOneDriveHostEnabled&&this.PrepareOneDriveHostFrame(),this.RegisterInsertOnlinePictureActions(),this._actionManager.addActionWithFlags(Oi.u.insertOnlinePictureFromHost,ol.d.view,o.i(this,this.showInsertPictureFromHostDialog,"showInsertPictureFromHostDialog"),1284),this._actionManager.addActionWithFlags(Oi.u.queryInsertOnlinePictureFromHostButton,ol.d.view,o.i(this,this.UpdateEntryPoints,"UpdateEntryPoints"),1124),this._actionManager.addActionWithFlags(Oi.u.insertOneDriveFile,ol.d.view,o.i(this,this.showInsertOneDriveFileDialog,"showInsertOneDriveFileDialog"),1284)},e.prototype.RegisterInsertOnlinePictureActions=function(){this._actionManager.addActionWithFlags(Oi.u.insertOnlinePicture,ol.d.view,o.i(this,this.showInsertPictureFromSearchDialog,"showInsertPictureFromSearchDialog"),1284),this._appSettingsManager.getBooleanAppSetting("OcpsIsEnabled")&&this._actionManager.removeActionIfFeatureIsDisabled(e.ConnectedServicesFeature,!0,Oi.u.insertOnlinePicture,ol.d.view,o.i(this,this.showInsertPictureFromSearchDialog,"showInsertPictureFromSearchDialog"),(function(e){yi.App.get_activeAppFrame().updateRibbonControlUsingAction(e,o.i(new rl.x,(new rl.x).getCommandById,"getCommandById"))}))},e.prototype.PrepareOneDriveHostFrame=function(){L.AFrameworkApplication.get_activeFrame().get_element().appendChild(this._oneDriveHostFrame.get_fakedOneDriveHostFrame()),wo.n.addHandler(this._oneDriveHostFrame.get_fakedOneDriveHostFrame().contentWindow,"message",o.i(this,this.ShowOneDriveFilePickerDialog,"ShowOneDriveFilePickerDialog")),this.isFakeHostFrameListening=!0},e.prototype.ShowOneDriveFilePickerDialog=function(e){if(e.rawEvent){var t=e.rawEvent.data;if(t)try{var n=Sys.Serialization.JavaScriptSerializer.deserialize(t,!0),i=n.MessageId?n.MessageId.toString():null;if(n&&i&&(i===he.a.insertImage||i===he.a.insertFileLink)){var r=i===he.a.insertImage?this._insertOnlineImageHelper:this._insertOneDriveFileLinkHelper;this._oneDriveFilePickerHelper.start(r)}}catch(e){}}},e.prototype.ShowInsertPictureFromHostDialogOnSignedIn=function(e){this.ShowInsertPictureDialog(this._insertMediaFromHostManagerFactory.getInstance(),CommonUIStrings.L_PictureInsertTitle,e)},e.prototype.UpdateEntryPoints=function(e,t,n,i,r){if(1===n)return 32;var o,a=L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled();return this._isOneDrive?o=a?CommonUIStrings.l_OneDriveName:String.format(CommonUIStrings.L_OnlinePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this._hostName?o=a?this._hostName:String.format(CommonUIStrings.L_OnlinePictureFromHost,this._hostName):(o=a?CommonUIStrings.l_HostGeneric:CommonUIStrings.l_OnlinePictureFromHostGeneric,S.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead.")),r[dr.f.LabelText]=o,32},e.prototype.showInsertPictureFromSearchDialog=function(e,t,n,i,r){var o=this._imageEditor.canInsertPictureInContext(t);if(1===n)return o&&this._insertMediaSettingsManager.isInsertOnlinePictureEnabled?32:8;if(2!==n||!o)return 8;this._corelationId=ai.l.create(),S.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");var a=0;L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance()&&(4===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()?a=8:5===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()&&(a=12));var l,s=Ft.i.getCultureInfo(L.AFrameworkApplication.lcid),u=String.format(this._insertOnlinePictureUrl,L.AFrameworkApplication.lcid,s?s.get_name():"en-us",L.AFrameworkApplication.buildVersion,this._corelationId,a,L.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserId")),c=new RegExp("insertmedia.bing.office.net","gi");return this._insertOnlinePictureUrl.search(c)>0&&(u=this._insertMediaHelper.buildInsertPictureServiceRequestUrl(yi.App.get_mode(),L.AFrameworkApplication.appSettingsManager.get_appSettings().InsertPictureServiceEndpoint)),(l=this._insertMediaDialogFactory.getInstanceWithUrl(u)).set_correlationId(this._corelationId),l.set_insertPictureTelemetryEndpoint(this._insertPictureTelemetryEndpoint),this.ShowInsertPictureDialog(l,CommonUIStrings.L_PictureInsertTitle,this._insertOnlineImageHelper)},e.prototype.showInsertOneDriveFileDialog=function(e,t,n,i,r){var o=32===this._actionManager.processActionAgainstContext(t,Oi.u.insertHyperlink,1,!1,null,null);return 1===n?o&&this._insertMediaSettingsManager.isInsertOneDriveFileLinkEnabled?32:8:2===n&&o?(S.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog."),this.ShowInsertPictureDialog(this._insertMediaFromHostManagerFactory.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this._insertOneDriveFileLinkHelper)):8},e.prototype.showInsertPictureFromHostDialog=function(e,t,n,i,r){var o=this._imageEditor.canInsertPictureInContext(t);return 1===n?o&&this._insertMediaSettingsManager.isInsertOnlinePictureFromHostEnabled?32:8:2===n&&o?(S.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog."),this.ShowInsertPictureDialog(this._insertMediaFromHostManagerFactory.getInstance(),CommonUIStrings.L_PictureInsertTitle,this._insertOnlineImageHelper)):8},e.prototype.ShowInsertPictureDialog=function(e,t,n){try{return e.showInsertMediaDialog(t,n),S.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(e){return S.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",e.toString()),this.showErrorDialog(il.o.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}},e.prototype.showErrorDialog=function(e,t,n){var i=new Vn.StandardDialog(!0);i.set_hasCloseGlyph(L.AFrameworkApplication.isCloseable),i.set_buttonsOption(0),i.setButtonText(1,CommonUIStrings.l_DialogClose),i.showError(e,t,n,(function(e,t){}))},e.prototype.dispose=function(){this.isFakeHostFrameListening&&this._oneDriveHostFrame.get_fakedOneDriveHostFrame().contentWindow&&(wo.n.removeHandler(this._oneDriveHostFrame.get_fakedOneDriveHostFrame().contentWindow,"message",o.i(this,this.ShowOneDriveFilePickerDialog,"ShowOneDriveFilePickerDialog")),this.isFakeHostFrameListening=!1)},e.ConnectedServicesFeature="ConnectedServices",e}();(0,o.l)(al,"ff50ce65$InsertMediaActor",null,[Sys.IDisposable]);var ll=(0,o.y)("aa0c8f65$IInsertMediaCrossDocumentMessenger"),sl=n(9240),ul=n(2249),cl=function(e){function t(t,n){return e.call(this,t,Oe.n.getOrigin(n))||this}return(0,v.t)(t,e),t.prototype.registerPostMessageHandler=function(e,t){if(this.isEnabled()&&this.addAllowedOrigin(this.get_targetOrigin())){this.addAllowedReceivingMessage(e);this.registerCallback(e,t)}},t.prototype.sendMessage=function(e,t,n){void 0===n&&(n=""),this.send((0,U.m)(new ul.f,{MessageId:e,SendTime:Date.now(),CorrelationId:n,Values:t}))},t}(sl.a);(0,o.l)(cl,"32b1bacc$InsertMediaCrossDocumentMessenger",sl.a,[ll,Sys.IDisposable]);var dl=function(){function e(){}return e.prototype.getInstance=function(e,t){return new cl(e,t)},e}();(0,o.l)(dl,"2a185178$InsertMediaCrossDocumentMessengerFactory",null,[Ya]);var gl=(0,o.y)("60890f4f$IInsertMediaDialog"),pl=function(){function e(){}return e.dialogHtml="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>",e}();(0,o.l)(pl,"eb407523$InsertMediaDialogHtml",null,[]);var hl=function(e){function t(n,i,r){var o=this;if(o._searchResults=null,o._dialogTitle=null,o._postMessenger=null,o._postMessengerFactory=null,o._insertMediaHelper=null,o._insertMediaServiceEndpoint=null,o._fInsertMessageReceived=!1,o.m_insertMediaIframe=null,o.m_iframeLoadedHandler=null,o.c_keepFocusDiv="KeepFocusDiv",o.c_keepFocusStartDiv="KeepFocusStartDiv",o.$$pf_CorrelationId=null,o.$$pf_InsertPictureTelemetryEndpoint=null,o.insertOnlineMediaHelper=null,o=e.call(this)||this,!n)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");return o._insertMediaServiceEndpoint=n,o._dialogTitle="",o._insertMediaHelper=r,o._searchResults=[],o._postMessengerFactory=i,o.set_dialogHtml(pl.dialogHtml),o.set_dialogId(t.Id),o}return(0,v.t)(t,e),t.prototype.get_correlationId=function(){return this.$$pf_CorrelationId},t.prototype.set_correlationId=function(e){return this.$$pf_CorrelationId=e,e},t.prototype.get_insertPictureTelemetryEndpoint=function(){return this.$$pf_InsertPictureTelemetryEndpoint},t.prototype.set_insertPictureTelemetryEndpoint=function(e){return this.$$pf_InsertPictureTelemetryEndpoint=e,e},t.prototype.get_FocusManager=function(){return St.FocusManager.instance()},t.prototype.showInsertMediaDialog=function(e,t){var n=this;if(this._dialogTitle=e,this._fInsertMessageReceived=!1,this.showDialog(this._dialogTitle,null),this.m_insertMediaIframe=document.getElementById(this.myId("insertmediaframe")),!this.m_insertMediaIframe)throw this.executeDismissButton(this.get_btnAction()),Error.invalidOperation("Couldn't get InsertMediaIframe.");var i=document.createElement("div");i.setAttribute("Id",this.c_keepFocusStartDiv),i.setAttribute("tabindex","0"),i.setAttribute("position","absolute"),i.setAttribute("width","-1000px"),i.setAttribute("top","-1000px"),this.m_insertMediaIframe.parentNode.insertBefore(i,this.m_insertMediaIframe.parentNode.firstChild);var r=document.createElement("div");r.setAttribute("Id",this.c_keepFocusDiv),r.setAttribute("tabindex","0"),this.m_insertMediaIframe.parentNode.appendChild(r),r.setAttribute("position","absolute"),r.setAttribute("width","-1000px"),r.setAttribute("top","10000px"),$addHandler(this.get_dialogElement(),"keydown",o.i(this,this.KeyDownHandler,"KeyDownHandler")),this.m_insertMediaIframe.setAttribute("src",this._insertMediaServiceEndpoint),this.m_insertMediaIframe.setAttribute("width","100%"),this.m_insertMediaIframe.setAttribute("height","100%"),this.m_insertMediaIframe.setAttribute("frameborder","0"),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ShowInsertMediaIframeWhenIframeIsReady")&&W.y.get_isFirefox()?(this.m_insertMediaIframe.style.visibility="hidden",this.m_iframeLoadedHandler=o.i(this,this.OnInsertMediaIframeLoaded,"OnInsertMediaIframeLoaded"),wo.n.addHandler(this.m_insertMediaIframe,"load",this.m_iframeLoadedHandler)):this.m_insertMediaIframe.style.visibility="visible";var a=document.getElementById(this.myId("WACDialogButtonPanel"));if(!a)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");a.style.display="none";var l=document.getElementById(this.myId("WACDialogTitleText"));if(!l)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");l.style.display="none",St.FocusManager.instance().getCurrentRegion().scope.set_keyDownHandledExternally(!0),this._postMessenger=this._postMessengerFactory.getInstance(this.m_insertMediaIframe.contentWindow,this._insertMediaServiceEndpoint),this._postMessenger.registerPostMessageHandler(he.a.addItem,(function(e){n.OnAddItem(e,o.i(t,t.insertMediaCallback,"insertMediaCallback"))})),this._postMessenger.registerPostMessageHandler(he.a.insert,(function(e){n.OnInsert(e,o.i(t,t.insertMediaCallback,"insertMediaCallback"))})),this._postMessenger.registerPostMessageHandler(he.a.getCustomHeaders,o.i(this,this.OnGetCustomHeaders,"OnGetCustomHeaders")),this._postMessenger.registerPostMessageHandler(he.a.getSessionId,o.i(this,this.OnGetSessionId,"OnGetSessionId")),this._postMessenger.registerPostMessageHandler(he.a.getCID,o.i(this,this.OnGetCID,"OnGetCID")),this._postMessenger.registerPostMessageHandler(he.a.cancelDialog,o.i(this,this.OnCancelDialog,"OnCancelDialog"))},t.prototype.OnInsertMediaIframeLoaded=function(e){var t=this;this.m_insertMediaIframe&&(this.m_insertMediaIframe.style.visibility="visible",window.setTimeout((function(){if(t._document){var e=t._document.getElementById(t.c_keepFocusStartDiv);e&&e.focus()}}),0))},t.prototype.KeyDownHandler=function(e){if(e.keyCode===Sys.UI.Key.tab)if(e.target.id!==this.c_keepFocusDiv||e.shiftKey){if(e.target.id===this.c_keepFocusStartDiv&&e.shiftKey){e.preventDefault(),this._document.getElementById(this.c_keepFocusDiv).focus()}}else e.preventDefault(),this._document.getElementById(this.c_keepFocusStartDiv).focus()},t.prototype.dispose=function(){this._postMessenger&&(this._postMessenger.dispose(),this._postMessenger=null),this.m_iframeLoadedHandler&&(wo.n.removeHandler(this.m_insertMediaIframe,"load",this.m_iframeLoadedHandler),this.m_iframeLoadedHandler=null),e.prototype.dispose.call(this)},t.prototype.sizeAndPositionDialog=function(){e.prototype.sizeAndPositionDialog.call(this);var t=document.getElementById(this.myId("WACDialogPanel"));t&&(t.style.width="870px")},t.prototype.OnAddItem=function(e,t){S.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");var n=this._insertMediaHelper.parseOnlineMediaSearchResult(e);n&&(this._searchResults.length>50?S.ULS.sendTraceTag(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(this._searchResults,n),this._fInsertMessageReceived&&(t(this._searchResults),this._fInsertMessageReceived=!1)))},t.prototype.OnCancelDialog=function(e){S.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message."),this.executeDismissButton(this.get_btnAction()),this.SendTelemetry(1)},t.prototype.SendTelemetry=function(e){var t=new RegExp("hubble","gi");if(this.get_insertPictureTelemetryEndpoint()&&this.get_insertPictureTelemetryEndpoint().search(t)>0&&this.get_correlationId()){var n={};n.InsertedFiles=this._searchResults.length,n.DialogMode=this.GetMediaType(),n.CorrelationId="{"+this.get_correlationId().toString()+"}",n.Platform="Wac",n.Provider="Bing",n.AppId=yi.App.get_mode(),n.Build=L.AFrameworkApplication.buildVersion;var i={};L.AFrameworkApplication.appSettingsManager&&(i=x.x.secureDeserialize(L.AFrameworkApplication.appSettingsManager.get_appSettings().SessionStartInfoJson.toString())),n.AudienceGroup=i&&i.Ring||"Unknown",n.Locale=Ft.i.getCultureInfo(L.AFrameworkApplication.lcid).get_name(),0===e&&(n.MediaDetails=this._searchResults),n.DialogResult=1===e?"Cancel":0===e?"OK":"Error",this.prepareRequest().send(JSON.stringify(n))}},t.prototype.GetMediaType=function(){var e=new RegExp("icon","gi");return this._dialogTitle.search(e)>1?"Icons":"Images"},t.prototype.prepareRequest=function(){var e=new XMLHttpRequest;return e.open("POST",this.get_insertPictureTelemetryEndpoint(),!0),e.setRequestHeader("Content-Type",""),e},t.prototype.OnInsert=function(e,t){S.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message."),this.executeDismissButton(this.get_btnAction()),t&&(this._searchResults&&this._searchResults.length>0?(t(this._searchResults),this.SendTelemetry(0)):(S.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this._fInsertMessageReceived=!0,t(this._searchResults),this.SendTelemetry(2)))},t.prototype.OnGetCustomHeaders=function(e){this._postMessenger&&(S.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this._postMessenger.sendMessage(he.a.setCustomHeaders,{CustomHeaders:""}))},t.prototype.OnGetSessionId=function(e){this._postMessenger&&(S.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this._postMessenger.sendMessage(he.a.setSessionId,{SessionId:L.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))},t.prototype.OnGetCID=function(e){this._postMessenger&&(S.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this._postMessenger.sendMessage(he.a.setCID,{CID:""}))},t.Id="InsertMediaDialog",t}(Bi.o);(0,o.l)(hl,"f6d5c66$InsertMediaDialog",Bi.o,[gl,Sys.IDisposable]);var _l=function(){function e(e,t){this._insertMediaCrossDocumentFactory=null,this._insertMediaHelper=null,this._insertMediaCrossDocumentFactory=e,this._insertMediaHelper=t}return e.prototype.getInstanceWithUrl=function(e){return new hl(e,this._insertMediaCrossDocumentFactory,this._insertMediaHelper)},e.prototype.getInstance=function(){throw Error.notImplemented()},e}();(0,o.l)(_l,"602f0012$InsertMediaDialogFactory",null,[el]);var ml=function(){function e(t,n,i){this._hostPostMessengerLazy=null,this._unsupportedFileTypes=null,this._hostOrigin=null,this._supportedImageExtensions=null,this.isCallbackRegistered=!1,this.$$pf_CorrelationId=null,this.$$pf_InsertPictureTelemetryEndpoint=null,this._hostPostMessengerLazy=t,this._unsupportedFileTypes=[],this._hostOrigin=n,this._supportedImageExtensions=i.split(e.ExtensionSeparator)}return e.prototype.get_correlationId=function(){return this.$$pf_CorrelationId},e.prototype.set_correlationId=function(e){return this.$$pf_CorrelationId=e,e},e.prototype.get_insertPictureTelemetryEndpoint=function(){return this.$$pf_InsertPictureTelemetryEndpoint},e.prototype.set_insertPictureTelemetryEndpoint=function(e){return this.$$pf_InsertPictureTelemetryEndpoint=e,e},e.prototype.showInsertMediaDialog=function(e,t){var n=this;Array.clear(this._unsupportedFileTypes);var i=this._hostPostMessengerLazy.get_value();i.addAllowedOrigin(this._hostOrigin),i.addAllowedReceivingMessage(t.get_hostCrossDocumentInsertMessageId()),this.isCallbackRegistered||(i.registerCallback(t.get_hostCrossDocumentInsertMessageId(),(function(e){n.OnInsert(e,t)})),this.isCallbackRegistered=!0),S.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");var r={FileExtensionFilterList:this._supportedImageExtensions};i.sendMessage(t.get_crossDocumentInsertMessageId(),r)},e.prototype.AddUnsupportedFileType=function(e){Array.contains(this._unsupportedFileTypes,e)||Array.add(this._unsupportedFileTypes,e)},e.prototype.OnInsert=function(e,t){S.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");for(var n=t.parseMessage(e),i=[],r=0;r<n.length;r++){var o=n[r];t.isFileTypeAllowed(o,this._supportedImageExtensions)?Array.add(i,o):this.AddUnsupportedFileType(t.getResultFileType(o))}if(i&&i.length?t.insertMediaCallback(i):S.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty"),this._unsupportedFileTypes.length>0){var a=this._unsupportedFileTypes.join(", ");S.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",a),this.ShowUnsupportedFileTypeDialog(a)}},e.prototype.ShowUnsupportedFileTypeDialog=function(e){var t=new Vn.StandardDialog;t.set_buttonsOption(0),t.showWarning(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,e),null)},e.prototype.dispose=function(){},e.ExtensionSeparator=";",e.AnyTargetOrigin="*",e}();(0,o.l)(ml,"67fff08b$InsertMediaFromHostManager",null,[gl,Sys.IDisposable]);var fl=function(){function e(e){this._insertMediaFromHostManager=null,this._insertMediaFromHostManager=e}return e.prototype.getInstanceWithUrl=function(e){throw Error.notImplemented()},e.prototype.getInstance=function(){return this._insertMediaFromHostManager},e}();(0,o.l)(fl,"88db137f$InsertMediaFromHostManagerFactory",null,[tl,el]);var yl=function(){function e(){this._fakeIframe=null,this._fakeIframe=document.createElement("iframe"),this._fakeIframe.src=e.NullIFrameSrc,this._fakeIframe.style.visibility="hidden",this._fakeIframe.style.position="absolute",this._fakeIframe.style.zIndex="-100"}return e.prototype.get_fakedOneDriveHostFrame=function(){return this._fakeIframe},e.NullIFrameSrc="about:blank",e}();(0,o.l)(yl,"e165c58d$InsertMediaFromHostOneDriveHostFrame",null,[Ja]);var Cl=n(3286),Sl=function(e){function t(n,i){var r=e.call(this,n,i===t.AnyTargetOrigin?i:Oe.n.getOrigin(i))||this;return e.prototype.addAllowedFreeSendingMessage.call(r,he.a.insertImage),e.prototype.addAllowedFreeSendingMessage.call(r,he.a.insertFileLink),r}return(0,v.t)(t,e),t.prototype.sendMessage=function(e,t,n){return void 0===n&&(n=""),this.send((0,U.m)(new ul.f,{MessageId:e,SendTime:Date.now(),CorrelationId:n,Values:t}))},t.prototype.sendMessageWithRetry=function(e,t,n,i){return void 0===n&&(n=""),void 0===i&&(i=0),!1},t.prototype.reportDocumentLoadedTime=function(e){},t.prototype.get_isHostReadyToAcceptPostMessage=function(){return!0},t.prototype.add_hostReadyToAcceptPostMessageReceived=function(e){},t.prototype.remove_hostReadyToAcceptPostMessageReceived=function(e){},t.AnyTargetOrigin="*",t}(sl.a);(0,o.l)(Sl,"a173a52$InsertMediaFromOneDriveCrossDocumentMessenger",sl.a,[se.i,Cl.d,Sys.IDisposable]);var bl=(0,o.y)("c2ea2fa1$IInsertMediaHelper"),vl=function(){return function(){}}();(0,o.l)(vl,"e6a3a971$OnlineMediaSearchResult",null,[]);var Tl=function(){function e(){}return e.prototype.AppModeToId=function(e){var t;switch(e){case 1:t=8;break;case 4:t=3;break;case 2:default:t=0}return t},e.prototype.buildInsertPictureServiceRequestUrl=function(e,t){return String.format(t,this.AppModeToId(e))},e.prototype.buildInsertM365PictureRequestUrl=function(e,t,n,i){var r=this.AppModeToId(e),o=Ft.i.getCultureInfo(L.AFrameworkApplication.lcid).get_name(),a=L.AFrameworkApplication.buildVersion;return String.format(t,L.AFrameworkApplication.lcid,o,a,n,r,i,1,1)},e.prototype.buildInsertVideoServiceRequestUrl=function(t,n){var i=this.AppModeToId(t),r=L.AFrameworkApplication.buildVersion,o=r.indexOf(".")>0?r.substring(0,r.indexOf(".")):"16";return String.format(n,L.AFrameworkApplication.lcid,L.AFrameworkApplication.lcid,L.AFrameworkApplication.lcid,i,o,r,"Video",0,e.IsMultipleInsertionEnabled?1:0)},e.prototype.parseOnlineMediaSearchResult=function(e){if(!e||!e.Values)return null;var t=e.Values;if(!t)return null;var n="";return"sourceProvider"in t&&(n=t.sourceProvider||""),(0,U.m)(new vl,{Action:t.action||"",Caption:t.caption||"",ContentType:t.contentType||"",Type:t.extension||"",PageUrl:t.pageUrl||"",OriginalUrl:t.sourceUrl||"",ContentProvider:n,ThumbnailUrl:t.thumbnailUrl||"",LicenseUrl:t.licenseUrl||"",LicenseDisplayName:t.licenseDisplayName||"",Height:t.height||0,Width:t.width||0,SvgContent:t.svgContent||""})},e.prototype.parseOnlineMediaSearchResultList=function(e){var t=[];if(!e||!e.Values||!e.Values.Items)return t;for(var n=e.Values.Items,i=0;i<n.length;i++){var r=n[i];if(r){var o=(0,U.m)(new vl,{Type:r.Extension||"",OriginalUrl:r.SourceUrl||"",Caption:r.caption,Height:r.Height||0,Width:r.Width||0});Array.add(t,o)}}return t},e.prototype.parseResponse=function(e){for(var t=[],n=0;n<e.data.files.length;n++){var i=e.data.files[n];if(i){var r=(0,U.m)(new vl,{ContentType:i.itemType||"",Type:i.extension||"",OriginalUrl:i.urls&&i.urls.open?i.urls.open:"",Height:i.photo?i.photo.height:0,Width:i.photo?i.photo.width:0});Array.add(t,r)}}return t},e.prototype.isFileTypeAllowed=function(e,t){if(!e)return!1;for(var n=0;n<t.length;n++)if(e.toLowerCase().indexOf(t[n])>=0)return!0;return!1},e.prototype.prepareHTMLForPictures=function(e){var t="";if(e)for(var n=0;n<e.length;n++){var i=e[n];i&&(t+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',i.OriginalUrl,i.Width,i.Height))}return t},e.prototype.getVideoUrlString=function(t){var n=e.s_EmbeddedStringRegExp.exec(t);return n&&n.length>2?n[2].trim():""},e.IsMultipleInsertionEnabled=!1,e.s_EmbeddedStringRegExp=new RegExp("<iframe\\s(.*\\s)*src=[\\\"|'](.*?)[\\\"|'].*/(iframe)?>","im"),e}();(0,o.l)(Tl,"5f3e108$InsertMediaHelper",null,[bl]);var Al=function(){return function(e,t,n,i){this.isInsertOnlinePictureEnabled=!1,this.isInsertOnlinePictureFromHostEnabled=!1,this.isInsertOneDriveFileLinkEnabled=!1,this.isInsertOnlinePictureFromEmulatedOneDriveHostEnabled=!1,this.isInsertOnlinePictureEnabled=e,this.isInsertOnlinePictureFromHostEnabled=t,this.isInsertOneDriveFileLinkEnabled=n,this.isInsertOnlinePictureFromEmulatedOneDriveHostEnabled=i}}();(0,o.l)(Al,"5081718$InsertMediaSettingsManager",null,[]);var Il=(0,o.y)("26ba712e$IInsertOnlineMediaHelper"),wl=(0,o.y)("ed19d0b0$IInsertOnlineMediaHandler"),xl=function(){function e(e){this._actionManager=null,this._insertMediaCommand=Oi.u.insertHyperlink,this._actionManager=e}return e.prototype.get_insertMediaCommand=function(){return this._insertMediaCommand},e.prototype.set_insertMediaCommand=function(e){return this._insertMediaCommand=e,e},e.prototype.insertMediaCallback=function(e){try{S.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",e.length);for(var t=0;t<e.length;t++)this._actionManager.processActionWithData(this.get_insertMediaCommand(),2,e[t]);S.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",e.length)}catch(e){S.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",e.toString())}},e}();(0,o.l)(xl,"d453c7c$InsertOneDriveFileHandler",null,[wl]);var El=n(9062),Fl=function(e){function t(t){return e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.get_crossDocumentInsertMessageId=function(){return he.a.insertFileLink},t.prototype.get_hostCrossDocumentInsertMessageId=function(){return he.a.insertFileLinkHost},t.prototype.parseMessage=function(e){return e&&e.Values&&"Items"in e.Values?e.Values.Items:null},t.prototype.getResultFileType=function(e){return El.r.shipAssertTag(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files"),""},t.prototype.isFileTypeAllowed=function(e,t){return!0},t.prototype.processOneDriveFilePickerResponse=function(e,t,n){var i=n(e);if(i.length){var r={};r.Items=i,t.sendMessage(this.get_hostCrossDocumentInsertMessageId(),r)}},t.prototype.parseOneDriveV7Response=function(e){for(var t=e,n=[],i=0;i<t.data.value.length;i++){var r=t.data.value[i];if(r){var o={};o.DisplayText=r.name,o.Url=r.urls.download,o.sourceUrl=r.urls.download,o.caption=r.name,Array.add(n,o)}}return n},t.prototype.parseOneDriveV5Response=function(e){for(var t=e,n=[],i=0;i<t.data.files.length;i++){var r=t.data.files[i];if(r){var o={};o.DisplayText=String.format("{0}{1}",r.name,r.extension),o.Url=this.FirstValidUrl([r.urls.viewInBrowser,r.urls.open,r.urls.download]),Array.add(n,o)}}return n},t.prototype.FirstValidUrl=function(e){for(var t=0;t<e.length;t++)if(e[t]&&""!==e[t])return e[t];return S.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid"),""},t}(xl);(0,o.l)(Fl,"a57de6e2$InsertOneDriveFileHelper",xl,[Il,wl]);var Pl=n(370),Dl=n(8928),Rl=function(){function e(e,t,n){this._actionManager=null,this._insertMediaHelper=null,this._telemetry=null,this._ariaNotifier=null,this._insertMediaCommand=Oi.u.browserPasted,this._actionManager=e,this._insertMediaHelper=t,this._telemetry=n}return e.prototype.get_actionManager=function(){return this._actionManager},e.prototype.get_ariaNotifier=function(){return this._ariaNotifier||(this._ariaNotifier=Ge.w.get_instance().resolve(na.u))},e.prototype.get_insertMediaCommand=function(){return this._insertMediaCommand},e.prototype.set_insertMediaCommand=function(e){return this._insertMediaCommand=e,e},e.prototype.insertMediaCallback=function(e){try{S.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",e.length);var t=this._insertMediaHelper.prepareHTMLForPictures(e),n=2;if(t&&t.length>0){var i=new Dl.DictionaryPropertySet;if(i.setValue(Pl.k.pastedHtmlContent,t),i.setValue(Pl.k.isImageInsertion,!0),this._telemetry){var r=this._telemetry.startMeasurement("ClipboardOperation");r.appendOperationFlag("insertOnlineImage"),i.setValue(Pl.k.clipboardTelemetry,r)}L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.get_ariaNotifier().sendNotification(Box4Intl.Box4Strings.l_ImageUploading,!0),n=this._actionManager.processActionWithData(this.get_insertMediaCommand(),2,i)}S.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",e.length,32===n,""===t)}catch(e){S.ULS.sendTraceTag(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",e.toString())}},e}();(0,o.l)(Rl,"c750813a$InsertOnlineImageHandler",null,[wl]);var Ml=function(e){function t(t,n,i){return void 0===i&&(i=null),e.call(this,t,n,i)||this}return(0,v.t)(t,e),t.prototype.get_crossDocumentInsertMessageId=function(){return he.a.insertImage},t.prototype.get_hostCrossDocumentInsertMessageId=function(){return he.a.insertImageHost},t.prototype.parseMessage=function(e){return this._insertMediaHelper.parseOnlineMediaSearchResultList(e)},t.prototype.getResultFileType=function(e){return e.Type},t.prototype.isFileTypeAllowed=function(e,t){return this._insertMediaHelper.isFileTypeAllowed(e.Type,t)},t.prototype.parseOneDriveV7Response=function(e){var t=e,n=[];if(t&&t.data&&t.data.value&&t.data.value.length>0)for(var i=0;i<t.data.value.length;i++)if(t.data.value[i]&&t.data.value[i].urls&&t.data.value[i].urls.download){var r=t.data.value[i],o=(0,U.m)(new vl,{OriginalUrl:r.urls.download,Type:r.extension||"",Caption:r.name,ContentType:"",Height:r.driveItem||r.driveItem.image?r.driveItem.image.height:0,Width:r.driveItem||r.driveItem.image?r.driveItem.image.width:0});Array.add(n,o)}return n.length||S.ULS.sendTraceTag(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found"),n},t.prototype.parseOneDriveV5Response=function(e){return this._insertMediaHelper.parseResponse(e)},t.prototype.processOneDriveFilePickerResponse=function(e,t,n){var i=n(e);if(i.length){for(var r=[],o=0;o<i.length;o++){var a=i[o],l={};l.Extension=a.Type,l.SourceUrl=a.OriginalUrl,l.caption=a.Type,l.SourceUrl=a.OriginalUrl,l.Width=a.Width,l.Height=a.Height,Array.add(r,l)}var s={};s.Items=r,t.sendMessage(this.get_hostCrossDocumentInsertMessageId(),s)}},t}(Rl);(0,o.l)(Ml,"3a8a1fe4$InsertOnlineImageHelper",Rl,[Il,wl]);var kl=function(){function e(e,t){this._filePickerApiManager=null,this._postMessengerFactory=null,this._filePickerApiManager=e,this._postMessengerFactory=t}return e.prototype.start=function(e){var t=this,n={mode:"open",select:"multi",lightbox:"white"};this._filePickerApiManager.start(n,(function(n,i){t.ProcessResponse(n,i,e)}))},e.prototype.ProcessResponse=function(e,t,n){var i=t;if(S.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",e),e&&i&&i.data&&i.data.files&&i.data.files.length>0){var r=this._postMessengerFactory.getInstance(window.frames[0].parent,window.document.URL);n.processOneDriveFilePickerResponse(i,r,o.i(n,n.parseOneDriveV5Response,"parseOneDriveV5Response"))}else S.ULS.sendTraceTag(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")},e}();(0,o.l)(kl,"fa8bba90$OneDriveFilePickerHelperV5",null,[Xa]);var Nl=(0,o.y)("3b5120f5$IImageFilePickerHelper"),Ll=(0,o.e)("84e4b761$IEventReceiver$1"),Bl=function(){function e(t,n,i){this._eventEmitter=null,this._resultCallback=null,this.$$pf_Id=0,o.m(this,e.$$(t)),this._eventEmitter=n,this.set_id(e.$$(o.f(this,"Common.App.NewAndOpen.Core.EventReceiver$1").T)._nextEventReceiverId++),this._resultCallback=i}return e.prototype.get_id=function(){return this.$$pf_Id},e.prototype.set_id=function(e){return this.$$pf_Id=e,e},e.prototype.notify=function(e,t){this._resultCallback(e,t)},e.prototype.getResult=function(e,t){return this._eventEmitter.queryForResult(e,t?this:null)},e.$$=function(t){return o.o("Common.App.NewAndOpen.Core.EventReceiver$1",e,[{T:t}],null,[Ll.$$(t)],{_nextEventReceiverId:function(){return 0}})},e}(),Ol=(0,o.y)("34b929da$IPickerDialog"),Ul=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.showPickerDialg=function(){this._customCssClass=t.FilePickerDialogClass,this.set_dialogHtml(t.PickerContainerHtml),this.set_dialogId(t.Id),this.showDialog("",null)},t.prototype.getPickerContainer=function(){return document.getElementById(t.IframeDivId)},t.prototype.sizeAndPositionDialog=function(){},t.prototype.reSizeDialog=function(){},t.Id="PickerDialog-Livebooks",t.IframeDivId="OpenFilePickerDiv",t.FilePickerDialogClass="FilePickerDialog",t.PickerContainerHtml="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>",t}(Bi.o);(0,o.l)(Ul,"409bb1d3$PickerDialog",Bi.o,[Ol]);var Hl=function(){function e(e,t,n){var i=this;this._filePickerApiManager=null,this._postMessengerFactory=null,this._oneDriveForBusinessUrl=null,this._cachedGetMoreInfoResult=null,this._getMoreInfoEventReceiver=null,this._filePickerApiManager=e,this._postMessengerFactory=n,this._getMoreInfoEventReceiver=new nt.q(Ll.$$(fn),(function(){return new Bl(fn,t.get_value(),o.i(i,i.GetMoreInfoEventReceived,"GetMoreInfoEventReceived"))}))}return e.prototype.get_oneDriveForBusinessUrl=function(){return this._oneDriveForBusinessUrl||(this._getMoreInfoEventReceiver.get_value().getResult(e.GetMoreInfoTriggerName,!0),this._cachedGetMoreInfoResult&&this._cachedGetMoreInfoResult.get_personalFileStorageUrl()&&this._cachedGetMoreInfoResult.get_personalFileStorageUrl().length&&(this._oneDriveForBusinessUrl=this.GetOneDriveForBussinessPageUrl(this._cachedGetMoreInfoResult.get_personalFileStorageUrl()))),this._oneDriveForBusinessUrl},e.prototype.GetOneDriveForBussinessPageUrl=function(t){(t=t.toLowerCase()).endsWith("/")||(t+="/");var n=t.indexOf(e.DocumentsString);return-1!==n?t.substring(0,n+1)+"_layouts/15/onedrive.aspx":""},e.prototype.GetMoreInfoEventReceived=function(e,t){this._cachedGetMoreInfoResult||3!==e.get_state()||(this._cachedGetMoreInfoResult=e)},e.prototype.start=function(e){var t=this;if(!this.get_oneDriveForBusinessUrl()){if(!L.AFrameworkApplication.breadcrumbFolderUrl||!L.AFrameworkApplication.breadcrumbFolderUrl.length)return void S.ULS.sendTraceTag(26071185,352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this._cachedGetMoreInfoResult);this._oneDriveForBusinessUrl=L.AFrameworkApplication.breadcrumbFolderUrl}var n=new Ul;n.showPickerDialg();var i=n.getPickerContainer();i?this._filePickerApiManager.start((function(i,r){n.hide(),t.ProcessResponse(i,r,e)}),(function(){t.OnCancel(n)}),i,this._oneDriveForBusinessUrl):S.ULS.sendTraceTag(26071186,352,10,"Picker container is null, will not show picker.")},e.prototype.OnCancel=function(e){e.hide(),S.ULS.sendTraceTag(26071187,352,50,"User cancelled to insert picture from onedrive.")},e.prototype.ProcessResponse=function(e,t,n){var i=t;if(S.ULS.sendTraceTag(26071188,352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",e),e&&i&&i.data&&i.data.value&&i.data.value.length>0){var r=this._postMessengerFactory.getInstance(window.frames[0].parent,window.document.URL);n.processOneDriveFilePickerResponse(i,r,o.i(n,n.parseOneDriveV7Response,"parseOneDriveV7Response"))}else S.ULS.sendTraceTag(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")},e.DocumentsString="/documents/",e.GetMoreInfoTriggerName="InsertFromOneDrive",e}();(0,o.l)(Hl,"834943d2$OneDriveFilePickerHelperV7",null,[Nl,Xa]);var Gl=n(2442),Wl=function(){function e(){this._container=null,this._insertMediaActor=null}return e.prototype.get_name=function(){return"Box4.Media"},e.prototype.configure=function(t){if(this._container=t,Gl.n.get_instance().get_item(99)){t.register(yl).as(Ja).singleInstance().usingFactory((function(){return new yl}));var n=new Al(Boolean.parse(L.AFrameworkApplication.appSettingsManager.get_appSettings().InsertOnlinePictureEnabled||"false"),L.AFrameworkApplication.isInsertOnlinePictureFromHostSupported(),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInsertOneDriveFileIsEnabled"),L.AFrameworkApplication.shouldUseEmulatedOneDriveHostForInsertOnlinePicture());if(Boolean.parse(L.AFrameworkApplication.appSettingsManager.get_appSettings().OneNoteInsertOneDriveFileIsEnabled||"false")){var i=Se.q.taskFromFuture(Cn.$$(fn),t.resolveFuture(Cn.$$(fn)));t.register(Hl).as(Xa).singleInstance().usingFactory((function(){return new Hl(t.resolve(Yn),new nt.q(Cn.$$(fn),(function(){return i.get_result()})),t.resolve(Ya))}))}else t.register(kl).as(Xa).singleInstance().usingFactory((function(){return new kl(t.resolve(jn),t.resolve(Ya))}));t.register(al).singleInstance().usingFactory((function(){return new al(L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.appSettingsManager,n,t.resolve(Xa),t.resolve(yl),t.resolve(Za.w),t.resolve(el),t.resolve(tl),t.resolve(Tl),t.resolve(Ml),t.resolve(Fl),L.AFrameworkApplication.get_isSkyDrive(),L.AFrameworkApplication.limitedEdit,L.AFrameworkApplication.get_hostNameToIncludeInSavedStatus(),L.AFrameworkApplication.appSettingsManager.get_appSettings().InsertPictureServiceEndpoint,L.AFrameworkApplication.appSettingsManager.get_appSettings().InsertPictureTelemetryEndpoint)})),t.register(_l).as(el).singleInstance().usingFactory((function(){return new _l(t.resolve(Ya),t.resolve(Tl))})),t.register(fl).as(tl).singleInstance().usingFactory((function(){return new fl(t.resolve(ml))})),t.register(ml).singleInstance().usingFactory((function(){return new ml(new nt.q(se.i,(function(){var t;if(L.AFrameworkApplication.shouldUseEmulatedOneDriveHostForInsertOnlinePicture()){var n=Ge.w.get_instance().resolve(Ja).get_fakedOneDriveHostFrame();t=new Sl(n.contentWindow,e.AnyTargetOrigin)}else t=L.AFrameworkApplication.hostPostmessenger;return t})),L.AFrameworkApplication.shouldUseEmulatedOneDriveHostForInsertOnlinePicture()?Oe.n.getOrigin(window.document.URL):Oe.n.getOrigin(L.AFrameworkApplication.postMessageOrigin),L.AFrameworkApplication.appSettingsManager.get_appSettings().ImageFetcherSupportedExtensions)})),t.register(dl).as(Ya).singleInstance(),t.register(Tl).singleInstance(),t.register(Ml).singleInstance().usingFactory((function(){return new Ml(L.AFrameworkApplication.get_theActionManager(),t.resolve(Tl),t.resolve(nl.s))})),t.register(Fl).singleInstance().usingFactory((function(){return new Fl(L.AFrameworkApplication.get_theActionManager())}))}},e.prototype.init=function(){Gl.n.get_instance().get_item(99)&&(this._insertMediaActor=this._container.resolve(al),this._insertMediaActor.registerActions())},e.prototype.dispose=function(){this._insertMediaActor&&this._insertMediaActor.dispose()},e.AnyTargetOrigin="*",e}();(0,o.l)(Wl,"e97878e3$MediaPackage",null,[s.u,u.s]);var Vl=function(){function e(){}return e.main=function(){B.o.get_instance().registerPackage(new Wl)},e}();(0,o.l)(Vl,"925d5709$Program",null,[]);var $l=function(){function e(){}return e.prototype.get_name=function(){return"Box4.NotebookLevelEditors"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)($l,"8ed52d82$Box4NotebookLevelEditorsPackage",null,[s.u,u.s]);var zl=n(2988),Kl=n(6519),ql=n(5315),jl=n(4561),Ql=n(2806),Jl=(0,o.y)("21916a31$ICreateParagraphStrategy"),Xl=n(9832),Yl=n(9708),Zl=n(1479),es=n(6328),ts=n(4821),ns=n(23),is=n(463),rs=n(7093),os=n(2183),as=n(621),ls=n(4392),ss=n(9461),us=n(6343),cs=n(4577),ds=n(249),gs=n(382),ps=n(5096),hs=n(9931),_s=n(9368),ms=n(836),fs=n(24),ys=n(8182),Cs=function(){return function(e){this.nodeToInsertAfter=null,this.nodeToInsertAfter=e}}();(0,o.l)(Cs,"91149946$ValidParentData",null,[]);var Ss=n(5885),bs=n(7101),vs=n(4236),Ts=n(861),As=n(6135),Is=n(6642),ws=n(1579),xs=n(1313),Es=n(7885),Fs=function(){return function(){this.depthNew=0,this.depthNew=0}}();(0,o.l)(Fs,"e3d8e6f4$BelowOutlineElementData",null,[]);var Ps=n(1513),Ds=n(1531),Rs=n(1971),Ms=function(e){function t(t,n,i,r){var o=this;return o.deletedParaState=null,o.aboveParaState=null,o.belowParaState=null,(o=e.call(this,4,r)||this).deletedParaState=t,o.aboveParaState=n,o.belowParaState=i,o}return(0,v.t)(t,e),t.prototype.get_deletedParaState=function(){return this.deletedParaState},t.prototype.get_aboveParaState=function(){return this.aboveParaState},t.prototype.get_belowParaState=function(){return this.belowParaState},t.prototype.getUpdateHintsForOperation=function(){var e=this.get_deletedParaState();if(!e)return S.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;var t=[],n=new Ds.a(this.get_deletedParaState().get_id(),this.get_deletedParaState().get_wordId(),this.get_aboveParaState()?this.get_aboveParaState().get_id():null);if(""!==e.get_characterData()&&e.get_characterData()){var i=new Rs.DeleteTextUpdateHint(this.get_deletedParaState().get_id(),0,e.get_characterData());Array.add(t,i)}return Array.add(t,n),t},t}(Ps.s);(0,o.l)(Ms,"bbf6444b$DeleteParagraphOperation",Ps.s,[]);var ks=n(5854),Ns=n(9798),Ls=function(e){function t(t,n,i,r,o){var a=this;return a.oldAboveParaState=null,a.oldBelowParaState=null,a.newAboveParaState=null,a.newParaState=null,(a=e.call(this,3,o)||this).oldAboveParaState=t,a.oldBelowParaState=n,a.newAboveParaState=i,a.newParaState=r,a}return(0,v.t)(t,e),t.prototype.get_oldAboveParaState=function(){return this.oldAboveParaState},t.prototype.get_oldBelowParaState=function(){return this.oldBelowParaState},t.prototype.get_newAboveParaState=function(){return this.newAboveParaState},t.prototype.get_newParaState=function(){return this.newParaState},t.prototype.getUpdateHintsForOperation=function(){var e=[],t=new ks.AddParagraphUpdateHint(this.get_newParaState().get_id(),this.get_newParaState().get_wordId(),this.get_oldAboveParaState()?this.get_oldAboveParaState().get_id():null);if(Array.add(e,t),""!==this.get_newParaState().get_characterData()&&this.get_newParaState().get_characterData()){var n=new Ns.s(this.get_newParaState().get_id(),0,this.get_newParaState().get_characterData());Array.add(e,n)}return e},t}(Ps.s);(0,o.l)(Ls,"a59ded9$InsertNewParagraphOperation",Ps.s,[]);var Bs=n(7303),Os=function(e){function t(t,n,i,r){var o=this;return o.oldAboveParaState=null,o.oldBelowParaState=null,o.mergedParaState=null,(o=e.call(this,2,r)||this).oldAboveParaState=t,o.oldBelowParaState=n,o.mergedParaState=i,o}return(0,v.t)(t,e),t.prototype.get_oldAboveParaState=function(){return this.oldAboveParaState},t.prototype.get_oldBelowParaState=function(){return this.oldBelowParaState},t.prototype.get_mergedParaState=function(){return this.mergedParaState},t.prototype.getUpdateHintsForOperation=function(){var e=[],t=new Bs.MergeParagraphUpdateHint(this.get_oldAboveParaState().get_id(),this.get_oldAboveParaState().get_wordId(),this.get_oldAboveParaState().get_characterData().length,this.get_oldBelowParaState().get_id(),this.get_oldBelowParaState().get_wordId(),this.get_mergedParaState().get_id(),this.get_mergedParaState().get_wordId());return Array.add(e,t),e},t}(Ps.s);(0,o.l)(Os,"284e3e2a$MergeParagraphOperation",Ps.s,[]);var Us=n(2951),Hs=function(e){function t(t,n,i,r,o){var a=this;return a.oldParaState=null,a.aboveParaState=null,a.belowParaState=null,a.splitAtCp=0,(a=e.call(this,1,o)||this).oldParaState=t,a.splitAtCp=n,a.aboveParaState=i,a.belowParaState=r,a}return(0,v.t)(t,e),t.prototype.get_oldParaState=function(){return this.oldParaState},t.prototype.get_aboveParaState=function(){return this.aboveParaState},t.prototype.get_belowParaState=function(){return this.belowParaState},t.prototype.get_splitAtCp=function(){return this.splitAtCp},t.prototype.getUpdateHintsForOperation=function(){var e=[],t=new Us.s(this.get_oldParaState().get_id(),this.get_oldParaState().get_wordId(),this.get_splitAtCp(),this.get_aboveParaState().get_id(),this.get_aboveParaState().get_wordId(),this.get_belowParaState().get_id(),this.get_belowParaState().get_wordId());return Array.add(e,t),e},t}(Ps.s);(0,o.l)(Hs,"19a9f980$SplitParagraphOperation",Ps.s,[]);var Gs=n(3976),Ws=function(){function e(e,t,n,i,r,o){void 0===o&&(o=null),this._trackChangeManager=null,this._trackChangeEditor=null,this._listEditor=null,this._listReader=null,this._outlineEditor=null,this._createParagraphStrategy=null,this._formattingPropertyTransitStrategy=null,this._mergeListEditorInOutlineElementStrategy=null,this._contentControlConverter=null,this._outlineEditor=e,this._listEditor=t,this._listReader=n,this._createParagraphStrategy=i,this._mergeListEditorInOutlineElementStrategy=r,this._formattingPropertyTransitStrategy=o}return e.prototype.AcquireAndApplyWordCoauthLockIfNeeded=function(e){Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager()&&yi.App.get_theCoauthManager().get_isCoauthorable()&&yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(e)},e.prototype.setIndentLeft=function(t,n,i){_s.OutlineElementNavigator.moveToContent(t),Ga.ParagraphReader.isParagraph(t)?e.get_paragraphEditor().getIndentationEditor().setIndentLeft(t,n,i):us.TableReader.isTable(t)&&this.SetTableIndentLeft(t,n,i),_s.OutlineElementNavigator.returnToOutlineElement(t)},e.prototype.SetTableIndentLeft=function(e,t,n){var i=new Ts.e(t,n).get_valueAsTwips(),r=e.get_currentNode();this.setTableIndentLeftForNode(r,i)},e.prototype.setTableIndentLeftForNode=function(e,t){e.setValue(os.j.paraIndentLeft,t)},e.prototype.get_IndentationEditor=function(){return hs.z.get_getOutlineElementIndentationEditor()},e.prototype.get_trackChangeManager=function(){return this._trackChangeManager||(this._trackChangeManager=Ge.w.get_instance().resolve(xa.b).get_instance())},e.prototype.get_trackChangeEditor=function(){return this._trackChangeEditor||(this._trackChangeEditor=Ge.w.get_instance().resolve(es.x).get_instance())},e.prototype.get_ListEditor=function(){return this._listEditor.get_value()},e.prototype.get_listReader=function(){return this._listReader.get_value()},e.prototype.get_OutlineEditor=function(){return this._outlineEditor.get_value()},e.prototype.get_CreateParagraphStrategy=function(){return this._createParagraphStrategy},e.prototype.get_LockedRangeEditor=function(){return za.k.get_instance()},e.prototype.get_FormattingPropertyTransitStrategy=function(){return this._formattingPropertyTransitStrategy},e.prototype.get_ContentControlConverter=function(){return this._contentControlConverter||(this._contentControlConverter=Ge.w.get_instance().tryResolve(Zl.t))},e.prototype.createOutlineElementNode=function(){var e=ps.i.get_instance().createInstance(393229);return e.setValue(is.b.outlineElementChildLevel,ms.k.first),e.setValue(is.b.creationTimeStamp,new Date),e.updateLastModifiedTime(),e},e.prototype.createOutlineGroupNode=function(){var e=new ss.m;return e.setValue(is.b.outlineElementChildLevel,ms.k.first),e},e.prototype.SetAuthor=function(t,n,i){var r=t.get_containingObjectSpace();if(r){r.get_id().equals(e._cachedAuthorContainersSpace)||(e._cachedAuthorContainersSpace=r.get_id(),e._cachedAuthorContainers={});var o=e._cachedAuthorContainers[n];if(!(n in e._cachedAuthorContainers&&r.hasObject(o.get_id())&&r.get_currentRevision()&&r.get_currentRevision().isObjectReferenced(o.get_id()))){var a=new Es.t;a.setValue(is.b.author,n),o=r.registerSharedObject(a)}t.get_properties().setValue(i,o.get_id()),e._cachedAuthorContainers[n]=o}},e.prototype.setLastModifiedTime=function(e,t){e.get_properties().setValue(is.b.lastModifiedTime,t)},e.prototype.updateAuthorAndTimeStamp=function(e,t){void 0===t&&(t=null);var n=new Ma.GraphTransaction(7);n.setFromNode(e),t||(t=new Date),this.setLastModifiedTime(e,t),this.SetAuthor(e,this.GetUserName(),is.b.authorMostRecent),""===Ss.OutlineElementReader.getAuthor(e,is.b.authorOriginal)&&this.SetAuthor(e,this.GetUserName(),is.b.authorOriginal),n.dispose()},e.prototype.GetUserName=function(){return yi.App.theUser.get_name()},e.prototype.duplicateRtl=function(e,t,n){if(void 0===n&&(n=!1),Gl.n.get_instance().get_item(56))if(Ss.OutlineElementReader.isRtlSet(e)){var i=Ss.OutlineElementReader.isRtl(e);n?this.setRtlSimple(t,i):this.setRtl(t,i)}else this.removeRtl(t);else if(Gl.n.get_instance().get_item(26)||Gl.n.get_instance().get_item(89)){i=Ss.OutlineElementReader.isRtl(e);n?this.setRtlSimple(t,i):this.setRtl(t,i)}},e.prototype.setTextDir=function(e,t){var n=new ha.g;n.set(e),n.tryToRootAtAncestorOfType(11);var i=n.returnToAncestorOfType(11);if(Ss.OutlineElementReader.isRtlForView(i)!==t)if(this.setRtl(i,t),Gl.n.get_instance().get_item(54))e.get_anchor().invalidateViewChannelForAllViews(4);else{var r=1;t&&(r=3),e.setValue(is.b.layoutAlignmentInParent,r),e.setValue(is.b.layoutAlignmentSelf,r)}},e.prototype.setRtl=function(t,n){var i=new Ma.GraphTransaction(7);if(i.setFromNode(t),this.setRtlSimple(t,n),Gl.n.get_instance().get_item(26)){var r=new ha.g;if(r.set(t),r.goToFirstChildByRole(2)&&Ga.ParagraphReader.isParagraph(r)){var o=r.get_currentNode();n?(o.setProperty_Unchecked(rs.o.readingOrderRTL,!0),e.get_paragraphEditor().setJustification(o,3)):(o.removeProperty(rs.o.readingOrderRTL),e.get_paragraphEditor().setJustification(o,1))}}var a=new ha.g;if(a.set(t),Gs.q.get_instance().invalidateChildParagraphView(a),a.tryToRootAtAncestorOfType(10)){var l=a.returnToAncestorOfType(10);a.goToFirstChildByRole(1)===t&&this.get_OutlineEditor().setRtl(l,n)}i.dispose()},e.prototype.setRtlSimple=function(e,t){var n=null,i=null;if(this.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_isConnected()){n=Ga.ParagraphReader.getParagraphsUnderNode(e,!0,!0),i=new C.c(xs.b);for(var r=0;r<n.get_count();r++)12===n.get_item(r).get_type()&&i.add(n.get_item(r).getCurrentFormatProperties())}if(t?e.get_properties().setValue(is.b.outlineElementRTL,!0):Gl.n.get_instance().get_item(56)?e.get_properties().setValue(is.b.outlineElementRTL,!1):(Gl.n.get_instance().get_item(26)||Gl.n.get_instance().get_item(89))&&e.get_properties().removeProperty(is.b.outlineElementRTL),this.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&n&&i)if(n.get_count()!==i.get_count())S.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",n.get_count(),i.get_count());else for(r=0;r<n.get_count();r++)this.get_trackChangeEditor().setParagraphFormatChange(n.get_item(r),i.get_item(r),this.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled())},e.prototype.removeRtl=function(e){e.get_properties().removeProperty(is.b.outlineElementRTL)},e.prototype.setIsBoilerText=function(e,t){e.get_properties().setValue(is.b.isBoilerText,t)},e.prototype.createParagraph=function(t,n,i){void 0===n&&(n=null),void 0===i&&(i=!1);var r=null,o=null;if(!Ss.OutlineElementReader.isOutlineElement(t))return S.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),null;var a=null,l=null,s=0;n&&(a=n.formatting,l=n.style,s=n.languageId),i||this.GetAboveAndBelowParagraphState(t,(0,g.m)((function(){return r}),(function(e){return r=e})),(0,g.m)((function(){return o}),(function(e){return o=e})));var u=ds.u.get_instance().createInstance(393230);if(u.setValue(is.b.richEditTextUnicode,""),t.addChild(u,2),t.goToChild(u),e.get_paragraphEditor().removeContent(u),e.get_paragraphEditor().makeDefaultParagraph(u),e.get_paragraphEditor().updateTextId(u),this.AcquireAndApplyWordCoauthLockIfNeeded(u),a&&u.get_characterProperties().get_first().get_formatting().set_formattingId(a),s||(s=L.AFrameworkApplication.lcid),t.get_currentNode().setProperty_Unchecked(is.b.richTextLanguageId,t.get_currentNode().getValueWithDefault(Number,is.b.richTextLanguageId,s)),Gl.n.get_instance().get_item(54)&&t.get_currentNode().setValue(os.j.paraTabCountInTheBeginning,0),Gl.n.get_instance().get_item(71)&&!Gl.n.get_instance().get_item(61)&&!l){var c=bs.StyleReader.getStyleSetFromParagraphNode(u);c&&(l=c.getStyleById(bs.StyleReader.styleIdNormal))}if(this._createParagraphStrategy.extendGraphNode(t),l&&e.get_styleEditor().setStyleOnParagraphNode(l,u,!0),!i&&r){var d=new Ls(r,o,r,new Is.q(u),u.get_documentKindType());t.get_currentNode().getGraphSpace().get_graphTransactionOperations().addOperation(d)}return u},e.prototype.GetAboveAndBelowParagraphState=function(e,t,n){var i=new ha.g;i.setFrom(e),t.val=null,i.get_isFirstSibling()?i.get_currentNode().getGraphSpace().get_graphTransactionOperations().blockRttSend(6):(_s.OutlineElementNavigator.moveToPreviousOutlineElement(i,!0,!1),t.val=this.GetGraphNodeStateFromIterator(i)),i.setFrom(e),n.val=this.GetBelowParagraphState(i)},e.prototype.GetBelowParagraphState=function(e){var t=new ha.g;t.setFrom(e);var n=null;return t.get_isLastSibling()||(_s.OutlineElementNavigator.moveToNextOutlineElement(t,!0,!1),n=this.GetGraphNodeStateFromIterator(t)),n},e.prototype.GetGraphNodeStateFromIterator=function(e,t){void 0===t&&(t=!1);var n=_s.OutlineElementNavigator.moveToContent(e,!0);return n?this.GetGraphNodeState(n,t):(S.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)},e.prototype.GetGraphNodeState=function(e,t){return void 0===t&&(t=!1),12===e.get_type()?t?new Is.q(e):new As.k(e):(e.getGraphSpace().get_graphTransactionOperations().blockRttSend(5),new vs.m(e))},e.prototype.createImage=function(e){this.removeContent(e);var t=ps.i.get_instance().createInstance(393233);return e.addChild(t,2),t},e.prototype.createEmbeddedFile=function(e){this.removeContent(e);var t=ps.i.get_instance().createInstance(393269);return e.addChild(t,2),t},e.prototype.cloneEmptyParagraphElement=function(e,t){var n=t.get_currentNode().clone();e.insertChild(n,null,1),e.goToChild(n),n.clonedFrom=t.get_currentNode(),_s.OutlineElementNavigator.moveToContent(t),1&t.get_invalidSubGraphCoreState()&&t.get_currentNode().validateProperties(null);var i=t.get_currentNode().clone();return i.styleCache=t.get_currentNode().styleCache,e.insertChild(i,null,2),e.goToChild(i),e.invalidateCoreChannel(1),i.clonedFrom=t.get_currentNode(),Gl.n.get_instance().get_item(55)&&i.setValue(os.j.wordId,as.s.randomUInt31()),t.returnToNodeOfType(11),n},e.prototype.removeContent=function(e){e.goToFirstChildByRole(2)&&e.disconnectNodeAndReturnToParent()},e.prototype.replaceContentWithContentOfOutline=function(e,t){var n=e.get_currentNode();_s.OutlineElementNavigator.moveToContent(e);var i=e.get_currentNode();_s.OutlineElementNavigator.returnToOutlineElement(e),t.goToLastChildByRole(1),_s.OutlineElementNavigator.moveToContent(t),e.addChild(t.get_currentNode(),2),t.disconnectNodeAndReturnToParent();var r=new ha.g;if(r.setFrom(t),r.goToFirstChildByRole(1)){var o=new ha.g;o.setFrom(e);var a=new Cs(null);if(!this.getValidParent(o,1,r.get_currentNode(),a))return;ws.z.moveChildren(o,null,1,1,r,-1)}t.disconnectNodeAndReturnToParent();var l=null;for(e.goToPreviousSiblingByRole(1)&&(l=e.get_currentNode()),e.returnToParent();fs.OutlineNavigator.moveToFirstOutlineElement(t);)e.insertChild(t.get_currentNode(),l,1),l=t.get_currentNode(),t.disconnectNodeAndReturnToParent();e.goToChild(n),e.goToChild(i),e.disconnectNodeAndReturnToParent()},e.prototype.splitAtIp=function(t,n,i,r,o,a,l){void 0===l&&(l=!1),this.removeContent(n);var s,u=n.get_currentNodeType(),c=t.get_currentNode(),d=null,g=null,p=null,h=!1;_s.OutlineElementNavigator.moveToContent(t);var _=t.get_currentNodeType();if(Ga.ParagraphReader.isParagraph(t)){s=t.get_currentNode();var m=(0,y.e)(cs.AParagraphNode,s);m?m.get_characterProperties()&&m.get_characterProperties().get_length()||S.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",m):S.ULS.sendTraceTag(38925731,307,15,"srcParaNode is null"),g=new Is.q(m),(h=i.get_cpBegin()===Ga.ParagraphReader.textLength(s))&&(p=this.GetBelowParagraphState(n));var f=n.get_currentNode();if(d=this.createParagraph(n,void 0,!0),e.get_paragraphEditor().splitParagraphAtIp(t,n,i,o,a,l),Gl.n.get_instance().get_item(71))if(r){var C=bs.StyleReader.getStyleFromParagraphNode(s);C&&e.get_styleEditor().setStyleOnParagraphNode(C,d,!0)}else if(h){var b=bs.StyleReader.getStyleFromParagraphNode(s);if(b){var v=b.getValueWithDefault(String,rs.o.nextStyle,null);if(v){var T=bs.StyleReader.getStyleSetFromParagraphNode(d).getStyleById(v);e.get_styleEditor().setStyleOnParagraphNode(T,d,!1)}else e.get_styleEditor().setStyleOnParagraphNode(b,d,!0)}}this.duplicateRtl(c,f),this.get_ListEditor().duplicateListLevelIfNecessary(c,f)}_s.OutlineElementNavigator.returnToOutlineElement(t),_s.OutlineElementNavigator.returnToOutlineElement(n);var A=Ss.OutlineElementReader.isEmpty(t,!0),I=Ss.OutlineElementReader.isEmpty(n,!0);if(Gl.n.get_instance().get_item(27)&&A&&!I){if(1&n.get_invalidSubGraphCoreState()){var w=new Ei.m;w.setFrom(n),n.get_currentNode().validateProperties(w)}this.SetAuthor(n.get_currentNode(),Ss.OutlineElementReader.getAuthor(t.get_currentNode(),is.b.authorMostRecent),is.b.authorMostRecent),this.SetAuthor(n.get_currentNode(),Ss.OutlineElementReader.getAuthor(t.get_currentNode(),is.b.authorOriginal),is.b.authorOriginal),this.setLastModifiedTime(n.get_currentNode(),Ss.OutlineElementReader.getLastModifiedTime(t.get_currentNode()))}_s.OutlineElementNavigator.moveToContent(t);var x=(0,y.e)(cs.AParagraphNode,t.get_currentNode());x?x.get_characterProperties()&&x.get_characterProperties().get_length()||S.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",x):S.ULS.sendTraceTag(38925761,307,15,"srcPara is null");var E=new Is.q(x);_s.OutlineElementNavigator.returnToOutlineElement(t);var F=d;if(F?F.get_characterProperties()&&F.get_characterProperties().get_length()||S.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",F):(S.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),S.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{splittingAtEnd:h,moveText:a,overrideParagraphStyle:r,sourceOutlineElementContentNodeType:_,destinationOutlineElementNodeType:u,alwaysMoveEopToDestinationPara:l})),h){var P=new Ls(g,p,E,new Is.q(F),F.get_documentKindType());n.get_currentNode().getGraphSpace().get_graphTransactionOperations().addOperation(P)}else{var D=void 0;D=a?new Hs(g,i.get_cpBegin(),E,new Is.q(F),F.get_documentKindType()):new Hs(g,i.get_cpBegin(),new Is.q(F),E,F.get_documentKindType()),n.get_currentNode().getGraphSpace().get_graphTransactionOperations().addOperation(D)}},e.prototype.CanBeMerged=function(e,t){_s.OutlineElementNavigator.moveToContent(e);var n=Ga.ParagraphReader.canContainIpOrTextRange(e.get_currentNode()),i=e.get_currentNode();return Gl.n.get_instance().get_item(14)&&(n=t?n&&!this.get_LockedRangeEditor().paragraphStartsInLockedRange(i):n&&!this.get_LockedRangeEditor().paragraphEndsInLockedRange(i)),_s.OutlineElementNavigator.returnToOutlineElement(e),n},e.prototype.merge=function(t,n,i,r,o,a,l,s){if(void 0===o&&(o=null),void 0===a&&(a=!1),void 0===l&&(l=!1),void 0===s&&(s=!1),t.get_currentNode().get_id()===n.get_currentNode().get_id())return!1;n.get_currentNode(),t.get_currentNode();var u,c,d=new ha.g;if(d.setFrom(n),u=this.GetGraphNodeStateFromIterator(d),d.setFrom(t),c=this.GetGraphNodeStateFromIterator(d,!0),!this.CanBeMerged(n,!0)||!this.CanBeMerged(t,!1))return!1;if(this.get_LockedRangeEditor().get_isContentControlEditingEnabled()){_s.OutlineElementNavigator.moveToContent(t),_s.OutlineElementNavigator.moveToContent(n);var g=Ga.ParagraphReader.isParagraph(t)?t.get_currentNode():null,p=Ga.ParagraphReader.isParagraph(n)?n.get_currentNode():null;if(_s.OutlineElementNavigator.returnToOutlineElement(t),_s.OutlineElementNavigator.returnToOutlineElement(n),g&&p&&!this.get_LockedRangeEditor().canBeMergedWithContentControlBoundary(g,p,!1)){if(!this.get_ContentControlConverter()||!this.get_LockedRangeEditor().canBeMergedWithContentControlBoundary(g,p,!0))return!1;this.get_ContentControlConverter()&&(this.get_ContentControlConverter().tryToConvertBlockContentControlToInlineBasedOnParagraph(g,!1),this.get_ContentControlConverter().tryToConvertBlockContentControlToInlineBasedOnParagraph(p,!0))}}var h=!1;if(this.get_listReader().get_qoEListInternalCCPImprovementIsEnabled()){var _=(0,y.e)(cs.AParagraphNode,t.get_currentNode());h=(i||!_||!_.get_characterData().length)&&!gs.ListReader.isListOutlineElement(t)}else h=this._mergeListEditorInOutlineElementStrategy.useSourceListWithNonlistDestination(i,t);s||this.get_ListEditor().merge(t,n,h,o),_s.OutlineElementNavigator.moveToContent(t);var m=t.get_currentNode().get_documentKindType();if(_s.OutlineElementNavigator.moveToContent(n),Ga.ParagraphReader.isParagraph(n)){if(Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()){p=n.get_currentNode(),g=t.get_currentNode();var f=ls.CoauthLockEditor.getInstance();if(f.shouldLockBlockEditing(this.get_LockedRangeEditor().getCoauthLockForParagraphOrImage(p))||f.shouldLockBlockEditing(this.get_LockedRangeEditor().getCoauthLockForParagraphOrImage(g)))return n.returnToParent(),t.returnToParent(),!1}var C=!1;if(gs.ListReader.get_isListMarkerEnabled()){var S=t.get_parentNode();S&&Ss.OutlineElementReader.isOutlineElementNode(S)&&(C=gs.ListReader.isListOutlineElementNode(S))}if(Gl.n.get_instance().get_item(71)){var b=Ga.ParagraphReader.isEmpty(t)||i;if(b=b&&!C){var v=bs.StyleReader.getStyleFromParagraph(n);v&&e.get_styleEditor().setStyleOnParagraphNode(v,t.get_currentNode(),!0)}}i&&this._formattingPropertyTransitStrategy.mergeParagraphProperties(n.get_currentNode(),t.get_currentNode(),C,l);var T=e.get_paragraphEditor().merge(t,n,i,r,a),A=d.get_currentNode(),I=t.get_currentNode();t.returnToParent(),T&&Ss.OutlineElementReader.isEmpty(n,!0)&&this.disconnectOutlineElement(n);var w=new Os(c,u,new As.k(A),m);return I.getGraphSpace().get_graphTransactionOperations().addOperation(w),!0}return n.returnToParent(),t.returnToParent(),!1},e.prototype.insertOutlineElementAt=function(e,t){void 0===t&&(t=!1);var n=new ha.g;n.set(e.get_node()),n.tryToRootAtOutlineAncestor(),_s.OutlineElementNavigator.returnToOutlineElement(n);var i=this.insertOutlineElementBelow(n),r=this.insertOutlineElementBelow(n);return this.splitAtIp(n,i,e,!1,!0,!0),Ss.OutlineElementReader.isEmpty(n,!1)&&(this.get_ListEditor().removeList(n),n.disconnectNodeAndReturnToParent()),!Ss.OutlineElementReader.isEmpty(i,!1)||t&&Ss.OutlineElementReader.isLastOutlineElementInOutline(i)||(this.get_ListEditor().removeList(i),i.disconnectNodeAndReturnToParent()),r},e.prototype.insertOutlineElementAsSibling=function(e,t,n,i,r,o){if(void 0===i&&(i=null),void 0===r&&(r=!1),void 0===o&&(o=!0),!this.CanInsertOutlineElementAsSibling(e))return null;var a,l=e.get_currentNode(),s=!1;if(o){var u=gs.ListReader.isListOutlineElement(e),c=t||r||!Ss.OutlineElementReader.isEmpty(e,!1);s=this.get_ListEditor().shouldTransferListInfo(u,c)}a=t?e.goToPreviousSiblingByRole(1):e.get_currentNode(),e.returnToParent();var d=this.get_OutlineEditor().insertOutlineElementAsChild(e,a,n,i);return d?(this.duplicateRtl(l,d),o&&(this.get_ListEditor().duplicateListLevelIfNecessary(l,d),s&&this.get_ListEditor().transferListInfo(e,t,l,d)),d):null},e.prototype.CanInsertOutlineElementAsSibling=function(e){if(Ss.OutlineElementReader.isOutlineElement(e)){var t=e.get_parentNode();if(ys.OutlineReader.isOutlineOrTableCellNode(t)||Ss.OutlineElementReader.isOutlineElementNode(t)||Ss.OutlineElementReader.isOutlineGroupNode(t))return!0}return!1},e.prototype.removeContainingOutlineElement=function(e){var t=new ha.g;t.set(e),t.tryToRootAtOutlineAncestor(),t.returnToNodeOfType(11);var n=null,i=null;this.GetAboveAndBelowParagraphState(t,(0,g.m)((function(){return n}),(function(e){return n=e})),(0,g.m)((function(){return i}),(function(e){return i=e})));var r=-1;12===e.get_type()&&(r=e.get_documentKindType()),t.get_currentNode().getGraphSpace().get_graphTransactionOperations().addOperation(new Ms(this.GetGraphNodeState(e,!0),n,i,r)),this.disconnectOutlineElement(t)},e.prototype.disconnectOutlineElement=function(e){if(e.hasChildrenOfRole(1)){var t=new Fs,n=new ha.g;n.setFrom(e),this.GetBelowOutlineElement(n,!1,!1,null,t)&&this.get_IndentationEditor().demote(e,-t.depthNew,0)}e.disconnectNodeAndReturnToParent(),us.TableReader.isInTable(e)&&this.postOutlineElementMove(e)},e.prototype.insertOutlineGroup=function(e,t,n){if(!ys.OutlineReader.isOutline(e)&&!Ss.OutlineElementReader.isOutlineElement(e))return null;var i=this.createOutlineGroupNode();return n>0&&n<ms.k.last&&i.setValue(is.b.outlineElementChildLevel,Math.min(ms.k.nil,n)),e.insertChild(i,t,1),i},e.prototype.insertOutlineGroupAsSibling=function(e,t,n){if(!Ss.OutlineElementReader.isOutlineElement(e)&&!Ss.OutlineElementReader.isOutlineGroup(e)||!ys.OutlineReader.isOutlineNode(e.get_parentNode())&&!Ss.OutlineElementReader.isOutlineElementNode(e.get_parentNode()))return null;var i,r=e.get_currentNode();i=n?e.goToPreviousSiblingByRole(1):e.get_currentNode(),e.returnToParent();var o=this.insertOutlineGroup(e,i,t);return e.goToChild(r),o},e.prototype.postOutlineElementMove=function(e){Ss.OutlineElementReader.isOutlineGroup(e)&&(e.hasChildrenOfRole(1)||e.disconnectNodeAndReturnToParent()),this.FixOutlineElementGroups(e,!1),this.AdjustOEChildren(e)},e.prototype.FixOutlineElementGroups=function(e,t){var n,i=null;for(n=e.goToFirstChildByRole(1);n;){var r=!1;Ss.OutlineElementReader.isOutlineGroupNode(n)&&!e.hasChildrenOfRole(1)&&(r=!0);var o=n;if(n=e.goToNextSiblingByRoleOrReturnToParent(1),r){var a=new ha.g;a.set(o),a.tryToRootAtOutlineAncestor(),a.disconnectNodeAndReturnToParent()}else if(Ss.OutlineElementReader.isOutlineGroupNode(o)){if(i){var l=new ha.g;l.set(i);var s=new ha.g;s.set(o),s.tryToRootAtOutlineAncestor(),l.addChild(s.get_currentNode(),1),s.disconnectNodeAndReturnToParent();var u=Ss.OutlineElementReader.getChildLevel(o);u===ms.k.nil&&(u=1);var c=Ss.OutlineElementReader.getChildLevel(o),d=Math.max(0,c-u);d?o.setValue(is.b.outlineElementChildLevel,Math.min(ms.k.nil,d)):(l.goToChild(o),e.goToFirstChildByRole(1),ws.z.deleteAboveMultipleNodes(l),l.returnToParent()),t&&this.FixOutlineElementGroups(l,!0)}}else i=o}var g=null,p=ms.k.last+1;for(n=e.goToFirstChildByRole(1);n;n=e.goToNextSiblingByRoleOrReturnToParent(1)){if(!Ss.OutlineElementReader.isOutlineGroup(e))return void e.returnToParent();p>(h=Ss.OutlineElementReader.getChildLevel(n))&&(p=h,g=n)}if(g){for(n=e.goToFirstChildByRole(1);n;n=e.goToNextSiblingByRoleOrReturnToParent(1))if(n!==g){var h=Ss.OutlineElementReader.getChildLevel(n);e.get_currentNode().setValue(is.b.outlineElementChildLevel,Math.min(ms.k.nil,h-p))}p+=Ss.OutlineElementReader.getChildLevel(e.get_currentNode()),e.get_currentNode().setValue(is.b.outlineElementChildLevel,Math.min(ms.k.nil,p));var _=new ha.g;_.setFrom(e),_.goToChild(g),_.goToFirstChildByRole(1),ws.z.deleteAboveMultipleNodes(_)}},e.prototype.getValidParent=function(e,t,n,i){e.get_currentNode();var r=Ss.OutlineElementReader.getChildLevel(e.get_currentNode());if(r===t)return!0;if(Ss.OutlineElementReader.isOutlineGroup(e))return!1;if(!e.getChildCountByRole(1)||this.IsOnlyOutlineElement(e,n))return e.get_currentNode().setValue(is.b.outlineElementChildLevel,Math.min(ms.k.nil,t)),!0;if(i.nodeToInsertAfter&&e.goToChild(i.nodeToInsertAfter)){if(Ss.OutlineElementReader.isOutlineGroup(e)&&r+Ss.OutlineElementReader.getChildLevel(e.get_currentNode())===t)return i.nodeToInsertAfter=e.goToLastChildByRole(1),e.returnToParent(),!0;e.returnToParent()}if(i.nodeToInsertAfter&&e.goToChild(i.nodeToInsertAfter)||!i.nodeToInsertAfter&&e.goToFirstChildByRole(1)){if(e.get_currentNode()!==n&&e.goToNextSiblingByRole(1)&&Ss.OutlineElementReader.isOutlineGroup(e)&&r+Ss.OutlineElementReader.getChildLevel(e.get_currentNode())===t)return i.nodeToInsertAfter=null,!0;e.returnToParent()}if(e.hasChild(n)&&this.IsOnlyNonGroupChild(e,n)){for(var o=e.goToFirstChildByRole(1);o;o=e.goToNextSiblingByRoleOrReturnToParent(1))if(o!==n){var a=Ss.OutlineElementReader.getChildLevel(o);o.setValue(is.b.outlineElementChildLevel,Math.min(ms.k.nil,a+(r-t)))}return e.get_currentNode().setValue(is.b.outlineElementChildLevel,Math.min(ms.k.nil,t)),!0}if(r<t){var l=this.insertOutlineGroup(e,i.nodeToInsertAfter,t-r);return e.goToChild(l),i.nodeToInsertAfter=null,!0}if(r>t){e.get_currentNode().setValue(is.b.outlineElementChildLevel,Math.min(ms.k.nil,t));var s=null;for(o=e.goToFirstChildByRole(1);o;)if(Ss.OutlineElementReader.isOutlineGroup(e))o.setValue(is.b.outlineElementChildLevel,Math.min(ms.k.nil,r-t+Ss.OutlineElementReader.getChildLevel(o))),o=e.goToNextSiblingByRoleOrReturnToParent(1);else{s||(s=this.insertOutlineGroupAsSibling(e,r-t,!1));var u=o;(o=ws.z.moveNodeAsSiblingChild(e,s,1))===s&&(o=e.goToNextSiblingByRoleOrReturnToParent(1)),i.nodeToInsertAfter===u&&(i.nodeToInsertAfter=s,s=null)}return!0}return!1},e.prototype.IsOnlyOutlineElement=function(e,t){return ha.g.executeWithDebugAssertRestored(e,(function(){if(1===e.getChildCountByRole(1)){var n=e.goToFirstChildByRole(1);if(e.returnToParent(),n===t)return!0}return!1}))},e.prototype.IsOnlyNonGroupChild=function(e,t){return ha.g.executeWithDebugAssertRestored(e,(function(){var n;for(n=e.goToFirstChildByRole(1);n;n=e.goToNextSiblingByRoleOrReturnToParent(1))if(n!==t&&!Ss.OutlineElementReader.isOutlineGroup(e))return e.returnToParent(),!1;return!0}))},e.prototype.GetBelowOutlineElement=function(e,t,n,i,r){r.depthNew=0;do{var o=e.get_currentNode();if(!t&&e.goToFirstChildByRole(1))r.depthNew-=Ss.OutlineElementReader.getChildLevel(o);else{if(ys.OutlineReader.isOutline(e))return!1;if(e.get_currentNode()===i)return!1;if(3===e.get_role()&&e.goToFirstSiblingByRole(1));else for(;!e.goToNextSiblingByRoleOrReturnToParent(1);)if(r.depthNew+=Ss.OutlineElementReader.getChildLevel(e.get_currentNode()),ys.OutlineReader.isOutline(e)||e.get_currentNode()===i)return!1}}while(!n&&Ss.OutlineElementReader.isOutlineGroup(e));return!0},e.prototype.insertOutlineElementBelow=function(e,t){return void 0===t&&(t=!1),this.InsertOutlineElement(e,!1,t)},e.prototype.insertOutlineElementAbove=function(e,t){return void 0===t&&(t=!1),this.InsertOutlineElement(e,!0,t)},e.prototype.InsertOutlineElement=function(e,t,n){void 0===n&&(n=!1);var i=new ha.g;i.setFrom(e);var r=new ha.g;return r.setFrom(i),this.insertOutlineElementAsSibling(r,t,!1,null,n),r.get_currentNode().setValue(is.b.outlineElementChildLevel,Math.min(ms.k.nil,Ss.OutlineElementReader.getChildLevel(i.get_currentNode()))),i.goToFirstChildByRole(1)&&ws.z.moveChildren(r,null,1,1,i,-1),r},e.prototype.AdjustOEChildren=function(e){e.get_currentNode();if(Ss.OutlineElementReader.requiresStrictOutlineStructure(e)){1!==Ss.OutlineElementReader.getChildLevel(e.get_currentNode())&&e.get_currentNode().setValue(is.b.outlineElementChildLevel,ms.k.first);for(var t=e.goToFirstChildByRole(1);t;)if(Ss.OutlineElementReader.isOutlineGroup(e)){var n=new ha.g;n.setFrom(e),n.returnToParent();var i=new ha.g;i.setFrom(e),i.goToFirstChildByRole(1),ws.z.moveChildren(n,e.get_currentNode(),1,1,i,-1),t=e.disconnectNodeAndGoToNextSiblingByRoleOrReturnToParent(1)}else this.AdjustOEChildren(e),t=e.goToNextSiblingByRoleOrReturnToParent(1)}},e.get_styleEditor=function(){return e._styleEditor||(e._styleEditor=Ge.w.get_instance().resolve(ts.e))},e.set_styleEditor=function(t){return e._styleEditor=t,t},e.get_paragraphEditor=function(){return e._paragraphEditor||(e._paragraphEditor=Ge.w.get_instance().resolve(ns.g))},e.set_paragraphEditor=function(t){return e._paragraphEditor=t,t},e._styleEditor=null,e._paragraphEditor=null,e._cachedAuthorContainersSpace=null,e._cachedAuthorContainers=null,e}();(0,o.l)(Ws,"d13cce42$OutlineElementEditor",null,[ql.p]);var Vs=n(2846),$s=n(1033),zs=n(5317),Ks=n(5321),qs=n(2411),js=n(8221),Qs=n(8917),Js=function(){function e(e){this._outlineElementNodeIdFactory=null,this._outlineElementNodeIdFactory=e}return e.prototype.createOutlineNode=function(e){void 0===e&&(e=!1);var t=ds.u.get_instance().createInstance(393228);return t.setValue(is.b.outlineElementChildLevel,ms.k.first),t.setValue(is.b.bodyTextAlignment,0),e||t.setValue(is.b.layoutMaxWidth,ys.OutlineReader.defaultOutlineWidth),new Ks.OutlineIndentInfo(!0).saveToProperty(t),t},e.prototype.appendOutlineElement=function(t,n,i){void 0===i&&(i=null);var r=t.get_currentNode();return t.goToLastChildByRole(1)?(Ss.OutlineElementReader.isOutlineGroup(t)&&_s.OutlineElementNavigator.moveToOutlineElement(t,!0),Ss.OutlineElementReader.isOutlineElement(t)?e.get_outlineElementEditor().insertOutlineElementAsSibling(t,!1,n,i):(t.returnToNode(r),null)):this.insertOutlineElementAsChild(t,null,n,i)},e.prototype.canInsertOutlineElementAsChild=function(e){return ys.OutlineReader.isOutlineViewLevelNode(e.get_currentNode())||Ss.OutlineElementReader.isOutlineElement(e)||Ss.OutlineElementReader.isOutlineGroup(e)||js.TableCellReader.isTableCell(e)},e.prototype.insertOutlineElementAsChild=function(t,n,i,r){if(void 0===n&&(n=null),void 0===i&&(i=!1),void 0===r&&(r=null),!this.canInsertOutlineElementAsChild(t))return null;var o=e.get_outlineElementEditor().createOutlineElementNode();return this.SetRtlForOutlineElementNode(o,t),t.insertChildUsingId(o,n,1,this._outlineElementNodeIdFactory.generateOutlineElementNodeId()),t.goToChild(o),i&&(e.get_outlineElementEditor().createParagraph(t,r),_s.OutlineElementNavigator.returnToOutlineElement(t)),Gl.n.get_instance().get_item(25)&&e.get_outlineElementEditor().updateAuthorAndTimeStamp(t.get_currentNode()),o},e.prototype.SetRtlForOutlineElementNode=function(t,n){var i=this.GetRtlStorageNodeForAnyOutlineElementParent(n);if(i)switch(i.get_type()){case 11:e.get_outlineElementEditor().duplicateRtl(i,t,!0);break;case 8:var r=e.get_PageReader().isRtl(i);e.get_outlineElementEditor().setRtlSimple(t,r)}},e.prototype.GetRtlStorageNodeForAnyOutlineElementParent=function(e){return this._outlineElementNodeIdFactory.getRtlStorageNodeForOutlineElementParent(e)},e.prototype.GetDefaultOutlinePosition=function(t,n,i){var r=e.get_PageReader().getMarginOrigin(t),o=ys.OutlineReader.defaultHorizontalOffset*(n?-1:1);return new zs.i(r.get_x()+o,r.get_y()+ys.OutlineReader.defaultVerticalOffset)},e.prototype.setOutlineToDefaultPosition=function(e,t){if(Gl.n.get_instance().get_item(17)){var n=new ha.g;n.set(e),n.tryToRootAtPageContent();var i=this.GetDefaultOutlinePosition(n.get_origin(),ys.OutlineReader.isRtlForView(e),t);qs.v.setMuPosition(e,i.get_x(),i.get_y())}},e.prototype.setRtl=function(e,t){if(!Gl.n.get_instance().get_item(43)||!Qs.q.isNodeInTitle(e)){var n=t?11:9;e.setValue(is.b.layoutAlignmentSelf,n)}},e.get_PageReader=function(){return $s.PageReader.get_instance()},e.get_outlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=Ge.w.get_instance().resolve(ql.p))},e.set_outlineElementEditor=function(t){return e._outlineElementEditor=t,t},e.get_formatEditor=function(){return e._formattingEditor||(e._formattingEditor=Ge.w.get_instance().resolve(Vs.z))},e.set_formatEditor=function(t){return e._formattingEditor=t,t},e._outlineElementEditor=null,e._formattingEditor=null,e}();(0,o.l)(Js,"782f9828$OutlineEditor",null,[zl.a]);var Xs=function(){function e(){}return e.configure=function(e){e.register(Js).as(zl.a).singleInstance().usingFactory((function(){return new Js(e.resolve(Kl.z))})),e.register(Ws).as(ql.p).singleInstance().usingFactory((function(){return new Ws(e.resolveLazy(zl.a),e.resolveLazy(jl.v),e.resolveLazy(Ql.c),e.resolve(Jl),e.resolve(Xl.j),e.resolve(Yl.x))}))},e}();(0,o.l)(Xs,"8a88ffd2$OutlineLevelEditorsComponentConfiguration",null,[]);var Ys=function(){function e(){}return e.prototype.get_name=function(){return"Box4.OutlineLevelEditors"},e.prototype.configure=function(e){Xs.configure(e)},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Ys,"76268ba2$Box4OutlineLevelEditorsPackage",null,[s.u,u.s]);var Zs=function(){function e(){}return e.prototype.get_name=function(){return"Box4.TableEditors"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Zs,"4892c8e2$Box4TableEditorsPackage",null,[s.u,u.s]);var eu=function(){function e(){}return e.prototype.get_name=function(){return"Box4.TextLevelEditors"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(eu,"a7e3da42$Box4TextLevelEditorsPackage",null,[s.u,u.s]);var tu=n(7617),nu=n(1250),iu=(0,o.y)("901e454a$IReactContextualUILauncher"),ru=n(6685),ou=n(93),au=n(8056),lu=(0,o.y)("8284df3f$ILanguageEditor"),su=n(434),uu=n(9),cu=(0,o.y)("ff2320d1$IAutoCorrectOptionsDialog"),du=(0,o.y)("6dfc1d5a$ILanguageListHelper"),gu=(0,o.y)("d1a09448$IProofingRepeatedWordSectionBuilder"),pu=(0,o.y)("776ca949$IProofingContextMenuSectionFactory"),hu=n(5621),_u=n(7908),mu=n(4688),fu=function(){function e(e,t){this._reactRoot=null,this._externalCommandDefinitionMapping=null,this._hasInitialized=!1,this._contextualUIContainer=null,this._reactRoot=e,this._externalCommandDefinitionMapping=t,ye.p.get_instance().registerHandler(me.d.mouseDown,this.GetContextualUIContainer(),o.i(this,this.OnContextualUIMouseDown,"OnContextualUIMouseDown")),L.AFrameworkApplication.get_theActionManager().addAction(Fe.b.showFloatie,Ue.m.frame,Le.ActionManager.doNothingButReportHandler),L.AFrameworkApplication.get_theActionManager().addAction(Fe.b.showContextMenu,Ue.m.frame,Le.ActionManager.doNothingButReportHandler),L.AFrameworkApplication.get_theActionManager().addAction(Fe.b.showContextMenuWithFloatie,Ue.m.frame,Le.ActionManager.doNothingButReportHandler)}return e.prototype.get_IsChromeReady=function(){return ar.r.get_instance().isCompleted(7)},e.prototype.showFloatie=function(e,t,n){this.get_IsChromeReady()?this.SetupContextualUI(t).then((function(){var t={};t.target=e,mu.UISurfaces.getContextualAPIAsync().then((function(e){return appChrome.api.dispatch(e.showFloatie(t,n)),L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.showFloatie,2),null}))})):this.logUnableToLaunchContextualUI()},e.prototype.showContextMenu=function(e,t,n,i){void 0===n&&(n=null),void 0===i&&(i=null),this.get_IsChromeReady()?this.SetupContextualUI(null).then((function(){var r={};r.target=e,i&&(r.directionalHint=i),mu.UISurfaces.getContextualAPIAsync().then((function(e){return appChrome.api.dispatch(e.showContextMenu(r,t,n)),L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.showContextMenu,2),null}))})):this.logUnableToLaunchContextualUI()},e.prototype.showContextMenuAndFloatie=function(e,t,n){this.get_IsChromeReady()?this.SetupContextualUI(t).then((function(){var t={};t.target=e;var i={};i.target=e,mu.UISurfaces.getContextualAPIAsync().then((function(e){return appChrome.api.dispatch(e.showContextualUI(t,i,n)),L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.showContextMenuWithFloatie,2),null}))})):this.logUnableToLaunchContextualUI()},e.prototype.logUnableToLaunchContextualUI=function(){S.ULS.sendTraceTag(51431558,340,15,"Unable to launch contextual ui because ribbon hasn't loaded yet")},e.prototype.dismissContextMenu=function(){this.get_IsChromeReady()&&mu.UISurfaces.isLoaded()&&mu.UISurfaces.getContextualAPIAsync().then((function(e){return appChrome.api.dispatch(e.hideContextMenu()),null}))},e.prototype.dismissFloatie=function(){this.get_IsChromeReady()&&mu.UISurfaces.isLoaded()&&mu.UISurfaces.getContextualAPIAsync().then((function(e){return appChrome.api.dispatch(e.hideFloatie()),null}))},e.prototype.dismissContextualUI=function(){this.get_IsChromeReady()&&mu.UISurfaces.isLoaded()&&mu.UISurfaces.getContextualAPIAsync().then((function(e){return appChrome.api.dispatch(e.hideContextualUI()),null}))},e.prototype.InitializeContextualUI=function(e){return mu.UISurfaces.getContextualAPIAsync().then((function(t){return t.initializeContextualUI(e),null}))},e.prototype.SetupContextualUI=function(e){var t=this;return this._hasInitialized?(this.SetActiveFloatieGroups(e),Promise.resolve(null)):this.InitializeContextualUI(this.GetContextualUIContainer()).then((function(n){return t._hasInitialized=!0,t.SetActiveFloatieGroups(e),null}))},e.prototype.SetActiveFloatieGroups=function(e){var t=this,n=new Array(0);e&&e.length>0&&n.push(appChrome.actions.setActiveFloatieGroups(e)),n.length>0&&appChrome.api.dispatch(n);var i=new Array(0);mu.UISurfaces.getContextualAPIAsync().then((function(e){return i.push.apply(i,t._reactRoot.get_reactRibbonRootPoller().getUpdateActionsForCommands(e.selectors.getFloatieOnlyControlsMap())),i.length>0&&appChrome.api.dispatch(i),null}))},e.prototype.GetContextualUIContainer=function(){return this._contextualUIContainer?this._contextualUIContainer:(this._contextualUIContainer=fr.n.createElement("div"),this._contextualUIContainer.id="ReactContextualUIDiv",this._contextualUIContainer.style.position="absolute",this._contextualUIContainer.style.zIndex="1001",document.body.insertBefore(this._contextualUIContainer,document.body.firstChild),this._contextualUIContainer)},e.prototype.OnContextualUIMouseDown=function(e){return e.innerEvent&&e.innerEvent.target&&"input"===e.innerEvent.target.tagName.toLowerCase()&&St.FocusManager.instance().scopeChanged("ribbon"),!1},e.ContextMenuExternalId="ContextMenu",e}();(0,o.l)(fu,"51038ee$ReactContextualUILauncher",null,[iu]);var yu=n(1125),Cu=n(8538),Su=(0,o.y)("1852da9d$IRootCommandHandler"),bu=(0,o.y)("b12e7ce2$IReactRibbonRootPoller"),vu=n(9246),Tu=n(4079),Au=n(9886),Iu=n(8186),wu=n(7984),xu=n(5956),Eu=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t}(Ko.k);(0,o.l)(Eu,"25579644$CompoundButtonProps",Ko.k,[]);var Fu=n(1093),Pu=n(4434),Du=function(){return function(){this.iconSet=null,this.disabled=!1,this.hidden=!1,this.iconColor=null,this.fullDescriptionLabel=null,this.keytip=null,this.customTooltip=null}}();(0,o.l)(Du,"cf573847$CommonOptionalButtonProperties",null,[]);var Ru=function(e){function t(){var t=e.call(this)||this;return t.commandValueId=null,t.role=null,t.hideLabel=!1,t.supportsPreview=!1,t.lang=null,t}return(0,v.t)(t,e),t}(Du);(0,o.l)(Ru,"a96dd08a$OptionalButtonProperties",Du,[]);var Mu=function(e){function t(){var t=e.call(this)||this;return t.commandValueId=null,t.styles=null,t.roleInMenu=null,t.lang=null,t.ariaDescription=null,t}return(0,v.t)(t,e),t}(Du);(0,o.l)(Mu,"efa3114b$OptionalCompoundButtonProperties",Du,[]);var ku=function(e){function t(){var t=e.call(this)||this;return t.menuModel=null,t.hideLabel=!1,t.downChevronIcon=null,t.hideChevron=!1,t.hideIcon=!1,t.lang=null,t.labelInMenu=null,t.toggled=!1,t.roleInMenu=null,t}return(0,v.t)(t,e),t}(Du);(0,o.l)(ku,"4aea8838$OptionalFlyoutAnchorProperties",Du,[]);var Nu=function(e){function t(){var t=e.call(this)||this;return t.secondaryText=null,t.styles=null,t.flipIconInRtl=!1,t}return(0,v.t)(t,e),t}(Ru);(0,o.l)(Nu,"cb4053e$OptionalPersonaButtonProperties",Ru,[]);var Lu=function(e){function t(){var t=e.call(this)||this;return t.toggled=!1,t.roleInMenu=null,t.toggleUsingIcon=!1,t}return(0,v.t)(t,e),t}(Du);(0,o.l)(Lu,"2ae4b258$OptionalToggleButtonProperties",Du,[]);var Bu=function(){return function(){this.personaType=null,this.hostAppPersonaId=null,this.olsPersonaId=null,this.locationId=null,this.aadObjectId=null,this.satoriId=null,this.smtp=null,this.permanentEntryId=null,this.displayName=null}}();(0,o.l)(Bu,"639aa1d7$PersonaIdentifiers",null,[]);var Ou=function(){return function(){this.identifiers=null,this.displayName=null,this.firstName=null,this.lastName=null,this.isUnauthenticatedSender=!1,this.isTier3Brand=!1,this.personaCoinName=null,this.personaCoinColor=null}}();(0,o.l)(Ou,"c860fac9$PersonaInfo",null,[]);var Uu=n(5894),Hu=function(){function e(){}return e.prototype.getStateProps=function(e,t){switch(t){case"ColorPickerModel":return appChrome.selectors.getColorPickerState(e);case"ToggleButtonModel":return this.GetPropsForToggleButtonModel(e);case"GalleryModel":return appChrome.selectors.getGalleryState(e);case"SplitButtonModel":return appChrome.selectors.getSplitButtonState(e)}return{}},e.prototype.GetPropsForToggleButtonModel=function(e){var t={};return t[gr.e.On]=appChrome.selectors.getButtonToggleState(e),t},e}();(0,o.l)(Hu,"35f48333$ReactStatePropsSelector",null,[]);var Gu=function(){function e(e,t,n,i){this._rootPoller=null,this._rootUser=null,this._rootType=0,this._externalUICommandDefinitionMapping=null,this._reactStatePropsSelector=null,this._successfullyPolledPopulateCommands=null,this._rootPoller=e,this._rootUser=t,this._rootType=n,this._externalUICommandDefinitionMapping=i,this._successfullyPolledPopulateCommands={},this._reactStatePropsSelector=new Hu}return e.prototype.skipPopulation=function(e){var t=e.populationProps.get_populateQueryCommandId();return e.populationProps.get_populateOnlyOnce()&&t in this._successfullyPolledPopulateCommands},e.prototype.getReduxActions=function(t,n,i){void 0===i&&(i=0);var r=new Array(0);if(!this.skipPopulation(t)){var o=t.populationProps.get_populateQueryCommandId(),a={};a.MenuId=t.get_externalUxCommand();var l=a;if((1&this._rootPoller.pollForCommandState(this._rootUser,this._rootType,o,o,a,i))>0&&l.MenuItems)switch(this._successfullyPolledPopulateCommands[o]=!0,n){case"ComboBoxModel":r.push(e.GetPopulateComboBoxAction(t,l));break;case"FlyoutAnchorModel":case"PreviewGalleryModel":case"SplitButtonModel":case"StatefulSplitButtonModel":r.push.apply(r,this.GetUpdateActionsForMenuControls(t.get_externalUxCommand(),n,l.MenuItems))}}return r},e.prototype.GetUpdateActionsForMenuControls=function(e,t,n){for(var i=new Array(0),r=new Array(0),o=new Array(0),a=new Array(0),l=0;l<n.MenuSectionList.length;l++){var s=(0,y.e)(zo.x,n.MenuSectionList[l]);if(s){var u=null,c=new Array(0);_r.n.isNullOrUndefined(s.Title)||(u=s.Title);for(var d=0;d<s.ControlList.length;d++){var g=(0,y.e)(xu.i,s.ControlList[d]);if(!g||g.ExternalId){var p=(0,y.e)(Au.e,s.ControlList[d]);if(p)this.PopulateCheckMarkToggleButton(p,i,r,c);else{var h=(0,y.e)(Uu.d,s.ControlList[d]);if(h)this.PopulateToggleButton(h,i,r,c);else{var _=(0,y.e)(qo,s.ControlList[d]);if(_)this.PopulatePersonaButton(_,i,r,c);else{var m=(0,y.e)(Ko.k,s.ControlList[d]);if(m)this.PopulateButton(m,i,r,c),m.MenuItemsStatefulData&&Ln.AppChromeUtils.appChromeContainsAction("setStatefulSplitButtonMenuItemsStatefulData")&&i.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(e,m.MenuItemsStatefulData));else{var f=(0,y.e)(Iu.z,s.ControlList[d]);if(f)this.PopulateColorPicker(f,i,r,c);else{var C=(0,y.e)(Fu.b,s.ControlList[d]);if(C)this.PopulateGallery(C,i,r,c);else{var S=(0,y.e)(Vo.b,s.ControlList[d]);S&&(this.PopulateFlyoutAnchor(S,i,r,c),"StatefulSplitButtonModel"===t&&a.push(S.ExternalId))}}}}}}}}n.UpdateDynamically&&o.push(appChrome.api.menuSection(c,u,s.Lang))}}return n.UpdateDynamically&&i.push(appChrome.actions.updateMenu(e,o,n.Title,n.AriaLabel,n.ShouldAutoOpen,n.AriaRoleDescription)),r.length>0&&i.splice(0,0,appChrome.actions.addControls(r)),a.length>0&&Ln.AppChromeUtils.appChromeContainsAction("setStatefulSplitButtonMruBypassControls")&&i.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(e,a)),i},e.prototype.PopulateButton=function(e,t,n,i){i.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)?(e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText)),e.Description&&t.push(appChrome.actions.updateCompoundButtonDescription(e.ExternalId,e.Description))):(e.Description||o.r(Eu,e)?Ln.AppChromeUtils.apiExists("createCompoundButtonModel")?n.push(appChrome.api.createCompoundButtonModel(e.ExternalId,e.LabelText,e.Description,(0,U.m)(new Mu,{iconSet:new Pu.x(this.GetIconName(e)).iconSet,keytip:e.KeyTip,roleInMenu:e.RoleInMenu,ariaDescription:e.AriaDescription}))):n.push(appChrome.api.compoundButtonControl(e.ExternalId,e.LabelText,e.Description,this.GetIconName(e),e.KeyTip,null,null,null,e.RoleInMenu,null,null,null,e.AriaDescription)):Ln.AppChromeUtils.apiExists("createButtonModel")?n.push(appChrome.api.createButtonModel(e.ExternalId,e.LabelText,(0,U.m)(new Ru,{iconSet:new Pu.x(this.GetIconName(e)).iconSet,keytip:e.KeyTip,supportsPreview:!!e.CommandPreviewId&&!!e.CommandRevertId,customTooltip:e.LabelText!==e.Alt?e.Alt:null}))):n.push(appChrome.api.buttonControl(e.ExternalId,e.LabelText,this.GetIconName(e),void 0,void 0,e.KeyTip,void 0,void 0,void 0,!!e.CommandPreviewId&&!!e.CommandRevertId,void 0,e.LabelText!==e.Alt?e.Alt:null)),this._externalUICommandDefinitionMapping.addCommandToMaps((0,U.m)(new vu.d(e.ExternalId,e.Command),{menuItemId:e.MenuItemId,queryCommandId:e.QueryCommand,commandPreviewId:e.CommandPreviewId,commandRevertId:e.CommandRevertId}))),e.Lang&&Ln.AppChromeUtils.appChromeContainsAction("setControlLanguage")&&t.push(appChrome.actions.setControlLanguage(e.ExternalId,e.Lang))},e.prototype.PopulateCheckMarkToggleButton=function(e,t,n,i){i.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)?e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText)):(Ln.AppChromeUtils.apiExists("createToggleButtonModel")?n.push(appChrome.api.createToggleButtonModel(e.ExternalId,e.LabelText,(0,U.m)(new Lu,{iconSet:new Pu.x(this.GetIconName(e)).iconSet,keytip:e.KeyTip,toggled:e.IsChecked,fullDescriptionLabel:e.Description,roleInMenu:e.AriaLabel,customTooltip:e.LabelText!==e.Alt?e.Alt:null,toggleUsingIcon:!!e.CheckedImageClass}))):Ln.AppChromeUtils.apiExists("toggleButtonControl")&&n.push(appChrome.api.toggleButtonControl(e.ExternalId,e.LabelText,this.GetIconName(e),e.KeyTip,e.IsChecked,void 0,e.Description,e.AriaLabel,e.LabelText!==e.Alt?e.Alt:null,!!e.CheckedImageClass)),this._externalUICommandDefinitionMapping.addCommandToMaps((0,U.m)(new vu.d(e.ExternalId,e.Command),{menuItemId:e.MenuItemId,queryCommandId:e.QueryCommand})))},e.prototype.PopulateToggleButton=function(e,t,n,i){i.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)?e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText)):(Ln.AppChromeUtils.apiExists("createToggleButtonModel")?n.push(appChrome.api.createToggleButtonModel(e.ExternalId,e.LabelText,(0,U.m)(new Lu,{iconSet:new Pu.x(this.GetIconName(e)).iconSet,keytip:e.KeyTip,fullDescriptionLabel:e.Description,roleInMenu:e.AriaLabel}))):Ln.AppChromeUtils.apiExists("toggleButtonControl")&&n.push(appChrome.api.toggleButtonControl(e.ExternalId,e.LabelText,this.GetIconName(e),e.KeyTip,void 0,void 0,e.Description,e.AriaLabel)),this._externalUICommandDefinitionMapping.addCommandToMaps((0,U.m)(new vu.d(e.ExternalId,e.Command),{menuItemId:e.MenuItemId,queryCommandId:e.QueryCommand})))},e.prototype.PopulatePersonaButton=function(e,t,n,i){i.push(e.ExternalId);var r=this.GetPersonaInfoFromProps(e);appChrome.selectors.isControlDefined(e.ExternalId)?e.LabelText&&t.push(appChrome.actions.setPersonaButtonCoauthor(e.ExternalId,r,e.LabelText)):Ln.AppChromeUtils.apiExists("createPersonaButtonModel")&&n.push(appChrome.api.createPersonaButtonModel(e.ExternalId,r,e.LabelText,(0,U.m)(new Nu,{role:e.RoleInMenu,fullDescriptionLabel:e.AriaDescription})))},e.prototype.PopulateFlyoutAnchor=function(e,t,n,i){if(i.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId))e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText));else{var r=!(void 0===e.ImageIsVisible||null===e.ImageIsVisible||e.ImageIsVisible),o=!(void 0===e.ImageIsVisible||null===e.ImageIsVisible)&&e.ImageIsVisible;Ln.AppChromeUtils.apiExists("createFlyoutAnchorModel")?n.push(appChrome.api.createFlyoutAnchorModel(e.ExternalId,e.LabelText,(0,U.m)(new ku,{iconSet:new Pu.x(this.GetIconName(e)).iconSet,keytip:e.KeyTip,hideIcon:r,toggled:o,roleInMenu:e.AriaLabel}))):n.push(appChrome.api.flyoutAnchorControl(e.ExternalId,e.LabelText,this.GetIconName(e),void 0,e.KeyTip,void 0,void 0,void 0,void 0,void 0,void 0,void 0,r,o,e.AriaLabel)),this._externalUICommandDefinitionMapping.addCommandToMaps((0,U.m)(new vu.d(e.ExternalId,e.Command),{queryCommandId:e.QueryCommand,populationProps:new Tu.s(e.PopulateQueryCommand,e.PopulateOnlyOnce)}))}e.Menu&&t.push.apply(t,this.GetUpdateActionsForMenuControls(e.ExternalId,"FlyoutAnchorModel",e.Menu)),e.Lang&&Ln.AppChromeUtils.appChromeContainsAction("setControlLanguage")&&t.push(appChrome.actions.setControlLanguage(e.ExternalId,e.Lang))},e.prototype.PopulateColorPicker=function(e,t,n,i){e.McuLayout&&i.push(e.McuExternalId),i.push(e.ExternalId);var r=0;appChrome.selectors.isControlDefined(e.ExternalId)?e.McuLayout&&(r=this._reactStatePropsSelector.getStateProps(e.ExternalId,"ColorPickerModel").columnCount):(e.McuLayout&&(Ln.AppChromeUtils.apiExists("createColorPickerModel")?n.push(appChrome.api.createColorPickerModel(e.McuExternalId,e.Width)):n.push(appChrome.api.colorPickerControl(e.McuExternalId,e.Width)),this._externalUICommandDefinitionMapping.addCommandToMaps((0,U.m)(new vu.d(e.McuExternalId,e.Command),{commandPreviewId:e.CommandPreviewId,commandRevertId:e.CommandRevertId})),r=e.Width),Ln.AppChromeUtils.apiExists("createColorPickerModel")?n.push(appChrome.api.createColorPickerModel(e.ExternalId,e.Width)):n.push(appChrome.api.colorPickerControl(e.ExternalId,e.Width)),this._externalUICommandDefinitionMapping.addCommandToMaps((0,U.m)(new vu.d(e.ExternalId,e.Command),{commandPreviewId:e.CommandPreviewId,commandRevertId:e.CommandRevertId})));for(var o=new Array(0),a=new Array(0),l=0;l<e.Colors.length;l++){var s=e.Colors[l];l<r?o.push(appChrome.api.colorPickerCell(s.Color,s.DisplayColor,s.Alt)):a.push(appChrome.api.colorPickerCell(s.Color,s.DisplayColor,s.Alt))}o.length>0&&t.push(appChrome.actions.populateColorPickerCells(e.McuExternalId,o)),t.push(appChrome.actions.populateColorPickerCells(e.ExternalId,a))},e.prototype.GetIconName=function(e){return e.Image32by32Class?this._externalUICommandDefinitionMapping.getExternalIconIdByLegacyIconId(e.Image32by32Class):e.Image16by16Class?this._externalUICommandDefinitionMapping.getExternalIconIdByLegacyIconId(e.Image16by16Class):e.ExternalImageId},e.prototype.PopulateGallery=function(e,t,n,i){var r=e.ExternalGalleryId||e.ExternalId,o=e.ExternalId;if(i.push(r),!appChrome.selectors.isControlDefined(r)){if(3!==e.Type)return;n.push(appChrome.api.iconGalleryControl(r,e.Width,[appChrome.api.gallerySection(new Array(0),o)],e.GalleryStyle))}t.push.apply(t,this.GetPopulateActionsFromGalleryButtonPropsArray(e.GalleryItems,o,r))},e.prototype.GetPersonaInfoFromProps=function(e){return e?(0,U.m)(new Ou,{displayName:e.DisplayName,personaCoinColor:e.ImageBackColor,identifiers:(0,U.m)(new Bu,{personaType:"User",smtp:e.PersonaId})}):null},e.prototype.GetPopulateActionsFromGalleryButtonPropsArray=function(e,t,n){void 0===n&&(n=null);for(var i=new Array(0),r=new Array(0),o=new Array(0),a=0;a<e.length;a++){var l=e[a],s=_r.n.isNullOrEmptyString(l.ExternalId)?l.Id:l.ExternalId;switch(r.push(s),l.get_Type()){case 1:var u=l;o.push(appChrome.api.characterCodeGalleryButton(s,u.Character,u.Style?u.Style:null,l.Alt,l.IsDisabled));break;case 2:o.push(appChrome.api.fontStyleGalleryButton(s,l.LabelText,l.Style,l.Alt,l.IsDisabled,l.PreviewStyleLabel));break;case 3:null!=l.IsDisabled?o.push(appChrome.api.iconGalleryButton(s,l.Icon,l.LabelText,l.Alt,l.FullIconStyle,l.PreviewIconStyle,l.IsDisabled)):o.push(appChrome.api.iconGalleryButton(s,l.Icon,l.LabelText,l.Alt,l.FullIconStyle,l.PreviewIconStyle));break;case 4:o.push(appChrome.api.listGalleryButton(s,l.LevelInfo,l.Alt,l.IsDisabled));break;case 5:o.push(appChrome.api.tableStyleGalleryButton(s,l.TableCellStyles,l.TableStyles,l.Alt,l.IsDisabled));break;case 7:o.push(appChrome.api.changeColorsGalleryButton(s,l.TableCellStyles,l.TableStyles,l.Alt,l.IsDisabled));break;case 6:o.push(appChrome.api.pageNumberGalleryButton(s,l.Text,l.Alt,l.IsDisabled))}this._externalUICommandDefinitionMapping.addCommandToMaps((0,U.m)(new vu.d(s,l.Command),{queryCommandId:l.QueryCommand,menuItemId:l.MenuItemId}))}return i.push(appChrome.actions.addControls(o)),n?i.push(appChrome.actions.updateGallerySectionItems(n,t,r)):i.push(appChrome.actions.populateGalleryItems(t,r)),i},e.GetPopulateComboBoxAction=function(e,t){for(var n=new Array(0),i=0;i<t.MenuItems.MenuSectionList.length;i++){var r=t.MenuItems.MenuSectionList[i];r.Title&&n.push(appChrome.api.comboBoxHeader("Header-"+i.toString(),r.Title));for(var o=0;o<r.ControlList.length;o++){var a=(0,y.e)(wu.z,r.ControlList[o]);a&&n.push(appChrome.api.comboBoxItem(a.MenuItemId,a.LabelText,a.Styles,a.CommandValueId,a.AriaLabel,a.Data))}i<t.MenuItems.MenuSectionList.length-1&&n.push(appChrome.api.comboBoxDivider("Divider-"+i.toString()))}return appChrome.actions.populateComboBoxOptions(e.get_externalUxCommand(),n)},e}();(0,o.l)(Gu,"e544549c$ReactPopulateQueryCommandPoller",null,[]);var Wu=n(5304),Vu=n(325),$u=function(){function e(e,t,n,i,r){this._externalUICommandDefinitionMapping=null,this._rootPoller=null,this._rootUser=null,this._rootType=0,this._reactPopulateQueryCommandPoller=null,this._externalUICommandDefinitionMapping=n,this._rootPoller=e,this._rootUser=t,this._rootType=i,this._reactPopulateQueryCommandPoller=r}return e.prototype.getReduxActions=function(e,t,n){var i=new Array(0);if(this.IsContainerModelType(t)){var r=this.GetStateActionsForContainerModelType(e,t,n);null!=r&&i.push.apply(i,r)}else if(e){var o=this.GetPollResult(e,n);if(mr.b.visible in n&&i.push(this.GetHiddenStateAction(e.get_externalUxCommand(),!n[mr.b.visible])),i.push(this.getEnabledDisabledAction(e.get_externalUxCommand(),this.IsCommandDisabled(o))),void 0!==n[mr.b.labelText]&&null!==n[mr.b.labelText]&&i.push(this.GetSetControlLabelAction(e.get_externalUxCommand(),n[mr.b.labelText])),null!=t){var a=this.GetControlStateActions(e.get_externalUxCommand(),t,n,o);null!=a&&i.push.apply(i,a)}}return i},e.prototype.getEnabledDisabledActionBasedOnChildrenCommands=function(e,t){var n=new Array(0),i={};switch(t){case"FlyoutAnchorModel":i=appChrome.selectors.getFlyoutAnchorMenuItems(e);break;case"SplitButtonModel":var r=appChrome.selectors.getSplitButtonState(e),o=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(r.command);if(o){var a=this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,o.get_commandId());n.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(e,!a))}return n;default:return null}var l=!1;for(var s in i){var u={key:s,value:i[s]},c=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(u.key);if(_r.n.isNullOrUndefined(c))l=!0;else if(a=this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,c.get_commandId(),{SourceControlId:c.get_externalUxCommand()}))return n.push(this.getEnabledDisabledAction(e,!1)),n}return n.push(this.getEnabledDisabledAction(e,!l)),n},e.prototype.getEnabledDisabledAction=function(e,t){return appChrome.actions.updateControlEnabledDisabledState(e,t)},e.prototype.GetHiddenStateAction=function(e,t){return appChrome.actions.updateControlHiddenState(e,t)},e.prototype.GetGalleryQueryCommandActions=function(e){var t=new Array(0),n=e.items,i=e.sections,r=-1,o=null;if(n)o=this.AddGalleryButtonActions(n,e,t,(0,g.m)((function(){return r}),(function(e){return r=e})));else if(i)for(var a=0,l=i;a<l.length;a++){var s=l[a],u=this.AddGalleryButtonActions(s.galleryButtons,e,t,(0,g.m)((function(){return r}),(function(e){return r=e})));u&&(o=u)}return t.push(appChrome.actions.updateGallerySelectedId(e.ExternalUxId,o)),t.push(this.getEnabledDisabledAction(e.ExternalUxId,!1)),e.isListGallery&&r>0&&t.push(appChrome.actions.updateListGalleryTextDirection(e.ExternalUxId,2===r)),t},e.prototype.AddGalleryButtonActions=function(e,t,n,i){var r=null;i.val=-1;for(var o=0,a=e;o<a.length;o++){var l=a[o],s={};s.SourceControlId=l;var u=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(l);if(u){var c=this.GetPollResult(u,s);n.push(this.getEnabledDisabledAction(l,this.IsCommandDisabled(c)));var d=this.GetControlStateActions(l,appChrome.selectors.getModelType(l),s,c);d&&n.push.apply(n,d),s[to.u.On]&&(r=l),void 0!==s[mr.b.labelText]&&null!==s[mr.b.labelText]&&n.push(this.GetSetControlLabelAction(u.get_externalUxCommand(),s[mr.b.labelText])),s[to.u.IsRtl]&&i.val<0&&(i.val=s[to.u.IsRtl])}}return r},e.prototype.GetPreviewGalleryActions=function(e){var t=new Array(0),n=null;if(!e)return null;var i=this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,e.get_commandId());if(t.push(this.getEnabledDisabledAction(e.get_externalUxCommand(),!i)),e.previewControlIds){for(var r=new Array(0),o=0;o<e.previewControlIds.length;o++){var a={},l=e.previewControlIds[o];a.SourceControlId=l;var s=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(l);this.GetPollResult(s||e,a),a[to.u.On]&&(n=a.SourceControlId),this.HandleSetControlIconRequest(l,a,t);var u=(0,y.e)(Wu.f,a[to.u.GalleryButtonProps]);if(u){if(r.push(u),i){var c=this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,u.Command);u.IsDisabled=!c}}else;}r.length>0&&t.push.apply(t,this._reactPopulateQueryCommandPoller.GetPopulateActionsFromGalleryButtonPropsArray(r,e.get_externalUxCommand())),t.push(appChrome.actions.updateGallerySelectedId(e.get_externalUxCommand(),n))}return t},e.prototype.GetControlStateActions=function(e,t,n,i){if(this.IsQueryCommandSuccessful(i)){var r=new Array(0);switch(t){case"ToggleButtonModel":r.push(this.GetToggleButtonAction(e,n[gr.e.On]));break;case"CheckboxModel":r.push(this.GetCheckboxAction(e,n[gr.e.On]));break;case"ComboBoxModel":var o=n[jr.g.Key];o?r.push(appChrome.actions.updateComboBoxKey(e,o,n[jr.g.Value])):r.push(appChrome.actions.updateComboBoxValue(e,n[jr.g.Value]));break;case"SplitButtonModel":r.push(this.GetToggleButtonAction(e,n[To.z.On]));break;case"SpinButtonModel":r.push(appChrome.actions.updateSpinButton(e,n[So.Number],Vu.r.convertUnitTypeToString(n[So.UnitType]),n[So.Text],n[So.MaxValue],n[So.Alt]));break;case"ColorPickerModel":r.push(appChrome.actions.updateColorPickerSelectedColor(e,n[br.IndexColorSelected]));break;case"PageNumberGalleryButtonModel":r.push(appChrome.actions.updatePageNumberGalleryButtonText(e,n[to.u.Text]));break;case"CompoundButtonModel":n[gr.e.Description]&&r.push(appChrome.actions.updateCompoundButtonDescription(e,n[gr.e.Description])),gr.e.On in n&&r.push(this.GetToggleButtonAction(e,n[gr.e.On]));break;case"PeopleWell":var a=n[Zr.g.LabelText],l=n[Zr.g.LabelTextUserGeneratedPlaceholderReplacements],s=a;l&&l.length>0&&(s=String.format.apply(null,[s].concat(l))),r.push(this.GetUpdatePeopleWellAction(e,s));break;case"SliderModel":r.push(appChrome.actions.updateSliderValue(e,n[mo.u.Value],0,n[mo.u.MaxValue],n[mo.u.Text]));break;case"FlyoutAnchorModel":Zr.g.ImageIsVisible in n&&r.push(appChrome.actions.hideFlyoutAnchorIcon(e,!n[Zr.g.ImageIsVisible]))}return this.HandleSetIconColorRequest(e,n,r),this.HandleSetControlIconRequest(e,n,r),this.HandleSetControlIconSetRequest(e,n,r),this.HandleSetControlCustomTooltipRequest(e,n,r),this.HandleAdditionalReduxAction(n,r),r}return null},e.prototype.GetStateActionsForContainerModelType=function(e,t,n){switch(t){case"PreviewGalleryModel":return this.GetPreviewGalleryActions(e);case"GalleryModel":return this.GetGalleryQueryCommandActions(n)}return null},e.prototype.IsContainerModelType=function(e){return"GalleryModel"===e||"PreviewGalleryModel"===e},e.prototype.GetToggleButtonAction=function(e,t){return appChrome.actions.toggleButton(e,t)},e.prototype.GetCheckboxAction=function(e,t){return appChrome.actions.toggleCheckbox(e,t)},e.prototype.GetSetControlCustomTooltipAction=function(e,t){return appChrome.actions.setControlCustomTooltip(e,t)},e.prototype.GetSetControlIconAction=function(e,t){return appChrome.actions.setControlIcon(e,t)},e.prototype.GetSetControlIconSetAction=function(e,t){return appChrome.actions.setControlIconSet(e,t)},e.prototype.GetSetControlLabelAction=function(e,t){return appChrome.actions.setControlLabel(e,t)},e.prototype.HandleSetControlCustomTooltipRequest=function(e,t,n){var i=(0,y.e)(String,t[mr.b.customTooltip]);i&&Ln.AppChromeUtils.appChromeContainsAction("setControlCustomTooltip")&&n.push(this.GetSetControlCustomTooltipAction(e,i))},e.prototype.HandleSetControlIconRequest=function(e,t,n){var i=(0,y.e)(String,t[mr.b.Icon]);i&&n.push(this.GetSetControlIconAction(e,i))},e.prototype.HandleSetControlIconSetRequest=function(e,t,n){var i=(0,y.e)(Object,t[mr.b.IconSet]);i&&n.push(this.GetSetControlIconSetAction(e,i))},e.prototype.HandleSetIconColorRequest=function(e,t,n){var i=(0,y.e)(String,t[mr.b.iconColor]);i&&n.push(appChrome.actions.updateIconColor(e,i))},e.prototype.HandleAdditionalReduxAction=function(e,t){var n=(0,y.e)(Array,e[mr.b.reduxActions]);n&&t.push.apply(t,n)},e.prototype.GetPollResult=function(e,t){return t.MenuItemId=e.menuItemId,this._rootPoller.pollForCommandState(this._rootUser,this._rootType,e.get_commandId(),e.queryCommandId,t)},e.prototype.IsCommandDisabled=function(e){return(1&e)<1},e.prototype.IsQueryCommandSuccessful=function(e){return(2&e)>0},e.prototype.GetUpdatePeopleWellAction=function(e,t){return appChrome.actions.updatePeopleWell(this.GetCoauthorsInfo(e),t)},e.prototype.GetCoauthorsInfo=function(e){var t=new Array(0),n={},i=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(e).populationProps.get_populateQueryCommandId();this._rootPoller.pollForCommandState(this._rootUser,this._rootType,"1285265560",i,n);var r=n.MenuItems;if(!r)return t;for(var o=r.MenuSectionList[0],a=0;a<o.ControlList.length;a++){var l=o.ControlList[a],s={};s.name=l.Alt,s.id=l.MenuItemId,s.description=l.Description,s.color=l.ImageBackColor,s.joinTime=l.JoinTimeInMS,s.imageUrl=l.ImageUrl,s.activeStatus=l.ActiveStatus,s.isAnonymous=l.IsAnonymous,s.canJump=l.CanJump,s.chatCapable=l.ChatCapable,s.upn=l.Upn,t.push(s)}return t},e}();(0,o.l)($u,"89c3163a$ReactQueryCommandPoller",null,[]);var zu=n(1802),Ku=function(){function e(e,t,n){this._externalUICommandDefinitionMapping=null,this._rootUser=null,this._statePropsSelector=null,this._queryCommandPoller=null,this._reactPopulateQueryCommandPoller=null,this._externalUICommandDefinitionMapping=e,this._rootUser=t;var i=new zu.g;this._statePropsSelector=new Hu,this._reactPopulateQueryCommandPoller=new Gu(i,this._rootUser,n,this._externalUICommandDefinitionMapping),this._queryCommandPoller=new $u(i,this._rootUser,this._externalUICommandDefinitionMapping,n,this._reactPopulateQueryCommandPoller)}return e.prototype.getPollForStateAndUpdateActions=function(){var e=new Array(0);if(!Ln.AppChromeUtils.appChromeAlreadyLoaded())return e;e.push.apply(e,this.GetUpdateContextualTabsActions());var t=this.GetDisableControlsInTabsActions(appChrome.selectors.getSelectedTabId());if(t.length>0)e.push.apply(e,t);else{for(var n=appChrome.selectors.getActiveControlIds(),i=0,r=this.GetDisabledControlsInGroups(appChrome.selectors.getActiveGroupIds());i<r.length;i++){var o=r[i];e.push(appChrome.actions.updateControlEnabledDisabledState(o,!0)),delete n[o]}e.push.apply(e,this.getUpdateActionsForCommands(n))}return e},e.prototype.pollForStateAndUpdateCommands=function(e){if(Ln.AppChromeUtils.appChromeAlreadyLoaded()){var t=this.getUpdateActionsForCommands(e);appChrome.api.dispatch(t)}},e.prototype.populateControlMenu=function(e,t,n){if(void 0===n&&(n=0),!_r.n.isNullOrUndefined(e)&&e.populationProps&&!this._reactPopulateQueryCommandPoller.skipPopulation(e)){var i=this._reactPopulateQueryCommandPoller.getReduxActions(e,t,n);if(i.length>0)return appChrome.api.dispatch(i),!0}return!1},e.prototype.getUpdateActionsForCommands=function(e){var t=new Array(0);for(var n in e){var i={key:n,value:e[n]},r=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(i.key),o=i.value,a=this._statePropsSelector.getStateProps(i.key,o);if(_r.n.isNullOrUndefined(r)){a.ExternalUxId=i.key;var l=this._queryCommandPoller.getEnabledDisabledActionBasedOnChildrenCommands(i.key,i.value);l&&l.length>0&&t.push.apply(t,l)}else a.MenuItemId=r.menuItemId,a.SourceControlId=i.key;t.push.apply(t,this._queryCommandPoller.getReduxActions(r,o,a))}return t},e.prototype.GetUpdateContextualTabsActions=function(){for(var e=new Array(0),t=appChrome.selectors.getContextualTabIds(),n=0;n<t.length;n++){var i=this._externalUICommandDefinitionMapping.getTabCommandByExternalUxId(t[n]);if(i){var r=this._rootUser.isRootCommandEnabled(i);e.push(appChrome.actions.activateDeactivateContextualTab(t[n],r))}}return e},e.prototype.GetDisableControlsInTabsActions=function(e){var t=new Array(0),n=this._externalUICommandDefinitionMapping.getTabCommandByExternalUxId(e);n&&(this._rootUser.isRootCommandEnabled(n)||t.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(e,!0)));return t},e.prototype.GetDisabledControlsInGroups=function(e){for(var t=new Array(0),n=0,i=e;n<i.length;n++){var r=i[n],o=this._externalUICommandDefinitionMapping.getGroupsMetadataByExternalUxId(r);if(o)for(var a=0,l=o;a<l.length;a++){var s=l[a];if(!this._rootUser.isRootCommandEnabled(s.commandId)){var u=s.externalUxCommandIds;u||(u=appChrome.selectors.getVisibleControlsInGroup(s.externalUxGroupId)),t.push.apply(t,u)}}}return t},e.prototype.GetDisableControlsInGroupsActions=function(e){for(var t=new Array(0),n=0,i=e;n<i.length;n++){var r=i[n],o=this._externalUICommandDefinitionMapping.getGroupsMetadataByExternalUxId(r);if(o)for(var a=0,l=o;a<l.length;a++){var s=l[a];if(!this._rootUser.isRootCommandEnabled(s.commandId))if(s.externalUxCommandIds)for(var u=0,c=s.externalUxCommandIds;u<c.length;u++){var d=c[u];t.push(appChrome.actions.updateControlEnabledDisabledState(d,!0))}else t.push(appChrome.actions.updateDisabledEnabledStateForControlsInGroup(s.externalUxGroupId,!0))}}return t},e}();(0,o.l)(Ku,"28bcc70b$ReactRibbonRootPoller",null,[bu]);var qu=function(){function e(e,t,n){void 0===n&&(n=null),this._reactCommandDefinitionMapping=null,this._reactRibbonRootPoller=null,this._lastPollTime=null,this.$$pf_RootUser=null,this._reactCommandDefinitionMapping=t,e.addRoot(this),this.set_rootUser(n)}return e.prototype.get_LastPollTime=function(){return this._lastPollTime||(this._lastPollTime=new Date,this._lastPollTime.setTime(0)),this._lastPollTime},e.prototype.set_LastPollTime=function(e){return this._lastPollTime=e,e},e.prototype.get_rootType=function(){return 2},e.prototype.get_rootUser=function(){return this.$$pf_RootUser},e.prototype.set_rootUser=function(e){return this.$$pf_RootUser=e,e},e.prototype.get_reactRibbonRootPoller=function(){return this._reactRibbonRootPoller||(this._reactRibbonRootPoller=new Ku(this._reactCommandDefinitionMapping,this.get_rootUser(),this.get_rootType())),this._reactRibbonRootPoller},e.prototype.commitAnyPendingChange=function(){var e=document.activeElement;ji.s.isEditable(e)&&e.blur()},e.prototype.executeCommand=function(e,t,n,i,r,o,a,l){if(void 0===l&&(l=2),!_r.n.isNullOrUndefined(this.get_rootUser())){var s=new go.f;s.CommandLocation=l,s.InvocationMethod=i,s.CommandTabName=n,this.CheckFloodgateSurveyInfo(),this.get_rootUser().executeRootCommand(e,t,s,o,a)}},e.prototype.getPollForStateAndUpdateActions=function(){return _r.n.isNullOrUndefined(this.get_rootUser())?new Array(0):this.get_reactRibbonRootPoller().getPollForStateAndUpdateActions()},e.prototype.pollForStateAndUpdate=function(){var e=this.getPollForStateAndUpdateActions();e.length>0&&(this.set_LastPollTime(new Date),appChrome.api.dispatch(e))},e.prototype.updatePeopleWellControl=function(){if(Ln.AppChromeUtils.appChromeAlreadyLoaded()){var e={PeopleWell:"PeopleWell"};this.get_reactRibbonRootPoller().pollForStateAndUpdateCommands(e)}},e.prototype.updateDocChatControl=function(){if(Ln.AppChromeUtils.appChromeAlreadyLoaded()){var e={DocChat:"ButtonModel"};this.get_reactRibbonRootPoller().pollForStateAndUpdateCommands(e)}},e.prototype.updateControl=function(e){},e.prototype.CheckFloodgateSurveyInfo=function(){var e=Ge.w.get_instance().tryResolve(yu.t);e?e.logActivity("SLRCommandUsed","FGSLRUsageEnabled"):S.ULS.sendTraceTag(36741406,340,50,"ISystemInitiatedFeedback was null")},e}();(0,o.l)(qu,"2a21b403$ReactRibbonRoot",null,[Cu.l,Su]);var ju=function(){function e(t){this._standaloneRoot=null;var n=new Uo;n.ImageUpArrow=n.ImageDownArrow=n.ImageSideArrow=n.ImageCheckMark=n.ImageUncheckMark=n.ImageDownArrow8by8=n.ImageUpArrow8by8=t,n.ImageUpArrowClass=Ct.ImageClusteringHelper.getImageClass("RibbonUpArrow_5x3x32"),n.ImageDownArrowClass=Ct.ImageClusteringHelper.getImageClass("SplitButtonArrow_5x3x32"),n.ImageUpArrow8by8Class=Ct.ImageClusteringHelper.getImageClass("RibbonUpArrow_8x8x32"),n.ImageDownArrow8by8Class=Ct.ImageClusteringHelper.getImageClass("SplitButtonArrow_8x8x32"),n.ImageSideArrowClass=Ct.ImageClusteringHelper.getImageClass("SubmenuFlyoutArrow_13x13x32"),n.ImageCheckMarkClass=Ct.ImageClusteringHelper.getImageClass("CheckboxChecked_16x16x32"),n.ImageUncheckMarkClass=Ct.ImageClusteringHelper.getImageClass("CheckboxUnchecked_16x16x32"),n.TextDirection=L.AFrameworkApplication.get_isRtl()?"rtl":"ltr",this._standaloneRoot=Mo.w.createStandaloneRoot(e.StandaloneRootName,n),this._standaloneRoot.refresh()}return e.prototype.get_sharedStandaloneRoot=function(){return this._standaloneRoot},e.prototype.dispose=function(){this._standaloneRoot.dispose()},e.StandaloneRootName="TheStandaloneRoot",e}();(0,o.l)(ju,"40bc1b65$StandaloneRootController",null,[nu.r,Sys.IDisposable]);var Qu=n(1269),Ju=function(e){function t(){var t=e.call(this)||this;return t.CommandMenuOpen=null,t.CommandMenuClose=null,t}return(0,v.t)(t,e),t}(Uo);(0,o.l)(Ju,"60ac8798$ContextMenuRootProperties",Uo,[]);var Xu=function(){function e(t){var n=this;this._root=null;var i=new Ju;i.ImageSideArrow=L.AFrameworkApplication.get_imageClusterPath(),i.ImageSideArrowClass=Ct.ImageClusteringHelper.getImageClass("SubmenuFlyoutArrow_13x13x32"),i.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection,i.CommandMenuOpen="3133826319",this._root=new Qu.ContextMenuRoot(e._contextMenuRootName,i),t.execute((function(e){n._root.set_rootUser(e)})),this._root.refresh(),L.AFrameworkApplication.get_theActionManager().addAction(Fe.b.showContextMenu,Ue.m.frame,Le.ActionManager.doNothingButReportHandler),L.AFrameworkApplication.get_theActionManager().addAction(Fe.b.showContextMenuWithFloatie,Ue.m.frame,Le.ActionManager.doNothingButReportHandler)}return e.prototype.get_theRoot=function(){return this._root},e.prototype.dispose=function(){this._root&&(this._root.dispose(),this._root=null)},e.prototype.showContextMenu=function(e,t){this.showContextMenuAt(e,t.get_clientPoint(),t.get_inputSource())},e.prototype.createContextMenu=function(e,t,n,i,r){this.get_theRoot().createContextMenu(e,t,n,i,r)},e.prototype.showContextMenuAtLauncher=function(e,t,n,i){void 0===i&&(i=null),yi.App.get_activeAppFrame().forceUpdateCommandUI(),this.PollForStateAndUpdateInternal(),this.get_theRoot().showContextMenuAtLauncher(e,t,n),this.get_theRoot().get_activeFloatie()?L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.showContextMenuWithFloatie,2):L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.showContextMenu,2)},e.prototype.showContextMenuAt=function(e,t,n){this.showContextMenuAtLauncher(e,new Sys.UI.Bounds(t.x,t.y,0,0),n)},e.prototype.PollForStateAndUpdateInternal=function(){this.get_theRoot().get_root().pollForStateAndUpdate()},e.prototype.dismissAllTransientUI=function(){return this.get_theRoot().dismissAllTransientUI()},e.prototype.showContextMenuWithFloatie=function(e,t,n,i){var r=this.get_theRoot(),o=!1,a=(0,y.e)(Ir.u,n);return r.set_activeFloatie(a),i.showContextMenuForSelection(e,t),r.get_activeMenu()?a&&(a.positionFloatieWithContextMenu(r,t),o=!0):(S.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",i.currentSelectionType()),r.set_activeFloatie(null)),o},e._contextMenuRootName="ContextMenuRootName",e}();(0,o.l)(Xu,"6b064c4$AContextMenuController",null,[tu.k,Sys.IDisposable]);var Yu=n(770),Zu=function(){function e(e){this._repeatedWordSectionBuilder=null,this._repeatedWordSectionBuilder=e}return e.prototype.create=function(e,t){var n=new Sys.StringBuilder;return this.CreateSpellingErrorSection(n,e,t),this.CreateIgnoreSpellingErrorSection(n,e),n.toString()},e.prototype.createMenuSectionProps=function(e,t){var n=new Array(0);return this.CreateSpellingErrorSectionProps(n,e,t),this.CreateIgnoreSpellingErrorSectionProps(n,e),n},e.prototype.CreateSpellingErrorSection=function(e,t,n){switch(t.get_errorType()){case 0:e.append(this._repeatedWordSectionBuilder.build());break;case 1:case 2:e.append(this.BuildContextMenuXml(t,n))}},e.prototype.CreateSpellingErrorSectionProps=function(e,t,n){switch(t.get_errorType()){case 0:e.push(this._repeatedWordSectionBuilder.buildSectionProps());break;case 1:case 2:e.push(this.BuildContextMenuSectionProps(t,n))}},e.prototype.CreateIgnoreSpellingErrorSection=function(e,t){Gl.n.get_instance().get_item(92)||(e.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),e.append(Yu.s.buildButtonXml("btnIgrnoreSpellingError",(2===t.get_errorType()?Oi.u.unregisteredAction:Oi.u.ignoreSpellingError).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null)),e.append("</Controls></MenuSection>"))},e.prototype.CreateIgnoreSpellingErrorSectionProps=function(e,t){if(!Gl.n.get_instance().get_item(92)){var n=(0,U.m)(new zo.x,{ControlList:[]}),i=2===t.get_errorType()?"UnknownSpellingError":"IgnoreSpellingError";Array.add(n.ControlList,(0,U.m)(new Ko.k,{ExternalId:i})),e.push(n)}},e.prototype.BuildContextMenuXml=function(e,t){var n=this.GenerateSuggestionsMenuXml(e.get_suggestions(),t);return n.length>0?Yu.s.buildMenuSectionXml("msUnknownWord",Yu.s.buildControlsGroupXml(null,n),"Menu16"):Yu.s.buildMenuSectionXml("msUnknownWord",Yu.s.buildControlsGroupXml(null,[Yu.s.buildButtonXml("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")},e.prototype.GenerateSuggestionsMenuXml=function(e,t){var n=[];if(e)for(var i=Math.min(t.length,e.length),r=0;r<i;++r)e[r]&&n.push(Yu.s.buildButtonXml("btnCorrectWord"+r,t[r].toString(),e[r]));return n},e.prototype.BuildContextMenuSectionProps=function(e,t){var n=(0,U.m)(new zo.x,{Id:"Suggestions",ControlList:[]});if(this.GenerateSuggestionsButtons(e.get_suggestions(),t,n.ControlList),n.ControlList.length<=0){var i=(0,U.m)(new Ko.k,{ExternalId:"NoSuggestions"});Array.add(n.ControlList,i)}return n},e.prototype.GenerateSuggestionsButtons=function(e,t,n){if(e)for(var i=Math.min(t.length,e.length),r=0;r<i;++r)if(e[r]){var o=(0,U.m)(new Ko.k,{ExternalId:"btnCorrectWord"+r,Command:t[r].toString(),LabelText:e[r]});Array.add(n,o)}},e}();(0,o.l)(Zu,"2bcaba2a$DefaultProofingContextMenuCreator",null,[]);var ec=n(2020),tc=n(5057),nc=n(4926),ic=function(){function e(){}return e.proofingSection="faProofing",e}();(0,o.l)(ic,"b0470373$ContextMenuControlId",null,[]);var rc=n(1900),oc=function(){return function(){this.Text=null,this.Level=0,this.Source=null,this.Action=0,this.BucketId=0,this.Description=null,this.NumberOfInstances=0}}();(0,o.l)(oc,"8caa2042$Suggestion",null,[]);var ac=function(){function e(e,t,n,i,r,o,a){this._repeatedWordSectionBuilder=null,this._isDisplaySuggestionDescriptionsEnabled=!1,this._isProofingSecondaryContextualMenuEnabled=!1,this._isIgnoreAllEnabled=!1,this._iconImage=null,this._imageClusterName=null,this._imageClusterPath=null,this._proofingFeatureConfiguration=null,this._ignoreAllKeywords=null,this._formattingReader=null,this._proofingFeatureConfiguration=t,this._repeatedWordSectionBuilder=e,this._isDisplaySuggestionDescriptionsEnabled=t.get_isDisplaySuggestionDescriptionsEnabled(),this._isProofingSecondaryContextualMenuEnabled=t.get_isProofingSecondaryContextualMenuEnabled(),this._isIgnoreAllEnabled=o,this._imageClusterName=i,this._imageClusterPath=r,this._ignoreAllKeywords=n,this._formattingReader=a,this._iconImage=new ec.n(rc.t,String),this._iconImage.set_item(1,"SpellingIssue_16x16x32"),this._iconImage.set_item(2,"GrammarIssue_16x16x32"),this._iconImage.set_item(3,"WritingIssue_16x16x32"),this._iconImage.set_item(4,null),this._iconImage.set_item(0,null)}return e.prototype.create=function(e,t,n){var i=(0,y.e)(nc.v,t);if(!i)return S.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";var r=new Sys.StringBuilder,o=this.GetLanguageFromSelection(e);return this.CreateSpellingErrorSection(r,i,n,o),this.CreateIgnoreSpellingErrorSection(r,i),this.CreateProofingErrorSection(r,i,o),r.toString()},e.prototype.createMenuSectionProps=function(e,t,n){var i=(0,y.e)(nc.v,t);if(!i)return S.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),new Array(0);var r=new Array(0),o=this.GetLanguageFromSelection(e);return this.CreateSpellingErrorSectionProps(r,i,n,o),this.CreateIgnoreSpellingErrorSectionProps(r,i),this.CreateProofingErrorSectionMenu(r,i,o),r},e.prototype.CreateSpellingErrorSection=function(e,t,n,i){void 0===i&&(i=null),t.get_errorType()?1===t.get_errorType()&&(this.ErrorIsIgnored(t)||e.append(this.BuildContextMenuXml(t,n,i))):e.append(this._repeatedWordSectionBuilder.build())},e.prototype.CreateSpellingErrorSectionProps=function(e,t,n,i){void 0===i&&(i=null),t.get_errorType()?1===t.get_errorType()&&(this.ErrorIsIgnored(t)||e.push(this.BuildContextMenuSection(t,n,i))):e.push(this._repeatedWordSectionBuilder.buildSectionProps())},e.prototype.CreateIgnoreSpellingErrorSection=function(e,t){if(!Gl.n.get_instance().get_item(92)){var n=new Sys.StringBuilder;this.ShowProofingIgnoreAll(t)?n.append(Yu.s.buildButtonXml("btnIgnoreAllSpellingError",(2===t.get_errorType()?Oi.u.unregisteredAction:Oi.u.ignoreAllSpellingError).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.ErrorIsIgnored(t)||n.append(Yu.s.buildButtonXml("btnIgrnoreSpellingError",this.GetIgnoreOnceCommand(t.get_errorType()).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null)),this.ShowSettings(t)&&(this._proofingFeatureConfiguration.get_isDoNotCheckThisIssueEnabled()&&n.append(Yu.s.buildButtonXml("btnDoNotCheckForThisIssue","2157977488",Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),n.append(Yu.s.buildButtonXml("btnGrammarOptions","3380187414",Rn.l.xmlEncode(Box4Intl.Box4Strings.l_GrammarOptions),null))),n.isEmpty()||(e.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),e.append(n.toString()),e.append("</Controls></MenuSection>"))}},e.prototype.CreateIgnoreSpellingErrorSectionProps=function(e,t){if(!Gl.n.get_instance().get_item(92)){var n=(0,U.m)(new zo.x,{ControlList:[]});if(this.ShowProofingIgnoreAll(t)){var i=(0,U.m)(new Ko.k,{ExternalId:2===t.get_errorType()?"UnknownAllSpellingError":"IgnoreAllSpellingError"});Array.add(n.ControlList,i)}else if(!this.ErrorIsIgnored(t)){var r=(0,U.m)(new Ko.k,{ExternalId:"btnIgrnoreSpellingError",Command:this.GetIgnoreOnceCommand(t.get_errorType()).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError});Array.add(n.ControlList,r)}if(this.ShowSettings(t)){if(this._proofingFeatureConfiguration.get_isDoNotCheckThisIssueEnabled()){var o=(0,U.m)(new Ko.k,{ExternalId:"DoNotCheckForThisIssue"});Array.add(n.ControlList,o)}var a=(0,U.m)(new Ko.k,{ExternalId:"GrammerSettingsContext"});Array.add(n.ControlList,a)}e.push(n)}},e.prototype.GetLanguageFromSelection=function(e){if(!this._formattingReader)return null;var t=this._formattingReader.language(this._formattingReader.getFormattingObject(e.get_firstContext()));return Ft.i.getCultureInfo(t).get_name()},e.prototype.GetIgnoreOnceCommand=function(e){return 2===e?Oi.u.unregisteredAction:this._proofingFeatureConfiguration.get_isIgnoreProofingCommandEnabled()?Oi.u.ignoreProofingError:Oi.u.ignoreSpellingError},e.prototype.CreateProofingErrorSection=function(e,t,n){if(void 0===n&&(n=null),this.ShouldCreateSecondaryContextMenu(t)){var i=Rn.l.xmlEncode(t.get_critiqueObject().CategoryTitle),r=Yu.s.generateFlyoutAnchorXml(ic.proofingSection,Fe.b.alwaysEnabled,this._iconImage.get_item(t.get_proofingType()),""!==i?i:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[e.toString()],this._imageClusterName,this._imageClusterPath),o=Yu.s.buildControlsGroupXml("cgProofingOuter",[r]);e.clear(),e.append(Yu.s.buildMenuSectionXml("msProofingOuter",o,"Menu16",void 0,void 0,n,"ariaLabelledById")),S.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",t.get_proofingType(),t.get_typeId())}},e.prototype.CreateProofingErrorSectionMenu=function(e,t,n){if(void 0===n&&(n=null),this.ShouldCreateSecondaryContextMenu(t)){var i=Rn.l.xmlEncode(t.get_critiqueObject().CategoryTitle),r=(0,U.m)(new Vo.b,{ExternalId:String.format("{0}_{1}",ic.proofingSection,t.get_proofingType()),Command:"798637440",Image16by16Class:this._iconImage.get_item(t.get_proofingType()),LabelText:""!==i?i:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:n,Menu:(0,U.m)(new $o.b,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.getAriaLabelForMenu(t),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});Array.addRange(r.Menu.MenuSectionList,e),Array.clear(e);var o=(0,U.m)(new zo.x,{ControlList:[]});Array.add(o.ControlList,r),e.push(o),S.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",t.get_proofingType(),t.get_typeId())}},e.prototype.BuildContextMenuXml=function(e,t,n){void 0===n&&(n=null);var i=this.GetEncodedMenuSectionTitle(e),r=[],o=!1,a=e.get_critiqueObject().Suggestions;if(a)if(a=a.slice(0,Math.min(3,a.length)),this._isDisplaySuggestionDescriptionsEnabled&&(o=!tc.p.any(oc,a,(function(e){return!e||!e.Description}))),1!==a.length||a[0].Action){var l=0,s=null;o&&(s="font-weight: bold;");for(var u=0,c=a;u<c.length;u++){var d=c[u];if(d){var g=null,p="";_=Rn.l.xmlEncode(d.Text);o&&(g=this.GetButtonDescription(d.Description),p=this.GetButtonAriaDescription(d.Description)),r.push(Yu.s.buildButtonXml("btnCorrectWord"+l,t[l].toString(),_,null,null,null,null,null,s,null,g,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,i,_),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,e.get_token(),this.ConvertStringToCommaDelimitedString(e.get_token())),"ariaDescribedById",p)),l++}}}else{var h=a[0],_=Rn.l.xmlEncode(h.Text);r.push(Yu.s.buildButtonXml("btnCorrectWord0","3587447601",_,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,i,_)))}var m,f="Menu16";return r.length>0?(m=r,o&&(f="Menu16DescriptionEnabled")):m=[Yu.s.buildButtonXml("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)],Yu.s.buildMenuSectionXml("msUnknownWord",Yu.s.buildControlsGroupXml(null,m),f,i,this.GetMenuSectionImage(e),n,"ariaLabelledById")},e.prototype.BuildContextMenuSection=function(e,t,n){void 0===n&&(n=null);var i=1!==e.get_proofingType()&&0!==e.get_proofingType()?e.get_critiqueObject().ExplanationTitle:"",r=(0,U.m)(new zo.x,{Title:i,Lang:n,ControlList:[]}),o=!1,a=e.get_critiqueObject().Suggestions;if(a)if(a=a.slice(0,Math.min(3,a.length)),this._isDisplaySuggestionDescriptionsEnabled&&(o=!tc.p.any(oc,a,(function(e){return!e||!e.Description}))),1!==a.length||a[0].Action)for(var l=0,s=0,u=a;s<u.length;s++){if(h=u[s]){var c=null,d="";if(o&&(c=this.GetButtonDescription(h.Description),d=this.GetButtonAriaDescription(h.Description)),l>=t.length)break;if(c){g=(0,U.m)(new Eu,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",l,e.get_proofingType()),Command:t[l].toString(),LabelText:h.Text,Description:c,Lang:n,AriaDescription:d});Array.add(r.ControlList,g)}else{var g=(0,U.m)(new Ko.k,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",l,e.get_proofingType()),Command:t[l].toString(),LabelText:h.Text,Lang:n,RoleInMenu:"menuitem"});Array.add(r.ControlList,g)}l++}}else{var p=a[0],h=(0,U.m)(new Ko.k,{ExternalId:"NoSuggestion",Command:"3587447601",LabelText:p.Text});Array.add(r.ControlList,h)}return r.ControlList.length<=0&&Array.add(r.ControlList,(0,U.m)(new Ko.k,{ExternalId:"btnNoSuggestions",Command:"3587447601",LabelText:Box4Intl.Box4Strings.l_NoSuggestions})),r},e.prototype.GetEncodedMenuSectionTitle=function(e){var t=1!==e.get_proofingType()&&0!==e.get_proofingType()?e.get_critiqueObject().ExplanationTitle:"";return Rn.l.xmlEncode(t)},e.prototype.GetMenuSectionImage=function(e){return this.ShouldCreateSecondaryContextMenu(e)?null:this._iconImage.get_item(e.get_proofingType())},e.prototype.ShouldCreateSecondaryContextMenu=function(e){return this._isProofingSecondaryContextualMenuEnabled&&2!==e.get_errorType()&&(1!==e.get_errorType()||!this.ErrorIsIgnored(e))},e.prototype.ShowProofingIgnoreAll=function(e){return this._isIgnoreAllEnabled&&!!e.get_errorType()&&1===e.get_proofingType()&&!this.ErrorIsIgnored(e)},e.prototype.getAriaLabelForMenu=function(e){return 1===e.get_proofingType()?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,e.get_token(),this.ConvertStringToCommaDelimitedString(e.get_token())):""},e.prototype.ShowSettings=function(e){return this._proofingFeatureConfiguration.get_isProofingSettingEnabled()&&this._isProofingSecondaryContextualMenuEnabled&&1===e.get_errorType()&&(2===e.get_proofingType()||3===e.get_proofingType())},e.prototype.ErrorIsIgnored=function(e){return!!e.get_errorType()&&!!this._ignoreAllKeywords&&this._ignoreAllKeywords.contains(e.get_token(),e.get_lcid())},e.prototype.GetButtonDescription=function(e){return""===e?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):e},e.prototype.GetButtonAriaDescription=function(e){return""!==e?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,e):""},e.prototype.ConvertStringToCommaDelimitedString=function(e){var t="";if(e){var n=0;for(n=0;n<e.length-1;n++)t=t+e.charAt(n)+",";t+=e.charAt(n)}return t},e}();(0,o.l)(ac,"d9d67cdd$EditorServiceProofingContextMenuCreator",null,[]);var lc=function(){function e(e,t){this._defaultCreator=null,this._editorServiceCreator=null,this._suggestionCommands=null,this._defaultCreator=e,this._editorServiceCreator=t,this._suggestionCommands=[Oi.u.takeSuggestedCorrection0,Oi.u.takeSuggestedCorrection1,Oi.u.takeSuggestedCorrection2,Oi.u.takeSuggestedCorrection3,Oi.u.takeSuggestedCorrection4]}return e.prototype.create=function(e,t){return t?o.r(nc.v,t)?this._editorServiceCreator.create(e,t,this._suggestionCommands):this._defaultCreator.create(t,this._suggestionCommands):""},e.prototype.createProps=function(e,t){return t?o.r(nc.v,t)?this._editorServiceCreator.createMenuSectionProps(e,t,this._suggestionCommands):this._defaultCreator.createMenuSectionProps(t,this._suggestionCommands):null},e}();(0,o.l)(lc,"fd287720$ProofingContextMenuSectionFactory",null,[pu]);var sc=function(){function e(){}return e.prototype.build=function(){var e=[Yu.s.buildButtonXml("btnDeleteRepeatedWord","2023591105",Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return Yu.s.buildMenuSectionXml("msRepeatedWord",Yu.s.buildControlsGroupXml(null,e),"Menu16")},e.prototype.buildSectionProps=function(){var e=(0,U.m)(new zo.x,{ControlList:[]}),t=(0,U.m)(new Ko.k,{ExternalId:"DeleteRepeatedWord"});return Array.add(e.ControlList,t),e},e}();(0,o.l)(sc,"a29a1ac1$ProofingRepeatedWordSectionBuilder",null,[gu]);var uc=n(1647),cc=n(7758),dc=function(){function e(e,t){this._isVisible=!1,this._contextualUILauncher=null,this._externalUICommandDefinitionMapping=null,this._hasShynessBehavior=!0,this.$$pf_PreventDismissOnMouseMove=!1,this.$$pf_PreventDismissOnClick=!1,this._contextualUILauncher=e,this._externalUICommandDefinitionMapping=t}return e.prototype.get_preventDismissOnMouseMove=function(){return this.$$pf_PreventDismissOnMouseMove},e.prototype.set_preventDismissOnMouseMove=function(e){return this.$$pf_PreventDismissOnMouseMove=e,e},e.prototype.get_preventDismissOnClick=function(){return this.$$pf_PreventDismissOnClick},e.prototype.set_preventDismissOnClick=function(e){return this.$$pf_PreventDismissOnClick=e,e},e.prototype.get_isVisible=function(){return this._isVisible},e.prototype.get_controls=function(){return null},e.prototype.get_hasShynessBehavior=function(){return this._hasShynessBehavior},e.prototype.set_hasShynessBehavior=function(e){return this._hasShynessBehavior=e,e},e.prototype.positionFloatieWithContextMenu=function(e,t){},e.prototype.dismissFloatie=function(e){return void 0===e&&(e=null),this._contextualUILauncher.dismissFloatie(),!0},e.prototype.ensureContextMenuDismissed=function(){},e.prototype.showFloatieAt=function(e,t,n,i){void 0===i&&(i=!1),this._contextualUILauncher.showFloatie((0,U.m)(new uc.s,{x:e.x,y:e.y}),this.getActiveFloatieGroups(n),n)},e.prototype.getFloatieBounds=function(){return new Sys.UI.Bounds(0,0,0,0)},e.prototype.disposeRoot=function(){},e.prototype.dismissAllTransientUI=function(){return this.dismissFloatie()},e.prototype.getActiveFloatieGroups=function(e){return new Array(0)},e}();(0,o.l)(dc,"8459991e$ReactFloatie",null,[Ir.u,cc.q]);var gc=function(){function e(e){this._currentFloatie=null,this._contextualUILauncher=null,this._contextualUILauncher=e}return e.prototype.dispose=function(){},e.prototype.dismissAllTransientUI=function(){return this._contextualUILauncher.dismissContextualUI(),!0},e.prototype.showContextMenu=function(e,t){this.showContextMenuAt(e,t.get_clientPoint(),t.get_inputSource())},e.prototype.showContextMenuAt=function(e,t,n){this.showContextMenuAtLauncher(e,new Sys.UI.Bounds(t.x,t.y,0,0),n),S.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",e)},e.prototype.showContextMenuAtLauncher=function(e,t,n,i){void 0===i&&(i=null),this._currentFloatie?this._contextualUILauncher.showContextMenuAndFloatie((0,U.m)(new uc.s,{x:t.x,y:t.y}),this._currentFloatie.getActiveFloatieGroups(n),n):this._contextualUILauncher.showContextMenu((0,U.m)(new uc.s,{x:t.x,y:t.y}),n,void 0,i),this._currentFloatie=null},e.prototype.showContextMenuWithFloatie=function(e,t,n,i){return this._currentFloatie=(0,y.e)(dc,n),i.showContextMenuForSelection(e,t),!0},e.prototype.createContextMenu=function(e,t,n,i,r){},e}();(0,o.l)(gc,"687520ca$ReactContextMenuController",null,[tu.k,Sys.IDisposable]);var pc=n(5524),hc=n(6737),_c=n(6491),mc=function(){function e(){}return e.locationIsRibbon=function(e){return 2===e||14===e||15===e},e}();(0,o.l)(mc,"4e0ade3a$UILocationUtil",null,[]);var fc=n(7871),yc=n(3824),Cc=n(4011),Sc=function(){return function(){this.originalActionId=0,this.actionToRun=0,this.actionData=null,this.mustRecurse=!1,this.earlyReturnBool=null}}();(0,o.l)(Sc,"b93d6431$CuiEnabledInfo",null,[]);var bc=function(){return function(){this.originalActionId=0,this.actionToRun=0,this.actionData=null,this.haveCachedValue=!1,this.executeAsync=!1,this.isQueryCommand=!1,this.isQuerySpinnerCommand=!1,this.isQueryCommandRunAsExecute=!1,this.mustRecurse=!1,this.earlyReturnBool=null}}();(0,o.l)(bc,"ec27114d$CuiExecuteInfo",null,[]);var vc=n(3371),Tc=function(){return function(){this.styleProperties=null,this.isHighlightedStyleDiffFromSelection=!1,this.styleProperties=new Es.t,this.isHighlightedStyleDiffFromSelection=!1}}();(0,o.l)(Tc,"2d552e9d$TextRangeStyleData",null,[]);var Ac=n(6932),Ic=function(){return function(){this.bold=0,this.boldNone=!1,this.italic=0,this.italicNone=!1,this.underline=0,this.underlineNone=!1,this.underlineType=0,this.underlineTypeNone=!1,this.superscript=0,this.superscriptNone=!1,this.subscript=0,this.subscriptNone=!1,this.strikethrough=0,this.strikethroughNone=!1,this.doubleStrikethrough=0,this.doubleStrikethroughNone=!1,this.fontName=null,this.fontNameNone=!1,this.fontSize=0,this.fontSizeNone=!1,this.themeFontIndex=0,this.themeFontIndexNone=!1,this.fontColor=0,this.fontColorNone=!1,this.highlight=0,this.highlightNone=!1,this.bold=this.italic=this.underline=this.strikethrough=this.doubleStrikethrough=this.superscript=this.subscript=2,this.fontSize=-1,this.fontColor=this.highlight=-1,this.underlineType=Cc.Font.get_invalidUnderlineType(),this.themeFontIndex=-1,this.boldNone=this.italicNone=this.underlineNone=this.underlineTypeNone=this.superscriptNone=this.subscriptNone=this.strikethroughNone=this.doubleStrikethroughNone=this.fontNameNone=this.fontSizeNone=this.themeFontIndexNone=this.fontColorNone=this.highlightNone=!1}}();(0,o.l)(Ic,"a7c81a66$FormattingData",null,[]);var wc=n(6102),xc=n(3621),Ec=function(){function e(){this._hasCachedParagraphFormatting=!1,this._hasCachedTextFormatting=!1,this.executeFunctions=new aa.e(Number,Function),this.enabledFunctions=new aa.e(Number,Function),this._formattingProperties=new Ic,this._paragraphFormattingProperties=new wc.n}return e.prototype.initialize=function(){e.SymbolDictionary=e.CreateSymbolDictionary(),this.executeFunctions.set_item(Oi.u.undo,e.inputMethodExecuteBridge),this.executeFunctions.set_item(Oi.u.redo,e.inputMethodExecuteBridge),this.executeFunctions.set_item(Oi.u.nextSpellingError,e.inputMethodExecuteBridge),this.executeFunctions.set_item(Oi.u.populateEditSurfaceMenuTouch,e.touchExecuteBridge),this.executeFunctions.set_item(Oi.u.openInClient,e.openInClientExecuteBridge),this.executeFunctions.set_item(Fe.b.close,e.closeExecuteBridge),this.executeFunctions.set_item(Oi.u.deleteKey,e.dictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(Oi.u.font,e.fontExecuteBridge),this.executeFunctions.set_item(Oi.u.setFontSize,o.i(this,this.genericFontSizeExecuteBridge,"genericFontSizeExecuteBridge")),this.executeFunctions.set_item(Oi.u.bold,e.formattingAsyncExecuteBridge),this.executeFunctions.set_item(Oi.u.setItalic,e.formattingAsyncExecuteBridge),this.executeFunctions.set_item(Oi.u.underline,e.formattingAsyncExecuteBridge),this.executeFunctions.set_item(Oi.u.strikethrough,e.formattingAsyncExecuteBridge),this.executeFunctions.set_item(Oi.u.superscript,e.formattingAsyncExecuteBridge),this.executeFunctions.set_item(Oi.u.subscript,e.formattingAsyncExecuteBridge),this.executeFunctions.set_item(Oi.u.queryBold,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryItalic,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryUnderline,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryStrikethrough,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.querySubscript,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.querySubscriptSplit,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.querySuperscript,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryFont,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryFontSize,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryFormatPainter,o.i(this,this.queryFormatPainterExecuteBridge,"queryFormatPainterExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryLeftJustify,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryRightJustify,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryCenterJustify,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryFullJustify,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.demoteIndent,e.executeBridgeWithNoData),this.executeFunctions.set_item(Oi.u.promoteIndent,e.executeBridgeWithNoData),this.executeFunctions.set_item(Fe.b.coauthoringQueryStatus,e.queryBridgeWithExistingData),this.executeFunctions.set_item(Oi.u.launchParagraphDialog,e.inputMethodExecuteBridge),this.enabledFunctions.set_item(Oi.u.populateFontColor,e.dictionaryPropertySetEnabledBridge),this.enabledFunctions.set_item(Oi.u.populateFontDropdown,e.dictionaryPropertySetEnabledBridge),this.enabledFunctions.set_item(Oi.u.populateFontSizeDropdown,e.dictionaryPropertySetEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryBold,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryItalic,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryUnderline,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryStrikethrough,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.querySubscript,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.querySubscriptSplit,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.querySuperscript,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryFont,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryFontSize,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryLeftJustify,e.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryCenterJustify,e.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryRightJustify,e.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryFullJustify,e.remapToQueryParagraphFormattingEnabledBridge),this.executeFunctions.set_item(Oi.u.commandingInsertHyperLink,o.i(this,this.insertHyperLinkBridge,"insertHyperLinkBridge")),this.executeFunctions.set_item(Oi.u.commandingUndo,o.i(this,this.commandingInputMethodExecuteBridge,"commandingInputMethodExecuteBridge")),this.executeFunctions.set_item(Oi.u.commandingRedo,o.i(this,this.commandingInputMethodExecuteBridge,"commandingInputMethodExecuteBridge")),this.executeFunctions.set_item(Oi.u.commandingInsertOnlinePic,o.i(this,this.insertOnLinePictureExecuteBridge,"insertOnLinePictureExecuteBridge")),this.executeFunctions.set_item(Oi.u.commandingInsertSymbol,o.i(this,this.insertSymbolBridge,"insertSymbolBridge")),this.executeFunctions.set_item(Oi.u.commandingInsertTable,o.i(this,this.commandingInsertTableExecuteBridge,"commandingInsertTableExecuteBridge")),this.executeFunctions.set_item(Oi.u.commandingNav,o.i(this,this.navToPageExecuteBridge,"navToPageExecuteBridge")),this.executeFunctions.set_item(Oi.u.commandingFontColor,e.commandingColorExecuteBridge),this.executeFunctions.set_item(Oi.u.commandingFontBackgroundColor,e.commandingColorExecuteBridge)},e.prototype.clearCache=function(){this._formattingProperties=new Ic,this._paragraphFormattingProperties=new wc.n,this._hasCachedParagraphFormatting=!1,this._hasCachedTextFormatting=!1},e.prototype.getExecuteInfo=function(t,n,i){var r=null,o=this.executeFunctions.get_item(t);return o?r=o(t,n,i):(r=new bc).actionData=n,r.originalActionId=t,r.actionToRun||(r.actionToRun=e.MapActionId(t)),r},e.prototype.getEnabledInfo=function(e){var t=null,n=this.enabledFunctions.get_item(e);return(t=n?n(e):new Sc).originalActionId=e,t.actionToRun||(t.actionToRun=e),t},e.prototype.queryFormattingExecuteBridge=function(e,t,n){var i=new bc;return i.haveCachedValue=this._hasCachedTextFormatting,this._hasCachedTextFormatting=!0,i.actionToRun=Oi.u.queryFormatting,i.actionData=this._formattingProperties,i.isQueryCommand=!0,i},e.prototype.queryParaFormattingExecuteBridge=function(e,t,n){var i=new bc;return i.haveCachedValue=this._hasCachedParagraphFormatting,this._hasCachedParagraphFormatting=!0,i.actionToRun=Oi.u.queryParagraphFormatting,i.actionData=this._paragraphFormattingProperties,i.isQueryCommandRunAsExecute=!0,i.isQueryCommand=!0,i},e.prototype.genericFontSizeExecuteBridge=function(t,n,i){var r=new bc;r.executeAsync=!0;var o,a=n.CommandValueId||n.Value,l=0;return Rn.l.parseNumberAndUnitsFromString(a,[0],L.AFrameworkApplication.get_numberFormat(),(0,g.m)((function(){return l}),(function(e){return l=e})),(0,g.m)((function(){return o}),(function(e){return o=e}))),isNaN(l)?(yi.App.get_activeAppFrame().updateCommandUI(),r.earlyReturnBool=!1,r):(l*=2,r.actionData=e.CreateActionDataContainer(Math.floor(l),n),r)},e.prototype.commandingInputMethodExecuteBridge=function(e,t,n){var i={Visible:!0};e===Oi.u.commandingUndo?(i.LabelText="Undo",i.SourceControlId="btnUndo"):(i.LabelText="Redo",i.SourceControlId="btnRedo");var r=new _c.p(i,2),o=new bc;return o.actionData=r,o},e.prototype.insertOnLinePictureExecuteBridge=function(e,t,n){var i=new bc,r=new Dl.DictionaryPropertySet,o=t.Value?t.Value:null;if(!o||""===o)return null;var a=String.format("<img src={0}>",o);return r.setValue(Pl.k.pastedHtmlContent,a),i.actionData=r,i},e.prototype.insertHyperLinkBridge=function(e,t,n){var i=new bc;return t.Source="CommandingInterface",i.actionData=t,i},e.prototype.commandingInsertTableExecuteBridge=function(e,t,n){var i=new bc;i.executeAsync=!0;var r=new Ac.v;return r.rows=t.Row,r.columns=t.Col,i.actionData=r,i},e.prototype.insertSymbolBridge=function(t,n,i){var r=new bc;r.executeAsync=!0;var o=n.Value;r.actionData=new Dl.DictionaryPropertySet;var a=this.GetSymbolByIndex(o),l={};return l.SourceControlId=e.SymbolIdPrefix+o+"_"+a,l.InnerHtml=String.format('<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>',a),r.actionData=l,r},e.prototype.navToPageExecuteBridge=function(e,t,n){var i=new bc,r=t.Value?t.Value:"";return i.actionData=r,i},e.prototype.queryFormatPainterExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=Ge.w.get_instance().tryResolve(pc.w),i.isQueryCommand=!0,i},e.prototype.GetSymbolByIndex=function(t){return e.SymbolDictionary[t.toString()]},e.CreateSymbolDictionary=function(){var e={0:"\u2022",1:"\u20ac",2:"\xa3",3:"\xa5",4:"\xa9",5:"\xae",6:"\u2122",7:"\xb1",8:"\u2260",9:"\u2264",10:"\u2265",11:"\xf7",12:"\xd7",13:"\u221e",14:"\xb5",15:"\u03b1",16:"\u03b2",17:"\u03c0",18:"\u03a9",19:"\u03a3",20:"\xb0",21:"\u0394",22:"\u263a",23:"\u2665",24:"\u20b9"};return e},e.applyQueryResult=function(e,t){var n=(0,y.e)(Ic,e.actionData),i=(0,y.e)(wc.n,e.actionData),r=!0;switch(e.originalActionId){default:r=!1;break;case Oi.u.queryAlwaysPressed:t[gr.e.On]=!0;break;case Oi.u.queryBold:t[gr.e.On]=1===n.bold;break;case Oi.u.queryItalic:t[gr.e.On]=1===n.italic;break;case Oi.u.queryUnderline:t[gr.e.On]=1===n.underline;break;case Oi.u.querySubscriptSplit:t[To.z.On]=1===n.subscript;break;case Oi.u.querySubscript:t[gr.e.On]=1===n.subscript;break;case Oi.u.querySuperscript:t[gr.e.On]=1===n.superscript;break;case Oi.u.queryStrikethrough:t[gr.e.On]=1===n.strikethrough||1===n.doubleStrikethrough;break;case Oi.u.queryFont:t[jr.g.IsFreeForm]=!0,void 0!==n.fontName&&null!==n.fontName?t[jr.g.Value]=vc.FormattingReader.getDisplayFontNameWithTheme(n.fontName,n.themeFontIndex):t[jr.g.Value]="";break;case Oi.u.queryFontSize:var o="";-1!==n.fontSize&&Rn.l.formatNumberToString(n.fontSize/2,0,L.AFrameworkApplication.get_numberFormat(),(0,g.m)((function(){return o}),(function(e){return o=e}))),t[jr.g.IsFreeForm]=!0,t[jr.g.Value]=o;break;case Oi.u.queryLeftJustify:t[gr.e.On]=1===i.layoutAlignmentInParent;break;case Oi.u.queryCenterJustify:t[gr.e.On]=2===i.layoutAlignmentInParent;break;case Oi.u.queryRightJustify:t[gr.e.On]=3===i.layoutAlignmentInParent;break;case Oi.u.queryFullJustify:t[gr.e.On]=6===i.layoutAlignmentInParent;break;case Oi.u.queryFormatPainter:var a=(0,y.e)(pc.w,e.actionData);a&&(t[gr.e.On]=a.get_isBrushActive());break;case Fe.b.coauthoringQueryStatus:}return r},e.executeBridgeWithNoData=function(e,t,n){return new bc},e.queryBridgeWithExistingData=function(e,t,n){var i=new bc;return i.actionData=t,i.isQueryCommand=!0,i},e.inputMethodExecuteBridge=function(e,t,n){var i=new _c.p(t,n.InvocationMethod),r=new bc;return r.actionData=i,r},e.touchExecuteBridge=function(e,t,n){var i=new _c.p(t,3),r=new bc;return r.actionData=i,r},e.openInClientExecuteBridge=function(e,t,n){var i=new bc;return mc.locationIsRibbon(n.CommandLocation)||26===n.CommandLocation||(i.actionData=!1),i},e.queryDictionaryPropertySetExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=new Dl.DictionaryPropertySet,i.isQueryCommand=!0,i},e.queryTextRangeStyleDataExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=new Tc,i.isQueryCommand=!0,i},e.dictionaryPropertySetExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=new Dl.DictionaryPropertySet,i},e.closeExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=Hi.z.closeButton,i},e.dictionaryPropertySetEnabledBridge=function(e){var t=new Sc;return t.actionData=new Dl.DictionaryPropertySet,t},e.formattingAsyncExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=new xc.b(2),i.executeAsync=!0,i},e.remapToQueryParagraphFormattingEnabledBridge=function(e){var t=new Sc;return t.actionToRun=Oi.u.queryParagraphFormatting,t},e.remapToQueryFormattingEnabledBridge=function(e){var t=new Sc;return t.actionToRun=Oi.u.queryFormatting,t},e.fontExecuteBridge=function(t,n,i){var r,o=new bc;if(o.executeAsync=!0,r=n.CommandValueId?n.CommandValueId:n.Value,o.actionData=r,Gl.n.get_instance().get_item(53)){var a=new Ic,l=n.MenuItemId;a.themeFontIndex=Cc.Font.getThemeFontIndexFromFontId(l),a.fontName=r,o.actionData=a}return e.LogFontUsageData(n,r),o.actionData=e.CreateActionDataContainer(o.actionData,n),yc.v.addMruFont(r),o},e.LogFontUsageData=function(e,t){var n=Rn.l.calcHashCode(t);void 0!==e[jr.g.IsFreeForm]&&null!==e[jr.g.IsFreeForm]&&e[jr.g.IsFreeForm]?S.ULS.sendTraceTag(51390360,324,50,String.format("{0} font applied is not a valid menu item",n.toString())):void 0!==e.MenuItemId&&null!==e.MenuItemId&&S.ULS.sendTraceTag(51390361,324,50,String.format("Font applied is {0}, MenuItemID:{1}",n.toString(),e.MenuItemId))},e.commandingColorExecuteBridge=function(t,n,i){var r=new bc,o=n.Color?n.Color:null;return o&&o.length===e.ColorLength?(r.actionData=e.ConvertRgbToBgr(o),r.executeAsync=!0,r):null},e.ConvertRgbToBgr=function(t){return t.length!==e.ColorLength?null:t.substring(4,6)+t.substring(2,4)+t.substring(0,2)},e.MapActionId=function(e){switch(e){case Oi.u.commandingUndo:return Oi.u.undo;case Oi.u.commandingRedo:return Oi.u.redo;case Oi.u.commandingInsertTable:return Oi.u.insertTable;case Oi.u.commandingInsertOnlinePic:return Oi.u.browserPasted;case Oi.u.commandingInsertSymbol:return Oi.u.insertSymbol;case Oi.u.commandingInsertHyperLink:return Oi.u.insertHyperlink;case Oi.u.commandingFontColor:return Oi.u.setFontColor;case Oi.u.commandingFontBackgroundColor:return Oi.u.setFontBackgroundColor;default:return e}},e.CreateActionDataContainer=function(e,t){var n=new hc.y(e);return L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()?new hc.y(e,t[fc.z.shouldCanvasTakeFocus]):n},e.SymbolDictionary={},e.SymbolIdPrefix="symbol_",e.ColorLength=6,e}();(0,o.l)(Ec,"3f4bb97b$CuiActionBridge",null,[]);var Fc=function(){function e(){}return e.registerActions=function(){L.AFrameworkApplication.get_theActionManager()},e.attachCommandHandlers=function(t,n,i){e._controlCommandHandlers[t.toString()]=n,e._controlQueryCommandHandlers[t.toString()]=i},e.detachCommandHandlers=function(t){e._controlCommandHandlers[t.toString()]=null,e._controlQueryCommandHandlers[t.toString()]=null},e.queryDialogControl=function(t,n,i,r,o){if(1===i)return 32;var a=o;return e.QueryControlValue(t,a)?32:8},e.handleDialogControl=function(t,n,i,r,o){if(1===i)return 32;var a=o;return e.NotifyControlValueChanged(t,a)?32:8},e.NotifyControlValueChanged=function(t,n){var i=e._controlCommandHandlers[t.toString()];return null!=i&&(i(t,n),!0)},e.QueryControlValue=function(t,n){var i=e._controlQueryCommandHandlers[t.toString()];return null!=i&&(i(t,n),!0)},e._controlCommandHandlers={},e._controlQueryCommandHandlers={},e}();(0,o.l)(Fc,"27097dde$DialogCuiControlActor",null,[]);var Pc=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)},e.DialogHtmlFormat="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> </table> </div>",e}();(0,o.l)(Pc,"8eebb169$AutoCorrectOptionsDialogHTML",null,[]);var Dc=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)},e.DialogHtmlFormat="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceQuoteWithSmartQuote' >{8}</label> </td> </tr> </table> </div>",e}();(0,o.l)(Dc,"b37178db$AutoCorrectOptionsDialogHTML2",null,[]);var Rc=function(e){function t(n,i){var r=this;return r._autoCorrectOptionsInfo=null,r._replaceQuoteWithSmartQuoteIsEnabled=!1,(r=e.call(this)||this)._autoCorrectOptionsInfo=n,r._replaceQuoteWithSmartQuoteIsEnabled=i,r.set_dialogId(t.Id),r}return(0,v.t)(t,e),t.prototype.showLanguageDialog=function(){S.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens."),this.set_dialogHtml(this._replaceQuoteWithSmartQuoteIsEnabled?Dc.get_dialogHtml():Pc.get_dialogHtml());var e={};e[t.ReplaceTextAsYouTypeCheckboxId]=this._autoCorrectOptionsInfo.get_replaceTextAsYouType(),e[t.CapitalizeFirstLetterOfSentencesCheckboxId]=this._autoCorrectOptionsInfo.get_capitalizeFirstLetterOfSentences(),e[t.ReplaceOrdianalsWithSuperscriptCheckboxId]=this._autoCorrectOptionsInfo.get_replaceOrdianalsWithSuperscript(),e[t.ReplaceHyphensWithDashCheckboxId]=this._autoCorrectOptionsInfo.get_replaceHyphensWithDash(),e[t.ReplaceFractionsWithFractionCharacterCheckboxId]=this._autoCorrectOptionsInfo.get_replaceFractionsWithFractionCharacter(),this._replaceQuoteWithSmartQuoteIsEnabled&&(e[t.ReplaceQuoteWithSmartQuoteCheckboxId]=this._autoCorrectOptionsInfo.get_replaceQuoteWithSmartQuote()),this.initializeAndShow(Box4Intl.Box4Strings.l_AutoCorrectOptions,o.i(this,this.SetAutoCorrectOptionsHandler,"SetAutoCorrectOptionsHandler"),e)},t.prototype.SetAutoCorrectOptionsHandler=function(e,n){if(Gl.n.get_instance().get_item(70))if(1===e)if(n[t.ReplaceTextAsYouTypeCheckboxId]!==this._autoCorrectOptionsInfo.get_replaceTextAsYouType()||n[t.CapitalizeFirstLetterOfSentencesCheckboxId]!==this._autoCorrectOptionsInfo.get_capitalizeFirstLetterOfSentences()||n[t.ReplaceOrdianalsWithSuperscriptCheckboxId]!==this._autoCorrectOptionsInfo.get_replaceOrdianalsWithSuperscript()||n[t.ReplaceHyphensWithDashCheckboxId]!==this._autoCorrectOptionsInfo.get_replaceHyphensWithDash()||n[t.ReplaceFractionsWithFractionCharacterCheckboxId]!==this._autoCorrectOptionsInfo.get_replaceFractionsWithFractionCharacter()||this._replaceQuoteWithSmartQuoteIsEnabled&&n[t.ReplaceQuoteWithSmartQuoteCheckboxId]!==this._autoCorrectOptionsInfo.get_replaceQuoteWithSmartQuote()){var i={};i[t.ReplaceTextAsYouTypeCheckboxId]=n[t.ReplaceTextAsYouTypeCheckboxId],i[t.CapitalizeFirstLetterOfSentencesCheckboxId]=n[t.CapitalizeFirstLetterOfSentencesCheckboxId],i[t.ReplaceOrdianalsWithSuperscriptCheckboxId]=n[t.ReplaceOrdianalsWithSuperscriptCheckboxId],i[t.ReplaceHyphensWithDashCheckboxId]=n[t.ReplaceHyphensWithDashCheckboxId],i[t.ReplaceFractionsWithFractionCharacterCheckboxId]=n[t.ReplaceFractionsWithFractionCharacterCheckboxId],this._replaceQuoteWithSmartQuoteIsEnabled&&(i[t.ReplaceQuoteWithSmartQuoteCheckboxId]=n[t.ReplaceQuoteWithSmartQuoteCheckboxId]),this._autoCorrectOptionsInfo.saveAutoCorrectOptions(i),S.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+{ReplaceTextAsYouType:n[t.ReplaceTextAsYouTypeCheckboxId],CapitalizeFirstLetterOfSentences:n[t.CapitalizeFirstLetterOfSentencesCheckboxId],ReplaceOrdianalsWithSuperscript:n[t.ReplaceOrdianalsWithSuperscriptCheckboxId],ReplaceHyphensWithDash:n[t.ReplaceHyphensWithDashCheckboxId],ReplaceFractionsWithFractionCharacter:n[t.ReplaceFractionsWithFractionCharacterCheckboxId],ReplaceQuoteWIthSmartQuoteIsEnabled:this._replaceQuoteWithSmartQuoteIsEnabled,ReplaceQuoteWithSmartQuote:this._replaceQuoteWithSmartQuoteIsEnabled&&n[t.ReplaceQuoteWithSmartQuoteCheckboxId]}),yi.App.get_activeAppFrame().updateCommandUI(!0)}else S.ULS.sendTraceTag(24523523,324,50,"User close the option dialog or cancle it without do any changes.");else S.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes.")},t.Id="AutoCorrectOptionsDialog",t.ReplaceTextAsYouTypeCheckboxId="ReplaceTextAsYouType",t.CapitalizeFirstLetterOfSentencesCheckboxId="CapitalizeFirstLetterOfSentences",t.ReplaceOrdianalsWithSuperscriptCheckboxId="ReplaceOrdianalsWithSuperscript",t.ReplaceHyphensWithDashCheckboxId="ReplaceHyphensWithDash",t.ReplaceFractionsWithFractionCharacterCheckboxId="ReplaceFractionsWithFractionCharacter",t.ReplaceQuoteWithSmartQuoteCheckboxId="ReplaceQuoteWithSmartQuote",t}(Bi.o);(0,o.l)(Rc,"6d0d1cd8$AutoCorrectOptionsDialog",Bi.o,[cu]);var Mc=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)},e.DialogHtmlFormat="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>",e}();(0,o.l)(Mc,"e167065a$AltTextDialogWithDescriptionHtml",null,[]);var kc=function(e){function t(n){var i=e.call(this)||this;i.set_dialogHtml(Mc.get_dialogHtml());var r={};r[t.altTitleKey]=i.getAltText(n),r[t.altDescriptionKey]=i.getDescriptionText(n)||"",i.set_dialogId(t.id),i.initializeAndShow(CommonUIStrings.l_AlternativeTextDialogTitle,o.i(i,i.altTextDialogHandler,"altTextDialogHandler"),r);var a=document.getElementById(t.altTitleKey);return a.focus(),a.select(),i}return(0,v.t)(t,e),t.prototype.dialogDefaultEnterKeyHandler=function(n){return n.get_sourceElement().id!==t.altDescriptionKey&&e.prototype.dialogDefaultEnterKeyHandler.call(this,n)},t.altTitleKey="titleText",t.altDescriptionKey="descriptionText",t.id="AAltTextDialogWithDescription",t}(Bi.o);(0,o.l)(kc,"bcd0af22$AAltTextDialogWithDescription",Bi.o,[]);var Nc=function(e){function t(t,n,i,r,o){var a=this;return a._tableEditor=null,a._coauthManager=null,a._graphTransactionFactory=null,a._trackChangeManager=null,a._containingNode=null,a._tableProperties=null,(a=e.call(this,t)||this)._tableEditor=n,a._coauthManager=i,a._graphTransactionFactory=r,a._trackChangeManager=o,a}return(0,v.t)(t,e),t.prototype.getDescriptionText=function(e){return this._containingNode=e.get_node(),this._tableProperties=us.TableReader.getTablePropertySet(e),us.TableReader.getTableAltTextDescription(this._tableProperties)},t.prototype.getAltText=function(e){return this._containingNode=e.get_node(),this._tableProperties=us.TableReader.getTablePropertySet(e),us.TableReader.getTableAltTextTitle(this._tableProperties)},t.prototype.altTextDialogHandler=function(e,t){if(1===e){var n=us.TableReader.getTableAltTextTitle(this._tableProperties),i=us.TableReader.getTableAltTextDescription(this._tableProperties),r=t[kc.altTitleKey],o=t[kc.altDescriptionKey];this.hide();var a=this._graphTransactionFactory.getTransaction(15);try{a.setFromNode(this._containingNode),this._tableEditor.setTableAltTextTitle(this._tableProperties,r),this._tableEditor.setTableAltTextDescription(this._tableProperties,o)}finally{a&&a.dispose()}r===n&&o===i||this._trackChangeManager.alertUntrackedChange(13)}Gl.n.get_instance().get_item(50)&&this._coauthManager.get_isCoauthorable()&&this._coauthManager.get_theLockManager().acquireAndApplyLock(this._containingNode)},t}(kc);(0,o.l)(Nc,"39ab9e3$TableAltTextDialog",kc,[]);var Lc=function(){function e(e,t,n){this._tableEditor=null,this._graphTransactionFactory=null,this._trackChangeManager=null,this._tableEditor=e,this._graphTransactionFactory=t,this._trackChangeManager=n}return e.prototype.create=function(e){return new Nc(e,this._tableEditor,yi.App.get_theCoauthManager(),this._graphTransactionFactory,this._trackChangeManager)},e}();(0,o.l)(Lc,"be4343d7$TableAltTextDialogFactory",null,[]);var Bc=n(6875),Oc=n(8604),Uc=n(7736),Hc=function(e){function t(t,n,i){var r=e.call(this,n,i)||this;return r._appFrame=null,r._appFrame=t,r}return(0,v.t)(t,e),t.prototype.initializeFloatie=function(e,t,n){var i=this;void 0===n&&(n=null),Gl.n.get_instance().get_item(73)||S.ULS.sendTraceTag(8151366,307,15,"Cannot find Floatie feature in the AppFeatures settings"),this._appFrame.bindFloatieBaseFactory((function(){return i.constructFloatie(e,t,n)}))},t.prototype.constructFloatie=function(t,n,i){return this.set_floatie(e.prototype.constructFloatie.call(this,t,n,i)),this._appFrame.add_onCommandUiUpdate(o.i(this,this.PollForStateAndUpdateFloatie,"PollForStateAndUpdateFloatie")),this.get_floatie()},t.prototype.onFloatieDismissed=function(e){this.get_floatie()&&Si.InteractiveViewManager.get_instance().get_selectionView()&&Si.InteractiveViewManager.get_instance().get_selectionView().onFloatieDismissed(e,this.get_floatie().get_touchMode()),this.get_floatie().set_preventDismissOnMouseMove(t.testHook),this._appFrame.set_isFloatieActive(!1)},t.prototype.PollForStateAndUpdateFloatie=function(){this._appFrame.get_isFloatieActive()&&this.get_floatie().pollForStateAndUpdate()},t.prototype.getHiddenFloatieGroups=function(e){var n=fa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection(),i=[],r=!!this.get_commandUiBridge()&&!this.get_commandUiBridge().isRibbonCommandEnabled("3523575366"),o=!!this.get_commandUiBridge()&&!this.get_commandUiBridge().isRibbonCommandEnabled("1898844988"),a=!t.get_EditSurfaceContextMenu().hasContent(n,e);return(!r||!t.get_SelectionContextMenuProvider().menuForSelectionHasAssociatedFloatie())&&(Array.add(i,t._textFormattingGroup),Array.add(i,t._stylesGroup)),r&&Array.add(i,t._pictureToolsGroup),o&&Array.add(i,t._tableToolsGroup),a&&Array.add(i,t._contextMenuGroup),i},t.get_EditSurfaceContextMenu=function(){return t._editSurfaceContextMenu||(t._editSurfaceContextMenu=Ge.w.get_instance().resolve(Uc.n))},t.get_SelectionContextMenuProvider=function(){return t._selectionContextMenuProvider||(t._selectionContextMenuProvider=Ge.w.get_instance().resolve(Bc.f))},t._textFormattingGroup="TextFormattingGroup",t._stylesGroup="StylesGroup",t._pictureToolsGroup="PictureToolsGroup",t._tableToolsGroup="TableToolsGroup",t._contextMenuGroup="ContextMenuGroup",t.testHook=!1,t._editSurfaceContextMenu=null,t._selectionContextMenuProvider=null,t}(Oc.l);(0,o.l)(Hc,"fdf85003$SelectionFloatieInitializer",Oc.l,[]);var Gc=function(){function e(){}return e.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(Oi.u.preventWarningsOnAppClose,ol.d.application,e.PreventWarningsOnAppClose),t.addActionWithFlags(Oi.u.showContextMenuAndFloatie_Automation,ol.d.application,e.ShowContextMenuAndFloatie,96),t.addActionWithFlags(Oi.u.showFloatieForSelection_Automation,ol.d.application,e.ShowFloatieForSelection,96)},e.PreventWarningsOnAppClose=function(e,t,n,i,r){return yi.App.allowUnsafeAppClose=!0,32},e.ShowContextMenuAndFloatie=function(t,n,i,r,o){return 1===i?32:e.ParseFloatieAutomationInput(o,(0,g.m)((function(){return a}),(function(e){return a=e})),(0,g.m)((function(){return l}),(function(e){return l=e})))?(yi.App.get_activeAppFrame().showContextMenuAndFloatie(a,l),32):16;var a,l},e.ShowFloatieForSelection=function(t,n,i,r,o){return 1===i?32:e.ParseFloatieAutomationInput(o,(0,g.m)((function(){return a}),(function(e){return a=e})),(0,g.m)((function(){return l}),(function(e){return l=e})))?(Hc.testHook=!0,yi.App.get_activeAppFrame().showFloatieForSelection(a,l),32):16;var a,l},e.ParseFloatieAutomationInput=function(e,t,n){if(t.val=null,n.val=0,!e)return!1;var i=e.split(",");return!(i.length<3)&&(t.val=new Sys.UI.Point(parseInt(i[0]),parseInt(i[1])),n.val=parseInt(i[2]),!0)},e}();(0,o.l)(Gc,"e2d6dda7$FloatieTestHookActor",null,[]);var Wc=n(2554),Vc=n(8751),$c=function(){function e(e,t){this._hooks=null,this._cuiActionBridge=null,this._actionMan=null,this._hooks=e.getCuiUserHooks(),this._cuiActionBridge=e,this._actionMan=t}return e.prototype.executeRootCommand=function(t,n,i,r,o){void 0===r&&(r=null),void 0===o&&(o=null),i&&(this._actionMan.set_commandLocation(i.CommandLocation),this._actionMan.set_invocationMethod(i.InvocationMethod),this._actionMan.set_commandTabName(i.CommandTabName));var a,l=parseInt(t),s=this._cuiActionBridge.getExecuteInfo(l,n,i);if(s.mustRecurse&&(s=this._cuiActionBridge.getExecuteInfo(s.actionToRun,n,i)),void 0!==s.earlyReturnBool&&null!==s.earlyReturnBool)return s.earlyReturnBool;if(s.haveCachedValue)a=32;else{var u=null;if(this._hooks&&this._hooks.preExecCommand&&(u=this._hooks.preExecCommand(s,o)),s.isQueryCommand||s.isQuerySpinnerCommand)s.executeAsync?a=16:2===(a=this._actionMan.processActionWithData(s.actionToRun,s.isQueryCommandRunAsExecute?2:1,s.actionData,o))&&(a=32);else if(s.executeAsync){a=this._actionMan.processActionWithDataAsync(null,s.actionToRun,2,s.actionData,(function(t,n){e.AsyncActionCallback(t,n),r&&r(t.get_response())}),null,o)}else a=this._actionMan.processActionWithData(s.actionToRun,2,s.actionData,o),r&&r(a);if(this._hooks&&this._hooks.postExecCommand&&this._hooks.postExecCommand(s,a,u),n&&i&&-1!==i.InvocationMethod&&i.InvocationMethod){var c=n.LegacyId;null==c&&(c="");var d=n.ParentMenuId;null==d&&n.MenuId&&(d=n.MenuId);var g=n.SqmControlId;null==g&&n.SourceControlId&&(g=n.SourceControlId),null==g&&null==d||Wc.z.raiseSQMEvent(new Vc.e(g,c,d,t,Date.now(),i))}}return s.isQueryCommand&&32===a&&this._hooks&&this._hooks.applyQueryResult&&this._hooks.applyQueryResult(s,n),s.isQuerySpinnerCommand&&32===a&&this._hooks&&this._hooks.applySpinnerQueryResult&&this._hooks.applySpinnerQueryResult(s,n),32===a||1===a},e.prototype.isRootCommandEnabled=function(e){if(L.AFrameworkApplication.isShuttingDown||Ce.y.get_instance().get_isYielding())return!1;var t=parseInt(e);if(!e||t===Le.ActionManager.emptyActionId)return!0;var n=this._cuiActionBridge.getEnabledInfo(t);return n.mustRecurse&&(n=this._cuiActionBridge.getEnabledInfo(n.actionToRun)),void 0!==n.earlyReturnBool&&null!==n.earlyReturnBool?n.earlyReturnBool:32===this._actionMan.processActionWithData(n.actionToRun,1,n.actionData)},e.prototype.clearCache=function(){this._cuiActionBridge.clearCache()},e.AsyncActionCallback=function(e,t){},e}();(0,o.l)($c,"71e0d0bd$GeneralCuiUser",null,[ou.h,Ro]);var zc=function(){function e(e,t,n,i){this._textToApplyTo=null,this._textFormattingCommands=null,this._autoCorrectRulesFuture=null,this._languageReader=null,this._textToApplyTo=e,this._textFormattingCommands=t,this._autoCorrectRulesFuture=n,this._languageReader=i}return e.prototype.getSelectedContextLanguage=function(e){return e.val=this._languageReader.getProofingEnabledFromContext(this._textToApplyTo),this._languageReader.getLanguageInfoFromContext(this._textToApplyTo)},e.prototype.setSelectedContextLanguage=function(e,t){if(this._textFormattingCommands){var n=new Dl.DictionaryPropertySet;this._autoCorrectRulesFuture.execute((function(t){t.ensureAutoCorrectListLoaded(e)})),n.setValue(is.b.languageID,e),n.setValue(Gl.n.get_instance().get_item(20)?os.j.noProof:Pl.k.noProofBox4,t);var i=new Ma.GraphTransaction(15);i.set(yi.App.theNotebookManager.get_theGraph()),this._textFormattingCommands.setLanguage(n),i.dispose()}},e}();(0,o.l)(zc,"3c740676$LanguageEditor",null,[lu]);var Kc=n(2203),qc=n(4896),jc=function(){function e(t,n){var i=this;void 0===t&&(t=!1),void 0===n&&(n=0),this._lcidToCultureInfo=null,this._recentlyUsedLanguagesList=null,this._recentlyUsedLanguagesSet=null,this._recentlyUsedLanguagesMaxSize=0,this._recentlyUsedLanguagesIsEnabled=!1,this._recentlyUsedLanguageHits=0,this._recentlyUsedLanguageMisses=0,this._hasLoggedRecentlyUsedLanguageHitRate=!1,this._languages=null,this._allLanguageOptions=null,this._languages=e.GetSortedByDisplayName(Ft.i.getCultures(1)),this._lcidToCultureInfo=new Da.u(Ft.i),this._recentlyUsedLanguagesList=new Array(0),this._recentlyUsedLanguagesSet=new qc.f(Number),this._recentlyUsedLanguagesIsEnabled=t,this._recentlyUsedLanguagesMaxSize=n<=0?e.DefaultRecentlyUsedLanguagesMaxSize:n,this._recentlyUsedLanguageHits=0,this._recentlyUsedLanguageMisses=0,this._hasLoggedRecentlyUsedLanguageHitRate=!1,t&&(this.InitializeRecentlyUsedLanguages(),L.AFrameworkApplication.subscribeToBeforeAppShutDown((function(e,t){i.logRecentlyUsedLanguageHitRate()})))}return e.prototype.InitializeRecentlyUsedLanguages=function(){for(var t=0,n=this._languages;t<n.length;t++){var i=n[t];this._lcidToCultureInfo.set_item(i.get_LCID(),i)}var r=new Array(0);try{var o=re.z.get(e.LcidCookieName);if(o&&""!==o)for(var a=decodeURIComponent(o).split(e.LcidCookieDelimiter).slice(0,this._recentlyUsedLanguagesMaxSize),l=function(e){var t,n=parseInt(e);n!==Number.NaN&&s._lcidToCultureInfo.tryGetValue(n,(0,g.m)((function(){return t}),(function(e){return t=e})))&&r.push(t)},s=this,u=0,c=a;u<c.length;u++){l(c[u])}}catch(e){S.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",e.message),Array.clear(r)}if(r.length)for(var d=0,p=r;d<p.length;d++){var h=p[d];m=h.get_LCID();this._recentlyUsedLanguagesSet.contains(m)||(this._recentlyUsedLanguagesList.push(h),this._recentlyUsedLanguagesSet.add(m))}else{var _,m=L.AFrameworkApplication.lcid;this._lcidToCultureInfo.tryGetValue(m,(0,g.m)((function(){return _}),(function(e){return _=e})))&&(this._recentlyUsedLanguagesList.push(_),this._recentlyUsedLanguagesSet.add(m))}this.SaveRecentlyUsedLanguagesToCookie()},e.prototype.SaveRecentlyUsedLanguagesToCookie=function(){var t=Kc.Enumerable.toArray(Number,Kc.Enumerable.select(Ft.i,Number,Kc.Enumerable.asEnumerable(Ft.i,this._recentlyUsedLanguagesList),(function(e){return e.get_LCID()}))).join(e.LcidCookieDelimiter);re.z.setWithExpiration(e.LcidCookieName,t,e.LcidCookieExpirationDays)},e.prototype.populateList=function(t,n){if(t&&!(t.options.length>0)){var i=-1,r=e.GetSortedByDisplayName(this._recentlyUsedLanguagesList);if(this._recentlyUsedLanguagesIsEnabled&&r.length>0){var o=e.BuildOptionElements(r);i=e.AddOptionElementsToList(t,o,n),t.add(e.BuildDividerOption(),null)}this._allLanguageOptions||(this._allLanguageOptions=e.BuildOptionElements(this._languages));var a=e.AddOptionElementsToList(t,this._allLanguageOptions,n);-1===i&&(i=a),t.selectedIndex=i}},e.prototype.setLanguageAsMostRecentlyUsed=function(e,t){var n;if(this._recentlyUsedLanguagesIsEnabled&&this._lcidToCultureInfo.tryGetValue(e,(0,g.m)((function(){return n}),(function(e){return n=e})))){var i=e!==t;if(this._recentlyUsedLanguagesSet.contains(e)){var r=Array.indexOf(this._recentlyUsedLanguagesList,n);r>=0&&(Array.removeAt(this._recentlyUsedLanguagesList,r),this._recentlyUsedLanguagesList.push(n)),i&&this._recentlyUsedLanguageHits++}else{if(this._recentlyUsedLanguagesSet.add(e),this._recentlyUsedLanguagesList.push(n),this._recentlyUsedLanguagesList.length>this._recentlyUsedLanguagesMaxSize){var o=this._recentlyUsedLanguagesList.shift();this._recentlyUsedLanguagesSet.remove(o.get_LCID())}i&&this._recentlyUsedLanguageMisses++}this.SaveRecentlyUsedLanguagesToCookie()}},e.prototype.logRecentlyUsedLanguageHitRate=function(){var e=this._recentlyUsedLanguageHits+this._recentlyUsedLanguageMisses;if(!this._hasLoggedRecentlyUsedLanguageHitRate&&e>0){var t=100*this._recentlyUsedLanguageHits/e;S.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",t),this._hasLoggedRecentlyUsedLanguageHitRate=!0}},e.BuildOptionElements=function(e){return Kc.Enumerable.toArray(Object,Kc.Enumerable.select(Ft.i,Object,Kc.Enumerable.asEnumerable(Ft.i,e),(function(e){var t=document.createElement("OPTION"),n=e.get_displayName();return t.value=e.get_LCID().toString(),t.text=n,t})))},e.BuildDividerOption=function(){var e=document.createElement("OPTION");return e.text="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500",e.value="-1",e.disabled=!0,e},e.AddOptionElementsToList=function(e,t,n){for(var i=n.toString(),r=-1,o=0,a=t;o<a.length;o++){var l=a[o];e.add(l,null),l.value===i&&(r=e.options.length-1)}return r},e.GetSortedByDisplayName=function(e){var t=Array.clone(e);return t.sort((function(e,t){return e.get_displayName().localeCompare(t.get_displayName())})),t},e.DefaultRecentlyUsedLanguagesMaxSize=7,e.LcidCookieName="RecentlyUsedLcids",e.LcidCookieDelimiter=",",e.LcidCookieExpirationDays=180,e}();(0,o.l)(jc,"99d0833$LanguageListHelper",null,[du]);var Qc=(0,o.y)("e099064c$ISpacingCommands"),Jc=function(e){function t(){var t=e.call(this)||this;return t.Number=0,t.Type=0,t}return(0,v.t)(t,e),t}(xu.i);(0,o.l)(Jc,"819b1966$NumberButtonProps",xu.i,[]);var Xc=function(){function e(){}return e.get_SpacingCommands=function(){return e._spacingCommands||(e._spacingCommands=Ge.w.get_instance().tryResolve(Qc))},e.get_ShouldPopulateMenu=function(){return!!e.get_SpacingCommands()},e.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(Oi.u.populateLineSpacingFlyout,ol.d.view,e.PopulateLineSpacingFlyout),t.setActionFlags(Oi.u.populateLineSpacingFlyout,102)},e.PopulateLineSpacingFlyout=function(t,n,i,r,o){if(1===i||!e.get_ShouldPopulateMenu())return e.get_ShouldPopulateMenu()?32:8;var a=o;if(L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()){var l=new Array(0);l.push((0,U.m)(new Jc,{ExternalId:"LineSpacing1_00",Number:1,Type:0})),l.push((0,U.m)(new Jc,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0})),l.push((0,U.m)(new Jc,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0})),l.push((0,U.m)(new Jc,{ExternalId:"LineSpacing2_00",Number:2,Type:0})),l.push((0,U.m)(new Jc,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0})),l.push((0,U.m)(new Jc,{ExternalId:"LineSpacing3_00",Number:3,Type:0})),a.MenuItems=Yu.s.buildExternalNumberToggleButtonMenuProperties(l)}else{var s=Yu.s.buildNumberToggleButtonXml("buttonLineSpacing1_00","1.00","2759860553","4080183461",1,0),u=Yu.s.buildNumberToggleButtonXml("buttonLineSpacing1_15","1.15","2759860553","4080183461",1.15,0),c=Yu.s.buildNumberToggleButtonXml("buttonLineSpacing1_50","1.50","2759860553","4080183461",1.5,0),d=Yu.s.buildNumberToggleButtonXml("buttonLineSpacing2_00","2.00","2759860553","4080183461",2,0),g=Yu.s.buildNumberToggleButtonXml("buttonLineSpacing2_50","2.50","2759860553","4080183461",2.5,0),p=Yu.s.buildNumberToggleButtonXml("buttonLineSpacing3_00","3.00","2759860553","4080183461",3,0),h=Yu.s.buildButtonXml("buttonParagraphDialog","2465215107",Box4Intl.Box4Strings.L_LineSpacingOptions),_=Yu.s.buildControlsGroupXml("LineSpacing.Menu.Controls",[s,u,c,d,g,p,h]),m=Yu.s.buildMenuSectionXml("msLineSpacing",_,"Menu"),f=Yu.s.buildMenuXml([m]);a.PopulationXML=f}return 32},e._spacingCommands=null,e}();(0,o.l)(Xc,"da8c3343$LineSpacingRibbonMenu",null,[]);var Yc=n(5871),Zc=function(){function e(){}return e.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addActionWithFlags(Oi.u.showToastNotification_Automation,ol.d.application,e.ShowToastNotification,96),t.addActionWithFlags(Oi.u.showCalloutNotification_Automation,ol.d.application,e.ShowCalloutNotification,96)},e.ShowToastNotification=function(e,t,n,i,r){if(1===n)return 32;var o=yi.App.get_activeAppFrame().get_notificationBar().createEntry("Automation test",!1);return o.set_image(3),yi.App.get_activeAppFrame().get_notificationBar().addEntry(o),32},e.ShowCalloutNotification=function(t,n,i,r,a){var l;return e.ParseCalloutNotificationAutomationActionData(a,(0,g.m)((function(){return l}),(function(e){return l=e})))?(mu.UISurfaces.getNotificationsAPIAsync().then((function(e){var t=null,n=e.calloutNotificationButton("OK",(function(){t&&e.removeNotification(t)})),i=(l?o.i(e,e.teachingCallout,"teachingCallout"):o.i(e,e.calloutNotification,"calloutNotification"))("#"+Yc.u.ribbonPanelId,"Here's the text for the callout","Your title",!1,n);return t=e.addNotification(i),null})),32):16},e.ParseCalloutNotificationAutomationActionData=function(e,t){return t.val=!1,!!e&&(t.val=Boolean.parse(e),!0)},e}();(0,o.l)(Zc,"363cad85$NotificationsTestHookActor",null,[]);var ed=function(){function e(e){this._appFrame=null,this._appFrame=e}return e.prototype.updateControls=function(e){this._appFrame&&this._appFrame.updateRibbonControls(e)},e.prototype.updateControl=function(e){this._appFrame&&this._appFrame.updateRibbonControl(e)},e}();(0,o.l)(ed,"4240c7bf$RibbonButtonUpdater",null,[hu.l]);var td=n(4642),nd=function(){function e(){this._container=null,this._contextMenuController=null,this._standaloneRootController=null}return e.prototype.get_name=function(){return"Box4.UI"},e.prototype.configure=function(e){var t=this;this._container=e,L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactFloatieEnabled()?(e.register(iu).singleInstance().usingFactory((function(){return new fu(e.resolve(qu),e.resolve(ru.u))})),e.register(tu.k).singleInstance().usingFactory((function(){return new gc(e.resolve(iu))}))):e.register(tu.k).singleInstance().usingFactory((function(){return new Xu(e.resolveFuture(ou.h))})),e.register(ou.h).usingFactory((function(){return new $c(e.resolve(Ec),L.AFrameworkApplication.get_theActionManager())})).singleInstance(),e.register(Lc).singleInstance().usingFactory((function(){return new Lc(e.resolve(au.z),new td.b,e.resolve(xa.b).get_instance())})),e.register(lu).usingFactory((function(){return new zc(fa.SelectionManager.get_instance().get_selectionContextForActionDispatch(),e.tryResolve(su.n),e.resolveFuture(Ca.r),e.resolve(uu.e))})),e.register(ju).as(nu.r).singleInstance().usingFactory((function(){return new ju(L.AFrameworkApplication.get_imageClusterPath())})),e.register(cu).usingFactory((function(){return new Rc(e.resolve(va),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReplaceQuoteWithSmartQuoteIsEnabled"))})),e.register(jc).as(du).singleInstance().usingFactory((function(){return new jc(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RecentlyUsedLanguagesListIsEnabled"))})),e.register(sc).as(gu).singleInstance(),e.register(Zu).singleInstance().usingFactory((function(){return new Zu(e.resolve(gu))})),e.register(lc).as(pu).singleInstance().usingFactory((function(){return new lc(e.resolve(Zu),e.resolve(ac))})),e.register(ed).as(hu.l).singleInstance().usingFactory((function(){return new ed(t._container.resolve(_u.r))}))},e.prototype.init=function(){var e=yi.App.get_activeAppFrame(),t=e.get_applicationInstance();hi.initSignOutResponseUI(e,o.i(t,t.onAuthenticationLost,"onAuthenticationLost"),o.i(t,t.onAuthenticationRestored,"onAuthenticationRestored"),e.get_canUseAppAfterAuthLost()),Fc.registerActions(),Gc.registerActions(),Zc.registerActions(),Xc.registerActions(),this._contextMenuController=this._container.tryResolve(tu.k),this.InitializeStandaloneRoot(),this._standaloneRootController=this._container.resolve(nu.r)},e.prototype.InitializeStandaloneRoot=function(){var e=this;this._container.resolveFuture(ou.h).execute((function(t){e._container.resolveFuture(nu.r).execute((function(e){e.get_sharedStandaloneRoot().set_rootUser(t)}))}))},e.prototype.dispose=function(){this._contextMenuController&&(this._contextMenuController.dispose(),this._contextMenuController=null),this._standaloneRootController.dispose(),this._standaloneRootController=null},e.main=function(){B.o.get_instance().registerPackage(new e,6)},e}();(0,o.l)(nd,"c54f0fe2$Box4UIPackage",null,[s.u,u.s]);var id=n(3637),rd=n(9784),od=n(4919),ad=n(3170),ld=function(){function e(){}return e.getScale=function(t,n,i,r,o,a){var l,s=1;if(!t&&!n||!i||!r)return s;if(o&&a){var u=i+t,c=r+n,d=1/i,g=1/r,p=d>g?d:g;u<e.MinImageWidthPixel?u=e.MinImageWidthPixel:u>e.MaxImageWidthPixel&&(u=e.MaxImageWidthPixel),c<e.MinImageHeightPixel?c=e.MinImageHeightPixel:c>e.MaxImageHeightPixel&&(c=e.MaxImageHeightPixel),t=u-i,n=c-r,(s=Math.abs(t/i)>Math.abs(n/r)?u/i:c/r)<p&&(s=p)}else o?((l=i+t)<e.MinImageWidthPixel?l=e.MinImageWidthPixel:l>e.MaxImageWidthPixel&&(l=e.MaxImageWidthPixel),s=l/i):a&&((l=r+n)<e.MinImageHeightPixel?l=e.MinImageHeightPixel:l>e.MaxImageHeightPixel&&(l=e.MaxImageHeightPixel),s=l/r);return s},e.getAngleFromVector=function(e,t){var n=0,i=t.x-e.x,r=t.y-e.y;return(n=Math.atan2(r,i))<0&&(n+=2*Math.PI),n},e.normalizeAngle=function(e){return(e%=360)<0&&(e+=360),e},e.MinImageWidthPixel=1,e.MinImageHeightPixel=1,e.MaxImageWidthPixel=1920,e.MaxImageHeightPixel=1280,e}();(0,o.l)(ld,"febc260c$ImageHelper",null,[]);var sd=function(){function e(e,t,n){this._startPoint=null,this._endPoint=null,this._offset=null,this._classNameDirection=0,this._cursorDirection=0,this._imagePresenter=null,this._actionManager=null,this._zoomManager=null,this._angle=0,this._flipX=!1,this._flipY=!1,this._isHorizontal=!1,this._isVertical=!1,this._imageWidth=0,this._imageHeight=0,this._imageScale=0,this._imagePresenter=e,this._actionManager=t,this._zoomManager=n}return e.prototype.isDragPossible=function(e){return!!yi.App.get_activeAppFrame().workspace.get_isEditingAllowed()&&""!==this.GetHandleClassName(e.get_sourceElement())},e.prototype.onDragStart=function(e){var t=this;return!!this.isDragPossible(e)&&(this._angle=this._imagePresenter.getCurrentRotationAngle(),this.SetResizeClassNameDirection(e),this.SetResizeCursorDirection(),this.SetResizeDirectionPermissions(this._cursorDirection,(0,g.m)((function(){return t._isHorizontal}),(function(e){return t._isHorizontal=e})),(0,g.m)((function(){return t._isVertical}),(function(e){return t._isVertical=e}))),this.SetResizeOffsetFlags(),this._startPoint=e.get_screenPoint(),this._offset=new Sys.UI.Point(0,0),this._imagePresenter.getDimensions((0,g.m)((function(){return t._imageWidth}),(function(e){return t._imageWidth=e})),(0,g.m)((function(){return t._imageHeight}),(function(e){return t._imageHeight=e}))),S.ULS.sendTraceTag(16802335,322,50,"Image resize drag started"),!0)},e.prototype.onDragMove=function(e){return this._endPoint=e.get_screenPoint(),this.CalcOffset(),this._imageScale=ld.getScale(this._offset.x,this._offset.y,this._imageWidth,this._imageHeight,this._isHorizontal,this._isVertical),this._imagePresenter.updateRenderSize(this._imageScale,this._isHorizontal,this._isVertical),!0},e.prototype.onDragEnd=function(e){this.SetSize(),S.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")},e.prototype.onDragCancel=function(e){this._imagePresenter.resetRenderSize(),S.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")},e.prototype.SetResizeCursorDirection=function(){var e=Math.floor((this._angle+22)/45)%8+this._classNameDirection;this._cursorDirection=e%8},e.prototype.SetResizeDirectionPermissions=function(e,t,n){if(this._angle&&90!==this._angle&&180!==this._angle&&270!==this._angle&&360!==this._angle||this.IsIntermediateDirection(e))return t.val=!0,void(n.val=!0);switch(t.val=!1,n.val=!1,e){case 1:case 5:n.val=!0;break;case 3:case 7:t.val=!0}},e.prototype.SetResizeOffsetFlags=function(){switch(this._flipX=!1,this._flipY=!1,this._cursorDirection){case 0:this._flipX=!0,this._flipY=!0;break;case 1:case 2:this._flipY=!0;break;case 7:case 6:this._flipX=!0}},e.prototype.IsIntermediateDirection=function(e){return!(e%2)},e.prototype.GetHandleClassName=function(t){var n=t.className;-1===n.indexOf(e.ResizeHandleCssClassPrefix)&&t.parentNode&&(n=t.parentNode.className);for(var i=n.split(" "),r=0;r<i.length;r++){var o=i[r].toString();if(o.startsWith(e.ResizeHandleCssClassPrefix)&&o!==e.ResizeHandleCommonCssClass)return o}return""},e.prototype.SetResizeClassNameDirection=function(e){switch(this.GetHandleClassName(e.get_sourceElement())){case"WACImageResizeHandleNW":this._classNameDirection=0;break;case"WACImageResizeHandleN":this._classNameDirection=1;break;case"WACImageResizeHandleNE":this._classNameDirection=2;break;case"WACImageResizeHandleE":this._classNameDirection=3;break;case"WACImageResizeHandleSE":this._classNameDirection=4;break;case"WACImageResizeHandleS":this._classNameDirection=5;break;case"WACImageResizeHandleSW":this._classNameDirection=6;break;case"WACImageResizeHandleW":this._classNameDirection=7}},e.prototype.CalcOffset=function(){var e=1;this._zoomManager.get_instance()&&(e=this._zoomManager.get_instance().get_currentZoom());var t=(this._endPoint.x-this._startPoint.x)/e,n=(this._endPoint.y-this._startPoint.y)/e;this._offset.x=this._flipX?-t:t,this._offset.y=this._flipY?-n:n},e.prototype.SetSize=function(){var e,t,n=new Dl.DictionaryPropertySet;(n.setValue(Pl.k.imageScale,100*this._imageScale),n.setValue(Pl.k.imageScaleFromCurrent,!0),90===this._angle||270===this._angle)?(this.SetResizeDirectionPermissions(this._classNameDirection,(0,g.m)((function(){return e}),(function(t){return e=t})),(0,g.m)((function(){return t}),(function(e){return t=e}))),n.setValue(Pl.k.imageResizeIsHorizontal,e),n.setValue(Pl.k.imageResizeIsVertical,t)):(n.setValue(Pl.k.imageResizeIsHorizontal,this._isHorizontal),n.setValue(Pl.k.imageResizeIsVertical,this._isVertical));this._actionManager.processActionWithData(Oi.u.imageResize,2,n)},e.ResizeHandleCssClassPrefix="WACImageResizeHandle",e.ResizeHandleCommonCssClass="WACImageResizeHandles",e}();(0,o.l)(sd,"24a7ea7f$ImageResizeDragAdapter",null,[ad.q]);var ud=function(){function e(e,t){this._actionManager=null,this._zoomManager=null,this._actionManager=e,this._zoomManager=t}return e.prototype.getImageResizeDragAdapter=function(e){return new sd(e,this._actionManager,this._zoomManager)},e}();(0,o.l)(ud,"4711eccb$ImageResizeDragAdapterFactory",null,[id.i]);var cd=(0,o.y)("73e13f25$IImageRotateDragAdapter"),dd=n(1266),gd=n(6399),pd=function(){function e(e,t,n,i,r,o){this._interactiveView=null,this._imagePresenter=null,this._actionManager=null,this._selectionManager=null,this._zoomManager=null,this._rotationContext=null,this._startPoint=null,this._endPoint=null,this._imgTopLeft=null,this._selectElement=null,this._rotateGripper=null,this._rotateHandle=null,this._wetChangeAngle=0,this._rotatingAngle=0,this._originalAngle=0,this._localAngle=0,this._properties=null,this._rotationGripperCreated=!1,this._isDisposed=!1,this._actionManager=e,this._selectionManager=t,this._interactiveView=n,this._imagePresenter=i,this._zoomManager=r,this._rotatingAngle=0,this._localAngle=0,this._selectElement=o}return e.prototype.CreateRotationHandle=function(){this._selectElement?(this._rotateHandle=dd.l.createElement(this._selectElement.ownerDocument,gd.q.span),this._rotateHandle.className=e._imgRotateHandleCssClass+" "+e._imgRotateBaseCssClass,this._rotateGripper=Ct.ImageClusteringHelper.createClusteredImage(24,24,"RotationArrow_24x24x32",e._imgRotateArrowCssClass,!1,""),this._rotateGripper.style.left="-12px",this._rotateGripper.style.position="absolute",this._rotateHandle.appendChild(this._rotateGripper),this._selectElement.appendChild(this._rotateHandle),this._rotationGripperCreated=!0):S.ULS.sendTraceTag(50868820,322,15,"_selectElement is null when creating rotate handle")},e.prototype.flipRotateGripper=function(t){this._rotationGripperCreated&&!this._isDisposed||S.ULS.sendTraceTag(50597971,322,15,"{0}",{Message:"FlipRotateGripper called before create gripper or after dispose",RotationGripperCreated:this._rotationGripperCreated,IsDisposed:this._isDisposed}),this._rotateHandle&&this._rotateGripper||(S.ULS.sendTraceTag(50597972,322,15,"{0}",{Message:"_rotateHandle or _rotateGripper is null. Call CreateRotationHandle again",SelectElementIsNull:!this._selectElement,RotateHandleIsNull:!this._rotateHandle,RotateGripperIsNull:!this._rotateGripper}),this.CreateRotationHandle()),t?(this._rotateGripper&&Sys.UI.DomElement.addCssClass(this._rotateGripper,e._imgFlipped),this._rotateHandle&&Sys.UI.DomElement.addCssClass(this._rotateHandle,e._imgFlipped),qi.o.setFlipTransForms(this._rotateGripper,!0,!0)):(this._rotateGripper&&Sys.UI.DomElement.removeCssClass(this._rotateGripper,e._imgFlipped),this._rotateHandle&&Sys.UI.DomElement.removeCssClass(this._rotateHandle,e._imgFlipped),qi.o.setFlipTransForms(this._rotateGripper,!1,!1))},e.prototype.getRotationGripper=function(){return this.CreateRotationHandle(),this._rotateGripper},e.prototype.isDragPossible=function(e){return!!yi.App.get_activeAppFrame().workspace.get_isEditingAllowed()&&(!!e&&(this._rotationContext=this.GetImageContext(),!!this._rotationContext))},e.prototype.onDragStart=function(e){return!!this.isDragPossible(e)&&(this._rotationContext=this.GetImageContext(),this._properties=pa.ImageReader.getImagePropertiesFromContext(this._rotationContext),this._properties?(this._startPoint=this.GetClientPoint(e),this._imgTopLeft=Sys.UI.DomElement.getBounds(this._selectElement),this._wetChangeAngle=pa.ImageReader.getImageWetChangeRotationAngle(this._properties)>0?pa.ImageReader.getImageWetChangeRotationAngle(this._properties):0,this._originalAngle=pa.ImageReader.getImagePersistedRotationAngle(this._properties),S.ULS.sendTraceTag(22052886,322,50,"Image rotate drag event started."),!0):(S.ULS.sendTraceTag(24496074,322,15,"Drag start cancelled. Attempted to rotate with null img. properties."),!1))},e.prototype.onDragMove=function(e){return this._endPoint=this.GetClientPoint(e),this.CalculateAngle(),this._imagePresenter?(this._imagePresenter.updateRotationEffect(this._rotatingAngle,this._localAngle),S.ULS.sendTraceTag(25179723,322,50,"Image rotate drag move is happening."),!0):(S.ULS.sendTraceTag(25179724,322,50,"Image rotate drag move aborted because img presenter is null."),!1)},e.prototype.onDragEnd=function(e){this._rotatingAngle=ld.normalizeAngle(this._rotatingAngle),this._wetChangeAngle=this._rotatingAngle,this.SetRotation(),S.ULS.sendTraceTag(22052887,322,50,"Image rotate drag event ended.")},e.prototype.onDragCancel=function(e){this._imagePresenter.updateRotationEffect(this._originalAngle,0),S.ULS.sendTraceTag(22052888,322,50,"Image rotate drag event canceled.")},e.prototype.GetClientPoint=function(e){return this._interactiveView.getClientPointFromDomEvent(e)},e.prototype.GetImageContext=function(){return this._selectionManager.get_selectionContextForActionDispatch()},e.prototype.CalculateAngle=function(){var e=1;this._zoomManager&&this._zoomManager.get_instance()&&(e=this._zoomManager.get_instance().get_currentZoom());var t=this._imgTopLeft.x+this._selectElement.clientWidth/2*e,n=this._imgTopLeft.y+this._selectElement.clientHeight/2*e,i=new Sys.UI.Point(t,n),r=ld.getAngleFromVector(this._startPoint,i),o=ld.getAngleFromVector(this._endPoint,i);this._rotatingAngle=Math.round(Vu.r.radiansToDegrees(o-r)),this._wetChangeAngle>0&&(this._rotatingAngle+=this._wetChangeAngle-this._originalAngle),this._localAngle=this._rotatingAngle,this._rotatingAngle+=this._originalAngle},e.prototype.SetRotation=function(){var e=new Dl.DictionaryPropertySet;e.setValue(Pl.k.imageRotateActionType,0),e.setValue(Pl.k.imageRotateAngle,this._rotatingAngle),this._actionManager.processActionWithData(Oi.u.imageRotate,2,e)},e.prototype.dispose=function(){S.ULS.sendTraceTag(50597973,322,50,"ImageRotateDragAdapter is disposed."),this._isDisposed||(this._rotateHandle&&(this._rotateGripper&&this._rotateHandle.contains(this._rotateGripper)&&(this._rotateHandle.removeChild(this._rotateGripper),this._rotateGripper=null),this._selectElement&&this._selectElement.contains(this._rotateHandle)&&(this._selectElement.removeChild(this._rotateHandle),this._rotateHandle=null)),this._isDisposed=!0)},e._imgRotateHandleCssClass="WacImgRotateHandle",e._imgRotateBaseCssClass="WacImgRotateBase",e._imgRotateArrowCssClass="WacImgRotateArrow",e._imgFlipped="Flipped",e}();(0,o.l)(pd,"775f6174$ImageRotateDragAdapter",null,[cd,ad.q,Sys.IDisposable]);var hd=function(){function e(e,t,n){this._selectionManager=null,this._actionManager=null,this._zoomManager=null,this._actionManager=e,this._selectionManager=t,this._zoomManager=n}return e.prototype.create=function(e,t,n){return new pd(this._actionManager,this._selectionManager,e,t,this._zoomManager,n)},e}();(0,o.l)(hd,"9382a5c0$ImageRotateDragAdapterFactory",null,[od.j]);var _d=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.Images"},e.prototype.configure=function(e){this._container=e,this._container.register(ud).as(id.i).singleInstance().usingFactory((function(){return new ud(L.AFrameworkApplication.get_theActionManager(),Ge.w.get_instance().resolveFuture(rd.w))})),this._container.register(hd).as(od.j).singleInstance().usingFactory((function(){return new hd(L.AFrameworkApplication.get_theActionManager(),fa.SelectionManager.get_instance(),Ge.w.get_instance().resolveFuture(rd.w))}))},e.prototype.init=function(){this._container.resolve(od.j)},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(_d,"c07f4b22$Box4ImagesPackage",null,[s.u,u.s]);var md=(0,o.y)("55dbb334$ISelectAllHandlers"),fd=n(4741),yd=n(7862),Cd=n(32),Sd=function(){function e(){this._paragraphNode=null}return e.prototype.get_contentTitle=function(){return null},e.prototype.getTitle=function(e){return null},e.prototype.getDescription=function(e){return null},e.prototype.reset=function(e){this._paragraphNode=e.get_node()},e.prototype.tryGetCpContext=function(e,t){var n=Cd.f.getBlobObjectAtCp(this._paragraphNode,e);return t.val=null,!(!n||n.get_blobType()!==this.get_blobType())&&(t.val=new ua.e,t.val.set_providerKey(this.get_key()),t.val.set_contentObject(n),t.val.title=this.getTitle(n),t.val.description=this.getDescription(n),!0)},e}();(0,o.l)(Sd,"3d3c3871$BlobDetailsProvider",null,[ra.q,yd.f]);var bd=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.get_key=function(){return"EQUATION"},t.prototype.get_blobType=function(){return 11},t.prototype.get_contentTitle=function(){return Box4Intl.Box4Strings.l_EquationContentTitle},t}(Sd);(0,o.l)(bd,"d535d61e$EquationDetailsProvider",Sd,[]);var vd=function(){function e(){this._hyperlinkRanges=null}return e.prototype.get_key=function(){return"LINK"},e.prototype.get_contentTitle=function(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle},e.prototype.reset=function(e){this._hyperlinkRanges=Ha.HyperlinkReader.getHyperlinksInParagraph(e.get_node())},e.prototype.tryGetCpContext=function(e,t){t.val=null;for(var n=0,i=this._hyperlinkRanges;n<i.length;n++){var r=i[n];if(r.cpBegin<=e&&e<r.cpEnd)return t.val=new ua.e,t.val.set_providerKey(this.get_key()),t.val.set_contentObject(r.hyperlink),!0}return!1},e}();(0,o.l)(vd,"9b0cf6f4$HyperlinkDetailsProvider",null,[ra.q,yd.f]);var Td=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.get_key=function(){return"IMAGE"},t.prototype.get_blobType=function(){return 5},t.prototype.get_contentTitle=function(){return Box4Intl.Box4Strings.l_ImageContentTitle},t.prototype.getTitle=function(e){return pa.ImageReader.getImageAltText(e.properties)},t.prototype.getDescription=function(e){return pa.ImageReader.getImageAltTextDescription(e.properties)},t}(Sd);(0,o.l)(Td,"e04b9605$ImageDetailsProvider",Sd,[]);var Ad=function(){function e(){}return e.prototype.get_key=function(){return"IMAGENODE"},e.prototype.get_contentTitle=function(){return Box4Intl.Box4Strings.l_ImageContentTitle},e.prototype.tryGetDocumentStructureDetails=function(e,t){return t.val=null,!(!e||!pa.ImageReader.isImageNode(e.get_currentNode()))&&(t.val=new da,t.val.set_providerKey(this.get_key()),t.val.contentId=e.get_currentNode().get_id(),t.val.set_contentObject(e.get_currentNode()),!0)},e.prototype.getContentIncrementalDetails=function(e,t){var n=e.get_contentObject(),i=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,r="";return t&&n.get_id()===t.get_contentObject().get_id()||(r=String.format(i,pa.ImageReader.getImageAltText(n.get_properties()),Box4Intl.Box4Strings.l_ImageContentTitle)),r},e.prototype.tryCollapseNestedContent=function(e,t,n){return n.val=null,!1},e}();(0,o.l)(Ad,"52822ce5$ImageNodeDetailsProvider",null,[oa,yd.f]);var Id,wd=n(9350),xd=function(){function e(t,n){this._proofingType=0,this._errorRangeEditor=null,this._errorRanges=null,this.$$pf_Key=null,this.$$pf_ContentTitle=null,this._errorRangeEditor=n,this._proofingType=t,this.set_key(e.Keys.get_item(t)),this.set_contentTitle(e.ContentTitles.get_item(t))}return e.prototype.get_key=function(){return this.$$pf_Key},e.prototype.set_key=function(e){return this.$$pf_Key=e,e},e.prototype.get_contentTitle=function(){return this.$$pf_ContentTitle},e.prototype.set_contentTitle=function(e){return this.$$pf_ContentTitle=e,e},e.prototype.reset=function(e){this._errorRanges=this._errorRangeEditor.getErrorRanges(e.get_node())},e.prototype.tryGetCpContext=function(t,n){var i=this,r=e.FirstOrDefault(wd.w,this._errorRanges||new Array(0),(function(e){return i.IsCpInErrorRangeOfProofingType(t,e)}));return n.val=this.CreateCpContentDetails(r),!!n.val},e.prototype.IsCpInErrorRangeOfProofingType=function(e,t){return t.get_begin()<=e&&e<t.get_end()&&(!t.errorDetails||this._proofingType===t.errorDetails.get_proofingType())},e.prototype.CreateCpContentDetails=function(e){var t;return e?((t=new ua.e).set_providerKey(this.get_key()),t.set_contentObject(e.errorDetails),t):null},e.FirstOrDefault=function(e,t,n){for(var i=0,r=t;i<r.length;i++){var a=r[i];if(n(a))return a}return o.c(e)},e.Keys=((Id=new ec.n(rc.t,String)).add(1,"SPELLINGERROR"),Id.add(2,"GRAMMATICALERROR"),Id.add(3,"ADVANCEDERROR"),Id),e.ContentTitles=((Id=new ec.n(rc.t,String)).add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),Id.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),Id.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),Id),e}();(0,o.l)(xd,"7f579906$ProofingDetailsProvider",null,[ra.q,yd.f]);var Ed=function(){return function(){this.tableNode=null,this.rows=0,this.columns=0,this.rowIdx=0,this.colIdx=0}}();(0,o.l)(Ed,"7988b12c$TableInfo",null,[]);var Fd=n(9088),Pd=n(1507),Dd=n(3603),Rd=function(){function e(){}return e.prototype.get_key=function(){return"TABLE"},e.prototype.get_contentTitle=function(){return Box4Intl.Box4Strings.l_TableContentTitle},e.prototype.tryGetDocumentStructureDetails=function(e,t){if(t.val=null,!js.TableCellReader.isTableCell(e))return!1;var n=new ha.g;n.setFrom(e);var i=new Ed;return i.rowIdx=Dd.v.getRowIndex(n)+1,i.colIdx=Fd.s.getColumnIndex(n)+1,Pd.TableNavigator.returnToContainingTable(n),i.tableNode=n.get_currentNode(),i.columns=us.TableReader.getColumnCount(i.tableNode),i.rows=us.TableReader.getRowCount(i.tableNode),t.val=new da,t.val.set_providerKey(this.get_key()),t.val.contentId=i.tableNode.get_id(),t.val.set_contentObject(i),!0},e.prototype.getContentIncrementalDetails=function(e,t){var n=e.get_contentObject(),i=new la.o(String);return t||i.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,n.columns,n.rows)),t&&t.get_contentObject().colIdx===n.colIdx||i.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,n.colIdx)),t&&t.get_contentObject().rowIdx===n.rowIdx||i.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,n.rowIdx)),i.toArray().join(" ")},e.prototype.tryCollapseNestedContent=function(e,t,n){return n.val=null,!1},e}();(0,o.l)(Rd,"643a86dc$TableDetailsProvider",null,[oa,yd.f]);var Md=function(){function e(e,t){this._futureAccessibilityContextManager=null,this._errorRangeEditor=null,this._futureAccessibilityContextManager=e,this._errorRangeEditor=t}return e.prototype.RegisterContentDetailsProviders=function(){var e=this;this._futureAccessibilityContextManager.execute((function(t){t.registerCpContentDetailsProvider(new vd),t.registerCpContentDetailsProvider(new xd(1,e._errorRangeEditor)),t.registerCpContentDetailsProvider(new xd(2,e._errorRangeEditor)),t.registerCpContentDetailsProvider(new xd(3,e._errorRangeEditor)),t.registerCpContentDetailsProvider(new bd),t.registerCpContentDetailsProvider(new Td),t.registerStructuralContentDetailsProvider(new Rd),t.registerStructuralContentDetailsProvider(new Ad)}))},e}();(0,o.l)(Md,"36a32584$AccessibilityActor",null,[]);var kd=(0,o.y)("e3cd3cc0$IBox4PasteStewardFactory"),Nd=n(2057),Ld=(0,o.y)("b0e13f8c$IBox4PasteStewardUtils"),Bd=n(4693),Od=(0,o.y)("6259e702$ISystemClipboard"),Ud=n(8282),Hd=(0,o.y)("4de8f38e$IChromeExtensionHelper"),Gd=(0,o.y)("f21428a1$ISystemClipboardAccessManagerFactory"),Wd=(0,o.y)("97711d15$ISystemClipboardAccessManager"),Vd=n(3747),$d=(0,o.y)("e7a6cceb$IClipboardOperationCutStrategy"),zd=(0,o.y)("27c73957$IDeleteTableSegmentStrategy"),Kd=(0,o.y)("dcd8d522$ISelectionFactory"),qd=(0,o.y)("79d614f7$IRenderOrderGraphIteratorFactory"),jd=(0,o.y)("19061046$IDomElementContentStateFactory"),Qd=(0,o.y)("64fd4a0c$IClipboardOperationPasteOvertypeStrategy"),Jd=n(9481),Xd=n(3758),Yd=n(7164),Zd=n(3374),eg=n(7055),tg=n(8952),ng=(0,o.y)("ff706675$IClipboardOperationPasteFactory"),ig=(0,o.y)("ae478ece$IClipboardOperationPasteStrategyFactory"),rg=(0,o.y)("81f416e1$IClipboardOperationCutCopyFactory"),og=n(3121),ag=n(7899),lg=n(3971),sg=(0,o.y)("eccb099c$IClipboardOperationClipboardAccessHelper"),ug=n(4124),cg=n(9423),dg=n(5853),gg=(0,o.y)("481e91f0$IExternalPasteExecutionManagerFactory"),pg=(0,o.y)("9df3ab4$IBox4ImageStewardFactory"),hg=(0,o.y)("9c124f4d$IBox4TableStewardFactory"),_g=(0,o.y)("6b9fa6b0$IBox4WordConverterFactory"),mg=(0,o.y)("6fb5d53$IHtmlTranslatorSettings"),fg=(0,o.y)("837be5c6$IContentControlCopyPasteHelper"),yg=(0,o.y)("1f745266$IExternalPasteCssConverter"),Cg=(0,o.y)("f10886fa$IHtmlNormalizerSettings"),Sg=n(5098),bg=n(9048),vg=n(7704),Tg=n(3734),Ag=(0,o.y)("6bdbb2a$IInternalPasteExecutionManagerFactory"),Ig=n(4355),wg=(0,o.y)("4078a61e$IImageStewardBridge"),xg=n(367),Eg=n(4610),Fg=n(6302),Pg=n(8695),Dg=(0,o.y)("80154dd0$IFontNameFormattingStrategy"),Rg=n(5183),Mg=(0,o.y)("9659dda2$ILanguageDialog"),kg=n(8990),Ng=n(7372),Lg=(0,o.y)("d55ca5e8$IProofingErrorPresenter"),Bg=(0,o.y)("a5844147$IFormattingViewOperationFinishedStageProcessor"),Og=(0,o.y)("d7033b9e$IEopFormattingStrategy"),Ug=n(2570),Hg=function(){function e(e){this.IsBrsOfOfficeOnlineExtensionSwitchedOn=!1,this.OfficeOnlineExtensionId=null,this.OldCopyPasteExtensionId=null,this.CurrentUsingExtensionId=null,this.$$pf_ShouldCheckExtensionBySendingMessage=!1,this.OfficeOnlineExtensionId=e.getStringAppSetting("OfficeOnlineChromeExtensionId"),this.OldCopyPasteExtensionId=e.getStringAppSetting("ChromeClipboardAccessExtensionId"),this.IsBrsOfOfficeOnlineExtensionSwitchedOn=e.getBooleanAppSetting("OfficeOnlineChromeExtensionIsEnabled"),this.set_shouldCheckExtensionBySendingMessage(!this.IsOfficeOnlineExtensionAvailable()),this.get_shouldCheckExtensionBySendingMessage()?this.CurrentUsingExtensionId=this.OldCopyPasteExtensionId:this.CurrentUsingExtensionId=this.OfficeOnlineExtensionId}return e.prototype.getExtensionId=function(){return this.CurrentUsingExtensionId},e.prototype.resetExtensionId=function(){this.CurrentUsingExtensionId===this.OfficeOnlineExtensionId&&this.get_IsLocalStorageAccessible()&&(localStorage.removeItem(e.OfficeOnlineExtensionInstalled),localStorage.removeItem(e.CopyPasteSupported)),this.CurrentUsingExtensionId=this.OldCopyPasteExtensionId,this.set_shouldCheckExtensionBySendingMessage(!0)},e.prototype.get_shouldCheckExtensionBySendingMessage=function(){return this.$$pf_ShouldCheckExtensionBySendingMessage},e.prototype.set_shouldCheckExtensionBySendingMessage=function(e){return this.$$pf_ShouldCheckExtensionBySendingMessage=e,e},e.prototype.IsOfficeOnlineExtensionAvailable=function(){if(this.IsBrsOfOfficeOnlineExtensionSwitchedOn&&this.get_IsLocalStorageAccessible()){var t=localStorage.getItem(e.OfficeOnlineExtensionInstalled);if(t&&"true"===t){var n=localStorage.getItem(e.CopyPasteSupported);return!!n&&"true"===n}}return!1},e.prototype.get_IsLocalStorageAccessible=function(){var e="LocalStorageAccessiblityTest",t=!1;try{localStorage.setItem(e,e),t=localStorage.getItem(e)===e,localStorage.removeItem(e)}catch(e){S.ULS.sendTraceTag(19452045,307,50,e.toString())}return t},e.OfficeOnlineExtensionInstalled="IsOfficeOnlineExtensionInstalled",e.CopyPasteSupported="IsCopyPasteSupported",e}();(0,o.l)(Hg,"b46aa487$ChromeExtensionHelper",null,[Hd]);var Gg=n(7043),Wg=function(){function e(){}return e.prototype.create=function(e){return new Gg.w(e)},e}();(0,o.l)(Wg,"5fbd756f$Factory",null,[jd]);var Vg=n(473),$g=n(6103),zg=function(){function e(e,t,n){this._activityManager=null,this._autoCorrectOptionsDialogFactory=null,this._theActionManager=null,this._theActionManager=e,this._activityManager=t,this._autoCorrectOptionsDialogFactory=n}return e.prototype.registerActions=function(){this._theActionManager.addActionWithFlags(Oi.u.openAutoCorrectOptions,ol.d.view,o.i(this,this.OpenAutoCorrectOptionsView,"OpenAutoCorrectOptionsView"),4)},e.prototype.OpenAutoCorrectOptionsView=function(e,t,n,i,r){return 1===n?32:(this._autoCorrectOptionsDialogFactory().showLanguageDialog(),32)},e}();(0,o.l)(zg,"af2c35fb$AutoCorrectActor",null,[]);var Kg=n(4505),qg=(0,o.y)("715baf40$IBox4ImageSteward"),jg=function(){function e(e,t){this.noteTagName=null,this.noteTagStatus=null,this.noteTagName=e,this.noteTagStatus=t||"Normal"}return e.prototype.get_noteTagName=function(){return this.noteTagName},e.prototype.get_noteTagStatus=function(){return this.noteTagStatus},e}();(0,o.l)(jg,"1c8819b0$NoteTagInfo",null,[]);var Qg=function(){function e(e,t,n,i,r){this.ownerHtmlElementInfo=null,this.htmlElementInfoFromHierarchy=null,this.absolutePosition=null,this.ownerNoteTagInfo=null,this.cultureName=null,e&&(this.ownerHtmlElementInfo=e),t&&(this.htmlElementInfoFromHierarchy=t),this.ownerNoteTagInfo=n||new C.c(jg),i&&""!==i&&(this.cultureName=i),this.absolutePosition=r}return e.prototype.get_ownerHtmlElementInfo=function(){return this.ownerHtmlElementInfo},e.prototype.get_htmlElementInfoFromHierarchy=function(){return this.htmlElementInfoFromHierarchy},e.prototype.get_cultureName=function(){return this.cultureName},e}();(0,o.l)(Qg,"2b6045df$GlobalAttributesArgs",null,[]);var Jg=function(e){function t(t,n,i,r,o,a,l,s,u){void 0===o&&(o=null),void 0===a&&(a=0),void 0===l&&(l=0),void 0===s&&(s=null),void 0===u&&(u=null);var c=e.call(this,o?o.get_ownerHtmlElementInfo():null,o?o.get_htmlElementInfoFromHierarchy():null,o?o.ownerNoteTagInfo:null,o?o.get_cultureName():null,o?o.absolutePosition:null)||this;return c.src=null,c.alt=null,c.width=0,c.height=0,c.maxWidth=0,c.maxHeight=0,c.href=null,c.desc=null,c.src=t,c.alt=n,c.width=i,c.height=r,c.maxWidth=a,c.maxHeight=l,c.href=s,c.desc=u,c}return(0,v.t)(t,e),t}(Qg);(0,o.l)(Jg,"c7511f56$ImageSemanticArgs",Qg,[]);var Xg=function(){function e(t){this._arrayList=null,o.m(this,e.$$(t)),this._arrayList=[]}return e.prototype.getCopy=function(){for(var t=new e(o.f(this,"Box3.List$1").T),n=0;n<this._arrayList.length;n++)t.add(this.get_item(n));return t},e.prototype.get_count=function(){return this._arrayList.length},e.prototype.get_item=function(e){return this._arrayList[e]},e.prototype.set_item=function(e,t){return this._arrayList[e]=t,t},e.prototype.add=function(e){Array.add(this._arrayList,e)},e.prototype.clear=function(){Array.clear(this._arrayList)},e.prototype.contains=function(e){return Array.contains(this._arrayList,e)},e.prototype.getRange=function(t,n){for(var i=new e(o.f(this,"Box3.List$1").T),r=0;r<n;r++)i.add(this.get_item(t+r));return i},e.prototype.indexOf=function(e){return Array.indexOf(this._arrayList,e)},e.prototype.insert=function(e,t){Array.insert(this._arrayList,e,t)},e.prototype.remove=function(e){return Array.remove(this._arrayList,e)},e.prototype.removeAt=function(e){Array.removeAt(this._arrayList,e)},e.prototype.removeRange=function(e,t){for(var n=0;n<t;n++)Array.removeAt(this._arrayList,e)},e.prototype.reverse=function(){this._arrayList.reverse()},e.prototype.sort=function(){this._arrayList.sort()},e.prototype.toArray=function(){return Array.clone(this._arrayList)},e.$$=function(t){return o.o("Box3.List$1",e,[{T:t}],null,[],{})},e}(),Yg=function(){return function(e,t,n,i){void 0===i&&(i=0),this.node=null,this.blob=null,this.location=0,this.imageAnchorId=0,this.node=e,this.blob=t,this.location=n,this.imageAnchorId=i}}();(0,o.l)(Yg,"452fc5e9$InsertPictureResult",null,[]);var Zg=function(){function e(e){this._iterator=null,this._box4PasteSteward=null,this._maxPicturesExceeded=!1,this._parentGraphSpace=null,this._results=new Xg(Yg),this._imageSemanticArgs=new Xg(Jg),this._iterator=e}return e.prototype.get_numPicturesPasted=function(){return El.r.shipAssertTag(4281429,307,this._results.get_count()===this._imageSemanticArgs.get_count()),this._results.get_count()},e.prototype.get_maxPicturesExceeded=function(){return this._maxPicturesExceeded},e.prototype.set_maxPicturesExceeded=function(e){return this._maxPicturesExceeded=e,e},e.prototype.bindToOwnerSteward=function(e){this._box4PasteSteward=e},e.prototype.get_desiredRevisionId=function(){return null},e.prototype.aggregateImages=function(e,t){this._results.add(e),this._imageSemanticArgs.add(t)},e.maxAltTextLength=2712,e}();(0,o.l)(Zg,"1aed0b0b$APicturePasteHandler",null,[qg]);var ep=n(244),tp=n(5352),np=n(2601),ip=n(5780),rp=function(){return function(e,t,n,i){this.request=null,this.requestSerialized=null,this.url=null,this.hasBeenRetried=!1,this.insertPictureResults=null,this.request=e,this.requestSerialized=t,this.url=i,this.insertPictureResults=n}}();(0,o.l)(rp,"6b926246$PicturePasteRequestInfo",null,[]);var op=n(1877),ap=function(){function e(){this.ImageId=null,this.Src=null,this.Alt=null,this.Desc=null,this.Width=0,this.Height=0,this.LockId=0,this.ImageAnchorId=0,this.IsImageFromPaste=!1,this.EditContainerWidth=0,this.LocalizedPicture=null,this.IsLayoutSizeSetByUser=!1}return e.construct=function(t,n,i,r,o,a,l,s,u,c,d,g){var p=new e;return p.ImageId=t,p.Src=n,p.Alt=i,p.Width=r,p.Height=o,p.Desc=a,p.LockId=l,p.ImageAnchorId=s,p.IsImageFromPaste=u,p.EditContainerWidth=c,p.LocalizedPicture=d,p.IsLayoutSizeSetByUser=g,p},e}();(0,o.l)(ap,"f6a1e52d$PastedPicture",null,[]);var lp=n(1421),sp=function(e){function t(){var t=e.call(this)||this;return t.DataUriPictures=!1,t.PastedPictures=null,t}return(0,v.t)(t,e),t.prototype.getClassId=function(){return 31},t.construct=function(e,n){var i=new t;return i.DataUriPictures=n,i.PastedPictures=e,i},t}(lp.z);(0,o.l)(sp,"f23049d8$PicturePasteRequest",lp.z,[]);var up=n(9066),cp=n(9992),dp=n(619),gp=n(5446),pp=n(7245),hp=n(8818),_p=function(e){function t(t,n,i,r,o,a,l,s){void 0===o&&(o=null),void 0===a&&(a=null),void 0===l&&(l=!1),void 0===s&&(s=!1);var u=e.call(this,t)||this;return u._numRequestsSuccessfullySent=0,u._revisionBeforeReplication=null,u._lastNotificationBarEntry=null,u._imageEditor=null,u._taskManager=null,u._undoManager=null,u._imageStewardBridge=null,u._notificationBar=null,u._pastePictureFailedImprovementIsEnabled=!1,u._pastePictureFailedNotificationBarIsEnabled=!1,u._stopwatchBuilder=null,u._picturePasteRequestStopwatch=null,u._desiredRevisionId=ai.l.get_nil(),u._requests=new Xg(rp),u._imageEditor=n,u._taskManager=i,u._undoManager=r,u._stopwatchBuilder=yi.App.get_activeAppFrame().get_theStopwatchBuilder(),u._imageStewardBridge=o,u._notificationBar=a,u._pastePictureFailedImprovementIsEnabled=l,u._pastePictureFailedNotificationBarIsEnabled=s,yi.App.get_theSaveStatusManager().addHandler(u),u}return(0,v.t)(t,e),t.prototype.get_AppSettingsManager=function(){return L.AFrameworkApplication.appSettingsManager},t.prototype.get_picturePasteIsEnabled=function(){return yi.App.picturePasteIsEnabled},t.prototype.get_maxPicturesReached=function(){return this.get_numPicturesPasted()===yi.App.maxImagesPerPaste},t.prototype.get_UnsentRequestsRemain=function(){return this._numRequestsSuccessfullySent!==this._requests.get_count()},t.prototype.get_NumImagesSent=function(){for(var e=0,t=0;t<this._numRequestsSuccessfullySent;t++)e+=this._requests.get_item(t).request.PastedPictures.length;return e},t.prototype.get_desiredRevisionId=function(){return this._desiredRevisionId},t.prototype.onFile=function(e){},t.prototype.onImage=function(e){if(e.alt.length>Zg.maxAltTextLength){var n=Rn.l.isLowSurrogateCharAt(e.alt,Zg.maxAltTextLength)?Zg.maxAltTextLength-1:Zg.maxAltTextLength;e.alt=e.alt.substring(0,n)}if(t.IsImageSrcLocalUrl(e)&&L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordNotificationBarImageErrorSettings"),this._notificationBar&&this._pastePictureFailedImprovementIsEnabled&&this._pastePictureFailedNotificationBarIsEnabled&&t.IsImageSrcLocalUrl(e))return S.ULS.sendTraceTag(41969745,322,15,"Unable to paste image with local URL"),void this.ShowSingleNotificationError();var i=new Dl.DictionaryPropertySet,r=null;if(Gl.n.get_instance().get_item(11)&&(e=this.ScaleImageForWord(e)),this._imageEditor.preparePlaceholderForImageUpload(i,e.width,e.height,!0),Gl.n.get_instance().get_item(1))S.ULS.shipAssertTag(7869443,307,Ss.OutlineElementReader.isOutlineElement(this._iterator)||ys.OutlineReader.isOutline(this._iterator)),this._box4PasteSteward.moveToNextOutlineElementForHtmlImport(!1),r=this._imageEditor.insertPictureBlock(this._iterator,i);else if(Gl.n.get_instance().get_item(11)){S.ULS.shipAssertTag(7869444,307,Ga.ParagraphReader.isParagraphNode(this._iterator.get_currentNode())),this._picturePasteRequestStopwatch=this._stopwatchBuilder.makeAndStartStopwatch("WebServiceCall",t.PicturePasteRequestTime),S.ULS.sendTraceTag(20505094,322,50,String.format("ImagePasteRequest img width: {0}, height {1}",e.width,e.height));var o=Wa.y.createIpContextAtEndOfParagraph(this._iterator.get_currentNode());r=this._imageEditor.insertPictureInline(o,i)}this.aggregateImages(r,e)},t.prototype.onPasteCompletion=function(){this.get_numPicturesPasted()>0&&(this._desiredRevisionId=ai.l.create(),this._parentGraphSpace=this._results.get_item(0).node.getParentGraphSpace(),S.ULS.sendTraceTag(38122840,307,50,"Pasted pictures: {0}",this.get_numPicturesPasted()),this.get_maxPicturesExceeded()&&(S.ULS.sendTraceTag(38122841,307,15,"MaxPicturesExceeded in paste."),this.ShowMaxPicturesExceededDialog()),op.q.get_instance().uploadStarted(this._parentGraphSpace),this._parentGraphSpace.get_contentReplicator().forceOutbound(o.i(this,this.PreparePicturePasteRequests,"PreparePicturePasteRequests"),null,null))},t.prototype.setImageProperties=function(e){if(this.get_numPicturesPasted()>0)for(var t=e.getValueWithDefault(Boolean,os.j.isImageFromPaste,!1),n=e.getValueWithDefault(Boolean,Pl.k.isUploadingImageCanFailedEarly,!1),i=e.getValueWithDefault(Boolean,Pl.k.isImageInsertion,!1),r=e.getValueWithDefault(Number,ep.p.editContainerWidth,-1),o=e.getValueWithDefault(Boolean,is.b.isLayoutSizeSetByUser,!1),a=0;a<this._results.get_count();a++)this._results.get_item(a).blob&&(this._results.get_item(a).blob.properties.setValue(os.j.isImageFromPaste,t),this._results.get_item(a).blob.properties.setValue(Pl.k.isUploadingImageCanFailedEarly,n),this._results.get_item(a).blob.properties.setValue(Pl.k.isImageInsertion,i),this._results.get_item(a).blob.properties.setValue(ep.p.editContainerWidth,r),this._imageEditor.scaleImageWidthAndHeight(this._results.get_item(a).blob.properties,r)),Gl.n.get_instance().get_item(113)&&this._results.get_item(a).node&&this._results.get_item(a).node.get_properties().setValue(is.b.isLayoutSizeSetByUser,o)},t.prototype.onRenderAugmentation=function(e){},t.prototype.ScaleImageForWord=function(e){S.ULS.shipAssertTag(7869447,307,Gl.n.get_instance().get_item(59));var n=up.d.get_instance().navigateToWordSectionNode(this._iterator.get_currentINode());if(!n)return e;var i=np.j.twipsToPixels(t.get_WordSectionReader().getPageHeight(n)-t.get_WordSectionReader().getMarginBottom(n)-t.get_WordSectionReader().getMarginTop(n),1),r=np.j.twipsToPixels(t.get_WordSectionReader().getPageWidth(n)-t.get_WordSectionReader().getMarginLeft(n)-t.get_WordSectionReader().getMarginRight(n),0);if(S.ULS.shipAssertTag(7869449,307,i>=0),S.ULS.shipAssertTag(7869450,307,r>=0),e.height>i){var o=i/e.height;e.height=i,e.width=Math.floor(e.width*o)}if(e.width>r){o=r/e.width;e.width=r,e.height=Math.floor(e.height*o)}return e},t.prototype.ShowSingleNotificationError=function(){var e=Box4Intl.Box4Strings.l_PastedImageFailedWithInvalidUrl;this._lastNotificationBarEntry&&(this._lastNotificationBarEntry.get_message()===e||this._lastNotificationBarEntry.get_isShowing())||(this._lastNotificationBarEntry=this._notificationBar.createEntry(e,!1),this._notificationBar.addEntry(this._lastNotificationBarEntry))},t.prototype.GetBaseUrl=function(){if(this._imageStewardBridge&&this._imageStewardBridge.isCustomBaseUrlEnabled())return this._imageStewardBridge.getCustomBaseUrl();var e=new Sys.Net.WebRequest;e.set_url("PicturePaste.ashx");var t=e.getResolvedUrl();return t=Oe.n.addParameterValue(t,dp.h.fileId,this._parentGraphSpace.get_fileQuerySignature())},t.prototype.PreparePicturePasteRequests=function(e){var n=this.GetBaseUrl(),i=0;Gl.n.get_instance().get_item(11)?i=131073:Gl.n.get_instance().get_item(1)?i=393233:S.ULS.shipAssertTag(7869451,307,!1),n=Oe.n.addParameterValue(n,dp.h.cellId,this._parentGraphSpace.get_objectSpaceId().toString()),n=Oe.n.addParameterValue(n,dp.h.desiredRevisionId,this._desiredRevisionId.toString()),n=Oe.n.addParameterValue(n,dp.h.classId,i.toString()),this._parentGraphSpace.get_encryptionSessionString()&&(n=Oe.n.addParameterValue(n,dp.h.encryptionSessionString,this._parentGraphSpace.get_encryptionSessionString())),Gl.n.get_instance().get_item(11)&&(n=Oe.n.addParameterValue(n,dp.h.wordMode,"1"),n=Oe.n.addParameterValue(n,gp.a.imageType,"1"),n=pp.n.get_instance().addToStringUrl(n)),this._parentGraphSpace.get_contentReplicator()&&this._parentGraphSpace.get_contentReplicator().get_isUsingOneNoteContentSync()&&(n=Oe.n.addParameterValue(n,dp.h.blockOnSaving,"1"));for(var r,o=0,a=n,l=new Xg(ap),s=new Xg(Yg),u=new Xg(ap),c=new Xg(Yg),d="",g=0;g<this.get_numPicturesPasted();g++){S.ULS.shipAssertTag(7869452,307,!!this._imageSemanticArgs.get_item(g).src),S.ULS.shipAssertTag(7869453,307,""!==this._imageSemanticArgs.get_item(g).src),S.ULS.shipAssertTag(7869454,307,this._imageSemanticArgs.get_item(g).src.length<19922944);var p=ip.z.lockIdNil;Gl.n.get_instance().get_item(50)&&(p=this._results.get_item(g).node.getValueWithDefault(Number,ep.p.lockId,ip.z.lockIdNil)),this.UpdateImageWidthAndHeight(this._results.get_item(g).blob,this._imageSemanticArgs.get_item(g));var h=ap.construct(this._results.get_item(g).blob?this._results.get_item(g).blob.id.toString():this._results.get_item(g).node.get_id().toString(),this._imageSemanticArgs.get_item(g).src,this._imageSemanticArgs.get_item(g).alt,this._imageSemanticArgs.get_item(g).width,this._imageSemanticArgs.get_item(g).height,this._imageSemanticArgs.get_item(g).desc,p,this._results.get_item(g).imageAnchorId,!!this._results.get_item(g).blob&&this._results.get_item(g).blob.properties.getValueWithDefault(Boolean,os.j.isImageFromPaste,!1),this._results.get_item(g).blob?this._results.get_item(g).blob.properties.getValueWithDefault(Number,ep.p.editContainerWidth,-1):-1,Gl.n.get_instance().get_item(50)&&this._results.get_item(g).blob?this._results.get_item(g).blob.properties.getValueWithDefault(String,os.j.localizedPicture,Box4Intl.Box4Strings.l_Picture):"",!!this._results.get_item(g).node&&this._results.get_item(g).node.get_properties().getValueWithDefault(Boolean,is.b.isLayoutSizeSetByUser,!1));if(this._imageSemanticArgs.get_item(g).src.startsWith("data:")){u.add(h),c.add(this._results.get_item(g));var _=sp.construct(u.toArray(),!0),m=x.x.serialize(_);m.length>t.MaximumRequestSize?(S.ULS.shipAssertTag(7869456,307,u.get_count()>1),u.remove(h),c.remove(this._results.get_item(g)),r=this._requests.get_count()?new mt.h(this._desiredRevisionId,o).toString():this._parentGraphSpace.get_contentReplicator().get_lastReplicated().toString(),a=Oe.n.addParameterValue(a,dp.h.baseRevisionId,r),a=Oe.n.addParameterValue(a,dp.h.pasteSequenceNumber,o.toString()),this._requests.add(new rp(sp.construct(u.toArray(),!0),d,c,a)),o+=u.get_count(),(u=new Xg(ap)).add(h),(c=new Xg(Yg)).add(this._results.get_item(g))):d=m}else l.add(h),s.add(this._results.get_item(g))}if(u.get_count()){a=n,r=this._requests.get_count()?new mt.h(this._desiredRevisionId,o).toString():this._parentGraphSpace.get_contentReplicator().get_lastReplicated().toString(),a=Oe.n.addParameterValue(a,dp.h.baseRevisionId,r),a=Oe.n.addParameterValue(a,dp.h.pasteSequenceNumber,o.toString());var f=sp.construct(u.toArray(),!0);this._requests.add(new rp(f,x.x.serialize(f),c,a)),o+=u.get_count()}if(l.get_count()){a=n,r=this._requests.get_count()?new mt.h(this._desiredRevisionId,o).toString():this._parentGraphSpace.get_contentReplicator().get_lastReplicated().toString(),a=Oe.n.addParameterValue(a,dp.h.baseRevisionId,r),a=Oe.n.addParameterValue(a,dp.h.pasteSequenceNumber,o.toString());var y=sp.construct(l.toArray(),!1);this._requests.add(new rp(y,x.x.serialize(y),s,a))}this.SendPicturePasteRequest()},t.prototype.UpdateImageWidthAndHeight=function(e,t){if(e&&t){var n=np.j.muToPixels(pa.ImageReader.getImageWidth(e.properties),0),i=np.j.muToPixels(pa.ImageReader.getImageHeight(e.properties),1);n>0&&n<t.width&&(t.width=n,t.height=i)}},t.prototype.SendPicturePasteRequest=function(){L.AFrameworkApplication.theClientRequestManager.addRequest(this._requests.get_item(this._numRequestsSuccessfullySent).url,2,this._requests.get_item(this._numRequestsSuccessfullySent).requestSerialized,{},!1,2,o.i(this,this.PicturePasteRequestSucceeded,"PicturePasteRequestSucceeded"),o.i(this,this.PicturePasteRequestFailed,"PicturePasteRequestFailed"),null,void 0,void 0,void 0,void 0,"26"),t.NumberOfPasteRequest++},t.prototype.PicturePasteRequestSucceeded=function(e){var n,i=this;if(hp.j.tryDeserializeServerResponse(e.get_data().responseData,(0,g.m)((function(){return n}),(function(e){return n=e})))){var r=n.Responses[0];if(r.StatusCode)46!==r.StatusCode||this._requests.get_item(this._numRequestsSuccessfullySent).hasBeenRetried?(S.ULS.sendTraceTag(51212675,322,15,"Picture paste request failed with reason "+r.StatusCode),this.HandleFailure()):(this._requests.get_item(this._numRequestsSuccessfullySent).hasBeenRetried=!0,this.SendPicturePasteRequest());else{this._picturePasteRequestStopwatch&&(this._picturePasteRequestStopwatch.stop(),this._picturePasteRequestStopwatch=null),this._numRequestsSuccessfullySent++,this.get_UnsentRequestsRemain()&&this.SendPicturePasteRequest(),this._revisionBeforeReplication=this._parentGraphSpace.get_contentReplicator().get_lastReplicated();var a=new ge.c(2,1,t.ForceInboundDelay,(function(e){i._parentGraphSpace.get_contentReplicator().postProcessFDOUpload(o.i(i,i.ForceInboundSucceeded,"ForceInboundSucceeded"),null,null)}),124);this._taskManager.addTask(a)}}else{S.ULS.sendTraceTag(7869457,307,10,"PicturePasteRequestSucceeded received null or empty server response group");var l=new tp.o(e.get_data());this.PicturePasteRequestFailed(l)}},t.prototype.ForceInboundSucceeded=function(e){var n=this,i=!mt.h.areEqual(this._revisionBeforeReplication,this._parentGraphSpace.get_contentReplicator().get_lastReplicated());if(S.ULS.sendTraceTag(8246492,307,50,"Revision changed after ForceInbound: {0}",i),i)this.callBackOnPasteSucceeded();else{var r=new ge.c(2,1,t.ForceInboundDelay,(function(e){n._parentGraphSpace.get_contentReplicator().postProcessFDOUpload(null,null,null)}),125);this._taskManager.addTask(r),this.callBackOnRevisionChanged()}t.NumberOfPasteRequest--,L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.updateSaveStatusForHeader,2),op.q.get_instance().uploadCompleted(this._parentGraphSpace,0)},t.prototype.PicturePasteRequestFailed=function(e){S.ULS.sendTraceTag(51212676,322,15,"Picture paste request failed"),9===e.get_data().status||this._requests.get_item(this._numRequestsSuccessfullySent).hasBeenRetried?(op.q.get_instance().uploadCompleted(this._parentGraphSpace,127),this.ChangeOutstandingPlaceholdersToFailure(),this._picturePasteRequestStopwatch=null):(this._requests.get_item(this._numRequestsSuccessfullySent).hasBeenRetried=!0,this.SendPicturePasteRequest())},t.prototype.HandleFailure=function(){op.q.get_instance().uploadCompleted(this._parentGraphSpace,127),this.ChangeOutstandingPlaceholdersToFailure()},t.prototype.ChangeOutstandingPlaceholdersToFailure=function(){S.ULS.shipAssertTag(7869458,307,this.get_UnsentRequestsRemain());var e=new Ma.GraphTransaction(15);e.setFromNode(this._results.get_item(0).node);for(var t=this._numRequestsSuccessfullySent;t<this._requests.get_count();t++)for(var n=0;n<this._requests.get_item(t).insertPictureResults.get_count();n++)Gl.n.get_instance().get_item(11)?(this._imageEditor.setImageAltText(this._requests.get_item(t).insertPictureResults.get_item(n).blob.properties,Box4Intl.Box4Strings.l_PastedImageFailed),pa.ImageReader.setImageUploadState(this._requests.get_item(t).insertPictureResults.get_item(n).blob.properties,2)):this._requests.get_item(t).insertPictureResults.get_item(n).node&&this._requests.get_item(t).insertPictureResults.get_item(n).node.get_isConnected()&&(this._imageEditor.setImageAltText(this._requests.get_item(t).insertPictureResults.get_item(n).node.get_properties(),Box4Intl.Box4Strings.l_PastedImageFailed),pa.ImageReader.setImageUploadState(this._requests.get_item(t).insertPictureResults.get_item(n).node.get_properties(),2));e.dispose(),this._undoManager.clearUndoHistory(this._parentGraphSpace,!1),this.callBackOnPasteFailed()},t.prototype.ShowMaxPicturesExceededDialog=function(){var e=new Vn.StandardDialog;e.set_buttonsOption(0),e.showError(0,Box4Intl.Box4Strings.l_MaxPicturesExceededTitle,String.format(Box4Intl.Box4Strings.l_MaxPicturesExceededMessage,yi.App.maxImagesPerPaste),null,!0),L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.pastedTooManyPictures,2)},t.prototype.onInsertInlineImageWithContext=function(e,t){if(e.alt.length>Zg.maxAltTextLength){var n=Rn.l.isLowSurrogateCharAt(e.alt,Zg.maxAltTextLength)?Zg.maxAltTextLength-1:Zg.maxAltTextLength;e.alt=e.alt.substring(0,n)}var i,r=new Dl.DictionaryPropertySet;this._imageEditor.preparePlaceholderForImageUpload(r,e.width,e.height),i=this._imageEditor.insertPictureInline(t,r),e=this.ScaleImageForWord(e),this.aggregateImages(i,e)},t.prototype.callBackOnPasteFailed=function(){},t.prototype.callBackOnPasteSucceeded=function(){},t.prototype.callBackOnRevisionChanged=function(){},t.prototype.hasUnsavedData=function(){return!!t.NumberOfPasteRequest},t.get_WordSectionReader=function(){return cp.p.get_instance()},t.IsImageSrcLocalUrl=function(e){var t=new RegExp("file:.*AppData\\/Local\\/Temp|^cid:[0-9a-fA-F]+$");return!!e&&!!e.src&&t.test(e.src)},t.ForceInboundDelay=1e3,t.PicturePasteRequestTime="PicturePasteRequestTime",t.NumberOfPasteRequest=0,t.MaximumRequestSize=20971520,t}(Zg);(0,o.l)(_p,"7b42c786$Box4ImageSteward",Zg,[Kg.d]);var mp=function(){function e(){this._maxPicturesExceeded=!0}return e.prototype.onImage=function(e){},e.prototype.onFile=function(e){},e.prototype.onRenderAugmentation=function(e){},e.prototype.bindToOwnerSteward=function(e){},e.prototype.onPasteCompletion=function(){},e.prototype.setImageProperties=function(e){},e.prototype.get_picturePasteIsEnabled=function(){return!1},e.prototype.get_numPicturesPasted=function(){return 0},e.prototype.get_maxPicturesExceeded=function(){return this._maxPicturesExceeded},e.prototype.set_maxPicturesExceeded=function(e){return this._maxPicturesExceeded=e,e},e.prototype.get_maxPicturesReached=function(){return!1},e.prototype.get_desiredRevisionId=function(){return ai.l.get_nil()},e}();(0,o.l)(mp,"21e642f$TextOnlyBox4ImageSteward",null,[qg]);var fp=function(){function e(e,t,n,i,r,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1),this._imageEditor=null,this._taskManager=null,this._undoManager=null,this._imageStewardBridge=null,this._notificationBar=null,this._pastePictureFailedImprovementIsEnabled=!1,this._pastePictureFailedNotificationBarIsEnabled=!1,this._imageEditor=e,this._taskManager=t,this._undoManager=n,this._imageStewardBridge=i,this._notificationBar=r,this._pastePictureFailedImprovementIsEnabled=o,this._pastePictureFailedNotificationBarIsEnabled=a}return e.prototype.create=function(e,t){return 1===e?new mp:new _p(t,this._imageEditor,this._taskManager,this._undoManager,this._imageStewardBridge,this._notificationBar,this._pastePictureFailedImprovementIsEnabled,this._pastePictureFailedNotificationBarIsEnabled)},e}();(0,o.l)(fp,"39140572$Box4ImageStewardFactory",null,[pg]);var yp=n(2148),Cp=function(){function e(e){this._isPasteBrAsNewParagraphEnabled=!1,this._isPasteBrAsNewParagraphEnabled=e}return e.prototype.isPageBreak=function(e){var t=this;if(!e||!e.get_htmlElementInfoFromHierarchy()||e.get_htmlElementInfoFromHierarchy().get_count()<1)return!1;var n=[yp.e.cssClassPageBreakTextSpan,yp.e.cssClassPageBreakBlob];return!!this.GetClosestAncestorHtmlElementInfoMatchingCondition(e.get_htmlElementInfoFromHierarchy(),1,(function(e){return t.ContainsCssClasses(e,n)}))},e.prototype.isEOP=function(e){var t=this;return!(!e||!e.get_htmlElementInfoFromHierarchy()||e.get_htmlElementInfoFromHierarchy().get_count()<1)&&!!this.GetClosestAncestorHtmlElementInfoMatchingCondition(e.get_htmlElementInfoFromHierarchy(),1,(function(e){return t.ContainsCssClasses(e,[yp.e.eopClassName])}))},e.prototype.isInLineBreak=function(e){var t=this;return!(!e||!e.get_htmlElementInfoFromHierarchy()||e.get_htmlElementInfoFromHierarchy().get_count()<1)&&!!this.GetClosestAncestorHtmlElementInfoMatchingCondition(e.get_htmlElementInfoFromHierarchy(),2,(function(e){return t.ContainsCssClasses(e,[yp.e.lineBreakBlobClassName])}))},e.prototype.isParagraph=function(e){var t=this;return!(!e||!e.get_htmlElementInfoFromHierarchy()||e.get_htmlElementInfoFromHierarchy().get_count()<1)&&!!this.GetClosestAncestorHtmlElementInfoMatchingCondition(e.get_htmlElementInfoFromHierarchy(),1,(function(e){return t.ContainsCssClasses(e,[yp.e.paragraphClassName])}))},e.prototype.isFormatless=function(e){if(!e||!e.get_htmlElementInfoFromHierarchy())return!1;for(var t=e.get_htmlElementInfoFromHierarchy(),n=0;n<t.get_count();++n)if(!t.get_item(n)||t.get_item(n).get_attributesCount()>0)return!1;return!0},e.prototype.escapeTextOfParagraphEnd=function(e,t){return this.isEOP(t)||this.isInLineBreak(t)?"":e},e.prototype.get_isPasteBrAsNewParagraphEnabled=function(){return this._isPasteBrAsNewParagraphEnabled},e.prototype.GetClosestAncestorHtmlElementInfoMatchingCondition=function(e,t,n){if(e&&e.get_count()>0)for(var i=e.get_count()-1;i>=0;--i){if(n(e.get_item(i)))return e.get_item(i);if(e.get_count()-i>=t)return null}return null},e.prototype.ContainsCssClasses=function(e,t){var n=e&&e.get_htmlClass()?e.get_htmlClass().split(" "):null;if(!n)return!1;for(var i=0,r=t;i<r.length;i++){var o=r[i];if(Array.indexOf(n,o)>=0)return!0}return!1},e}();(0,o.l)(Cp,"c329d385$Box4PasteStewardUtils",null,[Ld]);var Sp=(0,o.y)("d71adf72$IWordConverter"),bp=n(1577),vp=n(7170),Tp=function(){return function(){this.UniqueListId=0,this.ListLevelMetadataForEachLevel=null,this.ListLevelMetadataForEachLevel=new Array(9)}}();(0,o.l)(Tp,"4462f4a9$FullListMetadata",null,[]);var Ap=function(){return function(){this.Level=0,this.WordListId=null,this.UniqueListId=0,this.OriginalNode=null,this.FakeListMarker=null,this.PasteFromRichClient=!1}}();(0,o.l)(Ap,"c585602f$ListItemMetadata",null,[]);var Ip=function(){return function(){this.TagName=null,this.MostRecentFakeListMarker=null,this.Ignore=!1,this.NumberOfItems=0,this.ListStyle=null,this.Level=0,this.ListItems=null,this.LevelText=null,this.Font=null,this.TagName="UL",this.MostRecentFakeListMarker=null,this.Ignore=!1,this.NumberOfItems=0,this.ListStyle="BulletListStyle1",this.ListItems=new Xg(Ap),this.LevelText="",this.Font=""}}();(0,o.l)(Ip,"8df869ac$ListLevelMetadata",null,[]);var wp=function(){return function(){this.ListsMetadata=null,this.CurrentUniqueListId=0,this.ListsMetadata={},this.CurrentUniqueListId=-1}}();(0,o.l)(wp,"4da51672$LevelLists",null,[]);var xp=function(){return function(e){this.Nodes=null,this.CurrentIndex=0,this.Lists=null,this.ListItems=null,this.CurrentListIdsByLevels=null,this.LastProcessedItem=null,this.Nodes=e,this.CurrentIndex=0,this.Lists={},this.ListItems=new Array(0),this.LastProcessedItem=null,this.CurrentListIdsByLevels=new Array(0),this.CurrentListIdsByLevels[0]=new wp}}();(0,o.l)(xp,"ad95585b$WordConverterArguments",null,[]);var Ep=n(7979),Fp=(0,o.y)("c33fdd19$IHtmlEventAcceptor"),Pp=function(){return function(){this.x=0,this.y=0,this.left=null,this.top=null}}();(0,o.l)(Pp,"78def4b2$AbsolutePosition",null,[]);var Dp=function(){function e(t,n,i,r){void 0===i&&(i=""),void 0===r&&(r=0),this.isValid=!1,this.htmlIdentifier=null,this.htmlElementType=null,this.htmlClass=null,this.attributesCount=0;var o=!1;e.isHTMLIdentifierValid(t)&&(o=!0,this.htmlIdentifier=t),e.isHtmlElementTypeValid(n)&&(this.htmlElementType=n),this.htmlClass=i,this.attributesCount=r,o&&this.get_htmlElementType()?this.isValid=!0:this.isValid=!1}return e.prototype.get_isValid=function(){return this.isValid},e.prototype.get_htmlIdentifier=function(){return this.htmlIdentifier},e.prototype.get_htmlElementType=function(){return this.htmlElementType},e.prototype.get_htmlClass=function(){return this.htmlClass},e.prototype.get_attributesCount=function(){return this.attributesCount},e.isHTMLIdentifierValid=function(e){return!e||-1===e.indexOf(" ")&&e.length>0},e.isHtmlElementTypeValid=function(e){return!!e&&(-1===e.indexOf(" ")&&e.length>0)},e}();(0,o.l)(Dp,"22b41cf1$HtmlElementInfo",null,[]);var Rp=function(){function e(t){this.next=null,o.m(this,e.$$(t)),this.data=o.c(o.f(this,"Box3.StackNode$1").TNode)}return e.$$=function(t){return o.o("Box3.StackNode$1",e,[{TNode:t}],null,[],{})},e}(),Mp=function(){function e(t){this._top=null,this._count=0,o.m(this,e.$$(t)),this._top=null,this._count=0}return e.prototype.get_count=function(){return this._count},e.prototype.get_isEmpty=function(){return!this._count||!this._top},e.prototype.push=function(e){var t=new Rp(o.f(this,"Box3.Stack$1").T);t.data=e,t.next=this._top,this._top=t,this._count++},e.prototype.peek=function(){return this.get_isEmpty()?null:this._top.data},e.prototype.pop=function(){if(this.get_isEmpty())return null;var e=this._top;return this._top=e.next,this._count--,e.data},e.prototype.clear=function(){this._top=null,this._count=0},e.prototype.toArray=function(){for(var e=new Array(this.get_count()),t=this._top,n=this.get_count()-1;n>=0&&t;n--)e[n]=t.data,t=t.next;return e},e.$$=function(t){return o.o("Box3.Stack$1",e,[{T:t}],null,[],{})},e}(),kp=function(){function e(e){this.normalizer=null,this._onCloseCallbacks=null,this._formattingStack=null,this._elementHasRegisteredCallbacks=!1,this.normalizer=e}return e.prototype.get_CurrentFormatting=function(){return this._formattingStack.peek()},e.prototype.reset=function(){this.normalizer.reset(),this._onCloseCallbacks=new Mp(Object),this._formattingStack=new Mp(Ep.q),this._formattingStack.push(this.normalizer.get_defaultFormatting()),this._elementHasRegisteredCallbacks=!1},e.prototype.onBeforeNewElement=function(){this._elementHasRegisteredCallbacks=!1},e.prototype.registerOnCloseCallback=function(e){this._elementHasRegisteredCallbacks||(this._onCloseCallbacks.push(null),this._elementHasRegisteredCallbacks=!0),this._onCloseCallbacks.push(e)},e.prototype.onClose=function(){for(;;){var e=this._onCloseCallbacks.pop();if(!e)break;e()}},e.prototype.setFormattingFromAttributes=function(e,t){return!1},e.prototype.notifyNormalizerOfCurrentFormatting=function(){return this.HandleSpecifiedFormatting((function(){return!0}))},e.prototype.HandleSpecifiedFormatting=function(e){var t=this.get_CurrentFormatting().clone();return!!e(t)&&(this._formattingStack.push(t),this.normalizer.onFormattingChange(t),this.registerOnCloseCallback(o.i(this,this.OnFormattingEnd,"OnFormattingEnd")),!0)},e.prototype.handleCommonAttributes=function(e){var t=this;return e.style&&this.HandleSpecifiedFormatting((function(n){return t.setFormattingFromAttributes(n,e)}))?1:2},e.prototype.OnFormattingEnd=function(){this._formattingStack.pop(),this.normalizer.onFormattingChange(this.get_CurrentFormatting())},e.prototype.onText=function(e,t){},e.prototype.onAOpen=function(e){return 2},e.prototype.onAbbrOpen=function(e){return 2},e.prototype.onAcronymOpen=function(e){return 2},e.prototype.onAddressOpen=function(e){return 2},e.prototype.onAppletOpen=function(e){return 3},e.prototype.onAreaTag=function(e){},e.prototype.onBOpen=function(e){return 2},e.prototype.onBaseTag=function(e){},e.prototype.onBasefontTag=function(e){},e.prototype.onBdoOpen=function(e){return 2},e.prototype.onBigOpen=function(e){return 2},e.prototype.onBlockquoteOpen=function(e){return 2},e.prototype.onBodyOpen=function(e){return 2},e.prototype.onBrTag=function(e){},e.prototype.onButtonOpen=function(e){return 2},e.prototype.onCaptionOpen=function(e){return 2},e.prototype.onCenterOpen=function(e){return 2},e.prototype.onCiteOpen=function(e){return 2},e.prototype.onCodeOpen=function(e){return 2},e.prototype.onColTag=function(e){},e.prototype.onColgroupOpen=function(e){return 2},e.prototype.onDdOpen=function(e){return 2},e.prototype.onDelOpen=function(e){return 2},e.prototype.onDfnOpen=function(e){return 2},e.prototype.onDirOpen=function(e){return 2},e.prototype.onDivOpen=function(e){return 2},e.prototype.onDlOpen=function(e){return 2},e.prototype.onDtOpen=function(e){return 2},e.prototype.onEmOpen=function(e){return 2},e.prototype.onFieldsetOpen=function(e){return 2},e.prototype.onFontOpen=function(e){return 2},e.prototype.onFormOpen=function(e){return 2},e.prototype.onFrameTag=function(e){},e.prototype.onFramesetOpen=function(e){return 2},e.prototype.onH1Open=function(e){return 2},e.prototype.onH2Open=function(e){return 2},e.prototype.onH3Open=function(e){return 2},e.prototype.onH4Open=function(e){return 2},e.prototype.onH5Open=function(e){return 2},e.prototype.onH6Open=function(e){return 2},e.prototype.onHeadOpen=function(e){return 3},e.prototype.onHrTag=function(e){},e.prototype.onHtmlOpen=function(e){return 2},e.prototype.onIOpen=function(e){return 2},e.prototype.onIframeOpen=function(e){return 3},e.prototype.onImgTag=function(e){},e.prototype.onInputTag=function(e){},e.prototype.onInsOpen=function(e){return 2},e.prototype.onIsindexOpen=function(e){return 3},e.prototype.onKbdOpen=function(e){return 2},e.prototype.onLabelOpen=function(e){return 2},e.prototype.onLegendOpen=function(e){return 2},e.prototype.onLiOpen=function(e){return 2},e.prototype.onLinkTag=function(e){},e.prototype.onMapOpen=function(e){return 3},e.prototype.onMathOpen=function(e){return 2},e.prototype.onMenuOpen=function(e){return 2},e.prototype.onMetaTag=function(e){},e.prototype.onNoframesOpen=function(e){return 2},e.prototype.onNoscriptOpen=function(e){return 2},e.prototype.onObjectOpen=function(e){return 3},e.prototype.onOlOpen=function(e){return 2},e.prototype.onOptgroupOpen=function(e){return 2},e.prototype.onOptionOpen=function(e){return 2},e.prototype.onPOpen=function(e){return 2},e.prototype.onParamTag=function(e){},e.prototype.onPreOpen=function(e){return 2},e.prototype.onQOpen=function(e){return 2},e.prototype.onSOpen=function(e){return 2},e.prototype.onSampOpen=function(e){return 2},e.prototype.onScriptOpen=function(e){return 3},e.prototype.onSelectOpen=function(e){return 2},e.prototype.onSmallOpen=function(e){return 2},e.prototype.onSpanOpen=function(e){return 2},e.prototype.onStrikeOpen=function(e){return 2},e.prototype.onStrongOpen=function(e){return 2},e.prototype.onStyleOpen=function(e){return 3},e.prototype.onSubOpen=function(e){return 2},e.prototype.onSupOpen=function(e){return 2},e.prototype.onTableOpen=function(e){return 2},e.prototype.onTbodyOpen=function(e){return 2},e.prototype.onTdOpen=function(e){return 2},e.prototype.onTextareaOpen=function(e){return 2},e.prototype.onTfootOpen=function(e){return 2},e.prototype.onThOpen=function(e){return 2},e.prototype.onTheadOpen=function(e){return 2},e.prototype.onTitleOpen=function(e){return 3},e.prototype.onTrOpen=function(e){return 2},e.prototype.onTtOpen=function(e){return 2},e.prototype.onUOpen=function(e){return 2},e.prototype.onUlOpen=function(e){return 2},e.prototype.onVarOpen=function(e){return 2},e.prototype.onUnknownOpen=function(e){return 2},e.getPixelSize=function(e){if(e&&-1!==e.indexOf("px")){var t=parseInt(Rn.l.substring(e,0,e.indexOf("px")));if(!isNaN(t))return t}return 0},e.getSizeInPoints=function(e){if(!e||""===e)return-1;var t=Rn.l.toLower(e);if(-1!==t.indexOf("pt")){var n=parseFloat(Rn.l.substring(e,0,t.indexOf("pt")));if(!isNaN(n))return n}else if(-1!==t.indexOf("px")){n=parseFloat(Rn.l.substring(e,0,t.indexOf("px")));if(!isNaN(n))return 3*n/4}return-1},e.getPositionInPixel=function(t){return t&&""!==t?e.getPixelSize(t):null},e.parseGlobalAttributes=function(t){var n=null,i=null,r=null,o=null;return t&&t.get_domElement()&&(n=e.getField(t.get_domElement(),"id"),i=e.getField(t.get_domElement(),"lang"),r=t.get_domElement().tagName,t.get_applyAbsolutePosition()&&(o=(0,U.m)(new Pp,{x:e.getPixelSize(t.get_domElement().style.left),y:e.getPixelSize(t.get_domElement().style.top),left:e.getPositionInPixel(t.get_domElement().style.left),top:e.getPositionInPixel(t.get_domElement().style.top)})),void 0===n&&(n=""),void 0===i&&(i="")),new Qg(new Dp(n,r),t.get_htmlElementInfoFromHierarchy(),null,i,o)},e.getField=function(e,t){return e[t]},e}();(0,o.l)(kp,"b70fe79e$AHtmlTranslator",null,[Fp]);var Np=n(4699),Lp=function(e){function t(t,n,i,r,o,a){void 0===r&&(r=0),void 0===o&&(o=0),void 0===a&&(a=null);var l=e.call(this,a?a.get_ownerHtmlElementInfo():null,a?a.get_htmlElementInfoFromHierarchy():null,a?a.ownerNoteTagInfo:null,a?a.get_cultureName():null,a?a.absolutePosition:null)||this;return l.dataRenderSrc=null,l.dataRenderMethod=null,l.dataRenderFallback=null,l.width=0,l.height=0,l.dataRenderSrc=t,l.dataRenderMethod=n,l.dataRenderFallback=i,l.width=r,l.height=o,l}return(0,v.t)(t,e),t}(Qg);(0,o.l)(Lp,"461c080d$AugmentationSemanticArgs",Qg,[]);var Bp=function(){return function(){this.color=null,this.stop=null}}();(0,o.l)(Bp,"87f991db$ColorStopPair",null,[]);var Op=function(){function e(t,n,i){this.fromAttribute=!1,o.m(this,e.$$(t)),this.Value=o.c(o.f(this,"Box3.DefaultHtmlTranslatorHelper.ElementValueWrapper$1").T),this.Value=n,this.fromAttribute=i}return e.prototype.get_IsFromStyle=function(){return!this.fromAttribute},e.prototype.get_IsFromAttribute=function(){return this.fromAttribute},e.$$=function(t){return o.o("Box3.DefaultHtmlTranslatorHelper.ElementValueWrapper$1",e,[{T:t}],null,[],{})},e}(),Up=function(e){function t(t,n,i){var r=e.call(this,Number,t,n)||this;return r.IsRelativeDimension=!1,r.IsRelativeDimension=i,r}return(0,v.t)(t,e),t}(Op);(0,o.l)(Up,"e2e857b1$DimensionWrapper",Op.$$(Number),[]);var Hp=function(){return function(e,t,n,i,r,o,a,l,s,u,c,d){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=""),void 0===o&&(o=""),void 0===a&&(a=""),void 0===l&&(l=""),void 0===s&&(s="0pt"),void 0===u&&(u="0pt"),void 0===c&&(c="0pt"),void 0===d&&(d="0pt"),this.borderTopStyle=0,this.borderRightStyle=0,this.borderBottomStyle=0,this.borderLeftStyle=0,this.borderTopWidth=null,this.borderRightWidth=null,this.borderBottomWidth=null,this.borderLeftWidth=null,this.borderTopColor=null,this.borderRightColor=null,this.borderBottomColor=null,this.borderLeftColor=null,this.borderTopStyle=e,this.borderRightStyle=t,this.borderBottomStyle=n,this.borderLeftStyle=i,this.borderTopColor=r,this.borderRightColor=o,this.borderBottomColor=a,this.borderLeftColor=l,this.borderTopWidth=s,this.borderRightWidth=u,this.borderBottomWidth=c,this.borderLeftWidth=d}}();(0,o.l)(Hp,"92015389$TableCellBorderProperties",null,[]);var Gp=function(){return function(e,t,n,i){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=""),void 0===i&&(i=""),this.cellMarginTop=null,this.cellMarginRight=null,this.cellMarginBottom=null,this.cellMarginLeft=null,this.cellMarginTop=e,this.cellMarginRight=t,this.cellMarginBottom=n,this.cellMarginLeft=i}}();(0,o.l)(Gp,"4466123b$TableCellMarginProperties",null,[]);var Wp=function(){function e(){}return e.get_HtmlColorNamesRgb=function(){return e._htmlColorNamesRgb},e.get_TableCellVerticalAlignTypes=function(){return e._tableCellVerticalAlignTypes},e.get_TableCellBorderStyleTypes=function(){return e._tableCellBorderStyleTypes},e.GetValueFromStyleOrAttribute=function(t,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o=e.GetValueFromStyles(t,n),a=!1;return o||(a=!!(o=e.GetValueFromAttributes.apply(null,[t].concat(i)))),new Op(String,o,a)},e.GetValueFromStyles=function(e,t){for(var n=0,i=t;n<i.length;n++){var r=i[n];if(null!=r&&""!==r)return r.trim()}return null},e.GetValueFromAttributes=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var i=0,r=t;i<r.length;i++){var o=r[i],a=e.getAttribute(o);if(null!=a){var l=a+"";if(null!=l&&""!==l)return l.trim()}}return null},e.GetPixelsFromValueString=function(e,t,n){var i;if(i=parseFloat(t),isNaN(i))return 0;switch(e){case"px":return Math.round(i);case"pt":return Math.round(np.j.pointsToPixels(i,n,!1));case"in":return Math.round(np.j.inchesToPixels(i,n,!1));case"cm":return Math.round(np.j.inchesToPixels(Vu.r.centimetersToInches(i),n,!1));case"mm":return Math.round(np.j.inchesToPixels(Vu.r.centimetersToInches(.1*i),n,!1));default:return i}},e.RetrieveRenderDimensionInfoInPixels=function(t,n,i){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var a=e.GetValueFromStyleOrAttribute.apply(null,[t,i].concat(r)),l=0,s=!1;if(a.Value){var u=null,c=null;if(s=a.Value.endsWith("%"))u="%",c=Rn.l.substring(a.Value,0,a.Value.length-1);else if(a.get_IsFromAttribute())u="px",c=a.Value;else{u=a.Value.substr(a.Value.length-2);var d=parseFloat(u);isNaN(d)?c=Rn.l.substring(a.Value,0,a.Value.length-2):(u="px",c=a.Value)}l=e.GetPixelsFromValueString(u,c,0)}return new Up(l,a.get_IsFromAttribute(),s)},e.GetWidth=function(t){return e.RetrieveRenderDimensionInfoInPixels(t,0,[t.style.width],"width","WIDTH","Width")},e.GetHeight=function(t){return e.RetrieveRenderDimensionInfoInPixels(t,1,[t.style.height],"height","HEIGHT","Height")},e.GetMarginLeft=function(t){return e.RetrieveRenderDimensionInfoInPixels(t,0,[t.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")},e.GetMarginRight=function(t){return e.RetrieveRenderDimensionInfoInPixels(t,0,[t.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")},e.GetVerticalAlign=function(t){var n=e.GetValueFromStyleOrAttribute(t,[t.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return n.Value&&n.Value in e.get_TableCellVerticalAlignTypes()&&void 0!==e.get_TableCellVerticalAlignTypes()[n.Value]&&null!==e.get_TableCellVerticalAlignTypes()[n.Value]?e.get_TableCellVerticalAlignTypes()[n.Value]:0},e.IsTableCellBordersCollpased=function(t){var n=e.GetValueFromStyles(t,[t.style.borderCollapse]);return!(!n||null==n||"collapse"!==n&&"COLLAPSE"!==n&&"Collapse"!==n)},e.GetBackground=function(t){return e.GetValueFromStyleOrAttribute(t,[t.style.backgroundColor,t.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").Value},e.ConvertShorthandHexToHexStringColor=function(e){var t=Rn.l.substring(e,0,1),n=Rn.l.substring(e,1,2),i=Rn.l.substring(e,2,3);return t+t+n+n+i+i},e.convertColorValueToRgb=function(t){var n="";if(!t||""===t)return n;if((n=t.trim()).startsWith("rgb")){var i=(n=Rn.l.substring(n,n.indexOf("(")+1,n.length-1)).split(",");if(3!==i.length)return"";n="";for(var r=0;r<i.length;r++){var o=parseInt(i[r]);if(isNaN(o)||o<0||o>255)return"";var a=o.toString(16);1===a.length&&(a="0"+a),n+=a}return Rn.l.toUpper(n)}return e.get_HtmlColorNamesRgb()[Rn.l.toLower(n)]?e.get_HtmlColorNamesRgb()[Rn.l.toLower(n)]:(n.startsWith("#")&&(n=Rn.l.substring(n,1,n.length)),isNaN(parseInt(n,16))?"":(3===n.length&&(n=e.ConvertShorthandHexToHexStringColor(n)),6!==n.length?"":n))},e.parseMsoTabCount=function(e){var t=e.indexOf("mso-tab-count");if(-1===t)return 0;for(var n=new RegExp("([\\d])"),i="",r=t+"mso-tab-count".length+1;r<e.length;r++){var o=e.charAt(r).toString();if(!n.test(o))break;i+=o}var a=0;return""!==i&&(a=parseInt(i)),a},e.HandleCommonTableFormattingProperties=function(t,n){var i=e.GetBackground(t);i&&""!==i&&n.HandleSpecifiedFormatting((function(t){return t.setCellShadingColor(e.convertColorValueToRgb(i))}))},e.GetCellBorders=function(t){var n=t.style;if(!n)return null;var i=e.get_TableCellBorderStyleTypes()[n.borderTopStyle],r=e.convertColorValueToRgb(n.borderTopColor),o=n.borderTopWidth,a=e.get_TableCellBorderStyleTypes()[n.borderRightStyle],l=e.convertColorValueToRgb(n.borderRightColor),s=n.borderRightWidth,u=e.get_TableCellBorderStyleTypes()[n.borderBottomStyle],c=e.convertColorValueToRgb(n.borderBottomColor),d=n.borderBottomWidth,g=e.get_TableCellBorderStyleTypes()[n.borderLeftStyle],p=e.convertColorValueToRgb(n.borderLeftColor),h=n.borderLeftWidth;return new Hp(i,a,u,g,r,l,c,p,o,s,d,h)},e.GetCellInternalMargins=function(e){var t,n=e.firstChild;return(t=n&&n.className&&-1!==n.className.indexOf("TableCellContent")?e.firstChild.style:e.style)?new Gp(t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft):null},e._htmlColorNamesRgb=P.j.toDictionary("aliceblue","F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood","DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B","darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo","4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00","limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500","orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD","slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen","9ACD32"),e._tableCellVerticalAlignTypes=P.j.toDictionary("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3),e._tableCellBorderStyleTypes=P.j.toDictionary("",0,"initial",3,"inherit",11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2),e}();(0,o.l)(Wp,"13fb7292$DefaultHtmlTranslatorHelper",null,[]);var Vp=function(){function e(){this.direction=null,this.colorStops=new Xg(Bp)}return e.prototype.hasDirection=function(){return!!this.direction&&this.direction.length>0},e}();(0,o.l)(Vp,"f2c2384f$LinearGradient",null,[]);var $p=function(){return function(){this.isCopiedFromSameApp=!1}}();(0,o.l)($p,"8f4bea40$HtmlTranslatorContext",null,[]);var zp=function(){function e(e,t,n,i,r,o,a,l,s,u,c,d,g,p,h,_,m,f,y,C,S,b,v,T){void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===a&&(a=!0),void 0===l&&(l=!1),void 0===s&&(s=!0),void 0===u&&(u=!0),void 0===c&&(c=!0),void 0===d&&(d=!1),void 0===g&&(g=!1),void 0===p&&(p=!1),void 0===h&&(h=!1),void 0===_&&(_=!1),void 0===m&&(m=!1),void 0===f&&(f=null),void 0===y&&(y=null),void 0===C&&(C=null),void 0===S&&(S=null),void 0===b&&(b=null),void 0===v&&(v=null),void 0===T&&(T=null),this._pasteListImprovementsEnabled=!1,this._pasteTableImprovementsEnabled=!1,this._pasteComplexTablesImprovementsEnabled=!1,this._pasteTableCellMarginImprovementsEnabled=!1,this._shouldGetListLevelForEachListItem=!1,this._shouldGetFontSizeStyle=!1,this._shouldGetBackgroundColorStyle=!1,this._shouldGetBackgroundColorStyleFromImage=!1,this._shouldGetColorStyle=!1,this._shouldGetFontFamilyStyle=!1,this._shouldGetCapsStyle=!1,this._shouldGetPasteStyleId=!1,this._inlineTabInsertionEnabled=!1,this._shouldGetParagraphProperties=null,this._shouldGetThemeAttributes=null,this._shouldGetTextIndentStyle=null,this._shouldGetMarginLeftStyle=null,this._shouldGetLineHeightStyle=null,this._shouldGetTextAlignStyle=null,this._shouldGetTextSuperscriptSubscriptStyle=null,this.$$pf_ShouldGetThemeMarginAndIndentAttributes=!1,this.$$pf_ShouldSkipAppendText=!1,this.$$pf_ShouldGetThemeFontFamily=!1,this.$$pf_SupportPasteCloudFont=!1,this.isCopiedFromSameApp=!1,this._pasteListImprovementsEnabled=e,this._pasteTableImprovementsEnabled=t,this._pasteComplexTablesImprovementsEnabled=n,this._pasteTableCellMarginImprovementsEnabled=i,this._shouldGetListLevelForEachListItem=r,this._shouldGetFontSizeStyle=o,this._shouldGetBackgroundColorStyle=a,this._shouldGetBackgroundColorStyleFromImage=l,this._shouldGetColorStyle=s,this._shouldGetFontFamilyStyle=u,this._shouldGetCapsStyle=c,this.set_shouldGetThemeMarginAndIndentAttributes(d),this.set_shouldSkipAppendText(g),this.set_shouldGetThemeFontFamily(p),this.set_supportPasteCloudFont(h),this._shouldGetPasteStyleId=_,this._inlineTabInsertionEnabled=m,this._shouldGetParagraphProperties=f,this._shouldGetThemeAttributes=y,this._shouldGetLineHeightStyle=b,this._shouldGetTextIndentStyle=C,this._shouldGetMarginLeftStyle=S,this._shouldGetTextAlignStyle=v,this._shouldGetTextSuperscriptSubscriptStyle=T}return e.prototype.get_pasteListImprovementsEnabled=function(){return this._pasteListImprovementsEnabled},e.prototype.get_pasteTableImprovementsEnabled=function(){return this._pasteTableImprovementsEnabled},e.prototype.get_pasteComplexTableImprovementsEnabled=function(){return this._pasteComplexTablesImprovementsEnabled},e.prototype.get_pasteTableCellMarginImprovementsEnabled=function(){return this._pasteTableCellMarginImprovementsEnabled},e.prototype.get_shouldGetListLevelForEachListItem=function(){return this._shouldGetListLevelForEachListItem},e.prototype.get_shouldGetFontSizeStyle=function(){return this._shouldGetFontSizeStyle},e.prototype.get_shouldGetBackgroundColorStyle=function(){return this._shouldGetBackgroundColorStyle},e.prototype.get_shouldGetBackgroundColorStyleFromImage=function(){return this._shouldGetBackgroundColorStyleFromImage},e.prototype.get_shouldGetColorStyle=function(){return this._shouldGetColorStyle},e.prototype.get_shouldGetFontFamilyStyle=function(){return this._shouldGetFontFamilyStyle},e.prototype.get_shouldGetCapsStyle=function(){return this._shouldGetCapsStyle},e.prototype.get_shouldGetPasteStyleId=function(){return this._shouldGetPasteStyleId},e.prototype.get_inlineTabInsertionEnabled=function(){return this._inlineTabInsertionEnabled},e.prototype.get_shouldGetThemeMarginAndIndentAttributes=function(){return this.$$pf_ShouldGetThemeMarginAndIndentAttributes},e.prototype.set_shouldGetThemeMarginAndIndentAttributes=function(e){return this.$$pf_ShouldGetThemeMarginAndIndentAttributes=e,e},e.prototype.get_shouldSkipAppendText=function(){return this.$$pf_ShouldSkipAppendText},e.prototype.set_shouldSkipAppendText=function(e){return this.$$pf_ShouldSkipAppendText=e,e},e.prototype.get_shouldGetThemeFontFamily=function(){return this.$$pf_ShouldGetThemeFontFamily},e.prototype.set_shouldGetThemeFontFamily=function(e){return this.$$pf_ShouldGetThemeFontFamily=e,e},e.prototype.get_supportPasteCloudFont=function(){return this.$$pf_SupportPasteCloudFont},e.prototype.set_supportPasteCloudFont=function(e){return this.$$pf_SupportPasteCloudFont=e,e},e.prototype.get_shouldGetParagraphProperties=function(){return this._shouldGetParagraphProperties||o.i(this,this.ReturnFalse,"ReturnFalse")},e.prototype.get_shouldGetThemeAttributes=function(){return this._shouldGetThemeAttributes||o.i(this,this.ReturnFalse,"ReturnFalse")},e.prototype.get_shouldGetTextIndentStyle=function(){return this._shouldGetTextIndentStyle||o.i(this,this.ReturnTrue,"ReturnTrue")},e.prototype.get_shouldGetMarginLeftStyle=function(){return this._shouldGetMarginLeftStyle||o.i(this,this.ReturnTrue,"ReturnTrue")},e.prototype.get_shouldGetLineHeightStyle=function(){return this._shouldGetLineHeightStyle||o.i(this,this.ReturnFalse,"ReturnFalse")},e.prototype.get_shouldGetTextAlignStyle=function(){return this._shouldGetTextAlignStyle||o.i(this,this.ReturnTrue,"ReturnTrue")},e.prototype.get_shouldGetTextSuperscriptSubscriptStyle=function(){return this._shouldGetTextSuperscriptSubscriptStyle||o.i(this,this.ReturnFalse,"ReturnFalse")},e.prototype.ReturnTrue=function(e){return!0},e.prototype.ReturnFalse=function(e){return!1},e}();(0,o.l)(zp,"4241689a$HtmlTranslatorSettings",null,[mg]);var Kp=function(){return function(e,t){this.spaceBefore=0,this.spaceAfter=0,this.spaceBefore=e,this.spaceAfter=t}}();(0,o.l)(Kp,"15e74d7c$IndentationProperties",null,[]);var qp=function(e){function t(t,n,i,r,o,a,l,s,u,c,d){void 0===r&&(r=0),void 0===o&&(o=-1),void 0===a&&(a=!1),void 0===l&&(l=!1),void 0===s&&(s=""),void 0===u&&(u=""),void 0===c&&(c=null),void 0===d&&(d=-1);var g=e.call(this,i?i.get_ownerHtmlElementInfo():null,i?i.get_htmlElementInfoFromHierarchy():null,i?i.ownerNoteTagInfo:null,i?i.get_cultureName():null,i?i.absolutePosition:null)||this;return g._originalListStyle=0,g._listStyleOverride=0,g._currentNumber=0,g._useCurrentNumberAsOffsetFromStart=!1,g._startNumber=0,g._listLevel=0,g._listId=0,g._pasteFromRichClient=!1,g._externalPasteImprovementsEnabled=!1,g._levelText=null,g._font=null,g._charCodes=null,g._buAutoNum=0,g._isAutoNumber=!1,g._originalListStyle=t,g._listStyleOverride=0,g._startNumber=n,g._isAutoNumber=1===n&&-1===o&&!g._externalPasteImprovementsEnabled,g._listId=r,g._listLevel=o,g._pasteFromRichClient=a,g._externalPasteImprovementsEnabled=l,g._levelText=s,g._font=u,g._charCodes=c,g._buAutoNum=d,g._currentNumber=-1,g._useCurrentNumberAsOffsetFromStart=!0,g}return(0,v.t)(t,e),t.prototype.get_listStyleType=function(){return this.get_isListItemStyleSpecified()?this._listStyleOverride:this._originalListStyle},t.prototype.get_isListStyleSpecified=function(){return 2!==this._originalListStyle&&6!==this._originalListStyle},t.prototype.get_isListItemStyleSpecified=function(){return!!this._listStyleOverride},t.prototype.get_startNumber=function(){return this._startNumber},t.prototype.get_listLevel=function(){return this._listLevel},t.prototype.set_listLevel=function(e){return this._listLevel=e,e},t.prototype.get_listId=function(){return this._listId},t.prototype.set_listId=function(e){return this._listId=e,e},t.prototype.get_pasteFromRichClient=function(){return this._pasteFromRichClient},t.prototype.set_pasteFromRichClient=function(e){return this._pasteFromRichClient=e,e},t.prototype.get_externalPasteImprovementsEnabled=function(){return this._externalPasteImprovementsEnabled},t.prototype.set_externalPasteImprovementsEnabled=function(e){return this._externalPasteImprovementsEnabled=e,e},t.prototype.get_levelText=function(){return this._levelText},t.prototype.set_levelText=function(e){return this._levelText=e,e},t.prototype.get_font=function(){return this._font},t.prototype.set_font=function(e){return this._font=e,e},t.prototype.get_charCodes=function(){return this._charCodes},t.prototype.set_charCodes=function(e){return this._charCodes=e,e},t.prototype.get_buAutoNum=function(){return this._buAutoNum},t.prototype.set_buAutoNum=function(e){return this._buAutoNum=e,e},t.prototype.get_isListNumbered=function(){return this.get_listStyleType()>=6},t.prototype.get_isAutoNumber=function(){return this._isAutoNumber},t.prototype.get_currentNumber=function(){return this._externalPasteImprovementsEnabled,this._useCurrentNumberAsOffsetFromStart?this._startNumber+this._currentNumber:this._currentNumber},t.prototype.Clone=function(){var e=new t(this._originalListStyle,this._startNumber,new Qg(this.get_ownerHtmlElementInfo(),this.get_htmlElementInfoFromHierarchy(),this.ownerNoteTagInfo,this.get_cultureName(),this.absolutePosition),this._listId,this._listLevel,this._pasteFromRichClient,this._externalPasteImprovementsEnabled);return e._listStyleOverride=this._listStyleOverride,e._isAutoNumber=this._isAutoNumber,e._currentNumber=this._currentNumber,e._useCurrentNumberAsOffsetFromStart=this._useCurrentNumberAsOffsetFromStart,e._levelText=this._levelText,e._font=this._font,e._charCodes=this._charCodes,e._buAutoNum=this._buAutoNum,e},t.prototype.ApplyListItemInfo=function(e,t,n){this._listStyleOverride=e,t>0?(this._isAutoNumber=!1,this._currentNumber=t,this._useCurrentNumberAsOffsetFromStart=!1):(this._currentNumber++,this._isAutoNumber=!n)},t.prototype.resetListStartNumber=function(e){this._startNumber=e},t}(Qg);(0,o.l)(qp,"39675833$ListSemanticArgs",Qg,[]);var jp=function(e){function t(t,n,i,r,o,a,l,s,u,c,d,g){void 0===o&&(o=null),void 0===a&&(a=0),void 0===l&&(l=null),void 0===s&&(s=null),void 0===u&&(u=!1),void 0===c&&(c=!1),void 0===d&&(d=69905),void 0===g&&(g=null);var p=e.call(this,g?g.get_ownerHtmlElementInfo():null,g?g.get_htmlElementInfoFromHierarchy():null,g?g.ownerNoteTagInfo:null,g?g.get_cultureName():null,g?g.absolutePosition:null)||this;return p.colSpan=0,p.rowSpan=0,p.width=0,p.isSkipCell=!1,p.height=0,p.isRelativeWidth=!1,p.shadingColor=null,p.verticalAlignment=0,p.tableCellBorderProperties=null,p.cellLook=0,p.tableCellMarginProperties=null,p.colSpan=t,p.rowSpan=n,p.width=i,p.isSkipCell=c,p.height=r,p.isRelativeWidth=u,p.shadingColor=o,p.verticalAlignment=a,p.tableCellBorderProperties=l,p.tableCellMarginProperties=s,p.cellLook=d,p}return(0,v.t)(t,e),t}(Qg);(0,o.l)(jp,"fb2a0b29$TableCellSemanticArgs",Qg,[]);var Qp=function(e){function t(t,n){void 0===n&&(n=null);var i=e.call(this,n?n.get_ownerHtmlElementInfo():null,n?n.get_htmlElementInfoFromHierarchy():null,n?n.ownerNoteTagInfo:null,n?n.get_cultureName():null,n?n.absolutePosition:null)||this;return i.height=0,i.height=t,i}return(0,v.t)(t,e),t}(Qg);(0,o.l)(Qp,"52e6bc65$TableRowSemanticArgs",Qg,[]);var Jp,Xp=function(e){function t(t,n,i,r,o,a,l,s,u,c,d,g){void 0===c&&(c=null),void 0===d&&(d=-1),void 0===g&&(g=null);var p=e.call(this,g?g.get_ownerHtmlElementInfo():null,g?g.get_htmlElementInfoFromHierarchy():null,g?g.ownerNoteTagInfo:null,g?g.get_cultureName():null,g?g.absolutePosition:null)||this;if(p.rowCount=0,p.colCount=0,p.width=0,p.isRelativeWidth=!1,p.colWidths=null,p.isBorderHidden=!1,p.isBorderCollapsed=!1,p.tableBorderProperties=null,p.styleId=null,p.tableLook=0,p.indentationProperties=null,p.rowCount=t,p.colCount=n,p.width=i,o){p.colWidths=new Array(o.length);for(var h=0;h<o.length;++h)p.colWidths[h]=o[h]}return p.isBorderHidden=a,p.tableBorderProperties=s,p.isBorderCollapsed=l,p.isRelativeWidth=r,p.indentationProperties=u,p.styleId=c,p.tableLook=d,p}return(0,v.t)(t,e),t}(Qg);(0,o.l)(Xp,"f6dce8ef$TableSemanticArgs",Qg,[]);var Yp=function(e){function t(t,n,i,r){void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null);var o=e.call(this,t)||this;return o._settings=null,o._context=null,o._listUsageData=null,o._listInfoStack=null,o._listStyleTypes=P.j.toDictionary("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11),o._settings=n||new zp,o._context=i||new $p,o._listUsageData=r,o}return(0,v.t)(t,e),t.prototype.get_listStyleTypes=function(){return this._listStyleTypes},t.prototype.getListStyleTypeFromElement=function(e,n){var i,r=e.style?e.style.listStyleType:"";if(r&&""!==r&&(i=this.get_listStyleTypes()[Rn.l.toLower(r)]))return i;var o=kp.getField(e,"type");if(o&&""!==o&&(i=this.get_listStyleTypes()[o]))return i;if(this._settings.get_pasteListImprovementsEnabled()){var a=e.tagName.toLowerCase();if(a&&("ol"===a||"ul"===a)){var l=e.className;if(l&&""!==l)if("ul"===a)switch(l=t.getTrimmedListStyleFromExternalWacElement(l,"BulletListStyle")){case"BulletListStyle1":return 3;case"BulletListStyle2":return 4;case"BulletListStyle3":return 5;default:return n}else if("ol"===a)switch(l=t.getTrimmedListStyleFromExternalWacElement(l,"NumberListStyle")){case"NumberListStyle1":return 7;case"NumberListStyle2":return 8;case"NumberListStyle3":return 9;case"NumberListStyle4":return 10;case"NumberListStyle5":return 11;default:return n}}}return n},t.prototype.GetListLevelFromElement=function(e){var n=-1,i=e.tagName.toLowerCase();if("ol"===i||"ul"===i){if(!(e=ji.s.getFirstChildByTagName(e,"li")))return n;i="li"}if("li"===i){if((n=(n=this.GetAttributeValueAsNonNegativeInt(e,"data-aria-level",0))||-1)>0)return n-1;if(e=ji.s.getFirstChildByTagName(e,"p"))return t.GetListLevelFromStyleValue(e)-1}return n},t.prototype.GetAttributeValueAsNonNegativeInt=function(e,t,n){var i;i=this._settings.get_pasteListImprovementsEnabled()?e.getAttribute(t):kp.getField(e,t);var r=parseInt(i);return isNaN(r)||r<0?n:r},t.prototype.OnListElementClose=function(){this._listInfoStack.pop(),this.normalizer.onListEnd()},t.prototype.HandleListOpen=function(e,n){this.HandleSpecifiedFormatting((function(e){return e.setParagraphSpacing(0,0)}));var i,r=this.getListStyleTypeFromElement(e.get_domElement(),n?6:2),a=1;n&&(a=this.GetAttributeValueAsNonNegativeInt(e.get_domElement(),"start",1));var l=!1;if(this._settings.get_pasteListImprovementsEnabled()){var s=e.get_domElement().getAttribute("data-pasteFromRc");(l=!!s&&"true"===s)&&e.get_domElement().removeAttribute("data-pasteFromRc"),(W.y.get_isInternetExplorerOrEdge()||W.y.get_isFirefox())&&t.ClearMargins(e.get_domElement())}return i=new qp(r,a,kp.parseGlobalAttributes(e),0,-1,l,this._settings.get_pasteListImprovementsEnabled()),this._listInfoStack.push(i),this.normalizer.onListStart(i),this.registerOnCloseCallback(o.i(this,this.OnListElementClose,"OnListElementClose")),1},t.prototype.reset=function(){e.prototype.reset.call(this),this._listInfoStack=new Mp(qp)},t.prototype.setFormattingFromAttributes=function(e,n){var i,r=!1;try{i=n.getAttribute("xml:lang")||kp.getField(n,"lang")}catch(e){i=null}i&&""!==i&&(r=e.setLang(i)||r);var o=kp.getField(n,"dir");o&&(r=e.setTextDir(o)||r);var a=n.style;if(a){if(a.fontWeight){var l=Rn.l.toUpper(a.fontWeight),s=parseInt(l);isNaN(s)?"BOLD"===l?r=e.setBold(!0)||r:"NORMAL"===l&&(r=e.setBold(!1)||r):r=s>=600?e.setBold(!0)||r:e.setBold(!1)||r}if(this._settings.get_shouldGetFontSizeStyle()&&a.fontSize){var u=kp.getSizeInPoints(a.fontSize);u>0&&(r=e.setFontsize(Math.floor(2*u))||r)}if(this._settings.get_shouldGetTextIndentStyle()(this._context))if(this._settings.get_shouldGetThemeMarginAndIndentAttributes()&&n.getAttribute){var c=n.getAttribute("data-indent");if(c&&c.length>0){var d=np.j.twipsToPixels(parseInt(c),0)+"px";r=e.setTextIndent(d)||r}}else a.textIndent&&(r=e.setTextIndent(a.textIndent)||r);if(this._settings.get_shouldGetMarginLeftStyle()(this._context)&&a.marginLeft)if(this._settings.get_shouldGetThemeMarginAndIndentAttributes()&&n.getAttribute){var g=n.getAttribute("data-margin");g&&g.length>0&&(r=e.setMarginLeft(a.marginLeft)||r)}else"TABLE"!==n.tagName&&(r=e.setMarginLeft(a.marginLeft)||r);if(this._settings.get_shouldGetLineHeightStyle()(this._context)&&a.lineHeight&&(r=e.setLineSpacing(a.lineHeight)||r),this._settings.get_shouldGetCapsStyle()){var p=a.textTransform?Rn.l.toLower(a.textTransform):null,h=a,_=h.fontVariantCaps?Rn.l.toLower(h.fontVariantCaps):null,m=a.fontVariant?Rn.l.toLower(a.fontVariant):null;"uppercase"===p?r=e.setTextCapsType("uppercase")||r:("small-caps"===_||m&&m.indexOf("small-caps")>=0)&&(r=e.setTextCapsType("small-caps")||r)}if(this._settings.get_shouldGetTextAlignStyle()(this._context)&&a.textAlign&&(r=e.setTextAlign(Rn.l.toLower(a.textAlign))||r),a.fontStyle){var f=Rn.l.toUpper(a.fontStyle);"ITALIC"===f||"OBLIQUE"===f?r=e.setItalics(!0)||r:"NORMAL"===f&&(r=e.setItalics(!1)||r)}var y=t.GetTextDecorationLine(n);if(a.textDecoration||y){var C=Rn.l.toLower(a.textDecoration||"");if(y=Rn.l.toLower(y||""),n.parentNode&&n.parentNode.tagName&&"a"===Rn.l.toLower(n.parentNode.tagName)){var b=(n.querySelector(".TextRun")||n).className;b&&b.indexOf("Underlined")>-1&&(r=e.setUnderline(!0)||r)}else(a.textDecorationUnderline||t.IsUnderline(C)||t.IsUnderline(y))&&(r=e.setUnderline(!0)||r);(a.textDecorationLineThrough||t.IsLineThrough(C)||t.IsLineThrough(y))&&(r=e.setStrikethrough(!0)||r)}if(a.verticalAlign){var v=Rn.l.toUpper(a.verticalAlign);if("SUB"===v||this._settings.get_shouldGetTextSuperscriptSubscriptStyle()(this._context)&&n.className&&n.className.indexOf("Subscript")>-1?r=e.setSubscript(!0)||r:("SUPER"===v||this._settings.get_shouldGetTextSuperscriptSubscriptStyle()(this._context)&&n.className&&n.className.indexOf("Superscript")>-1)&&(r=e.setSuperscript(!0)||r),this._settings.get_shouldGetFontSizeStyle()&&("SUB"===v||"SUPER"===v)&&n.getAttribute){var T=parseFloat(n.getAttribute("data-fontsize"));isNaN(T)||(r=e.setFontsize(Math.floor(2*T))||r)}}var A=!1;if(L.AFrameworkApplication.appSettingsManager&&(A=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CopyAndPasteFontTelemetryIsEnabled")),this._settings.get_shouldGetFontFamilyStyle()&&a.fontFamily)if(this._settings.get_shouldGetThemeFontFamily()&&n.getAttribute){var I=n.getAttribute("data-usefontface");I&&"true"===I&&(A&&S.ULS.sendTraceTag(41707205,307,50,"Customized fontface"),r=this.SetFontFaceFromFontFamily(e,a.fontFamily,r))}else r=this.SetFontFaceFromFontFamily(e,a.fontFamily,r);var w=null;this._settings.get_shouldGetColorStyle()&&a.color&&(w=Wp.convertColorValueToRgb(a.color));var x=!!w;if(this._settings.get_shouldGetThemeAttributes()(this._context)&&n.getAttribute){var E=n.getAttribute("data-scheme-color");x=""!==(w=null!==E?E:"")||!this._context.isCopiedFromSameApp||t.IsTextRunSpan(n)}if(x&&(r=e.setFontColor(w)||r),this._settings.get_shouldGetBackgroundColorStyle()&&a.backgroundColor&&(!this._settings.get_pasteTableImprovementsEnabled()||!n.tagName||!t.TableTags.contains(Rn.l.toUpper(n.tagName)))){var F=a.backgroundColor;r=e.setFontHighlight(Wp.convertColorValueToRgb(F))||r}if(this._settings.get_shouldGetBackgroundColorStyleFromImage()&&a.backgroundImage&&n.className&&n.className.indexOf("Highlight")>-1){var P=t.GetValuesFromLinearGradient(a.backgroundImage);if(P&&P.colorStops.get_count()>0){F=P.colorStops.get_item(0).color;for(var D=!0,R=0;R<P.colorStops.get_count()&&(D=D&&F===P.colorStops.get_item(R).color);R++);D&&(A&&S.ULS.sendTraceTag(41707206,307,50,"Paste text with highlight"),r=e.setFontHighlight(Wp.convertColorValueToRgb(F))||r)}}}if(this._settings.get_shouldGetParagraphProperties()(this._context)&&n.getAttribute){var M=n.getAttribute("data-ccp-props");M&&(r=e.setParagraphProperties(M)||r)}if(n.getAttribute){var k=n.getAttribute("data-ccp-charstyle");k&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this._settings.get_shouldGetPasteStyleId()&&(r=e.setCharacterStyle(k)||r));var N=n.getAttribute("data-ccp-parastyle");N&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this._settings.get_shouldGetPasteStyleId()&&(r=e.setParagraphStyle(N)||r))}return r},t.prototype.ShouldSkipAppendCommentAnchorText=function(e){if(this._settings.get_shouldSkipAppendText())for(var t=e.parentNode;t&&t.tagName;){if(t.className&&Object.getType(t.className)===String&&Rn.l.toUpper(t.className).indexOf("MSOCOM")>-1)return!0;if("DIV"===Rn.l.toUpper(t.tagName))break;t=t.parentNode}return!1},t.prototype.SetFontFaceFromFontFamily=function(e,n,i){var r=t.getFontFaceForFormattingSteward(n);return e.setFontface(r,this._settings.get_supportPasteCloudFont())||i},t.prototype.onText=function(e,t){"\u200b"===e&&(e="\xa0"),t&&t.get_domElement()&&this.ShouldSkipAppendCommentAnchorText(t.get_domElement())&&(e=""),this.normalizer.onText(e,kp.parseGlobalAttributes(t))},t.prototype.onAOpen=function(e){var t=kp.getField(e.get_domElement(),"href");return t&&""!==t?(this.normalizer.onAnchorStart(t,kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onAnchorEnd,"onAnchorEnd")),1):2},t.prototype.onBOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setBold(!0)}))?1:2},t.prototype.onBigOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.growFontsize()}))?1:2},t.prototype.onBlockquoteOpen=function(e){return this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onBrTag=function(e){this.normalizer.onLineBreak(kp.parseGlobalAttributes(e))},t.prototype.onCaptionOpen=function(e){return this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onCiteOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setItalics(!0)}))?1:2},t.prototype.onCenterOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setTextAlign("center")})),this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onCodeOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setFontface("consolas")}))?1:2},t.prototype.onDelOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setStrikethrough(!0)}))?1:2},t.prototype.onDdOpen=function(e){return this.HandleListOpen(e,!1)},t.prototype.onDfnOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setItalics(!0)}))?1:2},t.prototype.onDirOpen=function(e){return this.HandleListOpen(e,!1)},t.prototype.onDivOpen=function(e){var n=e.get_domElement().getAttribute("data-render-src"),i=e.get_domElement().getAttribute("data-render-method");if(n&&""!==n&&i&&""!==i){var r=e.get_domElement().getAttribute("data-render-fallback"),a=0,l=0;if(e.get_domElement().currentStyle){var s=e.get_domElement().currentStyle.width,u=e.get_domElement().currentStyle.height;if(s&&-1!==s.indexOf("px")){var c=parseInt(Rn.l.substring(s,0,s.indexOf("px")));isNaN(c)||(a=c)}if(u&&-1!==u.indexOf("px")){var d=parseInt(Rn.l.substring(u,0,u.indexOf("px")));isNaN(d)||(l=d)}}var g=new Lp(n,i,r,a,l,kp.parseGlobalAttributes(e));return this.normalizer.onRenderAugmentation(g),2}if(this._settings.get_pasteListImprovementsEnabled()&&(W.y.get_isInternetExplorerOrEdge()||W.y.get_isFirefox())){var p=new RegExp("^SCX[0-9a-zA-Z]+$"),h=e.get_domElement().className.match(p);this._settings.get_pasteListImprovementsEnabled()&&h&&h.length&&t.ClearMargins(e.get_domElement())}var _=e.get_domElement().getAttribute("align");return this.HandleSpecifiedFormatting((function(e){return e.setTextAlign(_)})),this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onDlOpen=function(e){return this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onDtOpen=function(e){return this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onEmOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setItalics(!0)}))?1:2},t.prototype.onFontOpen=function(e){return this.HandleSpecifiedFormatting((function(n){var i=t.getFontFaceForFormattingSteward(e.get_domElement().getAttribute("face")),r=n.setFontface(i),o=n.setFontColor(Wp.convertColorValueToRgb(e.get_domElement().getAttribute("color")));return r||o}))?1:2},t.prototype.onH1Open=function(e){var t=this;return this.HandleSpecifiedFormatting((function(e){return t._settings.get_shouldGetPasteStyleId()?e.setParagraphHeadingStyle(1):e.setParagraphStyleType(1)})),this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onH2Open=function(e){var t=this;return this.HandleSpecifiedFormatting((function(e){return t._settings.get_shouldGetPasteStyleId()?e.setParagraphHeadingStyle(2):e.setParagraphStyleType(2)})),this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onH3Open=function(e){var t=this;return this.HandleSpecifiedFormatting((function(e){return t._settings.get_shouldGetPasteStyleId()?e.setParagraphHeadingStyle(3):e.setParagraphStyleType(3)})),this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onH4Open=function(e){var t=this;return this.HandleSpecifiedFormatting((function(e){return t._settings.get_shouldGetPasteStyleId()?e.setParagraphHeadingStyle(4):e.setParagraphStyleType(4)})),this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onH5Open=function(e){var t=this;return this.HandleSpecifiedFormatting((function(e){return t._settings.get_shouldGetPasteStyleId()?e.setParagraphHeadingStyle(5):e.setParagraphStyleType(5)})),this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onH6Open=function(e){var t=this;return this.HandleSpecifiedFormatting((function(e){return t._settings.get_shouldGetPasteStyleId()?e.setParagraphHeadingStyle(6):e.setParagraphStyleType(6)})),this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onHrTag=function(e){this.normalizer.onLineBreak(kp.parseGlobalAttributes(e))},t.prototype.onImgTag=function(e){var t=e.get_domElement(),n=t.src,i=t.alt,r=t.longdesc,o=0,a=0;t.style&&(o=kp.getPixelSize(t.style.width),a=kp.getPixelSize(t.style.height)),o&&a||(o=t.width,a=t.height);var l=0,s=0;e.get_domElement().currentStyle&&(o||a||(o=kp.getPixelSize(e.get_domElement().currentStyle.width),a=kp.getPixelSize(e.get_domElement().currentStyle.height)),l=kp.getPixelSize(e.get_domElement().currentStyle.maxWidth),s=kp.getPixelSize(e.get_domElement().currentStyle.maxHeight));var u=new Jg(n,i,o,a,kp.parseGlobalAttributes(e),l,s,r);this.normalizer.onImage(u)},t.prototype.onIOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setItalics(!0)}))?1:2},t.prototype.onInsOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setUnderline(!0)}))?1:2},t.prototype.onKbdOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setFontface("consolas")}))?1:2},t.prototype.onLabelOpen=function(e){return this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onLegendOpen=function(e){return this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onLiOpen=function(e){var n,i=this.getListStyleTypeFromElement(e.get_domElement(),0),r=this.GetAttributeValueAsNonNegativeInt(e.get_domElement(),"value",0),a=!1;if(this._listInfoStack.get_count()>0?n=this._listInfoStack.peek():(n=new qp(2,1,kp.parseGlobalAttributes(e)),r||(r=1)),this._settings.get_pasteListImprovementsEnabled()){var l=n.get_listLevel(),s=n.get_listId();this._settings.get_shouldGetListLevelForEachListItem()?(l=(l=this.GetListLevelFromElement(e.get_domElement()))<0&&n.get_listLevel()<0&&this._listInfoStack.get_count()>0?n.set_listLevel(this._listInfoStack.get_count()-1):n.set_listLevel(l>=0?l:n.get_listLevel()),this._listUsageData&&this._listUsageData.b<l&&(this._listUsageData.b=l)):l<0&&(l=n.set_listLevel(this.GetListLevelFromElement(e.get_domElement()))),s<1&&(s=n.set_listId(this.GetAttributeValueAsNonNegativeInt(e.get_domElement(),"data-listid",0))),e.get_domElement().getAttribute("data-leveltext")&&n.set_levelText(e.get_domElement().getAttribute("data-leveltext"));var u=e.get_domElement().getAttribute("data-font");u&&n.set_font(u);var c=!1;if(L.AFrameworkApplication.appSettingsManager&&(c=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FollowDestinationThemePasteIsEnabled")),c){var d=e.get_domElement().getAttribute("data-charcodes"),g=[];if(d&&""!==d)if(d.indexOf(",")>-1)for(var p=d.split(","),h=0;h<p.length;h++)Array.add(g,parseInt(p[h]));else Array.add(g,parseInt(d));if(g&&g.length>0){var _=new Array(g.length);for(h=0;h<g.length;h++)_[h]=g[h];n.set_charCodes(_)}var m=e.get_domElement().getAttribute("data-buAutoNum");m&&m.length>0&&n.set_buAutoNum(parseInt(m))}(a=l>=0&&s>0)&&t.ClearMargins(e.get_domElement())}return n.ApplyListItemInfo(i,r,a),this.normalizer.onListItemStart(n.Clone()),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onListItemEnd,"onListItemEnd")),1},t.prototype.onMenuOpen=function(e){return this.HandleListOpen(e,!1)},t.prototype.onMathOpen=function(e){if(this.HandleSpecifiedFormatting((function(e){return e.setMath(!0)}))){var t=e.get_domElement().getAttribute("OuterHtml");this.normalizer.onMathStart(t,kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onMathEnd,"onMathEnd"))}return 1},t.prototype.onOlOpen=function(e){return this.HandleListOpen(e,!0)},t.prototype.onOptionOpen=function(e){return this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onPOpen=function(e){var n=e.get_domElement().getAttribute("align");if(this.HandleSpecifiedFormatting((function(e){return e.setTextAlign(n)})),this._settings.get_pasteListImprovementsEnabled()){var i=e.get_domElement().parentNode;i&&i.tagName.toLowerCase().startsWith("li")&&t.ClearMargins(e.get_domElement(),W.y.get_isInternetExplorerOrEdge()||W.y.get_isFirefox())}return this.normalizer.onParagraphStart(kp.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onPreOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setFontface("consolas")})),this.normalizer.onPreFormattedTextStart(),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onPreFormattedTextEnd,"onPreFormattedTextEnd")),1},t.prototype.onSOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setStrikethrough(!0)}))?1:2},t.prototype.onSampOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setFontface("consolas")}))?1:2},t.prototype.onSmallOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.shrinkFontsize()}))?1:2},t.prototype.onSpanOpen=function(e){var t=e.get_domElement().attributes.getNamedItem("style"),n="";t&&t.value&&(n=t.value);var i=Wp.parseMsoTabCount(n);if(i>0&&this._settings.get_inlineTabInsertionEnabled()){for(var r=0;r<i;r++)this.normalizer.onTab(kp.parseGlobalAttributes(e));return 3}return 2},t.prototype.onStrikeOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setStrikethrough(!0)}))?1:2},t.prototype.onStrongOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setBold(!0)}))?1:2},t.prototype.onSubOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setSubscript(!0)}))?1:2},t.prototype.onSupOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setSuperscript(!0)}))?1:2},t.prototype.onTableOpen=function(e){this.HandleSpecifiedFormatting((function(e){return e.clearFormatting()&&e.resetJustification()})),Wp.HandleCommonTableFormattingProperties(e.get_domElement(),this);var t=Wp.GetWidth(e.get_domElement()),n=Wp.GetCellBorders(e.get_domElement()),i=Wp.GetMarginLeft(e.get_domElement()),r=Wp.GetMarginRight(e.get_domElement()),a=!parseInt(kp.getField(e.get_domElement(),"border")),l=Wp.IsTableCellBordersCollpased(e.get_domElement()),s=-1,u="",c=-1;e.get_domElement().attributes.hasOwnProperty("style")&&-1!==(c=e.get_domElement().attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?s=parseInt(e.get_domElement().attributes.getNamedItem("style").value.substr(c+"mso-yfti-tbllook:".length)):e.get_domElement().attributes.hasOwnProperty(Np.x.dataTableLook.toString())&&(s=parseInt(e.get_domElement().attributes.getNamedItem(Np.x.dataTableLook.toString()).value));var d=-1;return e.get_domElement().attributes.hasOwnProperty("class")&&-1!==(d=e.get_domElement().attributes.getNamedItem("class").value.indexOf("Mso"))?u=e.get_domElement().attributes.getNamedItem("class").value.substr(d).split(" ")[0]:e.get_domElement().attributes.hasOwnProperty(Np.x.dataTableStyle.toString())&&(u=e.get_domElement().attributes.getNamedItem(Np.x.dataTableStyle.toString()).value),this.normalizer.onTableStart(new Xp(0,0,t.Value,t.IsRelativeDimension,null,a,l,n,new Kp(i.Value,r.Value),u,s,kp.parseGlobalAttributes(e))),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onTableEnd,"onTableEnd")),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings"),1},t.prototype.onTdOpen=function(e){var t=Wp.GetHeight(e.get_domElement()),n=Wp.GetWidth(e.get_domElement());if(!n.Value&&n.get_IsFromAttribute()&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this._settings.get_pasteComplexTableImprovementsEnabled()))return 3;var i=parseInt(kp.getField(e.get_domElement(),"colSpan"));null!=i&&i+""!=""||(i=n.Value?1:0);var r=parseInt(kp.getField(e.get_domElement(),"rowSpan"));null!=r&&r+""!=""||(r=t.Value?1:0);var a=!1;e.get_domElement().attributes.hasOwnProperty("style")&&(a=-1!==e.get_domElement().attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==e.get_domElement().attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder")),!a&&e.get_domElement().attributes.hasOwnProperty("class")&&(a=-1!==e.get_domElement().attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));var l=69905;if(e.get_domElement().attributes.hasOwnProperty(Np.x.dataCellLook.toString())){var s=parseInt(e.get_domElement().attributes.getNamedItem(Np.x.dataCellLook.toString()).value);isNaN(s)||(l=s)}var u=Wp.convertColorValueToRgb(e.get_domElement().style.backgroundColor),c=Wp.GetVerticalAlign(e.get_domElement());this.HandleSpecifiedFormatting((function(e){return e.setParagraphSpacing(0,0)})),Wp.HandleCommonTableFormattingProperties(e.get_domElement(),this);var d=Wp.GetCellBorders(e.get_domElement()),g=this._settings.get_pasteTableCellMarginImprovementsEnabled()?Wp.GetCellInternalMargins(e.get_domElement()):null,p=new jp(i,r,n.Value,t.Value,u,c,d,g,n.IsRelativeDimension,a,l,kp.parseGlobalAttributes(e));return this.normalizer.onTableCellStart(p),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onTableCellEnd,"onTableCellEnd")),this.notifyNormalizerOfCurrentFormatting(),1},t.prototype.onThOpen=function(e){var t=this.onTdOpen(e);return 3===t?t:(this.HandleSpecifiedFormatting((function(e){var t=e.setBold(!0),n=e.setTextAlign("center");return t||n})),Wp.HandleCommonTableFormattingProperties(e.get_domElement(),this),1)},t.prototype.onTrOpen=function(e){Wp.HandleCommonTableFormattingProperties(e.get_domElement(),this);var t=Wp.GetHeight(e.get_domElement());return t.get_IsFromAttribute()&&!t.Value&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this._settings.get_pasteComplexTableImprovementsEnabled())?3:(this.normalizer.onTableRowStart(new Qp(t.Value,kp.parseGlobalAttributes(e))),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onTableRowEnd,"onTableRowEnd")),1)},t.prototype.onTtOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setFontface("consolas")}))?1:2},t.prototype.onUOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setUnderline(!0)}))?1:2},t.prototype.onUlOpen=function(e){return this.HandleListOpen(e,!1)},t.prototype.onVarOpen=function(e){return this.HandleSpecifiedFormatting((function(e){return e.setUnderline(!0)}))?1:2},t.GetEffectiveFontFace=function(e){return e?e.split(",")[0]:null},t.TrimCssFontValueToFontName=function(e){if(!e)return null;var t=Rn.l.removeSurroundingChar(e,'"');return t=Rn.l.removeSurroundingChar(t,"'")},t.getFontFaceForFormattingSteward=function(e){if(!e)return null;var n=t.GetEffectiveFontFace(e);return n=t.TrimCssFontValueToFontName(n)},t.AddSubstringToLinearGradient=function(e,t){t=t.trim();var n=new RegExp("^-?[0-9]+deg$"),i=t.match(n);if(i&&i.length>0)return!e.hasDirection()&&(e.direction=t,!0);var r,o=new RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$"),a=t.match(o);if(a&&a.length>0)return!e.hasDirection()&&(e.direction=t,!0);var l=new RegExp("^rgb\\(.*\\)"),s=t.match(l),u=-1===(r=s&&s.length>0?t.indexOf(")")+1:t.indexOf(" "))?t:Wp.convertColorValueToRgb(t.substr(0,r).trim());if(!u||""===u)return!1;var c=-1===r?"":t.substr(r).trim(),d=new Bp;return d.color=u,d.stop=c,e.colorStops.add(d),!0},t.GetValuesFromLinearGradient=function(e){try{if(!e)return null;if(!(e=e.trim()).startsWith("linear-gradient(")||!e.endsWith(")"))return null;var n=e.substr("linear-gradient(".length);n=n.substr(0,n.lastIndexOf(")"));for(var i=new Vp;n.trim().length>0;){var r=n.indexOf(","),o=n.indexOf("(");if(o>0&&o<r){var a=n.indexOf(")");if(a<o)return null;r=n.indexOf(",",a)}if(-1===r){if(!t.AddSubstringToLinearGradient(i,n))return null;n=""}else{var l=n.substr(0,r);if(n=n.substr(r+1),!t.AddSubstringToLinearGradient(i,l))return null}}return i}catch(e){return null}},t.getTrimmedListStyleFromExternalWacElement=function(e,t){var n=e.split(" ");if(n.length>0)for(var i=0;i<n.length;i++)if(n[i].indexOf(t)>=0)return n[i];return""},t.ClearMargins=function(e,n){void 0===n&&(n=!1),e&&e.nodeType!==bp.o.text&&(e.style.margin="",n&&t.ClearChildMargins(e,n))},t.ClearChildMargins=function(e,n){if(e)for(e=e.firstChild;e;)e.nodeType!==bp.o.text&&(e.style&&(e.style.margin=""),n&&t.ClearChildMargins(e,n)),e=e.nextSibling},t.GetListLevelFromStyleValue=function(e){if("p"!==e.tagName.toLowerCase())return-1;var t=e.getAttribute("style");if(t&&t.length>0&&-1!==t.indexOf("mso-list"))for(var n=t.split(";"),i=0;i<n.length;i++){var r=n[i].split(":");if(2===r.length&&"mso-list"===r[0].trim()){var o=r[1].trim().split(" ");if(3===o.length)return Number.parseInvariant(o[1].substr(5))}}return-1},t.IsTextRunSpan=function(e){return!(void 0===e.className||null===e.className)&&e.className.startsWith("TextRun")},t.GetTextDecorationLine=function(e){var t;return null==(t=e.style.textDecorationLine)?null:t},t.IsLineThrough=function(e){return e.indexOf("line-through")>=0},t.IsUnderline=function(e){return e.indexOf("underline")>=0},t.TableTags=((Jp=new C.c(String)).add("TABLE"),Jp.add("THEAD"),Jp.add("TBODY"),Jp.add("TFOOT"),Jp.add("TR"),Jp.add("TH"),Jp.add("TD"),Jp),t}(kp);(0,o.l)(Yp,"c019e594$DefaultHtmlTranslator",kp,[]);var Zp=n(7118),eh=function(){function e(e){void 0===e&&(e=null),this._nextUniqueId=0,this._numBulletsConverted=0,this._numNumberedConverted=0,this.$$pf_UsageData=null,this.set_usageData(e||Zp.z.getWordConverterUsageDataInstance("")),this._nextUniqueId=Number.parseInvariant((new Date).format("HHmmss"))}return e.prototype.get_usageData=function(){return this.$$pf_UsageData},e.prototype.set_usageData=function(e){return this.$$pf_UsageData=e,e},e.prototype.process=function(e,t){if(e&&(this._numNumberedConverted=0,this._numBulletsConverted=0,e.querySelectorAll)){var n=e.querySelectorAll("p");if(n&&n.length>0){for(var i=0,r=!1,a=n[0].parentNode;i<5&&a&&a!==e;){i++;var l=a.id.toLowerCase();if(l&&l.length&&-1!==l.indexOf("_editingelement")){if(Sys.UI.DomElement.containsCssClass(a,"WACEditing")&&Sys.UI.DomElement.containsCssClass(a,"EditingSurfaceBody")){r=!0;break}a=a.parentNode}else a=a.parentNode}if(r&&a!==e){for(var s=e.firstChild,u=!1;a.children.length>0&&a.children[0]!==s;)e.insertBefore(a.children[0],s),u=!0;if(u)for(var c=null;s;)c=s.nextSibling,e.removeChild(s),s=c}var d=new vp.a(t,o.i(this,this.ProcessNodesDiscovery,"ProcessNodesDiscovery"),new xp(n));d.setDebugName("Word Converter Operation"),d.set_isSynchronous(!t||t.get_isSynchronous()),d.run()}}},e.prototype.ProcessNodesDiscovery=function(t,n){var i=n,r=i.Nodes[i.CurrentIndex],a=e.GetListItemMetadata(r);if(a){var l=new RegExp("level[0-9]"),s=a.WordListId.replace(l,"").trim();s=s&&s.length?s:a.WordListId;var u=i.Lists[s];u||((u=new Tp).UniqueListId=this._nextUniqueId++);var c=u.ListLevelMetadataForEachLevel[a.Level-1];c||((c=new Ip).Level=a.Level);var d=r.parentNode;if(d&&"li"===d.tagName.toLowerCase()){var g=d.parentNode;if(g){var p=g.tagName.toUpperCase();!p||"OL"!==p&&"UL"!==p||(c.TagName=p)}}else c.MostRecentFakeListMarker=e.GetFakeListMarkerText(r,e.LookupDepth),c.MostRecentFakeListMarker&&c.MostRecentFakeListMarker.length||(c.MostRecentFakeListMarker=e.GetSupportListFakeListMarkerText(r,e.LookupDepth)),c.Ignore=!c.MostRecentFakeListMarker||!c.MostRecentFakeListMarker.length,c.TagName=e.GetFakeBulletTagName(c.MostRecentFakeListMarker);if(a.UniqueListId=u.UniqueListId,c.NumberOfItems++,!c.Ignore&&"li"!==r.parentNode.tagName.toLowerCase()){var h=e.GetSupportListFakeListMarkerText(r,e.LookupDepth);if((h=h||c.MostRecentFakeListMarker)&&h.length){a.FakeListMarker=h;var _=e.SetListStyleAndStartFromOrderedFakeListMarker(r,h,c.ListStyle,a.Level-1);_&&_.length&&(c.ListStyle=_)}}i.ListItems[i.ListItems.length]=a,c.ListItems.contains(a)||c.ListItems.add(a),void 0!==u.ListLevelMetadataForEachLevel[a.Level-1]&&null!==u.ListLevelMetadataForEachLevel[a.Level-1]&&u.ListLevelMetadataForEachLevel[a.Level-1]===c||(u.ListLevelMetadataForEachLevel[a.Level-1]=c),i.Lists[s]&&i.Lists[s]===u||(i.Lists[s]=u),i.LastProcessedItem=r}else{var m=i.LastProcessedItem;if(m&&e.GetRealPreviousSibling(r)===m&&r.tagName===m.tagName&&r.className===m.className){for(m.appendChild(m.ownerDocument.createElement("BR")),m.appendChild(m.ownerDocument.createElement("BR"));r.firstChild;)m.appendChild(r.firstChild);r.parentNode.removeChild(r)}}if(i.CurrentIndex++,i.Nodes.length<=i.CurrentIndex){if(!i.ListItems.length)return!1;i.CurrentIndex=0,t.changeStepCallback(o.i(this,this.ProcessNodeConvert,"ProcessNodeConvert"))}return!0},e.prototype.ProcessNodeConvert=function(t,n){var i=n,r=i.ListItems[i.CurrentIndex],o=r.OriginalNode,a=new RegExp("level[0-9]"),l=r.WordListId.replace(a,"").trim();l=l&&l.length?l:r.WordListId;var s=i.Lists[l],u=s.ListLevelMetadataForEachLevel[r.Level-1],c=o.parentNode.tagName.toLowerCase();if(!u.Ignore&&o.parentNode&&"li"!==c){var d=e.CreateListForNode(o,u);if(d){e.CleanupListIgnore(o,e.LookupDepth);var g=o.ownerDocument.createElement("LI");for(g.setAttribute("data-aria-level",String.format("{0}",r.Level)),g.setAttribute("data-listid",String.format("{0}",s.UniqueListId));o.firstChild;)g.appendChild(o.firstChild);d.appendChild(g),o.parentNode.removeChild(o),"UL"===u.TagName?(this._numBulletsConverted++,this.get_usageData().b++):(this._numNumberedConverted++,this.get_usageData().c++)}}else if("li"===c){var p=u.TagName,h=o.parentNode;if(r.PasteFromRichClient){var _=h.parentNode;_&&_.tagName.toUpperCase()===p&&_.setAttribute("data-pasteFromRc","true")}h.setAttribute("data-listid",String.format("{0}",s.UniqueListId)),"UL"===p?(this._numBulletsConverted++,this.get_usageData().b++):(this._numNumberedConverted++,this.get_usageData().c++)}return i.CurrentIndex++,i.CurrentIndex<i.ListItems.length},e.CreateListForNode=function(t,n){var i=e.CreateListAtNode(t,n.TagName);return e.ConvertListIfNeeded(i,n)},e.ConvertListIfNeeded=function(e,t){if(t.TagName!==e.tagName){for(var n=e.ownerDocument.createElement(t.TagName);e.firstChild;)n.appendChild(e.firstChild);e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e),e=n}return e},e.CreateListAtNode=function(e,t){var n=e.ownerDocument.createElement(t||"UL"),i=e.getAttribute("start");i&&i.length>0&&(n.setAttribute("start",i),e.removeAttribute("start"));var r,o=e.className;return o&&o.length>0&&(r="OL"===n.tagName?Yp.getTrimmedListStyleFromExternalWacElement(o,"NumberListStyle"):Yp.getTrimmedListStyleFromExternalWacElement(o,"BulletListStyle")).length>0&&(Sys.UI.DomElement.addCssClass(n,r),Sys.UI.DomElement.removeCssClass(e,r)),e.parentNode.insertBefore(n,e),n},e.CleanupListIgnore=function(t,n){for(var i=0;i<t.childNodes.length;i++){var r=t.childNodes[i];r.nodeType===bp.o.element&&n>1&&e.CleanupListIgnore(r,n-1),(e.IsEmptySpan(r)||e.IsIgnoreNode(r))&&(t.removeChild(r),i--)}},e.GetListItemMetadata=function(t){if(t.nodeType===bp.o.element){var n=e.GetStyleValue(t,e.MsoListStyleName);if(n&&n.length>0)try{var i=n.split(" ");if(3===i.length)return(o=new Ap).Level=Number.parseInvariant(i[1].substr(5)),o.WordListId=n,o.OriginalNode=t,o.PasteFromRichClient=!0,o}catch(e){}else{var r=t.parentNode;if(r&&"li"===r.tagName.toLocaleLowerCase()){var o,a=r.getAttribute("data-"+vt.t.ariaLevelAttribute),l=r.getAttribute("data-listid");if(a&&l&&a.length>0&&l.length>0)return(o=new Ap).Level=Number.parseInvariant(a),o.WordListId=l+" level"+a,o.OriginalNode=t,o.PasteFromRichClient=!1,o}}}return null},e.SetListStyleAndStartFromOrderedFakeListMarker=function(t,n,i,r){if("p"===t.tagName.toLowerCase()&&n&&n.length){var o=void 0;if("UL"===e.GetFakeBulletTagName(n))return o=e.GetBulletListStyleFromMarker(n),Sys.UI.DomElement.addCssClass(t,o),o;var a=-1,l=new RegExp("^[0-9]+"),s=void 0;if((s=n.match(l))&&s.length)return o="NumberListStyle1",Sys.UI.DomElement.addCssClass(t,o),t.setAttribute("start",s[0]),o;var u=new RegExp("^[a-zA-Z]+");if((s=n.match(u))&&s.length){var c=s[0],d=new RegExp("^[ivxlcdmIVXLCDM]+"),g=c.match(d);if(1!==(a=g&&g.length?e.GetRomanAlphaStyle(i,r):1)){var p=new RegExp("^[ivxlcdm]+");if(o=e.ConvertListMarkerIfMatchedAndSetProperties(t,c,p,Rn.l.convertFromRoman,"NumberListStyle3"))return o;var h=new RegExp("^[IVXLCDM]+");if(o=e.ConvertListMarkerIfMatchedAndSetProperties(t,c,h,Rn.l.convertFromRoman,"NumberListStyle5"))return o}if(a){var _=new RegExp("^[a-z]+");if(o=e.ConvertListMarkerIfMatchedAndSetProperties(t,c,_,Rn.l.convertFromAlpha,"NumberListStyle2"))return o;var m=new RegExp("^[A-Z]+");if(o=e.ConvertListMarkerIfMatchedAndSetProperties(t,c,m,Rn.l.convertFromAlpha,"NumberListStyle4"))return o}}return"NumberListStyle1"}return null},e.GetBulletListStyleFromMarker=function(e){switch(e){case"o":return"BulletListStyle2";case"\xa7":return"BulletListStyle3";case"\xb7":case"-":default:return"BulletListStyle1"}},e.GetRomanAlphaStyle=function(e,t){var n=-1;switch(e&&e.length||(e=""),e){case"NumberListStyle2":case"NumberListStyle4":n=1;break;case"NumberListStyle3":case"NumberListStyle5":n=0;break;default:n=-1}if(n<0)switch(t%3){case 0:n=0;break;case 1:n=1;break;case 2:default:n=0}return n},e.ConvertListMarkerIfMatchedAndSetProperties=function(e,t,n,i,r){var o=t.match(n);if(o&&o.length){var a=i(o[0]);return a=a<1?1:a,Sys.UI.DomElement.addCssClass(e,r),e.setAttribute("start",a+""),r}return null},e.GetFakeBulletTagName=function(e){return e&&"o"!==e&&"\xb7"!==e&&"\xa7"!==e&&"-"!==e?"OL":"UL"},e.GetSupportListFakeListMarkerText=function(t,n){for(var i,r,o,a=null,l=-1;!a&&l<t.childNodes.length;l++){var s=-1===l?t:t.childNodes[l];if(s)if((i=s.innerHTML)&&i.length>0){if((r=i.indexOf("\x3c!--[if !supportLists]--\x3e"))>=0&&(o=i.indexOf("\x3c!--[endif]--\x3e"))>=0){var u=i.substring(r,o+14);if(s.innerHTML=s.innerHTML.replace(u,""),u.length){var c=t.ownerDocument.createElement("span");return c.innerHTML=u,a=c.innerText.trim()}a&&a.length||(a="o")}}else l>=0&&s.nodeType===bp.o.element&&n>1&&(a=e.GetSupportListFakeListMarkerText(s,n-1))}return a},e.GetFakeListMarkerText=function(t,n){for(var i=null,r=0;!i&&r<t.childNodes.length;r++){var o=t.childNodes[r];e.IsIgnoreNode(o)?((i="string"==typeof o.innerText?o.innerText.trim():o.textContent.trim()).length||(i="o"),o.parentNode.removeChild(o)):o.nodeType===bp.o.element&&n>1&&(i=e.GetFakeListMarkerText(o,n-1))}return i},e.IsIgnoreNode=function(t){if(t.nodeType===bp.o.element){var n=e.GetStyleValue(t,e.MsoListStyleName);if(n&&n.length>0&&"ignore"===n.trim().toLowerCase())return!0}return!1},e.IsEmptySpan=function(e){return e.nodeType===bp.o.element&&!e.firstChild&&"SPAN"===e.tagName.toUpperCase()},e.GetStyleValue=function(e,t){var n=e.getAttribute("style");if(n&&n.length>0&&-1!==n.indexOf(t))for(var i=n.split(";"),r=0;r<i.length;r++){var o=i[r].split(":");if(2===o.length&&o[0].trim()===t)return o[1].trim()}return null},e.GetRealPreviousSibling=function(t){var n=t;do{n=n.previousSibling}while(n&&e.IsEmptyTextNode(n));return n},e.IsEmptyTextNode=function(t){if(!t)return!0;if(t.nodeType===bp.o.text){var n=t.nodeValue;return!(n=n.replace(e._lineBreaks,"")).trim().length}return t.nodeType===bp.o.element&&t.firstChild===t.lastChild&&("SPAN"===t.tagName||"FONT"===t.tagName)&&e.IsEmptyTextNode(t.firstChild)},e.MsoListStyleName="mso-list",e.LookupDepth=5,e._lineBreaks=new RegExp("[\n|\r]","gi"),e}();(0,o.l)(eh,"2c940c2c$WacAndRichClientWordConverter",null,[Sp]);var th=n(509),nh=function(){return function(){this.UniqueListId=0,this.TagName=null,this.FirstFakeBullet=null,this.Ignore=!1,this.NumberOfItems=0,this.TagName="UL",this.FirstFakeBullet=null,this.Ignore=!1,this.NumberOfItems=0}}();(0,o.l)(nh,"80fd551a$ListMetadata",null,[]);var ih=function(){function e(e){void 0===e&&(e=null),this._nextUniqueId=1,this._numBulletsConverted=0,this._numNumberedConverted=0,this.$$pf_UsageData=null,this.set_usageData(e||Zp.z.getWordConverterUsageDataInstance(""))}return e.prototype.get_usageData=function(){return this.$$pf_UsageData},e.prototype.set_usageData=function(e){return this.$$pf_UsageData=e,e},e.prototype.process=function(e,t){if(e&&(this._numNumberedConverted=0,this._numBulletsConverted=0,e.querySelectorAll)){var n=e.querySelectorAll("p");if(n&&n.length>0){var i=new vp.a(t,o.i(this,this.ProcessNodesDiscovery,"ProcessNodesDiscovery"),new xp(n));i.setDebugName("Word Converter Operation"),i.set_isSynchronous(!t||t.get_isSynchronous()),i.run()}}},e.prototype.ProcessNodesDiscovery=function(t,n){var i=n,r=i.Nodes[i.CurrentIndex],a=e.GetListItemMetadata(r);if(a){var l=i.CurrentListIdsByLevels[a.Level-1];l||(l=new wp,i.CurrentListIdsByLevels[a.Level-1]=l),i.LastProcessedItem&&e.GetRealPreviousSibling(r)!==i.LastProcessedItem&&e.ResetCurrentLists(i);var s=l.ListsMetadata[a.WordListId];if(s){if(!s.Ignore&&1===s.NumberOfItems){var u=e.GetFakeBulletText(r,e.LookupDepth);s.TagName=s.FirstFakeBullet===u?"UL":"OL"}}else(s=new nh).UniqueListId=this._nextUniqueId++,s.FirstFakeBullet=e.GetFakeBulletText(r,e.LookupDepth),s.Ignore=!s.FirstFakeBullet||!s.FirstFakeBullet.length,s.TagName=e.GetFakeBulletTagName(s.FirstFakeBullet),l.ListsMetadata[a.WordListId]=s,i.Lists[s.UniqueListId.toString()]=s;a.UniqueListId=s.UniqueListId,s.Ignore||"OL"===s.TagName&&s.NumberOfItems>0&&l.CurrentUniqueListId!==a.UniqueListId?(s.Ignore=!0,i.CurrentListIdsByLevels[0].CurrentUniqueListId=-1,i.CurrentListIdsByLevels=i.CurrentListIdsByLevels.slice(0,1)):(i.CurrentListIdsByLevels.length>a.Level&&(i.CurrentListIdsByLevels=i.CurrentListIdsByLevels.slice(0,a.Level)),l.CurrentUniqueListId=a.UniqueListId,i.ListItems[i.ListItems.length]=a,s.NumberOfItems++),i.LastProcessedItem=r}else{var c=i.LastProcessedItem;if(c&&e.GetRealPreviousSibling(r)===c&&r.tagName===c.tagName&&r.className===c.className){for(c.appendChild(c.ownerDocument.createElement("BR")),c.appendChild(c.ownerDocument.createElement("BR"));r.firstChild;)c.appendChild(r.firstChild);r.parentNode.removeChild(r)}}if(i.CurrentIndex++,i.Nodes.length<=i.CurrentIndex){if(!i.ListItems.length)return!1;i.CurrentIndex=0,t.changeStepCallback(o.i(this,this.ProcessNodeConvert,"ProcessNodeConvert"))}return!0},e.prototype.ProcessNodeConvert=function(t,n){var i=n,r=i.ListItems[i.CurrentIndex],o=r.OriginalNode,a=i.Lists[r.UniqueListId.toString()];if(!a.Ignore){var l=e.GetOrCreateListForNode(o,r,a);if(l){e.CleanupListIgnore(o,e.LookupDepth);for(var s=o.ownerDocument.createElement("LI");o.firstChild;)s.appendChild(o.firstChild);l.appendChild(s),o.parentNode.removeChild(o),"UL"===a.TagName?(this._numBulletsConverted++,this.get_usageData().b++):(this._numNumberedConverted++,this.get_usageData().c++)}}return i.CurrentIndex++,i.CurrentIndex<i.ListItems.length},e.GetOrCreateListForNode=function(t,n,i){var r=e.RecurringGetOrCreateListAtNode(t,n.Level,i),o=th.q.getObject(r,e.UniqueListIdCustomData);if(o&&o!==n.UniqueListId||!o&&r.firstChild){var a=t.ownerDocument.createElement(i.TagName);r.parentNode.insertBefore(a,r.nextSibling),r=a}return th.q.setObject(r,e.UniqueListIdCustomData,n.UniqueListId),e.ConvertListIfNeeded(r,i)},e.ConvertListIfNeeded=function(t,n){if(n.TagName!==t.tagName){var i=t.ownerDocument.createElement(n.TagName);for(th.q.setObject(i,e.UniqueListIdCustomData,th.q.getObject(t,e.UniqueListIdCustomData));t.firstChild;)i.appendChild(t.firstChild);t.parentNode.insertBefore(i,t),t.parentNode.removeChild(t),t=i}return t},e.RecurringGetOrCreateListAtNode=function(t,n,i){var r,o=null;if((r=1===n?e.GetRealPreviousSibling(t):(o=e.RecurringGetOrCreateListAtNode(t,n-1,null)).lastChild)&&r.nodeType===bp.o.element){var a=r.tagName.toUpperCase();if("UL"===a||"OL"===a)return r}var l=t.ownerDocument.createElement(i?i.TagName:"UL");return 1===n?t.parentNode.insertBefore(l,t):o.appendChild(l),l},e.CleanupListIgnore=function(t,n){for(var i=0;i<t.childNodes.length;i++){var r=t.childNodes[i];r.nodeType===bp.o.element&&n>1&&e.CleanupListIgnore(r,n-1),(e.IsEmptySpan(r)||e.IsIgnoreNode(r))&&(t.removeChild(r),i--)}},e.GetListItemMetadata=function(t){if(t.nodeType===bp.o.element){var n=e.GetStyleValue(t,e.MsoListStyleName);if(n&&n.length>0)try{var i=n.split(" ");if(3===i.length){var r=new Ap;return r.Level=Number.parseInvariant(i[1].substr(5)),r.WordListId=n,r.OriginalNode=t,r}}catch(e){}}return null},e.GetFakeBulletTagName=function(e){return"o"!==e&&"\xb7"!==e&&"\xa7"!==e&&"-"!==e?"OL":"UL"},e.GetFakeBulletText=function(t,n){for(var i=null,r=0;!i&&r<t.childNodes.length;r++){var o=t.childNodes[r];e.IsIgnoreNode(o)?(i="string"==typeof o.innerText?o.innerText.trim():o.textContent.trim()).length||(i="o"):o.nodeType===bp.o.element&&n>1&&(i=e.GetFakeBulletText(o,n-1))}return i},e.IsIgnoreNode=function(t){if(t.nodeType===bp.o.element){var n=e.GetStyleValue(t,e.MsoListStyleName);if(n&&n.length>0&&"ignore"===n.trim().toLowerCase())return!0}return!1},e.IsEmptySpan=function(e){return e.nodeType===bp.o.element&&!e.firstChild&&"SPAN"===e.tagName.toUpperCase()},e.GetStyleValue=function(e,t){var n=e.getAttribute("style");if(n&&n.length>0&&-1!==n.indexOf(t))for(var i=n.split(";"),r=0;r<i.length;r++){var o=i[r].split(":");if(2===o.length&&o[0].trim()===t)return o[1].trim()}return null},e.GetRealPreviousSibling=function(t){var n=t;do{n=n.previousSibling}while(n&&e.IsEmptyTextNode(n));return n},e.IsEmptyTextNode=function(t){if(!t)return!0;if(t.nodeType===bp.o.text){var n=t.nodeValue;return!(n=n.replace(e._lineBreaks,"")).trim().length}return t.nodeType===bp.o.element&&t.firstChild===t.lastChild&&("SPAN"===t.tagName||"FONT"===t.tagName)&&e.IsEmptyTextNode(t.firstChild)},e.ResetCurrentLists=function(e){for(var t=0;t<e.CurrentListIdsByLevels.length;t++){var n=e.CurrentListIdsByLevels[t];n&&(n.CurrentUniqueListId=-1)}},e.MsoListStyleName="mso-list",e.LookupDepth=5,e.UniqueListIdCustomData="UniqueListId",e._lineBreaks=new RegExp("[\n|\r]","gi"),e}();(0,o.l)(ih,"ac0c761b$WordConverter",null,[Sp]);var rh=function(){function e(t){this._externalPasteImprovementsEnabled=!1,this._externalPasteImprovementsEnabled=t.getBooleanAppSetting(e._externalPasteImprovementSettingName)&&t.getBooleanAppSetting("ListMarkerIsEnabled")}return e.prototype.get_externalPasteImprovementsEnabled=function(){return this._externalPasteImprovementsEnabled},e.prototype.create=function(e){return void 0===e&&(e=null),this._externalPasteImprovementsEnabled?new eh(e):new ih(e)},e._externalPasteImprovementSettingName="ExternalPasteImprovementsEnabled",e}();(0,o.l)(rh,"77a55839$Box4WordConverterFactory",null,[_g]);var oh=n(3740),ah=n(1749),lh=n(9199),sh=function(){function e(e,t,n,i,r){this._activityManager=null,this._systemClipboard=null,this._browserUtils=null,this._simpleOperationFactory=null,this._chromeClipboardAccessOperationTimeout=0,this._ensureOperationStartTime=0,this._activityManager=e,this._browserUtils=t,this._chromeClipboardAccessOperationTimeout=r,this._systemClipboard=n,this._simpleOperationFactory=i}return e.prototype.checkSystemClipboardReady=function(e,t,n){S.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",t,n,this._browserUtils.get_browserNameForlogging()),e.get_isSynchronous()&&this._browserUtils.get_isChrome()&&window.chrome&&S.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",t),this._systemClipboard.ensureSystemClipboardAccess(!!(16&t)),this._simpleOperationFactory.create(e,o.i(this,this.WaitingForEnsureAccessOperationResult,"WaitingForEnsureAccessOperationResult"),null).setDebugName("ClipboardPreProcess"),this._ensureOperationStartTime=Date.now()},e.prototype.resetSystemClipboard=function(){this._systemClipboard.reset()},e.prototype.WaitingForEnsureAccessOperationResult=function(e,t){var n=!0,i=this._systemClipboard.get_ensureOperationResult();return null!=i?(e.set_operationContext(i),n=!1):Date.now()-this._ensureOperationStartTime>this._chromeClipboardAccessOperationTimeout&&(S.ULS.sendTraceTag(18354843,307,50,null),this._activityManager.recordEvent(ah.f.failedProcessingStep,{Reason:lh.i.operationTimeout}),e.set_operationContext(!1),n=!1),n},e}();(0,o.l)(sh,"45a89b95$ClipboardOperationClipboardAccessHelper",null,[sg]);var uh=(0,o.y)("1eff8295$IClipboardOperationCutCopy"),ch=function(){function e(e,t,n,i,r,o,a,l,s,u,c,d,g,p,h){this._actionManager=null,this._activityManager=null,this._systemClipboard=null,this._internalClipboard=null,this._outlineElementEditor=null,this._selectionManager=null,this._paragraphReader=null,this._selectionEditor=null,this._outlineElementNavigator=null,this._graphIteratorFactory=null,this._outlineElementReader=null,this._renderOrderGraphIteratorFactory=null,this._selectionFactory=null,this._clipboardDataHelper=null,this._imageDataURLSkippedForSafari12IsEnabled=!1,this._isPasteTextKeepSourceFontSizeEnabled=!1,this._actionManager=e,this._activityManager=t,this._internalClipboard=n,this._outlineElementEditor=i,this._selectionManager=r,this._systemClipboard=o,this._paragraphReader=a,this._selectionEditor=l,this._outlineElementNavigator=s,this._graphIteratorFactory=u,this._outlineElementReader=c,this._renderOrderGraphIteratorFactory=d,this._selectionFactory=g,this._clipboardDataHelper=h,this._imageDataURLSkippedForSafari12IsEnabled=!!p&&p.getBooleanAppSetting("ImageDataURLSkippedForSafari12IsEnabled"),this._isPasteTextKeepSourceFontSizeEnabled=!!p&&p.getBooleanAppSetting("PasteKeepSourceFontSizeFixIsEnabled")}return e.prototype.get_OutlineElementEditor=function(){return this._outlineElementEditor},e.prototype.get_ActivityManager=function(){return this._activityManager},e.prototype.waitBeforeCopy=function(e,t){return e.yield(),!0},e.prototype.copyExternal=function(e,t){var n=t,i=n.ActionIdFlags;if(S.ULS.shipAssertTag(18130960,307,!!(16&i)),256&i){var r=!1;if(W.y.get_isSafari12Up()&&L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings"),this._imageDataURLSkippedForSafari12IsEnabled&&W.y.get_isSafari12Up()){var o=n.InteractiveView.get_editingDom().get_editingElement();this._clipboardDataHelper.replaceImageSrcWithCustomFieldSrc(o,"data-src","data-srcurl"),r=this._systemClipboard.copy(),this._clipboardDataHelper.replaceImageSrcWithCustomFieldSrc(o,"data-srcurl","data-src")}else if(this._isPasteTextKeepSourceFontSizeEnabled&&n.InteractiveView&&n.InteractiveView.get_editingDom()){var a=this._clipboardDataHelper.changeFontSizeUnitBeforeCutCopy(n.InteractiveView.get_editingDom().get_editingElement(),n.InteractiveView.get_displayUnitConverter(),!0);r=this._systemClipboard.copy(),a&&this._clipboardDataHelper.changeFontSizeUnitBeforeCutCopy(n.InteractiveView.get_editingDom().get_editingElement(),n.InteractiveView.get_displayUnitConverter(),!1)}else r=this._systemClipboard.copy();if(!r)return S.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),this.get_ActivityManager().recordEvent(ah.f.failedResult,{Reason:lh.i.systemClipboardFailed}),n.OperationTelemetry&&n.OperationTelemetry.fail("SystemClipboard did not copy",!1),n.Failed=!0,!1}return!0},e.prototype.copyInternal=function(e,t){var n=t,i=n.InteractiveView,r=n.ActionIdFlags;return S.ULS.shipAssertTag(18130961,307,!!(16&r)),n.SkipInternalCopy?this._internalClipboard.clearInternalData():this._internalClipboard.copySelectionToInternalClipboard(i,e),!0},e.prototype.deleteForCut=function(e,t){var n,i=t,r=(i.InteractiveView,i.Context),o=i.ActionData,a=i.ReportingData,l=!1,s=this._selectionManager.get_selectionCollection().get_currentSelection().get_lastContext();if(this._paragraphReader.isParagraphContext(s)||this._selectionEditor.isEndOfParagraphContext(s)){var u=this._graphIteratorFactory.getGraphIteratorFromNode(s.get_node()),c=u.tryToRootAtOutlineAncestor();S.ULS.shipAssertTag(18130962,307,c),this._outlineElementNavigator.returnToOutlineElement(u),this._outlineElementReader.isLastOutlineElementInOutline(u)&&(l=!0)}(n=64&i.ActionIdFlags?new Dl.DictionaryPropertySet:o||new Dl.DictionaryPropertySet).setValue(Pl.k.doNotDeleteTableSegments,!1);var d=this._actionManager.processActionAgainstContext(r,Oi.u.deleteKey,2,!0,a,n);if(8===d&&(S.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.get_ActivityManager().recordEvent(ah.f.failedProcessingStep,{Reason:lh.i.deleteFailed}),i.OperationTelemetry&&i.OperationTelemetry.fail("DeleteKey failed",!1),i.Failed=!0),32===d&&l){var g=this._selectionManager.get_selectionCollection().get_currentSelection();if(this._selectionEditor.isInsertionPointSelection(g)&&g.get_firstContext().get_node()===s.get_node()&&!this._paragraphReader.textLength(g.get_firstContext().get_node())){var p=this._graphIteratorFactory.getGraphIteratorFromNode(g.get_firstContext().get_node());c=this._selectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(p);if(S.ULS.shipAssertTag(18130964,307,c),this._outlineElementNavigator.returnToOutlineElement(p),!this._outlineElementReader.isFirstOutlineElementInOutline(p)){var h=this._renderOrderGraphIteratorFactory.create();h.setFrom(p),this._outlineElementNavigator.moveToPreviousOutlineElement(h,!1,!1);var _=this._outlineElementNavigator.moveToContent(h);this._paragraphReader.isParagraphNode(_)&&(this._outlineElementNavigator.returnToOutlineElement(h),this.get_OutlineElementEditor().merge(h,p,!1,!1),this._selectionManager.setSelection(this._selectionFactory.createIpSelection(_,this._paragraphReader.textLength(_))))}}}return!0},e}();(0,o.l)(ch,"af0839bc$ClipboardOperationCutCopy",null,[uh]);var dh=function(){function e(e,t,n,i,r,o,a,l,s,u,c,d,g,p,h){this._actionManager=null,this._activityManager=null,this._systemClipboard=null,this._internalClipboard=null,this._selectionManager=null,this._outlineElementEditor=null,this._paragraphReader=null,this._selectionEditor=null,this._outlineElementNavigator=null,this._graphIteratorFactory=null,this._outlineElementReader=null,this._renderOrderGraphIteratorFactory=null,this._selectionFactory=null,this._appSettingsManager=null,this._clipboardDataHelper=null,this._actionManager=e,this._activityManager=t,this._internalClipboard=n,this._systemClipboard=o,this._selectionManager=r,this._outlineElementEditor=i,this._paragraphReader=a,this._selectionEditor=l,this._outlineElementNavigator=s,this._graphIteratorFactory=u,this._outlineElementReader=c,this._renderOrderGraphIteratorFactory=d,this._selectionFactory=g,this._appSettingsManager=p,this._clipboardDataHelper=h}return e.prototype.create=function(){return new ch(this._actionManager,this._activityManager,this._internalClipboard,this._outlineElementEditor,this._selectionManager,this._systemClipboard,this._paragraphReader,this._selectionEditor,this._outlineElementNavigator,this._graphIteratorFactory,this._outlineElementReader,this._renderOrderGraphIteratorFactory,this._selectionFactory,this._appSettingsManager,this._clipboardDataHelper)},e}();(0,o.l)(dh,"d0b52c88$Factory",null,[rg]);var gh=function(){function e(){}return e.prototype.shouldDeleteTableForCut=function(){return!0},e}();(0,o.l)(gh,"2fc7f7c2$ClipboardOperationCutStrategy",null,[$d]);var ph=n(7559),hh=function(e,t){var n=e.__sortedValues;if(!n){for(var i in n=[],e)"string"==typeof i&&n.push({key:i,value:e[i]});n.sort((function(e,t){return e.value-t.value})),e.__sortedValues=n}for(var r=[],o=t,a=1;o>0;)1&o&&e[a]&&r.push(e[a]),a<<=1,o>>=1;if(r.length&&0===o)return r.reverse().join(", ")},_h=n(9267),mh=n(2689),fh=n(6569),yh=n(1081),Ch=function(){function e(t,n,i,r,a,l,s,u){void 0===l&&(l=null),void 0===s&&(s=""),void 0===u&&(u=!0),this.Context=null,this.InteractiveView=null,this.ActionIdFlags=0,this.ActionData=null,this.ReportingData=null,this.IsOvertype=!1,this.IsEndOfParagraphLastContext=!1,this.OriginalParagraphFormat=null,this.SelectPastedContent=!1,this.ReplacedFormatting=null,this.SkipInternalCopy=!1,this.BrowserName=null,this.UseVirtualSelection=!1,this.OperationTelemetry=null,this.ClipboardOperationId=null,this.propertySetCopy=null,this.UseSelection=!1,this.Failed=!1,this.StartSelection=null,this.FinalSelection=null,this.IsIncrementalAction=!1,this.IncrementalActionId=null,this.NumberOfIncrements=0,this.CopySource=0,this.Context=t,this.InteractiveView=t.view,this.ActionIdFlags=n,this.ActionData=a,this.OperationTelemetry=i,this.ReportingData=r,this.Failed=!1,this.SelectPastedContent=!1,this.OriginalParagraphFormat=null,this.IsOvertype=!1,this.IsEndOfParagraphLastContext=!1,this.SkipInternalCopy=e.ContextContainsWetChanges(t),this.BrowserName=s,this.UseSelection=u,this.UseVirtualSelection=!1,this.CopySource=0,this.ClipboardOperationId=mt.h.create().toString();var c=o.r(ph.d,a)?a:null;if(c){if(this.propertySetCopy=new Dl.DictionaryPropertySet,this.propertySetCopy.copyProperties(c),c.getValueWithDefault(Boolean,Pl.k.pastingForOvertype,!1)){this.IsOvertype=!0,this.IsEndOfParagraphLastContext=c.getValueWithDefault(Boolean,Pl.k.isEndOfParagraphLastContext,!1),this.OriginalParagraphFormat=l;for(var d=this.InteractiveView.get_selectionManager().get_selectionContextForActionDispatch(),g=void 0;d.get_isContextSet();)d=d.getContext(0);g=d;var p=(0,y.e)(cs.AParagraphNode,g.get_node());if(p){var h=0,_=Ga.ParagraphReader.textLength(p);switch(g.get_contextId()){case ol.d.textRange:h=g.get_cpBegin(),_=g.get_cpEnd();break;case ol.d.endOfParagraph:h=_}this.ReplacedFormatting=vc.FormattingReader.getFirstFormattingObjectAtOrBeforeCp(g.get_node(),h,g.get_ccBoundaryIdxAtCpBegin()),S.ULS.shipAssertTag(6305503,307,!!this.ReplacedFormatting);for(var m=0,f=Ha.HyperlinkReader.getHyperlinksInParagraph(p);m<f.length;m++){var C=f[m];C.cpEnd<=h||C.cpBegin>=_||e.get_HyperlinkEditor().removeHyperlink(g.get_node(),C.hyperlink)}}}this.SelectPastedContent=c.getValueWithDefault(Boolean,Pl.k.selectPastedContent,!1),this.UseVirtualSelection=c.getValueWithDefault(Boolean,Pl.k.useVirtualSelection,!1)}64&n&&(this.SelectPastedContent=!0)}return e.get_ActivityManager=function(){return xr.y.get_instance()},e.get_HyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=Ge.w.get_instance().resolve(Ba.o))},e.ContextContainsWetChanges=function(t){if(t){if(t.get_isContextSet()){for(var n=t,i=0;i<n.get_length();i++)if(e.ContextContainsWetChanges(n.getContext(i)))return!0;return!1}if(o.r(yh.k,t)){var r=t.get_nextContext();return e.ContextContainsWetChanges(r)}var a=t;if(Ga.ParagraphReader.isParagraphNode(a.get_node()))if(a.get_node().get_containsWetChanges())return!0}return!1},e._hyperlinkEditor=null,e}();(0,o.l)(Ch,"9b40d0f0$ClipboardActionArguments",null,[]);var Sh=n(6849),bh=function(){function e(){}return e.logCopyPasteShortcutDialogData=function(t,n,i){if(L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.cutCopyPasteDialog,2),t)S.ULS.sendTraceTag(18617483,307,50,"CopyPasteShortcutDialog showed for paste operation in {0}.",i);else{S.ULS.sendTraceTag(18617484,307,50,"CopyPasteShortcutDialog showed for copy operation in {0}.",i);var r=e.GetSelectedContexts(n);if(1===r.length)S.ULS.sendTraceTag(18425100,307,50,"CopyPasteShortcutDialog showed for copying 1 {0} element in {1}.",Object.getType(r[0].get_node()).getName(),i);else{var o=e.BuildLogEntry(r);S.ULS.sendTraceTag(18425101,307,50,"CopyPasteShortcutDialog showed for copying {0} elements: {1} in {2}.",r.length,o,i)}}},e.logCopyData=function(t){var n=t.BrowserName;if(S.ULS.sendTraceTag(18617485,307,50,"Copy operation in {0}.",n),t.InteractiveView){var i=t.InteractiveView.get_selectionManager(),r=e.GetSelectedContexts(i);if(1===r.length)S.ULS.sendTraceTag(18425102,307,50,"Copy 1 {0} element in {1}.",Object.getType(r[0].get_node()).getName(),n);else{var o=e.BuildLogEntry(r);S.ULS.sendTraceTag(18425103,307,50,"Copy {0} elements: {1} in {2}.",r.length,o,n)}}},e.logPasteData=function(e){var t=e.BrowserName;S.ULS.sendTraceTag(18617486,307,50,"Paste operation in {0}.",t)},e.GetSelectedContexts=function(e){for(var t=e.get_selectionCollection().clone(),n=new Array(0),i=0;i<t.get_length();i++)Array.addRange(n,t.get_item(i).toArray());return n},e.BuildLogEntry=function(e){for(var t={},n="",i=0;i<e.length;i++)t[n=Object.getType(e[i].get_node()).getName()]?t[n]=t[n]+1:t[n]=1;var r="";for(var o in t){var a={key:o,value:t[o]};r+=a.value+" "+a.key+" elements,"}return r=r.substring(0,r.length-1)},e}();(0,o.l)(bh,"cf1dd861$ClipboardTelemetry",null,[]);var vh=function(e){function t(t,n,i,r,a,l,s,u,c,d,g,p,h,_,m,f,C,S,b,v,T,A,I,w,x,E,F){void 0===F&&(F=!0);var P=e.call(this)||this;P._transaction=null,P._childArgs=null,P._operationStage=0,P._context=null,P._actionIdFlags=0,P._interactiveView=null,P._activityManager=null,P._selectionEditor=null,P._browserUtils=null,P._graphTransactionFactory=null,P._cannotCutDialog=null,P._simpleOperationFactory=null,P._operationTelemetry=null,P._telemetry=null,P._useSelection=!1,P._chromeClipboardAccessIsEnabled=!1,P._clipboardOperationContentControlShowPlaceholderProcessor=null,P._clipboardOperationMoveProcessor=null,P._clipboardOperationCutCopyProcessor=null,P._clipboardOperationPasteProcessor=null,P._clipboardOperationClipboardAccessHelper=null,P._clipboardOperationWordStrategy=null,P._trackChangeReader=null,P._trackChangeManager=null,P._undoManager=null,P._pasteFloatieEventSource=null,P._actionFlagsAsText=null,P._selectionContextForDispath=null,P._targetSelections=null,P.init(t),P.setDebugName("ClipboardOperation"),P.initAction(c,n,a,l,s),P._activityManager=d,P._selectionEditor=g,P._browserUtils=p,P._graphTransactionFactory=h,P._clipboardOperationContentControlShowPlaceholderProcessor=_,P._clipboardOperationMoveProcessor=m,P._clipboardOperationCutCopyProcessor=f,P._clipboardOperationPasteProcessor=C,P._clipboardOperationClipboardAccessHelper=S,P._clipboardOperationWordStrategy=b,P._chromeClipboardAccessIsEnabled=u,P._cannotCutDialog=v,P._simpleOperationFactory=T,P._useSelection=F,P._trackChangeReader=A,P._trackChangeManager=I,P._undoManager=w,P._pasteFloatieEventSource=x,P._context=r,P._telemetry=E,s&&o.r(ph.d,s)&&(P._operationTelemetry=(0,y.e)(_h.u,s.getValueWithDefault(Object,Pl.k.clipboardTelemetry,null))),P._operationTelemetry||(P._operationTelemetry=P._telemetry.startMeasurement("ClipboardOperation")),P._actionFlagsAsText=null==i?"NotAvailable":hh(Sh.u,i),P._operationTelemetry.appendOperationFlags(P._actionFlagsAsText.split(", "));var D=P._context;if(!D.view.get_isInteractiveView())return P._activityManager.recordEvent(ah.f.noExecute,{Reason:lh.i.nonInteractiveView}),P._operationTelemetry.fail("Not in interactive view",!0),P.set_response(8),P.Finish(),P;if(P._interactiveView=D.view,!P._interactiveView.get_selectionManager())return P._activityManager.recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),P._operationTelemetry.fail("No selection manager",!1),P.set_response(8),P.Finish(),P;if(P._operationStage=0,P._actionIdFlags=i,P._targetSelections=C.get_pasteTarget(),F&&(!P._targetSelections||!P._targetSelections.get_currentSelection()||!P._targetSelections.get_length()))return P._activityManager.recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),P._operationTelemetry.fail("No selection when one required",!0),P.set_response(8),P.Finish(),P;var R=!!(16&P._actionIdFlags),M=ga.SelectionEditor.isInsertionPointSelection(P._targetSelections.get_currentSelection()),k=!(R&&M),N=P.get_SelectionContextForActionDispatch();return k=b.isClipboardOperationEnabledWithThisSelection(i,N)&&k,1!==P.get_behavior()&&k||(k||P._operationTelemetry.fail("Clipboard operation disabled for selection",!0),P.set_response(k?32:8),P.setIsCompleted()),P}return(0,v.t)(t,e),t.prototype.get_SelectionContextForActionDispatch=function(){return this._selectionContextForDispath||(this._selectionContextForDispath=fa.SelectionManager.buildSectionContext(this._targetSelections)),this._selectionContextForDispath},t.prototype.recycle=function(){e.prototype.recycle.call(this),this._targetSelections=null},t.prototype.run=function(){this._operationStage||this.Setup(),1===this._operationStage&&this.Process(),2===this._operationStage&&this.TeardownSync(),3===this._operationStage&&this.TeardownAsync(),4===this._operationStage&&this.Finish()},t.prototype.Setup=function(){if(256&this._actionIdFlags&&this._chromeClipboardAccessIsEnabled){if(this.get_childOperation()||this._clipboardOperationClipboardAccessHelper.checkSystemClipboardReady(this,this._actionIdFlags,this._actionFlagsAsText),this.get_childOperation().run(),this.get_childOperation().get_inProgress())return;var e=this.get_childOperation().get_operationContext();if(this.clearChildOperation(),!e)return this._operationTelemetry.fail("No access to system clipboard",!0),this.set_response(8),this._operationStage=4,void this.LogCopyPasteShortcutDialogData()}else S.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",this._actionIdFlags,this._actionFlagsAsText,this._browserUtils.get_browserNameForlogging());return 32&this._actionIdFlags&&!this._selectionEditor.isCutAllowed(this._interactiveView.get_selectionManager().get_selectionContextForActionDispatch())?(S.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this._activityManager.recordEvent(ah.f.noExecute,{Reason:lh.i.cutNotAllowed}),this._operationTelemetry.fail("Cut not allowed",!0),this._cannotCutDialog.show(),this.set_response(8),void(this._operationStage=4)):(16&this._actionIdFlags||32&this._actionIdFlags)&&this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&this._trackChangeReader.isSelectionInsideDeletionChange(this._interactiveView.get_selectionManager().get_selectionCollection().get_currentSelection())?(this._operationTelemetry.fail("Selected content deleted in coauthoring",!0),this._trackChangeManager.showDeletedContentSelectedDialog(),this.set_response(8),void(this._operationStage=4)):(4096&this._actionIdFlags&&(this._pasteFloatieEventSource.raisePastedFloatieStatusChangeEvent((0,U.m)(new fh.k,{isFloatieLocked:!0,pasteCommand:this._actionFlagsAsText})),this._undoManager.undo()),this._clipboardOperationWordStrategy.prepareForSetup(this._actionIdFlags),this._transaction=this._graphTransactionFactory.getTransaction(15),this._transaction.setFromNode(this._interactiveView.get_targetNode()),void(this._operationStage=1))},t.prototype.Process=function(){if(!this.get_childOperation()){S.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this._actionIdFlags,this._actionFlagsAsText,this._browserUtils.get_browserNameForlogging()),S.ULS.shipAssertTag(6305507,307,!this._childArgs),this._childArgs=new Ch(this._context,this._actionIdFlags,this._operationTelemetry,this.get_reportingData(),this._actionData,void 0,this._browserUtils.get_browserNameForlogging(),this._useSelection);var e=void 0;e=65536&this._actionIdFlags?o.i(this._clipboardOperationContentControlShowPlaceholderProcessor,this._clipboardOperationContentControlShowPlaceholderProcessor.process,"process"):64&this._actionIdFlags?o.i(this._clipboardOperationMoveProcessor,this._clipboardOperationMoveProcessor.process,"process"):1&this._actionIdFlags?o.i(this._clipboardOperationPasteProcessor,this._clipboardOperationPasteProcessor.process,"process"):o.i(this._clipboardOperationCutCopyProcessor,this._clipboardOperationCutCopyProcessor.process,"process"),16&this._actionIdFlags&&this._interactiveView.get_selectionManager().get_theDelayedSelectionTask().forcePendingTasks(),this._simpleOperationFactory.create(this,e,this._childArgs).setDebugName("ClipboardAction")}S.ULS.shipAssertTag(6305536,307,!!this.get_childOperation()),this.get_childOperation().run(),this.get_childOperation().get_inProgress()||(this.clearChildOperation(),this._operationStage=this.get_isSynchronous()?2:3)},t.prototype.TeardownSync=function(){this._childArgs.IsOvertype&&this._transaction.set_undoActionId(Oi.u.typing),this._childArgs.IsIncrementalAction&&this._transaction.makeIncrementalAction(this._childArgs.IncrementalActionId,this._childArgs.NumberOfIncrements),this._transaction.dispose(),this.set_response(this._childArgs.Failed?8:32),this._operationStage=4},t.prototype.TeardownAsync=function(){if(this.get_childOperation()){if(this.get_childOperation().run(),this.get_childOperation().get_inProgress())return}else if(this._childArgs.IsOvertype&&this._transaction.set_undoActionId(Oi.u.typing),this._transaction.setAsyncOperation(this),this._childArgs.IsIncrementalAction&&this._transaction.makeIncrementalAction(this._childArgs.IncrementalActionId,this._childArgs.NumberOfIncrements),this._transaction.dispose(),this.get_activeChildOperation())return;this.set_response(this._childArgs.Failed?8:32),this._operationStage=4},t.prototype.Finish=function(){this._pasteFloatieEventSource.raisePastedFloatieStatusChangeEvent((0,U.m)(new fh.k,{isFloatieLocked:!1})),this.setIsCompleted(),32===this.get_response()?S.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.get_endTime()-+this.get_startTime(),this._actionIdFlags,this._actionFlagsAsText,this._browserUtils.get_browserNameForlogging()):S.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.get_endTime()-+this.get_startTime(),this._actionIdFlags,this._actionFlagsAsText,this._browserUtils.get_browserNameForlogging()),this._telemetry.endMeasurement(this._operationTelemetry)},t.prototype.LogCopyPasteShortcutDialogData=function(){var e=!!(1&this._actionIdFlags),t=this._context.view;if(t){var n=t.get_selectionManager();bh.logCopyPasteShortcutDialogData(e,n,this._browserUtils.get_browserNameForlogging())}},t}(mh.g);(0,o.l)(vh,"70ba407b$ClipboardOperation",mh.g,[]);var Th=(0,o.y)("11deb2ca$IClipboardOperationContentControlShowPlaceholderProcessor"),Ah=n(7857),Ih=function(){function e(e,t){this._internalClipboard=null,this._clipboardOperationPaste=null,this._contentControlActions=null,this._currentStep=0,this._internalClipboard=e,this._clipboardOperationPaste=t,this._currentStep=0}return e.prototype.process=function(e,t){this._currentStep||(this._contentControlActions=[o.i(this,this.CopyGlossarySelection,"CopyGlossarySelection"),o.i(this._clipboardOperationPaste,this._clipboardOperationPaste.pasteGlossaryPlaceholder,"pasteGlossaryPlaceholder")]);var n=!0;return this._currentStep<this._contentControlActions.length&&(n=this._contentControlActions[this._currentStep++](e,t)),!!n&&this._currentStep<this._contentControlActions.length},e.prototype.CopyGlossarySelection=function(e,t){var n=this,i=t;if(!o.r(ph.d,i.ActionData))return!1;var r=(0,y.e)(ph.d,i.ActionData);if(!r.hasProperty(Pl.k.glossarySelection))return!1;var a=r.getValue(Ah.Selection,Pl.k.glossarySelection),l=i.InteractiveView,s=l.get_selectionManager();return this._internalClipboard.useVirtualClipboardRoot(),s.runAgainstSelectionCollection((function(t){s.setSelection(a,void 0,!0),n._internalClipboard.copySelectionToInternalClipboard(l,e)}),!0),!0},e}();(0,o.l)(Ih,"ad6be803$ClipboardOperationContentControlShowPlaceholderProcessor",null,[Th]);var wh=(0,o.y)("f08949e3$IClipboardOperationCutCopyProcessor"),xh=function(){function e(e){this._clipboardOperationCutCopy=null,this._cutCopyActions=null,this._currentStep=0,this._clipboardOperationCutCopy=e,this._currentStep=-1}return e.prototype.process=function(e,t){-1===this._currentStep&&(this.CutCopyProcessorSetup(e,t),this._currentStep=0);var n=!1;return this._currentStep<this._cutCopyActions.length&&(n=this._cutCopyActions[this._currentStep++](e,t)),!!n&&this._currentStep<this._cutCopyActions.length},e.prototype.CutCopyProcessorSetup=function(e,t){var n=t;if(W.y.get_isMobile()||512&n.ActionIdFlags?(this._cutCopyActions=[o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.copyInternal,"copyInternal")],S.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!e.get_isSynchronous()&&256&n.ActionIdFlags?(this._cutCopyActions=[o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.waitBeforeCopy,"waitBeforeCopy"),o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.copyExternal,"copyExternal"),o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.copyInternal,"copyInternal")],S.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this._cutCopyActions=[o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.copyExternal,"copyExternal"),o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.copyInternal,"copyInternal")],S.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal.")),32&n.ActionIdFlags){var i=o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.deleteForCut,"deleteForCut");this._cutCopyActions.push(i),S.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut.")}return bh.logCopyData(n),!0},e}();(0,o.l)(xh,"2c9483ca$ClipboardOperationCutCopyProcessor",null,[wh]);var Eh=(0,o.y)("c37b31f5$IClipboardOperationMoveProcessor"),Fh=function(){function e(e,t,n,i){this._internalClipboard=null,this._clipboardOperationCutCopy=null,this._clipboardOperationPaste=null,this._selectionManager=null,this._moveActions=null,this._currentStep=0,this._internalClipboard=e,this._selectionManager=t,this._clipboardOperationCutCopy=n,this._clipboardOperationPaste=i,this._currentStep=0}return e.prototype.process=function(e,t){this._currentStep||(this._moveActions=[o.i(this,this.CopyMovedSelection,"CopyMovedSelection"),o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.deleteForCut,"deleteForCut"),o.i(this,this.MoveIp,"MoveIp"),o.i(this._clipboardOperationPaste,this._clipboardOperationPaste.pasteInternal,"pasteInternal"),o.i(this._clipboardOperationPaste,this._clipboardOperationPaste.setSelectionAfterPaste,"setSelectionAfterPaste")]);var n=!0;return this._currentStep<this._moveActions.length&&(n=this._moveActions[this._currentStep++](e,t)),!!n&&this._currentStep<this._moveActions.length},e.prototype.CopyMovedSelection=function(e,t){var n=t.InteractiveView;return this._internalClipboard.useDragDropClipboardRoot(),this._internalClipboard.copySelectionToInternalClipboard(n,e),!0},e.prototype.MoveIp=function(e,t){var n=[t.ActionData],i=new Ah.Selection(n,!0);return this._selectionManager.setSelection(i,e),!0},e}();(0,o.l)(Fh,"7768361c$ClipboardOperationMoveProcessor",null,[Eh]);var Ph=(0,o.y)("db609ff7$IClipboardOperationPasteProcessor"),Dh=function(){function e(e,t,n,i,r,o){this._activityManager=null,this._browserUtils=null,this._clipboardOperationPaste=null,this._htmlImportStrategyLazy=null,this._chromeClipboardAccessIsEnabled=!1,this._chromeClipboardAccessOperationTimeout=0,this._pasteActions=null,this._currentStep=0,this._prepareStartTime=0,this._clipboardAccessHelper=null,this._activityManager=i,this._browserUtils=t,this._clipboardOperationPaste=r,this._htmlImportStrategyLazy=n,this._chromeClipboardAccessIsEnabled=e.getBooleanAppSetting("ChromeClipboardAccessIsEnabled"),this._chromeClipboardAccessOperationTimeout=e.get_appSettings().ChromeClipboardAccessOperationTimeout,this._currentStep=0,this._clipboardAccessHelper=o}return e.prototype.get_pasteTarget=function(){return this._clipboardOperationPaste.get_pasteTarget()},e.prototype.process=function(e,t){return this._currentStep?1===this._currentStep?this.PrepareForPaste(e,t):2===this._currentStep?(this._currentStep=3,this._pasteActions(e,t)):3===this._currentStep&&(this._clipboardOperationPaste.setSelectionAfterPaste(e,t),!1):this.PasteProcessorSetup(e,t)},e.prototype.PasteProcessorSetup=function(e,t){var n=t;return this._browserUtils.get_isMobile()||512&n.ActionIdFlags?(2&n.ActionIdFlags?this._pasteActions=o.i(this._clipboardOperationPaste,this._clipboardOperationPaste.paste,"paste"):this._pasteActions=o.i(this._clipboardOperationPaste,this._clipboardOperationPaste.pasteInternal,"pasteInternal"),this._currentStep=2):(this._chromeClipboardAccessIsEnabled?(this._currentStep=1,this._prepareStartTime=Date.now()):this._currentStep=2,this._pasteActions=o.i(this._clipboardOperationPaste,this._clipboardOperationPaste.paste,"paste")),bh.logPasteData(n),!0},e.prototype.PrepareForPaste=function(e,t){var n=t,i=!0;if(this._htmlImportStrategyLazy.get_value().prepare())this._currentStep=2;else{var r=Date.now()-this._prepareStartTime;r>this._chromeClipboardAccessOperationTimeout&&(S.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",r),this._activityManager.recordEvent(ah.f.failedProcessingStep,{Reason:lh.i.operationTimeout}),n.OperationTelemetry&&n.OperationTelemetry.fail("Prepare for paste timed out",!1),t.Failed=!0,i=!1,this._clipboardAccessHelper.resetSystemClipboard())}return i},e}();(0,o.l)(Dh,"25fc685e$ClipboardOperationPasteProcessor",null,[Ph]);var Rh=function(){function e(e,t,n,i,r,o,a,l,s,u,c,d,g,p,h,_,m,f){this._internalClipboard=null,this._actionManager=null,this._chromeClipboardAccessIsEnabled=!1,this._activityManager=null,this._selectionEditor=null,this._browserUtils=null,this._graphTransactionFactory=null,this._clipboardOperationPasteFactory=null,this._clipboardOperationCutCopyFactory=null,this._clipboardOperationClipboardAccessHelper=null,this._clipboardOperationWordStrategy=null,this._cannotCutDialog=null,this._simpleOperationFactory=null,this._trackChangeReader=null,this._trackChangeManager=null,this._undoManager=null,this._pasteFloatieEventSource=null,this._telemetry=null,this._internalClipboard=e,this._actionManager=t,this._chromeClipboardAccessIsEnabled=n,this._activityManager=i,this._selectionEditor=r,this._browserUtils=o,this._graphTransactionFactory=a,this._clipboardOperationPasteFactory=l,this._clipboardOperationCutCopyFactory=s,this._clipboardOperationClipboardAccessHelper=u,this._clipboardOperationWordStrategy=c,this._cannotCutDialog=d,this._simpleOperationFactory=g,this._trackChangeReader=p,this._trackChangeManager=h,this._undoManager=_,this._pasteFloatieEventSource=m,this._telemetry=f}return e.prototype.create=function(e,t,n,i,r,o,a,l,s){void 0===s&&(s=!0);var u=this._clipboardOperationPasteFactory.create(i,(0,y.e)(ph.d,l)),c=this._clipboardOperationCutCopyFactory.create(),d=new Ih(this._internalClipboard,u),g=new Fh(this._internalClipboard,fa.SelectionManager.get_instance(),c,u),p=new xh(c),h=new Dh(L.AFrameworkApplication.appSettingsManager,$g.k.get_instance(),i,xr.y.get_instance(),u,this._clipboardOperationClipboardAccessHelper);return new vh(e,t,n,r,o,a,l,this._chromeClipboardAccessIsEnabled,this._actionManager,this._activityManager,this._selectionEditor,this._browserUtils,this._graphTransactionFactory,d,g,p,h,this._clipboardOperationClipboardAccessHelper,this._clipboardOperationWordStrategy,this._cannotCutDialog,this._simpleOperationFactory,this._trackChangeReader,this._trackChangeManager,this._undoManager,this._pasteFloatieEventSource,this._telemetry,s)},e}();(0,o.l)(Rh,"3313b38f$Factory",null,[Bd.d]);var Mh=(0,o.y)("cffd2a41$IClipboardOperationPaste"),kh=n(4937),Nh=function(){function e(e,t){this.graphObjectUsageData=null,this.cpUsageData=null,this.chpUsageData=null,this.blobUsageData=null,this.graphObjectUsageData=e.getGraphObjectUsageDataInstance(t),this.cpUsageData=e.getCpUsageDataInstance(t),this.chpUsageData=e.getChpUsageDataInstance(t),this.blobUsageData=e.getBlobUsageDataInstance(t)}return e.getAnInstance=function(t){return e.GetAnInstanceWithResolvedDependencies(t)},e.GetAnInstanceWithResolvedDependencies=function(t){return new e(kh.z.get_instance(),t)},e}();(0,o.l)(Nh,"6a56276a$CpUsageHelper",null,[]);var Lh=function(){function e(e,t,n,i,r,o,a,l,s,u,c,d){this._htmlImportStrategyLazy=null,this._activityManager=null,this._pasteCoordinator=null,this._internalClipboard=null,this._usageEditor=null,this._undoManagerLazy=null,this._selectionManager=null,this._actionManager=null,this._pasteStrategy=null,this._domElementContentStateFactory=null,this._clipboardOperationPasteOvertypeStrategy=null,this._trackChangeManager=null,this._activityManager=e,this._internalClipboard=t,this._pasteCoordinator=n,this._usageEditor=i,this._selectionManager=r,this._actionManager=o,this._htmlImportStrategyLazy=a,this._undoManagerLazy=s,this._pasteStrategy=l,this._domElementContentStateFactory=u,this._clipboardOperationPasteOvertypeStrategy=c,this._trackChangeManager=d}return e.prototype.get_UndoManager=function(){return this._undoManagerLazy.get_value()},e.prototype.get_UsageEditor=function(){return this._usageEditor},e.prototype.get_ActivityManager=function(){return this._activityManager},e.prototype.get_pasteTarget=function(){return this._pasteStrategy.get_pasteTarget()},e.prototype.paste=function(e,t){var n=this,i=this._trackChangeManager.beginUntrackedChangeCapture();try{var r,a=t,l=a.InteractiveView,s=a.ActionIdFlags;if(S.ULS.shipAssertTag(18131010,307,!!(1&s)),o.r(ph.d,a.ActionData)&&a.ActionData.setValue(ep.p.editContainerWidth,l.get_editingDom().get_editingElement().clientWidth),this._clipboardOperationPasteOvertypeStrategy.tryStoreOriginalFormat(e,t),!this._htmlImportStrategyLazy.get_value().tryGetContentDom((0,g.m)((function(){return r}),(function(e){return r=e}))))return a.OperationTelemetry&&a.OperationTelemetry.fail("HTML import strategy failed",!1),a.Failed=!0,!1;this.get_UndoManager().interruptUndoMerging();var u=!0,c=null,d=this._domElementContentStateFactory.create(r),p=a.UseSelection;return l.get_selectionManager().runAgainstSelectionCollection((function(e){p&&2===n._actionManager.processAction(Oi.u.deleteForReplace,2)?u=!1:(c=p?n._selectionManager.get_selectionCollection().get_currentSelection().get_firstContext():a.ActionData,S.ULS.shipAssertTag(18158338,307,ga.SelectionEditor.isInsertionPointContext(c)),n.LogMetricsForGraphLocation(c,"paste"))}),this._pasteStrategy.get_isPasteToVirtualSelection()),u?(l.get_editingView().disable(!0,25),d.restore(),this._pasteCoordinator.PasteAtIp(r,c,e),!0):!1}finally{i&&i.dispose()}},e.prototype.pasteGlossaryPlaceholder=function(e,t){this.get_UndoManager().interruptUndoMerging();var n=(new td.b).getTransaction(15);n.setFromNode(this._internalClipboard.get_theClipboardRoot());var i=t,r=(0,y.e)(ph.d,i.ActionData).getValue(Wa.y,Pl.k.glossaryInsertionIPContext);return S.ULS.shipAssertTag(20492440,307,ga.SelectionEditor.isInsertionPointContext(r)),this._pasteCoordinator.InternalPasteAtIp(r,e),this._internalClipboard.clearInternalData(),n.dispose(),!0},e.prototype.pasteInternal=function(e,t){this.get_UndoManager().interruptUndoMerging(),this._actionManager.processAction(Oi.u.deleteForReplace,2);var n=this._selectionManager.get_selectionCollection().get_currentSelection().get_firstContext();return S.ULS.shipAssertTag(18158339,307,ga.SelectionEditor.isInsertionPointContext(n)),this.LogMetricsForGraphLocation(n,"intPaste"),this._pasteCoordinator.InternalPasteAtIp(n,e),!0},e.prototype.LogMetricsForGraphLocation=function(e,t){var n=Nh.getAnInstance(t);this.get_UsageEditor().recordCpMetrics(n,e.get_node(),e.get_cpBegin()),this.get_UsageEditor().logCpUsageData(n.cpUsageData),this.get_UsageEditor().logGraphObjectUsageData(n.graphObjectUsageData),this.get_UsageEditor().logChpUsageData(n.chpUsageData),this.get_UsageEditor().logBlobUsageData(n.blobUsageData)},e.prototype.setSelectionAfterPaste=function(e,t){var n=t;return!!n.UseSelection&&(64&n.ActionIdFlags&&this._internalClipboard.useUserClipboardRoot(),n.FinalSelection?(this._pasteStrategy.updatedSelectionAfterPaste(n),this.get_UndoManager().interruptUndoMerging(),!1):(S.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.get_ActivityManager().recordEvent(ah.f.unexpectedState,{Reason:lh.i.invalidSelection}),n.OperationTelemetry&&n.OperationTelemetry.fail("No selection after paste",!1),n.Failed=!0,!1))},e}();(0,o.l)(Lh,"873b6a68$ClipboardOperationPaste",null,[Mh]);var Bh=function(){function e(e,t,n,i,r,o,a,l,s,u,c){this._activityManager=null,this._pasteCoordinator=null,this._internalClipboard=null,this._usageEditor=null,this._selectionManager=null,this._actionManager=null,this._undoManagerLazy=null,this._pasteStrategyFactory=null,this._domElementContentStateFactory=null,this._clipboardOperationPasteOvertypeStrategy=null,this._trackChangeManager=null,this._activityManager=e,this._internalClipboard=t,this._pasteCoordinator=n,this._usageEditor=i,this._selectionManager=r,this._actionManager=o,this._undoManagerLazy=l,this._pasteStrategyFactory=a,this._domElementContentStateFactory=s,this._clipboardOperationPasteOvertypeStrategy=u,this._trackChangeManager=c}return e.prototype.create=function(e,t){var n=this._pasteStrategyFactory.create(this._selectionManager,t);return new Lh(this._activityManager,this._internalClipboard,this._pasteCoordinator,this._usageEditor,this._selectionManager,this._actionManager,e,n,this._undoManagerLazy,this._domElementContentStateFactory,this._clipboardOperationPasteOvertypeStrategy,this._trackChangeManager)},e}();(0,o.l)(Bh,"b748da9c$Factory",null,[ng]);var Oh=function(){function e(e,t){this._stylePropertySet=null,this._paragraphFormattingData=null,this._stylePropertySet=e,this._paragraphFormattingData=t}return e.prototype.get_stylePropertySet=function(){return this._stylePropertySet},e.prototype.get_pargraphFormattingData=function(){return this._paragraphFormattingData},e}();(0,o.l)(Oh,"723dd0dd$ParagraphFormatStore",null,[]);var Uh=function(){function e(e,t,n,i){this._selectionManager=null,this._paragraphReader=null,this._styleReader=null,this._isStyleEnabled=!1,this._selectionManager=e,this._paragraphReader=t,this._styleReader=n,this._isStyleEnabled=i}return e.prototype.tryStoreOriginalFormat=function(e,t){if(t.IsOvertype&&this._isStyleEnabled){var n=e.get_operationContext(),i=this._selectionManager.get_selectionCollection().get_currentSelection().get_firstContext().get_node(),r=null;if(this._paragraphReader.isParagraphNode(i)){var o=this._styleReader.getStyleFromParagraphNode(i),a=this._paragraphReader.getParagraphProperties(i);r=new Oh(o,a)}n=new Ch(n.Context,n.ActionIdFlags,n.OperationTelemetry,n.ReportingData,n.ActionData,r),e.set_operationContext(n)}},e}();(0,o.l)(Uh,"6ae8e05$ClipboardOperationPasteOvertypeStrategy",null,[Qd]);var Hh=(0,o.y)("341dd240$IVirtualSelectionMerger"),Gh=(0,o.y)("39bba3fa$IClipboardOperationPasteStrategy"),Wh=function(){function e(e){var t=this;this._selectionManager=null,this._liveSelectionRecord=null,this._selectionManager=e,e.runAgainstSelectionCollection((function(e){t._liveSelectionRecord=e}),!1)}return e.prototype.get_isPasteToVirtualSelection=function(){return!1},e.prototype.updatedSelectionAfterPaste=function(e){var t=this.adjustSelectionAfterPaste(e);this.setSelection(this._selectionManager,t)},e.prototype.adjustSelectionAfterPaste=function(e){var t=e.FinalSelection;return(e.UseVirtualSelection||e.SelectPastedContent)&&e.StartSelection&&(t=Ua.SelectionFactory.extendSelection(e.StartSelection,t.get_firstContext())),t},e.prototype.setSelection=function(e,t){e.setSelection(t)},e}();(0,o.l)(Wh,"4bad9cf2$AClipboardOperationPasteStrategy",null,[Gh]);var Vh=function(e){function t(t){return e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.get_pasteTarget=function(){return this._liveSelectionRecord},t}(Wh);(0,o.l)(Vh,"2db79fde$ClipboardOperationPasteToLiveSelectionStrategy",Wh,[]);var $h=function(e){function t(t,n){var i=e.call(this,t)||this;return i._merger=null,i._virtualSelectionRecord=null,i._merger=n,t.runAgainstSelectionCollection((function(e){i._virtualSelectionRecord=e}),!0),i}return(0,v.t)(t,e),t.prototype.get_isPasteToVirtualSelection=function(){return!0},t.prototype.get_pasteTarget=function(){return this._virtualSelectionRecord},t.prototype.adjustSelectionAfterPaste=function(t){var n=e.prototype.adjustSelectionAfterPaste.call(this,t);return t.ActionData.setValue(Pl.k.pasteToVirtualSelectionIntermidiateResult,n),n=this._merger.getMergedSelection(this._liveSelectionRecord.get_currentSelection(),this._virtualSelectionRecord.get_currentSelection(),n)},t}(Wh);(0,o.l)($h,"aa58f7c9$ClipboardOperationPasteToVirtualSelectionStrategy",Wh,[]);var zh=function(){function e(e){this._virtualSelectionEnabled=!1,this._merger=null,this._virtualSelectionEnabled=e.getBooleanAppSetting("EnableVirtualSelectionInSelectionManager")}return e.prototype.create=function(e,t){return!!t&&t.getValueWithDefault(Boolean,Pl.k.useVirtualSelection,!1)&&this._virtualSelectionEnabled?new $h(e,this.get_VirtualSelectionMerger()):new Vh(e)},e.prototype.get_VirtualSelectionMerger=function(){return this._merger||(this._merger=Ge.w.get_instance().tryResolve(Hh)),this._merger},e}();(0,o.l)(zh,"a7a65487$ClipboardOperationPasteStrategyFactory",null,[ig]);var Kh=function(){function e(e,t,n,i,r,o){this._selectionManager=null,this._coauthManager=null,this._lockedRangeEditor=null,this._activityManager=null,this._isLockedRangeEnabled=!1,this._isWordCoauthEnabled=!1,this._activityManager=e,this._selectionManager=t,this._coauthManager=n,this._lockedRangeEditor=i,this._isLockedRangeEnabled=r,this._isWordCoauthEnabled=o}return e.prototype.prepareForSetup=function(e){this._isWordCoauthEnabled&&(1&e||32&e)&&this._coauthManager.get_isCoauthorable()&&this._selectionManager.acquireLocksForSelection()},e.prototype.isClipboardOperationEnabledWithThisSelection=function(e,t){return!this._isLockedRangeEnabled||(!(1&e&&this._lockedRangeEditor.contextSetContainsLockedRange(t,!0))||(this._activityManager.recordEvent(ah.f.noExecute,{Reason:lh.i.containsLockedRange}),!1))},e}();(0,o.l)(Kh,"f95d730e$ClipboardOperationWordStrategy",null,[]);var qh=function(){function e(e){this._cssConverterFidelityImprovementIsEnabled=!1,this._cssConverterFidelityImprovementIsEnabled=e.getBooleanAppSetting("CssConverterFidelityImprovementIsEnabledIsEnabled")}return e.prototype.convertStyleDomToInlineStyle=function(e,t){if(t){var n=t.sheet;if(n){var i=n.cssRules;if(i){var r=Array.clone(i);L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordCssConverterFidelityImprovementIsEnabledSettings"),this._cssConverterFidelityImprovementIsEnabled&&r.reverse();for(var o=0,a=0,l=0,s=0,u=0,c=r;u<c.length;u++){var d=c[u],g=d.style,p=d.selectorText,h=g?g.cssText:null,_=p?p.split(","):null;if(h&&_&&d.type===d.STYLE_RULE){s+=_.length;for(var m=0,f=_;m<f.length;m++){var y=f[m];y.indexOf("#")>=0&&o++,y.indexOf(".")>=0&&a++,y.indexOf("#")<0&&y.indexOf(".")<0&&l++;var C=null;try{C=e.querySelectorAll(y)}catch(e){S.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",y,e.message)}if(C)for(var b=0;b<C.length;b++)C[b].setAttribute("style",h+(C[b].getAttribute("style")||""))}}}S.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",s,o,a,l)}else this.LogStyleSheetPropertiesUnavailable("cssRules")}else this.LogStyleSheetPropertiesUnavailable("sheet")}},e.prototype.LogStyleSheetPropertiesUnavailable=function(e){S.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",W.y.get_browserNameForlogging())},e}();(0,o.l)(qh,"bc92382f$ExternalPasteCssConverter",null,[yg]);var jh=n(3898),Qh=(0,o.y)("55a3a744$ISingleLevelListEditor"),Jh=n(5566),Xh=(0,o.y)("5d549a23$IPastedParagraphSpaceHandler"),Yh=n(3367),Zh=n(184),e_=n(8661),t_=n(8950),n_=function(){return function(){this.value=!1,this.value=!1}}();(0,o.l)(n_,"70fef1a5$OutBool",null,[]);var i_=function(){function e(e){this._originNode=null,this._targetNode=null,this._originalIterator=null,this._childRoles=null,this._childNodes=null,this._childIndices=null,this._itemFilter=null,this._filterData=null,this._targetNode=e.get_currentNode();var t=new ha.g;t.setFrom(e),this._originalIterator=new ha.g,this._originalIterator.setFrom(e),this._originNode=t.get_origin(),this._childIndices=new Array(t.get_depth()),this._childRoles=new Array(t.get_depth()),this._childNodes=new Array(t.get_depth());for(var n=t.get_depth()-1;n>=0;--n){var i=t.get_currentNode();this._childRoles[n]=t.get_role(),this._childNodes[n]=i,t.returnToParent(),this._childIndices[n]=t.getChildIndexByRole(i,this._childRoles[n])}}return e.prototype.SetFilter=function(e,t){this._itemFilter=e,this._filterData=t},e.prototype.restore=function(e){var t=new n_,n=new n_;return this.RestoreDetailed(e,t,n),n.value},e.prototype.RestoreDetailed=function(e,t,n){if(t.value=!0,this._originalIterator.get_isValid())return e.setFrom(this._originalIterator),void(n.value=!1);for(var i=this._childNodes.length-1;i>=0;--i){var r=this._childNodes[i];if(r.get_anchor()&&!r.get_anchor().get_isRetired()&&(e.set(r),e.tryToRootAtAncestor(this._originNode)||this._originNode.get_IsGraphRoot()&&e.tryToRootAtMainGraphRoot()))return n.value=this.ExtendDownward(e,i+1),void e.get_isValid();t.value=!1}e.set(this._originNode),n.value=this.ExtendDownward(e,0)},e.prototype.ExtendDownward=function(e,t){var n,i,r=!1;if(n=this._childIndices[t],i=this._childRoles[t],n<e.getChildCountByRole(i))e.goToChildIndexByRole(n,i);else if(r=!0,!e.goToLastChildByRole(i))return!0;if(!this.MoveToClosestNodeWithFilter(e,i))return r;for(var o=t+1;o<this._childIndices.length;++o){if(r){if(!e.goToLastChildByRole(this._childRoles[o]))return!0}else if(!e.goToFirstChildByRole(this._childRoles[o]))return!1;if(!this.MoveToClosestNodeWithFilter(e,this._childRoles[o]))return r}return r},e.prototype.MoveToClosestNodeWithFilter=function(e,t){if(this._itemFilter&&!this._itemFilter(e,this._filterData)){var n=new ha.g;n.setFrom(e);var i=!0;do{if(!e.goToNextSiblingByRole(t)){i=!1;break}}while(!this._itemFilter(e,this._filterData));if(!i){e.setFrom(n);do{if(!e.goToPreviousSiblingByRole(t))return e.returnToParent(),!1}while(!this._itemFilter(e,this._filterData))}}return!0},e}();(0,o.l)(i_,"464c748a$NodeReference",null,[]);var r_=n(4440),o_=function(){function e(e,t,n,i,r){this._pageContentEditor=null,this._styleEditor=null,this._paragraphEditor=null,this._contentControlCopyPasteHelper=null,this._listReader=null,this._listEditor=null,this._workspace=null,this._singleLevelListEditor=null,this.ipContext=null,this.topMostSelectableNode=null,this.precedingNodeRef=null,this.followingNodeRef=null,this.parentArgs=null,this.transaction=null,this._trackChangeEditor=null,this._trackChangeReader=null,this._trackChangeManager=null,this._changeIdEditor=null,this._pastedParagraphSpaceHandler=null,this._renderOrderGraphIteratorFactory=null,this.ipContext=e,this.precedingNodeRef=null,this.followingNodeRef=null,this.parentArgs=t,this.transaction=n,this._contentControlCopyPasteHelper=i,this._workspace=r}return e.prototype.get_AppSettingsManager=function(){return L.AFrameworkApplication.appSettingsManager},e.prototype.get_StyleEditor=function(){return this._styleEditor||(this._styleEditor=Ge.w.get_instance().resolve(ts.e))},e.prototype.get_ParagraphEditor=function(){return this._paragraphEditor||(this._paragraphEditor=Ge.w.get_instance().resolve(ns.g))},e.prototype.get_PageContentEditor=function(){return this._pageContentEditor||(this._pageContentEditor=Ge.w.get_instance().resolve(jh.m))},e.prototype.get_OutlineEditor=function(){return e._outlineEditor||(e._outlineEditor=Ge.w.get_instance().resolve(zl.a))},e.prototype.get_ListReader=function(){return this._listReader||(this._listReader=Ge.w.get_instance().resolve(Ql.c))},e.prototype.get_ListEditor=function(){return this._listEditor||(this._listEditor=Ge.w.get_instance().resolve(jl.v))},e.prototype.get_SingleLevelListEditor=function(){return this._singleLevelListEditor||(this._singleLevelListEditor=Ge.w.get_instance().tryResolve(Qh))},e.prototype.get_TrackChangeEditor=function(){return this._trackChangeEditor||(this._trackChangeEditor=Ge.w.get_instance().resolve(es.x).get_instance())},e.prototype.get_TrackChangeReader=function(){return this._trackChangeReader||(this._trackChangeReader=Ge.w.get_instance().resolve(Ta.p).get_instance())},e.prototype.get_TrackChangeManager=function(){return this._trackChangeManager||(this._trackChangeManager=Ge.w.get_instance().resolve(xa.b).get_instance())},e.prototype.get_ChangeIdEditor=function(){return this._changeIdEditor||(this._changeIdEditor=Ge.w.get_instance().resolve(Jh.p))},e.prototype.get_PastedParagraphSpaceHandler=function(){return this._pastedParagraphSpaceHandler||(this._pastedParagraphSpaceHandler=Ge.w.get_instance().tryResolve(Xh))},e.prototype.set_PastedParagraphSpaceHandler=function(e){return this._pastedParagraphSpaceHandler=e,e},e.prototype.get_RenderOrderGraphIteratorFactory=function(){return this._renderOrderGraphIteratorFactory||(this._renderOrderGraphIteratorFactory=Ge.w.get_instance().tryResolve(qd))},e.prototype.set_RenderOrderGraphIteratorFactory=function(e){return this._renderOrderGraphIteratorFactory=e,e},e.prototype.get_pastingOutlines=function(){return!1},e.prototype.get_shouldGetPasteConstrainingWidth=function(){return this.get_AppSettingsManager().getBooleanAppSetting("WordEditorAutoResizeImageIsEnabled")},e.prototype.executePasteOfOutlines=function(e,t){},e.prototype.PasteSetup=function(e,t){var n=void 0===this.parentArgs.ActionIdFlags||null===this.parentArgs.ActionIdFlags?"not available":hh(Sh.u,this.parentArgs.ActionIdFlags);if(S.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.parentArgs.ActionIdFlags,n),S.ULS.shipAssertTag(6305487,307,ga.SelectionEditor.isInsertionPointContext(this.ipContext)),this.get_nothingToPaste())return S.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.parentArgs.FinalSelection=Ua.SelectionFactory.createSelectionFromContext(this.ipContext),e.changeStepCallback(o.i(this,this.PasteTeardown,"PasteTeardown")),!0;var i=new ha.g;if(i.set(this.ipContext.get_node()),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(i),_s.OutlineElementNavigator.returnToOutlineElement(i),this.topMostSelectableNode=i.get_origin(),this.get_pastingOutlines())return i.returnToNodeOfType(10),this.executePasteOfOutlines(i,e),e.changeStepCallback(o.i(this,this.SetSelectionAfterPastingOutlines,"SetSelectionAfterPastingOutlines")),!0;if(Qs.q.isInTitle(i)){if(this.get_isContentSingleParagraph())return this.parentArgs.FinalSelection=this.PastePlainText(this.ipContext,this.get_contentAsText()),e.changeStepCallback(o.i(this,this.PasteTeardown,"PasteTeardown")),!0;var r=this.MoveFromTitleToDocument(i);this.ipContext=r.get_item(0)}this._contentControlCopyPasteHelper&&this._contentControlCopyPasteHelper.onBeforeSplit(this.ipContext),this.SplitLine(this.ipContext);var a=new r_.z;return a.setFrom(i),_s.OutlineElementNavigator.moveToNextOutlineElement(a,!1,!1),this.precedingNodeRef=new i_(i),this.followingNodeRef=new i_(a),e.changeStepCallback(o.i(this,this.PasteExecution,"PasteExecution")),!0},e.prototype.PasteExecution=function(e,t){Dr.t.mark(5568),this.executePaste(e);var n=o.i(this,this.MergeAfterPaste,"MergeAfterPaste");if(this.get_isMergeFixEnabled()){var i=this.shouldSkipMergeAfterPaste();i&&(n=o.i(this,this.PasteTeardown,"PasteTeardown")),S.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",i)}return e.changeStepCallback(n),!0},e.prototype.shouldSkipMergeAfterPaste=function(){return!1},e.prototype.get_isMergeFixEnabled=function(){return this.get_AppSettingsManager().getBooleanAppSetting("PptCcpFix2IsEnabled")},e.prototype.get_shouldGetSingleOEFixEnable=function(){return this.get_AppSettingsManager().getBooleanAppSetting("CopyAndPasteOneParagraphIndentationFixIsEnabled")},e.prototype.MergeAfterPaste=function(t,n){Dr.t.mark(5569);var i=new ha.g;this.precedingNodeRef.restore(i),this.precedingNodeRef=null;var r=new ha.g;this.followingNodeRef.restore(r),this.followingNodeRef=null,S.ULS.shipAssertTag(6305489,307,Ss.OutlineElementReader.isOutlineElement(i)),S.ULS.shipAssertTag(6305490,307,Ss.OutlineElementReader.isOutlineElement(r)),_s.OutlineElementNavigator.moveToContent(i);var a=Ga.ParagraphReader.isParagraph(i)?Ga.ParagraphReader.textLength(i.get_currentNode()):0;_s.OutlineElementNavigator.returnToOutlineElement(i),_s.OutlineElementNavigator.moveToContent(r),S.ULS.shipAssertTag(6305491,307,Ga.ParagraphReader.isParagraph(r));var l,s=Ga.ParagraphReader.textLength(r.get_currentNode());_s.OutlineElementNavigator.returnToOutlineElement(r);var u,c=this.get_shouldMergeAfterContent(),d=new r_.z;d.setFrom(i),_s.OutlineElementNavigator.moveToNextOutlineElement(d,!1,!1);var p=d.get_currentNode()===r.get_currentNode(),h=!!this.parentArgs&&!!(8192&this.parentArgs.ActionIdFlags),_=!1;if(!h&&this.parentArgs.ActionData&&o.r(Dl.DictionaryPropertySet,this.parentArgs.ActionData)&&2===yi.App.get_mode()){var m=this.parentArgs.ActionData.getProperty_Unchecked(Pl.k.pastedPlainTextContent);h=!(!m||""===m)}if(p){var f=ha.g.createFromNode(i.get_currentNode());if(Ga.ParagraphReader.canContainIpOrTextRange(_s.OutlineElementNavigator.moveToContent(f))||(i=r),i.get_currentNode().get_id()!==r.get_currentNode().get_id()){S.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",gs.ListReader.isListOutlineElement(i),gs.ListReader.isListOutlineElement(r));var y=e.get_OutlineElementEditor().merge(i,r,!0,h);S.ULS.shipAssertTag(6305492,307,y)}l=i,u=!0}else{var C=!!(4&this.parentArgs.ActionIdFlags),b=this.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&this.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()&&C&&this.parentArgs.IsEndOfParagraphLastContext;this.get_PastedParagraphSpaceHandler()&&this.parentArgs&&2===yi.App.get_mode()&&!C&&(this.get_PastedParagraphSpaceHandler().handleSpacesAroundPastedContent(i,!1),this.get_PastedParagraphSpaceHandler().handleSpacesAroundPastedContent(r,!0)),_s.OutlineElementNavigator.moveToContent(d);var v=Ga.ParagraphReader.isParagraph(d)?Ga.ParagraphReader.textLength(d.get_currentNode()):0;if(_s.OutlineElementNavigator.returnToOutlineElement(d),this.ApplyTrackChangesOnPastedNode(d,i,r),this.get_ChangeIdEditor().get_catchUpActivityIsEnabled()||this.get_shouldGetSingleOEFixEnable())if((x=new r_.z).setFrom(d),_s.OutlineElementNavigator.moveToNextOutlineElement(x,!1,!1),x.get_currentINode().get_id()!==r.get_currentINode().get_id()){for(;d.get_currentNode().get_id()!==r.get_currentNode().get_id();)_s.OutlineElementNavigator.moveToContent(d,!1),this.get_ChangeIdEditor().setChangeIdOnContext(Wa.y.create(d.get_currentNode())),d.returnToParent(),_s.OutlineElementNavigator.moveToNextOutlineElement(d,!1,!1);d.setFrom(i),_s.OutlineElementNavigator.moveToNextOutlineElement(d,!1,!1)}else _=!0;if(this._contentControlCopyPasteHelper&&this._contentControlCopyPasteHelper.processPastedContentsInMergeAfterPaste(i,r,(0,g.m)((function(){return c}),(function(e){return c=e})),(0,g.m)((function(){return d}),(function(e){return d=e}))),this.parentArgs.ReplacedFormatting){S.ULS.shipAssertTag(6305493,307,this.parentArgs.IsOvertype);var T=new ha.g;T.setFrom(d);var A=_s.OutlineElementNavigator.moveToContent(T);if(A){var I=this.parentArgs.ReplacedFormatting.cloneUnderDifferentChp(A.get_characterProperties().get_item(0));A.get_characterProperties().get_item(0).set_formatting(I)}}var w=void 0;if(gs.ListReader.isListOutlineElement(i)?(e.get_listSettings().isSingleLevelListImprovementEnabled&&this.get_SingleLevelListEditor()&&this.get_SingleLevelListEditor().inflateSingleLevelListIfNeeded(i),w=!gs.ListReader.isListOutlineElement(d)||this.get_shouldMergePastedListIntoList()):Ss.OutlineElementReader.isEmpty(i,!0)?(e.get_OutlineElementEditor().disconnectOutlineElement(i),w=!1):w=gs.ListReader.get_isListMarkerEnabled()||!gs.ListReader.isListOutlineElement(d),this._contentControlCopyPasteHelper&&(w=this._contentControlCopyPasteHelper.checkShouldMergeBeforeContent(i,w)),this.parentArgs.StartSelection=null,(this.parentArgs.SelectPastedContent||this.parentArgs.UseVirtualSelection)&&(this.parentArgs.StartSelection=this.GetStartSelection(w?i.get_currentNode():d.get_currentNode(),w)),w){var x,E=gs.ListReader.isListOutlineElement(i);if(S.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",E,gs.ListReader.isListOutlineElement(r)),e.get_OutlineElementEditor().merge(i,d,!0,h,r,void 0,_,b),gs.ListReader.isListOutlineElement(i))if(this.get_ListReader().get_qoEListInternalCCPImprovementIsEnabled())if((x=new r_.z).setFrom(i),_s.OutlineElementNavigator.moveToNextOutlineElement(x,!1,!1),x.get_currentINode().get_id()!==r.get_currentINode().get_id()){var F=this.get_ListReader().getListInfo(i);this.get_ListReader().moveToList(i);var P=i.get_currentNode().getValueWithDefault(Number,os.j.listID,0);for(i.returnToParent(),F.set_restartAt(Zh.z.startAtNone);x.get_currentNode().get_id()!==r.get_currentNode().get_id();){if(gs.ListReader.isListOutlineElement(x)){if(E){var D=this.get_ListReader().getListLevelInfoFromListNode(x),R=this.get_ListReader().getListPropertiesFromIdLevel(i.get_currentNode(),P,D),M=R?e_.j.createFromExistingPropertySet(R,null):F,k=e_.j.createFromScratch(M.get_listType(),F.get_listStyle(),null,0,D,"","");k.oeToJoin=i.get_currentNode(),this.get_ListEditor().setPendingListInfo(k),this.get_ListEditor().setListInfoAndIndentAfterPaste(x,!0)}}else this.get_ListEditor().applyBulletsNumbering(F.get_propertySet(),x,(0,g.m)((function(){return F}),(function(e){return F=e})));_s.OutlineElementNavigator.moveToNextOutlineElement(x,!1,!1)}}}if(c){var N=new r_.z;N.setFrom(r),_s.OutlineElementNavigator.moveToPreviousOutlineElement(N,!1,!1),S.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}",gs.ListReader.isListOutlineElement(N),gs.ListReader.isListOutlineElement(r)),l=(y=e.get_OutlineElementEditor().merge(N,r,!0,h,void 0,!0,void 0,b))?N:r,u=y}else l=r,u=!1;if(this.get_ChangeIdEditor().get_catchUpActivityIsEnabled()&&_)if(w){var L=new ha.g;L.setFrom(i);var B=_s.OutlineElementNavigator.moveToContent(L);this.get_ChangeIdEditor().setChangeIdOnTextRange(B,a,a+v)}else if(c){var O=new ha.g;O.setFrom(d);var U=_s.OutlineElementNavigator.moveToContent(O);this.get_ChangeIdEditor().setChangeIdOnTextRange(U,0,v)}else{var H=new ha.g;H.setFrom(d);var G=_s.OutlineElementNavigator.moveToContent(H);this.get_ChangeIdEditor().setChangeIdOnContext(Wa.y.create(G))}}S.ULS.shipAssertTag(6305494,307,l.get_isValid());var W=_s.OutlineElementNavigator.moveToContent(l),V=u?Ga.ParagraphReader.textLength(W)-s:0,$=!1;if(o.r(ph.d,this.parentArgs.ActionData)&&($=this.parentArgs.ActionData.getValueWithDefault(Boolean,Pl.k.isImageInsertion,!1)),$&&Gl.n.get_instance().get_item(11)?this.parentArgs.FinalSelection=Ua.SelectionFactory.createTextRangeOrIpSelection(W,V-1,V):this.parentArgs.FinalSelection=Ua.SelectionFactory.createIpSelection(W,V),Gl.n.get_instance().get_item(71)&&this.parentArgs&&this.parentArgs.IsOvertype&&Ga.ParagraphReader.isParagraphNode(W)&&this.parentArgs.OriginalParagraphFormat){var z=this.parentArgs.OriginalParagraphFormat.get_stylePropertySet();z&&this.get_StyleEditor().setStyleOnParagraphNode(z,W,!0);var K=this.parentArgs.OriginalParagraphFormat.get_pargraphFormattingData();K&&this.get_ParagraphEditor().applyParagraphProperties(W,K)}return t.changeStepCallback(o.i(this,this.PasteTeardown,"PasteTeardown")),!0},e.prototype.ApplyTrackChangesOnPastedNode=function(t,n,i){var r=!1;if(this.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&this.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()){var o=!1;if(this._contentControlCopyPasteHelper){var a=n.get_currentNode();o=this._contentControlCopyPasteHelper.isPastedInBlockContentControl(a)||this._contentControlCopyPasteHelper.isPastedInInlineContentControl(a)}o?this.get_TrackChangeManager().set_pendingUntrackedChangeAlert(1):r=!0}if(r){for(var l=function(){_s.OutlineElementNavigator.moveToContent(t,!1);var n,i=s.get_TrackChangeReader().splitAndSortTrackableContexts(Wa.y.create(t.get_currentNode()));i.getUntrackedChangeType((0,g.m)((function(){return n}),(function(e){return n=e})))&&s.get_TrackChangeManager().alertUntrackedChange(n);for(var r=function(t){var n,r=i.getContext(t,(0,g.m)((function(){return n}),(function(e){return n=e})));n&&(e.get_HyperlinkEditor().normalizeHyperlinksinGraphNodeContext(r,1),s.get_TrackChangeEditor().setTrackChangeOnContext(r,1,null,!0))},o=0;o<i.get_length();o++)r(o);t.returnToParent(),_s.OutlineElementNavigator.moveToNextOutlineElement(t,!1,!1)},s=this;t.get_currentNode()!==i.get_currentNode();)l();t.setFrom(n),_s.OutlineElementNavigator.moveToNextOutlineElement(t,!1,!1)}},e.prototype.GetStartSelection=function(e,t){var n=ha.g.createFromNode(e);if(_s.OutlineElementNavigator.moveToContent(n),Ga.ParagraphReader.isParagraphNode(n.get_currentNode())){var i=t?Ga.ParagraphReader.textLength(n.get_currentNode()):0;return Ua.SelectionFactory.createIpSelection(n.get_currentNode(),i)}return us.TableReader.isTableNode(n.get_currentNode())?Ua.SelectionFactory.createSelectionFromNode(n.get_currentNode()):null},e.prototype.SetSelectionAfterPastingOutlines=function(e,t){var n=ha.g.createFromNode(this.topMostSelectableNode);return n.goToLastChildByRole(1),this.parentArgs.FinalSelection=Ua.SelectionFactory.createCollapsedSelection(n.get_currentNode(),!1),e.changeStepCallback(o.i(this,this.PasteTeardown,"PasteTeardown")),!0},e.prototype.PasteTeardown=function(e,t){var n=void 0===this.parentArgs.ActionIdFlags||null===this.parentArgs.ActionIdFlags?"not available":hh(Sh.u,this.parentArgs.ActionIdFlags);S.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.parentArgs.ActionIdFlags,n),S.ULS.shipAssertTag(6305497,307,!!this.parentArgs.FinalSelection),this.transaction.dispose();var i=this._workspace.get_activeView();if(!i.get_isInteractiveView())return!1;var r=i;return!!r.get_editingView().get_isContentEditableView()&&(r.get_editingView().tearDownForPasteAction(),!1)},e.prototype.ShouldCopyWordIdDuringSplitAtEndOfParagraphOnPaste=function(t,n){if(!e.get_featureHelper())return!1;if(e.get_featureHelper().logUniqueFeatureUsage(36),!e.get_featureHelper().isFeatureEnabled(36))return!1;var i=new ha.g;i.setFrom(t);var r=_s.OutlineElementNavigator.moveToContent(i),o=Ga.ParagraphReader.isParagraphNode(r)&&n===Ga.ParagraphReader.textLength(r);return S.ULS.sendTraceTag(50384992,307,50,"ShouldCopyWordIdDuringSplitAtEndParagraphOnPaste feature is enabled. isPasteAtEndofParagraph: {0}",o),o},e.prototype.SplitLine=function(t){S.ULS.shipAssertTag(6305498,307,ga.SelectionEditor.isInsertionPointContext(t));var n=ha.g.createFromNode(t.get_node()),i=n.tryToRootAtOutlineAncestor();_s.OutlineElementNavigator.returnToOutlineElement(n);var r=t.get_node().get_type();S.ULS.sendTraceTag(40425481,307,50,"sourceOE GraphIterator setup. {0}",{tryToRootAtOutlineAncestorSuccess:i,ipContextNodeType:r});var o=e.get_OutlineElementEditor().insertOutlineElementBelow(n,!0),a=this.ShouldCopyWordIdDuringSplitAtEndOfParagraphOnPaste(n,t.get_cpBegin());e.get_OutlineElementEditor().splitAtIp(n,o,t,!1,!1,!0,a)},e.prototype.PastePlainText=function(t,n){S.ULS.shipAssertTag(6305500,307,t.get_contextId()===ol.d.insertionPoint);var i=t.get_node();return n=n.replace(Rn.l.get__lineBreakRegExp()," "),e.get_CharacterPropertiesEditor().replaceTextRange(t,n),Ua.SelectionFactory.createIpSelection(i,t.get_cpBegin()+n.length)},e.prototype.MoveFromTitleToDocument=function(t){t.tryToRootAtPageContent(),e.get_PageNavigator().returnToPageContent(t);var n=e.get_PageReader().getOutlineCount(t),i=this.get_PageContentEditor().createOutline(t);return n?qs.v.setMuPosition(t.get_currentNode(),n+1,n+2):this.get_OutlineEditor().setOutlineToDefaultPosition(i,yi.App.get_activeAppFrame().workspace.get_contentView().getViewWidth()),this.get_OutlineEditor().insertOutlineElementAsChild(t,null,!0),Ua.SelectionFactory.createCollapsedSelection(t.get_currentNode(),!0)},e.get_PageNavigator=function(){return Ii.PageNavigator.get_instance()},e.get_CharacterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=Ge.w.get_instance().resolve(ba.x))},e.get_HyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=Ge.w.get_instance().resolve(Ba.o))},e.get_PageReader=function(){return $s.PageReader.get_instance()},e.get_OutlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=Ge.w.get_instance().resolve(ql.p))},e.get_listSettings=function(){return e._listSettings||(e._listSettings=Ge.w.get_instance().tryResolve(t_.r))},e.get_featureHelper=function(){return e._featureHelper||(e._featureHelper=Ge.w.get_instance().tryResolve(Yh.d))},e._outlineEditor=null,e._featureHelper=null,e._outlineElementEditor=null,e._characterPropertiesEditor=null,e._hyperlinkEditor=null,e._listSettings=null,e}();(0,o.l)(o_,"2b50d4d1$APasteExecutionManager",null,[]);var a_=n(4631),l_=function(){function e(){this.actionIdFlags=0,this.foundDataCcpTimestampAttribute=!1,this.foundDataClipserviceCcpidAttribute=!1,this.foundDataShapeIdsAttribute=!1,this.foundGoogleDocsInternalGuidId=!1,this.foundOneNoteOnlineSequenceClass=!1,this.foundPowerPointOnlineSequenceClass=!1,this.foundWordOnlineSequenceClass=!1,this.progId=null,this.foundText=!1,this.foundEquation=!1,this.foundList=!1,this.foundTable=!1,this.foundImage=!1,this.pasteBrowser=0,this.pastedHtmlLength=0,this.platform=null,this.operationId=null,this._htmlTagStyleMap=null,this.copySourceBrowser=6,this._htmlTagStyleMap={}}return e.prototype.logHtmlContentMetadata=function(){var e=this.BuildHtmlContentMetadataDictForLogging();S.ULS.sendTraceTag(51406241,307,50,JSON.stringify(e))},e.prototype.logHtmlContentStyledata=function(){var e=this._htmlTagStyleMap;for(var t in e){var n={key:t,value:e[t]},i=n.value;i&&(i.SourceApp=this.getSourceApp(),i.Browser=a_.h[this.pasteBrowser],i.TagName=n.key,i.OperationId=this.operationId,S.ULS.sendTraceTag(51406242,307,50,JSON.stringify(i)))}},e.prototype.incrementStyleCountForTag=function(e,t){if(e&&e.length&&t&&t.length){e=e.toLowerCase(),t=t.toLowerCase(),e in this._htmlTagStyleMap||(this._htmlTagStyleMap[e]={});var n=this._htmlTagStyleMap[e],i=this.getStyleCountForTag(e,t);n[t]=i+1}},e.prototype.getStyleCountForTag=function(e,t){if(!(e&&e.length&&t&&t.length&&this._htmlTagStyleMap&&e in this._htmlTagStyleMap))return 0;e=e.toLowerCase(),t=t.toLowerCase();var n=this._htmlTagStyleMap[e];return n&&t in n?n[t]:0},e.prototype.BuildHtmlContentMetadataDictForLogging=function(){var e={};return e.ActionIdFlags=this.actionIdFlags,e.FoundDataCcpTimestampAttribute=this.foundDataCcpTimestampAttribute,e.FoundDataClipserviceCcpidAttribute=this.foundDataClipserviceCcpidAttribute,e.FoundDataShapeIdsAttribute=this.foundDataShapeIdsAttribute,e.FoundGoogleDocsInternalGuidId=this.foundGoogleDocsInternalGuidId,e.FoundOneNoteOnlineSequenceClass=this.foundOneNoteOnlineSequenceClass,e.FoundPowerPointOnlineSequenceClass=this.foundPowerPointOnlineSequenceClass,e.FoundWordOnlineSequenceClass=this.foundWordOnlineSequenceClass,e.ProgId=this.progId,e.SourceApp=this.getSourceApp(),e.FoundText=this.foundText,e.FoundEquation=this.foundEquation,e.FoundList=this.foundList,e.FoundTable=this.foundTable,e.FoundImage=this.foundImage,e.CopySourceBrowser=this.copySourceBrowser,e.PasteBrowser=this.pasteBrowser,e.IsSameBrowserPaste=this.IsSameBrowserPaste(this.copySourceBrowser,this.pasteBrowser),e.IsCrossBrowserPaste=this.IsCrossBrowserPaste(this.copySourceBrowser,this.pasteBrowser),e.IsUncategorizedBrowserPaste=this.IsUncategorizedBrowserPaste(this.copySourceBrowser,this.pasteBrowser),e.Platform=this.platform,e.PastedHtmlLength=this.pastedHtmlLength,e.OperationId=this.operationId,e},e.prototype.getSourceApp=function(){switch(this.progId){case"Word.Document":return"Word";case"OneNote.File":return"OneNote";case"Excel.Sheet":return"Excel";case"PowerPoint.Slide":return"PowerPoint"}return this.foundWordOnlineSequenceClass?"Word Online":this.foundGoogleDocsInternalGuidId?"Google Docs":this.foundPowerPointOnlineSequenceClass||this.foundDataClipserviceCcpidAttribute||this.foundDataShapeIdsAttribute?"PowerPoint Online":this.foundDataCcpTimestampAttribute?"Excel Online":"Other"},e.prototype.IsSameBrowserPaste=function(e,t){return 5!==e&&6!==e&&e===t},e.prototype.IsCrossBrowserPaste=function(e,t){return 6!==e&&e!==t},e.prototype.IsUncategorizedBrowserPaste=function(e,t){return 5===e&&5===t},e}();(0,o.l)(l_,"f44c4fa3$HtmlContentMetadata",null,[]);var s_=function(){function e(e,t,n){void 0===n&&(n=!1),this.domElement=null,this.htmlElementInfoFromHierarchy=null,this.applyAbsolutePosition=!1,this.domElement=e,this.htmlElementInfoFromHierarchy=t,this.applyAbsolutePosition=n}return e.prototype.get_domElement=function(){return this.domElement},e.prototype.get_htmlElementInfoFromHierarchy=function(){return this.htmlElementInfoFromHierarchy},e.prototype.get_applyAbsolutePosition=function(){return this.applyAbsolutePosition},e}();(0,o.l)(s_,"b801568d$TagEventParam",null,[]);var u_=function(){function e(e,t){void 0===t&&(t=null),this._translator=null,this._voidElements=null,this._transparentTags=null,this._prunedElements=null,this._domElementHandlers=null,this.usageData=null,this._translator=e,this.set_usageData(t||Zp.z.getHtmlProcessorUsageDataInstance("")),this.setUpTagDictionaries()}return e.prototype.get_usageData=function(){return this.usageData},e.prototype.set_usageData=function(e){return this.usageData=e,e},e.prototype.registerNewTag=function(e){e=Rn.l.toUpper(e),this._transparentTags[e]?delete this._transparentTags[e]:this._prunedElements[e]?delete this._prunedElements[e]:this._domElementHandlers[e]=o.i(this._translator,this._translator.onUnknownOpen,"onUnknownOpen")},e.prototype.notifyVoidElement=function(e,t,n,i){if(this._transparentTags[t])this.NotifyTransparentElement();else{this.get_usageData().e++;var r=this._domElementHandlers[t];r&&r(new s_(e,n,i)),this.get_usageData().b++}},e.prototype.NotifyTransparentElement=function(){this.get_usageData().d++},e.prototype.notifyPrunedElement=function(){this.get_usageData().c++},e.prototype.notifyElementOpen=function(e,t,n,i){if(this._transparentTags[t])this.NotifyTransparentElement();else{var r=this._domElementHandlers[t];if(r)return this.get_usageData().b++,r(new s_(e,n,i));this.get_usageData().f++}return 2},e.prototype.setUpTagDictionaries=function(){this._voidElements=P.j.toDictionary("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0),this._transparentTags=P.j.toDictionary("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0),this._prunedElements=P.j.toDictionary("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0),this._domElementHandlers=P.j.toDictionary("A",o.i(this._translator,this._translator.onAOpen,"onAOpen"),"ABBR",o.i(this._translator,this._translator.onAbbrOpen,"onAbbrOpen"),"ACRONYM",o.i(this._translator,this._translator.onAcronymOpen,"onAcronymOpen"),"ADDRESS",o.i(this._translator,this._translator.onAddressOpen,"onAddressOpen"),"APPLET",o.i(this._translator,this._translator.onAppletOpen,"onAppletOpen"),"AREA",o.i(this._translator,this._translator.onAreaTag,"onAreaTag"),"B",o.i(this._translator,this._translator.onBOpen,"onBOpen"),"BASE",o.i(this._translator,this._translator.onBaseTag,"onBaseTag"),"BASEFONT",o.i(this._translator,this._translator.onBasefontTag,"onBasefontTag"),"BDO",o.i(this._translator,this._translator.onBdoOpen,"onBdoOpen"),"BIG",o.i(this._translator,this._translator.onBigOpen,"onBigOpen"),"BLOCKQUOTE",o.i(this._translator,this._translator.onBlockquoteOpen,"onBlockquoteOpen"),"BODY",o.i(this._translator,this._translator.onBodyOpen,"onBodyOpen"),"BR",o.i(this._translator,this._translator.onBrTag,"onBrTag"),"BUTTON",o.i(this._translator,this._translator.onButtonOpen,"onButtonOpen"),"CAPTION",o.i(this._translator,this._translator.onCaptionOpen,"onCaptionOpen"),"CENTER",o.i(this._translator,this._translator.onCenterOpen,"onCenterOpen"),"CITE",o.i(this._translator,this._translator.onCiteOpen,"onCiteOpen"),"CODE",o.i(this._translator,this._translator.onCodeOpen,"onCodeOpen"),"COL",o.i(this._translator,this._translator.onColTag,"onColTag"),"COLGROUP",o.i(this._translator,this._translator.onColgroupOpen,"onColgroupOpen"),"DD",o.i(this._translator,this._translator.onDdOpen,"onDdOpen"),"DEL",o.i(this._translator,this._translator.onDelOpen,"onDelOpen"),"DFN",o.i(this._translator,this._translator.onDfnOpen,"onDfnOpen"),"DIR",o.i(this._translator,this._translator.onDirOpen,"onDirOpen"),"DIV",o.i(this._translator,this._translator.onDivOpen,"onDivOpen"),"DL",o.i(this._translator,this._translator.onDlOpen,"onDlOpen"),"DT",o.i(this._translator,this._translator.onDtOpen,"onDtOpen"),"EM",o.i(this._translator,this._translator.onEmOpen,"onEmOpen"),"FIELDSET",o.i(this._translator,this._translator.onFieldsetOpen,"onFieldsetOpen"),"FONT",o.i(this._translator,this._translator.onFontOpen,"onFontOpen"),"FORM",o.i(this._translator,this._translator.onFormOpen,"onFormOpen"),"FRAME",o.i(this._translator,this._translator.onFrameTag,"onFrameTag"),"FRAMESET",o.i(this._translator,this._translator.onFramesetOpen,"onFramesetOpen"),"H1",o.i(this._translator,this._translator.onH1Open,"onH1Open"),"H2",o.i(this._translator,this._translator.onH2Open,"onH2Open"),"H3",o.i(this._translator,this._translator.onH3Open,"onH3Open"),"H4",o.i(this._translator,this._translator.onH4Open,"onH4Open"),"H5",o.i(this._translator,this._translator.onH5Open,"onH5Open"),"H6",o.i(this._translator,this._translator.onH6Open,"onH6Open"),"HEAD",o.i(this._translator,this._translator.onHeadOpen,"onHeadOpen"),"HR",o.i(this._translator,this._translator.onHrTag,"onHrTag"),"HTML",o.i(this._translator,this._translator.onHtmlOpen,"onHtmlOpen"),"I",o.i(this._translator,this._translator.onIOpen,"onIOpen"),"IFRAME",o.i(this._translator,this._translator.onIframeOpen,"onIframeOpen"),"IMG",o.i(this._translator,this._translator.onImgTag,"onImgTag"),"INPUT",o.i(this._translator,this._translator.onInputTag,"onInputTag"),"INS",o.i(this._translator,this._translator.onInsOpen,"onInsOpen"),"ISINDEX",o.i(this._translator,this._translator.onIsindexOpen,"onIsindexOpen"),"KBD",o.i(this._translator,this._translator.onKbdOpen,"onKbdOpen"),"LABEL",o.i(this._translator,this._translator.onLabelOpen,"onLabelOpen"),"LEGEND",o.i(this._translator,this._translator.onLegendOpen,"onLegendOpen"),"LI",o.i(this._translator,this._translator.onLiOpen,"onLiOpen"),"LINK",o.i(this._translator,this._translator.onLinkTag,"onLinkTag"),"MAP",o.i(this._translator,this._translator.onMapOpen,"onMapOpen"),"MATH",o.i(this._translator,this._translator.onMathOpen,"onMathOpen"),"MENU",o.i(this._translator,this._translator.onMenuOpen,"onMenuOpen"),"META",o.i(this._translator,this._translator.onMetaTag,"onMetaTag"),"NOFRAMES",o.i(this._translator,this._translator.onNoframesOpen,"onNoframesOpen"),"NOSCRIPT",o.i(this._translator,this._translator.onNoscriptOpen,"onNoscriptOpen"),"OBJECT",o.i(this._translator,this._translator.onObjectOpen,"onObjectOpen"),"OL",o.i(this._translator,this._translator.onOlOpen,"onOlOpen"),"OPTGROUP",o.i(this._translator,this._translator.onOptgroupOpen,"onOptgroupOpen"),"OPTION",o.i(this._translator,this._translator.onOptionOpen,"onOptionOpen"),"P",o.i(this._translator,this._translator.onPOpen,"onPOpen"),"PARAM",o.i(this._translator,this._translator.onParamTag,"onParamTag"),"PRE",o.i(this._translator,this._translator.onPreOpen,"onPreOpen"),"Q",o.i(this._translator,this._translator.onQOpen,"onQOpen"),"S",o.i(this._translator,this._translator.onSOpen,"onSOpen"),"SAMP",o.i(this._translator,this._translator.onSampOpen,"onSampOpen"),"SCRIPT",o.i(this._translator,this._translator.onScriptOpen,"onScriptOpen"),"SELECT",o.i(this._translator,this._translator.onSelectOpen,"onSelectOpen"),"SMALL",o.i(this._translator,this._translator.onSmallOpen,"onSmallOpen"),"SPAN",o.i(this._translator,this._translator.onSpanOpen,"onSpanOpen"),"STRIKE",o.i(this._translator,this._translator.onStrikeOpen,"onStrikeOpen"),"STRONG",o.i(this._translator,this._translator.onStrongOpen,"onStrongOpen"),"STYLE",o.i(this._translator,this._translator.onStyleOpen,"onStyleOpen"),"SUB",o.i(this._translator,this._translator.onSubOpen,"onSubOpen"),"SUP",o.i(this._translator,this._translator.onSupOpen,"onSupOpen"),"TABLE",o.i(this._translator,this._translator.onTableOpen,"onTableOpen"),"TBODY",o.i(this._translator,this._translator.onTbodyOpen,"onTbodyOpen"),"TD",o.i(this._translator,this._translator.onTdOpen,"onTdOpen"),"TEXTAREA",o.i(this._translator,this._translator.onTextareaOpen,"onTextareaOpen"),"TFOOT",o.i(this._translator,this._translator.onTfootOpen,"onTfootOpen"),"TH",o.i(this._translator,this._translator.onThOpen,"onThOpen"),"THEAD",o.i(this._translator,this._translator.onTheadOpen,"onTheadOpen"),"TITLE",o.i(this._translator,this._translator.onTitleOpen,"onTitleOpen"),"TR",o.i(this._translator,this._translator.onTrOpen,"onTrOpen"),"TT",o.i(this._translator,this._translator.onTtOpen,"onTtOpen"),"U",o.i(this._translator,this._translator.onUOpen,"onUOpen"),"UL",o.i(this._translator,this._translator.onUlOpen,"onUlOpen"),"VAR",o.i(this._translator,this._translator.onVarOpen,"onVarOpen"))},e}();(0,o.l)(u_,"2ed84bd6$AHtmlProcessor",null,[]);var c_=function(){return function(e,t){this.ChildNodes=null,this.HtmlElementInfoFromHierarchy=null,this.CurrentChildIndex=0,this.IsCurrentChildClosing=!1,this.ChildNodes=e.childNodes,this.HtmlElementInfoFromHierarchy=t,this.CurrentChildIndex=0,this.IsCurrentChildClosing=!1}}();(0,o.l)(c_,"233eb4fe$HtmlProcessorArguments",null,[]);var d_=function(e){function t(t,n){void 0===n&&(n=null);var i=this;return i._isPasteTextFromWordWin32FixEnabled=null,i=e.call(this,t,n)||this}return(0,v.t)(t,e),t.prototype.get_IsPasteTextFromWordWin32FixEnabled=function(){return null==this._isPasteTextFromWordWin32FixEnabled&&(L.AFrameworkApplication.appSettingsManager?this._isPasteTextFromWordWin32FixEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CopyAndPasteTextFromWordWin32FixIsEnabled"):this._isPasteTextFromWordWin32FixEnabled=!1),this._isPasteTextFromWordWin32FixEnabled},t.prototype.process=function(e,t){void 0===t&&(t=null),e&&(this._translator.reset(),this.ProcessChildren(new c_(e,new Xg(Dp)),t))},t.prototype.ProcessChildren=function(e,t){if(e.ChildNodes.length){var n=new vp.a(t,o.i(this,this.ProcessChild,"ProcessChild"),e);n.setDebugName("HTML Processing Operation"),t||n.set_isSynchronous(!0),n.run()}},t.prototype.ProcessChild=function(e,n){var i=n,r=i.ChildNodes[i.CurrentChildIndex];if(r.nodeType===bp.o.text)return this._translator.onBeforeNewElement(),this._translator.onText(r.nodeValue,new s_(r,i.HtmlElementInfoFromHierarchy.getCopy())),t.TryToMoveToNextSibling(i);if(r.nodeType!==bp.o.element)return t.TryToMoveToNextSibling(i);if(!i.IsCurrentChildClosing){var o=Rn.l.toUpper(r.tagName);if(t.HasBeenProcessed(r));else if(this._prunedElements[o])this.notifyPrunedElement();else{t.MarkAsAlreadyProcessed(r),this._translator.onBeforeNewElement();var a=r.id,l=r.tagName,s=i.HtmlElementInfoFromHierarchy.getCopy(),u=r.getAttribute?r.getAttribute("class"):null,c=r.attributes?r.attributes.length:0,d=new Dp(a,l,u||"",c);if(d.get_isValid()&&s.add(d),this._voidElements[o])return this.notifyVoidElement(r,o,s,!1),t.TryToMoveToNextSibling(i);var g=!1;switch(this.notifyElementOpen(r,o,s,!1)){case 1:g=!0;break;case 3:return t.TryToMoveToNextSibling(i)}switch(this._translator.handleCommonAttributes(r)){case 1:g=!0}if(i.IsCurrentChildClosing=g,this.ProcessChildren(new c_(r,s),e),!e.get_isSynchronous())return!0}}if(i.IsCurrentChildClosing){if(this.get_IsPasteTextFromWordWin32FixEnabled()&&!this._domElementHandlers[Rn.l.toUpper(r.tagName)])return t.TryToMoveToNextSibling(i);this._translator.onClose()}return t.TryToMoveToNextSibling(i)},t.MarkAsAlreadyProcessed=function(e){e.nodeType!==bp.o.text&&th.q.setObject(e,"alreadyPasted",!0)},t.HasBeenProcessed=function(e){return e.nodeType!==bp.o.text&&th.q.getObject(e,"alreadyPasted")},t.TryToMoveToNextSibling=function(e){return e.CurrentChildIndex++,e.IsCurrentChildClosing=!1,e.CurrentChildIndex<e.ChildNodes.length},t}(u_);(0,o.l)(d_,"478832be$HtmlProcessor",u_,[]);var g_=function(){function e(){}return e.dataCcpTimestampAttribute="data-ccp-timestamp",e.dataClipserviceCcpidAttribute="data-clipservice-ccpid",e.dataShapeIdsAttribute="data-shapeids",e.googleDocsInternalGuidIdPrefix="docs-internal-guid-",e.oneNoteOnlineSequenceClassPrefix="SCXO",e.powerPointOnlineSequenceClassPrefix="SCXP",e.wordOnlineSequenceClassPrefix="SCXW",e.msoListFirstParagraphClass="MsoListParagraphCxSpFirst",e.msoListLastParagraphClass="MsoListParagraphCxSpLast",e}();(0,o.l)(g_,"519dcd2e$HtmlContentMetadataConstants",null,[]);var p_=function(){function e(e,t,n,i){void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),this._nextAcceptor=null,this._shouldParseStyleForHtmlTagEventIsEnabled=!1,this.usageData=null,this.contentMetadata=null,this._nextAcceptor=e,this.usageData=t||Zp.z.getHtmlEventUsageDataInstance(W.y.get_browserCodeForLogging(),""),this.contentMetadata=n,this._shouldParseStyleForHtmlTagEventIsEnabled=!!i&&i.getBooleanAppSetting("ParseStyleForHtmlTagEventIsEnabled")}return e.prototype.get_usageData=function(){return this.usageData},e.prototype.get_contentMetadata=function(){return this.contentMetadata},e.prototype.Increment=function(e){return e?e+1:1},e.prototype.reset=function(){this._nextAcceptor.reset()},e.prototype.onBeforeNewElement=function(){this._nextAcceptor.onBeforeNewElement()},e.prototype.handleCommonAttributes=function(e){if(e&&this.get_contentMetadata()){if(e.getAttribute&&(e.getAttribute(g_.dataCcpTimestampAttribute)&&(this.get_contentMetadata().foundDataCcpTimestampAttribute=!0),e.getAttribute(g_.dataClipserviceCcpidAttribute)&&(this.get_contentMetadata().foundDataClipserviceCcpidAttribute=!0),e.getAttribute(g_.dataShapeIdsAttribute)&&(this.get_contentMetadata().foundDataShapeIdsAttribute=!0)),e.id&&e.id.startsWith&&e.id.startsWith(g_.googleDocsInternalGuidIdPrefix)&&(this.get_contentMetadata().foundGoogleDocsInternalGuidId=!0),e.className&&e.className.split)for(var t=0,n=e.className.split(" ");t<n.length;t++){var i=n[t];if(i.startsWith(g_.oneNoteOnlineSequenceClassPrefix)&&(this.get_contentMetadata().foundOneNoteOnlineSequenceClass=!0),i.startsWith(g_.powerPointOnlineSequenceClassPrefix)&&(this.get_contentMetadata().foundPowerPointOnlineSequenceClass=!0),i.startsWith(g_.wordOnlineSequenceClassPrefix)&&(this.get_contentMetadata().foundWordOnlineSequenceClass=!0),i.startsWith(W.y.browserCodePrefix)&&i.length===W.y.browserCodePrefix.length+1){var r=parseInt(Rn.l.substring(i,i.length-1,i.length));isNaN(r)||(this.get_contentMetadata().copySourceBrowser=r)}i!==g_.msoListFirstParagraphClass&&i!==g_.msoListLastParagraphClass||(this.get_contentMetadata().foundList=!0)}this.get_usageData().b=this.get_contentMetadata().getSourceApp()}return this._nextAcceptor.handleCommonAttributes(e)},e.prototype.onClose=function(){this._nextAcceptor.onClose()},e.prototype.onText=function(e,t){this.get_contentMetadata()&&(this.get_contentMetadata().foundText=!0),this.get_usageData().d=this.Increment(this.get_usageData().d),this._shouldParseStyleForHtmlTagEventIsEnabled&&this.ParseStyleUsageForTag(t),this._nextAcceptor.onText(e,t)},e.prototype.onAOpen=function(e){return this.get_usageData().e=this.Increment(this.get_usageData().e),this._nextAcceptor.onAOpen(e)},e.prototype.onAbbrOpen=function(e){return this.get_usageData().f=this.Increment(this.get_usageData().f),this._nextAcceptor.onAbbrOpen(e)},e.prototype.onAcronymOpen=function(e){return this.get_usageData().g=this.Increment(this.get_usageData().g),this._nextAcceptor.onAcronymOpen(e)},e.prototype.onAddressOpen=function(e){return this.get_usageData().h=this.Increment(this.get_usageData().h),this._nextAcceptor.onAddressOpen(e)},e.prototype.onAppletOpen=function(e){return this.get_usageData().i=this.Increment(this.get_usageData().i),this._nextAcceptor.onAppletOpen(e)},e.prototype.onAreaTag=function(e){this.get_usageData().j=this.Increment(this.get_usageData().j),this._nextAcceptor.onAreaTag(e)},e.prototype.onBOpen=function(e){return this.get_usageData().k=this.Increment(this.get_usageData().k),this._nextAcceptor.onBOpen(e)},e.prototype.onBaseTag=function(e){this.get_usageData().l=this.Increment(this.get_usageData().l),this._nextAcceptor.onBaseTag(e)},e.prototype.onBasefontTag=function(e){this.get_usageData().m=this.Increment(this.get_usageData().m),this._nextAcceptor.onBasefontTag(e)},e.prototype.onBdoOpen=function(e){return this.get_usageData().n=this.Increment(this.get_usageData().n),this._nextAcceptor.onBdoOpen(e)},e.prototype.onBigOpen=function(e){return this.get_usageData().o=this.Increment(this.get_usageData().o),this._nextAcceptor.onBigOpen(e)},e.prototype.onBlockquoteOpen=function(e){return this.get_usageData().p=this.Increment(this.get_usageData().p),this._nextAcceptor.onBlockquoteOpen(e)},e.prototype.onBodyOpen=function(e){return this.get_usageData().q=this.Increment(this.get_usageData().q),this._nextAcceptor.onBodyOpen(e)},e.prototype.onBrTag=function(e){this.get_usageData().r=this.Increment(this.get_usageData().r),this._nextAcceptor.onBrTag(e)},e.prototype.onButtonOpen=function(e){return this.get_usageData().s=this.Increment(this.get_usageData().s),this._nextAcceptor.onButtonOpen(e)},e.prototype.onCaptionOpen=function(e){return this.get_usageData().t=this.Increment(this.get_usageData().t),this._nextAcceptor.onCaptionOpen(e)},e.prototype.onCenterOpen=function(e){return this.get_usageData().u=this.Increment(this.get_usageData().u),this._nextAcceptor.onCenterOpen(e)},e.prototype.onCiteOpen=function(e){return this.get_usageData().v=this.Increment(this.get_usageData().v),this._nextAcceptor.onCiteOpen(e)},e.prototype.onCodeOpen=function(e){return this.get_usageData().w=this.Increment(this.get_usageData().w),this._nextAcceptor.onCodeOpen(e)},e.prototype.onColTag=function(e){this.get_usageData().x=this.Increment(this.get_usageData().x),this._nextAcceptor.onColTag(e)},e.prototype.onColgroupOpen=function(e){return this.get_usageData().y=this.Increment(this.get_usageData().y),this._nextAcceptor.onColgroupOpen(e)},e.prototype.onDdOpen=function(e){return this.get_usageData().z=this.Increment(this.get_usageData().z),this._nextAcceptor.onDdOpen(e)},e.prototype.onDelOpen=function(e){return this.get_usageData().ba=this.Increment(this.get_usageData().ba),this._nextAcceptor.onDelOpen(e)},e.prototype.onDfnOpen=function(e){return this.get_usageData().bb=this.Increment(this.get_usageData().bb),this._nextAcceptor.onDfnOpen(e)},e.prototype.onDirOpen=function(e){return this.get_usageData().bc=this.Increment(this.get_usageData().bc),this._nextAcceptor.onDirOpen(e)},e.prototype.onDivOpen=function(e){return this.get_usageData().bd=this.Increment(this.get_usageData().bd),this._nextAcceptor.onDivOpen(e)},e.prototype.onDlOpen=function(e){return this.get_usageData().be=this.Increment(this.get_usageData().be),this._nextAcceptor.onDlOpen(e)},e.prototype.onDtOpen=function(e){return this.get_usageData().bf=this.Increment(this.get_usageData().bf),this._nextAcceptor.onDtOpen(e)},e.prototype.onEmOpen=function(e){return this.get_usageData().bg=this.Increment(this.get_usageData().bg),this._nextAcceptor.onEmOpen(e)},e.prototype.onFieldsetOpen=function(e){return this.get_usageData().bh=this.Increment(this.get_usageData().bh),this._nextAcceptor.onFieldsetOpen(e)},e.prototype.onFontOpen=function(e){return this.get_usageData().bi=this.Increment(this.get_usageData().bi),this._nextAcceptor.onFontOpen(e)},e.prototype.onFormOpen=function(e){return this.get_usageData().bj=this.Increment(this.get_usageData().bj),this._nextAcceptor.onFormOpen(e)},e.prototype.onFrameTag=function(e){this.get_usageData().bk=this.Increment(this.get_usageData().bk),this._nextAcceptor.onFrameTag(e)},e.prototype.onFramesetOpen=function(e){return this.get_usageData().bl=this.Increment(this.get_usageData().bl),this._nextAcceptor.onFramesetOpen(e)},e.prototype.onH1Open=function(e){return this.get_usageData().bm=this.Increment(this.get_usageData().bm),this._nextAcceptor.onH1Open(e)},e.prototype.onH2Open=function(e){return this.get_usageData().bm=this.Increment(this.get_usageData().bm),this._nextAcceptor.onH2Open(e)},e.prototype.onH3Open=function(e){return this.get_usageData().bm=this.Increment(this.get_usageData().bm),this._nextAcceptor.onH3Open(e)},e.prototype.onH4Open=function(e){return this.get_usageData().bm=this.Increment(this.get_usageData().bm),this._nextAcceptor.onH4Open(e)},e.prototype.onH5Open=function(e){return this.get_usageData().bm=this.Increment(this.get_usageData().bm),this._nextAcceptor.onH5Open(e)},e.prototype.onH6Open=function(e){return this.get_usageData().bm=this.Increment(this.get_usageData().bm),this._nextAcceptor.onH6Open(e)},e.prototype.onHeadOpen=function(e){return this.get_usageData().bn=this.Increment(this.get_usageData().bn),this._nextAcceptor.onHeadOpen(e)},e.prototype.onHrTag=function(e){this.get_usageData().bo=this.Increment(this.get_usageData().bo),this._nextAcceptor.onHrTag(e)},e.prototype.onHtmlOpen=function(e){return this.get_usageData().bp=this.Increment(this.get_usageData().bp),this._nextAcceptor.onHtmlOpen(e)},e.prototype.onIOpen=function(e){return this.get_usageData().bq=this.Increment(this.get_usageData().bq),this._nextAcceptor.onIOpen(e)},e.prototype.onIframeOpen=function(e){return this.get_usageData().br=this.Increment(this.get_usageData().br),this._nextAcceptor.onIframeOpen(e)},e.prototype.onImgTag=function(e){this.get_contentMetadata()&&(this.get_contentMetadata().foundImage=!0),this.get_usageData().bs=this.Increment(this.get_usageData().bs),this._nextAcceptor.onImgTag(e)},e.prototype.onInputTag=function(e){this.get_usageData().bt=this.Increment(this.get_usageData().bt),this._nextAcceptor.onInputTag(e)},e.prototype.onInsOpen=function(e){return this.get_usageData().bu=this.Increment(this.get_usageData().bu),this._nextAcceptor.onInsOpen(e)},e.prototype.onIsindexOpen=function(e){return this.get_usageData().bv=this.Increment(this.get_usageData().bv),this._nextAcceptor.onIsindexOpen(e)},e.prototype.onKbdOpen=function(e){return this.get_usageData().bw=this.Increment(this.get_usageData().bw),this._nextAcceptor.onKbdOpen(e)},e.prototype.onLabelOpen=function(e){return this.get_usageData().bx=this.Increment(this.get_usageData().bx),this._nextAcceptor.onLabelOpen(e)},e.prototype.onLegendOpen=function(e){return this.get_usageData().by=this.Increment(this.get_usageData().by),this._nextAcceptor.onLegendOpen(e)},e.prototype.onLiOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundList=!0),this.get_usageData().bz=this.Increment(this.get_usageData().bz),this._shouldParseStyleForHtmlTagEventIsEnabled&&this.ParseStyleUsageForTag(e),this._nextAcceptor.onLiOpen(e)},e.prototype.onLinkTag=function(e){this.get_usageData().ca=this.Increment(this.get_usageData().ca),this._nextAcceptor.onLinkTag(e)},e.prototype.onMapOpen=function(e){return this.get_usageData().cb=this.Increment(this.get_usageData().cb),this._nextAcceptor.onMapOpen(e)},e.prototype.onMathOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundEquation=!0),this.get_usageData().cc=this.Increment(this.get_usageData().cc),this._nextAcceptor.onMathOpen(e)},e.prototype.onMenuOpen=function(e){return this.get_usageData().cd=this.Increment(this.get_usageData().cd),this._nextAcceptor.onMenuOpen(e)},e.prototype.onMetaTag=function(e){this.get_usageData().ce=this.Increment(this.get_usageData().ce),this._nextAcceptor.onMetaTag(e)},e.prototype.onNoframesOpen=function(e){return this.get_usageData().cf=this.Increment(this.get_usageData().cf),this._nextAcceptor.onNoframesOpen(e)},e.prototype.onNoscriptOpen=function(e){return this.get_usageData().cg=this.Increment(this.get_usageData().cg),this._nextAcceptor.onNoscriptOpen(e)},e.prototype.onObjectOpen=function(e){return this.get_usageData().ch=this.Increment(this.get_usageData().ch),this._nextAcceptor.onObjectOpen(e)},e.prototype.onOlOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundList=!0),this.get_usageData().ci=this.Increment(this.get_usageData().ci),this._shouldParseStyleForHtmlTagEventIsEnabled&&this.ParseStyleUsageForTag(e),this._nextAcceptor.onOlOpen(e)},e.prototype.onOptgroupOpen=function(e){return this.get_usageData().cj=this.Increment(this.get_usageData().cj),this._nextAcceptor.onOptgroupOpen(e)},e.prototype.onOptionOpen=function(e){return this.get_usageData().ck=this.Increment(this.get_usageData().ck),this._nextAcceptor.onOptionOpen(e)},e.prototype.onPOpen=function(e){return this.get_usageData().cl=this.Increment(this.get_usageData().cl),this._shouldParseStyleForHtmlTagEventIsEnabled&&this.ParseStyleUsageForTag(e),this._nextAcceptor.onPOpen(e)},e.prototype.onParamTag=function(e){this.get_usageData().cm=this.Increment(this.get_usageData().cm),this._nextAcceptor.onParamTag(e)},e.prototype.onPreOpen=function(e){return this.get_usageData().cn=this.Increment(this.get_usageData().cn),this._nextAcceptor.onPreOpen(e)},e.prototype.onQOpen=function(e){return this.get_usageData().co=this.Increment(this.get_usageData().co),this._nextAcceptor.onQOpen(e)},e.prototype.onSOpen=function(e){return this.get_usageData().cp=this.Increment(this.get_usageData().cp),this._nextAcceptor.onSOpen(e)},e.prototype.onSampOpen=function(e){return this.get_usageData().cq=this.Increment(this.get_usageData().cq),this._nextAcceptor.onSampOpen(e)},e.prototype.onScriptOpen=function(e){return this.get_usageData().cr=this.Increment(this.get_usageData().cr),this._nextAcceptor.onScriptOpen(e)},e.prototype.onSelectOpen=function(e){return this.get_usageData().cs=this.Increment(this.get_usageData().cs),this._nextAcceptor.onSelectOpen(e)},e.prototype.onSmallOpen=function(e){return this.get_usageData().ct=this.Increment(this.get_usageData().ct),this._nextAcceptor.onSmallOpen(e)},e.prototype.onSpanOpen=function(e){return this.get_usageData().cu=this.Increment(this.get_usageData().cu),this._shouldParseStyleForHtmlTagEventIsEnabled&&this.ParseStyleUsageForTag(e),this._nextAcceptor.onSpanOpen(e)},e.prototype.onStrikeOpen=function(e){return this.get_usageData().cv=this.Increment(this.get_usageData().cv),this._nextAcceptor.onStrikeOpen(e)},e.prototype.onStrongOpen=function(e){return this.get_usageData().cw=this.Increment(this.get_usageData().cw),this._nextAcceptor.onStrongOpen(e)},e.prototype.onStyleOpen=function(e){return this.get_usageData().cx=this.Increment(this.get_usageData().cx),this._nextAcceptor.onStyleOpen(e)},e.prototype.onSubOpen=function(e){return this.get_usageData().cy=this.Increment(this.get_usageData().cy),this._nextAcceptor.onSubOpen(e)},e.prototype.onSupOpen=function(e){return this.get_usageData().cz=this.Increment(this.get_usageData().cz),this._nextAcceptor.onSupOpen(e)},e.prototype.onTableOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundTable=!0),this.get_usageData().da=this.Increment(this.get_usageData().da),this._shouldParseStyleForHtmlTagEventIsEnabled&&this.ParseStyleUsageForTag(e),this._nextAcceptor.onTableOpen(e)},e.prototype.onTbodyOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundTable=!0),this.get_usageData().db=this.Increment(this.get_usageData().db),this._shouldParseStyleForHtmlTagEventIsEnabled&&this.ParseStyleUsageForTag(e),this._nextAcceptor.onTbodyOpen(e)},e.prototype.onTdOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundTable=!0),this.get_usageData().dc=this.Increment(this.get_usageData().dc),this._shouldParseStyleForHtmlTagEventIsEnabled&&this.ParseStyleUsageForTag(e),this._nextAcceptor.onTdOpen(e)},e.prototype.onTextareaOpen=function(e){return this.get_usageData().dd=this.Increment(this.get_usageData().dd),this._nextAcceptor.onTextareaOpen(e)},e.prototype.onTfootOpen=function(e){return this.get_usageData().de=this.Increment(this.get_usageData().de),this._nextAcceptor.onTfootOpen(e)},e.prototype.onThOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundTable=!0),this.get_usageData().df=this.Increment(this.get_usageData().df),this._nextAcceptor.onThOpen(e)},e.prototype.onTheadOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundTable=!0),this.get_usageData().dg=this.Increment(this.get_usageData().dg),this._nextAcceptor.onTheadOpen(e)},e.prototype.onTitleOpen=function(e){return this.get_usageData().dh=this.Increment(this.get_usageData().dh),this._nextAcceptor.onTitleOpen(e)},e.prototype.onTrOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundTable=!0),this.get_usageData().di=this.Increment(this.get_usageData().di),this._nextAcceptor.onTrOpen(e)},e.prototype.onTtOpen=function(e){return this.get_usageData().dj=this.Increment(this.get_usageData().dj),this._nextAcceptor.onTtOpen(e)},e.prototype.onUOpen=function(e){return this.get_usageData().dk=this.Increment(this.get_usageData().dk),this._nextAcceptor.onUOpen(e)},e.prototype.onUlOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundList=!0),this.get_usageData().dl=this.Increment(this.get_usageData().dl),this._nextAcceptor.onUlOpen(e)},e.prototype.onVarOpen=function(e){return this.get_usageData().dm=this.Increment(this.get_usageData().dm),this._nextAcceptor.onVarOpen(e)},e.prototype.onUnknownOpen=function(e){return this.get_usageData().dn=this.Increment(this.get_usageData().dn),this._nextAcceptor.onUnknownOpen(e)},e.prototype.ParseStyleUsageForTag=function(e){var t=e.get_domElement();if(t&&t.style&&this.get_contentMetadata()){var n=t.style;if(n)for(var i=0,r=n;i<r.length;i++){var o=r[i];o&&o.length>0&&this.get_contentMetadata().incrementStyleCountForTag(t.tagName,o)}}},e}();(0,o.l)(p_,"d62dc7cb$HtmlEventUsageCollector",null,[Fp]);var h_=n(2743),__=n(5487),m_=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this._nextAcceptor=null,this.usageData=null,this.tableUsageData=null,this._nextAcceptor=e,this.usageData=t||Zp.z.getSemanticEventsUsageDataInstance(""),this.tableUsageData=n||Zp.z.getSemanticTableEventsUsageDataInstance("")}return e.prototype.get_usageData=function(){return this.usageData},e.prototype.get_tableUsageData=function(){return this.tableUsageData},e.prototype.onTableStart=function(e){this.get_tableUsageData().b++,this._nextAcceptor.onTableStart(e)},e.prototype.onTableEnd=function(){this._nextAcceptor.onTableEnd()},e.prototype.onTableRowStart=function(e){this.get_tableUsageData().c++,this._nextAcceptor.onTableRowStart(e)},e.prototype.onTableRowEnd=function(){this._nextAcceptor.onTableRowEnd()},e.prototype.onTableCellStart=function(e){this.get_tableUsageData().d++,this._nextAcceptor.onTableCellStart(e)},e.prototype.onTableCellEnd=function(){this._nextAcceptor.onTableCellEnd()},e.prototype.onTablePartStart=function(e){this.get_tableUsageData().e++,this._nextAcceptor.onTablePartStart(e)},e.prototype.onTablePartEnd=function(){this._nextAcceptor.onTablePartEnd()},e.prototype.reset=function(){this._nextAcceptor.reset()},e.prototype.get_defaultFormatting=function(){return this._nextAcceptor.get_defaultFormatting()},e.prototype.onText=function(e,t){this.get_usageData().b++,this._nextAcceptor.onText(e,t)},e.prototype.onLineBreak=function(e){this.get_usageData().c++,this._nextAcceptor.onLineBreak(e)},e.prototype.onTab=function(e){this.get_usageData().b++,this._nextAcceptor.onTab(e)},e.prototype.onImage=function(e){this.get_usageData().d++,this._nextAcceptor.onImage(e)},e.prototype.onFile=function(e){this.get_usageData().e++,this._nextAcceptor.onFile(e)},e.prototype.onFormattingChange=function(e){this.get_usageData().f++,this._nextAcceptor.onFormattingChange(e)},e.prototype.onAnchorStart=function(e,t){this.get_usageData().g++,this._nextAcceptor.onAnchorStart(e,t)},e.prototype.onAnchorEnd=function(){this._nextAcceptor.onAnchorEnd()},e.prototype.onParagraphStart=function(e){this.get_usageData().h++,this._nextAcceptor.onParagraphStart(e)},e.prototype.onParagraphEnd=function(){this._nextAcceptor.onParagraphEnd()},e.prototype.onPreFormattedTextStart=function(){this._nextAcceptor.onPreFormattedTextStart()},e.prototype.onPreFormattedTextEnd=function(){this._nextAcceptor.onPreFormattedTextEnd()},e.prototype.onMathStart=function(e,t){this.get_usageData().i++,this._nextAcceptor.onMathStart(e,t)},e.prototype.onMathEnd=function(){this._nextAcceptor.onMathEnd()},e.prototype.onListStart=function(e){this.get_usageData().j++,this._nextAcceptor.onListStart(e)},e.prototype.onListEnd=function(){this._nextAcceptor.onListEnd()},e.prototype.onListItemStart=function(e){this.get_usageData().k++,this._nextAcceptor.onListItemStart(e)},e.prototype.onListItemEnd=function(){this._nextAcceptor.onListItemEnd()},e.prototype.onRenderAugmentation=function(e){this.get_usageData().l++,this._nextAcceptor.onRenderAugmentation(e)},e.prototype.onSpanStart=function(){this.get_usageData().m++,this._nextAcceptor.onSpanStart()},e.prototype.onSpanEnd=function(){this._nextAcceptor.onSpanEnd()},e}();(0,o.l)(m_,"13f6dcfc$SemanticEventUsageCollector",null,[h_.m,__.p]);var f_=function(){function e(e){this.steward=null,this.steward=e}return e.prototype.reset=function(){this.steward.reset()},e.prototype.get_defaultFormatting=function(){return this.steward.get_defaultFormatting()},e.prototype.onText=function(e,t){this.steward.onText(e,t)},e.prototype.onLineBreak=function(e){this.steward.onLineBreak(e)},e.prototype.onTab=function(e){this.steward.onTab(e)},e.prototype.onImage=function(e){this.steward.onImage(e)},e.prototype.onFile=function(e){this.steward.onFile(e)},e.prototype.onFormattingChange=function(e){this.steward.onFormattingChange(e)},e.prototype.onAnchorStart=function(e,t){this.steward.onAnchorStart(e,t)},e.prototype.onAnchorEnd=function(){this.steward.onAnchorEnd()},e.prototype.onParagraphStart=function(e){this.steward.onParagraphStart(e)},e.prototype.onParagraphEnd=function(){this.steward.onParagraphEnd()},e.prototype.onPreFormattedTextStart=function(){this.steward.onPreFormattedTextStart()},e.prototype.onPreFormattedTextEnd=function(){this.steward.onPreFormattedTextEnd()},e.prototype.onListStart=function(e){this.steward.onListStart(e)},e.prototype.onListEnd=function(){this.steward.onListEnd()},e.prototype.onListItemStart=function(e){this.steward.onListItemStart(e)},e.prototype.onListItemEnd=function(){this.steward.onListItemEnd()},e.prototype.onRenderAugmentation=function(e){this.steward.onRenderAugmentation(e)},e.prototype.onSpanStart=function(){this.steward.onSpanStart()},e.prototype.onSpanEnd=function(){this.steward.onSpanEnd()},e.prototype.onTableStart=function(e){this.steward.onTableStart(e)},e.prototype.onTableEnd=function(){this.steward.onTableEnd()},e.prototype.onTableRowStart=function(e){this.steward.onTableRowStart(e)},e.prototype.onTableRowEnd=function(){this.steward.onTableRowEnd()},e.prototype.onTableCellStart=function(e){this.steward.onTableCellStart(e)},e.prototype.onTableCellEnd=function(){this.steward.onTableCellEnd()},e.prototype.onTablePartStart=function(e){this.steward.onTablePartStart(e)},e.prototype.onTablePartEnd=function(){this.steward.onTablePartEnd()},e.prototype.onMathStart=function(e,t){this.steward.onMathStart(e,t)},e.prototype.onMathEnd=function(){this.steward.onMathEnd()},e}();(0,o.l)(f_,"3d6fa7f7$AHtmlNormalizer",null,[h_.m,__.p]);var y_=function(e){function t(t){var n=e.call(this,t)||this;return n.queueMode=!1,n}return(0,v.t)(t,e),t.prototype.onText=function(e,t){var n=this;this.queueMode?this.get_queueManager().EnqueueEvent((function(){n.processText(e,t)})):this.processText(e,t)},t.prototype.processText=function(e,t){this.steward.onText(e,t)},t.prototype.onLineBreak=function(e){var t=this;this.queueMode?this.get_queueManager().EnqueueEvent((function(){t.processLineBreak(e)})):this.processLineBreak(e)},t.prototype.processLineBreak=function(e){this.steward.onLineBreak(e)},t.prototype.onImage=function(e){var t=this;this.queueMode?this.get_queueManager().EnqueueEvent((function(){t.processImage(e)})):this.processImage(e)},t.prototype.processImage=function(e){this.steward.onImage(e)},t.prototype.onFile=function(e){var t=this;this.queueMode?this.get_queueManager().EnqueueEvent((function(){t.processFile(e)})):this.processFile(e)},t.prototype.processFile=function(e){this.steward.onFile(e)},t.prototype.onFormattingChange=function(e){var t=this;this.queueMode?this.get_queueManager().EnqueueEvent((function(){t.processFormattingChange(e)})):this.processFormattingChange(e)},t.prototype.processFormattingChange=function(e){this.steward.onFormattingChange(e)},t.prototype.onAnchorStart=function(e,t){var n=this;this.queueMode?this.get_queueManager().EnqueueEvent((function(){n.processAnchorStart(e,t)})):this.processAnchorStart(e,t)},t.prototype.processAnchorStart=function(e,t){this.steward.onAnchorStart(e,t)},t.prototype.onAnchorEnd=function(){this.queueMode?this.get_queueManager().EnqueueEvent(o.i(this,this.processAnchorEnd,"processAnchorEnd")):this.processAnchorEnd()},t.prototype.processAnchorEnd=function(){this.steward.onAnchorEnd()},t.prototype.onParagraphStart=function(e){var t=this;this.queueMode?this.get_queueManager().EnqueueEvent((function(){t.processParagraphStart(e)})):this.processParagraphStart(e)},t.prototype.processParagraphStart=function(e){this.steward.onParagraphStart(e)},t.prototype.onParagraphEnd=function(){this.queueMode?this.get_queueManager().EnqueueEvent(o.i(this,this.processParagraphEnd,"processParagraphEnd")):this.processParagraphEnd()},t.prototype.processParagraphEnd=function(){this.steward.onParagraphEnd()},t.prototype.onPreFormattedTextStart=function(){this.queueMode?this.get_queueManager().EnqueueEvent(o.i(this,this.processPreFormattedTextStart,"processPreFormattedTextStart")):this.processPreFormattedTextStart()},t.prototype.processPreFormattedTextStart=function(){this.steward.onPreFormattedTextStart()},t.prototype.onPreFormattedTextEnd=function(){this.queueMode?this.get_queueManager().EnqueueEvent(o.i(this,this.processPreFormattedTextEnd,"processPreFormattedTextEnd")):this.processPreFormattedTextEnd()},t.prototype.processPreFormattedTextEnd=function(){this.steward.onPreFormattedTextEnd()},t.prototype.onListStart=function(e){var t=this;this.queueMode?this.get_queueManager().EnqueueEvent((function(){t.processListStart(e)})):this.processListStart(e)},t.prototype.processListStart=function(e){this.steward.onListStart(e)},t.prototype.onListEnd=function(){this.queueMode?this.get_queueManager().EnqueueEvent(o.i(this,this.processListEnd,"processListEnd")):this.processListEnd()},t.prototype.processListEnd=function(){this.steward.onListEnd()},t.prototype.onListItemStart=function(e){var t=this;this.queueMode?this.get_queueManager().EnqueueEvent((function(){t.processListItemStart(e)})):this.processListItemStart(e)},t.prototype.processListItemStart=function(e){this.steward.onListItemStart(e)},t.prototype.onListItemEnd=function(){this.queueMode?this.get_queueManager().EnqueueEvent(o.i(this,this.processListItemEnd,"processListItemEnd")):this.processListItemEnd()},t.prototype.processListItemEnd=function(){this.steward.onListItemEnd()},t.prototype.onTableStart=function(e){var t=this;this.queueMode?this.get_queueManager().EnqueueEvent((function(){t.processTableStart(e)})):this.processTableStart(e)},t.prototype.processTableStart=function(e){this.steward.onTableStart(e)},t.prototype.onTableEnd=function(){this.queueMode?this.get_queueManager().EnqueueEvent(o.i(this,this.processTableEnd,"processTableEnd")):this.processTableEnd()},t.prototype.processTableEnd=function(){this.steward.onTableEnd()},t.prototype.onTableRowStart=function(e){var t=this;this.queueMode?this.get_queueManager().EnqueueEvent((function(){t.processTableRowStart(e)})):this.processTableRowStart(e)},t.prototype.processTableRowStart=function(e){this.steward.onTableRowStart(e)},t.prototype.onTableRowEnd=function(){this.queueMode?this.get_queueManager().EnqueueEvent(o.i(this,this.processTableRowEnd,"processTableRowEnd")):this.processTableRowEnd()},t.prototype.processTableRowEnd=function(){this.steward.onTableRowEnd()},t.prototype.onTableCellStart=function(e){var t=this;this.queueMode?this.get_queueManager().EnqueueEvent((function(){t.processTableCellStart(e)})):this.processTableCellStart(e)},t.prototype.processTableCellStart=function(e){this.steward.onTableCellStart(e)},t.prototype.onTableCellEnd=function(){this.queueMode?this.get_queueManager().EnqueueEvent(o.i(this,this.processTableCellEnd,"processTableCellEnd")):this.processTableCellEnd()},t.prototype.processTableCellEnd=function(){this.steward.onTableCellEnd()},t.prototype.onTablePartStart=function(e){var t=this;this.queueMode?this.get_queueManager().EnqueueEvent((function(){t.processTablePartStart(e)})):this.processTablePartStart(e)},t.prototype.processTablePartStart=function(e){this.steward.onTablePartStart(e)},t.prototype.onTablePartEnd=function(){this.queueMode?this.get_queueManager().EnqueueEvent(o.i(this,this.processTablePartEnd,"processTablePartEnd")):this.processTablePartEnd()},t.prototype.processTablePartEnd=function(){this.steward.onTablePartEnd()},t.prototype.onMathStart=function(e,t){var n=this;this.queueMode?this.get_queueManager().EnqueueEvent((function(){n.processMathStart(e,t)})):this.processMathStart(e,t)},t.prototype.processMathStart=function(e,t){this.steward.onMathStart(e,t)},t.prototype.onMathEnd=function(){this.queueMode?this.get_queueManager().EnqueueEvent(o.i(this,this.processMathEnd,"processMathEnd")):this.processMathEnd()},t.prototype.processMathEnd=function(){this.steward.onMathEnd()},t}(f_);(0,o.l)(y_,"8b433e63$AQueuingHtmlNormalizer",f_,[]);var C_=function(){function e(t){this.next=null,o.m(this,e.$$(t)),this.data=o.c(o.f(this,"Box3.QueueNode$1").TNode)}return e.$$=function(t){return o.o("Box3.QueueNode$1",e,[{TNode:t}],null,[],{})},e}(),S_=function(){function e(t){this._back=null,this._front=null,this._count=0,o.m(this,e.$$(t)),this._back=null,this._front=null,this._count=0}return e.prototype.get_count=function(){return this._count},e.prototype.get_isEmpty=function(){return!this._count||!this._back||!this._front},e.prototype.enqueue=function(e){var t=new C_(o.f(this,"Box3.Queue$1").T);t.data=e,this.get_isEmpty()?(this._back=t,this._front=t):(this._back.next=t,this._back=t),this._count++},e.prototype.front=function(){return this.get_isEmpty()?null:this._front.data},e.prototype.back=function(){return this.get_isEmpty()?null:this._back.data},e.prototype.dequeue=function(){if(this.get_isEmpty())return null;var e=this._front;return this._front=e.next,this._count--,this._front||(this._back=null),e.data},e.prototype.clear=function(){this._back=null,this._front=null,this._count=0},e.prototype.toArray=function(){for(var e=new Array(this.get_count()),t=this._front,n=0;n<this.get_count()&&t;n++)e[n]=t.data,t=t.next;return e},e.$$=function(t){return o.o("Box3.Queue$1",e,[{T:t}],null,[],{})},e}(),b_=function(){function e(){this._queuedEvents=null,this._queuedEvents=new S_(Object)}return e.prototype.get_IsQueueEmpty=function(){return this._queuedEvents.get_isEmpty()},e.prototype.EnqueueEvent=function(e){this._queuedEvents.enqueue(e)},e.prototype.Flush=function(e){for(void 0===e&&(e=!1),e&&this.SetContextAsWhenEnqueuing();!this._queuedEvents.get_isEmpty();){this._queuedEvents.dequeue()()}e&&this.ResetContextAfterFlushing()},e.prototype.SetContextAsWhenEnqueuing=function(){},e.prototype.ResetContextAfterFlushing=function(){},e}();(0,o.l)(b_,"a6d0f596$QueuedEventManager",null,[]);var v_=function(e){function t(t){var n=e.call(this)||this;return n._normalizer=null,n.CurrentParagraphArgs=null,n.IsInsideParagraph=!1,n.ParagraphText="",n.IsPreformattedText=!1,n.IsInsideHyperlink=!1,n.CurrentHref=null,n.CurrentHrefGlobalAttributes=null,n.NestedListCount=0,n.IsUnderImpliedList=!1,n.IsUnderListItem=!1,n.IsListItemEmpty=!1,n.Table=null,n.NestedOrphanedTableCellCount=0,n._normalizer=t,n}return(0,v.t)(t,e),t.prototype.get_AmidstTableStructure=function(){return!!this.Table},t.prototype.SetContextAsWhenEnqueuing=function(){this._normalizer._outerContentStates.push(this._normalizer._currentState),this._normalizer._currentState=this},t.prototype.ResetContextAfterFlushing=function(){this._normalizer._currentState=this._normalizer._outerContentStates.pop()},t}(b_);(0,o.l)(v_,"9e39db23$ContentState",b_,[]);var T_=function(){return function(e,t,n){this.ColSpan=0,this.RowSpan=0,this.Width=0,this.IsSkipCell=!1,this.Height=0,this.IsRelativeWidth=!1,this.ShadingColor=null,this.VerticalAlignment=0,this.GlobalAttributesOnCell=null,this.Contents=null,this.TableCellBorderProperties=null,this.TableCellMarginProperties=null,this.CellLook=0,this.ColSpan=e.colSpan,this.RowSpan=e.rowSpan,this.Width=e.width,this.Height=e.height,this.IsRelativeWidth=e.isRelativeWidth,this.ShadingColor=e.shadingColor,this.VerticalAlignment=e.verticalAlignment,this.TableCellBorderProperties=e.tableCellBorderProperties,this.TableCellMarginProperties=e.tableCellMarginProperties,this.IsSkipCell=e.isSkipCell,this.CellLook=e.cellLook,this.Contents=n,this.GlobalAttributesOnCell=t}}();(0,o.l)(T_,"906e7b44$TableCell",null,[]);var A_=function(e){function t(t,n){var i=e.call(this)||this;return i._normalizer=null,i._columns=null,i._globalAttributesArgs=null,i._currentRowIdx=0,i._tableRowsGlobalAttributesArgs=null,i._currentColIdx=0,i._isBorderHidden=!1,i._isBorderCollapsed=!1,i._tableBorderProperties=null,i._width=0,i._isRelativeWidth=!1,i._indentationProperties=null,i._tableLook=0,i._tableStyleId=null,i._mergedCellExtensionBoundaries=null,i._rowHeights=null,i._normalizer=t,i._tableRowsGlobalAttributesArgs=new Xg(Qp),i._columns=new Xg(Array),i._mergedCellExtensionBoundaries=new Array(0),i._rowHeights=new Array(0),i._currentRowIdx=-1,i._currentColIdx=0,i._isBorderHidden=n.isBorderHidden,i._isBorderCollapsed=n.isBorderCollapsed,i._tableBorderProperties=n.tableBorderProperties,i._width=n.width,i._isRelativeWidth=n.isRelativeWidth,i._globalAttributesArgs=new Qg(new Dp(n.get_ownerHtmlElementInfo().get_htmlIdentifier(),n.get_ownerHtmlElementInfo().get_htmlElementType()),n.get_htmlElementInfoFromHierarchy(),n.ownerNoteTagInfo,n.get_cultureName(),n.absolutePosition),i._indentationProperties=n.indentationProperties,i._tableStyleId=n.styleId,i._tableLook=n.tableLook,i}return(0,v.t)(t,e),t.prototype.get_Steward=function(){return this._normalizer.steward},t.prototype.PrepareToNormalizeNextRow=function(e){this._currentRowIdx++,this._tableRowsGlobalAttributesArgs.add(e),this._rowHeights[this._currentRowIdx]=e.height,this._currentColIdx=0},t.prototype.get_CurrentColumn=function(){for(;this._currentColIdx>=this._columns.get_count();)this._columns.add(new Array(this._currentRowIdx+1));return this._columns.get_item(this._currentColIdx)},t.prototype.AddCell=function(e,t,n,i,r,o,a){if(this._currentRowIdx<0)return!1;for(;this._mergedCellExtensionBoundaries[this._currentColIdx]>=this._currentRowIdx;)this._currentColIdx++;var l=new T_(e,new Qg(t,n,i,r,o),a);if(this.get_CurrentColumn()[this._currentRowIdx]=l,l.RowSpan>1)for(var s=this._currentRowIdx+l.RowSpan-1,u=this._currentColIdx,c=this._currentColIdx+l.ColSpan-1,d=u;d<=c;d++)this._mergedCellExtensionBoundaries[d]>=s||(this._mergedCellExtensionBoundaries[d]=s);return this._currentColIdx+=l.ColSpan,this._rowHeights[this._currentRowIdx]<l.Height&&(this._rowHeights[this._currentRowIdx]=l.Height),!0},t.prototype.SetContextAsWhenEnqueuing=function(){this._normalizer._currentState.Table=this},t.prototype.ResetContextAfterFlushing=function(){this._normalizer._currentState.Table=null},t.prototype.FlushTable=function(){this.Flush(!0);for(var e=this._currentRowIdx+1,t=new Array(e),n=0;n<e;n++)t[n]=new Array(this._columns.get_count());for(var i=!0,r=0,o=0;o<this._columns.get_count();o++){var a=this._columns.get_item(o),l=!0;for(n=0;n<e;n++){var s=a[n];s&&(l=!1,t[n][o+r]=new jp(s.ColSpan,s.RowSpan,s.Width,s.Height,void 0,void 0,void 0,void 0,s.IsRelativeWidth,s.IsSkipCell))}l?(this._columns.removeAt(o),o--,++r):i=!1}if(!i){var u=null;(u=this._isRelativeWidth?this._normalizer.calculateTableWidths(t,this._width/100):this._normalizer.calculateTableWidths(t))&&u.length!==this._columns.get_count()&&(u=null),this._normalizer.ensureCurrentContentEnded(!0),this._normalizer.closeExpiredImpliedList(),this.get_Steward().onTableStart(new Xp(e,this._columns.get_count(),this._width,this._isRelativeWidth,u,this._isBorderHidden,this._isBorderCollapsed,this._tableBorderProperties,this._indentationProperties,this._tableStyleId,this._tableLook,this._globalAttributesArgs));for(n=0;n<e;n++){var c=this._tableRowsGlobalAttributesArgs.get_item(n),d=this._rowHeights[n];this.get_Steward().onTableRowStart(new Qp(d,new Qg(c.get_ownerHtmlElementInfo(),c.get_htmlElementInfoFromHierarchy(),c.ownerNoteTagInfo,c.get_cultureName(),c.absolutePosition)));for(o=0;o<this._columns.get_count();o++){var g=this._columns.get_item(o)[n],p=!!this._tableStyleId&&""!==this._tableStyleId&&"Custom"!==this._tableStyleId,h=g?g.ColSpan:0,_=g?g.RowSpan:0,m=g?g.Width:0,f=g?g.Height:0,y=g?g.CellLook:0,C=!!g&&g.IsRelativeWidth,S=g&&(65536&y||!p)?g.ShadingColor:"",b=g?g.VerticalAlignment:0,v=!!g&&g.IsSkipCell,T=g?this._normalizer.getNormalizedTableCellBorder(g.TableCellBorderProperties,o,n,this._columns,this._isBorderCollapsed,p,g.CellLook):new Hp,A=g?g.TableCellMarginProperties:new Gp,I=g?g.GlobalAttributesOnCell:null,w=I?I.get_ownerHtmlElementInfo():null,x=I?I.get_htmlElementInfoFromHierarchy():null,E=I?I.ownerNoteTagInfo:null,F=I?I.get_cultureName():null,P=I?I.absolutePosition:null;this.get_Steward().onTableCellStart(new jp(h,_,m,f,S,b,T,A,C,v,y,new Qg(w,x,E,F,P))),g&&!g.IsSkipCell&&(g.Contents.SetContextAsWhenEnqueuing(),g.Contents.Flush(),this._normalizer.ensureCurrentContentEnded(!1),this._normalizer.closeExpiredImpliedList(),g.Contents.ResetContextAfterFlushing()),this.get_Steward().onTableCellEnd()}this.get_Steward().onTableRowEnd()}this.get_Steward().onTableEnd(),this._normalizer._currentState.IsListItemEmpty=!1,this._normalizer.ensureOutsideListItem(!1)}},t}(b_);(0,o.l)(A_,"ec850842$NormalizedTable",b_,[]);var I_=function(){function e(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this._isInlineTabInsertionEnabled=!1,this._splitHyperlinkFixWithEnterIsEnabled=!1,this._isInlineTabInsertionEnabled=e,this._splitHyperlinkFixWithEnterIsEnabled=t}return e.prototype.get_isInlineTabInsertionEnabled=function(){return this._isInlineTabInsertionEnabled},e.prototype.get_splitHyperlinkFixWithEnterIsEnabled=function(){return this._splitHyperlinkFixWithEnterIsEnabled},e}();(0,o.l)(I_,"1770f953$HtmlNormalizerSettings",null,[Cg]);var w_=function(e){function t(t,n){void 0===n&&(n=null);var i=e.call(this,t)||this;return i._currentState=null,i._htmlNormalizerSettings=null,i._outerContentStates=null,i._outerContentStates=new Mp(v_),i._htmlNormalizerSettings=n||new I_,i}return(0,v.t)(t,e),t.prototype.reset=function(){e.prototype.reset.call(this),this._currentState=new v_(this),this._outerContentStates.clear(),this.queueMode=!1},t.prototype.get_queueManager=function(){return this._currentState&&this._currentState.get_AmidstTableStructure()?this._currentState.Table:this._currentState},t.prototype.ensureReadyForText=function(e){void 0===e&&(e=!1),this._currentState.IsInsideParagraph||(this.closeExpiredImpliedList(),this.steward.onParagraphStart(this._currentState.CurrentParagraphArgs),this._currentState.IsInsideParagraph=!0,this._currentState.IsListItemEmpty=!1),e||!this._currentState.CurrentHref||this._currentState.IsInsideHyperlink||(this.steward.onAnchorStart(this._currentState.CurrentHref,this._currentState.CurrentHrefGlobalAttributes),this._currentState.IsInsideHyperlink=!0)},t.prototype.ensureOutsideHyperlink=function(){this._currentState.IsInsideHyperlink&&(this.steward.onAnchorEnd(),this._currentState.IsInsideHyperlink=!1)},t.prototype.ensureOutsideParagraph=function(){this._currentState.IsInsideParagraph&&(this.steward.onParagraphEnd(),this._currentState.IsInsideParagraph=!1,this._currentState.ParagraphText="")},t.prototype.ensureOutsideListItem=function(e){this._currentState.IsUnderListItem&&(this._currentState.IsListItemEmpty?e||(this.steward.onParagraphStart(null),this.steward.onParagraphEnd(),this.steward.onListItemEnd(),this._currentState.IsUnderListItem=!1):(this.steward.onListItemEnd(),this._currentState.IsUnderListItem=!1,this._currentState.IsListItemEmpty=!0))},t.prototype.ensureCurrentContentEnded=function(e,t){void 0===t&&(t=!1),t&&!this._currentState.IsInsideParagraph||(this.ensureOutsideHyperlink(),this.ensureOutsideParagraph(),this.ensureOutsideListItem(e))},t.prototype.openNewImpliedList=function(e){this.steward.onListStart(new qp(2,1,e)),this._currentState.NestedListCount++,this._currentState.IsUnderImpliedList=!0},t.prototype.closeExpiredImpliedList=function(){!this._currentState.IsUnderListItem&&this._currentState.IsUnderImpliedList&&(this.steward.onListEnd(),this._currentState.NestedListCount--,this._currentState.IsUnderImpliedList=!1)},t.prototype.processText=function(e,n){if(""!==(e=this.NormalizeWhiteSpaces(e)))if(this.ensureReadyForText(),this._currentState.IsPreformattedText)this.ProcessTextInternal(e,n);else{for(var i=e.split(t.c_tab),r=0;r<i.length-1;r++)this.ProcessTextInternal(i[r],n),this.steward.onTab(n);this.ProcessTextInternal(i[i.length-1],n)}},t.prototype.processMathStart=function(e,t){""!==e&&(this.ensureReadyForText(),this.steward.onMathStart(e,t))},t.prototype.processLineBreak=function(e){this._htmlNormalizerSettings.get_splitHyperlinkFixWithEnterIsEnabled()||this.ensureOutsideHyperlink(),this.ensureReadyForText(!0),this.steward.onLineBreak(e)},t.prototype.processFormattingChange=function(e){this._currentState.get_AmidstTableStructure()||this.steward.onFormattingChange(e)},t.prototype.processImage=function(t){this._currentState.CurrentHref&&(t.href=this._currentState.CurrentHref),e.prototype.processImage.call(this,t)},t.prototype.processAnchorStart=function(e,t){this.ensureOutsideHyperlink(),this._currentState.CurrentHref=e,this._currentState.CurrentHrefGlobalAttributes=t},t.prototype.processAnchorEnd=function(){this.ensureOutsideHyperlink(),this._currentState.CurrentHref=null,this._currentState.CurrentHrefGlobalAttributes=null},t.prototype.processParagraphStart=function(e){this._currentState.CurrentParagraphArgs=e,this.ensureCurrentContentEnded(!0)},t.prototype.processParagraphEnd=function(){this._currentState.CurrentParagraphArgs=null,this.ensureCurrentContentEnded(!0)},t.prototype.processPreFormattedTextStart=function(){this._currentState.IsPreformattedText=!0},t.prototype.processPreFormattedTextEnd=function(){this._currentState.IsPreformattedText=!1},t.prototype.processListStart=function(e){this.ensureCurrentContentEnded(!1),this.closeExpiredImpliedList(),this.steward.onListStart(e),this._currentState.NestedListCount++},t.prototype.processListEnd=function(){this.ensureCurrentContentEnded(!1),this.steward.onListEnd(),this._currentState.NestedListCount--},t.prototype.processListItemStart=function(e){this.ensureCurrentContentEnded(!1),this._currentState.NestedListCount||this.openNewImpliedList(e),this.steward.onListItemStart(e),this._currentState.IsUnderListItem=!0,this._currentState.IsListItemEmpty=!0},t.prototype.processListItemEnd=function(){this.ensureCurrentContentEnded(!1)},t.prototype.onTableStart=function(e){this._currentState.get_AmidstTableStructure()||(this.queueMode=!0,this._currentState.Table=new A_(this,e))},t.prototype.processTableStart=function(e){},t.prototype.onTableEnd=function(){if(this._currentState.Table){var e=this._currentState.Table;this._currentState.Table=null,this._outerContentStates.get_isEmpty()?(this.queueMode=!1,e.FlushTable()):this.get_queueManager().EnqueueEvent(o.i(e,e.FlushTable,"FlushTable"))}},t.prototype.processTableEnd=function(){},t.prototype.onTableRowStart=function(e){this._currentState.get_AmidstTableStructure()&&this._currentState.Table.PrepareToNormalizeNextRow(e)},t.prototype.processTableRowStart=function(e){},t.prototype.onTableRowEnd=function(){},t.prototype.processTableRowEnd=function(){},t.prototype.onTableCellStart=function(e){var t=!1;if(this._currentState.get_AmidstTableStructure()){var n=new v_(this);this._currentState.Table.AddCell(e,new Dp(e.get_ownerHtmlElementInfo().get_htmlIdentifier(),e.get_ownerHtmlElementInfo().get_htmlElementType()),e.get_htmlElementInfoFromHierarchy(),e.ownerNoteTagInfo,e.get_cultureName(),e.absolutePosition,n)?(this._outerContentStates.push(this._currentState),this._currentState=n):t=!0}else t=!0;t&&this._currentState.NestedOrphanedTableCellCount++},t.prototype.processTableCellStart=function(e){},t.prototype.onTableCellEnd=function(){this._currentState.NestedOrphanedTableCellCount>0?this._currentState.NestedOrphanedTableCellCount--:this._currentState=this._outerContentStates.pop()},t.prototype.processTableCellEnd=function(){},t.prototype.calculateTableWidths=function(e,t){if(void 0===t&&(t=1),!e)return null;var n=e.length;if(!n)return null;for(var i=e[0].length,r=1;r<n;r++)if(e[r].length!==i)return null;var o=new Array(i+1);o[0]=0;for(var a=new Array(i+1),l=0;l<a.length;l++)a[l]=!1;var s=new C.c(Number);for(l=0;l<i;l++){for(r=0;r<n;r++)if(e[r][l]&&e[r][l].width>0){var u=Math.min(l+e[r][l].colSpan,i);o[u]=o[l]+e[r][l].width*(e[r][l].isRelativeWidth?t:1),a[u]=!0}if(a[l+1]){var c=o[l+1]-o[l];if(c<=0)return null;s.add(c)}else o[l+1]=o[l]}return s.toArray()},t.prototype.markTableStyleBorders=function(e,t){return 1&t||(e.borderTopStyle=12),16&t||(e.borderRightStyle=12),256&t||(e.borderBottomStyle=12),4096&t||(e.borderLeftStyle=12),e},t.prototype.getNormalizedTableCellBorder=function(e,t,n,i,r,o,a){if(!e)return null;if(o&&(e=this.markTableStyleBorders(e,a)),n<0||t<0||t>i.get_count()-1)return e;var l;t-1>=0&&n<=i.get_item(t-1).length-1&&1===e.borderLeftStyle&&((l=i.get_item(t-1)[n])&&1!==l.TableCellBorderProperties.borderRightStyle&&(e.borderLeftStyle=l.TableCellBorderProperties.borderRightStyle,e.borderLeftColor=l.TableCellBorderProperties.borderRightColor,e.borderLeftWidth=l.TableCellBorderProperties.borderRightWidth));n-1>=0&&n<=i.get_item(t).length-1&&1===e.borderTopStyle&&((l=i.get_item(t)[n-1])&&1!==l.TableCellBorderProperties.borderBottomStyle&&(e.borderTopStyle=l.TableCellBorderProperties.borderBottomStyle,e.borderTopColor=l.TableCellBorderProperties.borderBottomColor,e.borderTopWidth=l.TableCellBorderProperties.borderBottomWidth));return e},t.prototype.NormalizeWhiteSpaces=function(e){return this._currentState.IsPreformattedText||(e=this._htmlNormalizerSettings.get_isInlineTabInsertionEnabled()?e.replace(t.HtmlWhiteSpaceRegExpRetainTabs," "):e.replace(t.HtmlWhiteSpaceRegExp," ")),e.startsWith(" ")&&(this._currentState.ParagraphText.endsWith(" ")||""===this._currentState.ParagraphText)&&(e=Rn.l.substring(e,1,e.length)),e},t.prototype.ProcessTextInternal=function(e,t){""!==e&&(this.steward.onText(e,t),this._currentState.ParagraphText+=e)},t.HtmlWhiteSpaceRegExp=new RegExp("[ \t\f\u200b\r\n]+","g"),t.HtmlWhiteSpaceRegExpRetainTabs=new RegExp("[ \f\u200b\r\n]+","g"),t.c_tab="\t",t}(y_);(0,o.l)(w_,"723df6fd$DefaultHtmlNormalizer",y_,[]);var x_,E_=function(e){function t(t,n,i){var r=e.call(this,t,i)||this;return r._imageSteward=null,r._haveShownAnonymousEditingDialog=!1,r._imageSteward=n,r}return(0,v.t)(t,e),t.prototype.processImage=function(e){if(this._imageSteward.get_picturePasteIsEnabled())if(L.AFrameworkApplication.limitedEdit){if(!this._haveShownAnonymousEditingDialog){var n=new Vn.StandardDialog;n.set_buttonsOption(0),n.setButtonText(1,CommonUIStrings.l_DialogClose),n.messageBox(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this._haveShownAnonymousEditingDialog=!0}}else this._imageSteward.get_maxPicturesReached()?this._imageSteward.set_maxPicturesExceeded(!0):e.src&&""!==e.src?Oe.n.getOrigin(e.src)!==Oe.n.getOrigin(window.location.href)?e.src.startsWith("data:")&&e.src.length>t.MaxDataUriLength?L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.pastedPictureWithDataUri,2):e.src.startsWith("webkit-fake-url")?L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.pastedLocalPictureFromSafari,2):(Gl.n.get_instance().get_item(1)?this.ensureCurrentContentEnded(!1):Gl.n.get_instance().get_item(11)&&(this.ensureOutsideHyperlink(),this.ensureReadyForText(!0)),this.steward.onImage(e)):L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.pastedPictureWithRelativeSrc,2):L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.pastedPictureWithNoSrc,2)},t.MaxDataUriLength=19922944,t}(w_);(0,o.l)(E_,"ed5dc909$Box4HtmlNormalizer",w_,[]),function(e){e[e.unknown=0]="unknown",e[e.differentBox4App=1]="differentBox4App",e[e.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession",e[e.sameBox4AppSameSession=3]="sameBox4AppSameSession"}(x_||(x_={})),(0,o.h)("e4ff53ba$CopySource",x_);var F_=function(){return function(e,t,n,i,r,o,a,l,s,u){this.htmlProcessor=null,this.imageSteward=null,this.wordConverterUsageData=null,this.formattingStewardUsageData=null,this.semanticEventsUsageData=null,this.semanticTableEventsUsageData=null,this.htmlContentMetadata=null,this.htmlEventsUsageData=null,this.htmlProcessorUsageData=null,this.listUsageData=null,this.htmlProcessor=e,this.imageSteward=t,this.wordConverterUsageData=n,this.formattingStewardUsageData=i,this.semanticEventsUsageData=r,this.semanticTableEventsUsageData=o,this.htmlContentMetadata=a,this.htmlEventsUsageData=l,this.htmlProcessorUsageData=s,this.listUsageData=u}}();(0,o.l)(F_,"a379461$ExecutePasteArguments",null,[]);var P_=function(){function e(){}return e.fromClipboardActionFlags=function(e){return 8192&e?1:0},e}();(0,o.l)(P_,"b21b6550$StewardFamilyHelper",null,[]);var D_=function(e){function t(t,n,i,r,o,a,l,s,u,c,d,g,p,h){var _=e.call(this,n,i,r,c,g)||this;return _._pastedHtmlContainer=null,_._importIterator=null,_._box4PasteStewardFactory=null,_._imageStewardFactory=null,_._tableStewardFactory=null,_._wordConverterFactory=null,_._htmlNormalizerSettings=null,_._htmlTranslatorSettings=null,_._htmlTranslatorContext=null,_._externalPasteCssConverter=null,_._appSettingsManager=null,_._shouldGatherMetadataAboutPastedHtmlContent=!1,_._shouldConvertStyleDomToInlineStyle=!1,_._pastedHtmlContainer=t,_._box4PasteStewardFactory=o,_._imageStewardFactory=a,_._tableStewardFactory=l,_._wordConverterFactory=s,_._htmlTranslatorSettings=u,_._htmlNormalizerSettings=h,_._appSettingsManager=d,_._htmlTranslatorContext=(0,U.m)(new $p,{isCopiedFromSameApp:2===_.parentArgs.CopySource||3===_.parentArgs.CopySource}),_._externalPasteCssConverter=p,_._shouldGatherMetadataAboutPastedHtmlContent=d.getBooleanAppSetting("GatherMetadataAboutExternalPastedHTMLContentIsEnabled"),_._shouldConvertStyleDomToInlineStyle=d.getBooleanAppSetting("ParseStyleFromRawHtmlHeadIsEnabled"),_}return(0,v.t)(t,e),t.prototype.get_nothingToPaste=function(){return!1},t.prototype.get_isContentSingleParagraph=function(){return!Rn.l.testGlobal(Rn.l.get__lineBreakRegExp(),this._pastedHtmlContainer.innerText)},t.prototype.get_contentAsText=function(){return this._pastedHtmlContainer.innerText},t.prototype.executePaste=function(e){this._importIterator=new ha.g,this.precedingNodeRef.restore(this._importIterator),S.ULS.shipAssertTag(6305550,307,Ss.OutlineElementReader.isOutlineElement(this._importIterator)),this.parentArgs.OperationTelemetry&&this.parentArgs.OperationTelemetry.appendOperationFlag("external");var t=P_.fromClipboardActionFlags(this.parentArgs.ActionIdFlags),n=this._imageStewardFactory.get_value().create(t,this._importIterator),i=this._tableStewardFactory.get_value().create(t,this._importIterator),r=Zp.z.getWordConverterUsageDataInstance(L.AFrameworkApplication.userSessionId),a=Zp.z.getFormattingStewardUsageDataInstance(L.AFrameworkApplication.userSessionId),l=Zp.z.getSemanticEventsUsageDataInstance(L.AFrameworkApplication.userSessionId),s=Zp.z.getSemanticTableEventsUsageDataInstance(L.AFrameworkApplication.userSessionId),u=this._shouldGatherMetadataAboutPastedHtmlContent?this.InitializeHtmlContentMetadataInstance():null,c=Zp.z.getHtmlEventUsageDataInstance(W.y.get_browserCodeForLogging(),this.parentArgs.ClipboardOperationId),d=Zp.z.getHtmlProcessorUsageDataInstance(L.AFrameworkApplication.userSessionId),g=this._htmlTranslatorSettings.get_shouldGetListLevelForEachListItem()?Zp.z.getListUsageDataInstance(L.AFrameworkApplication.userSessionId):null,p=this._box4PasteStewardFactory.get_value().create(t,this._importIterator,n,i,null,a),h=new m_(p,l,s),_=new E_(h,n,this._htmlNormalizerSettings),m=new Yp(_,this._htmlTranslatorSettings,this._htmlTranslatorContext,g),f=new p_(m,c,u,this._appSettingsManager),y=new d_(f,d),C=new F_(y,n,r,a,l,s,u,c,d,g),b=new vp.a(e,o.i(this,this.PreprocessStyle,"PreprocessStyle"),C);b.setDebugName("paste and request pictures"),b.set_isSynchronous(!e||e.get_isSynchronous()),b.run()},t.prototype.PreprocessStyle=function(e,t){if(this._shouldConvertStyleDomToInlineStyle){var n=this._pastedHtmlContainer.getElementsByTagName("style");if(n&&n.length>0){S.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(var i=0;i<n.length;i++)this._externalPasteCssConverter.convertStyleDomToInlineStyle(this._pastedHtmlContainer,n[i]),n[i]&&(n[i].parentNode.removeChild(n[i]),i--)}}return e.changeStepCallback(o.i(this,this.ConvertWordListHtml,"ConvertWordListHtml")),!0},t.prototype.ConvertWordListHtml=function(e,t){var n=t;return this._wordConverterFactory.get_value().create(n.wordConverterUsageData).process(this._pastedHtmlContainer,e),e.changeStepCallback(o.i(this,this.ProcessHtml,"ProcessHtml")),!0},t.prototype.ProcessHtml=function(e,t){var n,i=t;return i.htmlProcessor.process(this._pastedHtmlContainer,e),n=i.imageSteward&&i.imageSteward.get_picturePasteIsEnabled()?o.i(this,this.RequestImages,"RequestImages"):o.i(this,this.EndPasteOperation,"EndPasteOperation"),e.changeStepCallback(n),!0},t.prototype.RequestImages=function(e,t){var n=t.imageSteward;if(n){var i=!1,r=!1,a=!1,l=!1,s=-1,u=new Dl.DictionaryPropertySet,c=new RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(o.r(ph.d,this.parentArgs.ActionData)){i=this.parentArgs.ActionData.getValueWithDefault(Boolean,os.j.isImageFromPaste,!1);var d=this.parentArgs.ActionData.getValueWithDefault(String,Pl.k.pastedHtmlContent,"");a=this.parentArgs.ActionData.getValueWithDefault(Boolean,Pl.k.isImageInsertion,!1),l=this.parentArgs.ActionData.getValueWithDefault(Boolean,is.b.isLayoutSizeSetByUser,!1),c.test(d)&&(r=!0),this.get_shouldGetPasteConstrainingWidth()&&(s=this.parentArgs.ActionData.getValueWithDefault(Number,ep.p.editContainerWidth,-1))}else 256&this.parentArgs.ActionIdFlags&&this._pastedHtmlContainer&&(i=!0,c.test(this._pastedHtmlContainer.innerHTML)&&(r=!0));u.setValue(os.j.isImageFromPaste,i),u.setValue(Pl.k.isUploadingImageCanFailedEarly,r),u.setValue(Pl.k.isImageInsertion,a),u.setValue(ep.p.editContainerWidth,s),u.setValue(is.b.isLayoutSizeSetByUser,l),n.setImageProperties(u),n.onPasteCompletion(),n.get_numPicturesPasted()&&(this.parentArgs.IsIncrementalAction=!0,this.parentArgs.IncrementalActionId=n.get_desiredRevisionId(),this.parentArgs.NumberOfIncrements=n.get_numPicturesPasted(),L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.requestImages,2))}return e.changeStepCallback(o.i(this,this.EndPasteOperation,"EndPasteOperation")),!0},t.prototype.EndPasteOperation=function(e,t){var n=t;return Zp.z.logWordConverterUsageData(n.wordConverterUsageData),Zp.z.logHtmlProcessorUsageData(n.htmlProcessorUsageData),Zp.z.logSemanticEventsUsageData(n.semanticEventsUsageData),Zp.z.logSemanticTableEventsUsageData(n.semanticTableEventsUsageData),Zp.z.logFormattingStewardUsageData(n.formattingStewardUsageData),Zp.z.logListUsageData(n.listUsageData),Zp.z.logHtmlEventsUsageData(n.htmlEventsUsageData),n.htmlContentMetadata&&(n.htmlContentMetadata.logHtmlContentMetadata(),n.htmlContentMetadata.logHtmlContentStyledata()),!1},t.prototype.InitializeHtmlContentMetadataInstance=function(){var e=new l_;return e.pasteBrowser=W.y.get_browserCodeForLogging(),this.parentArgs&&(e.actionIdFlags=this.parentArgs.ActionIdFlags,e.operationId=this.parentArgs.ClipboardOperationId,this.parentArgs.ActionData&&(e.progId=this.parentArgs.ActionData.getValueWithDefault(String,Pl.k.pastedHtmlProdId,""))),this._pastedHtmlContainer&&this._pastedHtmlContainer.innerHTML&&(e.pastedHtmlLength=this._pastedHtmlContainer.innerHTML.length),L.AFrameworkApplication.sessionStartInfoSettings&&(e.platform=L.AFrameworkApplication.sessionStartInfoSettings.Platform),e},t.prototype.get_shouldMergePastedListIntoList=function(){return!0},t.prototype.get_shouldMergeAfterContent=function(){if(S.ULS.shipAssertTag(6305551,307,!!this._importIterator),this._htmlTranslatorSettings.get_shouldGetParagraphProperties()(this._htmlTranslatorContext)){var e=!1;Ss.OutlineElementReader.isOutlineElement(this._importIterator)&&(this._importIterator.goToLastChild(),e=!0);var t=Ga.ParagraphReader.isParagraph(this._importIterator)&&!this._importIterator.get_currentNode().getValueWithDefault(Boolean,Pl.k.isEopFromCopy,!1);return e&&this._importIterator.returnToParent(),t}return Ga.ParagraphReader.isParagraph(this._importIterator)},t}(o_);(0,o.l)(D_,"6b001b8d$ExternalPasteExecutionManager",o_,[]);var R_=function(){function e(e,t,n,i,r,o,a,l,s){this._box4PasteStewardFactory=null,this._imageStewardFactory=null,this._tableStewardFactory=null,this._wordConverterFactory=null,this._htmlTranslatorSettings=null,this._contentControlCopyPasteHelper=null,this._appSettingsManager=null,this._externalPasteCssConverter=null,this._htmlNormalizerSettings=null,this._box4PasteStewardFactory=e,this._imageStewardFactory=t,this._tableStewardFactory=n,this._wordConverterFactory=i,this._htmlTranslatorSettings=r,this._contentControlCopyPasteHelper=o,this._appSettingsManager=a,this._externalPasteCssConverter=l,this._htmlNormalizerSettings=s}return e.prototype.create=function(e,t,n,i){return new D_(e,t,n,i,this._box4PasteStewardFactory,this._imageStewardFactory,this._tableStewardFactory,this._wordConverterFactory,this._htmlTranslatorSettings,this._contentControlCopyPasteHelper,this._appSettingsManager,yi.App.get_activeAppFrame().workspace,this._externalPasteCssConverter,this._htmlNormalizerSettings)},e}();(0,o.l)(R_,"ff32ecf9$Factory",null,[gg]);var M_=n(8383),k_=n(934),N_=n(8028),L_=function(){function e(e){this.internalCopyUsageData=null,this.graphObjectUsageData=null,this.paragraphUsageData=null,this.chpUsageData=null,this.blobUsageData=null;this.internalCopyUsageData=e.getInternalCopyUsageDataInstance("intCopy"),this.graphObjectUsageData=e.getGraphObjectUsageDataInstance("intCopy"),this.paragraphUsageData=e.getParagraphUsageDataInstance("intCopy"),this.chpUsageData=e.getChpUsageDataInstance("intCopy"),this.blobUsageData=e.getBlobUsageDataInstance("intCopy")}return e.getAnInstance=function(){return e.GetAnInstanceWithResolvedDependencies()},e.GetAnInstanceWithResolvedDependencies=function(){return new e(kh.z.get_instance())},e}();(0,o.l)(L_,"5d4e908$InternalCopyUsageHelper",null,[]);var B_=function(){function e(e,t,n){this.Source=null,this.Target=null,this.ParagraphLinks=null,this.ChildOperationReturnValue=null,this.UseChildReturnValue=!1,this.shouldCopySubtree=!1,this.$$pf_FeatureArgs=null,this._usageHelper=L_.getAnInstance(),this.Source=e,this.Target=t,this.ParagraphLinks=n}return e.prototype.get_usageHelper=function(){return this._usageHelper},e.prototype.get_featureArgs=function(){return this.$$pf_FeatureArgs},e.prototype.set_featureArgs=function(e){return this.$$pf_FeatureArgs=e,e},e}();(0,o.l)(B_,"94d0b34b$InternalCopyArguments",null,[]);var O_=function(e){function t(t,n,i,r){var o=e.call(this,t,n,{})||this;o.SelectedContexts=null,o.ContextIndex=0,o.GraphTransaction=null,o.SelectedContexts=new Array(0);for(var a=0;a<i.get_length();a++)Array.addRange(o.SelectedContexts,i.get_item(a).toArray());return o.ContextIndex=0,o.GraphTransaction=r,o}return(0,v.t)(t,e),t}(B_);(0,o.l)(O_,"b6a8c111$BasicInternalCopyArguments",B_,[]);var U_=function(e){function t(t){var n=e.call(this)||this;return n.featureArgs=null,n.featureArgs=t,n}return(0,v.t)(t,e),t}(Sys.EventArgs);(0,o.l)(U_,"3e357bc3$BeforePasteArguments",Sys.EventArgs,[]);var H_=function(e){function t(t,n){var i=e.call(this,t.Source,t.Target,t.ParagraphLinks)||this;return i.ParentArgs=null,i.InsertAfter=null,i.ParentArgs=t,i.InsertAfter=n,i}return(0,v.t)(t,e),t.prototype.get_usageHelper=function(){return this.ParentArgs.get_usageHelper()},t.prototype.get_featureArgs=function(){return this.ParentArgs.get_featureArgs()},t.prototype.set_featureArgs=function(e){return this.ParentArgs.set_featureArgs(e),e},t}(B_);(0,o.l)(H_,"86e180b0$CoreInternalCopyArguments",B_,[]);var G_=function(){return function(e,t,n,i,r){void 0===r&&(r=null),this.Source=null,this.Target=null,this.InsertAfter=null,this.OutlineOffset=null,this.featureArgs=null,this.Source=e,this.Target=t,this.InsertAfter=n,this.OutlineOffset=i,this.featureArgs=r||{}}}();(0,o.l)(G_,"e775f0a6$CoreInternalPasteArguments",null,[]);var W_=function(){return function(e,t,n,i,r,o,a,l,s){this.TableCellPasteOperation=null,this.Source=null,this.Target=null,this.OutlineOffset=null,this.RowIndex=0,this.ColumnIndex=0,this.PasteOperationStep=null,this.ChangedCellIndices=null,this.InteractiveView=null,this.TableCellPasteOperation=e,this.Source=t,this.Target=n,this.OutlineOffset=i,this.RowIndex=r,this.ColumnIndex=o,this.ChangedCellIndices=a,this.PasteOperationStep=l,this.InteractiveView=s}}();(0,o.l)(W_,"91a703f8$CoreInternalTablePasteArguments",null,[]);var V_=function(e){function t(t,n,i,r,o){var a=e.call(this)||this;return a.operation=null,a.operationStep=null,a.original=null,a.clone=null,a.featureArgs=null,a.operation=t,a.operationStep=n,a.original=i,a.clone=r,a.featureArgs=o,a}return(0,v.t)(t,e),t}(Sys.EventArgs);(0,o.l)(V_,"f250f131$ParagraphCopyPasteArguments",Sys.EventArgs,[]);var $_,z_=n(6276),K_=n(3392),q_=n(8479),j_=n(6374),Q_=n(5615),J_=n(4397);!function(e){e[e.unknown=-2]="unknown",e[e.all=-1]="all",e[e.none=0]="none",e[e.element=1]="element",e[e.content=2]="content",e[e.bodyText=3]="bodyText",e[e.list=4]="list",e[e.structureElement=5]="structureElement",e[e.anchoredObject=6]="anchoredObject",e[e.footnoteEndnoteContainer=7]="footnoteEndnoteContainer",e[e.footnoteEndnote=8]="footnoteEndnote",e[e.metaContent=9]="metaContent",e[e.headerAllPages=10]="headerAllPages",e[e.headerFirstPage=11]="headerFirstPage",e[e.headerEvenPages=12]="headerEvenPages",e[e.footerAllPages=13]="footerAllPages",e[e.footerFirstPage=14]="footerFirstPage",e[e.footerEvenPages=15]="footerEvenPages",e[e.commentContent=16]="commentContent",e[e.shapeContainer=17]="shapeContainer",e[e.appsRole=18]="appsRole",e[e.appRole=19]="appRole",e[e.appRefRole=20]="appRefRole",e[e.appPropRole=21]="appPropRole",e[e.appBindingRole=22]="appBindingRole",e[e.customXmlRootRole=23]="customXmlRootRole",e[e.customXmlRole=24]="customXmlRole",e[e.contentControlRootRole=25]="contentControlRootRole",e[e.contentControlRole=26]="contentControlRole",e[e.notesContent=27]="notesContent",e[e.glossaryPageManifestRole=28]="glossaryPageManifestRole",e[e.glossaryPageContentRole=29]="glossaryPageContentRole",e[e.bookmarkContainerRole=30]="bookmarkContainerRole",e[e.shadowNumberListRole=31]="shadowNumberListRole",e[e.slideMasterContentRole=32]="slideMasterContentRole",e[e.ocsVectorClockContainerRole=33]="ocsVectorClockContainerRole",e[e.pptSectionContent=34]="pptSectionContent",e[e.autoSaveParametersRole=35]="autoSaveParametersRole",e[e.promptTextRole=36]="promptTextRole",e[e.smartArtSubShapeRole=37]="smartArtSubShapeRole",e[e.taskContent=38]="taskContent",e[e.embeddedFontContainer=39]="embeddedFontContainer",e[e.embeddedFont=40]="embeddedFont",e[e.intelligenceRegion=41]="intelligenceRegion",e[e.intelligenceRejection=42]="intelligenceRejection",e[e.intelligenceContentLocator=43]="intelligenceContentLocator",e[e.intelligenceRoot=44]="intelligenceRoot",e[e.graphSpaceElement=45]="graphSpaceElement",e[e.graphSpaceContext=46]="graphSpaceContext",e[e.graphSpaceVersionHistoryContext=47]="graphSpaceVersionHistoryContext",e[e.graphSpaceFileReference=48]="graphSpaceFileReference",e[e.graphSpace=49]="graphSpace",e[e.graphSpaceContent=50]="graphSpaceContent",e[e.viewTarget=51]="viewTarget",e[e.selected=52]="selected",e[e.tempElement=53]="tempElement",e[e.widget=54]="widget",e[e.widgetTarget=55]="widgetTarget",e[e.text=56]="text",e[e.textStructure=57]="textStructure",e[e.noteTag=58]="noteTag",e[e.wetContent=59]="wetContent",e[e.countRoles=60]="countRoles",e[e.firstPersisted=1]="firstPersisted",e[e.lastPersisted=48]="lastPersisted",e[e.firstGraphSpaceRole=45]="firstGraphSpaceRole",e[e.lastGraphSpaceRole=49]="lastGraphSpaceRole",e[e.firstGraphSpaceContextRole=46]="firstGraphSpaceContextRole",e[e.lastGraphSpaceContextRole=47]="lastGraphSpaceContextRole"}($_||($_={})),(0,o.h)("6db7387f$ChildNodeRole",$_);var X_=n(253),Y_=function(){function e(){}return e.$$cctor=function(){e.rolesToIgnore=new ec.n($_,Boolean),e.rolesToIgnore.set_item(58,!0),e.rolesToIgnore.set_item(4,!0)},e.generalizeSelectionToOEs=function(t,n,i){var r=[];if(Gl.n.get_instance().get_item(104)&&t.get_isTableCellSelection()&&Ua.SelectionFactory.isTableFullSelectedForCellSelection(t)){(C=ha.g.createFromNode(t.get_currentSelection().get_tableSelectionContexts().get_firstContext().get_node())).tryToRootAtAncestorOfType(14);var o=Wa.y.create(C.get_origin()),a=e.AscendWhileNodeIsFirstAndOrLast(o,!0,!0,null);C.set(a),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(C),e.GeneralizeNodeToOE(C,r)}else for(var l=0;l<t.get_length()&&!(i&&r.length>0);++l){var s=t.get_item(l),u=e.getFirstOrLastGraphContext(s,!0),c=e.getFirstOrLastGraphContext(s,!1);if(u&&c)if(u!==c||u.get_contextId()!==ol.d.insertionPoint){var d=null,g=null,p=null,h=-1,_=void 0,m=void 0;if(u.get_node()===c.get_node())_=u.get_node(),m=c.get_node();else{d=e.GetAllAncestors(u.get_node()),g=e.GetAllAncestors(c.get_node());var f=void 0;for(f=0;f<d.length&&f<g.length&&d[f]===g[f];++f);p=d[f-1],h=f-1,_=e.AscendWhileNodeIsFirstAndOrLast(u,!0,!1,p),m=e.AscendWhileNodeIsFirstAndOrLast(c,!1,!0,p)}if(_===m){o=void 0;o=_===u.get_node()?u:Wa.y.create(_);a=e.AscendWhileNodeIsFirstAndOrLast(o,!0,!0,null);(C=new r_.z).set(a),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(C),e.GeneralizeNodeToOE(C,r)}else{for((C=new r_.z).set(_),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(C),_===p&&C.goToFirstChild(),e.GeneralizeNodeToOE(C,r);C.get_parentNode()!==p;){for(;C.goToNextSibling();)e.GeneralizeNodeToOE(C,r);C.returnToParent()}if(m===p)for(;C.goToNextSibling();)e.GeneralizeNodeToOE(C,r);else{C.goToNextSibling();for(f=h+1;f<g.length;++f){for(;;){if((y=C.get_currentNode())===g[f])break;e.GeneralizeNodeToOE(C,r),C.goToNextSibling()}if(m===g[f])break;C.goToFirstChild()}e.GeneralizeNodeToOE(C,r)}}}else{var y=u.get_node();(C=ha.g.createFromNode(y)).tryToRootAtAncestorOfType(11)&&e.GeneralizeNodeToOE(C,r)}}if(r.length<=0)return null;if(n){var C=new ha.g;for(l=0;l<r.length;++l)C.set(r[l].get_node()),_s.OutlineElementNavigator.moveToContent(C),r[l]=Wa.y.create(C.get_currentNode())}return j_.x.createSet(r)},e.getFirstOrLastGraphContext=function(e,t){if(t)for(var n=0;n<e.get_length();++n){if(e.get_item(n).get_isGraphNodeContext())return e.get_item(n);if(e.get_item(n).get_isContextSet())for(var i=e.get_item(n),r=0;r<i.get_length();++r)if(i.getContext(r).get_isGraphNodeContext())return i.getContext(r)}else for(n=e.get_length()-1;n>=0;--n){if(e.get_item(n).get_isGraphNodeContext())return e.get_item(n);if(e.get_item(n).get_isContextSet())for(r=(i=e.get_item(n)).get_length()-1;r>=0;--r)if(i.getContext(r).get_isGraphNodeContext())return i.getContext(r)}return null},e.GeneralizeNodeToOE=function(t,n){if(e.IsParentOfOutlienElement(t))e.FindAllOEsUnder(t,n);else if(!e.rolesToIgnore.containsKey(t.get_role())){var i=t.useAncestorOfType(11);!i||n.length&&n[n.length-1].get_node()===i||Array.add(n,Wa.y.create(i))}},e.GetAllAncestors=function(e){var t=[],n=new ha.g;for(n.set(e),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(n),Array.add(t,e);n.returnToParent();)Array.add(t,n.get_currentNode());return t.reverse(),t},e.AscendWhileNodeIsFirstAndOrLast=function(t,n,i,r){var o=t.get_node();if(ga.SelectionEditor.isTextRangeContext(t)){if(n&&t.get_cpBegin()>0)return o;if(i&&t.get_cpEnd()<Ga.ParagraphReader.textLength(o))return o}if(ga.SelectionEditor.isEndOfParagraphContext(t)&&n&&Ga.ParagraphReader.textLength(o)>0)return o;var a=new r_.z;for(a.set(o),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(a);!a.get_isAtOrigin();){if(r===(o=a.get_currentNode()))return o;if(n&&!e.IsFirstSignificantChild(a))return o;if(i&&!e.IsLastSignificantChild(a))return o;a.returnToParent()}return a.get_currentNode()},e.IsLastSignificantChild=function(t){var n=!0;if(t.goToNextSibling())for(n=!1;e.rolesToIgnore.containsKey(t.get_role())||Gl.n.get_instance().get_item(77)&&16===t.get_currentNodeType()&&js.TableCellReader.isGhostCell(t);)if(!t.goToNextSibling()){n=!0;break}return n},e.IsFirstSignificantChild=function(t){var n=t.get_currentNode(),i=!0;if(t.goToPreviousSibling())for(i=!1;e.rolesToIgnore.containsKey(t.get_role());)if(!t.goToPreviousSibling()){i=!0;break}return t.returnToParent(),t.goToChild(n),i},e.FindAllOEsUnder=function(t,n){var i=X_.z.createTraverserFromIterator(t);for(i.setFilter(e.FilterNonElementRoles,null);i.moveNext();)if(Ss.OutlineElementReader.isOutlineElementNode(i.get_currentNode())){var r=i.get_currentNode();Array.add(n,Wa.y.create(r))}},e.FilterNonElementRoles=function(t,n){return e.IsParentOfOutlienElement(t)},e.IsParentOfOutlienElement=function(e){return e.get_isAtOrigin()||1===e.get_role()||27===e.get_role()},e.rolesToIgnore=null,e}();(0,o.l)(Y_,"5adad57c$OutlineElementGeneralizer",null,[]),Y_.$$cctor();var Z_=function(){return function(){this.containingTable=null,this.controlCell=null,this.rowSpan=0,this.colSpan=0,this.response=0,this.response=2}}();(0,o.l)(Z_,"3d088497$ComplexCellData",null,[]);var em=n(4441),tm=n(4143),nm=n(4244),im=function(){function e(e){this._graph=null,this._graph=e;e.LockTempGraphAlgorithm()}return e.prototype.dispose=function(){this._graph.UnlockTempGraphAlgorithm()},e.createFromNode=function(t){return new e(t.get_containingGraph())},e}();(0,o.l)(im,"d45b3be5$TempGraphAlgorithmLock",null,[Sys.IDisposable]);var rm=function(){function e(t,n,i){this._pageContentEditor=null,this._doNotDeleteThisTable=null,this._topmostSelectableContentContainer=null,this._tempAlgorithmLock=null,this._refCount=0,this._deleteTableSegments=!1,this._deleteOutlineElementNodeStrategy=null,this._tableEditor=null,this._paragraphsToMerge=[],this._deadOutlineNodes=[],this._tableCellsList=[],this._columnDeletedCount={},this._oldRowCount={},this._anyRowDeleted={},this._topmostSelectableContentContainer=e.GetTopMostSelectableContentContainer(t),this._topmostSelectableContentContainer.maskTempAlgorithmPropagation(),this._tempAlgorithmLock=im.createFromNode(this._topmostSelectableContentContainer),e._currentNormalizer=this,this._refCount=1,this._deleteTableSegments=n,this._deleteOutlineElementNodeStrategy=i}return e.prototype.get_TableEditor=function(){return this._tableEditor||(this._tableEditor=Ge.w.get_instance().resolve(au.z))},e.prototype.get_IsContentControlEditingEnabled=function(){return!!e.get_ContentControlEditor()&&!!e.get_ContentControlConfigSettings()&&e.get_ContentControlConfigSettings().get_isContentControlEditingEnabled()},e.prototype.get_PageContentEditor=function(){return this._pageContentEditor||(this._pageContentEditor=Ge.w.get_instance().resolve(jh.m))},e.prototype.normalize=function(){if(!(--this._refCount>0)){var e=new Ma.GraphTransaction(7);e.setFromNode(this._topmostSelectableContentContainer),this.PruneDeletedNodes(),this.MergeAtEndsOfParagraphs(),this.FixDeadOutlines(),Gl.n.get_instance().get_item(63)&&this.CleanUpTableCells(),this.FixEmptyPage(),e.dispose(),this.CleanUp()}},e.prototype.setTableAsNotDeletable=function(e){this._doNotDeleteThisTable=e},e.prototype.FixEmptyPage=function(){var t=ha.g.createFromNode(this._topmostSelectableContentContainer);if(!t.hasChildren()){var n=this.get_PageContentEditor().createOutline(t);e.get_OutlineEditor().appendOutlineElement(t,!0);var i=yi.App.get_activeAppFrame().workspace.get_contentView();i.get_isPageView()&&e.get_OutlineEditor().setOutlineToDefaultPosition(n,i.getViewWidth())}},e.prototype.cancel=function(){if(!(--this._refCount>0)){var t=nm.p.createTraverser(this._topmostSelectableContentContainer);for(t.setFilter(e._canDeleteCheckFilterDelegate,null);t.moveNext();)t.get_iterator().get_isAtOrigin()||t.get_iterator().validateCoreChannel(16,!1);this.CleanUp()}},e.prototype.CleanUp=function(){this._topmostSelectableContentContainer.unmaskTempAlgorithmPropagation(),this._tempAlgorithmLock.dispose(),e._currentNormalizer=null},e.prototype.trackContext=function(t){if(t.get_isGraphNodeContext()){var n=t;e.IsUnlockedContext(n)&&Array.add(this._paragraphsToMerge,n.get_node()),this.trackNode(n.get_node())}else t.get_isContextSet()&&this.trackContextSet(t)},e.prototype.trackContextSet=function(e){for(var t=0;t<e.get_length();++t)this.trackContext(e.getContext(t))},e.prototype.trackNode=function(e){e.get_anchor().invalidateCoreChannel(16)},e.prototype.MergeAtEndsOfParagraphs=function(){for(var t=0;t<this._paragraphsToMerge.length;++t){var n=this._paragraphsToMerge[t];if(n.get_anchor()&&!n.get_anchor().get_isRetired()){var i=new ha.g;if(i.set(n),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(i))if(_s.OutlineElementNavigator.returnToOutlineElement(i),this._deleteOutlineElementNodeStrategy.canDeleteWithoutMerge(i))e.get_OutlineElementEditor().disconnectOutlineElement(i);else{var r=new r_.z;if(r.setFrom(i),_s.OutlineElementNavigator.moveToNextOutlineElement(r,!1,!1)&&36!==r.get_role()&&(_s.OutlineElementNavigator.moveToContent(r),!r.get_currentNode().get_isBlockContent()&&!us.TableReader.isTable(r))){_s.OutlineElementNavigator.returnToOutlineElement(r);var o=new ha.g;o.setFrom(r),o.returnToParent(),e.get_OutlineElementEditor().merge(i,r,!1,!1),Ss.OutlineElementReader.isOutlineGroup(o)&&!o.hasChildren()&&r.disconnectNodeAndReturnToParent()}}}}Array.clear(this._paragraphsToMerge)},e.prototype.CleanUpTableCells=function(){for(var t=0;t<this._tableCellsList.length;++t){var n=this._tableCellsList[t];if(n.get_anchor()&&!n.get_anchor().get_isRetired()&&!js.TableCellReader.isGhostCellNode(n)){var i=new ha.g;i.set(n),i.goToLastChildByRole(1),i.goToFirstChildByRole(2),us.TableReader.isTable(i)&&(i.returnToParent(),e.get_OutlineElementEditor().insertOutlineElementAsSibling(i,!1,!0,null))}}Array.clear(this._tableCellsList)},e.prototype.GetColumnListForTable=function(e){var t=e.get_id().toString();if(this._columnDeletedCount[t])return this._columnDeletedCount[t];for(var n=new Array(us.TableReader.getColumnCount(e)),i=0;i<us.TableReader.getColumnCount(e);++i)n[i]=0;return this._columnDeletedCount[t]=n,this._oldRowCount[t]=us.TableReader.getRowCount(e),n},e.prototype.PruneDeletedNodes=function(){var t=nm.p.createTraverser(this._topmostSelectableContentContainer);t.setFilter(e._canDeleteCheckFilterDelegate,null);for(var n=t.moveNext(),i=new ha.g,r=0;n;)if(t.get_iterator().get_isAtOrigin())this.CleanChildTempGraphAlgorithmBits(t.get_iterator()),n=t.moveNext();else if(this._deleteOutlineElementNodeStrategy.isParentOfDeletedOutlineElements(t.get_iterator())&&Array.add(this._deadOutlineNodes,t.get_iterator().get_currentNode()),Gl.n.get_instance().get_item(63)&&js.TableCellReader.isTableCell(t.get_iterator())&&Array.add(this._tableCellsList,t.get_iterator().get_currentNode()),e.CanIteratorBeDisconnected(t.get_iterator()))switch(t.get_iterator().get_currentNodeType()){case 16:var o=Pd.TableNavigator.getContainingTable(t.get_iterator());if(!this._deleteTableSegments||us.TableReader.isComplexTableNode(o)||js.TableCellReader.isGhostCell(t.get_iterator()))n=t.moveNext();else++this.GetColumnListForTable(o)[Fd.s.getColumnIndex(t.get_iterator())],n=t.moveNext();break;case 15:o=Pd.TableNavigator.getContainingTable(t.get_iterator());if(this._deleteTableSegments&&!us.TableReader.isComplexTableNode(o)){var a=o.get_id().toString();this._anyRowDeleted[a]=!0,i.setFrom(t.get_iterator()),n=t.moveNext(),this.get_TableEditor().deleteRows(i,1)}else n=t.moveNext();break;case 14:(u=t.get_iterator().get_currentNode())!==this._doNotDeleteThisTable?(n=t.moveNext(),this.get_IsContentControlEditingEnabled()&&e.get_ContentControlEditor().updateContentControlNodeStartEndObjectOnTableDeleted(u),i.setFrom(t.get_iterator()),n=t.moveNext(),e.get_OutlineElementEditor().disconnectOutlineElement(i)):(t.get_iterator().validateCoreChannel(16,!1),n=t.moveNext());break;case 23:i.setFrom(t.get_iterator()),n=t.moveNext(),i.disconnectNodeAndReturnToParent();break;case 11:r++,Qs.q.isInTitle(t.get_iterator())?(t.get_iterator().validateCoreChannel(16,!1),n=t.moveNext()):(i.setFrom(t.get_iterator()),gs.ListReader.isListOutlineElement(i)&&!this._deleteOutlineElementNodeStrategy.shouldFollowFirstSelectedOEAfterDelete(i,r)&&e.get_ListEditor().removeList(i),i.hasChildrenOfRole(2)?this._deleteOutlineElementNodeStrategy.shouldKeepOutlineElementAfterDelete(i,r)?n=t.moveNext():(i.setFrom(t.get_iterator()),n=t.moveNext(),e.get_OutlineElementEditor().disconnectOutlineElement(i)):(n=t.moveNext(),e.get_OutlineElementEditor().disconnectOutlineElement(i)));break;case 12:var l=t.get_iterator().get_currentNode();n=t.moveNext(),this.get_IsContentControlEditingEnabled()&&e.get_ContentControlEditor().updateContentControlNodeStartEndObjectOnParagraphDeleted(l);break;default:n=t.moveNext()}else{var s=!0;if(us.TableReader.isTable(t.get_iterator())&&this._deleteTableSegments){a=(u=t.get_currentNode()).get_id().toString();var u,c=this._columnDeletedCount[a],d=!1;if(c)for(var g=this._oldRowCount[a],p=us.TableReader.getColumnCount(u)-1;p>=0;--p)c[p]===g&&(this.get_TableEditor().deleteColumns(t.get_iterator(),p,1),d=!0);us.TableReader.getColumnCount(t.get_iterator().get_currentNode())?Gl.n.get_instance().get_item(30)&&(d||this._anyRowDeleted[a])&&us.TableReader.isSingleCellTable(t.get_iterator().get_currentNode())&&(i.setFrom(t.get_iterator()),Pd.TableNavigator.moveToFirstRow(i),Pd.TableNavigator.moveToFirstColumn(i),n=t.moveNext(),e.get_OutlineElementEditor().replaceContentWithContentOfOutline(t.get_iterator(),i)):(n=t.moveNext(),i.setFrom(t.get_iterator()),n=t.moveNext(),i.disconnectNodeAndReturnToParent(),s=!1)}s&&(t.get_iterator().validateCoreChannel(16,!1),n=t.moveNext())}this._columnDeletedCount={},this._oldRowCount={},this._anyRowDeleted={}},e.prototype.CleanChildTempGraphAlgorithmBits=function(e){if(e.goToFirstChild())do{e.validateCoreChannel(16,!1)}while(e.goToNextSiblingOrReturnToParent())},e.prototype.FixDeadOutlines=function(){for(var t=0;t<this._deadOutlineNodes.length;++t){var n=this._deadOutlineNodes[t];if(n.get_anchor()&&!n.get_anchor().get_isRetired()){var i=new ha.g;if(i.set(n),!fs.OutlineNavigator.moveToFirstOutlineElement(i)){if(i.get_currentNode().setValue(is.b.outlineElementChildLevel,ms.k.first),Gl.n.get_instance().get_item(41)&&10===i.get_currentNodeType()){var r=e.get_OutlineElementEditor().insertOutlineGroup(i,null,1);i.goToChild(r)}e.get_OutlineEditor().appendOutlineElement(i,!0)}}}Array.clear(this._deadOutlineNodes)},e.get_ListEditor=function(){return e._listEditor||(e._listEditor=Ge.w.get_instance().resolve(jl.v))},e.get_OutlineEditor=function(){return e._outlineEditor||(e._outlineEditor=Ge.w.get_instance().resolve(zl.a))},e.get_OutlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=Ge.w.get_instance().resolve(ql.p))},e.get_UnsupportedNodeEditor=function(){return tm.q.get_instance()},e.get_LockedRangeEditor=function(){return za.k.get_instance()},e.get_ContentControlEditor=function(){return e._contentControlEditor||(e._contentControlEditor=Ge.w.get_instance().tryResolve(q_.p))},e.get_ContentControlConfigSettings=function(){return e._contentControlConfigSettings||(e._contentControlConfigSettings=Ge.w.get_instance().tryResolve(Q_.i))},e.getNormalizer=function(t,n){return e._currentNormalizer?(e._currentNormalizer._refCount++,e._currentNormalizer):(e._currentNormalizer=new e(t,n,Ge.w.get_instance().resolve(em.j)),e._currentNormalizer)},e.GetTopMostSelectableContentContainer=function(e){var t=ha.g.createFromNode(e);return ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(t),t.returnToNodeMatchingCondition((function(e){return e.get_isTopmostSelectableContentContainer()})),t.get_currentNode()},e.IsUnlockedContext=function(t){var n=!1;return ga.SelectionEditor.isEndOfParagraphContext(t)&&(n=!Gl.n.get_instance().get_item(14)||!e.get_LockedRangeEditor().isEopContextInLockedRange(t)),!n&&Ga.ParagraphReader.isParagraphContext(t)&&(n=!Gl.n.get_instance().get_item(14)||!e.get_LockedRangeEditor().isParaContextInLockedRange(t)&&!t.get_node().getValueWithDefault(Boolean,os.j.isResilientEop,!1)),n},e.CanIteratorBeDisconnected=function(t){switch(t.get_currentNodeType()){case 12:return t.get_currentNode().get_canBeDisconnectedDuringDelete()}if(!t.goToFirstChild())return!e.get_UnsupportedNodeEditor().isUnsupported(t)||e.get_UnsupportedNodeEditor().canBeDeleted(t.get_currentNode());var n=!0;do{switch(t.get_role()){case 2:case 1:case 3:case 56:case 57:16&t.get_invalidSubGraphCoreState()||16===t.get_currentNodeType()&&js.TableCellReader.isGhostCell(t)||(n=!1)}t.validateCoreChannel(16,!0)}while(t.goToNextSiblingOrReturnToParent());return n&&e.get_UnsupportedNodeEditor().isUnsupported(t)&&(n=e.get_UnsupportedNodeEditor().canBeDeleted(t.get_currentNode())),n},e.CanDeleteCheckFilter=function(e,t){return e.get_isAtOrigin()||!!(16&e.get_invalidSubGraphCoreState())},e._canDeleteCheckFilterDelegate=e.CanDeleteCheckFilter,e._currentNormalizer=null,e._eventSource=new at.f,e._outlineEditor=null,e._listEditor=null,e._outlineElementEditor=null,e._contentControlEditor=null,e._contentControlConfigSettings=null,e}();(0,o.l)(rm,"4e4e238f$GraphStructureNormalizer",null,[]);var om=function(){return function(){this.processContexts=null,this.containingTable=null,this.response=0,this.singleElement=null,this.numberOfOperations=0,this.response=2}}();(0,o.l)(om,"c71c38af$TableGeneralizeData",null,[]);var am=n(5381),lm=n(7754),sm=function(){function e(){}return e.get_ContextSetEditor=function(){return am.ContextSetEditor.get_instance()},e.performGenericViewLevelAction=function(t,n,i,r,o,a,l){var s=!1;if(a&&a[e.viewActionCollapseIp]&&a[e.viewActionCollapseIp]&&(s=!0),!n.view.get_isInteractiveView())return 2;var u,c=n.view,d=c.get_selectionManager();if(1===i)return d&&d.get_selectionCollection().get_currentSelection()?(u=l?e.get_ContextSetEditor().generalizeContextToSetOfType(n.get_nextContext(),l,!0):n.get_nextContext(),L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(u,t,i,!0,r,o)):8;a&&a[e.viewActionPerfMarkStart]&&Dr.t.mark(a[e.viewActionPerfMarkStart]);var g=lm.a.get_instance().createReferenceToCurrentSelection(),p=d.get_selectionCollection().get_currentSelection().get_firstContext(),h=new Ma.GraphTransaction(15);h.setFromNode(p.get_node()),h.setAllViewsToUpdate(),u=l?e.get_ContextSetEditor().generalizeContextToSetOfType(n.get_nextContext(),l):n.get_nextContext();var _=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(u,t,i,!0,r,o);return 32===_&&g.restoreSelection(s),St.FocusManager.instance().setScope(c.get_focusScopeId()),h.dispose(),yi.App.get_activeAppFrame().updateCommandUI(),a&&a[e.viewActionPerfMarkEnd]&&Dr.t.mark(a[e.viewActionPerfMarkEnd]),_},e.performGenericViewLevelActionAgainstOEs=function(t,n,i,r,o,a){var l,s=fa.SelectionManager.get_instance(),u=!1;if(a&&a[e.viewActionCollapseIp]&&a[e.viewActionCollapseIp]&&(u=!0),1===i)return s&&s.get_selectionCollection().get_currentSelection()&&(l=Y_.generalizeSelectionToOEs(s.get_selectionCollection(),!1,!0))?L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(l,t,i,!0,r,o):8;a&&a[e.viewActionPerfMarkStart]&&Dr.t.mark(a[e.viewActionPerfMarkStart]);var c=lm.a.get_instance().createReferenceToCurrentSelection(),d=s.get_selectionCollection().get_currentSelection().get_firstContext();if(!(l=Y_.generalizeSelectionToOEs(s.get_selectionCollection(),!1)))return 8;var g=new Ma.GraphTransaction(15);g.setFromNode(d.get_node()),g.setAllViewsToUpdate();var p=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(l,t,i,!0,r,o);32===p&&c.restoreSelection(u);var h=n.view;return h&&St.FocusManager.instance().setScope(h.get_focusScopeId()),g.dispose(),yi.App.get_activeAppFrame().updateCommandUI(),a&&a[e.viewActionPerfMarkEnd]&&Dr.t.mark(a[e.viewActionPerfMarkEnd]),p},e.viewActionPerfMarkStart="PerfMarkStart",e.viewActionPerfMarkEnd="PerfMarkEnd",e.viewActionCollapseIp="CollapseIp",e}();(0,o.l)(sm,"5f6b79ca$ViewActionHandler",null,[]);var um=n(216),cm=n(1240),dm=n(4156),gm=function(){return function(){this.controlCell=null,this.rowOffset=0,this.colOffset=0,this.firstGhostCellInSameRow=null,this.firstGhostCellInSameColumn=null}}();(0,o.l)(gm,"1eff2558$MergedCellInfo",null,[]);var pm=n(8524),hm=n(2726),_m=n(8773),mm=n(9192),fm=n(9413),ym=n(1653),Cm=function(){function e(t,n){e._outlineEditor=t,e._outlineElementEditor=n}return e.prototype.handlePargraphDeletion=function(e){},e.prototype.setNewWordTableColumnWidth=function(e,t){},e.prototype.setNewWordTableLayout=function(e){},e.prototype.getTableWidthMus=function(e){return 0},e.prototype.setColumnWidths=function(e){},e.prototype.setTableAndParentTableColumnWidths=function(e){},e.prototype.resetRowAndColumnCountsUpdatingSpans=function(e){var t=e.tableIterator.get_currentNode();this.UpdateGhostCellsWithoutControllingCell(t);var n=this.CountColumnsOnTable(t),i=this.GetTableStructure(t,n),r=i.length;e.deletedRows=this.FindRowsToDelete(i),e.deletedColumns=this.FindColumnsToDelete(i);var o=e.deletedRows.toArray().length,a=e.deletedColumns.toArray().length;(o>0||a>0)&&(r-=o,n-=a,this.UpdateTableCellSpans(e)),this.setRowCount((0,y.e)(mm.k,t),r),this.setColumnCount((0,y.e)(mm.k,t),n),this.ResetColumnWidths(e)},e.prototype.FindColumnsToDelete=function(e){for(var t=new C.c(Number),n=0;n<e[0].length;n++){for(var i=!0,r=0;r<e.length;r++)if(1===e[r][n]){i=!1;break}i&&t.add(n)}return t},e.prototype.FindRowsToDelete=function(e){for(var t=new C.c(Number),n=0;n<e.length;n++){for(var i=!0,r=0;r<e[n].length;r++)if(1===e[n][r]){i=!1;break}i&&t.add(n)}return t},e.prototype.CountColumnsOnTable=function(e){var t=0,n=ha.g.createFromNode(e);Pd.TableNavigator.moveToFirstRow((0,y.e)(ha.g,n)),Pd.TableNavigator.moveToFirstColumn((0,y.e)(ha.g,n));for(var i=(0,y.e)(cm.v,n.get_currentINode()),r=!1;i;)!i.get_isGhostCell()||js.TableCellReader.isSkippedCell((0,y.e)(mm.k,i))?(t+=i.get_hasColSpan()?i.get_colSpan():1,r=!0):r||t++,i=(0,y.e)(cm.v,Pd.TableNavigator.moveToNextColumn((0,y.e)(ha.g,n)));return t},e.prototype.UpdateTableCellSpans=function(e){var t=e.tableIterator.get_currentINode(),n=ha.g.createFromNode(t),i=0;Pd.TableNavigator.moveToFirstRow((0,y.e)(ha.g,n));for(var r=n.get_currentINode(),o=np.j.pixelsToMu(fm.k.minimumRowHeightInPixels,1);r;){for(;e.deletedRows.contains(i);)i++;var a=1,l=e.sourceCellLocation?e.sourceCellLocation.rowIndex:0,s=e.sourceRowHeights[l+i];for(s<o&&(s=o);e.deletedRows.contains(i+a);){var u=e.sourceRowHeights[l+i+a];u<o&&(u=o),s+=u,a++}r.setValue(os.j.tableRowHeight,s);var c=a-1,d=0;Pd.TableNavigator.moveToFirstColumn((0,y.e)(ha.g,n));for(var g=(0,y.e)(cm.v,n.get_currentINode());g;){var p=g.get_hasColSpan()?g.get_colSpan():1;g.get_hasRowSpan()&&g.get_rowSpan();if(!g.get_isGhostCell()||p>1){c>0&&(g.set_rowSpan(g.get_rowSpan()-c),g.get_rowSpan()<1&&g.set_rowSpan(1));for(var h=0,_=1;_<p;_++)e.deletedColumns.contains(d+_)&&h++;h>0&&(g.set_colSpan(g.get_colSpan()-h),g.get_colSpan()<1&&g.set_colSpan(1))}d+=p,g=(0,y.e)(cm.v,Pd.TableNavigator.moveToNextColumn((0,y.e)(ha.g,n)))}i++,Pd.TableNavigator.moveToFirstColumn((0,y.e)(ha.g,n)),n.returnToParent(),r=Pd.TableNavigator.moveToNextRow((0,y.e)(ha.g,n))}},e.prototype.UpdateGhostCellsWithoutControllingCell=function(e){var t=new C.c(Number),n=ha.g.createFromNode(e);Pd.TableNavigator.moveToFirstRow((0,y.e)(ha.g,n));for(var i=n.get_currentINode();i;){var r=!1,o=0;Pd.TableNavigator.moveToFirstColumn((0,y.e)(ha.g,n));for(var a=(0,y.e)(pm.TableCellNode,n.get_currentNode());a;){if(a.get_isGhostCell())a.get_hasColSpan()?(r=!0,t.contains(o)||(a.set_isGhostCell(!1),a.clearCellSpans())):js.TableCellReader.isSkippedCell((0,y.e)(mm.k,a))||t.contains(o)&&(r||Gl.n.get_instance().get_item(77))||(a.set_isGhostCell(!1),a.clearCellSpans());else{r=!0;for(var l=a.get_hasColSpan()?a.get_colSpan():1,s=0;s<l;s++)t.contains(o+s)||t.add(o+s)}o++,a=(0,y.e)(pm.TableCellNode,Pd.TableNavigator.moveToNextColumn((0,y.e)(ha.g,n)))}Pd.TableNavigator.moveToFirstColumn((0,y.e)(ha.g,n)),n.returnToParent(),i=Pd.TableNavigator.moveToNextRow((0,y.e)(ha.g,n))}},e.prototype.GetTableStructure=function(e,t){var n=[],i=0,r=ha.g.createFromNode(e);Pd.TableNavigator.moveToFirstRow((0,y.e)(ha.g,r));for(var o=r.get_currentINode();o;){var a=0;Pd.TableNavigator.moveToFirstColumn((0,y.e)(ha.g,r));for(var l=(0,y.e)(cm.v,r.get_currentINode());l;){if(!l.get_isGhostCell()||js.TableCellReader.isSkippedCell((0,y.e)(mm.k,l))){for(var s=l.get_hasColSpan()?l.get_colSpan():1,u=l.get_hasRowSpan()?l.get_rowSpan():1;i<n.length&&2===n[i][a];)a++,(a%=t)||i++;for(var c=0;c<u;c++){var d=i+c;d===n.length&&Array.add(n,new Array(t));for(var g=0;g<s;g++)n[d][a+g]=c>0||g>0?2:1}a+=s}l=(0,y.e)(cm.v,Pd.TableNavigator.moveToNextColumn((0,y.e)(ha.g,r)))}Pd.TableNavigator.moveToFirstColumn((0,y.e)(ha.g,r)),r.returnToParent(),o=Pd.TableNavigator.moveToNextRow((0,y.e)(ha.g,r)),i++}return n},e.prototype.ResetColumnWidths=function(e){if(us.TableReader.isTable(e.tableIterator)&&e.sourceCellLocation&&e.sourceColumnWidths){for(var t=(0,y.e)(um.w,e.tableIterator.get_currentINode()),n=e.sourceColumnWidths,i=new Array(t.get_columnCount()),r=e.sourceCellLocation.columnIndex,o=0;o<i.length;o++)for(i[o]=n[r],r++;e.deletedColumns.contains(r-e.sourceCellLocation.columnIndex);)i[o]+=n[r],r++;t.set_columnWidths(i)}},e.prototype.GetTableCellWidth=function(e){var t=(0,y.e)(cm.v,e.get_currentNode());return t?t.get_width():0},e.prototype.updateMergeCellInfo=function(e){var t=this;(Gl.n.get_instance().get_item(77)||Gl.n.get_instance().get_item(63))&&(Pd.TableNavigator.forEachCellInTable(e,(function(e,t,n){return e.get_currentNode().set_mergeCellInfo(null),!0})),Pd.TableNavigator.forEachCellInTable(e,(function(e,n,i){var r=e.get_currentNode();if(!r.get_isGhostCell()){var o=r.get_rowSpan(),a=r.get_colSpan();o>1||a>1?t.createMergeCell(e,o,a):r.resetCellSpansToDefault()}return!0})))},e.prototype.createMergeCell=function(e,t,n){var i=this,r=e.get_currentNode(),a=new ha.g;a.setFrom(e),Pd.TableNavigator.forEachCell(a,t,n,(function(t,a,l){var s=t.get_currentNode();s!==r&&(s.set_isGhostCell(!0),t.goToFirstChildByRole(1),o.r(dm.w,t.get_currentNode())&&(Ss.OutlineElementReader.isEmpty(t,!1)||e.addChild(t.get_currentNode(),1),i.handlePargraphDeletion(t),t.disconnectNodeAndReturnToParent())),s.set_mergeCellInfo((0,U.m)(new gm,{controlCell:r,rowOffset:a,colOffset:l})),1!==a||l||(r.get_mergeCellInfo().firstGhostCellInSameColumn=s),a||1!==l||(r.get_mergeCellInfo().firstGhostCellInSameRow=s),s.resetCellSpansToDefault(),l||s.set_colSpan(n)})),r.set_rowSpan(t),r.set_colSpan(n)},e.prototype.createSplitCell=function(e,t,n){var i=new ha.g;if(i.setFrom(e),n>1&&this.SplitCell(i,n,!1),t>1)for(var r=e.get_currentNode().get_colSpan(),o=0;o<n;o++){this.SplitCell(i,t,!0);for(var a=0;a<r;a++)Pd.TableNavigator.moveToNextColumn(i)}Pd.TableNavigator.returnToContainingTable(i),this.updateMergeCellInfo(i)},e.prototype.SplitCell=function(t,n,i){if(!(n<=1)){var r=t.get_currentNode(),o=new ha.g;o.setFrom(t);var a=e.getCellSpan(r,i);if(1===a){i?this.SetNewRowHeightWhenSplitting(o,n):this.SetNewColumnWidthWhenSplitting(o,n);for(var l=0;l<n-1;l++)i?this.insertDeadRow(o):this.insertDeadCol(o);this.SplitCell(t,n,i)}else if(a%n){if(!(n%a)){this.SplitCell(o,a,i);for(l=0;l<a;l++){s=n/a;this.SplitCell(o,s,i);for(d=0;d<s;d++)i?Pd.TableNavigator.moveToNextRow(o):Pd.TableNavigator.moveToNextColumn(o)}}}else{var s=a/n,u=i?s:r.get_rowSpan(),c=i?r.get_colSpan():s;e.setCellSpan(t.get_currentNode(),i,s);for(var l=0;l<n;l++){l>0&&this.promoteToNonGhostCellImpl(o,t),(u>1||c>1)&&this.createMergeCell(o,u,c);for(var d=0;d<s;d++)i?Pd.TableNavigator.moveToNextRow(o):Pd.TableNavigator.moveToNextColumn(o)}}}},e.prototype.SetNewColumnWidthWhenSplitting=function(e,t){var n=new ha.g;n.setFrom(e);var i=Fd.s.getColumnIndex(e);Pd.TableNavigator.returnToContainingTable(n);var r=n.get_currentNode().getValueWithDefault(Array,is.b.tableColumnWidths,null);r&&((r=tc.p.clone(r))[i]=r[i]/t,n.get_currentNode().setValue(is.b.tableColumnWidths,r))},e.prototype.SetNewRowHeightWhenSplitting=function(e,t){var n=np.j.pixelsToMu(fm.k.minimumRowHeightInPixels,1),i=new ha.g;i.setFrom(e),Pd.TableNavigator.returnToContainingRow(i);var r=i.get_currentNode().getValueWithDefault(Number,os.j.tableRowHeight,0);r>n*t?i.get_currentNode().setValue(os.j.tableRowHeight,r/t):i.get_currentNode().removeProperty(os.j.tableRowHeight)},e.prototype.insertDeadRow=function(e){var t=new ha.g;t.setFrom(e),Pd.TableNavigator.returnToContainingRow(t);var n=t.get_currentNode();t.goToFirstChildByRole(1);var i=new ha.g;i.setFrom(e),Pd.TableNavigator.returnToContainingTable(i);var r=i.get_currentNode();this.updateMergeCellInfo(i);var o=ds.u.get_instance().createInstance(393251);this.insertRowNode(i,o,n,n,!1),i.goToChild(o);for(var a=us.TableReader.getColumnCount(r),l=0;l<a;++l){var s=t.get_currentNode(),u=this.createTableCellNode();if(this.addCellNode(i,u,s,!1,!0),!u.get_isGhostCell())if(s.get_isGhostCell()){var c=void 0;(c=s.get_mergeCellInfo().controlCell).set_rowSpan(c.get_rowSpan()+1)}else s.set_rowSpan(2);t.goToNextSiblingByRole(1)}return this.setRowCount(r,us.TableReader.getRowCount(r)+1),Pd.TableNavigator.returnToContainingTable(i),this.updateMergeCellInfo(i),o},e.prototype.insertDeadCol=function(e){var t=ha.g.createFromNode(e.useIAncestorOfType(14)),n=us.TableReader.getColumnCount(t.get_currentNode()),i=Fd.s.getColumnIndex(e),r=i+1;this.updateMergeCellInfo(t),t.goToFirstChildByRole(1);do{var o=t.goToChildIndexByRole(i,1);t.returnToParent();var a=this.createTableCellNode();if(this.insertCellNode(t,a,o,!1,!1),!a.get_isGhostCell())if(o.get_isGhostCell()){var l=void 0;(l=o.get_mergeCellInfo().controlCell).set_colSpan(l.get_colSpan()+1)}else o.set_colSpan(2)}while(t.goToNextSiblingByRoleOrReturnToParent(1));this.updateMergeCellInfo(t);var s=t.get_currentNode().getValueWithDefault(Array,is.b.tableColumnWidths,null);return s&&(s=tc.p.clone(s)),this.setColumnCount(t.get_currentNode(),++n),s&&(Array.insert(s,r,s[i]),t.get_currentNode().setValue(is.b.tableColumnWidths,s)),this.onInsertColumnsCompleted(t.get_currentNode(),r,!1,1,null),r},e.prototype.removeDeadCells=function(e,t){var n=this;us.TableReader.isComplexTableNode(e.get_currentNode())&&Gl.n.get_instance().get_item(63)&&this.removeDeadCellsImpl(e,(function(e){return n.GetHeightFromRow(e,t)}),(function(e,t){e.setProperty_Unchecked(os.j.tableRowHeight,t)}),os.j.complexTable)},e.prototype.handleInsertCellWithMerged=function(t,n,i,r){var o=n,a=n.get_mergeCellInfo();if(Gl.n.get_instance().get_item(77)&&t.set_isGhostCell(!1),a)if(e.getOffSet(a,!r))t.set_isGhostCell(!0);else{var l=e.getCellSpan(a.controlCell,r);!n.get_isGhostCell()&&i||!i&&e.getOffSet(a,r)===l-1?(o=a.controlCell,!r&&o.get_hasRowSpan()&&t.set_rowSpan(o.get_rowSpan())):(t.set_isGhostCell(!0),e.setCellSpan(a.controlCell,r,l+1)),r&&o.get_hasColSpan()&&t.set_colSpan(o.get_colSpan())}return o},e.prototype.handleDeleteCell=function(t,n,i){var r=t.get_mergeCellInfo();if(r)if(t.get_isGhostCell())this.handleGhostCellDeletion(t,r,n);else{var o=e.getCellSpan(t,n);if(o>1){var a=e.getCellSpan(t,!n),l=new ha.g;l.set(t),l.tryToRootAtAncestorOfType(14);var s=new ha.g;s.setFrom(l);var u=n?Pd.TableNavigator.moveToNextRow(s):s.goToNextSiblingByRole(1);e.setCellSpan(u,n,o-1),e.setCellSpan(u,!n,a),i(s,l)}}},e.prototype.handleGhostCellDeletion=function(t,n,i){if(!e.getOffSet(n,!i)){var r=e.getCellSpan(n.controlCell,i);e.setCellSpan(n.controlCell,i,r-1)}},e.prototype.updateIsComplexTableProperty=function(e,t){var n=!1;Pd.TableNavigator.forEachCellInTable(e,(function(e,t,i){return!js.TableCellReader.isGhostCell(e)||(n=!0,!1)})),e.get_currentNode().setProperty_Unchecked(t,n)},e.prototype.removeDeadCellsImpl=function(e,t,n,i){var r=us.TableReader.getRowCount(e.get_currentNode()),o=us.TableReader.getColumnCount(e.get_currentNode());if(r&&o){var a=!1,l=!1,s=new Array(r);Pd.TableNavigator.forEachCellInTable(e,(function(e,t,n){n||(s[t]=new Array(o));var i=e.get_currentNode();return i.get_isGhostCell()?js.TableCellReader.isSkippedCell(i)?s[t][n]=2:s[t][n]=1:s[t][n]=0,!0}));for(var u=new Array(r),c=new Array(r),d=0;d<r;d++){for(var g=!!d,p=!0,h=0;h<o;h++){if(!s[d][h]){g=!1,p=!1;break}1===s[d][h]?p=!1:d&&2===s[d-1][h]||(g=!1)}u[d]=g,c[d]=p}for(d=r-1;d>=0;d--)if(c[d])e.goToChildIndexByRole(d,1),this.deleteRows(e,1),Array.removeAt(s,d),a=!0;else if(u[d]&&t){e.goToChildIndexByRole(d,1);var _=e.getPreviousSiblingByRole(1);n(_,t(e.get_currentNode())+t(_)),this.deleteRows(e,1),Array.removeAt(s,d),a=!0}if((r=s.length)>0){u=new Array(o),c=new Array(o);for(h=0;h<o;h++){var m=!!h,f=!0;for(d=0;d<r;d++){if(!s[d][h]){m=!1,f=!1;break}1===s[d][h]?f=!1:h&&2===s[d][h-1]||(m=!1)}u[h]=m,c[h]=f}var y=e.get_currentNode().getValueWithDefault(Array,is.b.tableColumnWidths,null),C=!1;if(y){C=!0,y=Array.clone(y);for(d=0;d<y.length;d++)if(!y[d]){C=!1;break}}for(h=o-1;h>=0;h--)c[h]?(y&&Array.removeAt(y,h),this.deleteColumns(e,h,1),l=!0):u[h]&&C&&(y[h-1]+=y[h],Array.removeAt(y,h),this.deleteColumns(e,h,1),l=!0);l&&y&&e.get_currentNode().setValue(is.b.tableColumnWidths,y)}(a||l)&&this.updateIsComplexTableProperty(e,i)}},e.prototype.GetHeightFromRow=function(e,t){var n=Dd.v.getRowHeightInMu(e);if(!n){var i=e.getHtmlViewElement(t);i&&(n=Vu.r.pointsToMu(i.get_htmlElement().offsetHeight))}return n},e.prototype.get_tableLoggingCategory=function(){return e._tableLoggingCategory},e.prototype.setRowCount=function(e,t){us.TableReader.getRowCount(e)!==t&&e.get_properties().setValue(is.b.tableRowCount,t)},e.prototype.setColumnCount=function(e,t){var n=us.TableReader.getColumnCount(e);n!==t&&(t&&n&&e.get_properties().removeProperties(is.b.tableColumnWidths,is.b.tableLockedColumns),e.get_properties().setValue(is.b.tableColumnCount,t))},e.prototype.createTable=function(e,t,n,i,r,o){void 0===i&&(i=null),void 0===r&&(r=!1),void 0===o&&(o=!1);var a=this.CreateTableInternal(e,t,n);return Gl.n.get_instance().get_item(71)&&bs.StyleReader.get_tableStyleReader()&&bs.StyleReader.get_tableStyleReader().onBeforeTableInsert(a),this.FinishCreateTable(a,t,n,i,r,o),Gl.n.get_instance().get_item(71)&&bs.StyleReader.get_tableStyleReader()&&bs.StyleReader.get_tableStyleReader().onAfterTableInsert(a),a},e.prototype.CreateTableInternal=function(e,t,n){if(Gl.n.get_instance().get_item(63)&&us.TableReader.isInTable(e)){var i=Pd.TableNavigator.getContainingTable(e);i&&this.setColumnWidths(i)}var r=ds.u.get_instance().createInstance(393250);return e.addChild(r,2),e.goToChild(r),r},e.prototype.recreatePastedTable=function(e,t,n,i,r,o,a){var l=this.CreateTableInternal(e,t,n);return Gl.n.get_instance().get_item(71)&&bs.StyleReader.get_tableStyleReader()&&bs.StyleReader.get_tableStyleReader().decorateNewTable(l,i,r),this.FinishCreateTable(l,t,n,o,!1,a),S.ULS.sendTraceTag(50373653,324,50,String.format("Table pasted: TableId={0}, RowCount={1}, ColumnCount={2}",l.get_id().toString(),t,n)),l},e.prototype.FinishCreateTable=function(e,t,n,i,r,o){void 0===i&&(i=null),void 0===r&&(r=!1),void 0===o&&(o=!1);var a=ha.g.createFromNode(e);this.createRowsAndColumns(a,t,n,i,r),this.setRowCount(e,t),this.setColumnCount(e,n),Gl.n.get_instance().get_item(63)&&(this.setNewWordTableColumnWidth(e,n),this.setNewWordTableLayout(e)),e.setValue(is.b.tableBordersVisible,!o)},e.prototype.createRowsAndColumns=function(e,t,n,i,r){void 0===i&&(i=null),void 0===r&&(r=!1);for(var o=0;o<t;++o){var a=new _m.o;e.addChild(a,1),Gl.n.get_instance().get_item(55)&&a.setValue(os.j.wordId,as.s.randomUInt31())}var l=null,s=!0;e.goToFirstChildByRole(1);do{for(var u=0;u<n;++u){var c=this.createTableCellNode();e.addChild(c,1),this.finishCell(e,c,r,i,(0,g.m)((function(){return l}),(function(e){return l=e})),(0,g.m)((function(){return s}),(function(e){return s=e}))),Pd.TableNavigator.returnToContainingRow(e)}}while(e.goToNextSiblingByRoleOrReturnToParent(1))},e.prototype.finishCell=function(t,n,i,r,o,a){t.goToChild(n),o.val&&i?e._outlineElementEditor.cloneEmptyParagraphElement(t,o.val):(e._outlineEditor.appendOutlineElement(t,!0,r),!a.val&&i&&(o.val=new ha.g,o.val.setFrom(t)),a.val=!1)},e.prototype.insertRows=function(e,t,n,i){var r=new ha.g;r.setFrom(e);var o,a=r.get_currentNode();r.goToFirstChildByRole(1);var l=Dd.v.getRowIndex(e);t?o=e.goToPreviousSiblingByRole(1):(o=e.get_currentNode(),l++);var s=e.returnToParent();Gl.n.get_instance().get_item(63)&&this.setTableAndParentTableColumnWidths(e.get_currentNode()),this.updateMergeCellInfo(e);for(var u=null,c=null,d=0;d<n;++d){var g=ds.u.get_instance().createInstance(393251);c||(c=g),u=g,this.insertRowNode(e,g,o,a,t)}var p=us.TableReader.getColumnCount(e.get_currentNode()),h=!0;do{h?(e.goToChild(u),h=!1):e.goToNextSiblingByRole(1);for(var _=0;_<p;++_){var m=this.createTableCellNode(),f=this.addCellNode(e,m,r.get_currentNode(),t,!0);this.appendNonGhostCellOutlineElement(e,m,i(f)),r.goToNextSiblingByRole(1)}r.goToFirstSiblingByRole(1)}while(e.get_currentNode()!==c);return this.setRowCount(s,us.TableReader.getRowCount(s)+n),this.onInsertRowsCompleted(s,t,l,n),e.get_currentNode()},e.prototype.deleteRows=function(e,t){var n=Dd.v.getRowIndex(e),i=n+t;e.returnToParent(),Gl.n.get_instance().get_item(63)&&this.setTableAndParentTableColumnWidths(e.get_currentNode()),this.updateMergeCellInfo(e);for(var r=i-1;r>=n;--r){e.goToChildIndexByRole(r,1);for(var o=e.goToFirstChildByRole(1);o;)this.onCellDeleted(o,!0),o=e.goToNextSiblingByRoleOrReturnToParent(1);this.handlePargraphDeletion(e),e.disconnectNodeAndReturnToParent()}this.setRowCount(e.get_currentNode(),us.TableReader.getRowCount(e.get_currentNode())-t),this.onDeleteRowsCompleted(e,n,t)},e.prototype.insertColumns=function(e,t,n,i,r){Gl.n.get_instance().get_item(63)&&this.setTableAndParentTableColumnWidths(e.get_currentNode()),this.updateMergeCellInfo(e);var o=us.TableReader.getColumnCount(e.get_currentNode());-1===t&&(t=o);var a=n?t:t-1;e.goToFirstChildByRole(1);do{var l=e.goToChildIndexByRole(a,1);e.returnToParent();new Array(i);for(var s=0;s<i;++s){var u=this.createTableCellNode(),c=this.insertCellNode(e,u,l,n,!1);this.appendNonGhostCellOutlineElement(e,u,r(c))}}while(e.goToNextSiblingByRoleOrReturnToParent(1));o+=i,this.recomputeAndSetColumnWidthsAfterColInsertion(e,o,i,t,n),this.onInsertColumnsCompleted(e.get_currentNode(),t,n,i,r)},e.prototype.recomputeAndSetColumnWidthsAfterColInsertion=function(e,t,n,i,r){var o=e.get_currentNode().getValueWithDefault(Array,is.b.tableLockedColumns,null),a=e.get_currentNode().getValueWithDefault(Array,is.b.tableColumnWidths,null);if(o&&(o=tc.p.clone(o)),a&&(a=tc.p.clone(a)),this.setColumnCount(e.get_currentNode(),t),Gl.n.get_instance().get_item(30)&&o){for(var l=new Array(t),s=0;s<i;++s)l[s]=o[s];for(;s<i+n;++s)l[s]=!1;for(;s<t;++s)l[s]=o[s-n];e.get_currentNode().setValue(is.b.tableLockedColumns,l)}if(a){var u=this.ajustColumnWidthsAfterInsertColumn(e,a,t,i,r,n);e.get_currentNode().setValue(is.b.tableColumnWidths,u)}},e.prototype.ajustColumnWidthsAfterInsertColumn=function(e,t,n,i,r,o){for(var a=new Array(n),l=0,s=0;l<i;++l)a[l]=t[l],s+=a[l];for(;l<n;++l)a[l]=l-o<0?t[0]:t[l-o],s+=a[l];if(Gl.n.get_instance().get_item(63)){var u=this.getTableWidthMus(e.get_currentNode());if(s>u){var c=u/s;for(l=0;l<n;++l)a[l]=Math.max(np.j.pixelsToMu(ym.u.get_tableCellMinTotalWidth(),0),a[l]*c)}}return a},e.prototype.onInsertColumnsCompleted=function(e,t,n,i,r){},e.prototype.onInsertRowsCompleted=function(e,t,n,i){},e.prototype.insertRowNode=function(t,n,i,r,o){t.insertChildUsingId(n,i,1,e._getIdForNewCell?e._getIdForNewCell():null)},e.prototype.insertCellNode=function(t,n,i,r,o){t.goToChild(i);var a=r?t.getPreviousSiblingByRole(1):i;return t.returnToParent(),t.insertChildUsingId(n,a,1,e._getIdForNewCell?e._getIdForNewCell():null),i},e.prototype.getNodeToInsertAfter=function(e,t,n){e.goToChild(t);var i=n?e.getPreviousSiblingByRole(1):t;return e.returnToParent(),i},e.prototype.addCellNode=function(t,n,i,r,o){return t.addChildUsingId(n,1,e._getIdForNewCell?e._getIdForNewCell():null),i},e.prototype.copyCells=function(e,t,n,i,r){return n},e.prototype.appendNonGhostCellOutlineElement=function(t,n,i){js.TableCellReader.isGhostCellNode(n)||(t.goToChild(n),e._outlineEditor.appendOutlineElement(t,!0,i),Pd.TableNavigator.returnToContainingRow(t))},e.prototype.deleteColumns=function(e,t,n){Gl.n.get_instance().get_item(63)&&this.setTableAndParentTableColumnWidths(e.get_currentNode()),this.updateMergeCellInfo(e);var i=us.TableReader.getColumnCount(e.get_currentNode());-1===t&&(t=i-n),e.goToFirstChildByRole(1);do{for(var r=t+n-1;r>=t;--r)e.goToChildIndexByRole(r,1),this.onCellDeleted(e.get_currentNode(),!1),this.handlePargraphDeletion(e),e.disconnectNodeAndReturnToParent()}while(e.goToNextSiblingByRoleOrReturnToParent(1));i-=n,this.recomputeAndSetColumnWidthsAfterColDeletion(e,i,t,n),this.onDeleteColumnsCompleted(e,t,n)},e.prototype.recomputeAndSetColumnWidthsAfterColDeletion=function(e,t,n,i){var r=e.get_currentNode().getValueWithDefault(Array,is.b.tableLockedColumns,null),o=e.get_currentNode().getValueWithDefault(Array,is.b.tableColumnWidths,null);if(r&&(r=tc.p.clone(r)),o&&(o=tc.p.clone(o)),this.setColumnCount(e.get_currentNode(),t),r){for(var a=new Array(t),l=0;l<n;++l)a[l]=r[l];for(;l<t;++l)a[l]=r[l+i];e.get_currentNode().setValue(is.b.tableLockedColumns,a)}if(o){var s=new Array(t);for(l=0;l<n;++l)s[l]=o[l];for(;l<t;++l)s[l]=o[l+i];e.get_currentNode().setValue(is.b.tableColumnWidths,s)}},e.prototype.mergeCells=function(e,t,n){},e.prototype.splitCell=function(e,t,n){},e.prototype.onCellDeleted=function(e,t){},e.prototype.promoteToNonGhostCellImpl=function(e,t){},e.prototype.onDeleteRowsCompleted=function(e,t,n){},e.prototype.onDeleteColumnsCompleted=function(e,t,n){},e.prototype.onMergeCellsCompleted=function(e){},e.prototype.onSplitCellsCompleted=function(e){},e.prototype.deleteColumnsContainingCell=function(e,t){var n=Fd.s.getColumnIndex(e);e.returnToParent(),e.returnToParent(),this.deleteColumns(e,n,t)},e.prototype.createTableCellNode=function(){var e=ds.u.get_instance().createInstance(393252);return e.setValue(is.b.outlineElementChildLevel,ms.k.first),new Ks.OutlineIndentInfo(!0).saveToProperty(e),e},e.prototype.setJustification=function(e,t){e.setValue(is.b.layoutAlignmentInParent,t),e.setValue(is.b.layoutAlignmentSelf,t)},e.prototype.clearColumnWidth=function(e,t){},e.prototype.clearAllColumnWidths=function(e){e.removeProperties(is.b.tableLockedColumns,is.b.tableColumnWidths)},e.prototype.setColumnWidthsMu=function(e,t,n){var i=us.TableReader.getColumnCount(e),r=e.getValueWithDefault(Array,is.b.tableLockedColumns,null);r=r?tc.p.clone(r):new Array(i);var o=e.getValueWithDefault(Array,is.b.tableColumnWidths,null);o=o?tc.p.clone(o):new Array(i),r[t]=!0,o[t]=n,e.setValue(is.b.tableColumnWidths,o),e.setValue(is.b.tableLockedColumns,r)},e.prototype.setRowHeightMu=function(e,t){e.setValue(os.j.tableRowHeight,t)},e.prototype.setTableAltTextDescription=function(e,t){},e.prototype.setTableAltTextTitle=function(e,t){},e.get_FormattingEditor=function(){return e._formattingEditor||(e._formattingEditor=Ge.w.get_instance().resolve(Vs.z))},e.getOutlineElementInfoFromCell=function(t,n){void 0===n&&(n=!0);var i=new hm.d;if(t){var r=null,o=Ua.SelectionFactory.createCollapsedSelection(t,n);if(o){for(var a=0;a<o.get_length();a++)if(vc.FormattingReader.containsFormatting(o.get_item(a))){r=o.get_item(a);break}}else S.ULS.sendTraceTag(19244694,315,10,"Unexpected null selection.");if(r){var l=vc.FormattingReader.getFormattingObject(r);l.get_cache().get_isLink()&&(l=l.cloneUnderDifferentChp(null),e.get_FormattingEditor().removeLinkFormatting(l)),i.formatting=l.get_formattingId(),i.languageId=vc.FormattingReader.language(l),Gl.n.get_instance().get_item(71)&&(i.style=bs.StyleReader.getStyleFromParagraphNode(r.get_node()))}}return i},e.setCellSpan=function(e,t,n){t?e.set_rowSpan(n):e.set_colSpan(n)},e.getCellSpan=function(e,t){return t?e.get_rowSpan():e.get_colSpan()},e.getOffSet=function(e,t){return t?e.rowOffset:e.colOffset},e.getFirstGhostCell=function(e,t){return t?e.firstGhostCellInSameRow:e.firstGhostCellInSameColumn},e.clearColumnWidth_TableLockedColumnsProperty=function(e,t,n){var i=e.getValueWithDefault(Array,is.b.tableLockedColumns,null);(i=i?tc.p.clone(i):new Array(n))[t]=!1,e.setValue(is.b.tableLockedColumns,i)},e.clearColumnWidth_TableColumnWidthsProperty=function(e,t,n){var i=e.getValueWithDefault(Array,is.b.tableColumnWidths,null);(i=i?tc.p.clone(i):new Array(n))[t]=0,e.setValue(is.b.tableColumnWidths,i)},e._formattingEditor=null,e._outlineEditor=null,e._outlineElementEditor=null,e._getIdForNewCell=null,e._tableLoggingCategory="Tables",e}();(0,o.l)(Cm,"3d7a258a$TableEditor",null,[au.z]);var Sm=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,Box4Intl.Box4Strings.l_TableDialogColumnLabelText,Box4Intl.Box4Strings.l_TableDialogRowLabelText)},e.DialogHtmlFormat="<div class='WACDialogRow' id='RowTableSize'> <div class='WacDialogLabels' id='TableSizeDialogLabels'> <label id='TableSizeDialogColumn' class='DialogSpinnerLabel' for='TableSizeDialogColumnSpinner'>{0}</label> <br/> <label id='TableSizeDialogRow' class='DialogSpinnerLabel' for='TableSizeDialogRowSpinner'>{1}</label> <br/> </div> <div class='WacSpinnerBox' id='TableSizeDialogSpinners'> <div id='TableSizeDialogColumnSpinnerContainer' class='WacSpinnerBoxes'></div> <div class='InsertTableDialogTooltipContainer' id='TableSizeDialogColumnTooltipContainer'> <div id='TableSizeDialogColumnTooltipContent' class='InsertTableDialogTooltipContent'></div> </div> <br/> <div id='TableSizeDialogRowSpinnerContainer' class='WacSpinnerBoxes'></div> <div class='InsertTableDialogTooltipContainer' id='TableSizeDialogRowTooltipContainer'> <div id='TableSizeDialogRowTooltipContent' class='InsertTableDialogTooltipContent'></div> </div> <br/> </div> </div>",e}();(0,o.l)(Sm,"4655a7d3$TableSizeDialogHtml",null,[]);var bm=function(){function e(e,t,n,i,r,a){this.InputElement=null,this.TooltipContainerElement=null,this.TooltipContentElement=null,this.visible=!1,this.timer=0,this.MaxInputNumber=0,this.MinInputNumber=0,this.CurrentSpan=0,this.NonNumericTooltipText=null,this.OverSizeTooltipText=null,this.NonNegUnderSizeTooltipText=null,this.NegUnderSizeTooltipText=null,this.NotMultipleOrFactorTooltipText=null,this.visible=!1,this.MinInputNumber=i,this.MaxInputNumber=r,this.InputElement=e,this.CurrentSpan=a,this.TooltipContainerElement=document.getElementById(t),this.TooltipContentElement=document.getElementById(n),this.TooltipContainerElement.style.display="none",this.OverSizeTooltipText=String.format(Box4Intl.Box4Strings.l_TableOverSizeWarningMessage,r),this.NonNegUnderSizeTooltipText=String.format(Box4Intl.Box4Strings.l_TableNonNegUnderSizeWarningMessage,i),this.NegUnderSizeTooltipText=Box4Intl.Box4Strings.l_TableNegUnderSizeWarningMessage,this.NonNumericTooltipText=Box4Intl.Box4Strings.l_TableNonNumericWarningMessage,this.NotMultipleOrFactorTooltipText=String.format(Box4Intl.Box4Strings.l_TableNotMultipleOrFactorOfSpanWarningMessage,a),wo.n.addHandler(e,me.d.blur,o.i(this,this.OnInputBlur,"OnInputBlur")),wo.n.addHandler(e,me.d.keyUp,o.i(this,this.OnInputChange,"OnInputChange"))}return e.prototype.inputValueUpdated=function(){var e;if(this.TryParseInt(this.InputElement.value,(0,g.m)((function(){return e}),(function(t){return e=t}))))if(e>this.MaxInputNumber)this.TooltipContentElement.innerText=this.OverSizeTooltipText,this.popup();else if(e>=0&&e<this.MinInputNumber)this.TooltipContentElement.innerText=this.NonNegUnderSizeTooltipText,this.popup();else if(e<0)this.TooltipContentElement.innerText=this.NegUnderSizeTooltipText,this.popup();else{if(!(e%this.CurrentSpan&&this.CurrentSpan%e))return this.hide(),!0;this.TooltipContentElement.innerText=this.NotMultipleOrFactorTooltipText,this.popup()}else this.TooltipContentElement.innerText=this.NonNumericTooltipText,this.popup();return!1},e.prototype.popup=function(){this.visible?(this.ClearTimer(),this.SetTimer()):(this.visible=!0,this.TooltipContainerElement.style.display="",this.SetTimer())},e.prototype.hide=function(){this.ClearTimer(),this.TooltipContainerElement.style.display="none",this.visible=!1},e.prototype.dispose=function(){this.hide(),wo.n.removeHandler(this.InputElement,me.d.blur,o.i(this,this.OnInputBlur,"OnInputBlur")),wo.n.removeHandler(this.InputElement,me.d.keyUp,o.i(this,this.OnInputChange,"OnInputChange"))},e.prototype.TryParseInt=function(t,n){return n.val=0,!!e.NumericRegEx.test(t)&&(n.val=parseInt(t),!0)},e.prototype.OnInputBlur=function(e){this.hide()},e.prototype.OnInputChange=function(e){this.inputValueUpdated()},e.prototype.SetTimer=function(){this.timer=window.setTimeout(o.i(this,this.hide,"hide"),e.TooltipHideTimeoutMs)},e.prototype.ClearTimer=function(){window.clearTimeout(this.timer)},e.TooltipHideTimeoutMs=1e4,e.NumericRegEx=new RegExp("^(\\+|\\-)?[0-9]*$"),e}();(0,o.l)(bm,"d2e9c737$TableSizeDialogTooltip",null,[]);var vm=function(e){function t(n,i,r,a,l,s,u,c,d,g){var p=this;return p.disposing=!1,p.properties=null,p.callback=null,p.tooltipControls=null,p.MinRowCount=0,p.MinColCount=0,p.MaxRowCount=0,p.MaxColCount=0,p.DefRowCount=0,p.DefColCount=0,p.ColIncrement=0,p.RowIncrement=0,p.StandaloneRoot=Ge.w.get_instance().resolve(nu.r).get_sharedStandaloneRoot(),(p=e.call(this)||this).properties={},p.disposing=!1,p.tooltipControls={},p.MinRowCount=r,p.MinColCount=a,p.MaxRowCount=l,p.MaxColCount=s,p.DefRowCount=u,p.DefColCount=c,p.RowIncrement=d,p.ColIncrement=g,p.callback=i,p.set_dialogHtml(Sm.get_dialogHtml()),p.set_dialogId(t.Id),p.initializeAndShow(n,o.i(p,p.TableSizeDialogResultHandler,"TableSizeDialogResultHandler"),null),p.InitializeSpinners(),p}return(0,v.t)(t,e),t.prototype.onInnerHtmlSet=function(){var e=String.format(Box4Intl.Box4Strings.l_TableSizeHoverMessage,this.MinColCount,this.MaxColCount),n=String.format(Box4Intl.Box4Strings.l_TableSizeHoverMessage,this.MinRowCount,this.MaxRowCount);this.BuildTableSizeDialogSpinner(t.SpinnerColumnContainerId,t.SpinnerColumnControlId,t.SpinnerColumnTooltipContainerId,t.SpinnerColumnTooltipContentId,Oi.u.tableColumnDialog,Oi.u.queryTableColumnDialog,e,this.MinColCount,this.MaxColCount,this.ColIncrement),this.BuildTableSizeDialogSpinner(t.SpinnerRowContainerId,t.SpinnerRowControlId,t.SpinnerRowTooltipContainerId,t.SpinnerRowTooltipContentId,Oi.u.tableRowDialog,Oi.u.queryTableRowDialog,n,this.MinRowCount,this.MaxRowCount,this.RowIncrement)},t.prototype.InitializeSpinners=function(){for(var e=t.get_SpinnerCommandIds(),n=0;n<e.length;n++)Fc.attachCommandHandlers(e[n],o.i(this,this.SetAdvancedControlValue,"SetAdvancedControlValue"),o.i(this,this.GetAdvancedControlValue,"GetAdvancedControlValue"));this.StandaloneRoot.pollForControlState(t.SpinnerColumnControlId),this.StandaloneRoot.pollForControlState(t.SpinnerRowControlId)},t.prototype.GetAdvancedControlValue=function(e,n){var i=this.FieldNameFromCommandId(e);if(this.properties[i])n[So.Number]=this.properties[i];else{var r=e===Oi.u.queryTableColumnDialog?this.DefColCount:this.DefRowCount;n[So.UnitType]=t.CountUnitType,n[So.Number]=r,this.properties[i]=r}},t.prototype.SetAdvancedControlValue=function(e,t){this.properties[this.FieldNameFromCommandId(e)]=parseInt(t[So.Number]);var n=this.tooltipControls[e.toString()];n&&n.inputValueUpdated(),this.StandaloneRoot.pollForStateAndUpdate()},t.prototype.TableSizeDialogResultHandler=function(e,t){if(1===e){var n=this.properties[this.FieldNameFromCommandId(Oi.u.tableRowDialog)],i=this.properties[this.FieldNameFromCommandId(Oi.u.tableColumnDialog)];this.callback(n?parseInt(n):this.DefRowCount,i?parseInt(i):this.DefColCount)}this.dispose()},t.prototype.dispose=function(){if(!this.disposing){this.disposing=!0,this.tooltipControls[2781309760].dispose(),this.tooltipControls[3232519678].dispose();for(var n=t.get_SpinnerCommandIds(),i=0;i<n.length;i++)Fc.detachCommandHandlers(n[i]);this.StandaloneRoot.removeControl(t.SpinnerColumnControlId),this.StandaloneRoot.removeControl(t.SpinnerRowControlId),e.prototype.dispose.call(this)}},t.prototype.BuildTableSizeDialogSpinner=function(e,t,n,i,r,o,a,l,s,u){var c=this.BuildTableSizeSpinnerXml(t,r,o,a,l,s,u);this.AttachSpinner(c,e,t,n,i,r,l,s,u)},t.prototype.AttachSpinner=function(e,t,n,i,r,o,a,l,s){var u=document.getElementById(t);this.StandaloneRoot.addControl(n,e);var c=this.StandaloneRoot.getDOMElementForControlDisplayMode(n,"Medium");this.tooltipControls[o.toString()]=new bm(c.children[0],i,r,a,l,s),u.appendChild(c)},t.prototype.BuildTableSizeSpinnerXml=function(e,t,n,i,r,o,a){return Yu.s.buildSpinnerXml(e,t,n,i,[this.BuildTableSizeUnitXml(r,o,a)])},t.prototype.BuildTableSizeUnitXml=function(e,n,i){return Yu.s.buildUnitXml(t.Unit,e.toString(),n.toString(),i.toString())},t.prototype.FieldNameFromCommandId=function(e){switch(e){case Oi.u.tableRowDialog:case Oi.u.queryTableRowDialog:return"rows";case Oi.u.tableColumnDialog:case Oi.u.queryTableColumnDialog:return"columns"}return null},t.get_SpinnerCommandIds=function(){return[Oi.u.tableColumnDialog,Oi.u.tableRowDialog,Oi.u.queryTableColumnDialog,Oi.u.queryTableRowDialog]},t.Id="TableSizeDialog",t.SpinnerColumnControlId="TableSizeDialogColumnSpinner",t.SpinnerRowControlId="TableSizeDialogRowSpinner",t.SpinnerColumnContainerId="TableSizeDialogColumnSpinnerContainer",t.SpinnerRowContainerId="TableSizeDialogRowSpinnerContainer",t.SpinnerColumnTooltipContainerId="TableSizeDialogColumnTooltipContainer",t.SpinnerRowTooltipContainerId="TableSizeDialogRowTooltipContainer",t.SpinnerColumnTooltipContentId="TableSizeDialogColumnTooltipContent",t.SpinnerRowTooltipContentId="TableSizeDialogRowTooltipContent",t.Unit="none",t.CountUnitType=0,t}(Bi.o);(0,o.l)(vm,"a50e3f22$TableSizeDialog",Bi.o,[]);var Tm=function(){function e(e){this._nodeRef=null,this._offset=0,this._ccIndex=0,ga.SelectionEditor.isInsertionPointSelection(e)||(e=ga.SelectionEditor.collapseToIp(e,!0,!1));var t=e.get_firstContext(),n=new ha.g;n.set(t.get_node()),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(n),ga.SelectionEditor.isInsertionPointContext(t)&&(this._offset=t.get_cpBegin(),this._ccIndex=t.get_ccBoundaryIdxAtCpBegin()),ga.SelectionEditor.isAnchoredObjectContext(t)&&n.returnToAncestorOfType(12),this._nodeRef=new i_(n)}return e.prototype.restore=function(){var e=new ha.g;this._nodeRef.SetFilter(o.i(this,this.SelectableFilter,"SelectableFilter"),null);var t=new n_,n=new n_;if(this._nodeRef.RestoreDetailed(e,n,t),Ga.ParagraphReader.canContainIpOrTextRange(e.get_currentNode())){if(!n.value&&t.value)return Ua.SelectionFactory.createCollapsedSelection(e.get_currentNode(),!1);var i=Wa.y.createIpContext(e.get_currentNode(),this._offset);if(-1!==this._ccIndex){var r=Ga.ParagraphReader.getContentControlCountAtCp(e.get_currentNode(),this._offset);this._ccIndex>0&&this._ccIndex<=r&&(i.set_ccBoundaryIdxAtCpBegin(this._ccIndex),i.set_ccBoundaryIdxAtCpEnd(this._ccIndex))}return Ua.SelectionFactory.createSelectionFromContext(i)}if(e.get_currentNode().get_isSelectable())return ga.SelectionEditor.collapseToIp(Ua.SelectionFactory.createSelectionFromNode(e.get_currentNode()),!t.value,!1);var a=ga.SelectionEditor.findFirstOrLastSelectableContentNode(e,!t.value);return a?Ga.ParagraphReader.canContainIpOrTextRange(a)?Ua.SelectionFactory.createIpSelection(a,t.value?Ga.ParagraphReader.textLength(a):0):Ua.SelectionFactory.createSelectionFromNode(a):null},e.prototype.SelectableFilter=function(e,t){return e.get_currentNode().get_isSelectableContentContainer()||e.get_currentNode().get_isSelectableContent()},e}();(0,o.l)(Tm,"71bdce2d$IpReference",null,[]);var Am,Im=n(5723);!function(e){e[e.unspecified=-1]="unspecified",e[e.none=0]="none",e[e.left=1]="left",e[e.center=2]="center",e[e.right=3]="right",e[e.inner=4]="inner",e[e.outer=5]="outer",e[e.both=6]="both",e[e.distribute=7]="distribute",e[e.margin=8]="margin",e[e.highKashida=9]="highKashida",e[e.lowKashida=10]="lowKashida",e[e.mediumKashida=11]="mediumKashida",e[e.numTab=12]="numTab",e[e.thaiDistribute=13]="thaiDistribute",e[e.start=14]="start",e[e.end=15]="end"}(Am||(Am={})),(0,o.h)("c55d1f41$Justification",Am);var wm=n(7749),xm=function(){return function(){this.forceDeletion=!1}}();(0,o.l)(xm,"6d4d3437$TrackChangeDeletionActionData",null,[]);var Em=function(){function e(){}return e.get_CcConfigSettings=function(){return e._ccConfigSettings||(e._ccConfigSettings=Ge.w.get_instance().tryResolve(Q_.i))},e.get_AutoCorrectScheduler=function(){return e._autoCorrectScheduler||(e._autoCorrectScheduler=Ge.w.get_instance().tryResolve(Ia.g))},e.get_ParagraphIndentationReader=function(){return e._paragraphIndentationReader||(e._paragraphIndentationReader=Ge.w.get_instance().resolve(Sg.p))},e.get_TableAltTextDialog=function(){return e._tableAltTextDialog||(e._tableAltTextDialog=Ge.w.get_instance().tryResolve(Lc))},e.get_DeleteTableSegmentStrategy=function(){return e._deleteTableSegmentStrategy||(e._deleteTableSegmentStrategy=Ge.w.get_instance().resolve(zd))},e.get_ExternalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=Ge.w.get_instance().resolveFuture(kg.i))},e.get_getNewOutlineElementInfoDelegate=function(){return e._getNewOutlineElementInfoDelegate||(e._getNewOutlineElementInfoDelegate=function(e){return Cm.getOutlineElementInfoFromCell(e)})},e.set_getNewOutlineElementInfoDelegate=function(t){return e._getNewOutlineElementInfoDelegate=t,t},e.get_getRefRowWhenInsertRowDelegate=function(){return e._getRefRowWhenInsertRowDelegate||(e._getRefRowWhenInsertRowDelegate=e.GetRefRowWhenInsertRowImpl)},e.set_getRefRowWhenInsertRowDelegate=function(t){return e._getRefRowWhenInsertRowDelegate=t,t},e.get_getRefCellWhenInsertColumnDelegate=function(){return e._getRefCellWhenInsertColumnDelegate||(e._getRefCellWhenInsertColumnDelegate=e.GetRefCellWhenInsertColumnImpl)},e.set_getRefCellWhenInsertColumnDelegate=function(t){return e._getRefCellWhenInsertColumnDelegate=t,t},e.get_getRefColumnFromRefCellDelegate=function(){return e._getRefColumnFromRefCellDelegate||(e._getRefColumnFromRefCellDelegate=e.GetRefColumnFromRefCellImpl)},e.set_getRefColumnFromRefCellDelegate=function(t){return e._getRefColumnFromRefCellDelegate=t,t},e.get_getRefColumnsWhenSelectColumnDelegate=function(){return e._getRefColumnsWhenSelectColumnDelegate||(e._getRefColumnsWhenSelectColumnDelegate=e.GetRefColumnsWhenSelectColumnImpl)},e.set_getRefColumnsWhenSelectColumnDelegate=function(t){return e._getRefColumnsWhenSelectColumnDelegate=t,t},e.get_getRefRowsWhenSelectRowDelegate=function(){return e._getRefRowsWhenSelectRowDelegate||(e._getRefRowsWhenSelectRowDelegate=e.GetRefRowsWhenSelectRowImpl)},e.set_getRefRowsWhenSelectRowDelegate=function(t){return e._getRefRowsWhenSelectRowDelegate=t,t},e.get_gotoFocusCellAfterInsertColumnDelegate=function(){return e._gotoFocusCellAfterInsertColumnDelegate||(e._gotoFocusCellAfterInsertColumnDelegate=e.GotoFocusCellAfterInsertColumnImpl)},e.set_gotoFocusCellAfterInsertColumnDelegate=function(t){return e._gotoFocusCellAfterInsertColumnDelegate=t,t},e.get_getRowOrColumnsForDeleteDelegate=function(){return e._getRowOrColumnsForDeleteDelegate||(e._getRowOrColumnsForDeleteDelegate=e.GetRowOrColumnsForDeleteImpl)},e.set_getRowOrColumnsForDeleteDelegate=function(t){return e._getRowOrColumnsForDeleteDelegate=t,t},e.get_isRowOrColumnOperationEnabledDelegate=function(){return e._isRowOrColumnOperationEnabledDelegate||(e._isRowOrColumnOperationEnabledDelegate=e.IsRowColumnOperationEnabledForComplexTable)},e.set_isRowOrColumnOperationEnabledDelegate=function(t){return e._isRowOrColumnOperationEnabledDelegate=t,t},e.get_FeatureHelper=function(){return e._featureHelper||(e._featureHelper=Ge.w.get_instance().tryResolve(Yh.d))},e.get_FormattingEditor=function(){return e._formattingEditor||(e._formattingEditor=Ge.w.get_instance().resolve(Vs.z))},e.get_TrackChangeManager=function(){return e._trackChangeManager||(e._trackChangeManager=Ge.w.get_instance().resolve(xa.b).get_instance())},e.get_TrackChangeEditor=function(){return e._trackChangeEditor||(e._trackChangeEditor=Ge.w.get_instance().resolve(es.x).get_instance())},e.get_ChangeIdEditor=function(){return e._changeIdEditor||(e._changeIdEditor=Ge.w.get_instance().resolve(Jh.p))},e.get_UnsupportedNodeEditor=function(){return tm.q.get_instance()},e.get_LockedRangeEditor=function(){return za.k.get_instance()},e.get_ListReader=function(){return e._listReader||(e._listReader=Ge.w.get_instance().resolve(Ql.c))},e.get_ListEditor=function(){return e._listEditor||(e._listEditor=Ge.w.get_instance().resolve(jl.v))},e.get_OutlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=Ge.w.get_instance().resolve(ql.p))},e.get_ContentControlChpHelper=function(){return e._contentControlChpHelper||(e._contentControlChpHelper=Ge.w.get_instance().tryResolve(K_.k))},e.get_ContentControlConverter=function(){return e._contentControlConverter||(e._contentControlConverter=Ge.w.get_instance().tryResolve(Zl.t))},e.get_ContentControlEditor=function(){return e._contentControlEditor||(e._contentControlEditor=Ge.w.get_instance().tryResolve(q_.p))},e.get_ContextSetEditor=function(){return e._contextSetEditor||(e._contextSetEditor=am.ContextSetEditor.get_instance())},e.set_ContextSetEditor=function(t){return e._contextSetEditor=t,t},e.get_ActivityManager=function(){return xr.y.get_instance()},e.get_TableEditor=function(){return e._tableEditor||(e._tableEditor=Ge.w.get_instance().resolve(au.z))},e.get_IsUnblockComplexTableEnabled=function(){return null==e._isUnblockComplexTableEnabled&&(e._isUnblockComplexTableEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UnblockComplexTableIsEnabled")&&!Gl.n.get_instance().get_item(30)),e._isUnblockComplexTableEnabled},e.registerActions=function(t){L.AFrameworkApplication.get_theActionManager();var n=function(e){return Y_.generalizeSelectionToOEs(e.get_selectionCollection(),!1)},i=function(t,i,r,o,a){var l=yi.App.theContextSetActor.createDelegatedViewHandler(n);return a[e.cumulativeJustificationKey]={},l(t,i,r,o,a)};e.initializeActionToJustificationMap();var r=L.AFrameworkApplication.get_theActionManager(),o=t.createDelegatedViewHandlerForUniqueNodeOfType(14);r.addAction(Oi.u.createTable,ol.d.view,e.CreateTableView),r.addAction(Oi.u.createTable,ol.d.insertionPoint,e.CreateTable),r.setActionFlags(Oi.u.createTable,1028),r.addAction(Oi.u.insertRowBelow,ol.d.view,e.InsertRowView),r.addAction(Oi.u.insertRowBelow,ol.d.tableRow,e.InsertRow),r.setActionFlags(Oi.u.insertRowBelow,1028),r.addAction(Oi.u.insertRowAbove,ol.d.view,e.InsertRowView),r.addAction(Oi.u.insertRowAbove,ol.d.tableRow,e.InsertRow),r.setActionFlags(Oi.u.insertRowAbove,1028),r.addAction(Oi.u.insertColumnAfter,ol.d.view,e.InsertColumnView),r.addAction(Oi.u.insertColumnAfter,ol.d.tableCell,e.InsertColumn),r.setActionFlags(Oi.u.insertColumnAfter,4),r.addAction(Oi.u.insertColumnRight,ol.d.view,e.InsertColumnView),r.setActionFlags(Oi.u.insertColumnRight,4),r.addAction(Oi.u.insertColumnBefore,ol.d.view,e.InsertColumnView),r.addAction(Oi.u.insertColumnBefore,ol.d.tableCell,e.InsertColumn),r.setActionFlags(Oi.u.insertColumnBefore,4),r.addAction(Oi.u.insertColumnLeft,ol.d.view,e.InsertColumnView),r.setActionFlags(Oi.u.insertColumnLeft,4),r.addAction(Oi.u.deleteColumn,ol.d.view,e.DeleteTableSegmentView),r.addAction(Oi.u.deleteColumn,ol.d.tableCell,e.DeleteColumn),r.setActionFlags(Oi.u.deleteColumn,4),r.addAction(Oi.u.deleteRow,ol.d.view,e.DeleteTableSegmentView),r.addAction(Oi.u.deleteRow,ol.d.tableRow,e.DeleteRow),r.setActionFlags(Oi.u.deleteRow,1028),r.addAction(Oi.u.deleteTable,ol.d.view,e.DeleteTableView),r.addAction(Oi.u.deleteTable,ol.d.table,e.DeleteTable),r.setActionFlags(Oi.u.deleteTable,1028),r.addAction(Oi.u.collapseTable,ol.d.table,e.CollapseTable),r.addAction(Oi.u.collapseTable,ol.d.view,o),r.setActionFlags(Oi.u.collapseTable,4),r.addAction(Oi.u.insertTable,ol.d.view,e.InsertTableView),r.addAction(Oi.u.insertTable,ol.d.insertionPoint,e.InsertTable),r.setActionFlags(Oi.u.insertTable,1036),r.addAction(Oi.u.insertTableDialog,ol.d.view,e.InsertTableDialogHandler),r.setActionFlags(Oi.u.insertTableDialog,1028),r.addAction(Oi.u.mergeCells,ol.d.view,e.MergeCellsView),r.addAction(Oi.u.mergeCells,ol.d.tableCell,e.MergeCells),r.setActionFlags(Oi.u.mergeCells,4),r.addAction(Oi.u.splitCellsDialog,ol.d.view,e.SplitCellsDialogHandler),r.setActionFlags(Oi.u.splitCellsDialog,4),r.addAction(Oi.u.splitCells,ol.d.view,e.SplitCellsView),r.addAction(Oi.u.splitCells,ol.d.tableCell,e.SplitCells),r.setActionFlags(Oi.u.splitCells,4),r.addActionWithFlags(Oi.u.queryTableColumnDialog,ol.d.view,Fc.queryDialogControl,96),r.addActionWithFlags(Oi.u.queryTableRowDialog,ol.d.view,Fc.queryDialogControl,96),r.addAction(Oi.u.tableColumnDialog,ol.d.view,Fc.handleDialogControl),r.addAction(Oi.u.tableRowDialog,ol.d.view,Fc.handleDialogControl),r.addAction(Oi.u.insertTableFlyoutEnabled,ol.d.view,e.InsertTableFlyoutEnabled),r.setActionFlags(Oi.u.insertTableFlyoutEnabled,1124),r.addAction(Oi.u.editTableAltText,ol.d.view,e.EditTableAltText),r.setActionFlags(Oi.u.editTableAltText,100),r.addAction(Oi.u.selectTable,ol.d.view,e.SelectTable),r.addAction(Oi.u.selectRow,ol.d.view,e.SelectRowView),r.addAction(Oi.u.selectColumn,ol.d.view,e.SelectColumn),r.addAction(Oi.u.selectCell,ol.d.view,e.SelectCell),r.addAction(Oi.u.toggleBorders,ol.d.view,o),r.addAction(Oi.u.toggleBorders,ol.d.table,e.ToggleBorders),r.setActionFlags(Oi.u.toggleBorders,4),r.addAction(Oi.u.queryBordersHidden,ol.d.view,o),r.addAction(Oi.u.queryBordersHidden,ol.d.table,e.QueryBordersHidden),r.setActionFlags(Oi.u.queryBordersHidden,96),Gl.n.get_instance().get_item(30)&&(r.addAction(Oi.u.splitInsertColumnAfter,ol.d.view,e.InsertColumnView),r.addAction(Oi.u.splitInsertColumnAfter,ol.d.insertionPoint,e.InsertColumn),r.setActionFlags(Oi.u.splitInsertColumnAfter,4),r.addAction(Oi.u.splitInsertRowBelow,ol.d.insertionPoint,e.InsertRow),r.addAction(Oi.u.splitInsertRowBelow,ol.d.view,e.InsertRowView),r.setActionFlags(Oi.u.splitInsertRowBelow,4)),r.addAction(Oi.u.queryTableTabGroup,ol.d.view,e.QueryTableTabGroup),Gl.n.get_instance().get_item(63)?r.setActionFlags(Oi.u.queryTableTabGroup,96):r.setActionFlags(Oi.u.queryTableTabGroup,1124);for(var a=0,l=[Oi.u.justifyLeft,Oi.u.justifyCenter,Oi.u.justifyRight,Oi.u.justifyKashida,Oi.u.justifyTop,Oi.u.justifyMiddle,Oi.u.justifyBottom,Oi.u.justifyTopLeft,Oi.u.justifyTopCenter,Oi.u.justifyTopRight,Oi.u.justifyMiddleLeft,Oi.u.justifyMiddleCenter,Oi.u.justifyMiddleRight,Oi.u.justifyBottomLeft,Oi.u.justifyBottomCenter,Oi.u.justifyBottomRight];a<l.length;a++){var s=l[a];r.addAction(s,ol.d.view,e.genericViewActionTableCellHandler),r.addAction(s,ol.d.tableCell,e.applyTableCellJustification),r.setActionFlags(s,4)}for(var u=0,c=[Oi.u.queryJustifyTopLeft,Oi.u.queryJustifyTopCenter,Oi.u.queryJustifyTopRight,Oi.u.queryJustifyMiddleLeft,Oi.u.queryJustifyMiddleCenter,Oi.u.queryJustifyMiddleRight,Oi.u.queryJustifyBottomLeft,Oi.u.queryJustifyBottomCenter,Oi.u.queryJustifyBottomRight];u<c.length;u++){s=c[u];r.addAction(s,ol.d.view,i),r.addAction(s,ol.d.paragraph,e.queryDirectTableCellParagraphJustification),r.setActionFlags(s,68)}},e.initializeActionToJustificationMap=function(){e._actionIdToVAlignMap.set_item(Oi.u.justifyTop,e._actionIdToVAlignMap.set_item(Oi.u.justifyTopLeft,e._actionIdToVAlignMap.set_item(Oi.u.justifyTopCenter,e._actionIdToVAlignMap.set_item(Oi.u.justifyTopRight,e._actionIdToVAlignMap.set_item(Oi.u.queryJustifyTopLeft,e._actionIdToVAlignMap.set_item(Oi.u.queryJustifyTopCenter,e._actionIdToVAlignMap.set_item(Oi.u.queryJustifyTopRight,e.topJustify))))))),e._actionIdToVAlignMap.set_item(Oi.u.justifyMiddle,e._actionIdToVAlignMap.set_item(Oi.u.justifyMiddleLeft,e._actionIdToVAlignMap.set_item(Oi.u.justifyMiddleCenter,e._actionIdToVAlignMap.set_item(Oi.u.justifyMiddleRight,e._actionIdToVAlignMap.set_item(Oi.u.queryJustifyMiddleLeft,e._actionIdToVAlignMap.set_item(Oi.u.queryJustifyMiddleCenter,e._actionIdToVAlignMap.set_item(Oi.u.queryJustifyMiddleRight,e.middleJustify))))))),e._actionIdToVAlignMap.set_item(Oi.u.justifyBottom,e._actionIdToVAlignMap.set_item(Oi.u.justifyBottomLeft,e._actionIdToVAlignMap.set_item(Oi.u.justifyBottomCenter,e._actionIdToVAlignMap.set_item(Oi.u.justifyBottomRight,e._actionIdToVAlignMap.set_item(Oi.u.queryJustifyBottomLeft,e._actionIdToVAlignMap.set_item(Oi.u.queryJustifyBottomCenter,e._actionIdToVAlignMap.set_item(Oi.u.queryJustifyBottomRight,e.bottomJustify))))))),e._actionIdToHAlignMap.set_item(Oi.u.justifyLeft,e._actionIdToHAlignMap.set_item(Oi.u.justifyTopLeft,e._actionIdToHAlignMap.set_item(Oi.u.justifyMiddleLeft,e._actionIdToHAlignMap.set_item(Oi.u.justifyBottomLeft,e._actionIdToHAlignMap.set_item(Oi.u.queryJustifyTopLeft,e._actionIdToHAlignMap.set_item(Oi.u.queryJustifyMiddleLeft,e._actionIdToHAlignMap.set_item(Oi.u.queryJustifyBottomLeft,1))))))),e._actionIdToHAlignMap.set_item(Oi.u.justifyCenter,e._actionIdToHAlignMap.set_item(Oi.u.justifyTopCenter,e._actionIdToHAlignMap.set_item(Oi.u.justifyMiddleCenter,e._actionIdToHAlignMap.set_item(Oi.u.justifyBottomCenter,e._actionIdToHAlignMap.set_item(Oi.u.queryJustifyTopCenter,e._actionIdToHAlignMap.set_item(Oi.u.queryJustifyMiddleCenter,e._actionIdToHAlignMap.set_item(Oi.u.queryJustifyBottomCenter,2))))))),e._actionIdToHAlignMap.set_item(Oi.u.justifyRight,e._actionIdToHAlignMap.set_item(Oi.u.justifyTopRight,e._actionIdToHAlignMap.set_item(Oi.u.justifyMiddleRight,e._actionIdToHAlignMap.set_item(Oi.u.justifyBottomRight,e._actionIdToHAlignMap.set_item(Oi.u.queryJustifyTopRight,e._actionIdToHAlignMap.set_item(Oi.u.queryJustifyMiddleRight,e._actionIdToHAlignMap.set_item(Oi.u.queryJustifyBottomRight,3))))))),e._actionIdToHAlignMap.set_item(Oi.u.justifyKashida,6)},e.EditTableAltText=function(t,n,i,r,o){if(1===i)return 32;if(!n.view.get_isInteractiveView())return 2;var a=n.view;if(!a.get_selectionManager())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelectionManager}),8;var l=a.get_selectionManager().get_selectionContextForActionDispatch();return(l=e.get_ContextSetEditor().attemptToGeneralizeToNodeContextOfType(l,14))?(e.get_TableAltTextDialog().create(l),32):(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.failedToGeneralizeToTable}),8)},e.SelectTable=function(t,n,i,r,o){if(Dr.t.mark(5756),!n.view.get_isInteractiveView())return 2;var a=n.view;if(!a.get_selectionManager())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelectionManager}),8;var l=a.get_selectionManager().get_selectionContextForActionDispatch();if(!(l=e.get_ContextSetEditor().attemptToGeneralizeToNodeContextOfType(l,14)))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.failedToGeneralizeToTable}),8;if(2===i){var s=null,u=l.get_node(),c=us.TableReader.isComplexTableNode(u),d=e.get_IsUnblockComplexTableEnabled();if(Gl.n.get_instance().get_item(104)&&(!c||d))if(Gl.n.get_instance().get_item(77)){var g=Ua.SelectionFactory.createTableCellSelectionFromTable(u,d);a.get_selectionManager().setSelectionFromSelectionCollectionAsync(g,null)}else{var p=ha.g.createFromNode(u);p.goToFirstChildByRole(1);for(var h=[J_.TableNodeContext.create(p.get_currentNode())];p.goToNextSiblingByRole(1);)c&&Dd.v.isGhostRow(p)||Array.add(h,J_.TableNodeContext.create(p.get_currentNode()));s=new Ah.Selection(h,!0)}else s=Ua.SelectionFactory.createSelectionFromNode(l.get_node());if(s){var _=new vp.a(null,(function(e,t){return a.get_selectionManager().setSelection(s,e),!1}),null);_.setDebugName("SelectTable"),_.run()}}return Dr.t.mark(5757),32},e.SelectRowView=function(t,n,i,r,o){if(Dr.t.mark(5752),!n.view.get_isInteractiveView())return 2;var a=n.view;if(!a.get_selectionManager())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelectionManager}),8;var l=a.get_selectionManager().get_selectionCollection();if(!l)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),2;var s=e.get_getRefRowsWhenSelectRowDelegate()(l);if(32!==s.response)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.failedToGeneralizeToTable}),s.response;if(2===i){var u=s.processContexts,c=u[0].get_node(),d=c,g=ha.g.createFromNode(c);g.tryToRootAtAncestorOfType(14);for(var p=null,h=Pd.TableNavigator.getContainingTable(g),_=us.TableReader.isComplexTableNode(h),m=e.get_IsUnblockComplexTableEnabled(),f=Gl.n.get_instance().get_item(104)&&(!_||m),y=[],C=0;C<u.length;++C){var S=g.get_currentNode()===u[C].get_node();(S||_&&Dd.v.hasGhostCell(g))&&(d=g.get_currentNode(),!f||_&&Dd.v.isGhostRow(g)||Array.add(y,J_.TableNodeContext.create(g.get_currentNode())),Pd.TableNavigator.moveToNextRow(g),S||--C)}var b=a.get_selectionManager().get_selectionCollection().get_currentSelection(),v=null;if(f)if(Gl.n.get_instance().get_item(77)){var T=new ha.g,A=new ha.g;b.isForward?(T.set(c),A.set(d)):(T.set(d),A.set(c)),T.tryToRootAtAncestorOfType(14),Pd.TableNavigator.moveToFirstColumn(T),A.tryToRootAtAncestorOfType(14),Pd.TableNavigator.moveToLastColumn(A),v=_?Ua.SelectionFactory.createTableCellSelectionBetweenIteratorEx(T,A):Ua.SelectionFactory.createTableCellSelectionBetweenIterator(T,A)}else p=new Ah.Selection(y,Gl.n.get_instance().get_item(63)||b.isForward);else p=Ua.SelectionFactory.createSelectionFromContentBetweenNodes(c,d);p&&(v=new Im.SelectionCollection([p],0)),a.get_selectionManager().setSelectionFromSelectionCollectionAsync(v,null)}return Dr.t.mark(5753),32},e.SelectColumn=function(t,n,i,r,o){if(Dr.t.mark(5754),!n.view.get_isInteractiveView())return 2;var a=n.view;if(!a.get_selectionManager())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelectionManager}),8;var l=a.get_selectionManager().get_selectionCollection();if(!l)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),2;var s=e.get_getRefColumnsWhenSelectColumnDelegate()(l);if(32!==s.response)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.failedToGeneralizeToTable}),s.response;if(2===i){var u=[],c=s.processContexts,d=new ha.g;d.set(c[0].get_node()),d.tryToRootAtAncestorOfType(14);var g=Pd.TableNavigator.getContainingTable(d),p=Number.MAX_VALUE,h=0;if(c.length===us.TableReader.getColumnCount(Pd.TableNavigator.getContainingTable(d))){var _=null;if(Gl.n.get_instance().get_item(104)&&(_=Ua.SelectionFactory.createTableCellSelectionFromTable(g,e.get_IsUnblockComplexTableEnabled())))u=_.toArray();else{var m=Ua.SelectionFactory.createSelectionFromNode(g);Array.add(u,m)}p=0,h=us.TableReader.getColumnCount(g)-1}else{for(var f=0;f<c.length;++f){var y=ha.g.createFromNode(c[f].get_node());y.tryToRootAtAncestorOfType(14);var C=Fd.s.getColumnIndex(y);p=Math.min(p,C),h=Math.max(h,C)}var S=ha.g.createFromNode(g);Pd.TableNavigator.moveToFirstRow(S),Pd.TableNavigator.moveToColumnByIndex(S,p);var b=new ha.g;b.setFrom(S),Pd.TableNavigator.moveToColumnByIndex(b,h);var v=void 0,T=g.isComplexTable(),A=Gl.n.get_instance().get_item(104)&&(!T||e.get_IsUnblockComplexTableEnabled());do{(m=A?Ua.SelectionFactory.createSelectionBetweenTableCellNodes(S,b,!0,!0):Ua.SelectionFactory.createSelectionFromContentBetweenNodes(S.get_currentNode(),b.get_currentNode()))&&Array.add(u,m),v=!Pd.TableNavigator.moveToNextRow(S),Pd.TableNavigator.moveToNextRow(b)}while(!v)}var I=ha.g.createFromNode(g);Pd.TableNavigator.moveToCell(I,0,p);var w=us.TableReader.getRowCount(g),x=ha.g.createFromNode(g);Pd.TableNavigator.moveToCell(x,w-1,h);var E=new Im.SelectionCollection(u,u.length-1,0,I,x);a.get_selectionManager().setSelectionFromSelectionCollectionAsync(E,null)}return Dr.t.mark(5751),32},e.SelectCell=function(t,n,i,r,o){if(Dr.t.mark(5750),!n.view.get_isInteractiveView())return 2;var a=n.view;if(!a.get_selectionManager())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelectionManager}),8;var l=a.get_selectionManager().get_selectionContextForActionDispatch();if(!l)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),2;for(var s=e.get_ContextSetEditor().breakDownContextSets(l),u={},c=0;c<s.length;++c)if(s[c].get_isGraphNodeContext()){if((T=ha.g.createFromNode(s[c].get_node())).tryToRootAtOutlineAncestor(),!js.TableCellReader.isTableCellOrInside(T))return 8;Pd.TableNavigator.returnToCell(T),u[T.get_currentNode().get_id().toString()]=T}if(2===i){if(Gl.n.get_instance().get_item(104)){var d=a.get_selectionManager().get_selectionCollection();if(d.get_currentSelection().get_tableSelectionContexts())return Dr.t.mark(5751),32;var g=d.get_currentSelection(),p=g.isForward?g.get_firstContext():g.get_lastContext(),h=g.isForward?g.get_lastContext():g.get_firstContext(),_=new ha.g;_.set(p.get_node()),_.tryToRootAtOutlineAncestor();var m=new ha.g;m.set(h.get_node()),m.tryToRootAtOutlineAncestor();var f=null;if((f=Pd.TableNavigator.returnToLowestCommonTable(_,m))&&!f.isComplexTable()){var y=ga.SelectionEditor.collapseToIp(g,!0,!1),C=J_.TableNodeContext.create(_.get_currentNode(),y.get_firstContext()),S=Ua.SelectionFactory.createSelectionCollectionFromSelection(Ua.SelectionFactory.createSelectionFromContext(C));return a.get_selectionManager().setSelectionFromSelectionCollection(S),Dr.t.mark(5751),32}}var b=[];for(var v in u){var T={key:v,value:u[v]}.value,A=Ua.SelectionFactory.createSelectionFromNode(T.get_currentNode());Array.add(b,A)}if(b.length>0){var I=new Im.SelectionCollection(b,b.length-1);a.get_selectionManager().setSelectionFromSelectionCollectionAsync(I,null)}}return Dr.t.mark(5751),32},e.getTableCellAlignmentIsEnabled=function(){return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacTableCellAlignmentIsEnabled")},e.applyTableCellJustification=function(t,n,i,r,o){var a=e.alignmentEnabledGetter();if(1===i)return a?32:8;if(!o||!a)return 2;var l=n;if(!n||!l.get_node())return 2;var s=l.get_node();if(js.TableCellReader.isGhostCellNode(s))return 32;if(e._actionIdToVAlignMap.containsKey(t)){var u=e._actionIdToVAlignMap.get_item(t);s.setProperty_Unchecked(os.j.tableCellVerticalAlignment,u)}if(e._actionIdToHAlignMap.containsKey(t)){var c=e._actionIdToHAlignMap.get_item(t);e.ApplyCellHorizontalJustification(s,c)}return 32},e.ApplyCellHorizontalJustification=function(t,n){if(!js.TableCellReader.isGhostCellNode(t)){var i=ha.g.createFromNode(t);if(fs.OutlineNavigator.moveToFirstOutlineElement(i))do{if(i.goToFirstChildByRole(2)){var r=i.get_currentNode();12===r.get_type()?r.setProperty_Unchecked(is.b.layoutAlignmentInParent,n):14===r.get_type()?us.TableReader.foreachCellInTable(r,(function(t){e.ApplyCellHorizontalJustification(t,n)})):S.ULS.sendTraceTag(8439839,324,50,"Unsupported node type for justification set:{0}",wm.l[r.get_type()]),i.returnToParent()}}while(i.goToNextSibling())}},e.queryDirectTableCellParagraphJustification=function(t,n,i,r,o){if(!o)return 2;if(1===i)return 32;var a=o,l=a[e.cumulativeJustificationKey];if(e.consistentKey in l&&!l[e.consistentKey])return 32;var s=e._actionIdToHAlignMap.get_item(t),u=e._actionIdToVAlignMap.get_item(t),c=n;if(!n||!c.get_node())return 2;var d=c.get_node(),g=Ga.ParagraphReader.getJustification(d),p=ha.g.createFromNode(d);p.tryToRootAtAncestorOfType(16),p.returnToAncestorOfType(16);var h=p.get_currentNode().getValueWithDefault(String,os.j.tableCellVerticalAlignment,e.topJustify);return l[e.consistentKey]=a[gr.e.On]=s===g&&u===h,32},e.DeleteTableView=function(t,n,i,r,o){var a=n;if(!a.view.get_isInteractiveView())return 2;var l=a.view;if(!l.get_selectionManager())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelectionManager}),8;var s=l.get_selectionManager().get_selectionContextForActionDispatch();if(!(s=e.get_ContextSetEditor().attemptToGeneralizeToNodeContextOfType(s,14)))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.failedToGeneralizeToTable}),8;if(1===i)return p=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(s,Oi.u.deleteTable,i,!0,r,o);Dr.t.mark(7117);var u=new Tm(ga.SelectionEditor.collapseToIp(Ua.SelectionFactory.createSelectionFromContext(s),!0,!1)),c=new Ma.GraphTransaction(15);try{c.setFromNode(a.view.get_targetNode());var d=rm.getNormalizer(s.get_node(),!0);d.trackContext(s);var g=(0,y.e)(xm,o)||new xm,p=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(s,Oi.u.deleteTable,i,!0,r,e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()?g:o),h=!e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()||!e.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()||g.forceDeletion;32===p&&2===i&&h?(d.normalize(),l.get_selectionManager().setSelection(u.restore()),St.FocusManager.instance().setScope(l.get_focusScopeId())):d.cancel()}finally{c&&c.dispose()}return Dr.t.mark(7118),32},e.CreateTableView=function(t,n,i,r,o){var a=n;Dr.t.mark(4943);var l=null;2===i&&(l=new Ma.GraphTransaction(15)).setFromNode(a.view.get_targetNode());var s=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(a.get_nextContext(),t,i,!0,r,o);if(32===s&&2===i){if(!a.view.get_isInteractiveView())return 2;var u=a.view,c=u.get_selectionManager().get_selectionContextForActionDispatch();c=e.get_ContextSetEditor().attemptToGeneralizeToNodeContextOfType(c,16);var d=new ha.g;d.set(c.get_node()),d.tryToRootAtAncestorOfType(14),Pd.TableNavigator.moveToNextOrPreviousCell(d,!1),u.get_selectionManager().setSelection(Ua.SelectionFactory.createCollapsedSelection(d.get_currentNode(),!0))}return l&&l.dispose(),Dr.t.mark(4944),s},e.InsertColumnView=function(t,n,i,r,o){var a=n;if(!a.view.get_isInteractiveView())return 2;var l=a.view;if(!l.get_selectionManager()||!l.get_selectionManager().get_selectionCollection().get_currentSelection())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),8;Dr.t.mark(4945);var s=l.get_selectionManager().get_selectionContextForActionDispatch();if(!s)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),8;var u=t===Oi.u.insertColumnAfter||t===Oi.u.splitInsertColumnAfter,c=e.get_ContextSetEditor().breakDownContextSets(s);if(!c||c.length<=0)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),8;var d=c[0].get_node();if(!d)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),8;u=us.TableReader.isRtlForView(d)?t===Oi.u.insertColumnLeft||u:t===Oi.u.insertColumnRight||u;var g=e.get_getRefCellWhenInsertColumnDelegate()(s,u);if(32!==g.response)return g.response;var p,h=g.containingTable,_=us.TableReader.isComplexTableNode(h),m=t;(p=u?(0,y.e)(z_.s,g.processContexts[g.processContexts.length-1]):(0,y.e)(z_.s,g.processContexts[0])).get_node();t!==Oi.u.splitInsertColumnAfter&&(t=u?Oi.u.insertColumnAfter:Oi.u.insertColumnBefore);var f=null;2===i&&(f=new Ma.GraphTransaction(15)).setFromNode(a.view.get_targetNode());var C=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(p,t,i,!0,r,g.numberOfOperations);return f&&f.dispose(),2===i&&S.ULS.sendTraceTag(9011547,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, ColumnCount={6}",m,Oi.u.getNameFromId(m)||"Unknown",Gl.n.get_instance().get_item(77),_,C,h.get_id().toString(),us.TableReader.getColumnCount(h))),Dr.t.mark(4946),C},e.InsertRowView=function(t,n,i,r,o){var a=n;if(!a.view.get_isInteractiveView())return 2;var l=t===Oi.u.splitInsertRowBelow,s=t===Oi.u.insertRowAbove;Dr.t.mark(4947);var u=a.view;if(!u.get_selectionManager())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelectionManager}),8;var c=u.get_selectionManager().get_selectionContextForActionDispatch();if(!c)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),8;var d=e.get_getRefRowWhenInsertRowDelegate()(c,s);if(32!==d.response)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.failedToGeneralizeToTable}),d.response;var g,p=us.TableReader.isComplexTableNode(d.containingTable),h=null;2===i&&(h=new Ma.GraphTransaction(15)).setFromNode(a.view.get_targetNode());(g=s?(0,y.e)(z_.s,d.processContexts[0]):(0,y.e)(z_.s,d.processContexts[d.processContexts.length-1])).get_node();var _=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(l?c:g,t,i,!1,r,d.numberOfOperations);return h&&h.dispose(),2===i&&S.ULS.sendTraceTag(9011548,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, RowCount={6}",t,Oi.u.getNameFromId(t)||"Unknown",Gl.n.get_instance().get_item(77),p,_,d.containingTable.get_id().toString(),us.TableReader.getRowCount(d.containingTable))),Dr.t.mark(4948),_},e.MoveToFirstColumnControlCell=function(e){for(Pd.TableNavigator.moveToFirstColumn(e);js.TableCellReader.isGhostCell(e);){if(!Pd.TableNavigator.moveToPreviousRow(e))break}},e.moveToFirstRowControlCell=function(e){for(Pd.TableNavigator.moveToFirstRow(e);js.TableCellReader.isGhostCell(e);){if(!Pd.TableNavigator.moveToPreviousColumn(e))break}},e.MergeCellsView=function(t,n,i,r,o){if(Gl.n.get_instance().get_item(30))return 2;var a=n;if(!a.view.get_isInteractiveView())return 2;var l=a.view;if(!l.get_selectionManager()||!l.get_selectionManager().get_selectionCollection().get_currentSelection())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),8;var s=l.get_selectionManager().get_selectionContextForActionDispatch(),u=e.GetMergeCellContextData(s);if(32!==u.response)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.failedToGeneralizeToTable}),u.response;var c=null,d=null;if(2===i){(c=new Tm(l.get_selectionManager().get_selectionCollection().get_currentSelection())).restore();(d=new Ma.GraphTransaction(15)).setFromNode(a.view.get_targetNode())}var g=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(Wa.y.create(u.controlCell),t,i,!1,r,u);if(2===i&&32===g){var p=ha.g.createFromNode(u.containingTable);p.tryToRootAtOutlineAncestor()&&e.get_TableEditor().removeDeadCells(p,l.get_viewId()),c&&(l.get_selectionManager().setSelection(Ua.SelectionFactory.createCollapsedSelection(u.controlCell,!0)),St.FocusManager.instance().setScope(l.get_focusScopeId()))}return d&&d.dispose(),2===i&&(S.ULS.sendTraceTag(38397411,324,50,String.format("Merge Cells command run. Response={0}",g)),e.get_TrackChangeManager().alertUntrackedChange(5)),g},e.GetMergeCellContextData=function(t){var n=new Z_;if(n.containingTable=null,n.controlCell=null,!t)return n.response=8,n;var i=e.get_ContextSetEditor().breakDownContextSets(t);if(i.length<=1)return n.response=2,n;for(var r=new C.c(String),o={},a=0;a<i.length;++a)if(i[a].get_isGraphNodeContext()){var l=ha.g.createFromNode(i[a].get_node());if(l.tryToRootAtOutlineAncestor(),!js.TableCellReader.isTableCellOrInside(l))return n.response=8,n;var s=(0,y.e)(cs.AParagraphNode,l.get_currentNode());if(s&&!s.getValueWithDefault(Boolean,os.j.isFullySupportedParagraph,!0))return n.response=8,n;Pd.TableNavigator.returnToCell(l);var u=l.get_currentNode();if(r.contains(u.get_id().toString()))continue;r.add(u.get_id().toString());var c=Pd.TableNavigator.getContainingTable(l),d=Pd.TableNavigator.getContainingTableRow(l).get_id().toString();if(n.containingTable)if(n.containingTable!==c){if(l.hasAncestor(n.containingTable))continue;if(!ha.g.createFromNode(n.containingTable).tryToRootAtAncestor(c))return n.response=8,n;o={},n.containingTable=c,n.controlCell=u,o[d]=u.get_colSpan()}else o[d]=d in o?o[d]+u.get_colSpan():u.get_colSpan();else o={},n.containingTable=c,n.controlCell=u,o[d]=u.get_colSpan();for(var g=1;g<u.get_rowSpan();g++){Pd.TableNavigator.moveToNextRow(l);var p=Pd.TableNavigator.getContainingTableRow(l).get_id().toString();o[p]=p in o?o[p]+u.get_colSpan():u.get_colSpan()}}if(!n.controlCell)return n.response=2,n;var h=Object.keys(o);n.rowSpan=h.length,n.colSpan=o[h[0]];for(var _=0,m=h;_<m.length;_++){d=m[_];if(n.colSpan!==o[d])return n.response=2,n}return n.response=32,n},e.SplitCellsDialogHandler=function(t,n,i,r,o){if(1===i)return L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.splitCells,i);var a=e.GetSelectedCell(n);return a?(new vm(Box4Intl.Box4Strings.L_SplitCells,e.SplitCellsDialogCallback,1,1,100,63,a.get_rowSpan(),1===a.get_colSpan()?2:a.get_colSpan(),a.get_rowSpan(),a.get_colSpan()),32):2},e.GetSelectedCell=function(t){var n,i=t.view;if(ga.SelectionEditor.isInsertionPointSelection(i.get_selectionManager().get_selectionCollection().get_currentSelection())){n=i.get_selectionManager().get_selectionCollection().get_currentSelection().get_firstContext().get_node()}else{var r=i.get_selectionManager().get_selectionContextForActionDispatch();n=e.get_ContextSetEditor().breakDownContextSets(r)[0].get_node()}var o=ha.g.createFromNode(n);return o.tryToRootAtOutlineAncestor(),js.TableCellReader.isInTableCell(o)?(Pd.TableNavigator.returnToContainingCell(o),o.get_currentNode()):null},e.SplitCellsDialogCallback=function(e,t){var n={};n.rows=e,n.columns=t,L.AFrameworkApplication.get_theActionManager().processActionWithData(Oi.u.splitCells,2,n)},e.SplitCellsView=function(t,n,i,r,a){if(Gl.n.get_instance().get_item(30))return 2;var l=n;if(!l.view.get_isInteractiveView())return 2;var s,u=l.view;if(!u.get_selectionManager()||!u.get_selectionManager().get_selectionCollection().get_currentSelection())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),8;if(ga.SelectionEditor.isInsertionPointSelection(u.get_selectionManager().get_selectionCollection().get_currentSelection())){s=u.get_selectionManager().get_selectionCollection().get_currentSelection().get_firstContext().get_node()}else{var c=u.get_selectionManager().get_selectionContextForActionDispatch();if(!c)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.failedToGeneralizeToTable}),8;var d=e.get_ContextSetEditor().breakDownContextSets(c);if(1!==d.length||!o.r(Wa.y,d[0]))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsMultiCellTable}),8;s=d[0].get_node()}var g=ha.g.createFromNode(s);if(g.tryToRootAtOutlineAncestor(),!js.TableCellReader.isInTableCell(g))return 2;Pd.TableNavigator.returnToContainingCell(g);var p=g.get_currentNode(),h=null,_=null;if(2===i){(h=new Tm(u.get_selectionManager().get_selectionCollection().get_currentSelection())).restore();(_=new Ma.GraphTransaction(15)).setFromNode(l.view.get_targetNode())}var m=Wa.y.create(p),f=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(m,t,i,!1,r,a);return 2===i&&32===f&&h&&(u.get_selectionManager().setSelection(Ua.SelectionFactory.createCollapsedSelection(p,!0)),St.FocusManager.instance().setScope(u.get_focusScopeId())),_&&_.dispose(),2===i&&(S.ULS.sendTraceTag(38397440,324,50,String.format("Split Cells command run. Response={0}",f)),e.get_TrackChangeManager().alertUntrackedChange(11)),f},e.DeleteTableSegmentView=function(t,n,i,r,o){var a=n;if(!a.view.get_isInteractiveView())return 2;var l=t===Oi.u.deleteRow;l?Dr.t.mark(4951):Dr.t.mark(4949);var s=a.view;if(!s.get_selectionManager()||!s.get_selectionManager().get_selectionCollection().get_currentSelection())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),8;var u=s.get_selectionManager().get_selectionContextForActionDispatch(),c=e.get_getRowOrColumnsForDeleteDelegate()(u,l,s.get_selectionManager());if(32!==c.response)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.failedToGeneralizeToTable}),c.response;var d=us.TableReader.isComplexTableNode(c.containingTable),p=null,h=null,_=null,m=!1,f=!1;if(2===i){var C=(p=new Tm(s.get_selectionManager().get_selectionCollection().get_currentSelection())).restore();(x=ha.g.createFromNode(C.get_firstContext().get_node())).tryToRootAtAncestorOfType(14),Pd.TableNavigator.returnToContainingCell(x),f=js.TableCellReader.isLastCellInRow(x),Pd.TableNavigator.returnToContainingRow(x),m=Dd.v.isLastRowInTable(x),h=rm.getNormalizer(a.view.get_targetNode(),!0),d&&e.get_DeleteTableSegmentStrategy().excludeControlCells((0,g.m)((function(){return u}),(function(e){return u=e}))),h.trackContext(u),(_=new Ma.GraphTransaction(15)).setFromNode(a.view.get_targetNode())}var b=(0,y.e)(xm,o)||new xm,v=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(j_.x.createSet(c.processContexts),t,i,!1,r,e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&l?b:o),T=!e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()||!e.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()||!l||b.forceDeletion,A=!1,I=!1;2===i&&32===v&&T&&((x=ha.g.createFromNode(c.containingTable)).tryToRootAtOutlineAncestor()&&e.get_TableEditor().removeDeadCells(x,s.get_viewId()));if(2===i&&32===v&&Gl.n.get_instance().get_item(30)&&us.TableReader.isSingleCellTable(c.containingTable)&&T&&(x=ha.g.createFromNode(c.containingTable)).tryToRootAtOutlineAncestor()){p=new Tm(l?Ua.SelectionFactory.createCollapsedSelection(c.containingTable,!m):Ua.SelectionFactory.createCollapsedSelection(c.containingTable,!f)),s.get_selectionManager().setSelection(ga.SelectionEditor.collapseToIp(Ua.SelectionFactory.createSelectionFromNode(c.containingTable),!1,!1));L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.collapseTable,2);A=!0,I=!0}if(32===v&&2===i&&T){if((!A&&us.TableReader.getColumnCount(c.containingTable)<=0||us.TableReader.getRowCount(c.containingTable)<=0)&&(A=!0),h.normalize(),p){var w=p.restore();if(A)w=I&&!l?Ua.SelectionFactory.createCollapsedSelection(w.get_firstContext().get_node(),!f):Ua.SelectionFactory.createCollapsedSelection(w.get_firstContext().get_node(),!0);else{var x;(x=ha.g.createFromNode(w.get_firstContext().get_node())).tryToRootAtAncestorOfType(14);l?(Pd.TableNavigator.returnToContainingRow(x),m&&!Gl.n.get_instance().get_item(77)?(x.tryToRootAtOutlineAncestor(),_s.OutlineElementNavigator.returnToOutlineElement(x),e.get_OutlineElementEditor().insertOutlineElementAsSibling(x,!1,!0)):e.MoveToFirstColumnControlCell(x),w=Ua.SelectionFactory.createCollapsedSelection(x.get_currentNode(),!0)):(Pd.TableNavigator.returnToCell(x),f&&Gl.n.get_instance().get_item(30)?(Pd.TableNavigator.moveToLastRow(x),w=Ua.SelectionFactory.createCollapsedSelection(x.get_currentNode(),!1)):(Gl.n.get_instance().get_item(63)||Gl.n.get_instance().get_item(77))&&(e.moveToFirstRowControlCell(x),w=Ua.SelectionFactory.createCollapsedSelection(x.get_currentNode(),!0)))}s.get_selectionManager().setSelection(w),St.FocusManager.instance().setScope(s.get_focusScopeId())}}else h&&h.cancel();return _&&_.dispose(),2===i&&(S.ULS.sendTraceTag(9011549,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}",t,Oi.u.getNameFromId(t)||"Unknown",Gl.n.get_instance().get_item(77),d,v,c.containingTable.get_id().toString())),l||32!==v||e.get_TrackChangeManager().alertUntrackedChange(12)),l?Dr.t.mark(4952):Dr.t.mark(4950),v},e.GotoFocusCellAfterInsertColumnImpl=function(e,t){Pd.TableNavigator.moveToFirstRow(e);var n=(0,y.e)(pm.TableCellNode,e.get_currentNode()).get_colSpan();if(t)for(var i=0;i<n;i++)Pd.TableNavigator.moveToNextColumn(e);else Pd.TableNavigator.moveToPreviousColumn(e)},e.GetRefRowWhenInsertRowImpl=function(t,n){return e.generalizeTableContextsToLowestCommonTable(t,!1,!0,!0)},e.GetRefCellWhenInsertColumnImpl=function(t,n){return e.generalizeTableContextsToLowestCommonTable(t,!0,!0,!0)},e.GetRefColumnFromRefCellImpl=function(e,t){var n=Fd.s.getColumnIndex(e);return t&&(n+=e.get_currentNode().get_colSpan()-1),n},e.GetRefColumnsWhenSelectColumnImpl=function(t){var n=fa.SelectionManager.buildSectionContext(t);return e.generalizeTableContextsToLowestCommonTable(n,!0,!0,Gl.n.get_instance().get_item(104)&&e.get_IsUnblockComplexTableEnabled())},e.GetRefRowsWhenSelectRowImpl=function(t){var n=fa.SelectionManager.buildSectionContext(t);return e.generalizeTableContextsToLowestCommonTable(n,!1,!0,Gl.n.get_instance().get_item(104)&&e.get_IsUnblockComplexTableEnabled())},e.GetRowOrColumnsForDeleteImpl=function(t,n,i){return e.generalizeTableContextsToLowestCommonTable(t,!n,!0,!0)},e.generalizeTableContextsToLowestCommonTable=function(t,n,i,r){var o=new om;if(o.containingTable=null,!t)return o.response=8,o;var a={},l=new Array(0),s=!1,u=e.get_ContextSetEditor().breakDownContextSets(t);1===u.length&&(s=!0);for(var c=function(t){if(u[t].get_isGraphNodeContext()){var i=[],s=ha.g.createFromNode(u[t].get_node());if(s.tryToRootAtOutlineAncestor(),!js.TableCellReader.isTableCellOrInside(s))return o.response=8,{value:o};if(n)Pd.TableNavigator.returnToCell(s),r&&js.TableCellReader.getColSpan(s.get_currentNode())>1?js.TableCellReader.foreachMergedCells(s.get_currentNode(),(function(e){var t=ha.g.createFromNode(e);t.tryToRootAtOutlineAncestor(),Pd.TableNavigator.moveToFirstRow(t),Array.add(i,t)}),2):Array.add(i,s),Pd.TableNavigator.moveToFirstRow(s);else{js.TableCellReader.isTableCell(s)||Pd.TableNavigator.returnToCell(s);var c=s.get_currentNode().get_rowSpan();if(Pd.TableNavigator.returnToContainingRow(s),c>1)for(var d=1;d<c;d++){var g=ha.g.createFromNode(s.get_currentNode());g.tryToRootAtOutlineAncestor(),Array.add(i,g),Pd.TableNavigator.moveToNextRow(s)}Array.add(i,s)}for(var p=0;p<i.length;++p){s=i[p];var h=Pd.TableNavigator.getContainingTable(s),_=s.get_currentNode().get_id().toString();if(!a[_])if(a[_]=!0,o.containingTable)if(o.containingTable!==h)if(s.hasAncestor(o.containingTable))e.GeneralizeToElementOfTable(s,o.containingTable,n),_=s.get_currentNode().get_id().toString(),a[_]||(a[_]=!0,Array.add(l,s));else{if(a[_]=!1,!ha.g.createFromNode(o.containingTable).tryToRootAtAncestor(h))return o.response=8,{value:o};for(var m=[],f=0;f<l.length;f++){var y=l[f];e.GeneralizeToElementOfTable(y,h,n),_=y.get_currentNode().get_id().toString(),a[_]||(a[_]=!0,Array.add(m,y))}_=s.get_currentNode().get_id().toString(),a[_]||(a[_]=!0,Array.add(m,s)),o.containingTable=h,Array.clear(l),l=m}else Array.add(l,s);else o.containingTable=h,Array.add(l,s)}Array.clear(i)}},d=0;d<u.length;++d){var g=c(d);if("object"==typeof g)return g.value}if(!l.length)return o.response=8,o;if(!i&&l.length>1)return o.response=8,o;o.singleElement=l[0].get_currentNode();var p=[];for(d=0;d<l.length;d++){var h=l[d];if(!r&&us.TableReader.isInComplexTable(h))return o.response=8,o;Array.add(p,Wa.y.create(h.get_currentNode()))}return o.numberOfOperations=s?1:p.length,o.processContexts=p,o.response=32,o},e.GeneralizeToElementOfTable=function(e,t,n){do{n?Pd.TableNavigator.returnToContainingCell(e):Pd.TableNavigator.returnToContainingRow(e)}while(Pd.TableNavigator.getContainingTable(e)!==t);n&&Pd.TableNavigator.moveToFirstRow(e)},e.InsertTableFlyoutEnabled=function(e,t,n,i,r){if(1===n){var o=t.get_nextContext();return o&&ga.SelectionEditor.isInsertionPointContext(o)?L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(o,Oi.u.insertTable,n,!0,i,r):2}return 32},e.InsertTableDialogHandler=function(t,n,i,r,o){return 1===i?L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.insertTable,i):(new vm(Box4Intl.Box4Strings.l_TableInsertDialog,e.InsertTableDialogCallback,1,1,100,63,2,5,1,1),32)},e.InsertTableDialogCallback=function(e,t){var n=new Ac.v;n.rows=e,n.columns=t,L.AFrameworkApplication.get_theActionManager().processActionWithData(Oi.u.insertTable,2,n)},e.InsertTableView=function(t,n,i,r,o){r.dataValue1=0,r.dataValue2=0;var a=-1,l=null,s=null,u=null;if(!n.view.get_isInteractiveView())return 2;var c=n.view;if(!c.get_selectionManager())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelectionManager}),8;if(Dr.t.mark(4941),2===i){var d=c.get_selectionManager().get_selectionContextForActionDispatch();d.get_isGraphNodeContext()&&(u=new Ma.GraphTransaction(15),s=Gs.q.get_instance().getTraversableIteratorAtOutlineElement(d.get_node()),u.setFromIterator(s),(l=new ha.g).setFrom(s),l.returnToParent(),a=l.getChildIndex(s.get_currentNode()))}var g=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n.get_nextContext(),t,i,!0,r,o);if(32===g&&2===i){var p=void 0;if(s.get_isValid()?(_s.OutlineElementNavigator.moveToNextOutlineElement(s,!1,!1),_s.OutlineElementNavigator.moveToContent(s),p=Ua.SelectionFactory.createCollapsedSelection(s.get_currentNode(),!0)):(l.goToChildIndex(a),_s.OutlineElementNavigator.moveToContent(l),p=Ua.SelectionFactory.createCollapsedSelection(l.get_currentNode(),!0)),c.get_selectionManager().setSelection(p),St.FocusManager.instance().setScope(c.get_focusScopeId()),yi.App.get_box4Bridge()&&yi.App.get_box4Bridge().get_commandUi()){var h=void 0;h=L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()?"Table":yi.App.tableToolsDesignTabIsEnabled?"ContextualTabs.Tables.Design":"ContextualTabs.Tables.Layout",yi.App.get_box4Bridge().get_commandUi().ribbonActivateTab(h)}}return u&&u.dispose(),Dr.t.mark(4942),g},e.QueryTableTabGroup=function(t,n,i,r,o){var a=n;if(!a.view.get_isInteractiveView())return 8;var l=a.view;if(!l.get_selectionManager())return 8;var s=l.get_selectionManager().get_selectionContextForActionDispatch(),u=e.get_ContextSetEditor().breakDownContextSets(s);if(u.length<=0)return 8;for(var c=new ha.g,d=0;d<u.length;++d)if(c.set(u[d].get_node()),c.tryToRootAtOutlineAncestor(),!us.TableReader.isInTable(c))return 8;return 32},e.CreateTable=function(t,n,i,r,o){var a=n.get_contextId()===ol.d.insertionPoint,l=null,s=null;if(a){if(l=n,Ha.HyperlinkReader.isIpInHyperlink(l,!0))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsHyperlink}),8;(s=new ha.g).set(l.get_node()),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(s),Qs.q.isInTitle(s)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsTitle}),a=!1),!l.get_cpBegin()&&s.get_isFirstSibling()&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.invalidTableLocation}),a=!1)}if(1===i||!a)return a?32:8;Dr.t.mark(4929);var u=new Ma.GraphTransaction(7);u.setFromIterator(s),_s.OutlineElementNavigator.returnToOutlineElement(s);var c=s.get_currentNode();e.get_OutlineElementEditor().insertOutlineElementAsSibling(s,!1,!1);var d=e.get_TableEditor().createTable(s,1,2);e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()&&e.get_TrackChangeEditor().markTableForInsertion(d);var g=new ha.g;return g.set(c),g.tryToRootAtOutlineAncestor(),Pd.TableNavigator.moveToCellContent(s,0,1),e.get_OutlineElementEditor().splitAtIp(g,s,l,!0,!0,!0),Pd.TableNavigator.returnToContainingTable(s),Pd.TableNavigator.moveToCellContent(s,0,0),s.disconnectNodeAndReturnToParent(),ws.z.moveNode(g,s,null,g.get_role()),e.get_ListEditor().applyListInfo(g,null),Pd.TableNavigator.returnToContainingTable(s),_s.OutlineElementNavigator.returnToOutlineElement(s),g.goToFirstChildByRole(1)&&ws.z.moveChildren(s,null,1,1,g,-1),e.get_AutoCorrectScheduler()&&e.get_AutoCorrectScheduler().tryToAutocorrectAtTextBreak(c,Re.v.vK_Tab),u.dispose(),S.ULS.sendTraceTag(42505434,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",t,Oi.u.getNameFromId(t)||"Unknown",Gl.n.get_instance().get_item(77),d.get_id().toString())),Dr.t.mark(4930),32},e.InsertColumn=function(t,n,i,r,o){var a=ga.SelectionEditor.isInsertionPointContext(n)&&t===Oi.u.splitInsertColumnAfter||n.get_contextId()===ol.d.tableCell,l=null;if(a&&((l=new ha.g).set(n.get_node()),l.tryToRootAtAncestorOfType(14),js.TableCellReader.isTableCellOrInside(l)||(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsTableCell}),a=!1),a&&!e.get_isRowOrColumnOperationEnabledDelegate()(l,t)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedOrComplexTable}),a=!1),a)){Pd.TableNavigator.returnToContainingCell(l);var s=Gl.n.get_instance().get_item(63)?63:255;if(us.TableReader.getColumnCount(Pd.TableNavigator.getContainingTable(l))>=s)return e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.maxColumnCount}),8}if(1===i||!a)return a?32:8;Dr.t.mark(4931);var u=t!==Oi.u.insertColumnBefore,c=new Ma.GraphTransaction(15);c.setFromIterator(l),n.get_node().getGraphSpace().get_graphTransactionOperations().blockRttSend(2);var d=new ha.g;d.set(l.get_currentNode()),d.tryToRootAtAncestorOfType(15),Pd.TableNavigator.returnToContainingTable(l);var g=l.get_currentNode(),p=e.get_getRefColumnFromRefCellDelegate()(d,u);u&&p++;var h=o||1;if(e.get_TableEditor().insertColumns(l,p,!u,h,e.get_getNewOutlineElementInfoDelegate()),e.get_CcConfigSettings()&&e.get_CcConfigSettings().get_isContentControlEditingEnabled()&&g.hasProperty(os.j.contentControlHolderObjectId)){var _=g.getValueWithDefault(mt.h,os.j.contentControlHolderObjectId,mt.h.get_nil());if(!_.equals(mt.h.get_nil())){var m=new C.c(mm.k),f=ha.g.createFromNode(g);Pd.TableNavigator.forEachCellInTable(f,(function(e,t,n){return n!==p||js.TableCellReader.isGhostCell(e)||Ga.ParagraphReader.getParagraphsUnderIterator(e,!1,!1,m),!0})),e.get_ContentControlEditor()&&e.get_ContentControlEditor().addBlockContentControlInformationToParagraphs(m,_)}}if(l.set(n.get_node()),l.tryToRootAtAncestorOfType(16),t===Oi.u.splitInsertColumnAfter)Pd.TableNavigator.moveToNextColumn(d),fs.OutlineNavigator.moveToFirstOutlineElement(d),_s.OutlineElementNavigator.returnToOutlineElement(l),e.get_OutlineElementEditor().removeContent(d),e.get_OutlineElementEditor().splitAtIp(l,d,n,!0,!0,!0),e.get_AutoCorrectScheduler()&&e.get_AutoCorrectScheduler().tryToAutocorrectAtTextBreak(l.get_currentNode(),Re.v.vK_Tab);else{var y=yi.App.get_activeAppFrame().workspace,S=ha.g.createFromNode(n.get_node());S.tryToRootAtOutlineAncestor(),e.get_gotoFocusCellAfterInsertColumnDelegate()(S,u),y.get_contentView().get_selectionManager().setSelection(Ua.SelectionFactory.createCollapsedSelection(S.get_currentNode(),!0))}return e.get_TrackChangeManager().alertUntrackedChange(12),c.dispose(),Dr.t.mark(4932),32},e.IsRowColumnOperationEnabledForComplexTable=function(e,t){return!(Gl.n.get_instance().get_item(14)&&us.TableReader.isInLockedOrComplexTable(e)||Gl.n.get_instance().get_item(30)&&us.TableReader.isInComplexTable(e))},e.InsertRow=function(t,n,i,r,o){var a=t===Oi.u.splitInsertRowBelow,l=t===Oi.u.insertRowAbove,s=n.get_node(),u=new ha.g;u.set(s),u.tryToRootAtOutlineAncestor();var c=!0;if(Dd.v.isTableRowNode(s)||us.TableReader.isInTable(u)||(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.doesNotContainTable}),c=!1),c&&!e.get_isRowOrColumnOperationEnabledDelegate()(u,t)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedOrComplexTable}),c=!1),1===i||!c)return c?32:8;Dr.t.mark(4933);var d=new Ma.GraphTransaction(15);d.setFromIterator(u),n.get_node().getGraphSpace().get_graphTransactionOperations().blockRttSend(2);var g=null;if(a){var p=new ha.g;p.setFrom(u),_s.OutlineElementNavigator.returnToOutlineElement(p),Pd.TableNavigator.returnToContainingRow(u),g=e.get_TableEditor().insertRows(u,l,1,e.get_getNewOutlineElementInfoDelegate()),Pd.TableNavigator.moveToFirstColumn(u),fs.OutlineNavigator.moveToFirstOutlineElement(u),e.get_OutlineElementEditor().splitAtIp(p,u,n,!1,!0,!0),Pd.TableNavigator.returnToContainingRow(u),e.get_AutoCorrectScheduler()&&e.get_AutoCorrectScheduler().tryToAutocorrectAtTextBreak(p.get_currentNode(),Re.v.vK_Tab)}else{var h=o||1;g=e.get_TableEditor().insertRows(u,l,h,e.get_getNewOutlineElementInfoDelegate())}e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()&&e.get_TrackChangeEditor().markTableRowForInsertion(g),e.get_ChangeIdEditor().get_catchUpActivityIsEnabled()&&e.get_ChangeIdEditor().setChangeIdOnTableRow(g);var _=Pd.TableNavigator.getContainingTable(u);if(e.get_CcConfigSettings()&&e.get_CcConfigSettings().get_isContentControlEditingEnabled()&&_&&_.hasProperty(os.j.contentControlHolderObjectId)){var m=_.getValueWithDefault(mt.h,os.j.contentControlHolderObjectId,mt.h.get_nil());if(!m.equals(mt.h.get_nil())&&e.get_ContentControlEditor()){var f=ha.g.createFromNode(g);e.get_ContentControlEditor().addOrCopyBlockContentControlInformationToSubGraph(f,null,null,m,!1)}}var y=yi.App.get_activeAppFrame().workspace,C=ha.g.createFromNode(s);return C.tryToRootAtAncestorOfType(14),Dd.v.isTableRow(C)||Pd.TableNavigator.returnToContainingRow(C),l?Pd.TableNavigator.moveToPreviousRow(C):Pd.TableNavigator.moveToNextRow(C),e.MoveToFirstColumnControlCell(C),y.get_contentView().get_selectionManager().setSelection(Ua.SelectionFactory.createCollapsedSelection(C.get_currentNode(),!0)),d.dispose(),Dr.t.mark(4934),32},e.genericViewActionTableCellHandler=function(t,n,i,r,o){var a=sm.performGenericViewLevelAction(t,n,i,r,o,{},16);if(2===i&&e.ShouldLog(t)){var l=Oi.u.getNameFromId(t)||"Unknown";S.ULS.sendTraceTag(8791561,324,50,String.format("ActionId={0}, ActionName={1}, Response={2}",t,l,a))}return 2===i&&32===a&&e.get_TrackChangeManager().alertUntrackedChange(13),a},e.ShouldLog=function(e){return e===Oi.u.justifyTopLeft||e===Oi.u.justifyTopCenter||e===Oi.u.justifyTopRight||e===Oi.u.justifyMiddleLeft||e===Oi.u.justifyMiddleCenter||e===Oi.u.justifyMiddleRight||e===Oi.u.justifyBottomLeft||e===Oi.u.justifyBottomCenter||e===Oi.u.justifyBottomRight},e.DeleteColumn=function(t,n,i,r,o){var a=new ha.g,l=n.get_isValid();if(l&&(a.set(n.get_node()),a.tryToRootAtOutlineAncestor()||(e.get_ActivityManager().recordEvent(ah.f.unexpectedState,{Reason:lh.i.failedToRoot}),l=!1),js.TableCellReader.isTableCellNode(n.get_node())||(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsTableCell}),l=!1)),l&&!e.get_isRowOrColumnOperationEnabledDelegate()(a,t)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedOrComplexTable}),l=!1),l&&!e.get_UnsupportedNodeEditor().areAllObjectsDeletable()){var s;(s=new ha.g).setFrom(a);do{if(!e.get_UnsupportedNodeEditor().canAllContentBeDeleted(s.get_currentNode())){e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.contentCannotBeDeleted}),l=!1;break}}while(Pd.TableNavigator.moveToNextRow(s))}if(l&&((s=new ha.g).setFrom(a),1!==i&&Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()))do{for(var u=X_.z.createTraverser(s.get_currentNode());u.moveNext();){var c=u.get_currentNode();Ga.ParagraphReader.isParagraphNode(c)&&yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(c)}}while(Pd.TableNavigator.moveToNextRow(s));if(1===i)return l?32:8;if(l){Dr.t.mark(4935);var d=new Ma.GraphTransaction(7);try{d.setFromIterator(a),e.get_TableEditor().deleteColumnsContainingCell(a,1)}finally{d&&d.dispose()}return Dr.t.mark(4936),32}return 2},e.MergeCells=function(t,n,i,r,o){var a=o,l=new ha.g,s=n.get_isValid();if(s){if(l.set(n.get_node()),l.tryToRootAtOutlineAncestor()||(e.get_ActivityManager().recordEvent(ah.f.unexpectedState,{Reason:lh.i.failedToRoot}),s=!1),js.TableCellReader.isTableCellNode(n.get_node())||(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsTableCell}),s=!1),s&&!e.get_UnsupportedNodeEditor().areAllObjectsDeletable()){(d=new ha.g).setFrom(l),(g=new ha.g).setFrom(l);for(var u=0;u<a.rowSpan;u++){for(var c=0;c<a.colSpan;c++){if(!e.get_UnsupportedNodeEditor().canAllContentBeDeleted(d.get_currentNode())){e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.contentCannotBeDeleted}),s=!1;break}d.goToNextSiblingByRole(1)}if(!s)break;Pd.TableNavigator.moveToNextRow(g),d.setFrom(g)}}if(s&&1!==i&&Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()){var d,g;(d=new ha.g).setFrom(l),(g=new ha.g).setFrom(l);for(u=0;u<a.rowSpan;u++){for(c=0;c<a.colSpan;c++)yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(d.get_currentNode()),d.goToNextSiblingByRole(1);if(!s)break;Pd.TableNavigator.moveToNextRow(g),d.setFrom(g)}}}if(1===i)return s?32:8;if(s){var p=new Ma.GraphTransaction(7);try{p.setFromIterator(l),e.get_TableEditor().mergeCells(l,a.rowSpan,a.colSpan)}finally{p&&p.dispose()}return 32}return 2},e.SplitCells=function(t,n,i,r,o){var a=new ha.g,l=n.get_isValid();if(l&&(a.set(n.get_node()),a.tryToRootAtOutlineAncestor()||(e.get_ActivityManager().recordEvent(ah.f.unexpectedState,{Reason:lh.i.failedToRoot}),l=!1),js.TableCellReader.isTableCellNode(n.get_node())||(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsTableCell}),l=!1),l&&1!==i&&Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable())){var s=new ha.g;s.setFrom(a),yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(s.get_currentNode())}if(1===i)return l?32:8;if(l){var u=o,c=u.rows,d=u.columns,g=new Ma.GraphTransaction(7);try{g.setFromIterator(a),e.get_TableEditor().splitCell(a,c,d)}finally{g&&g.dispose()}return 32}return 2},e.DeleteTable=function(t,n,i,r,o){var a=n.get_node(),l=!0;if(us.TableReader.isTableNode(a)||(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsTable}),l=!1),e.get_UnsupportedNodeEditor().canAllContentBeDeleted(a)||(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.contentCannotBeDeleted}),l=!1),l&&(Gl.n.get_instance().get_item(14)||Gl.n.get_instance().get_item(63))&&e.get_LockedRangeEditor().isTableNodeInLockedRange(a)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),l=!1),1===i)return l?32:8;if(l){if(Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable())for(var s=X_.z.createTraverser(a);s.moveNext();){var u=s.get_currentNode();12===u.get_type()&&yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(u)}var c=(0,y.e)(xm,o);if(!e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()||!e.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()||!!c&&c.forceDeletion||!e.get_TrackChangeEditor().tryMarkTableForDeletion(a)){var d=new Ma.GraphTransaction(7);d.setFromNode(a);var g=new ha.g;g.set(a),g.tryToRootAtOutlineAncestor(),g.returnToParent(),e.get_TableEditor().handlePargraphDeletion(g),e.get_CcConfigSettings()&&e.get_CcConfigSettings().get_isContentControlEditingEnabled()&&e.get_ContentControlEditor()&&e.get_ContentControlEditor().updateContentControlNodeStartEndObjectOnTableDeleted(a),e.get_OutlineElementEditor().disconnectOutlineElement(g),d.dispose(),c&&(c.forceDeletion=!0)}return S.ULS.sendTraceTag(42505435,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",t,Oi.u.getNameFromId(t)||"Unknown",Gl.n.get_instance().get_item(77),a.get_id().toString())),32}return 2},e.DeleteRow=function(t,n,i,r,o){var a=n.get_node();if(!e.get_UnsupportedNodeEditor().canAllContentBeDeleted(a))return 8;var l=new ha.g;l.set(a),l.tryToRootAtOutlineAncestor();var s=Dd.v.isTableRowNode(a);if(s||e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsTableRow}),s&&!e.get_isRowOrColumnOperationEnabledDelegate()(l,t)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedOrComplexTable}),s=!1),1===i)return s?32:8;if(s){if(Gl.n.get_instance().get_item(50)&&!yi.App.get_theCoauthManager().get_amIAlone())for(var u=X_.z.createTraverser(a);u.moveNext();){var c=u.get_currentNode();12===c.get_type()&&yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(c)}Dr.t.mark(4937);var d=(0,y.e)(xm,o);if(!e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()||!e.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()||!!d&&d.forceDeletion||!e.get_TrackChangeEditor().tryMarkTableRowForDeletion(a)){var g=new Ma.GraphTransaction(7);g.setFromNode(a),e.get_TableEditor().deleteRows(l,1),g.dispose(),d&&(d.forceDeletion=!0)}return Dr.t.mark(4938),32}return 2},e.CollapseTable=function(t,n,i,r,o){var a=!1,l=null;if(n.get_isGraphNodeContext()&&((l=new ha.g).set(n.get_node()),(a=us.TableReader.isTable(l)&&us.TableReader.isSingleCellTable(l.get_currentNode()))?l.tryToRootAtOutlineAncestor():e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsSingleCellTable})),1===i)return a?32:8;if(a){Dr.t.mark(4939);var s=new ha.g;s.setFrom(l),Pd.TableNavigator.moveToCell(s,0,0),_s.OutlineElementNavigator.returnToOutlineElement(l);var u=new Ma.GraphTransaction(7);return u.setFromIterator(s),e.get_OutlineElementEditor().replaceContentWithContentOfOutline(l,s),u.dispose(),Dr.t.mark(4940),32}return 2},e.InsertTable=function(t,n,i,r,o){if(!n.get_isGraphNodeContext())return 2;if(!ga.SelectionEditor.isInsertionPointContext(n))return 2;if(Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().isIpOrTextRangeContextInLockedRange(n))return e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),2;var a=null;if(e.get_CcConfigSettings()&&e.get_CcConfigSettings().get_isContentControlEditingEnabled()){var l=n,s=(a=e.get_ContentControlChpHelper().getContentControlsWrappedIp(l.get_node(),l.get_cpBegin(),l.get_ccBoundaryIdxAtCpBegin())).get_item(a.get_count()-1);if(a.get_count()>0&&!s.isBlock&&(!e.get_ContentControlConverter()||!e.get_ContentControlConverter().isInlineContentControlToBeConvertedToBlock(l,s.get_contentControlObjectId())))return 2}if(e.get_ExternalSelectionManagerFuture()&&e.get_ExternalSelectionManagerFuture().get_instance()&&e.get_ExternalSelectionManagerFuture().get_instance().isExternalSelectionContext(n))return 2;var u=new ha.g;if(u.set(n.get_node()),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(u),Qs.q.isInTitle(u))return e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsTitle}),2;if(1===i)return 32;var c=1,d=2,g=o;if(g&&(c=g.rows,d=g.columns),r.dataValue1=d,r.dataValue2=c,e.get_ContentControlConverter()&&e.get_ContentControlConverter().tryToConvertInlineContentControlToBlock(n),ga.SelectionEditor.isInsertionPointContext(n)){var p=new Ma.GraphTransaction(7);Dr.t.mark(4927),p.setFromNode(n.get_node()),n.get_node().getGraphSpace().get_graphTransactionOperations().blockRttSend(2);var h=new hm.d;if(Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()){var _=n.get_node();yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(_)}var m=vc.FormattingReader.getFormattingObject(n);if(Gl.n.get_instance().get_item(49)&&(m.get_cache().get_isLink()&&(m=m.cloneUnderDifferentChp(null),e.get_FormattingEditor().removeLinkFormatting(m)),h.formatting=m.get_formattingId()),h.languageId=vc.FormattingReader.language(m),Gl.n.get_instance().get_item(71)&&(h.style=bs.StyleReader.getStyleFromParagraphNode(n.get_node()),e.get_ListReader().doesStyleImplyList(h.style))){var f=bs.StyleReader.getStyleSetFromParagraphNode(n.get_node());f&&(h.style=f.getStyleById(bs.StyleReader.get_wordStyleIdNormal()))}var y=null;if(Gl.n.get_instance().get_item(54)){var C=ha.g.createFromNode(n.get_node());C.tryToRootAtAncestorOfType(11),y=e.get_ParagraphIndentationReader().getLeftIndent(C.get_currentNode())}else y=new Ts.e(1,-1);var b=e.get_OutlineElementEditor().insertOutlineElementAt(n,!0),v=null;if(v=g&&g.isRichApi?e.get_TableEditor().createTable(b,c,d,h):e.get_TableEditor().createTable(b,c,d,h,!0),e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()&&e.get_TrackChangeEditor().markTableForInsertion(v),e.get_ChangeIdEditor().get_catchUpActivityIsEnabled()&&e.get_ChangeIdEditor().setChangeIdOnTable(v),g&&(g.tableNode=v),_s.OutlineElementNavigator.returnToOutlineElement(b),e.get_CcConfigSettings()&&e.get_CcConfigSettings().get_isContentControlEditingEnabled()&&a&&a.get_count()>0){var T=ha.g.createFromNode(v),A=a.get_item(a.get_count()-1).get_contentControlObjectId();e.get_ContentControlEditor()&&(e.get_ContentControlEditor().addOrCopyBlockContentControlInformationToSubGraph(T,null,null,A,!1),v.setValue(os.j.contentControlHolderObjectId,A))}if(Gl.n.get_instance().get_item(56)&&h.style&&!Ss.OutlineElementReader.isRtlSet(b.get_currentNode()))h.style.getValueWithDefault(Boolean,is.b.outlineElementRTL,!1)&&e.get_OutlineElementEditor().setRtl(b.get_currentNode(),!0);return e.get_ListEditor().applyListInfo(b,null,!0,!1,-1),e.get_ListEditor().setLeftIndentOnTableIfNecessary(b,y.get_unit(),y.get_value()),Ss.OutlineElementReader.isLastOutlineElementInOutline(b)&&e.get_OutlineElementEditor().insertOutlineElementAsSibling(b,!1,!0,h),p.dispose(),S.ULS.sendTraceTag(42505436,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}, RowCount={4}, ColumnCount={5}",t,Oi.u.getNameFromId(t)||"Unknown",Gl.n.get_instance().get_item(77),v.get_id().toString(),c,d)),Dr.t.mark(4928),L.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorGridTableDefaultStyleSettings"),32}return ga.SelectionEditor.isTextRangeContext(n),2},e.ToggleBorders=function(e,t,n,i,r){if(1===n)return 32;Dr.t.mark(5748);var o=t.get_node(),a=new Ma.GraphTransaction(15);a.setFromNode(o);var l=!o.getValueWithDefault(Boolean,is.b.tableBordersVisible,!0);return o.setValue(is.b.tableBordersVisible,l),a.dispose(),Dr.t.mark(5749),32},e.QueryBordersHidden=function(e,t,n,i,r){var o=!t.get_node().getValueWithDefault(Boolean,is.b.tableBordersVisible,!0);return r.setValue(is.b.tableBordersVisible,o),32},e.topJustify="top",e.middleJustify="center",e.bottomJustify="bottom",e.cumulativeJustificationKey="__cumulative__",e.consistentKey="__consistent__",e._actionIdToHAlignMap=new d.w(Am),e._actionIdToVAlignMap=new d.w(String),e._outlineElementEditor=null,e._autoCorrectScheduler=null,e._paragraphIndentationReader=null,e._tableAltTextDialog=null,e._deleteTableSegmentStrategy=null,e._isUnblockComplexTableEnabled=null,e._ccConfigSettings=null,e._externalSelectionManagerFuture=null,e._getNewOutlineElementInfoDelegate=null,e.alignmentEnabledGetter=e.getTableCellAlignmentIsEnabled,e._getRefRowWhenInsertRowDelegate=null,e._getRefCellWhenInsertColumnDelegate=null,e._getRefColumnFromRefCellDelegate=null,e._getRefColumnsWhenSelectColumnDelegate=null,e._getRefRowsWhenSelectRowDelegate=null,e._gotoFocusCellAfterInsertColumnDelegate=null,e._getRowOrColumnsForDeleteDelegate=null,e._isRowOrColumnOperationEnabledDelegate=null,e._featureHelper=null,e._formattingEditor=null,e._trackChangeManager=null,e._trackChangeEditor=null,e._changeIdEditor=null,e._listReader=null,e._listEditor=null,e._contentControlChpHelper=null,e._contentControlConverter=null,e._contentControlEditor=null,e._contextSetEditor=null,e._tableEditor=null,e}();(0,o.l)(Em,"fced7ad4$TableActor",null,[]);var Fm=n(6264),Pm=n(4445),Dm=n(622),Rm=n(6142),Mm=n(7982),km=function(){return function(e,t,n,i){this.sourceRowHeights=null,this.sourceColumnWidths=null,this.tableIterator=null,this.deletedColumns=null,this.deletedRows=null,this.sourceCellLocation=null,this.sourceCellLocation=e,this.tableIterator=t,this.sourceColumnWidths=n,this.sourceRowHeights=i}}();(0,o.l)(km,"3f9b7943$TableSimplificationInformation",null,[]);var Nm=n(3787),Lm=n(2822),Bm=n(2245),Om=function(){function e(e,t,n,i,r,o,a,l,s,u,c,d,g,p,h,_){this._tableEditor=null,this._outlineEditor=null,this._outlineElementEditor=null,this._clipboardRoot=null,this._virtualClipboardRoot=null,this._userClipboardRoot=null,this._dragdropClipboardRoot=null,this._selectionCollection=null,this._listEditor=null,this._usageHelper=null,this._imageEditor=null,this._notebookManager=null,this._paragraphIndentationReader=null,this._appSettingsManager=null,this._getNewOutlineElementInfoDelegate=null,this._listReader=null,this._graphTransactionFactory=null,this._contentControlCopyPasteHelper=null,this._tableCellReader=null,this._trackChangeReader=null,this._trackChangeManager=null,this._sequenceCodePrefix=null,this._sequenceCodeCommonPrefix=null,this._formattingPropertyTransitStrategy=null,this._noOutlineLevelContentOverride=!1,this._notebookManager=o,this._paragraphIndentationReader=a,this._imageEditor=e,this._tableEditor=t,this._outlineEditor=n,this._outlineElementEditor=i,this._listEditor=r,this._appSettingsManager=l,this._graphTransactionFactory=u,this._userClipboardRoot=s.create(2097162),this.RegisterClipboardRoot(this._userClipboardRoot),this._dragdropClipboardRoot=s.create(2097162),this.RegisterClipboardRoot(this._dragdropClipboardRoot),this._virtualClipboardRoot=s.create(2097162),this.RegisterClipboardRoot(this._virtualClipboardRoot),this._clipboardRoot=this._userClipboardRoot,this._contentControlCopyPasteHelper=c,this._tableCellReader=d,this._trackChangeReader=g,this._trackChangeManager=p,this._sequenceCodePrefix=h,this._sequenceCodeCommonPrefix=h.substr(0,3),this._formattingPropertyTransitStrategy=_}return e.prototype.get_ListReader=function(){return this._listReader||(this._listReader=Ge.w.get_instance().resolve(Ql.c))},e.prototype.get_SequenceCode=function(){return this._selectionCollection?this._selectionCollection.get_sequenceCode():0},e.prototype.get_ContainsEop=function(){return this._selectionCollection.get_currentSelection().containsEop},e.prototype.get_endsWithEop=function(){return this._selectionCollection.get_currentSelection().endsWithEop},e.prototype.get_theClipboardRoot=function(){return this._clipboardRoot},e.prototype.get_theVirtualClipboardRoot=function(){return this._virtualClipboardRoot},e.prototype.get_containsOutlineLevelContent=function(){return this._selectionCollection.isOutlineLevelSelection&&!this._noOutlineLevelContentOverride},e.prototype.set_containsOutlineLevelContent=function(e){return e?S.ULS.shipAssertTag(6305555,307,!1):this._noOutlineLevelContentOverride=!0,e},e.prototype.get_OnlyCopySelectedNodes=function(){return!this._selectionCollection.isOutlineLevelSelection},e.prototype.get_UsageEditor=function(){return kh.z.get_instance()},e.prototype.get_isPasteTableWithReplacingCellEnabled=function(){return this._appSettingsManager.getBooleanAppSetting("InternalPasteTableWithReplacingCellIsEnabled")&&Gl.n.get_instance().get_item(63)||Gl.n.get_instance().get_item(77)},e.prototype.RegisterClipboardRoot=function(e){var t=new wi.n(-1);this._notebookManager.get_theGraph().addRoot(t);var n=new ha.g;n.set(t);var i=this._graphTransactionFactory.getTransaction(3);i.setFromIterator(n),n.addChild(e,50),i.dispose()},e.prototype.copySelectionToInternalClipboard=function(e,t){void 0===t&&(t=null);var n=e.get_selectionManager();this._selectionCollection=n.get_selectionCollection().clone(),this._noOutlineLevelContentOverride=!1;var i=ha.g.createFromNode(n.get_theSelectionRoot()),r=ha.g.createFromNode(this._clipboardRoot),a=this._graphTransactionFactory.getTransaction(3);a.setFromIterator(r),i.goToFirstChildByRole(52);do{i.get_currentNode().validateProperties(null)}while(i.goToNextSiblingByRoleOrReturnToParent(52));var l=new vp.a(t,o.i(this,this.ClearInternalClipboard,"ClearInternalClipboard"),new O_(i,r,this._selectionCollection,a));l.setDebugName("InternalCopy"),l.set_isSynchronous(!t||t.get_isSynchronous()),l.run()},e.prototype.ClearInternalClipboard=function(e,t){Dr.t.mark(5566);var n=t.Target;return n.goToFirstChild()?(n.disconnectNodeAndReturnToParent(),!0):(e.changeStepCallback(o.i(this,this.ExecuteCopy,"ExecuteCopy")),!0)},e.prototype.ExecuteCopy=function(e,t){var n=new H_(t,null),i=new vp.a(e,o.i(this,this.CoreCopySetup,"CoreCopySetup"),n);return i.setDebugName("ExecuteCoreCopyToInternalClipboard"),i.run(),e.changeStepCallback(o.i(this,this.TrimNewText,"TrimNewText")),!0},e.prototype.CoreCopySetup=function(e,t){var n=t,i=n.Source;n.Target,n.InsertAfter;return i.goToFirstChild()?(e.changeStepCallback(o.i(this,this.CoreCopyIteration,"CoreCopyIteration")),!0):(n.ParentArgs&&(n.ParentArgs.ChildOperationReturnValue=null),S.ULS.shipAssertTag(6305560,307,!1),!1)},e.prototype.CoreCopyIteration=function(e,t){var n=t,i=n.InsertAfter,r=n.Source,a=n.Target,l=r.get_currentNode(),s=this.get_OnlyCopySelectedNodes();if(!l.get_isPersistable())return e.changeStepCallback(o.i(this,this.CoreCopyIncrement,"CoreCopyIncrement")),!0;if(n.ParentArgs.shouldCopySubtree&&(n.shouldCopySubtree=!0),!n.shouldCopySubtree&&(l.excludeFromInternalClipboard()&&n.get_usageHelper().internalCopyUsageData.c++,l.excludeFromInternalClipboard()||s&&!l.isPartOfSelectedStructure(this.get_SequenceCode())))return e.changeStepCallback(o.i(this,this.CoreCopyIncrement,"CoreCopyIncrement")),!0;if(!n.shouldCopySubtree&&s&&!l.get_renderToClipboard()){if(r.hasChildren()){n.UseChildReturnValue=!0;var u=new vp.a(e,o.i(this,this.CoreCopySetup,"CoreCopySetup"),new H_(n,i));u.setDebugName("RecursiveCoreCopyToInternalClipboard"),u.run()}return e.changeStepCallback(o.i(this,this.CoreCopyIncrement,"CoreCopyIncrement")),!0}var c=a.get_currentNode().getParentGraphSpace().get_contentObjectSpace(),d=ws.z.copyNode(l,c,!0);this.get_UsageEditor().recordNodeTypeMetrics(n.get_usageHelper().graphObjectUsageData,d);var g=18===r.get_parentNode().get_type()?1:r.get_role();if(a.insertChild(d,i,g),a.goToChild(d),n.InsertAfter=d,Ga.ParagraphReader.isParagraphNode(d)&&(this.ProcessCopiedParagraphs(e,o.i(this,this.CoreCopySetup,"CoreCopySetup"),l,d,n),this.ProcessCopiedBlobs(e,l,d)),this.EnsureTableCellHasWidth(l,d),r.hasChildren()){S.ULS.shipAssertTag(6305562,307,!n.UseChildReturnValue);var p=new vp.a(e,o.i(this,this.CoreCopySetup,"CoreCopySetup"),new H_(n,null));p.setDebugName("RecursiveCoreCopyToInternalClipboard"),p.run()}return e.changeStepCallback(o.i(this,this.CoreCopyIterationPostProcessing,"CoreCopyIterationPostProcessing")),!0},e.prototype.CoreCopyIterationPostProcessing=function(t,n){var i=n,r=i.Source,a=i.Target,l=a.get_currentNode(),s=r.get_currentNode();if(Ga.ParagraphReader.isParagraph(a)&&(i.ParagraphLinks[s.get_id().toString()]=l),Gl.n.get_instance().get_item(54)&&Ga.ParagraphReader.isParagraphNode(l)){if(Ga.ParagraphReader.getTabCountInTheBeginning(s)>0)if(this._paragraphIndentationReader.getHangingIndent(s).get_valueAsTwips()>0)s.setValue(os.j.paraTabCountInTheBeginning,0);else{var u=this._paragraphIndentationReader.getFirstLineIndentWithTabs(s).get_valueAsTwips();e.get_ParagraphEditor().getIndentationEditor().setFirstLineIndent(l,u)}if(!this.get_IsComplexTableCellPasteWithFormattingEnabled()&&this._formattingPropertyTransitStrategy.get_pasteParagraphImprovementIsEnabled()){if(r.returnToParent(),!us.TableReader.isInTable(a)&&r.get_isLastSibling()&&!this.get_endsWithEop())for(var c=0,d=this._formattingPropertyTransitStrategy.get_paragraphPropertyWhitelist();c<d.length;c++){var g=d[c];l.removeProperty(g)}r.goToChild(s)}}if(Gl.n.get_instance().get_item(57)&&Ga.ParagraphReader.isParagraphNode(l)){for(var p=l,h=new Array(0),_=new Array(0),m=0;m<p.get_wordRunProperties().get_length();m++)p.get_wordRunProperties().runIds.set_item(m,Fm.CharacterPropertiesEditor.newWordRunId),p.get_wordRunProperties().paraIds.set_item(m,Fm.CharacterPropertiesEditor.newWordParaId),h[m]=!0,_[m]=!1;p.setProperty_Unchecked(os.j.newlyTypedRuns,h),S.ULS.shipAssertTag(6305563,307,h.length===p.get_wordRunProperties().get_length()),S.ULS.shipAssertTag(6305564,307,Gl.n.get_instance().get_item(50)),S.ULS.shipAssertTag(6305565,307,!!yi.App.get_theCoauthManager()),Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()&&(p.setProperty_Unchecked(ep.p.runsFromMerge,_),S.ULS.shipAssertTag(6305566,307,_.length===p.get_wordRunProperties().get_length())),(this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&this._trackChangeManager.get_changeTrackingDocumentSettingEnabled()||Gl.n.get_instance().get_item(45)&&yi.App.get_box4Bridge().get_trackedChangesEnabled())&&l.setValue(os.j.isNewEop,!0),Gl.n.get_instance().get_item(14)&&l.removeProperties(os.j.fieldNestedLevel,os.j.paraEndInField,os.j.paraStartInField),Gl.n.get_instance().get_item(45)&&Ga.ParagraphReader.isParagraphNode(l)&&l.removeProperties(os.j.isResilientEop)}if(this.OneNoteShouldPostProcessFdo(a)){var f=a.get_currentNode().getGraphSpace(),y=pa.ImageReader.getPictureContainerAsFileDataObject(a.get_currentNode().get_properties(),f.get_contentObjectSpace(),!1),C=pa.ImageReader.getPictureContainerAsFileDataObject(a.get_currentNode().get_properties(),f.get_contentObjectSpace(),!0),b=null;N_.EmbeddedFileReader.isEmbeddedFile(a)&&(b=N_.EmbeddedFileReader.getEmbeddedFileContainer(a.get_currentNode())),this.fileDataObjectCopyPostProcessing(y,s),this.fileDataObjectCopyPostProcessing(C,s),this.fileDataObjectCopyPostProcessing(b,s)}if(this.get_OnlyCopySelectedNodes()&&(this.EnsureTableCellHasOutlineElement(a),us.TableReader.isTable(a))){var v=this._selectionCollection.createSelectionContextsIterator();v.moveNext();var T=js.TableCellReader.getCellLocation(r,v.get_current().get_node());T||(T=new Mm.x(0,0));var A=new km(T,a,us.TableReader.getColumnWidths(r),us.TableReader.getRowHeights(r));this._tableEditor.resetRowAndColumnCountsUpdatingSpans(A)}return Ss.OutlineElementReader.isOutlineElement(a)&&!a.hasChildrenOfRole(2)&&(this._outlineElementEditor.createParagraph(a),a.returnToParent()),a.returnToParent(),i.ParentArgs&&(i.ParentArgs.ChildOperationReturnValue=i.InsertAfter),t.changeStepCallback(o.i(this,this.CoreCopyIncrement,"CoreCopyIncrement")),!0},e.prototype.CoreCopyIncrement=function(e,t){var n=t;if(n.UseChildReturnValue&&(n.InsertAfter=n.ChildOperationReturnValue,n.UseChildReturnValue=!1),!n.Source.goToNextSiblingOrReturnToParent()){n.ParentArgs&&(n.ParentArgs.ChildOperationReturnValue=n.InsertAfter);var i=n.Source;return 11!==i.get_currentNodeType()||i.getNextSiblingByRole(-1)||this.ProcessOnCopyComplete(e,null,i.get_currentNode(),n.Target.get_currentNode(),n),!1}return e.changeStepCallback(o.i(this,this.CoreCopyIteration,"CoreCopyIteration")),!0},e.prototype.ProcessCopiedBlobs=function(e,t,n){for(var i=Cd.f.getBlobObjects(t),r=Cd.f.getBlobObjects(n),a=0;a<i.length;a++)i[a].onBlobCopy(r[a],e,o.i(this,this.CoreCopySetup,"CoreCopySetup"))},e.prototype.TrimNewText=function(t,n){var i=n;if(i.ContextIndex>=i.SelectedContexts.length)return t.changeStepCallback(o.i(this,this.CopyTeardown,"CopyTeardown")),!0;var r=i.SelectedContexts[i.ContextIndex],a=r.get_node(),l=r.get_cpBegin(),s=r.get_cpEnd();if(!ga.SelectionEditor.isInsertionPointOrTextRangeContext(r))if(!i.ContextIndex&&ga.SelectionEditor.isEndOfParagraphContext(r))s=l=Ga.ParagraphReader.textLength(a);else if(Ga.ParagraphReader.isParagraphContext(r))l=0,s=Ga.ParagraphReader.textLength(a);else{if(!ga.SelectionEditor.isAnchoredObjectContext(r)){if(ys.OutlineReader.isOutlineContext(r))for(var u=nm.p.createTraverser(r.get_node());u.moveNext();){var c=u.get_currentNode();Ga.ParagraphReader.isParagraphNode(c)&&Array.add(i.SelectedContexts,Wa.y.createTextRange(c,0,Ga.ParagraphReader.textLength(c)))}return i.ContextIndex++,!0}S.ULS.shipAssertTag(6305568,307,!i.ContextIndex);var d=ha.g.createFromNode(a),g=d.tryToRootAtAncestorOfType(12);S.ULS.shipAssertTag(6305569,307,g),a=d.get_origin(),s=l=Ga.ParagraphReader.textLength(a)}var p=i.ParagraphLinks[a.get_id().toString()];if(S.ULS.shipAssertTag(6305570,307,!!p),!p)return S.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{ContextIndex:i.ContextIndex,SelectedContextsLength:i.SelectedContexts.length,SelectedNodeType:a.get_type(),ContextId:r.get_contextId()}),i.ContextIndex++,!0;var h,_=Cd.f.getBlobObjects(p),m=!1;for(h=_.length-1;h>=0;h--)if(!_[h].get_canBeCopied())if(4!==_[h].get_blobType()){if(_[h].get_containingProperties().set_blob(null),Gl.n.get_instance().get_item(57)&&-1!==_[h].get_runIndex()){var f=_[h].get_containingProperties().get_formatting(),y=0,C=0;f&&-1===f.runIndex?(C=_[h].get_runIndex()+1,y=_[h].get_noOfRunsEmbedded()-1,f.runIndex=_[h].get_runIndex()):(y=_[h].get_noOfRunsEmbedded(),C=_[h].get_runIndex());for(var b=0;b<y;b++)p.get_wordRunProperties().removeAt(C,16);y>0&&(m=!0)}var v="";if(Bm.r.isInkSpaceBlob(_[h]))v=" ",i.get_usageHelper().internalCopyUsageData.f++;else if(Bm.r.isTextInkBlob(_[h])){var T=Bm.r.getTextInkObject(_[h]);T&&(v=Bm.r.getFirstTextOption(T),i.get_usageHelper().internalCopyUsageData.g++)}var A=_[h].get_containingProperties().get_cp();A>=l&&A<s&&(e.get_CharacterPropertiesEditor().replaceTextRange(Wa.y.createTextRange(p,A,A+1),v),s=s-1+v.length,i.get_usageHelper().internalCopyUsageData.i++)}else _[h].get_containingProperties().set_blob(null),_[h].get_containingProperties().set_blob(new Lm.y(_[h].get_containingProperties(),Lm.y.defaultLineBreakText)),i.get_usageHelper().internalCopyUsageData.e++;m&&p.updateRunIndices(),this.RemoveParagraphRanges(p);var I=Ga.ParagraphReader.textLength(p);s<I&&e.get_CharacterPropertiesEditor().replaceTextRange(Wa.y.createTextRange(p,s,I),""),l>0&&e.get_CharacterPropertiesEditor().replaceTextRange(Wa.y.createTextRange(p,0,l),"");var w=0,x=ha.g.createFromNode(p);for(x.goToFirstChildByRole(6);!x.get_isAtOrigin();){var E=x.get_currentNode();if(x.goToNextSiblingByRoleOrReturnToParent(6),pa.ImageReader.isImageNode(E))if(pa.ImageReader.isReproduceable(E))e.get_ParagraphEditor().convertAnchoredImageToInline(E,Wa.y.createIpContext(p,w)),w++,i.get_usageHelper().internalCopyUsageData.d++;else{var F=ha.g.createFromNode(E);F.tryToRootAtAncestorOfType(12),F.disconnectNodeAndReturnToParent(),i.get_usageHelper().internalCopyUsageData.h++}else S.ULS.shipAssertTag(6305571,307,!1)}if(!Ga.ParagraphReader.textLength(p)&&i.ContextIndex===i.SelectedContexts.length-1&&ga.SelectionEditor.isInsertionPointOrTextRangeContext(r)){var P=ha.g.createFromNode(p);P.tryToRootAtAncestorOfType(25)&&(_s.OutlineElementNavigator.returnToOutlineElement(P),this._outlineElementEditor.disconnectOutlineElement(P),i.ContextIndex&&(this._selectionCollection.get_currentSelection().endsWithEop=!0))}return this.get_UsageEditor().recordParagraphMetrics(i.get_usageHelper().paragraphUsageData,i.get_usageHelper().chpUsageData,i.get_usageHelper().blobUsageData,p),i.ContextIndex++,!0},e.prototype.RemoveParagraphRanges=function(t){var n=Gl.n.get_instance().get_item(14),i=!this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&Gl.n.get_instance().get_item(45),r=e.get_IsImprovedFieldProcessingEnabled(),o=t.get_characterProperties();if(Gl.n.get_instance().get_item(57)&&o&&(n||i)){for(var a=new C.c(Nm.j),l=new C.c(Number),s=0;s<o.get_length();s++){var u=o.get_item(s);if(n){if(u.get_dynamicRangeObjects()&&a.add(u),r){if(u.get_fieldMarkerObjects()){for(var c=0;c<u.get_fieldMarkerObjects().get_length();c++)l.add(u.get_fieldMarkerObjects().get_item(c).get_runIndex());u.set_fieldMarkerObjects(null)}}else u.get_fieldRangeEnd()&&(l.add(u.get_fieldRangeEnd().get_runIndex()),u.set_fieldRangeEnd(null)),u.get_fieldRangeStart()&&(l.add(u.get_fieldRangeStart().get_runIndex()),u.set_fieldRangeStart(null));if(u.get_contentControlRangeObjects()){for(c=0;c<u.get_contentControlRangeObjects().get_length();c++)l.add(u.get_contentControlRangeObjects().get_item(c).get_runIndex());u.set_contentControlRangeObjects(null)}}if(i){if(yi.App.get_box4Bridge().get_trackedChangesEnabled()){if(u.get_formatting()&&e.get_FormattingEditor().removeLinkFormatting(u.get_formatting()),u.get_hyperlink()){for(c=0;c<u.get_hyperlink().get_noOfRunsEmbedded();c++)l.add(u.get_hyperlink().runIndex+c);u.set_hyperlink(null)}u.set_isHyperlinkEnd(!1)}u.set_trackedChange(null),u.set_isTrackedChangeEnd(!1)}}t.removeAndUpdateWordRunProperties(!0,l);for(var d=a.$$lge();d.$$mn();){(u=d.$$cu()).set_dynamicRangeObjects(null)}if(i&&o.get_length()>1){var g=o.get_first();g.set_trackedChange(new Pm.b(g)),o.get_last().set_isTrackedChangeEnd(!0)}}},e.prototype.CopyTeardown=function(e,t){var n=t;return this._clipboardRoot.validateProperties(null),t.GraphTransaction.dispose(),Dr.t.mark(5567),this.NormalizeCopiedTable(),this.dumpInternalClipboard(),this._usageHelper=n.get_usageHelper(),this.LogClipboardMetricsForPaste("Copy"),this.get_IsClipboardRootEmpty()&&S.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot"),!1},e.prototype.get_IsClipboardRootEmpty=function(){return!ha.g.createFromNode(this._clipboardRoot).goToFirstChild()},e.prototype.useVirtualClipboardRoot=function(){this._clipboardRoot=this._virtualClipboardRoot},e.prototype.useUserClipboardRoot=function(){this._clipboardRoot=this._userClipboardRoot},e.prototype.useDragDropClipboardRoot=function(){this._clipboardRoot=this._dragdropClipboardRoot},e.prototype.get_isUserClipboard=function(){return this._clipboardRoot===this._userClipboardRoot},e.prototype.get_isDragDropClipboard=function(){return this._clipboardRoot===this._dragdropClipboardRoot},e.prototype.get_isVirtualClipboard=function(){return this._clipboardRoot===this._virtualClipboardRoot},e.prototype.clearInternalData=function(){for(var e=ha.g.createFromNode(this._clipboardRoot);e.goToFirstChild();)e.disconnectNodeAndReturnToParent()},e.prototype.LogClipboardMetricsForPaste=function(e){var t=this._usageHelper.internalCopyUsageData.b;e+="-"+t,this._usageHelper.internalCopyUsageData.b=e,this._usageHelper.graphObjectUsageData.b=e,this._usageHelper.paragraphUsageData.b=e,this._usageHelper.chpUsageData.b=e,this._usageHelper.blobUsageData.b=e,this.get_UsageEditor().logInternalCopyUsageData(this._usageHelper.internalCopyUsageData),this.get_UsageEditor().logGraphObjectUsageData(this._usageHelper.graphObjectUsageData),this.get_UsageEditor().logParagraphUsageData(this._usageHelper.paragraphUsageData),this.get_UsageEditor().logChpUsageData(this._usageHelper.chpUsageData),this.get_UsageEditor().logBlobUsageData(this._usageHelper.blobUsageData),this._usageHelper.internalCopyUsageData.b=t,this._usageHelper.graphObjectUsageData.b=t,this._usageHelper.paragraphUsageData.b=t,this._usageHelper.chpUsageData.b=t,this._usageHelper.blobUsageData.b=t},e.prototype.pasteFromInternalClipboard=function(t,n,i,r,a,l){void 0===a&&(a=null),void 0===l&&(l=null),this.LogClipboardMetricsForPaste("Paste");var s=ha.g.createFromNode(n),u=ha.g.createFromNode(this._clipboardRoot),c=null;if(a){var d=new zs.i(ys.OutlineReader.defaultHorizontalOffset,ys.OutlineReader.defaultVerticalOffset);c=a.equals(new zs.i(-1,-1))?new zs.i(0,0):a.subtract(d)}if(this.internalClipboardContainsSingleOutlineLevelElement())if(u.goToFirstChild(),pa.ImageReader.isImageNode(u.get_currentNode())){var g=u.get_currentNode();u.returnToParent(),u.insertChild(this._outlineElementEditor.createOutlineElementNode(),null,1),u.goToFirstChild(),u.insertChild(g,null,2),u.returnToParent(),u.goToChild(g),u.disconnectNodeAndReturnToParent(),this._imageEditor.onFloatingImageChangeToNormal(g),this.set_containsOutlineLevelContent(!1)}else if(N_.EmbeddedFileReader.isFloatingEmbeddedFileNode(u.get_currentNode())){var p=u.get_currentNode();u.returnToParent(),u.insertChild(this._outlineElementEditor.createOutlineElementNode(),null,1),u.goToFirstChild();var h=this._outlineElementEditor.createParagraph(u),_=Wa.y.createIpContext(h,0);e.get_CharacterPropertiesEditor().replaceTextRange(_,"<<"+N_.EmbeddedFileReader.getEmbeddedFileName(p)+">>"),u.returnToParent(),u.returnToParent(),u.goToChild(p),u.disconnectNodeAndReturnToParent(),this.set_containsOutlineLevelContent(!1)}if((!this._contentControlCopyPasteHelper||!this._contentControlCopyPasteHelper.isPastedInInlineContentControl(i))&&this.get_isPasteTableWithReplacingCellEnabled()&&this.IsToPasteATableInTableCell(u,s))return u.get_currentNode().validateProperties(null),S.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.ReplaceTableCellsFromClipboardTable(l,u,s,c,t),void S.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended.");Dr.t.mark(5564),u.get_currentNode().validateProperties(null);var m={};m[e.ImagePasteConstrainingWidth]=r,gs.ListReader.isListOutlineElementNode(i)&&this.get_ListReader().get_qoEListInternalCCPImprovementIsEnabled()&&(m[Dm.c.internalListPasteIntoListSkipRenumberSourceList]=!0);var f=new G_(u,s,i,c,m),y=new vp.a(l,o.i(this,this.CorePasteSetup,"CorePasteSetup"),f);y.setDebugName("ExecuteCorePasteFromInternalClipboard"),y.set_isSynchronous(!l||l.get_isSynchronous()),this.ProcessBeforePaste(f),y.run()},e.prototype.IsTableCellPaste=function(e){if(e&&e.get_isValid()){var t=ha.g.createFromNode(this._clipboardRoot);return this.IsToPasteATableInTableCell(t,e)}return!1},e.prototype.IsToPasteATableInTableCell=function(e,t){if(js.TableCellReader.isTableCellOrInside(t)&&1===e.getChildCount()){if(e.goToFirstChildByRole(1),Ss.OutlineElementReader.isOutlineElement(e)){if(_s.OutlineElementNavigator.moveToContent(e),us.TableReader.isTable(e)){if(us.TableReader.isComplexTableNode(e.get_currentNode())&&S.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table."),t.tryToRootAtAncestorOfType(14)&&!us.TableReader.isComplexTableNode(Pd.TableNavigator.getContainingTable(t)))return S.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."),!0;if(S.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),this.get_IsComplexTableCellPasteWithFormattingEnabled())return!0}_s.OutlineElementNavigator.returnToOutlineElement(e)}e.returnToParent()}return!1},e.prototype.ReplaceTableCellsFromClipboardTable=function(e,t,n,i,r,a){void 0===a&&(a=null),n.tryToRootAtAncestorOfType(14);var l=Dd.v.getRowIndex(n),s=Fd.s.getColumnIndex(n);n.returnToAncestorOfType(14);var u=us.TableReader.getRowCount(n.get_currentNode()),c=us.TableReader.getColumnCount(n.get_currentNode()),d=us.TableReader.getRowCount(t.get_currentNode()),g=us.TableReader.getColumnCount(t.get_currentNode());if(S.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};",u,c,d,g),this._getNewOutlineElementInfoDelegate=a?function(){return null}:Em.get_getNewOutlineElementInfoDelegate(),this.IsTableDimensionValid(l+d,s+g)){var p=l+d-u;p>0&&(Pd.TableNavigator.moveToLastRow(n),S.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+p),this._tableEditor.insertRows(n,!1,p,this._getNewOutlineElementInfoDelegate),S.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),n.returnToAncestorOfType(14));var h=s+g-c;if(h>0){S.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+h);try{this._tableEditor.insertColumns(n,c,!1,h,this._getNewOutlineElementInfoDelegate)}catch(e){throw S.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",e.toString()),e}S.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}var _=this.GetChangedCellIndices(u,c,d,g,l,s);S.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");var m=new vp.a(this.get_IsComplexTableCellPasteWithFormattingEnabled()?e:null,o.i(this,this.PasteTableOperationRun,"PasteTableOperationRun"),new W_(null,t,n,i,l,s,_,a,r));m.setDebugName("ExecuteCorePasteTableInTable"),m.set_isSynchronous(!1),m.run()}},e.prototype.IsTableDimensionValid=function(t,n){if(!this.get_IsNormalTableCellPasteWithFormattingEnabled())return!0;var i={};t>e.c_maxTableRowColCount&&(i.rowCount=t,i.c_maxTableRowColCount=e.c_maxTableRowColCount),n>e.c_maxTableRowColCount&&(i.columnCount=n,i.c_maxTableRowColCount=e.c_maxTableRowColCount);var r=t*n;return r>e.c_maxTableCellCount&&(i.rowCount=t,i.columnCount=n,i.cellsCount=r,i.c_maxTableCellCount=e.c_maxTableCellCount),M_.p.getKeys(i).length>0&&S.ULS.sendTraceTag(39716808,307,10,"IsTableDimensionValid: {0}",i),!M_.p.getKeys(i).length},e.prototype.PasteTableOperationRun=function(e,t){var n=t;if(n.TableCellPasteOperation){if(n.TableCellPasteOperation.get_inProgress())return!0;if(js.TableCellReader.isTableCell(n.Source)||n.Source.returnToAncestorOfType(16),this.get_IsNormalTableCellPasteWithFormattingEnabled()&&js.TableCellReader.isFirstCellInTable(n.Source)&&this.AdjustSelectionAfterPaste(n.InteractiveView,n.Target.get_currentNode()),js.TableCellReader.isLastCellInTable(n.Source))return this._contentControlCopyPasteHelper&&this._contentControlCopyPasteHelper.processPastedContentsAfterReplaceTableCellsFromClipboardTable(n.Target,n.ChangedCellIndices),this.NormalizePastedTable(Pd.TableNavigator.getContainingTable(n.Target)),S.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"),!1;js.TableCellReader.isTableCell(n.Target)||n.Target.returnToAncestorOfType(16);var i=!this.get_IsComplexTableCellPasteWithFormattingEnabled();js.TableCellReader.isLastCellInRow(n.Source)?(Pd.TableNavigator.moveToNextRow(n.Target),Pd.TableNavigator.moveToColumnByIndex(n.Target,n.ColumnIndex),S.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")):Pd.TableNavigator.moveToNextOrPreviousCell(n.Target,!1,i),Pd.TableNavigator.moveToNextOrPreviousCell(n.Source,!1,i)}else us.TableReader.isTable(n.Target)||n.Target.returnToAncestorOfType(14),us.TableReader.isTable(n.Source)||n.Source.returnToAncestorOfType(14),Pd.TableNavigator.moveToCell(n.Target,n.RowIndex,n.ColumnIndex),Pd.TableNavigator.moveToCell(n.Source,0,0);for(;n.Target.goToFirstChild();)n.Target.disconnectNodeAndReturnToParent();return n.TableCellPasteOperation=new vp.a(e,n.PasteOperationStep?n.PasteOperationStep:o.i(this,this.CorePasteSetup,"CorePasteSetup"),new G_(n.Source,n.Target,null,n.OutlineOffset)),n.TableCellPasteOperation.setDebugName("ExecuteCorePasteCellContentInCell"),n.TableCellPasteOperation.set_isSynchronous(!1),n.TableCellPasteOperation.run(),!0},e.prototype.NormalizeCopiedTable=function(){if(this.get_IsComplexTableCellPasteWithFormattingEnabled()){for(var e=ha.g.createFromNode(this.get_theClipboardRoot()),t=e.get_currentNode();14!==e.get_currentNodeType();)if(!(t=e.goToFirstChild()))return void S.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");this.NormalizeTable(t)}},e.prototype.NormalizePastedTable=function(e){this.get_IsComplexTableCellPasteWithFormattingEnabled()&&this.NormalizeTable(e)},e.prototype.ToControlCell=function(e){var t=ha.g.createFromNode(e);this._outlineEditor.insertOutlineElementAsChild(t,null,!0),e.set_isGhostCell(!1),e.set_rowSpan(1),e.set_colSpan(1)},e.prototype.NormalizeTable=function(t){var n=this;if(t&&14===t.get_type()){S.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var i={},r=us.TableReader.getRowCount(t),o=us.TableReader.getColumnCount(t),a=ha.g.createFromNode(t);Pd.TableNavigator.forEachCellInTable(a,(function(a,l,s){var u={},c=l,d=s,g=a.get_currentNode();if(16===g.get_type())if(g.get_isGhostCell()){e.ComposeKeyOfGhostCell(l,s)in i||(n.ToControlCell(g),u.IsGhostCell="->false")}else{Gl.n.get_instance().get_item(77),e.RefreshCellRowSpan(t,g,c,d,r,(function(e,t,n){u.rowSpan=String.format("{0}:{1}->{2}",e,t,n)})),e.RefreshCellColSpan(t,g,d,c,o,(function(e,t,n){u.colSpan=String.format("{0}:{1}->{2}",e,t,n)}));for(var p=String.format("{0},{1}-{2},{3}",c,d,c+g.get_rowSpan(),d+g.get_colSpan()),h=0;h<g.get_rowSpan();h++)for(var _=0;_<g.get_colSpan();_++)(h||_)&&(i[e.ComposeKeyOfGhostCell(c+h,d+_)]=p)}return M_.p.getKeys(u).length>0&&(void 0!==u.IsGhostCell&&null!==u.IsGhostCell||(void 0!==u.rowSpan&&null!==u.rowSpan||(u.rowSpan=g.get_rowSpan()),void 0!==u.colSpan&&null!==u.colSpan||(u.colSpan=g.get_colSpan())),S.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",l,s,u)),!0})),e.DumpGhostCells(i)}},e.prototype.get_IsNormalTableCellPasteWithFormattingEnabled=function(){return Gl.n.get_instance().get_item(77)},e.prototype.get_IsComplexTableCellPasteWithFormattingEnabled=function(){return!!this._appSettingsManager&&this._appSettingsManager.getBooleanAppSetting("ComplexTableCellPasteWithFormattingIsEnabled")},e.prototype.AdjustSelectionAfterPaste=function(e,t){if(e){var n=ha.g.createFromNode(t);if(n.goToLastChildByRole(1)){var i=n.goToFirstChildByRole(2);if(i){var r=Ua.SelectionFactory.createIpSelection(i,0);e.get_selectionManager().setSelection(r)}else S.ULS.sendTraceTag(38843739,307,50,"AdjustSelectionAfterPaste: no child paragraph node was found.")}else S.ULS.sendTraceTag(38843740,307,50,"AdjustSelectionAfterPaste: no child OE node was found.")}else S.ULS.sendTraceTag(38843738,307,50,"AdjustSelectionAfterPaste: interactiveView is null, abort.")},e.prototype.GetChangedCellIndices=function(e,t,n,i,r,o){for(var a=new Array(0),l=0;l<Math.max(r+n,e);l++){var s=0,u=o+i;for(l<r?s=t:l>=r&&l<Math.min(r+n,e)?s=o:l>=r+n&&l<e?s=t:u=Math.max(o+i,t);s<u;s++)Array.add(a,new Array(2)),a[a.length-1][0]=l,a[a.length-1][1]=s}return a},e.prototype.CorePasteSetup=function(e,t){return t.Source.goToFirstChild()?(e.changeStepCallback(o.i(this,this.CorePasteIteration,"CorePasteIteration")),!0):(e.changeStepCallback(o.i(this,this.PasteTeardown,"PasteTeardown")),!0)},e.prototype.ReplicateTableCellProperties=function(e,t){if(!this.get_IsComplexTableCellPasteWithFormattingEnabled())return 0;if(!t||!e)return S.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{source:e,table:t}),0;if(16!==t.get_currentNode().get_type()||16!==e.get_parentNode().get_type())return 0;var n=t.get_currentNode(),i=e.get_parentNode(),r={};return n.get_isGhostCell()!==i.get_isGhostCell()&&(n.set_isGhostCell(i.get_isGhostCell()),r.IsGhostCell=n.get_isGhostCell()),n.get_isSkippedCell()!==i.get_isSkippedCell()&&(n.set_isSkippedCell(i.get_isSkippedCell()),r.IsSkippedCell=n.get_isSkippedCell()),n.get_shouldRenderCell()!==i.get_shouldRenderCell()&&(n.set_shouldRenderCell(i.get_shouldRenderCell()),r.ShouldRenderCell=n.get_shouldRenderCell()),n.get_colSpan()!==i.get_colSpan()&&(r.ColSpan=String.format("{0}<={1}.",n.get_colSpan(),i.get_colSpan()),n.set_colSpan(i.get_colSpan())),n.get_rowSpan()!==i.get_rowSpan()&&(r.RowSpan=String.format("{0}<={1}.",n.get_rowSpan(),i.get_rowSpan()),n.set_rowSpan(i.get_rowSpan())),M_.p.getKeys(r).length},e.prototype.CorePasteIteration=function(e,t){var n=t,i=n.Source,r=n.Target,a=i.get_currentNode();if(!a.get_isPersistable())return e.changeStepCallback(o.i(this,this.CorePasteIncrement,"CorePasteIncrement")),!0;if(!a.get_canBePasted())return e.changeStepCallback(o.i(this,this.CorePasteIncrement,"CorePasteIncrement")),!0;if(this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&Ss.OutlineElementReader.isOutlineElement(i)){if(!_s.OutlineElementNavigator.moveToContent(i).get_canBePasted())return _s.OutlineElementNavigator.returnToOutlineElement(i),e.changeStepCallback(o.i(this,this.CorePasteIncrement,"CorePasteIncrement")),!0;_s.OutlineElementNavigator.returnToOutlineElement(i)}S.ULS.shipAssertTag(6305608,307,!a.excludeFromInternalClipboard());var l=r.get_currentNode().getParentGraphSpace().get_contentObjectSpace(),s=ws.z.copyNode(a,l,!0);s.onBeforePaste(),this.ReplicateTableCellProperties(i,r),r.insertChild(s,n.InsertAfter,i.get_role()),r.goToChild(s),n.InsertAfter=s,Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()&&yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(s),this.EnsureTableCellHasWidth(a,s);var u=new vp.a(e,o.i(this,this.CorePasteSetup,"CorePasteSetup"),new G_(i,r,null,n.OutlineOffset,n.featureArgs));return u.setDebugName("RecursiveCorePasteOperation"),u.run(),e.changeStepCallback(o.i(this,this.CorePasteIterationPostProcessing,"CorePasteIterationPostProcessing")),!0},e.prototype.ProcessPastedBlobs=function(t,n,i){for(var r=Cd.f.getBlobObjects(n),a=Cd.f.getBlobObjects(i),l=r.length-1;l>=0;l--){if(!r[l].shouldRetainBlobAfterPaste(i)){var s=Wa.y.createTextRange(i,r[l].get_containingProperties().get_cp(),r[l].get_containingProperties().get_cp()+1);e.get_CharacterPropertiesEditor().replaceTextRange(s,"")}r[l].onBlobPaste(a[l],t,o.i(this,this.CorePasteSetup,"CorePasteSetup"))}},e.prototype.fileDataObjectCopyPostProcessing=function(e,t){if(e){S.ULS.shipAssertTag(6305610,307,e.hasProperty(k_.w.originalObjectDataBlobId)),e.hasProperty(k_.w.originalObjectDataBlobId)||e.setValue(k_.w.originalObjectDataBlobId,e.getValueWithDefault(String,k_.w.objectDataBlobId,""));var n=Rm.SectionNavigator.getSection(t),i=n?n.get_fileId():yi.App.get_activeAppFrame().workspace.get_activeSection()?yi.App.get_activeAppFrame().workspace.get_activeSection().get_fileId():null;!e.hasProperty(k_.w.fileId)&&i&&e.setValue(k_.w.fileId,i)}},e.prototype.fileDataObjectPastePostProcessing=function(e){e&&this._imageEditor.setNewFileDataObjectId(e)},e.prototype.CorePasteIterationPostProcessing=function(t,n){var i=n,r=i.Target,a=r.get_currentNode(),l=i.Source.get_currentNode(),s=-1;if(i.featureArgs[e.ImagePasteConstrainingWidth]&&(s=i.featureArgs[e.ImagePasteConstrainingWidth]),Ga.ParagraphReader.isParagraphNode(a)&&(this.ProcessPastedParagraphs(t,o.i(this,this.CorePasteSetup,"CorePasteSetup"),l,a,i),this.ProcessPastedBlobs(t,l,a)),a.onAfterPaste(),i.featureArgs[Dm.c.internalListPasteIntoListSkipRenumberSourceList]?22===a.get_type()&&a.setValue(os.j.listID,Number.MAX_VALUE):this._listEditor.renumberForOEPasteIfNecessary(a),Gl.n.get_instance().get_item(11)&&Ga.ParagraphReader.isParagraphNode(a)){var u=Cd.f.getBlobObjectsOfType(a,5);if(u.length>0){for(var c=0,d=u;c<d.length;c++){var g=d[c];if(!g.properties.hasProperty(os.j.pictureUpdatedGraphicProperties)&&g.properties.hasProperty(os.j.pictureGraphicProperties)){var p=g.properties.getValue(String,os.j.pictureGraphicProperties);g.properties.setValue(os.j.pictureUpdatedGraphicProperties,p)}pa.ImageReader.isRenderedImage(g.properties)||this._imageEditor.scaleImageWidthAndHeight(g.properties,s)}(m=a.getParentGraphSpace()).get_contentReplicator().forceOutbound(null,null,null)}}if(Gl.n.get_instance().get_item(25)&&Ss.OutlineElementReader.isOutlineElement(r)&&this._outlineElementEditor.updateAuthorAndTimeStamp(r.get_currentNode()),Gl.n.get_instance().get_item(10)&&ys.OutlineReader.isOutlineLevelNode(a)){var h=qs.v.getMuPosition(a),_=i.OutlineOffset;qs.v.setMuPosition(a,h.get_x()+_.get_x(),h.get_y()+_.get_y())}if(this.OneNoteShouldPostProcessFdo(r)){var m=r.get_currentNode().getGraphSpace(),f=pa.ImageReader.getPictureContainerAsFileDataObject(r.get_currentNode().get_properties(),m.get_contentObjectSpace(),!1),y=pa.ImageReader.getPictureContainerAsFileDataObject(r.get_currentNode().get_properties(),m.get_contentObjectSpace(),!0),C=null;N_.EmbeddedFileReader.isEmbeddedFile(r)&&(C=N_.EmbeddedFileReader.getEmbeddedFileContainer(r.get_currentNode())),this.fileDataObjectPastePostProcessing(f),this.fileDataObjectPastePostProcessing(y),this.fileDataObjectPastePostProcessing(C),(f||y||C)&&(m.isOneNoteEnsureFreshNeeded=!0,m.isOneNotePageVersionCreatePending=!0)}if(Gl.n.get_instance().get_item(24)&&N_.EmbeddedFileReader.isEmbeddedFile(r)){var S=r.get_currentNode();if(N_.EmbeddedFileReader.isFloatingEmbeddedFile(r)){r.returnToParent();var b=this._outlineEditor.createOutlineNode();b.setValue(is.b.layoutAlignmentSelf,e.get_PageReader().isRtl(S)?11:9);h=qs.v.getMuPosition(a);qs.v.setMuPosition(b,h.get_x(),h.get_y()),r.insertChild(b,S,1),r.goToChild(S),r.disconnectNodeAndGoToNextSiblingOrReturnToParent(),this._outlineEditor.appendOutlineElement(r,!1)}else r.disconnectNodeAndReturnToParent();var v=this._outlineElementEditor.createParagraph(r),T=Wa.y.createIpContext(v,0);e.get_CharacterPropertiesEditor().replaceTextRange(T,"<<"+N_.EmbeddedFileReader.getEmbeddedFileName(S)+">>")}return this.EnsureTableCellHasOutlineElement(r),this.UpdateTableRowCount(l,a),r.returnToParent(),t.changeStepCallback(o.i(this,this.CorePasteIncrement,"CorePasteIncrement")),!0},e.prototype.OneNoteShouldPostProcessFdo=function(e){return Gl.n.get_instance().get_item(1)&&pa.ImageReader.isImage(e)||Gl.n.get_instance().get_item(24)&&N_.EmbeddedFileReader.isEmbeddedFile(e)},e.prototype.UpdateTableRowCount=function(e,t){if(this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&us.TableReader.isTableNode(e)){for(var n=0,i=us.TableReader.getRowCount(e),r=us.TableReader.getRowsInTable(e,0,i-1).$$lge();r.$$mn();){r.$$cu().get_trackedChangeDeletion()&&n++}var o=this._graphTransactionFactory.getTransaction(4);o.setFromNode(t),t.get_properties().setValue(is.b.tableRowCount,i-n),o.dispose()}},e.prototype.CorePasteIncrement=function(e,t){return t.Source.goToNextSiblingOrReturnToParent()?(e.changeStepCallback(o.i(this,this.CorePasteIteration,"CorePasteIteration")),!0):(e.changeStepCallback(o.i(this,this.PasteTeardown,"PasteTeardown")),!0)},e.prototype.PasteTeardown=function(e,t){return Dr.t.mark(5565),!1},e.prototype.nothingToPaste=function(){return!ha.g.createFromNode(this._clipboardRoot).goToFirstChild()},e.prototype.internalClipboardContainsSingleOutlineLevelElement=function(){return!!this.get_containsOutlineLevelContent()&&1===ha.g.createFromNode(this._clipboardRoot).getChildCount()},e.prototype.internalClipboardContainsSingleParagraph=function(t){var n=ha.g.createFromNode(this._clipboardRoot);return t&&this.internalClipboardContainsSingleOutlineLevelElement()&&n.goToFirstChild(),!(1!==n.getChildCount()||(n.goToFirstChild(),!Ss.OutlineElementReader.isOutlineElement(n)||1!==n.getChildCount()||!n.goToFirstChildByRole(2)))&&(Ga.ParagraphReader.isParagraph(n)&&!e.get_UnsupportedNodeEditor().containsUnsupportedObject(n))},e.prototype.getClipboardParagraphText=function(){var e=ha.g.createFromNode(this._clipboardRoot);return this.internalClipboardContainsSingleOutlineLevelElement()&&e.goToFirstChild(),e.goToFirstChild(),e.goToFirstChild(),S.ULS.shipAssertTag(6305614,307,Ga.ParagraphReader.isParagraph(e)),Ga.ParagraphReader.text(e.get_currentNode())},e.prototype.getCopySourceFromDOMTree=function(e){try{return this.GetCopySourceFromDOMTreeInternal(e)}catch(e){return S.ULS.sendTraceTag(23643968,307,10,"GetCopySourceFromDOMTree failed with exception:{0}",e.message),0}},e.prototype.GetCopySourceFromDOMTreeInternal=function(e){var t=0;if(e&&!(t=this.GetCopySourceFromDOMElement(e))&&e.childNodes)for(var n=0;n<e.childNodes.length&&!(t=this.getCopySourceFromDOMTree(e.childNodes[n]));n++);return t},e.prototype.GetCopySourceFromDOMElement=function(e){if(e.nodeType===bp.o.element&&e.getAttribute)for(var t=0,n=(e.getAttribute("class")||"").split(" ");t<n.length;t++){var i=n[t];if(i.startsWith(this._sequenceCodeCommonPrefix))return i.startsWith(this._sequenceCodePrefix)?this.get_SequenceCode()&&i===this._sequenceCodePrefix+this.get_SequenceCode()?3:2:1}return 0},e.prototype.dumpInternalClipboard=function(){return new Array(0)},e.prototype.ProcessCopiedParagraphs=function(t,n,i,r,o){o.get_featureArgs()||o.set_featureArgs({}),e._eventSource.raiseEvent("OnParagraphCopy",new V_(t,n,i,r,o.get_featureArgs()))},e.prototype.ProcessOnCopyComplete=function(t,n,i,r,o){o.get_featureArgs()||o.set_featureArgs({}),e._eventSource.raiseEvent("OnCopyComplete",new V_(t,n,i,r,o.get_featureArgs()))},e.prototype.ProcessBeforePaste=function(t){t.featureArgs||(t.featureArgs={}),e._eventSource.raiseEvent("BeforePaste",new U_(t.featureArgs))},e.prototype.ProcessPastedParagraphs=function(t,n,i,r,o){e._eventSource.raiseEvent("OnParagraphPaste",new V_(t,n,i,r,o.featureArgs))},e.prototype.EnsureTableCellHasOutlineElement=function(e){js.TableCellReader.isTableCell(e)&&(e.goToFirstChildByRole(1)||this._outlineEditor.appendOutlineElement(e,!0),e.returnToParent())},e.prototype.EnsureTableCellHasWidth=function(e,t){this._tableCellReader.isTableCellNode(t)&&t.set_width(e.get_width())},e.add_onParagraphCopy=function(t){e._eventSource.addHandler("OnParagraphCopy",t)},e.remove_onParagraphCopy=function(t){e._eventSource.removeHandler("OnParagraphCopy",t)},e.add_onParagraphPaste=function(t){e._eventSource.addHandler("OnParagraphPaste",t)},e.remove_onParagraphPaste=function(t){e._eventSource.removeHandler("OnParagraphPaste",t)},e.add_onCopyComplete=function(t){e._eventSource.addHandler("OnCopyComplete",t)},e.remove_onCopyComplete=function(t){e._eventSource.removeHandler("OnCopyComplete",t)},e.add_beforePaste=function(t){e._eventSource.addHandler("BeforePaste",t)},e.remove_beforePaste=function(t){e._eventSource.removeHandler("BeforePaste",t)},e.get_FormattingEditor=function(){return e._formattingEditor||(e._formattingEditor=Ge.w.get_instance().resolve(Vs.z))},e.get_CharacterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=Ge.w.get_instance().resolve(ba.x))},e.get_ParagraphEditor=function(){return e._paragraphEditor||(e._paragraphEditor=Ge.w.get_instance().resolve(ns.g))},e.get_IsImprovedFieldProcessingEnabled=function(){var e=Ge.w.get_instance().tryResolve(Yh.d);return!!e&&e.isFeatureEnabled(72)},e.get_UnsupportedNodeEditor=function(){return tm.q.get_instance()},e.get_PageReader=function(){return $s.PageReader.get_instance()},e.DumpGhostCells=function(e){for(var t={},n=0,i=M_.p.getKeys(e);n<i.length;n++){var r=i[n],o=e[r];t[o]=o in t?String.format("{0}|{1}",t[o],r):r}M_.p.getKeys(t).length>=1&&S.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",t)},e.RefreshCellColSpan=function(t,n,i,r,o,a){n.get_colSpan()>o-i&&(a&&a("A",n.get_colSpan(),o-i),n.set_colSpan(o-i));var l=e.ShrinkOrExtendColSpan(t,n,r,i);n.get_colSpan()!==l&&(a&&a("B",n.get_colSpan(),l),n.set_colSpan(l))},e.RefreshCellRowSpan=function(t,n,i,r,o,a){n.get_rowSpan()>o-i&&(a&&a("A",n.get_rowSpan(),o-i),n.set_rowSpan(o-i));var l=e.ShrinkOrExtendRowSpan(t,n,i,r);n.get_rowSpan()!==l&&(a&&a("B",n.get_rowSpan(),l),n.set_rowSpan(l))},e.ShrinkOrExtendColSpan=function(t,n,i,r){var o=n.get_colSpan();return e.ShrinkOrExtendSpan(t,o,(function(e,t){Pd.TableNavigator.moveToCell(e,i,r+t);e.get_currentNode()}))},e.ShrinkOrExtendRowSpan=function(t,n,i,r){var o=n.get_rowSpan();return e.ShrinkOrExtendSpan(t,o,(function(e,t){Pd.TableNavigator.moveToCell(e,i+t,r);e.get_currentNode()}))},e.ShrinkOrExtendSpan=function(e,t,n){if(14!==e.get_type())throw Error.argument("tableNode is not a Table.");if(!n)throw Error.argumentNull("MoveToCellAction");for(var i=1;i<t;i++){var r=ha.g.createFromNode(e);n(r,i);var o=r.get_currentNode();if(!o||16!==o.get_type()||!o.get_isGhostCell())return i}return t},e.ComposeKeyOfGhostCell=function(e,t){return e+","+t},e._eventSource=new at.f,e._formattingEditor=null,e._characterPropertiesEditor=null,e._paragraphEditor=null,e.c_maxTableRowColCount=50,e.c_maxTableCellCount=1225,e.ImagePasteConstrainingWidth="PasteConstrainingWidth",e}();(0,o.l)(Om,"4893dd29$InternalClipboard",null,[]);var Um=function(e){function t(t,n,i,r,o,a,l){var s=e.call(this,t,n,i,o,a)||this;return s._internalClipboard=null,s._lazyPageView=null,s._internalClipboard=r,s._lazyPageView=l,s}return(0,v.t)(t,e),t.prototype.get_ShouldGetDragDropConstrainingWidth=function(){return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AutoResizeDragDropImageIsEnabled")},t.prototype.get__pageView=function(){return this._lazyPageView.get_value()},t.prototype.get_nothingToPaste=function(){return this._internalClipboard.nothingToPaste()},t.prototype.get_pastingOutlines=function(){var e=this._internalClipboard;return e.get_containsOutlineLevelContent()&&!e.internalClipboardContainsSingleOutlineLevelElement()},t.prototype.executePasteOfOutlines=function(e,t){S.ULS.shipAssertTag(6305616,307,ys.OutlineReader.isOutline(e));var n=qs.v.getMuPosition(e.get_currentNode());if(ys.OutlineReader.isEmpty(e)){var i=Wa.y.create(e.get_currentNode());e.returnToNodeOfType(8),L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(i,Oi.u.deleteKey,2,!0,null,null)}else e.returnToNodeOfType(8);var r=e.goToLastChildByRole(1);r&&e.returnToParent(),this._internalClipboard.pasteFromInternalClipboard(this.parentArgs.InteractiveView,e.get_currentNode(),r,-1,n,t)},t.prototype.get_isContentSingleParagraph=function(){return this._internalClipboard.internalClipboardContainsSingleParagraph(!0)},t.prototype.get_contentAsText=function(){return this._internalClipboard.getClipboardParagraphText()},t.prototype.executePaste=function(e){var t=new ha.g;this.precedingNodeRef.restore(t),S.ULS.shipAssertTag(6305618,307,Ss.OutlineElementReader.isOutlineElement(t)),this.parentArgs.OperationTelemetry&&this.parentArgs.OperationTelemetry.appendOperationFlag("internal");var n=-1;if(this.get_shouldGetPasteConstrainingWidth()&&o.r(ph.d,this.parentArgs.ActionData))n=this.parentArgs.ActionData.getValueWithDefault(Number,ep.p.editContainerWidth,-1);else if(this.get_ShouldGetDragDropConstrainingWidth()){var i=this.GetDOMElementFromGraphNodeContext(t.get_currentNode());n=i?i.clientWidth:n}if(this._internalClipboard.pasteFromInternalClipboard(this.parentArgs.InteractiveView,t.get_parentNode(),t.get_currentNode(),n,null,e),this.get_isMergeFixEnabled()&&(this.precedingNodeRef.restore(t),Ss.OutlineElementReader.isOutlineElement(t)&&this._internalClipboard.IsTableCellPaste(t))){var r=_s.OutlineElementNavigator.moveToContent(t);r&&(this.parentArgs.FinalSelection=Ua.SelectionFactory.createIpSelection(r,0))}},t.prototype.GetDOMElementFromGraphNodeContext=function(e){if(!e)return null;var t=e?e.getHtmlViewElement(this.get__pageView().get_viewId()):null;return t?t.get_htmlElement():null},t.prototype.shouldSkipMergeAfterPaste=function(){var e=new ha.g;return this.precedingNodeRef.restore(e),this._internalClipboard.IsTableCellPaste(e)},t.prototype.get_shouldMergePastedListIntoList=function(){return gs.ListReader.get_isListMarkerEnabled()},t.prototype.get_shouldMergeAfterContent=function(){return!this._internalClipboard.get_endsWithEop()&&!this._internalClipboard.get_containsOutlineLevelContent()},t}(o_);(0,o.l)(Um,"7c32bb97$InternalPasteExecutionManager",o_,[]);var Hm=function(){function e(e,t,n){this._internalClipboard=null,this._contentControlCopyPasteHelper=null,this._lazyPageView=null,this._internalClipboard=e,this._contentControlCopyPasteHelper=t,this._lazyPageView=n}return e.prototype.create=function(e,t,n){return new Um(e,t,n,this._internalClipboard,this._contentControlCopyPasteHelper,yi.App.get_activeAppFrame().workspace,this._lazyPageView)},e}();(0,o.l)(Hm,"28b837e3$Factory",null,[Ag]);var Gm=function(){function e(e,t,n){this._internalClipboard=null,this._internalPasteExecutionManagerFactory=null,this._externalPasteExecutionManagerFactory=null,this._internalClipboard=e,this._internalPasteExecutionManagerFactory=t,this._externalPasteExecutionManagerFactory=n}return e.prototype.PasteAtIp=function(t,n,i){S.ULS.shipAssertTag(6305620,307,!!t),S.ULS.shipAssertTag(6305621,307,ga.SelectionEditor.isInsertionPointContext(n)),S.ULS.shipAssertTag(6305622,307,!!i),S.ULS.shipAssertTag(6305623,307,o.r(Ch,i.get_operationContext()));var r=i.get_operationContext();r.CopySource=this._internalClipboard.getCopySourceFromDOMTree(t),this.LogInlineTabUsage(t,r);var a=this.isInternalPaste(t,n,r);if(a||this.shouldContinueProcessContent(t,n,r)){var l,s=new Ma.GraphTransaction(7);s.setFromNode(n.get_node()),n.get_node().getGraphSpace().get_graphTransactionOperations().blockRttSend(8),a?(S.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",r.ActionIdFlags,r.BrowserName),l=this._internalPasteExecutionManagerFactory.create(n,r,s)):(S.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",r.ActionIdFlags,r.CopySource,r.BrowserName),e.LogIfPasteTextIsUrl(t),l=this._externalPasteExecutionManagerFactory.create(t,n,r,s));var u=new vp.a(i,o.i(l,l.PasteSetup,"PasteSetup"),null);u.setDebugName("Paste"),u.run()}else r.FinalSelection=Ua.SelectionFactory.createSelectionFromContext(n)},e.prototype.isInternalPaste=function(e,t,n){return!this.isPasteTextOnly(n)&&3===n.CopySource},e.prototype.shouldContinueProcessContent=function(e,t,n){return!0},e.prototype.isPasteTextOnly=function(e){return 1===P_.fromClipboardActionFlags(e.ActionIdFlags)},e.prototype.InternalPasteAtIp=function(e,t){S.ULS.shipAssertTag(6305624,307,ga.SelectionEditor.isInsertionPointContext(e)),S.ULS.shipAssertTag(6305625,307,!!t),S.ULS.shipAssertTag(6305626,307,o.r(Ch,t.get_operationContext()));var n=new Ma.GraphTransaction(7);n.setFromNode(e.get_node());var i=t.get_operationContext(),r=this._internalPasteExecutionManagerFactory.create(e,i,n),a=new vp.a(t,o.i(r,r.PasteSetup,"PasteSetup"),null);a.setDebugName("InternalPasteAtIp"),a.run()},e.prototype.LogInlineTabUsage=function(e,t){if(e){var n=!1,i=!1;e.innerHTML&&e.innerHTML.indexOf("mso-tab-count")>=0?i=!0:e.innerText&&e.innerText.indexOf("\t")>=0&&(n=!0),(n||i)&&(L.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),S.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",x_[t.CopySource],n,i))}},e.LogIfPasteTextIsUrl=function(t){return!!t&&(!!e._webUrlRegEx.test(t.innerText)&&(S.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl"),!0))},e.BeginWithZeroOrMoreWhiteSpaces="^[\\s]*",e.WebDomainBeginning="(((http|https):\\/\\/)|(www\\.))",e.WebDomain="[\\w\\-_]+(\\.[\\w\\-_]+)+",e.UrlRestOfString="[\\w\\-\\.,@?^=%&amp;:/~\\+#]*",e.EndWithZeroOrMoreWhiteSpaces="[\\s]*$",e._webUrlRegEx=new RegExp(e.BeginWithZeroOrMoreWhiteSpaces+e.WebDomainBeginning+e.WebDomain+e.UrlRestOfString+e.EndWithZeroOrMoreWhiteSpaces),e}();(0,o.l)(Gm,"749633eb$PasteCoordinator",null,[]);var Wm=n(9313),Vm=n(7784),$m=n(5378),zm=function(){function e(e,t,n,i,r,o,a,l,s,u,c){this._pasteFloatieManager=null,this._pasteFloatieEventSource=null,this._interactiveViewManager=null,this._pressOnlyKeyEvent=null,this._activeFrame=null,this._pasteFloatiePositionProvider=null,this._appSettingsManager=null,this._pasteFloatieFeatureSetBuilder=null,this._paragraphNodeEventHandlers=null,this._graphTransactionManager=null,this._currentInteractiveView=null,this._isLocked=!1,this._pasteCommand=null,this._isHiding=!1,this._pasteFloatieManager=e,this._pasteFloatieEventSource=t,this._interactiveViewManager=n,this._pressOnlyKeyEvent=i,this._activeFrame=r,this._pasteFloatiePositionProvider=o,this._appSettingsManager=a,this._pasteFloatieFeatureSetBuilder=l,this._paragraphNodeEventHandlers=s,this._graphTransactionManager=u,2===c&&this.StartEventListening()}return e.prototype.StartEventListening=function(){this._pasteFloatieEventSource.add_onShowPasteFloatie(o.i(this,this.ShowFloatieHandler,"ShowFloatieHandler")),this._pasteFloatieEventSource.add_onDismissPasteFloatie(o.i(this,this.FloatieDismissedHandler,"FloatieDismissedHandler"))},e.prototype.CreateFloatie=function(e,t){this._pasteFloatiePositionProvider.invalidPastedPositionCache(),1!==this._pasteFloatieFeatureSetBuilder.createFromPastedHtmlString(t.pasteHtmlString)&&this.ShowFloatie(e,t)&&(this._isHiding?this._isHiding=!1:this.RegisterViewChangeEventHandlers(),this.RegisterFloatieEventHandler(),S.ULS.sendTraceTag(40379588,307,50,"Box4 Paste floatie created."),this.UpdateFloatiePosition())},e.prototype.DismissFloatie=function(e){this._isLocked||(this._pasteFloatieManager.isFloatieVisible()||this._isHiding)&&(e&&(this._pasteFloatiePositionProvider.invalidPastedPositionCache(),this.UnregisterViewChangedEventHandlers(),S.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this._pasteCommand)),this._isHiding=!e,this.UnregisterFloatieHandler(),this._pasteFloatieManager.dismissFloatie())},e.prototype.RegisterViewChangeEventHandlers=function(){this._currentInteractiveView=this._interactiveViewManager.get_selectionView(),wo.n.addHandler(this._currentInteractiveView.get_container(),"scroll",o.i(this,this.ScrollHandler,"ScrollHandler")),this._activeFrame.add_onResize(o.i(this,this.ResizeHandler,"ResizeHandler"))},e.prototype.UnregisterViewChangedEventHandlers=function(){wo.n.removeHandler(this._currentInteractiveView.get_container(),"scroll",o.i(this,this.ScrollHandler,"ScrollHandler")),this._activeFrame.remove_onResize(o.i(this,this.ResizeHandler,"ResizeHandler"))},e.prototype.UpdateFloatiePosition=function(){var e=new $m.g(0,L.AFrameworkApplication.get_isRtl());e.location=this._pasteFloatiePositionProvider.getFloatiePosition(),this._pasteFloatiePositionProvider.isFloatieInContentView(e.location)?this.ShowFloatie(null,e):this._pasteFloatieEventSource.raiseDismissPasteFloatieEvent(new Vm.g(!1))},e.prototype.ResizeHandler=function(){this.UpdateFloatiePosition()},e.prototype.ScrollHandler=function(e){this.UpdateFloatiePosition()},e.prototype.FloatieDismissedHandler=function(e,t){this.DismissFloatie(t.get_finalDismiss())},e.prototype.ShowFloatieHandler=function(e,t){this.CreateFloatie(e,t)},e.prototype.RegisterFloatieEventHandler=function(){this._pressOnlyKeyEvent.add_onKeyCodeWasPressedOnly(o.i(this,this.OnOnlyKeyPressed,"OnOnlyKeyPressed")),this._pasteFloatieEventSource.add_onExpandPasteFloatieMenu(o.i(this._pasteFloatieManager,this._pasteFloatieManager.expandFloatie,"expandFloatie")),this._pasteFloatieEventSource.add_onPastedFloatieStatusChange(o.i(this,this.PastedFloatieStatusChange,"PastedFloatieStatusChange")),this._paragraphNodeEventHandlers.add_onConnected(o.i(this,this.OnParagraphConnect,"OnParagraphConnect")),this._paragraphNodeEventHandlers.add_onDisconnected(o.i(this,this.OnParagraphDisconnected,"OnParagraphDisconnected")),this._paragraphNodeEventHandlers.add_onPropertyChanged(o.i(this,this.OnParagraphPropertyChanged,"OnParagraphPropertyChanged"))},e.prototype.UnregisterFloatieHandler=function(){this._pressOnlyKeyEvent.remove_onKeyCodeWasPressedOnly(o.i(this,this.OnOnlyKeyPressed,"OnOnlyKeyPressed")),this._pasteFloatieEventSource.remove_onExpandPasteFloatieMenu(o.i(this._pasteFloatieManager,this._pasteFloatieManager.expandFloatie,"expandFloatie")),this._pasteFloatieEventSource.remove_onPastedFloatieStatusChange(o.i(this,this.PastedFloatieStatusChange,"PastedFloatieStatusChange")),this._paragraphNodeEventHandlers.remove_onConnected(o.i(this,this.OnParagraphConnect,"OnParagraphConnect")),this._paragraphNodeEventHandlers.remove_onDisconnected(o.i(this,this.OnParagraphDisconnected,"OnParagraphDisconnected")),this._paragraphNodeEventHandlers.remove_onPropertyChanged(o.i(this,this.OnParagraphPropertyChanged,"OnParagraphPropertyChanged"))},e.prototype.PastedFloatieStatusChange=function(e,t){this._isLocked=t.isFloatieLocked,t.pasteCommand&&(this._pasteCommand=t.pasteCommand),t.shouldUpdatePosition&&this._pasteFloatieManager.isFloatieVisible()&&this.UpdateFloatiePosition()},e.prototype.OnParagraphPropertyChanged=function(e,t){t.get_property()===is.b.lastModifiedTime&&(this._graphTransactionManager.get_currentModificationOperations().contains(Oi.u.updateProofingResults)||this.RaiseDismissEventIfNotLoading(t))},e.prototype.OnParagraphDisconnected=function(e,t){this.RaiseDismissEventIfNotLoading(t)},e.prototype.OnParagraphConnect=function(e,t){t.get_isDelayLoad()||this.RaiseDismissEventIfNotLoading(t)},e.prototype.RaiseDismissEventIfNotLoading=function(e){e.get_node().get_loading()||this._pasteFloatieEventSource.raiseDismissPasteFloatieEvent(new Vm.g(!0))},e.prototype.ShowFloatie=function(e,t){return t||(t=new $m.g(0,L.AFrameworkApplication.get_isRtl())),t.location||(t.location=this._pasteFloatiePositionProvider.getFloatiePosition()),!!t.location&&(this._isHiding&&(this._isHiding=!1,this.RegisterFloatieEventHandler()),this._pasteFloatieManager.showFloatie(e,t),!0)},e.prototype.OnOnlyKeyPressed=function(e,t){Wm.i.get_instance().keyCode===Re.v.vK_Ctrl&&this._pasteFloatieEventSource.raiseExpandPasteFloatieMenuEvent()},e}();(0,o.l)(zm,"c9434152$PasteFloatieEventManager",null,[]);var Km=function(){function e(e,t){this._clipboardDataHelper=null,this._commandUiBridge=null,this._clipboardDataHelper=e,this._commandUiBridge=t}return e.prototype.createFromPastedHtmlString=function(t){var n=this;if(!Kc.Enumerable.any(String,Kc.Enumerable.where(String,Kc.Enumerable.asEnumerable(String,e.SupportedCommands),(function(e){return n._commandUiBridge.isRibbonCommandEnabled(e)}))))return 1;var i=this._clipboardDataHelper.parseHtmlUsingDomParser(t);if(i){var r=i.innerText;if(!!r&&r.trim().length>0)return 0}return 1},e.SupportedCommands=["1604545586","2385042182"],e}();(0,o.l)(Km,"b8ec121a$PasteFloatieFeatureSetBuilder",null,[]);var qm=n(5752),jm=n(8469),Qm=n(3095),Jm=n(294),Xm=function(){return function(){this.pastedNode=null,this.pastedCp=0}}();(0,o.l)(Xm,"4554b384$PasteFloatieAnchorData",null,[]);var Ym=n(5770),Zm=function(){function e(e,t,n,i,r){this._selectionManager=null,this._textMetricsAdapter=null,this._interactiveViewManager=null,this._getElementBoundFunc=null,this._pasteFloatieManager=null,this._pasteFloatieAnchorData=null,this._selectionManager=e,this._textMetricsAdapter=t,this._interactiveViewManager=n,this._getElementBoundFunc=i,this._pasteFloatieManager=r}return e.prototype.invalidPastedPositionCache=function(){this._pasteFloatieAnchorData=null},e.prototype.getFloatiePosition=function(){var e=this.GetFloatiePositionFromNode(this._pasteFloatieAnchorData)||this.CalculateFloatiePosition();if(!e){var t="null",n="null";if(this._pasteFloatieAnchorData.pastedNode){if(!this._interactiveViewManager.get_selectionView())return S.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;t=Object.getType(this._pasteFloatieAnchorData.pastedNode).getName();var i=this._pasteFloatieAnchorData.pastedNode.getViewElement(this._interactiveViewManager.get_selectionView().get_viewId());i&&(n=Object.getType(i).getName())}S.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",t,n)}return e},e.prototype.isFloatieInContentView=function(e){if(!e)return!1;var t=this._pasteFloatieManager.getFloatieBounds(),n=this._getElementBoundFunc(this._interactiveViewManager.get_selectionView().get_container()),i=new Sys.UI.Bounds(e.x,e.y,t.width,t.height);return i.y>=n.y&&i.y+i.height<=n.y+n.height},e.prototype.CalculateFloatiePosition=function(){if(!this._selectionManager||!this._selectionManager.get_selectionCollection()||!this._selectionManager.get_selectionCollection().get_currentSelection())return S.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var e=this._selectionManager.get_selectionCollection().get_currentSelection().get_firstContext(),t=!e.get_cpBegin()&&!e.get_cpEnd(),n=e.get_node();if(n&&t)do{n=this.GetPreviousContentNode(n)}while(n&&o.r(cs.AParagraphNode,n)&&!n.get_characterData().trim().length);var i="",r=(0,y.e)(cs.AParagraphNode,n);r&&(i=r.get_characterData().length===e.get_cpBegin()||t?r.get_characterData().trimEnd():r.get_characterData().substring(0,e.get_cpBegin()).trimEnd());var a=r?i.length:e.get_cpBegin(),l=(0,U.m)(new Xm,{pastedNode:(0,y.e)(qm.k,(r?(0,y.e)(qm.k,r):(0,y.e)(qm.k,n))||e.get_node()),pastedCp:a});return this.GetFloatiePositionFromNode(l)},e.prototype.GetPreviousContentNode=function(e){var t=new ha.g;return e.get_anchor()?(t.set(e),t.tryToRootAtOutlineAncestor()?(t.returnToAncestorOfType(11),t.goToPreviousSibling()?t.goToFirstChildByRole(2):null):null):null},e.prototype.GetFloatiePositionFromNode=function(t){if(!t||!t.pastedNode)return null;this._pasteFloatieAnchorData=t;var n=this._interactiveViewManager.get_selectionView();if(!n)return S.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;var i=(0,y.e)(jm.e,t.pastedNode.getViewElement(n.get_viewId()));if(!i)return null;var r=null;if(o.r(cs.AParagraphNode,t.pastedNode)){var a=(0,y.e)(Qm.e,i);if(!a)return null;try{(r=this._textMetricsAdapter.boundsFromIp(t.pastedCp,a,t.pastedCp>0,!1,!1,!1)).height+=e.FloatieYAxisOffSet}catch(e){S.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",e),r=null}}else if(o.r(Ym.f,t.pastedNode)){r=(0,y.e)(Jm.v,i).getTableContentBounds()}return r||(r=i.getBounds()),L.AFrameworkApplication.get_isRtl()&&this._pasteFloatieManager.isFloatieVisible()&&(r.x-=this._pasteFloatieManager.getFloatieBounds().width),new Sys.UI.Point(r.x+r.width,r.y+r.height)},e.FloatieYAxisOffSet=2,e}();(0,o.l)(Zm,"129d19d5$PasteFloatiePositionProvider",null,[]);var ef=(0,o.y)("704e15c9$ICopyPasteShortcutDialogFactory"),tf=function(){function e(e,t){this._dialogHandler=null,this.clipboardAccessExtensionLink=null,this._dialogHandler=e,this.clipboardAccessExtensionLink=t}return e.prototype.get_titleText=function(){return CommonUIStrings.l_ClipboardUseShortcutTitle},e.prototype.get_forwardElementText=function(){return CommonUIStrings.l_ClipboardUseShortcutMessage},e.prototype.get_cutText=function(){return CommonUIStrings.l_ClipboardCut},e.prototype.get_macCutText=function(){return CommonUIStrings.l_ClipboardCut_Mac},e.prototype.get_copyText=function(){return CommonUIStrings.l_ClipboardCopy},e.prototype.get_macCopyText=function(){return CommonUIStrings.l_ClipboardCopy_Mac},e.prototype.get_pasteText=function(){return CommonUIStrings.l_ClipboardPaste},e.prototype.get_macPasteText=function(){return CommonUIStrings.l_ClipboardPaste_Mac},e.prototype.get_pasteTextOnly=function(){return CommonUIStrings.l_ClipboardPasteText},e.prototype.get_macPasteTextOnly=function(){return CommonUIStrings.l_ClipboardPasteText_Mac},e.prototype.get_clipboardAccessExtensionLink=function(){return this.clipboardAccessExtensionLink},e.prototype.get_clipboardExtensionLinkText=function(){return CommonUIStrings.l_ClipboardExtensionLink},e.prototype.get_clipboardExtensionSuggestionText=function(){return CommonUIStrings.l_ClipboardExtensionSuggestion},e.prototype.extensionLinkHandler=function(e){S.ULS.sendTraceTag(8716421,307,50,null),window.open(this.get_clipboardAccessExtensionLink(),"_blank")},e.prototype.resolveCopyPasteShortcut=function(t,n){var i=W.y.get_isMac();return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CcpFixIPadShortcutStringsIsEnabled")&&(i=W.y.get_isIPad()||i),i?String.format(n,e.MacCommandSymbol):t},e.prototype.dispose=function(){this._dialogHandler=null},e.prototype.reactCopyPasteShortcutDialogHandler=function(e,t){this.CopyPasteShortcutDialogHandler(e)},e.prototype.legacyCopyPasteShortcutDialogHandler=function(e,t){this.CopyPasteShortcutDialogHandler(e)},e.prototype.CopyPasteShortcutDialogHandler=function(e){this._dialogHandler&&this._dialogHandler(e)},e.MacCommandSymbol="\u2318",e.id="CopyPasteShortcutDialog",e.textElementId="CopyPasteText",e}();(0,o.l)(tf,"34a14835$ACopyPasteShortcutDialog",null,[Sys.IDisposable]);var nf=function(e){function t(n,i,r){var a=e.call(this,n,i)||this,l=document.createElement(t.spanText);l.className=t.WACCopyPasteShortcutDialogTextPanel;var s=document.createElement(t.spanText);s.id=tf.textElementId;var u=document.createElement(t.spanText);u.innerText=a.get_forwardElementText();var c=document.createElement(t.spanText);c.className=t.boldText,c.innerText=a.resolveCopyPasteShortcut(a.get_cutText(),a.get_macCutText());var d=document.createElement(t.spanText);d.className=t.boldText,d.innerText=a.resolveCopyPasteShortcut(a.get_copyText(),a.get_macCopyText());var g=document.createElement(t.spanText);if(g.className=t.boldText,g.innerText=a.resolveCopyPasteShortcut(a.get_pasteText(),a.get_macPasteText()),s.appendChild(u),s.appendChild(document.createElement("br")),s.appendChild(c),s.appendChild(d),s.appendChild(g),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPasteTextOnlyShortcutDialogSettings"),r.getBooleanAppSetting("PasteTextOnlyShortcutDialogIsEnabled")&&(W.y.get_isChrome()||W.y.get_isFirefox())){var p=document.createElement(t.spanText);p.className=t.boldText,p.innerText=a.resolveCopyPasteShortcut(a.get_pasteTextOnly(),a.get_macPasteTextOnly()),s.appendChild(p)}if(l.appendChild(s),a.get_clipboardAccessExtensionLink()){S.ULS.sendTraceTag(8716420,307,50,null);var h=document.createElement(t.spanText),_=document.createElement("a");_.href="#",_.innerText=a.get_clipboardExtensionLinkText(),wo.n.addHandler(_,"click",o.i(a,a.extensionLinkHandler,"extensionLinkHandler")),h.appendChild(_);var m=a.get_clipboardExtensionSuggestionText().indexOf("{0}");if(-1!==m){var f=a.get_clipboardExtensionSuggestionText().substring(0,m),y=a.get_clipboardExtensionSuggestionText().substring(m+3,a.get_clipboardExtensionSuggestionText().length),C=document.createTextNode(f),b=document.createTextNode(y);h.insertBefore(C,_),h.appendChild(b)}l.appendChild(document.createElement("br")),l.appendChild(h)}else S.ULS.sendTraceTag(8716422,307,50,null);var v=new Vn.StandardDialog;return v.set_buttonsOption(0),v.set_dialogId(tf.id),v.messageBox(a.get_titleText(),null,0,o.i(a,a.legacyCopyPasteShortcutDialogHandler,"legacyCopyPasteShortcutDialogHandler"),l),v.setDescribedByForDialog(tf.textElementId),a}return(0,v.t)(t,e),t.WACCopyPasteShortcutDialogTextPanel="WACCopyPasteShortcutDialogTextPanel",t.spanText="span",t.boldText="UIFontBold",t}(tf);(0,o.l)(nf,"28337d34$CopyPasteShortcutDialog",tf,[]);var rf=function(e){function t(t,n,i){var r=e.call(this,t,n)||this,a={};if(a.forwardElementText=r.get_forwardElementText(),a.cutText=r.resolveCopyPasteShortcut(r.get_cutText(),r.get_macCutText()),a.copyText=r.resolveCopyPasteShortcut(r.get_copyText(),r.get_macCopyText()),a.pasteText=r.resolveCopyPasteShortcut(r.get_pasteText(),r.get_macPasteText()),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPasteTextOnlyShortcutDialogSettings"),i.getBooleanAppSetting("PasteTextOnlyShortcutDialogIsEnabled")&&(W.y.get_isChrome()||W.y.get_isFirefox())&&(a.pasteTextOnly=r.resolveCopyPasteShortcut(r.get_pasteTextOnly(),r.get_macPasteTextOnly())),r.get_clipboardAccessExtensionLink()){S.ULS.sendTraceTag(40726914,307,50,null);a.extensionLink={type:"AppLinkProps",id:"extensionLink",text:r.get_clipboardExtensionLinkText(),handler:function(e){r.extensionLinkHandler(e)}};var l=r.get_clipboardExtensionSuggestionText().indexOf("{0}");-1!==l&&(a.suggestionPrefixElement=r.get_clipboardExtensionSuggestionText().substring(0,l),a.suggestionSuffixElement=r.get_clipboardExtensionSuggestionText().substring(l+3,r.get_clipboardExtensionSuggestionText().length))}else S.ULS.sendTraceTag(40726915,307,50,null);var s={id:tf.id,bodyControls:a},u=new Bi.o(!1,!1,!0);return u.set_buttonsOption(0),u.set_dialogId(tf.id),u.initializeAndShow(r.get_titleText(),o.i(r,r.reactCopyPasteShortcutDialogHandler,"reactCopyPasteShortcutDialogHandler"),s),r}return(0,v.t)(t,e),t}(tf);(0,o.l)(rf,"a581a2b5$ReactCopyPasteShortcutDialog",tf,[]);var of=function(){function e(){this._isReactDialogEnabled=!1,this._isReactDialogEnabled=!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactDialogEnabled()}return e.prototype.createCopyPasteShortcutDialog=function(e,t){return this._isReactDialogEnabled?new rf(e,t,L.AFrameworkApplication.appSettingsManager):new nf(e,t,L.AFrameworkApplication.appSettingsManager)},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();(0,o.l)(of,"7c5ec4c0$CopyPasteShortcutDialogFactory",null,[ef]);var af=function(){function e(e,t,n,i,r,o,a){this._stopTesting=!1,this._isInUse=!1,this._systemClipboardAccessManager=null,this._interactiveViewManager=null,this._workspace=null,this._focusManager=null,this._editingDomManager=null,this._editViewStateManager=null,this._browserUtils=null,this._systemClipboardAccessManager=e,this._interactiveViewManager=t,this._workspace=n,this._focusManager=i,this._editingDomManager=r,this._editViewStateManager=o,this._browserUtils=a}return e.prototype.get_SystemClipboardAccessManager=function(){return this._systemClipboardAccessManager},e.prototype.get_IsInUse=function(){return this._isInUse},e.prototype.set_IsInUse=function(e){return this._isInUse=e,this._editViewStateManager.set_ignoreClipboardEvents(e),e},e.prototype.ensureSystemClipboardAccess=function(e){this.get_SystemClipboardAccessManager().ensureSystemClipboardAccess(e),e||this.TestClipboardAccess(!0)},e.prototype.get_ensureOperationResult=function(){return this.get_SystemClipboardAccessManager().get_resultForEnsureAccessOperation()},e.prototype.prepareForPaste=function(e){this.set_IsInUse(!0),this.get_SystemClipboardAccessManager().prepareForPaste(e,this.get_TargetDocument())},e.prototype.reset=function(){this.set_IsInUse(!1)},e.prototype.paste=function(){var e=this._interactiveViewManager.get_selectionView();e&&this._focusManager.setScope(e.get_focusScopeId());var t=this._workspace.get_activeView();if(!t.get_isInteractiveView())return null;var n=t;if(!n.get_editingView().get_isContentEditableView())return null;var i=n.get_editingView(),r=this._editingDomManager.getEditingElement();this.set_IsInUse(!0),t.validateSynchronous();var o=null;try{i.prepareForPasteAction(),this.get_SystemClipboardAccessManager().executePasteCommand(this.get_TargetDocument(),(0,g.m)((function(){return r}),(function(e){return r=e}))),o=r}catch(e){S.ULS.shipAssertTag(6305672,307,!1),this.HandleBlockedAccessAttempt(!0)}return this.set_IsInUse(!1),o},e.prototype.copy=function(){var e=this._interactiveViewManager.get_selectionView();e&&this._focusManager.setScope(e.get_focusScopeId());var t,n=this._workspace.get_activeView();if(!n.get_isInteractiveView())return!1;if(1!==n.get_editingView().get_mode())return!1;this.set_IsInUse(!0);try{this.get_SystemClipboardAccessManager().executeCopyCommand(this.get_TargetDocument()),t=!0}catch(e){S.ULS.shipAssertTag(6305673,307,W.y.get_isFirefox()),S.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",W.y.get_browserNameForlogging()),t=!1}return this.set_IsInUse(!1),!!t},e.prototype.TestClipboardAccess=function(e){if(this._stopTesting)return!0;var t=this._workspace.get_activeView();if(!t.get_isInteractiveView())return!1;var n=t;if(!n.get_editingView().get_isContentEditableView())return!1;var i=n.get_editingView(),r=this._editingDomManager.getEditingElement();this.set_IsInUse(!0);var o=new Gg.w(r),a=!1;try{a=this.get_SystemClipboardAccessManager().testClipboardAccess(r,(function(){i.clearSurface()}),(function(){i.selectAllContent()}))}catch(e){S.ULS.shipAssertTag(6305674,307,!W.y.get_isInternetExplorerNonEdge())}return o.restore(),this.set_IsInUse(!1),a?this._stopTesting=!0:(S.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",W.y.get_browserNameForlogging()),W.y.get_isInternetExplorerNonEdge()||this.HandleBlockedAccessAttempt(e)),a},e.prototype.HandleBlockedAccessAttempt=function(e){if(this._stopTesting=!1,L.AFrameworkApplication.get_wacCopyPasteShortcutDialogIsEnabled())of.get_instance().createCopyPasteShortcutDialog(null,null);else{var t=new Vn.StandardDialog;t.set_buttonsOption(0),t.showWarning(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}},e.prototype.get_TargetDocument=function(){var e=this._editingDomManager.getEditingDomOwnerDocument();return e?e.get_domDocument():null},e}();(0,o.l)(af,"6f2fafcb$SystemClipboard",null,[Od]);var lf=n(2454),sf=(0,o.y)("7756c440$IEdgeSystemClipboardSelectionEnsureStrategy"),uf=function(){function e(t,n,i){this._chromeClipboardAccessExtensionSuggestionIsEnabled=!1,this._chromeClipboardAccessRichFormatContentIsEnabled=!1,this._chromeSingleTextRunCopyImprovementIsEnabled=!1,this._googleWebstoreLink=null,this._extensionHelper=null,this._clipboardDataHelper=null,this._oldCopyPasteExtensionId=null,this._clipboardContentFromExtension=null,this._lastPasteUid=null,this._extensionId=null,this._isAnchorElement=null,this.$$pf_ResultForEnsureAccessOperation=null,this._chromeClipboardAccessExtensionSuggestionIsEnabled=t.getBooleanAppSetting("ChromeClipboardAccessExtensionSuggestionIsEnabled"),this._chromeClipboardAccessRichFormatContentIsEnabled=t.getBooleanAppSetting("ChromeClipboardAccessRichFormatContentIsEnabled"),this._chromeSingleTextRunCopyImprovementIsEnabled=t.getBooleanAppSetting("ChromeSingleTextRunCopyImprovementIsEnabled"),this._googleWebstoreLink=t.getStringAppSetting("ChromeClipboardAccessExtensionLink"),this._extensionHelper=n,this._clipboardDataHelper=i,this._oldCopyPasteExtensionId=t.getStringAppSetting("ChromeClipboardAccessExtensionId"),this._extensionId=null,this._isAnchorElement=function(t){return!!t.tagName&&t.tagName.toLowerCase()===e.AnchorTagName}}return e.prototype.ensureSystemClipboardAccess=function(e){e?this.set_resultForEnsureAccessOperation(!0):(this.set_resultForEnsureAccessOperation(null),chrome.runtime&&chrome.runtime.sendMessage?(this._extensionId=this._extensionHelper.getExtensionId(),this._extensionHelper.get_shouldCheckExtensionBySendingMessage()?this.CheckExtensionExistenceAsync():(this.set_resultForEnsureAccessOperation(!0),S.ULS.sendTraceTag(19256732,307,50,mt.h.create().toString()))):(this.PopupInstallDialog(),this.set_resultForEnsureAccessOperation(!1)))},e.prototype.get_resultForEnsureAccessOperation=function(){return this.$$pf_ResultForEnsureAccessOperation},e.prototype.set_resultForEnsureAccessOperation=function(e){return this.$$pf_ResultForEnsureAccessOperation=e,e},e.prototype.testClipboardAccess=function(e,t,n){return!0},e.prototype.executeCopyCommand=function(e){S.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy"),bt.g.executeDocumentCommand(e,"copy")||S.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)))},e.prototype.executePasteCommand=function(e,t){if(this._clipboardContentFromExtension){var n=document.implementation.createHTMLDocument("doc");n.body.innerHTML=this._clipboardContentFromExtension,t.val=n.body,this._clipboardContentFromExtension=null}},e.prototype.prepareForPaste=function(t,n){var i=this,r=mt.h.create();this._lastPasteUid=r,this._extensionHelper.get_shouldCheckExtensionBySendingMessage()?S.ULS.sendTraceTag(7377737,307,50,r.toString()):S.ULS.sendTraceTag(19256735,307,50,r.toString());var o={};o[e.Command]=e.PasteCommand,chrome.runtime.sendMessage(this._extensionId,o,(function(e){r.equals(i._lastPasteUid)?i._clipboardContentFromExtension=e:S.ULS.sendTraceTag(7385868,307,50,null),S.ULS.sendTraceTag(7377738,307,50,r.toString()),chrome.runtime.lastError&&(i.DropExtensionAndPopDialog(),i._extensionHelper.get_shouldCheckExtensionBySendingMessage()?S.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):S.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message)),t()}))},e.prototype.PopupInstallDialog=function(){S.ULS.sendTraceTag(8716423,307,50,null),of.get_instance().createCopyPasteShortcutDialog(o.i(this,this.PopupInstallDialogHandler,"PopupInstallDialogHandler"),this._chromeClipboardAccessExtensionSuggestionIsEnabled?this._googleWebstoreLink+this._extensionId:null)},e.prototype.PopupInstallDialogHandler=function(e){1===e?S.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this._chromeClipboardAccessExtensionSuggestionIsEnabled)):e||S.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this._chromeClipboardAccessExtensionSuggestionIsEnabled))},e.prototype.DropExtensionAndPopDialog=function(){this._extensionHelper.resetExtensionId(),this.PopupInstallDialog()},e.prototype.SendTestCommandMessage=function(t,n){var i={};i[e.Command]=e.TestCommand,i[e.MessageObject]=e.TestMessage,chrome.runtime.sendMessage(t,i,n)},e.prototype.CheckExtensionExistenceAsync=function(){var t=this,n=mt.h.create();S.ULS.sendTraceTag(7726105,307,50,n.toString()),this.SendTestCommandMessage(this._extensionId,(function(i){if(S.ULS.sendTraceTag(7726106,307,50,n.toString()),i&&i===e.TestMessage)t.set_resultForEnsureAccessOperation(!0);else{if(i){var r=i;r!==e.TestMessage&&S.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",r,chrome.runtime.lastError?chrome.runtime.lastError.message:null)}else S.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null);t.PopupInstallDialog(),t.set_resultForEnsureAccessOperation(!1)}}))},e.prototype.LogInstallationStatusDictionary=function(e,t){var n={};n.OfficeOnlineExtensionInstallationStatus=e,n.OfficeClipboardExtensionInstallationStatus=t,S.ULS.sendTraceTag(51144839,307,50,JSON.stringify(n))},e.prototype.logExtensionInstallationStatus=function(){var e=this;if(chrome.runtime&&chrome.runtime.sendMessage){var t=!this._extensionHelper.get_shouldCheckExtensionBySendingMessage();this.SendTestCommandMessage(this._oldCopyPasteExtensionId,(function(n){var i=!!n;e.LogInstallationStatusDictionary(t,i)}))}else this.LogInstallationStatusDictionary(!1,!1)},e.Command="command",e.PasteCommand="paste",e.TestCommand="test",e.TestMessage="ping",e.MessageObject="object",e.AnchorTagName="a",e.BodyTagName="body",e}();(0,o.l)(uf,"b5702d42$ChromeSystemClipboardAccessManager",null,[Wd]);var cf=function(){function e(e,t){this._browserUtils=null,this._appSettingsManager=null,this._blockFirefoxCopyCutThroughSystemClipboard=!1,this.$$pf_ResultForEnsureAccessOperation=null,this._browserUtils=e,this._appSettingsManager=t,this._blockFirefoxCopyCutThroughSystemClipboard=!this._appSettingsManager.getBooleanAppSetting("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this._appSettingsManager.getBooleanAppSetting("BlockCopyCutOnFirefoxIsEnabled")}return e.prototype.ensureSystemClipboardAccess=function(e){if(this._blockFirefoxCopyCutThroughSystemClipboard&&e&&this._browserUtils.get_isFirefox())return of.get_instance().createCopyPasteShortcutDialog(null,null),void this.set_resultForEnsureAccessOperation(!1);this.set_resultForEnsureAccessOperation(!0)},e.prototype.get_resultForEnsureAccessOperation=function(){return this.$$pf_ResultForEnsureAccessOperation},e.prototype.set_resultForEnsureAccessOperation=function(e){return this.$$pf_ResultForEnsureAccessOperation=e,e},e.prototype.executeCopyCommand=function(e){bt.g.executeDocumentCommand(e,"copy")},e.prototype.executePasteCommand=function(e,t){bt.g.executeDocumentCommand(e,"paste")},e.prototype.prepareForPaste=function(e,t){void 0===t&&(t=null),e()},e.prototype.testClipboardAccess=function(e,t,n){if(this._browserUtils.get_isElectron())return!1;t(),n(),this.executePasteCommand(e.ownerDocument,(0,g.m)((function(){return e}),(function(t){return e=t})));var i=e.innerHTML;e.innerHTML=ai.l.create().toString(),n(),this.executePasteCommand(e.ownerDocument,(0,g.m)((function(){return e}),(function(t){return e=t})));var r=i===e.innerHTML;return this.set_resultForEnsureAccessOperation(r),r},e}();(0,o.l)(cf,"42210bd7$DefaultSystemClipboardAccessManager",null,[Wd]);var df=function(){function e(e,t,n,i){this._clipboardDataHelper=null,this._processImageStrategy=null,this._maxImageNumber=0,this._clientCallback=null,this._pastedContentDom=null,this._pastedTargetElement=null,this._pasteTargetDocument=null,this._imageBlobs=null,this._edgeSystemClipboardSelectionEnsureStrategy=null,this._isEdgeSystemClipboardSelectionEnsureStrategyIsEnabled=!1,this._shouldGrantEdgeSystemClipboardAccessForCopyCut=!1,this.$$pf_ResultForEnsureAccessOperation=null,this._clipboardDataHelper=t,this._processImageStrategy=n,this._maxImageNumber=e.getIntAppSetting("ClipboardDataImageBlobLimitaton",10),this._isEdgeSystemClipboardSelectionEnsureStrategyIsEnabled=e.getBooleanAppSetting("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled"),this._edgeSystemClipboardSelectionEnsureStrategy=i,this._shouldGrantEdgeSystemClipboardAccessForCopyCut=e.getBooleanAppSetting("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}return e.prototype.ensureSystemClipboardAccess=function(e){this._shouldGrantEdgeSystemClipboardAccessForCopyCut&&e&&this.set_resultForEnsureAccessOperation(!0)},e.prototype.get_resultForEnsureAccessOperation=function(){return this.$$pf_ResultForEnsureAccessOperation},e.prototype.set_resultForEnsureAccessOperation=function(e){return this.$$pf_ResultForEnsureAccessOperation=e,e},e.prototype.executeCopyCommand=function(e){e&&bt.g.executeDocumentCommand(e,me.d.copy)},e.prototype.executePasteCommand=function(e,t){this._pastedContentDom&&(t.val=this._pastedContentDom,this._pastedContentDom=null)},e.prototype.prepareForPaste=function(e,t){if(void 0===t&&(t=null),e&&t){if(this._clientCallback=e,this._pasteTargetDocument=t,$addHandler(this._pasteTargetDocument,me.d.paste,o.i(this,this.OnPasteEvent,"OnPasteEvent")),this._pastedTargetElement=null,this._imageBlobs=null,this._isEdgeSystemClipboardSelectionEnsureStrategyIsEnabled&&this._edgeSystemClipboardSelectionEnsureStrategy.ensureSelection(),this.TryPaste(this._pasteTargetDocument)){if(this._imageBlobs&&this._imageBlobs.length>0&&(!this._pastedTargetElement||this._clipboardDataHelper.useImageDataFromPasteEvent(this._pastedTargetElement)))return this._processImageStrategy.convertImageBlobToBase64(this._imageBlobs,o.i(this,this.OnImageConverted,"OnImageConverted")),void(this._pastedContentDom&&!this._pastedContentDom.hasChildNodes()&&S.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes."));this._pastedTargetElement&&this._pastedTargetElement.innerHTML&&(this._pastedContentDom=this.HtmlStringToDom(this._pastedTargetElement.innerHTML),this._pastedContentDom&&!this._pastedContentDom.hasChildNodes()&&S.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),ji.s.clearElement(this._pastedTargetElement))}this.FinishPrepareForPaste()}else e&&e()},e.prototype.testClipboardAccess=function(e,t,n){var i=this.TryPaste(e.ownerDocument);return this.set_resultForEnsureAccessOperation(i),i},e.prototype.OnPasteEvent=function(e){try{if(e&&e.rawEvent){if(this._pastedTargetElement=e.rawEvent.target,this._pastedTargetElement&&this._pastedTargetElement.id&&this._pastedTargetElement.id.indexOf("Paste")>-1)return S.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this._pastedTargetElement.id),void(this._pastedTargetElement=null);this._imageBlobs=this.GetImageBlobs(e.rawEvent)}}catch(e){S.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+e.toString())}},e.prototype.OnImageConverted=function(e){e&&(this._processImageStrategy.get_shouldPassImageDataUriAsPasteContent()&&(e=String.format('<img src="{0}">',e)),this._pastedContentDom=this.HtmlStringToDom(e)),this.FinishPrepareForPaste()},e.prototype.FinishPrepareForPaste=function(){this._pasteTargetDocument&&($removeHandler(this._pasteTargetDocument,me.d.paste,o.i(this,this.OnPasteEvent,"OnPasteEvent")),this._pasteTargetDocument=null),this._clientCallback&&(this._clientCallback(),this._clientCallback=null)},e.prototype.GetImageBlobs=function(e){var t,n=null,i=this._clipboardDataHelper.getClipboardDataTransferIfOnlyContainsImage(e);i&&this._clipboardDataHelper.tryGetPastedImageBlob(i,this._maxImageNumber,this._processImageStrategy.get_maxImageBlobSizeInBytes(),(0,g.m)((function(){return n}),(function(e){return n=e})),(0,g.m)((function(){return t}),(function(e){return t=e})));return n},e.prototype.TryPaste=function(e){return bt.g.executeDocumentCommand(e,me.d.paste)},e.prototype.HtmlStringToDom=function(e){var t=document.implementation.createHTMLDocument("doc");return t.body.innerHTML=e,t.body},e}();(0,o.l)(df,"32e5571f$EdgeSystemClipboardAccessManager",null,[Wd]);var gf=function(){function e(e,t,n,i){this._appSettingsManager=null,this._chromeExtensionHelper=null,this._clipboardDataHelper=null,this._browserUtils=null,this._appSettingsManager=e,this._chromeExtensionHelper=t,this._clipboardDataHelper=n,this._browserUtils=i}return e.prototype.create=function(){var e=null;return e||(this._appSettingsManager.getBooleanAppSetting("ChromeClipboardAccessIsEnabled")&&this._browserUtils.get_isChrome()&&window.chrome?(S.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),e=new uf(this._appSettingsManager,this._chromeExtensionHelper,this._clipboardDataHelper),this._appSettingsManager.getBooleanAppSetting("LogChromeExtensionInstallationStatusIsEnabled")&&e.logExtensionInstallationStatus()):this._appSettingsManager.getBooleanAppSetting("EdgeContextMenuPasteFixIsEnabled")&&this._browserUtils.get_isInternetExplorerEdge()?(S.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),e=new df(this._appSettingsManager,Ge.w.get_instance().resolve(Ud.t),Ge.w.get_instance().resolve(lf.f),Ge.w.get_instance().resolve(sf))):(S.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),e=new cf(this._browserUtils,this._appSettingsManager))),e},e}();(0,o.l)(gf,"5c4eaec8$SystemClipboardAccessManagerFactory",null,[Gd]);var pf=function(){function e(){}return e.prototype.excludeControlCells=function(e){},e}();(0,o.l)(pf,"66fad85e$DeleteTableSegmentStrategy",null,[zd]);var hf=n(2572),_f=n(7876),mf=n(9193),ff=n(2335),yf=function(){function e(e,t){this._isFrozen=!1,this._containingObjectSpace=null,this._paragraphWithIpFormatting=null,this._textFormattingCommands=null,this._fontSlotProvider=null,this._fontNameFormattingStrategy=null,this._ipProperties=new Dl.DictionaryPropertySet,this._fontSlotProvider=e,this._fontNameFormattingStrategy=t}return e.prototype.get_textFormattingCommands=function(){return this._textFormattingCommands||(this._textFormattingCommands=Ge.w.get_instance().tryResolve(su.n))},e.prototype.get_formattingEditor=function(){return e._formattingEditor||(e._formattingEditor=Ge.w.get_instance().resolve(Vs.z))},e.prototype.resetFormatting=function(){this._isFrozen||(this._ipProperties.removeAllProperties(),this._containingObjectSpace=null,this.RemoveIpFormattingCharacterProperty())},e.prototype.copyRunFormatting=function(e){var t=vc.FormattingReader.getFormattingObject(e);if(!t.get_cache().get_isLink()){var n=t.get_formattingContainer();if(n){var i=new Dl.DictionaryPropertySet;i.copyProperties(n),i.copyProperties(this._ipProperties),i.hasProperty(rs.o.characterStyle)&&(this._containingObjectSpace=t.get_paragraph().get_containingObjectSpace()),this._ipProperties=i}}},e.prototype.hasProperty=function(e){return this._ipProperties.hasProperty(e)},e.prototype.hasPropertiesApplied=function(){return this._ipProperties.countOfProperties()>0},e.prototype.get_ipProperties=function(){return this._ipProperties},e.prototype.freeze=function(){this._isFrozen=!0},e.prototype.thaw=function(){this._isFrozen=!1},e.prototype.getPropertyWithDefault=function(e,t,n){return this.get_ipProperties().getValueWithDefault(e,t,n)},e.prototype.setFontSize=function(e){this._ipProperties.setValue(is.b.fontSize,this.get_formattingEditor().constrainFontSize(e)),this.SetIpFormattingCharacterProperty()},e.prototype.fontSize=function(){return this._ipProperties.getValueWithDefault(Number,is.b.fontSize,Cc.Font.get_defaultSize())},e.prototype.setFontName=function(e){this._ipProperties.setValue(is.b.font,e),this._fontNameFormattingStrategy.setFontName(this._ipProperties,e),this._fontSlotProvider&&this._fontSlotProvider.get_enabled()&&(El.r.traceTag(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this._fontSlotProvider.setFontSlotValues(this._ipProperties,e)),this.SetIpFormattingCharacterProperty()},e.prototype.setThemeFont=function(e){this._ipProperties.setValue(os.j.themeFont,e),this._fontSlotProvider&&this._fontSlotProvider.get_enabled()&&(El.r.traceTag(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this._fontSlotProvider.setThemeSlotValues(this._ipProperties,e)),this.SetIpFormattingCharacterProperty()},e.prototype.setFontColor=function(e){var t=fa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection().get_firstContext().get_node(),n=mf.m.get_instance().colorFromThemeColor(t,e);this._ipProperties.setValue(is.b.fontColor,n),this.SetIpFormattingCharacterProperty()},e.prototype.clearFontColor=function(){this._ipProperties.setValue(is.b.fontColor,ff.o.auto),this.SetIpFormattingCharacterProperty()},e.prototype.fontColor=function(){return this._ipProperties.getValueWithDefault(Number,is.b.fontColor,ff.o.nil)},e.prototype.setFontHighlight=function(e){this._ipProperties.setValue(is.b.highlight,parseInt(e,16)),this.SetIpFormattingCharacterProperty()},e.prototype.clearFontHighlight=function(){this._ipProperties.setValue(is.b.highlight,ff.o.auto),this.SetIpFormattingCharacterProperty()},e.prototype.FontHighlight=function(){return this._ipProperties.getValueWithDefault(Number,is.b.highlight,ff.o.nil)},e.prototype.isBold=function(){return this._ipProperties.getValueWithDefault(Boolean,is.b.bold,!1)},e.prototype.setBold=function(e){this._ipProperties.setValue(is.b.bold,e),this.SetIpFormattingCharacterProperty()},e.prototype.isItalic=function(){return this._ipProperties.getValueWithDefault(Boolean,is.b.italic,!1)},e.prototype.setItalic=function(e){this._ipProperties.setValue(is.b.italic,e),this.SetIpFormattingCharacterProperty()},e.prototype.isUnderline=function(){return this._ipProperties.getValueWithDefault(Boolean,is.b.underline,!1)},e.prototype.setUnderline=function(e){this._ipProperties.setValue(is.b.underline,e),this._ipProperties.setValue(is.b.underlineType,e?Cc.Font.get_underlineTypeSingle():Cc.Font.get_underlineTypeNone()),this.SetIpFormattingCharacterProperty()},e.prototype.underlineType=function(){return this._ipProperties.getValueWithDefault(Number,is.b.underlineType,Cc.Font.get_underlineTypeNone())},e.prototype.setUnderlineType=function(e){e<Cc.Font.get_underlineTypeSingle()||e>Cc.Font.get_underlineTypeNone()||(this._ipProperties.setValue(is.b.underline,e!==Cc.Font.get_underlineTypeNone()),this._ipProperties.setValue(is.b.underlineType,e),this.SetIpFormattingCharacterProperty())},e.prototype.isSuperscript=function(){return this._ipProperties.getValueWithDefault(Boolean,is.b.superscript,!1)},e.prototype.setSuperscript=function(e){this._ipProperties.setValue(is.b.superscript,e),e&&this.isSuperscript()&&this._ipProperties.setValue(is.b.subscript,!1),this.SetIpFormattingCharacterProperty()},e.prototype.isSubscript=function(){return this._ipProperties.getValueWithDefault(Boolean,is.b.subscript,!1)},e.prototype.setSubscript=function(e){this._ipProperties.setValue(is.b.subscript,e),e&&this.isSubscript()&&this._ipProperties.setValue(is.b.superscript,!1),this.SetIpFormattingCharacterProperty()},e.prototype.isStrikethrough=function(){return this._ipProperties.getValueWithDefault(Boolean,is.b.strikethrough,!1)},e.prototype.setStrikethrough=function(e){this._ipProperties.setValue(is.b.strikethrough,e),this.SetIpFormattingCharacterProperty()},e.prototype.isDoubleStrikethrough=function(){return this._ipProperties.getValueWithDefault(Boolean,rs.o.doubleStrikethrough,!1)},e.prototype.setDoubleStrikethrough=function(e){this._ipProperties.setValue(rs.o.doubleStrikethrough,e),this.SetIpFormattingCharacterProperty()},e.prototype.getCharacterStyleObjectId=function(){return this._ipProperties.getValueWithDefault(mt.h,rs.o.characterStyle,null)},e.prototype.setCharacterStyle=function(e,t){this._ipProperties.removeAllProperties(),this._ipProperties.setValue(rs.o.characterStyle,e.get_id()),this._containingObjectSpace=t.get_containingObjectSpace(),this.SetIpFormattingCharacterProperty()},e.prototype.hasValidCharacterStyleObjectSpace=function(e){return!this._containingObjectSpace||e===this._containingObjectSpace},e.prototype.setLanguage=function(e){var t=is.b.languageID;if(Gl.n.get_instance().get_item(13)){var n=hf.k.lcidToLanguageHint(e);switch(n){case 1:t=os.j.languageIDBidi;break;case 2:t=os.j.languageIDEastAsia}this._ipProperties.setValue(os.j.languageHint,n)}this._ipProperties.setValue(t,e),this.SetIpFormattingCharacterProperty()},e.prototype.language=function(){var e=is.b.languageID;if(Gl.n.get_instance().get_item(13))switch(this._ipProperties.getValueWithDefault(Number,os.j.languageHint,0)){case 1:e=os.j.languageIDBidi;break;case 2:e=os.j.languageIDEastAsia}return this._ipProperties.getValueWithDefault(Number,e,0)},e.prototype.setNoProof=function(t){this._ipProperties.setValue(e.get_NoProofProperty(),t),this.SetIpFormattingCharacterProperty()},e.prototype.isNoProof=function(){return this._ipProperties.getValueWithDefault(Boolean,e.get_NoProofProperty(),!1)},e.prototype.isNoProofSetOnIP=function(){return this._ipProperties.hasProperty(e.get_NoProofProperty())},e.prototype.isLanguageSetOnIP=function(){return Gl.n.get_instance().get_item(13)?this._ipProperties.hasProperty(is.b.languageID)||this._ipProperties.hasProperty(os.j.languageIDBidi)||this._ipProperties.hasProperty(os.j.languageIDEastAsia):this._ipProperties.hasProperty(is.b.languageID)},e.prototype.SetIpFormattingCharacterProperty=function(){if(W.y.get_supportsPlacingIpInEmptySpan()){Si.InteractiveViewManager.get_instance().get_editingView();var e=fa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection().get_firstContext(),t=e.get_node();if(t!==this._paragraphWithIpFormatting){this._paragraphWithIpFormatting=t;var n=this._paragraphWithIpFormatting.suspendAutoCoreInvalidations();try{this._paragraphWithIpFormatting.ensureChPOnCp(e.get_cpBegin()).set_isIpFormatting(!0)}finally{n&&n.dispose()}}else this._paragraphWithIpFormatting.invalidateViewElements(16,!0)}},e.prototype.RemoveIpFormattingCharacterProperty=function(){if(W.y.get_supportsPlacingIpInEmptySpan()&&this._paragraphWithIpFormatting){var e=this._paragraphWithIpFormatting.suspendAutoCoreInvalidations();try{for(var t=this._paragraphWithIpFormatting.get_characterProperties().get_length()-1;0<=t;t--){var n=this._paragraphWithIpFormatting.get_characterProperties().get_item(t);n.get_isIpFormatting()&&(n.set_isIpFormatting(!1),0,n.get_isEmpty()&&this._paragraphWithIpFormatting.get_characterProperties().removeAt(t))}}finally{e&&e.dispose()}this._paragraphWithIpFormatting=null}},e.prototype.contextHasIpFormatting=function(e){var t=e,n=t.get_node();if(t.get_cpBegin()!==t.get_cpEnd())return!1;var i=n.get_characterProperties().getChpAtCp(t.get_cpBegin());return!!i&&i.get_isIpFormatting()},e.prototype.applyIpFormattingToContext=function(e){if(this.get_textFormattingCommands()){this.freeze();var t=new Ma.GraphTransaction(7);t.setFromNode(e.get_node()),this.get_textFormattingCommands().setFormattingFromIp(e),this.thaw(),this.resetFormatting(),t.dispose()}},e.prototype.getSelectionForIpFormatting=function(e){var t=e.get_node(),n=Ga.ParagraphReader.text(t);if(!e.get_cpBegin()||e.get_cpBegin()===n.length)return null;if(Rn.l.isWhitespace(n.charCodeAt(e.get_cpBegin())))return null;if(_f.i.get_instance().getForwardBreakByWord(n,e.get_cpBegin()-1)===e.get_cpBegin())return null;if(!ga.SelectionEditor.isSelectionExpandableToWord(e))return null;var i=ga.SelectionEditor.expandSelectionToWordBoundary(e,!1);return i&&(i.get_length()>1||ga.SelectionEditor.isTextRangeContext(i.get_firstContext()))?i:null},e.get_NoProofProperty=function(){return Gl.n.get_instance().get_item(20)?os.j.noProof:Pl.k.noProofBox4},e._formattingEditor=null,e}();(0,o.l)(yf,"bd1ea3e5$InsertionPointFormatting",null,[Fg.c]);var Cf=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.get_ActionManager=function(){return this._actionManager},e.prototype.bullets=function(e,t){var n=new Dl.DictionaryPropertySet;return n.setValue(Pl.k.listSoftType,e),n.setValue(Pl.k.listSoftStyle,t),32===this.get_ActionManager().processActionWithData(Oi.u.toggleBulletsList,2,n)},e.prototype.numbering=function(e,t,n){var i=new Dl.DictionaryPropertySet;return i.setValue(Pl.k.listSoftType,e),i.setValue(Pl.k.listSoftStyle,t),i.setValue(Pl.k.listLastStartAt,n),32===this.get_ActionManager().processActionWithData(Oi.u.toggleNumberedList,2,i)},e}();(0,o.l)(Cf,"24983237$ListCommands",null,[Ig.c]);var Sf=(0,o.y)("bf6ae59a$IProofingWholeDocumentCallbacks"),bf=function(){function e(e){this._selectionEditor=null,this._selectionEditor=e}return e.prototype.checkExecutionIsEnabled=function(e,t){var n=(0,y.e)(yh.k,e);return!!n&&!!n.view&&n.view.get_isInteractiveView()},e.prototype.setupCallback=function(e,t,n){return!0},e.prototype.processCurrentParagraphAtBeginningCallback=function(e,t){return!0},e.prototype.processOtherParagraphCallback=function(e,t){return!0},e.prototype.processCurrentParagraphAtEndCallback=function(e,t){},e.prototype.teardownCallback=function(e,t){return!0},e.prototype.spellErrorFilter=function(e,t){if(e.get_isAtOrigin())return!0;var n=e.get_role();return 1===n||2===n||3===n||4===n||5===n},e.prototype.getProofingWholeDocumentRootNode=function(e){if(!e||!this._selectionEditor)return e;var t=new r_.z;if(t.set(e),this._selectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(t)){for(;!t.get_isAtOrigin();)t.returnToParent();return t.get_currentNode()}return e},e}();(0,o.l)(bf,"d200965d$SimpleProofingWholeDocumentCallBacks",null,[Sf]);var vf=function(){return function(e){this.value=!1,this.value=e}}();(0,o.l)(vf,"56e6229a$RefBool",null,[]);var Tf=function(){return function(){this.NextError=null,this.ErrorNode=null,this.UncheckedRanges=new vf(!1)}}();(0,o.l)(Tf,"46258273$FindNextErrorOperationParam",null,[]);var Af=function(e){function t(t,n){var i=e.call(this,n)||this;return i._errorRangeEditor=null,i._errorRangeEditor=t,i}return(0,v.t)(t,e),t.prototype.processCurrentParagraphAtBeginningCallback=function(e,t){return!this.LocateNextErrorInParagraph(e.get_node(),e.get_cpBegin(),t)},t.prototype.processOtherParagraphCallback=function(e,t){return!this.LocateNextErrorInParagraph(e,0,t)},t.prototype.processCurrentParagraphAtEndCallback=function(e,t){this.LocateNextErrorInParagraph(e.get_node(),0,t);(0,y.e)(Tf,t)},t.prototype.LocateNextErrorInParagraph=function(e,t,n){var i=(0,y.e)(Tf,n);if(Ga.ParagraphReader.isParagraphNode(e)&&!e.get_isBlockContent())if(vc.FormattingReader.getFormattingObject(Wa.y.createIpContext(e,t)).get_cache().get_isNoProof())i.UncheckedRanges.value=!0;else for(var r=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SkipIgnoredProofingErrorsFromRibbon"),o=this._errorRangeEditor.getErrorRanges(e),a=0;a<o.length;a++){var l=o[a],s=r&&l.errorDetails.isIgnored();if(l.get_begin()>=t&&!s)return i.NextError=l,i.ErrorNode=e,!0}return!1},t}(bf);(0,o.l)(Af,"8b57ae13$FindNextErrorCallbackSteps",bf,[]);var If=function(e){function t(t,n,i,r,o,a,l,s,u,c,d){var g=e.call(this)||this;return g._context=null,g._selectionManager=null,g._selectionEditor=null,g._operationStage=0,g._proofingWholeDocCallbacks=null,g._currentIpContext=null,g._traverser=null,g._proofingWholeDocumentRootNode=null,g.init(t),g.setDebugName(d),g.initAction(s,n,r,o,a),g._actionData=a,g._context=i,g._selectionManager=u,g._selectionEditor=c,g._proofingWholeDocCallbacks=l,g._operationStage=0,g}return(0,v.t)(t,e),t.prototype.run=function(){this.checkExecutionIsEnabled(),this._operationStage||this.setupStage(),1===this._operationStage&&this.processStage(),2===this._operationStage&&this.teardownStage(),3===this._operationStage&&this.finishedStage()},t.prototype.checkExecutionIsEnabled=function(){if(!this._selectionManager.get_selectionCollection()||!this._selectionManager.get_selectionCollection().get_currentSelection())return S.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.set_response(2),void(this._operationStage=3);1===this.get_behavior()&&(this._proofingWholeDocCallbacks.checkExecutionIsEnabled(this._context,this._actionData)?this.set_response(32):this.set_response(2),this._operationStage=3)},t.prototype.setupStage=function(){this.buildProofingContext(),this._proofingWholeDocCallbacks.setupCallback(this,this._currentIpContext,this._actionData)?(this.buildHereToEndTraverser(),this._operationStage=1):(this.set_response(8),this._operationStage=3)},t.prototype.processStage=function(){this.get_childOperation()||new vp.a(this,o.i(this,this.processCurrentNodeAtBegin,"processCurrentNodeAtBegin"),this._actionData);do{if(this.get_childOperation().run(),this.get_childOperation().get_inProgress()&&!this.get_isSynchronous())return}while(this.get_childOperation().get_inProgress());this.clearChildOperation(),this._operationStage=2},t.prototype.teardownStage=function(){this._proofingWholeDocCallbacks.teardownCallback(this,this._actionData)?this.set_response(32):this.set_response(8),this._operationStage=3},t.prototype.finishedStage=function(){this.setIsCompleted()},t.prototype.processCurrentNodeAtBegin=function(e,t){var n=this._proofingWholeDocCallbacks.processCurrentParagraphAtBeginningCallback(this._currentIpContext,t);return e.changeStepCallback(o.i(this,this.fromHereToEnd,"fromHereToEnd")),n},t.prototype.fromHereToEnd=function(e,t){if(this._traverser.moveNext()){var n=this._traverser.get_currentNode();return 12!==n.get_type()||(n===this._currentIpContext.get_node()||this._proofingWholeDocCallbacks.processOtherParagraphCallback(n,t))}return this.buildStartToHereTraverser(),e.changeStepCallback(o.i(this,this.fromStartToHere,"fromStartToHere")),!0},t.prototype.fromStartToHere=function(e,t){if(this._traverser.moveNext()){var n=this._traverser.get_currentNode();return 12!==n.get_type()||(n===this._currentIpContext.get_node()?(e.changeStepCallback(o.i(this,this.processCurrentNodeAtEnd,"processCurrentNodeAtEnd")),!0):this._proofingWholeDocCallbacks.processOtherParagraphCallback(n,t))}return!1},t.prototype.processCurrentNodeAtEnd=function(e,t){return this._proofingWholeDocCallbacks.processCurrentParagraphAtEndCallback(this._currentIpContext,t),!1},t.prototype.buildProofingContext=function(){var e=this._selectionManager.get_selectionCollection().get_currentSelection();(e=this._selectionEditor.collapseToIp(e,!0,!1))&&(this._currentIpContext=e.get_firstContext()),this._currentIpContext&&this._currentIpContext.get_node()&&(this._proofingWholeDocumentRootNode=this._proofingWholeDocCallbacks.getProofingWholeDocumentRootNode(this._currentIpContext.get_node()))},t.prototype.buildHereToEndTraverser=function(){if(!this._proofingWholeDocumentRootNode)throw Error.argumentNull("_proofingWholeDocumentRootNode");var e=new r_.z;e.set(this._currentIpContext.get_node()),e.tryToRootAtAncestorOfType(this._proofingWholeDocumentRootNode.get_type()),this._traverser=nm.p.createPartialTraverser(e,this._proofingWholeDocumentRootNode),this._traverser.setFilter(o.i(this._proofingWholeDocCallbacks,this._proofingWholeDocCallbacks.spellErrorFilter,"spellErrorFilter"),null)},t.prototype.buildStartToHereTraverser=function(){if(!this._proofingWholeDocumentRootNode)throw Error.argumentNull("_proofingWholeDocumentRootNode");var e=new r_.z;e.set(this._proofingWholeDocumentRootNode),this._traverser=nm.p.createTraverserFromIterator(e),this._traverser.setFilter(o.i(this._proofingWholeDocCallbacks,this._proofingWholeDocCallbacks.spellErrorFilter,"spellErrorFilter"),null)},t}(mh.g);(0,o.l)(If,"bb27a0bc$ProofingWholeDocumentOperation",mh.g,[]);var wf=n(8797),xf=function(){function e(e,t,n,i,r,o,a,l,s,u,c,d,g,p,h){this._selectionContextMenuProvider=null,this._characterPropertiesEditor=null,this._lockedRangeEditor=null,this._acceptedCritiqueActionIds=null,this._rejectedCritiqueActionIds=null,this._activityManager=null,this._languageDialogFactory=null,this._actionManager=null,this._errorRangeEditor=null,this._graphTransactionFactory=null,this._selectionManager=null,this._externalSelectionManagerFuture=null,this._selectionEditor=null,this._contextMenuController=null,this._proofingErrorPresenterFuture=null,this._appFeaturesLookup=null,this._isProofingSecondaryContextualMenuEnabled=!1,this._actionManager=t,this._errorRangeEditor=e,this._languageDialogFactory=n,this._characterPropertiesEditor=i,this._graphTransactionFactory=r,this._selectionManager=o,this._externalSelectionManagerFuture=a,this._selectionEditor=l,this._selectionContextMenuProvider=s,this._lockedRangeEditor=u,this._activityManager=c,this._contextMenuController=(0,y.e)(Xu,d),this._isProofingSecondaryContextualMenuEnabled=g.get_isProofingSecondaryContextualMenuEnabled(),this._proofingErrorPresenterFuture=p,this._appFeaturesLookup=h,this._acceptedCritiqueActionIds=new ec.n(rc.t,Number),this._acceptedCritiqueActionIds.set_item(1,Oi.u.spellingCritiqueAccepted),this._acceptedCritiqueActionIds.set_item(2,Oi.u.grammarCritiqueAccepted),this._acceptedCritiqueActionIds.set_item(3,Oi.u.styleCritiqueAccepted),this._rejectedCritiqueActionIds=new ec.n(rc.t,Number),this._rejectedCritiqueActionIds.set_item(1,Oi.u.spellingCritiqueRejected),this._rejectedCritiqueActionIds.set_item(2,Oi.u.grammarCritiqueRejected),this._rejectedCritiqueActionIds.set_item(3,Oi.u.styleCritiqueRejected)}return e.prototype.RegisterActions=function(){var e=this._actionManager,t=o.i(this,this.CorrectError,"CorrectError"),n=o.i(this,this.CollapseIp,"CollapseIp");e.addActionWithFlags(Oi.u.openLanguageDialog,ol.d.view,o.i(this,this.OpenLanguageDialogView,"OpenLanguageDialogView"),4),e.addAction(Oi.u.deleteRepeatedWord,ol.d.insertionPoint,o.i(this,this.DeleteRepeatedWord,"DeleteRepeatedWord")),e.addAction(Oi.u.ignoreSpellingError,ol.d.insertionPoint,o.i(this,this.IgnoreSpellingError,"IgnoreSpellingError")),e.addAction(Oi.u.takeSuggestedCorrection0,ol.d.insertionPoint,t),e.addAction(Oi.u.takeSuggestedCorrection1,ol.d.insertionPoint,t),e.addAction(Oi.u.takeSuggestedCorrection2,ol.d.insertionPoint,t),e.addAction(Oi.u.takeSuggestedCorrection3,ol.d.insertionPoint,t),e.addAction(Oi.u.takeSuggestedCorrection4,ol.d.insertionPoint,t),e.addAction(Oi.u.deleteRepeatedWord,ol.d.view,n),e.addAction(Oi.u.ignoreSpellingError,ol.d.view,n),e.addAction(Oi.u.takeSuggestedCorrection0,ol.d.view,n),e.addAction(Oi.u.takeSuggestedCorrection1,ol.d.view,n),e.addAction(Oi.u.takeSuggestedCorrection2,ol.d.view,n),e.addAction(Oi.u.takeSuggestedCorrection3,ol.d.view,n),e.addAction(Oi.u.takeSuggestedCorrection4,ol.d.view,n),e.setActionFlags(Oi.u.deleteRepeatedWord,4),e.setActionFlags(Oi.u.ignoreSpellingError,4),e.setActionFlags(Oi.u.takeSuggestedCorrection0,4),e.setActionFlags(Oi.u.takeSuggestedCorrection1,4),e.setActionFlags(Oi.u.takeSuggestedCorrection2,4),e.setActionFlags(Oi.u.takeSuggestedCorrection3,4),e.setActionFlags(Oi.u.takeSuggestedCorrection4,4),e.addAction(Oi.u.takeSuggestedCorrection,Ue.m.frame,Le.ActionManager.doNothingButReportHandler),this._isProofingSecondaryContextualMenuEnabled&&e.addActionWithFlags(Oi.u.populateProofingSecondaryMenu,ol.d.view,o.i(this,this.PopulateProofingSecondaryMenu,"PopulateProofingSecondaryMenu"),100),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordEditorIdeasIsEnabled")&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordEditorIdeasCardsIsEnabled")||e.addActionWithFlags(Oi.u.nextSpellingError,ol.d.view,o.i(this,this.FindNextProofingError,"FindNextProofingError"),4),this.RegisterLoggingActions([Oi.u.spellingCritiqueSeen,Oi.u.spellingCritiqueAccepted,Oi.u.spellingCritiqueRejected,Oi.u.grammarCritiqueSeen,Oi.u.grammarCritiqueAccepted,Oi.u.grammarCritiqueRejected,Oi.u.styleCritiqueSeen,Oi.u.styleCritiqueAccepted,Oi.u.styleCritiqueRejected])},e.prototype.RegisterLoggingActions=function(e){for(var t=0;t<e.length;t++)this._actionManager.addActionWithFlags(e[t],ol.d.view,Le.ActionManager.doNothingHandler,4)},e.prototype.CollapseIp=function(e,t,n,i,r){var o=this._selectionManager.get_selectionCollection().get_currentSelection();if(!o)return this._activityManager.recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),2;var a=this._selectionEditor.collapseToIp(o,!0,!1);return this._actionManager.processActionAgainstContext(a.get_firstContext(),e,n,!1,i,r)},e.prototype.OpenLanguageDialogView=function(e,t,n,i,r){return 1===n?this._actionManager.processAction(Oi.u.setLanguage,1):(this._languageDialogFactory().showLanguageDialog(),32)},e.prototype.TryHandleUnexpectedStates=function(e){return e?!e.errorDetails&&(S.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this._activityManager.recordEvent(ah.f.failedResult,{Reason:"ErrorRangeMissingErrorDetails"}),Dr.t.mark(4671),!0):(S.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this._activityManager.recordEvent(ah.f.failedResult,{Reason:"RequestedErrorRangeNotFound"}),Dr.t.mark(4671),!0)},e.prototype.DeleteRepeatedWord=function(e,t,n,i,r){if(1===n)return 32;Dr.t.mark(4670);var o=this._errorRangeEditor.getErrorAtContext(t);if(this.TryHandleUnexpectedStates(o))return 8;var a=t.get_node(),l=this._graphTransactionFactory.getTransaction(15),s=o.get_begin();" "===Ga.ParagraphReader.text(a).charAt(s-1)&&s--,l.setFromNode(a);var u=this._characterPropertiesEditor.replaceTextRange(Wa.y.createTextRange(a,o.get_begin()>0?o.get_begin()-1:0,o.get_end()),"",!0,!1);return this._selectionManager.setSelection(Ua.SelectionFactory.createIpSelection(a,u+s)),l.dispose(),o.errorDetails.traceUserAction(e),Dr.t.mark(4671),32},e.prototype.LogRejectedSuggestion=function(e){var t;this._rejectedCritiqueActionIds.tryGetValue(e.errorDetails.get_proofingType(),(0,g.m)((function(){return t}),(function(e){return t=e})))&&this._actionManager.processAction(t,2)},e.prototype.IgnoreSpellingError=function(e,t,n,i,r){if(1===n)return 32;S.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred"),Dr.t.mark(4670);var o=this._errorRangeEditor.getErrorAtContext(t);if(this.TryHandleUnexpectedStates(o))return 8;var a=t.get_node(),l=this._graphTransactionFactory.getTransaction(15);return l.setFromNode(a),this._errorRangeEditor.removeErrorRanges(a,[o],!0),a.setValue(is.b.containsIgnoredSpellingError,!0),l.dispose(),o.errorDetails.traceUserAction(e,1),Dr.t.mark(4671),S.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded"),this.LogRejectedSuggestion(o),32},e.prototype.GetCorrectionIndex=function(e){switch(e){case Oi.u.takeSuggestedCorrection0:return 0;case Oi.u.takeSuggestedCorrection1:return 1;case Oi.u.takeSuggestedCorrection2:return 2;case Oi.u.takeSuggestedCorrection3:return 3;case Oi.u.takeSuggestedCorrection4:return 4;default:return-1}},e.prototype.LogAcceptedSuggestion=function(e){var t;this._acceptedCritiqueActionIds.tryGetValue(e.errorDetails.get_proofingType(),(0,g.m)((function(){return t}),(function(e){return t=e})))&&this._actionManager.processAction(t,2)},e.prototype.CorrectError=function(e,t,n,i,r){var o=!0,a=t;if(this._appFeaturesLookup.get_item(14)&&(o=!this._lockedRangeEditor.isIpOrTextRangeContextInLockedRange(a)),this._externalSelectionManagerFuture&&this._externalSelectionManagerFuture.get_instance()&&this._externalSelectionManagerFuture.get_instance().isExternalSelectionContext(a)&&(o=!1),1===n||!o)return o?32:8;this._actionManager.processAction(Oi.u.takeSuggestedCorrection,2),Dr.t.mark(4670);var l=this.GetCorrectionIndex(e);if(l<0)return 8;var s=this._errorRangeEditor.getErrorAtContext(t);if(this.TryHandleUnexpectedStates(s))return 8;var u=t.get_node(),c=s.errorDetails.get_suggestions();if(!c)return this._activityManager.recordEvent(ah.f.failedResult,{Reason:"NoSuggestionsFound"}),Dr.t.mark(4671),8;var d=l<c.length?c[l]:null;if(!d)return this._activityManager.recordEvent(ah.f.failedResult,{Reason:"RequestedSuggestionIsNull"}),Dr.t.mark(4671),8;this._appFeaturesLookup.get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()&&yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(u),d=d.replace("  "," \xa0");var g=this._graphTransactionFactory.getTransaction(15);g.setFromNode(u);var p=this._characterPropertiesEditor.replaceTextRange(Wa.y.createTextRange(u,s.get_begin(),s.get_end()),d,!0,!1,Oi.u.takeSuggestedCorrection);return this._selectionManager.setSelection(Ua.SelectionFactory.createIpSelection(u,s.get_begin()+d.length+p)),g.dispose(),s.errorDetails.traceUserAction(e),Dr.t.mark(4671),this.LogAcceptedSuggestion(s),32},e.prototype.ScrollSelectionIntoViewAndShowContextMenu=function(e,t,n,i){e.scrollSelectionIntoView();var r=n.getHtmlViewElement(e.get_viewId());if(r){var o=L.AFrameworkApplication.get_isRtl()?i.get_begin():i.get_end(),a=wf.n.boundsFromCp(r,o);this._selectionContextMenuProvider.showContextMenuForSelection(new Sys.UI.Point(a.x,a.y+a.height),t)}else S.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")},e.prototype.FindNextProofingError=function(e,t,n,i,r){var o=this;if(!t.view.get_isInteractiveView())return 2;var a=t.view;if(!this._selectionManager.get_selectionCollection().get_currentSelection())return this._activityManager.recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),2;if(1===n)return 32;var l=new Tf,s=new Af(this._errorRangeEditor,this._selectionEditor),u=new If(null,e,t,n,i,l,s,this._actionManager,this._selectionManager,this._selectionEditor,null);if(u.set_isSynchronous(!0),u.run(),u.get_isCompleted()&&l.NextError){var c=Ua.SelectionFactory.createIpSelection(l.ErrorNode,l.NextError.get_begin()),d=Ua.SelectionFactory.extendSelection(c,Wa.y.createIpContext(l.ErrorNode,l.NextError.get_end()));if(!this._proofingErrorPresenterFuture.get_instance()||!this._proofingErrorPresenterFuture.get_instance().presentProofingError(l.NextError,d,a)){this._selectionManager.setSelection(d);var g=0;r&&(g=r.inputMethod),a.shouldScrollSelectionIntoView=!1,Ce.y.get_instance().addTask(new ge.c(1,1,1,(function(){o.ScrollSelectionIntoViewAndShowContextMenu(a,g,l.ErrorNode,l.NextError)})))}}else{var p=new Vn.StandardDialog;p.set_buttonsOption(0),yi.App.theProofingManager.get_isSpellingComplete()?p.showInformation(CommonUIStrings.l_DefaultDialogTitle,l.UncheckedRanges.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(p.showInformation(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),yi.App.theProofingManager.addProofingCompletedCallback((function(){p.get_isShowing()&&(p.hide(),o._actionManager.processAction(e,2))}),!1))}return 32},e.prototype.PopulateProofingSecondaryMenu=function(e,t,n,i,r){if(1===n)return 32;if(this._contextMenuController&&this._contextMenuController.get_theRoot()){var o=this._contextMenuController.get_theRoot().getValidControl(ic.proofingSection);o&&!o.menuLaunched&&(o.launchMenu(0),o.get_menu().focusNext(0))}return 32},e}();(0,o.l)(xf,"5de9f60e$ProofingActor",null,[]);var Ef=n(6591),Ff=n(5990),Pf=function(){function e(){}return e.get_styleFormattingAttrs=function(){return e.styleFormattingAttrsArray||(e.styleFormattingAttrsArray=new Array(e.StyleFormattingAttrsArraySize),e.styleFormattingAttrsArray[0]=is.b.fontColor,e.styleFormattingAttrsArray[1]=rs.o.shading,e.styleFormattingAttrsArray[2]=is.b.languageID,e.styleFormattingAttrsArray[3]=is.b.underline,e.styleFormattingAttrsArray[4]=is.b.underlineType,e.styleFormattingAttrsArray[5]=rs.o.doubleStrikethrough,e.styleFormattingAttrsArray[6]=is.b.font,e.styleFormattingAttrsArray[7]=is.b.fontSize,e.styleFormattingAttrsArray[8]=is.b.superscript,e.styleFormattingAttrsArray[9]=is.b.subscript,e.styleFormattingAttrsArray[10]=is.b.isHidden,e.styleFormattingAttrsArray[11]=os.j.noProof,e.styleFormattingAttrsArray[12]=Pl.k.noProofBox4,e.styleFormattingAttrsArray[13]=rs.o.capitalization,e.styleFormattingAttrsArray[14]=is.b.bold,e.styleFormattingAttrsArray[15]=is.b.italic,e.styleFormattingAttrsArray[16]=is.b.underline),e.styleFormattingAttrsArray},e.get_paragraphStyleAttrs=function(){return e.paragraphStyleAttrsArray||(e.paragraphStyleAttrsArray=new Array(e.ParagraphStyleAttrsArraySize),e.paragraphStyleAttrsArray[0]=rs.o.paragraphStyle,e.paragraphStyleAttrsArray[1]=rs.o.paragraphStyleId),e.paragraphStyleAttrsArray},e.get_paragraphListAttrs=function(){return e.paragraphListAttrsArray||(e.paragraphListAttrsArray=new Array(e.ParagraphListAttrsArraySize),e.paragraphListAttrsArray[0]=os.j.listID,e.paragraphListAttrsArray[1]=os.j.listLevel),e.paragraphListAttrsArray},e.get_paragraphFormattingAttrs=function(){return e.paragraphFormattingAttrsArray||(e.paragraphFormattingAttrsArray=new Array(e.ParagraphFormattingAttrsArraySize),e.paragraphFormattingAttrsArray[0]=os.j.paraIndentFirstLine,e.paragraphFormattingAttrsArray[1]=os.j.paraIndentFirstLineChars,e.paragraphFormattingAttrsArray[2]=os.j.paraIndentLeft,e.paragraphFormattingAttrsArray[3]=os.j.paraIndentLeftChars,e.paragraphFormattingAttrsArray[4]=os.j.paraIndentRight,e.paragraphFormattingAttrsArray[5]=os.j.paraIndentRightChars,e.paragraphFormattingAttrsArray[6]=os.j.paraIndentHanging,e.paragraphFormattingAttrsArray[7]=os.j.paraIndentHangingChars,e.paragraphFormattingAttrsArray[8]=rs.o.paragraphSpaceBefore,e.paragraphFormattingAttrsArray[9]=rs.o.paragraphSpaceAfter,e.paragraphFormattingAttrsArray[10]=os.j.paraSpacingBefore,e.paragraphFormattingAttrsArray[11]=os.j.paraSpacingAfter,e.paragraphFormattingAttrsArray[12]=os.j.lineSpacingRule,e.paragraphFormattingAttrsArray[13]=os.j.lineSpacingValue,e.paragraphFormattingAttrsArray[14]=os.j.paragraphSpaceBeforeAuto,e.paragraphFormattingAttrsArray[15]=os.j.paragraphSpaceAfterAuto,e.paragraphFormattingAttrsArray[16]=os.j.paraSpacingBeforeLines,e.paragraphFormattingAttrsArray[17]=os.j.paraSpacingAfterLines,e.paragraphFormattingAttrsArray[18]=is.b.layoutAlignmentInParent,e.paragraphFormattingAttrsArray[19]=is.b.layoutAlignmentSelf,e.paragraphFormattingAttrsArray[20]=rs.o.readingOrderRTL,e.paragraphFormattingAttrsArray[21]=is.b.outlineElementRTL),e.paragraphFormattingAttrsArray},e.StyleFormattingAttrsArraySize=17,e.ParagraphFormattingAttrsArraySize=22,e.ParagraphStyleAttrsArraySize=2,e.ParagraphListAttrsArraySize=2,e.styleFormattingAttrsArray=null,e.paragraphFormattingAttrsArray=null,e.paragraphStyleAttrsArray=null,e.paragraphListAttrsArray=null,e}();(0,o.l)(Pf,"f841a302$StyleConstants",null,[]);var Df=function(){function e(){}return e.get_PropertySetComparer=function(){return e._comparer||(e._comparer=new Ff.h)},e.isSelectedStyleIsDifferentFromSelection=function(t,n){if(!t||!t.get_node()||!n)return!1;var i=vc.FormattingReader.getFormattingObject(t),r=i?i.get_formattingContainer():null;if(e.IsFormattingAndStyleAttributesDifferent(r,n,Pf.get_styleFormattingAttrs()))return S.ULS.sendTraceTag(51218398,324,50,"Difference in formatting attributes b/w text selection and style"),!0;var o=t.get_node().getCurrentFormatProperties();return!!e.IsFormattingAndStyleAttributesDifferent(o,n,Pf.get_paragraphFormattingAttrs())&&(S.ULS.sendTraceTag(51218399,324,50,"Difference in paragraph attributes b/w text selection and style"),!0)},e.IsFormattingAndStyleAttributesDifferent=function(t,n,i){var r=!1;if(t)for(var o=0,a=i;o<a.length;o++){var l=a[o];r=!!t.hasProperty(l)&&(!n.hasProperty(l)||!e.get_PropertySetComparer().compare(t,n,l))||r}return r},e._comparer=null,e}();(0,o.l)(Df,"1fbdee38$StyleUtils",null,[]);var Rf=function(){function e(e,t,n,i,r,o,a,l,s,u){this.StyleShortcuts=null,this._characterPropertiesEditor=null,this._styleEditor=null,this._styleReader=null,this._formattingEditor=null,this._contextSetEditor=null,this._insertionPointFormatting=null,this._lockedRangeEditor=null,this._activityManager=null,this._textFormattingHelper=null,this._viewActionHandler=null,this._isHighlightStyleWhenDifferentFromSelectionEnabled=null,this._characterPropertiesEditor=e,this._styleEditor=t,this._styleReader=n,this._formattingEditor=i,this._contextSetEditor=r,this._insertionPointFormatting=o,this._lockedRangeEditor=a,this._activityManager=l,this._textFormattingHelper=s,this._viewActionHandler=u}return e.prototype.get_CharacterPropertiesEditor=function(){return this._characterPropertiesEditor},e.prototype.get_StyleEditor=function(){return this._styleEditor},e.prototype.get_StyleReader=function(){return this._styleReader},e.prototype.get_ContextSetEditor=function(){return this._contextSetEditor},e.prototype.get_InsertionPointFormatting=function(){return this._insertionPointFormatting},e.prototype.get_FormattingEditor=function(){return this._formattingEditor},e.prototype.get_LockedRangeEditor=function(){return this._lockedRangeEditor},e.prototype.get_ActivityManager=function(){return this._activityManager},e.prototype.get_TextFormattingHelper=function(){return this._textFormattingHelper},e.prototype.get_ViewActionHandler=function(){return this._viewActionHandler},e.prototype.get_IsHighlightStyleWhenDifferentFromSelectionEnabled=function(){return null==this._isHighlightStyleWhenDifferentFromSelectionEnabled&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordHighlightStyleWhenDifferentFromSelectionSettings"),L.AFrameworkApplication.appSettingsManager?this._isHighlightStyleWhenDifferentFromSelectionEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HighlightStyleWhenDifferentFromSelectionIsEnabled"):this._isHighlightStyleWhenDifferentFromSelectionEnabled=!1),this._isHighlightStyleWhenDifferentFromSelectionEnabled},e.prototype.RegisterActions=function(){var t=L.AFrameworkApplication.get_theActionManager(),n=yi.App.theContextSetActor.createDelegatedViewHandlerForNodeType(12);Gl.n.get_instance().get_item(61)&&(t.addAction(Oi.u.applyStyle,ol.d.textRange,o.i(this,this.ApplyStyleToTextRange,"ApplyStyleToTextRange")),t.addAction(Oi.u.queryStyle,ol.d.textRange,o.i(this,this.QueryStyleTextRange,"QueryStyleTextRange")),t.addAction(Oi.u.applyStyle,ol.d.insertionPoint,o.i(this,this.ApplyStyleToIp,"ApplyStyleToIp")),t.addAction(Oi.u.queryStyle,ol.d.insertionPoint,o.i(this,this.QueryStyleIp,"QueryStyleIp"))),t.addAction(Oi.u.applyStyle,ol.d.paragraph,o.i(this,this.ApplyStyleToParagraph,"ApplyStyleToParagraph")),t.addAction(Oi.u.applyStyle,ol.d.view,o.i(this,this.ApplyStyleView,"ApplyStyleView")),t.setActionFlags(Oi.u.applyStyle,12),t.addAction(Oi.u.queryStyle,ol.d.view,o.i(this,this.QueryStyleView,"QueryStyleView")),t.addAction(Oi.u.queryStyle,ol.d.paragraph,o.i(this,this.QueryStyleParagraph,"QueryStyleParagraph")),t.setActionFlags(Oi.u.queryStyle,99|(Gl.n.get_instance().get_item(7)?0:4)),t.addAction(Oi.u.populateMenuMoreStyles,ol.d.view,n),t.addAction(Oi.u.populateMenuMoreStyles,ol.d.paragraph,o.i(this,this.PopulateMenuMoreStyles,"PopulateMenuMoreStyles")),t.setActionFlags(Oi.u.populateMenuMoreStyles,103),t.addActionWithFlags(Oi.u.applyStyleShortcut0,ol.d.view,o.i(this,this.ApplyStyleShortcut,"ApplyStyleShortcut"),4),t.addActionWithFlags(Oi.u.applyStyleShortcut1,ol.d.view,o.i(this,this.ApplyStyleShortcut,"ApplyStyleShortcut"),4),t.addActionWithFlags(Oi.u.applyStyleShortcut2,ol.d.view,o.i(this,this.ApplyStyleShortcut,"ApplyStyleShortcut"),4),t.addActionWithFlags(Oi.u.applyStyleShortcut3,ol.d.view,o.i(this,this.ApplyStyleShortcut,"ApplyStyleShortcut"),4),t.addActionWithFlags(Oi.u.applyStyleShortcut4,ol.d.view,o.i(this,this.ApplyStyleShortcut,"ApplyStyleShortcut"),4),t.addActionWithFlags(Oi.u.applyStyleShortcut5,ol.d.view,o.i(this,this.ApplyStyleShortcut,"ApplyStyleShortcut"),4),t.addActionWithFlags(Oi.u.applyStyleShortcut6,ol.d.view,o.i(this,this.ApplyStyleShortcut,"ApplyStyleShortcut"),4),t.addActionWithFlags(Oi.u.applyStyleShortcut7,ol.d.view,o.i(this,this.ApplyStyleShortcut,"ApplyStyleShortcut"),4),t.addActionWithFlags(Oi.u.applyStyleShortcut8,ol.d.view,o.i(this,this.ApplyStyleShortcut,"ApplyStyleShortcut"),4),t.addActionWithFlags(Oi.u.applyStyleShortcut9,ol.d.view,o.i(this,this.ApplyStyleShortcut,"ApplyStyleShortcut"),4),this.StyleShortcuts=new Array(e.ShortcutCount),this.get_StyleReader().setStyleActorDefaultStyleShortcuts(this.StyleShortcuts)},e.prototype.GetStyleCommandIndex=function(e){switch(e){case Oi.u.applyStyleShortcut0:return 0;case Oi.u.applyStyleShortcut1:return 1;case Oi.u.applyStyleShortcut2:return 2;case Oi.u.applyStyleShortcut3:return 3;case Oi.u.applyStyleShortcut4:return 4;case Oi.u.applyStyleShortcut5:return 5;case Oi.u.applyStyleShortcut6:return 6;case Oi.u.applyStyleShortcut7:return 7;case Oi.u.applyStyleShortcut8:return 8;case Oi.u.applyStyleShortcut9:return 9;default:return-1}},e.prototype.ApplyStyleShortcut=function(e,t,n,i,r){var o,a=this.GetStyleCommandIndex(e);return a<0||a>this.StyleShortcuts.length?2:(o=this.StyleShortcuts[a])?L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(t,Oi.u.applyStyle,n,!0,i,o):2},e.prototype.PopulateMenuMoreStyles=function(e,t,n,i,r){var o=!0;if(t.get_contextId()!==ol.d.paragraph&&t.get_contextId()!==ol.d.textRange&&t.get_contextId()!==ol.d.insertionPoint&&(o=!1),1===n||!o)return o?32:8;if(2===n&&!r)return 8;var a=t.get_node(),l=r,s=this.get_StyleReader().getStyleSetFromParagraphNode(a),u=Gl.n.get_instance().get_item(61);return L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&(l.MenuItems=Ef.StylePreviewGenerator.getMoreStylesMenuProps(s,u)),l.PopulationXML=Ef.StylePreviewGenerator.generateMoreStylesMenuXml(s,u),32},e.prototype.QueryStyleParagraph=function(e,t,n,i,r){var o=!0;if(t.get_contextId()!==ol.d.paragraph&&(o=!1),1===n&&!o)return 8;var a=t.get_node(),l=this.get_StyleReader().getStyleFromParagraphNode(a);return l&&r?(r.styleProperties.copyProperties(l),this.get_IsHighlightStyleWhenDifferentFromSelectionEnabled()&&(r.isHighlightedStyleDiffFromSelection=Df.isSelectedStyleIsDifferentFromSelection(t,l)),32):(S.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",r,a,l),8)},e.prototype.ApplyStyleToParagraph=function(e,t,n,i,r){if(t.get_contextId()!==ol.d.paragraph)return 8;if(Gl.n.get_instance().get_item(14)&&this.get_LockedRangeEditor().isParaStartOrEndInLockedRange(t))return this.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),8;if(1===n)return 32;var o=t.get_node(),a=r;if(!a)return 8;var l=this.GetStyleToApplyFromStyleId(a,o);if(!l)return this.get_ActivityManager().recordEvent(ah.f.unexpectedState,{Reason:lh.i.failedToFindStyle}),8;if(2!==this.get_StyleReader().getStyleTargetType(l))return 2;var s=new Ma.GraphTransaction(15);s.setFromNode(o),this.get_InsertionPointFormatting().resetFormatting(),this.get_StyleEditor().setStyleOnParagraphNode(l,o,!1),s.dispose();var u=Rn.l.calcHashCode(a),c=u>>>16^65535&u;return i.dataValue1=c,32},e.prototype.QueryStyleTextRange=function(e,t,n,i,r){var o=!0;if(t.get_contextId()!==ol.d.textRange&&(o=!1),1===n&&!o)return 2;var a=t,l=a.get_node(),s=vc.FormattingReader.getFormattingObject(a),u=vc.FormattingReader.getCharacterStyleContainer(s);if(this.get_IsHighlightStyleWhenDifferentFromSelectionEnabled()){if(!r||!l)return S.ULS.sendTraceTag(51218393,324,10,"actionData : {}, graphNode : {}",r,l),8;if(!(u=u||this.get_StyleReader().getStyleFromParagraphNode(l)))return S.ULS.sendTraceTag(51218394,324,10,"No paragraph style for Text range context is found"),2;r.isHighlightedStyleDiffFromSelection=Df.isSelectedStyleIsDifferentFromSelection(t,u)}else{if(!u)return 2;if(!r)return 8}return r.styleProperties.copyProperties(u),32},e.prototype.ApplyStyleToTextRange=function(e,t,n,i,r){var o=this;if(t.get_contextId()!==ol.d.textRange)return 8;if(!Gl.n.get_instance().get_item(61))return 8;if(this.get_LockedRangeEditor().isParaStartOrEndInLockedRange(t))return this.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),8;if(1===n)return 32;var a=t,l=a.get_node(),s=r;if(!s)return 8;var u=this.GetStyleToApplyFromStyleId(s,a.get_node());if(!u)return this.get_ActivityManager().recordEvent(ah.f.unexpectedState,{Reason:lh.i.failedToFindStyle}),8;if(1!==this.get_StyleReader().getStyleTargetType(u))return 2;var c=this.get_StyleReader().getStyleSetFromParagraphNode(l);if(!c)return this.get_ActivityManager().recordEvent(ah.f.unexpectedState,{Reason:lh.i.failedToFindStyleSet}),8;if(!c.getStyleById(this.get_StyleReader().getStyleId(u)))return this.get_ActivityManager().recordEvent(ah.f.unexpectedState,{Reason:lh.i.failedToFindStyle}),8;var d=new Ma.GraphTransaction(7);try{d.setFromNode(l),this.get_StyleEditor().updateStyleSetFromParagraphNode(l,c),this.get_TextFormattingHelper().applyCharacterFormattingOnTextRange(a,(function(e){o.get_FormattingEditor().clearCharacterFormatting(e),o.get_FormattingEditor().setCharacterStyle(e,u)}))}finally{d&&d.dispose()}var g=Rn.l.calcHashCode(s),p=g>>>16^65535&g;return i.dataValue1=p,32},e.prototype.QueryStyleIp=function(e,t,n,i,r){var o=!0;if(t.get_contextId()!==ol.d.insertionPoint&&(o=!1),1===n&&!o)return 2;var a=this.get_StyleEditor().getStyleFromIp(t),l=t.get_node();if(this.get_IsHighlightStyleWhenDifferentFromSelectionEnabled()){if(!r||!l)return S.ULS.sendTraceTag(51218396,324,10,"actionData : {}, graphNode : {}",r,l),8;if(!(a=a||this.get_StyleReader().getStyleFromParagraphNode(l)))return S.ULS.sendTraceTag(51218397,324,10,"No paragraph style for I/P context is found"),2;r.isHighlightedStyleDiffFromSelection=Df.isSelectedStyleIsDifferentFromSelection(t,a)}else{if(!a)return 2;if(!r)return 8}return r.styleProperties.copyProperties(a),32},e.prototype.ApplyStyleToIp=function(e,t,n,i,r){if(t.get_contextId()!==ol.d.insertionPoint)return 8;if(!Gl.n.get_instance().get_item(61))return 8;if(this.get_LockedRangeEditor().isParaStartOrEndInLockedRange(t))return this.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),8;if(1===n)return 32;var o=t,a=o.get_node(),l=r;if(!l)return 8;var s=this.GetStyleToApplyFromStyleId(l,o.get_node());if(!s)return this.get_ActivityManager().recordEvent(ah.f.unexpectedState,{Reason:lh.i.failedToFindStyle}),8;var u,c=this.get_StyleReader().getStyleTargetType(s);if(1!==c&&2!==c)return 2;var d=this.get_InsertionPointFormatting().getSelectionForIpFormatting(o);if(d){var g=fa.SelectionManager.createMultiRangeOrGraphContext(d);u=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(g,e,2,!1,i,r)}else{var p=new Ma.GraphTransaction(7);p.setFromNode(a),this.get_StyleEditor().setStyleOnIp(s,a),p.dispose(),u=32}var h=Rn.l.calcHashCode(l),_=h>>>16^65535&h;return i.dataValue1=_,u},e.prototype.QueryStyleView=function(e,t,n,i,r){if(Gl.n.get_instance().get_item(61)){var o=this.get_ViewActionHandler().performGenericViewLevelAction(e,t,n,i,r,null,0);if(2!==o)return o}return this.get_ViewActionHandler().performGenericViewLevelAction(e,t,n,i,r,null,12)},e.prototype.ApplyStyleView=function(e,t,n,i,r){var o={};o[this.get_ViewActionHandler().get_viewActionPerfMarkStart()]=6168,o[this.get_ViewActionHandler().get_viewActionPerfMarkEnd()]=6169;var a=12;if(Gl.n.get_instance().get_item(61)){if(!t.view.get_isInteractiveView())return 2;var l=t.view.get_selectionManager(),s=l?l.get_selectionContextForActionDispatch():null;if(!s)return this.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),8;if(Gl.n.get_instance().get_item(11)&&this.get_ContextSetEditor().contextContentsCheck(pa.ImageReader.isAnchoredImageContext,s))return this.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsAnchoredImage}),8;if(Gl.n.get_instance().get_item(14)&&this.get_LockedRangeEditor().isContextSetInLockedParagraphs(s))return this.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsLockedRange}),8;var u=this.get_StyleReader().getStyleSetFromActivePage();if(r&&u){var c=u.getStyleById(r);if(c){var d=this.get_StyleReader().getLinkedStyle(c,u),g=this.get_StyleReader().getStyleTargetType(c);if(d){var p=l.get_selectionCollection().get_item(0);(p.get_containsSingleContext()&&p.get_firstContext().get_contextId()===ol.d.textRange||2===p.get_length()&&p.get_firstContext().get_contextId()===ol.d.textRange&&p.get_lastContext().get_contextId()===ol.d.endOfParagraph)&&(g=1,r=d.getValue(String,rs.o.paragraphStyleId))}1===g?a=0:3===g&&(a=14)}}}return this.get_ViewActionHandler().performGenericViewLevelAction(e,t,n,i,r,o,a)},e.prototype.GetStyleToApplyFromStyleId=function(e,t){if(!e||!t)return null;return Ga.ParagraphReader.isParagraphNode(t)?this.get_StyleReader().getStyleSetFromParagraphNode(t).getStyleById(e):null},e.ShortcutCount=10,e}();(0,o.l)(Rf,"1eeb611d$StyleActor",null,[]);var Mf=n(2342),kf=n(2434),Nf=n(9345),Lf=n(6649),Bf=(0,o.y)("40736ec6$IColorMenu"),Of=function(){return function(){this.Color=null,this.DisplayColor=null,this.Alt=null}}();(0,o.l)(Of,"43ff0ba8$ColorCellProps",null,[]);var Uf,Hf=n(4931);!function(e){e[e.automatic=1]="automatic",e[e.clear=2]="clear",e[e.themeColors=3]="themeColors",e[e.standardColors=4]="standardColors",e[e.recentColors=5]="recentColors"}(Uf||(Uf={})),(0,o.h)("f4671a3b$ColorMenuControls",Uf);var Gf=function(){function e(e){this._menuName=null,this._menuPopulationXmlCache=null,this._menuPopulationPropertiesCache=null,this._isRecentSectionAdded=!1,this._colorMenuControls={},this._recentColors=new C.c(String),this._menuName=e}return e.prototype.invalidateMenu=function(){this._menuPopulationXmlCache=null,this._menuPopulationPropertiesCache=null},e.prototype.generateColorControlProperties=function(e,t){if(this._menuPopulationPropertiesCache)return this._menuPopulationPropertiesCache;if(!e)return null;var n=(0,U.m)(new $o.b,{Id:String.format("menu{0}Color",this._menuName),ExternalId:String.format("{0}Color",this._menuName)});if(n.MenuSectionList=[],Array.add(n.MenuSectionList,this.AddAutomaticControl()),Array.add(n.MenuSectionList,this.AddClearControl()),Array.add(n.MenuSectionList,this.AddThemeColorsControl(e,t)),Array.add(n.MenuSectionList,this.AddStandardColorsControl()),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordRecentFontColorSettings"),L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RecentFontColorIsEnabled")){var i=this.AddRecentColorsControl(e,t);i&&Array.add(n.MenuSectionList,i)}return this._menuPopulationPropertiesCache=n,this._menuPopulationPropertiesCache},e.prototype.addRecentColor=function(t){var n=this._recentColors.indexOf(t);n?(this.invalidateMenu(),-1!==n&&this._recentColors.removeAt(n),this._recentColors.insert(0,t),S.ULS.sendTraceTag(51389399,340,50,"{0} is added at the start of recent color list",t),this._recentColors.get_count()===e.MaxRecentColorsCount+1&&(S.ULS.sendTraceTag(51389400,340,50,"Removing {0} from the recent color list",this._recentColors.get_item(e.MaxRecentColorsCount)),this._recentColors.removeAt(e.MaxRecentColorsCount)),this.SendUpdateMenuRecentSectionReduxAction()):S.ULS.sendTraceTag(51389398,340,50,"No need to update recent menu section as {0} is same as last used color",t)},e.prototype.createColorControl=function(e,t){if(this._menuPopulationXmlCache)return this._menuPopulationXmlCache;var n=this.generateColorControlProperties(e,t);return this._menuPopulationXmlCache=Yu.s.getXmlFromMenuProps(n),this._menuPopulationXmlCache},e.prototype.addMenuControl=function(e,t){Uf[e]in this._colorMenuControls||(this._colorMenuControls[Uf[e]]=t)},e.prototype.addToMenuCacheInvalidator=function(e,t){e.addCallback(o.i(this,this.invalidateMenu,"invalidateMenu"),t)},e.prototype.AddAutomaticControl=function(){var e;if(!this.tryGetActionIdForControl(1,(0,g.m)((function(){return e}),(function(t){return e=t}))))return null;var t=(0,U.m)(new zo.x,{Id:String.format("{0}Color",this._menuName),ControlsId:String.format("{0}.Color.Menu.Controls",this._menuName),DisplayMode:"Menu16",ControlList:[]}),n=(0,U.m)(new Ko.k,{Command:e.toString(),LabelText:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_Automatic),Image16by16:L.AFrameworkApplication.get_imageClusterPath(),Image16by16Class:Ct.ImageClusteringHelper.getImageClass("Automatic_16x16x32"),Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});return Array.add(t.ControlList,n),t},e.prototype.AddClearControl=function(){var e;if(!this.tryGetActionIdForControl(2,(0,g.m)((function(){return e}),(function(t){return e=t}))))return null;var t=(0,U.m)(new zo.x,{Id:String.format("{0}Color",this._menuName),ControlsId:String.format("{0}.Color.Menu.Controls",this._menuName),DisplayMode:"Menu16",ControlList:[]}),n=(0,U.m)(new Ko.k,{Command:e.toString(),LabelText:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:L.AFrameworkApplication.get_imageClusterPath(),Image16by16Class:Ct.ImageClusteringHelper.getImageClass("NoHighlight_16x16x32"),Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});return Array.add(t.ControlList,n),t},e.prototype.AddThemeColorsControl=function(t,n){var i;if(!this.tryGetActionIdForControl(3,(0,g.m)((function(){return i}),(function(e){return i=e}))))return null;var r=(0,U.m)(new zo.x,{Id:"Colors",ControlsId:String.format("{0}.Color.Menu.Controls",this._menuName),ControlList:[]}),o=(0,U.m)(new Iu.z,{Id:String.format("Theme{0}ColorPicker",this._menuName),ExternalId:String.format("Theme{0}ColorPicker",this._menuName),McuExternalId:String.format("Theme{0}ColorPickerMCU",this._menuName),McuLayout:!0,Command:i.toString(),Width:10});return o.Colors=e.GetThemeColors(t,n),Array.add(r.ControlList,o),r},e.prototype.AddStandardColorsControl=function(){var t;if(!this.tryGetActionIdForControl(4,(0,g.m)((function(){return t}),(function(e){return t=e}))))return null;var n=(0,U.m)(new zo.x,{Id:String.format("{0}Colors",this._menuName),ControlsId:String.format("{0}.Color.Menu.Controls",this._menuName),Title:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]}),i=(0,U.m)(new Iu.z,{Id:String.format("Standard{0}ColorPicker",this._menuName),ExternalId:String.format("Standard{0}ColorPicker",this._menuName),Command:t.toString(),Width:10,Colors:new Array(0)});return i.Colors=e.GetStandardColors(),Array.add(n.ControlList,i),n},e.prototype.AddRecentColorsControl=function(t,n){var i;if(!this.tryGetActionIdForControl(5,(0,g.m)((function(){return i}),(function(e){return i=e})))||!this._recentColors.get_count())return null;S.ULS.sendTraceTag(51389401,340,50,"Adding recent color control");var r=(0,U.m)(new zo.x,{Id:String.format("{0}Colors",this._menuName),ControlsId:String.format("{0}.Color.Menu.Controls",this._menuName),Title:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_MenuRecentColors),ControlList:[]}),o=(0,U.m)(new Iu.z,{Id:String.format("Recent{0}ColorPicker",this._menuName),ExternalId:String.format("Recent{0}ColorPicker",this._menuName),Command:i.toString(),Width:10,Colors:new Array(0)}),a=e.GetStandardColors();Array.addRange(a,e.GetThemeColors(t,n));for(var l=0;l<this._recentColors.get_count();l++)for(var s=this._recentColors.get_item(l),u=0;u<a.length;u++)s===a[u].Color&&o.Colors.push(a[u]);return Array.add(r.ControlList,o),r},e.prototype.SendUpdateMenuRecentSectionReduxAction=function(){if(L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&!this._isRecentSectionAdded){S.ULS.sendTraceTag(51389402,340,50,"Sending a redux action to update the font menu");var e=(0,U.m)(new Hf.p,{title:Box4Intl.Box4Strings.L_FontColor,sections:new Array(0)});e.sections.push(appChrome.api.menuSection(["AutomaticFontColor"],null)),e.sections.push(appChrome.api.menuSection(["ThemeFontColorPickerMCU"],null)),e.sections.push(appChrome.api.menuSection(["ThemeFontColorPicker"],null)),e.sections.push(appChrome.api.menuSection(["StandardFontColorPicker"],Box4Intl.Box4Strings.L_MenuStandardColors)),e.sections.push(appChrome.api.menuSection(["RecentFontColorPicker"],Box4Intl.Box4Strings.L_MenuRecentColors)),appChrome.api.dispatch(appChrome.actions.updateMenu("FontColor",e.sections,Box4Intl.Box4Strings.L_FontColor)),this._isRecentSectionAdded=!0}},e.prototype.tryGetActionIdForControl=function(e,t){t.val=0;var n=Uf[e];return n in this._colorMenuControls&&(t.val=this._colorMenuControls[n],!0)},e.addThemeColors=function(t,n,i){for(var r=e.GetThemeColors(t,i),o=0;o<r.length;o++){n.val+=String.format('\r\n\t\t\t\t<Color Color="{0}" Alt="{1}" DisplayColor="{2}"/>',r[o].Color,r[o].Alt,r[o].DisplayColor)}},e.GetStandardColors=function(){var e=new Array(0);return e.push((0,U.m)(new Of,{Color:"0000C0",Alt:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"})),e.push((0,U.m)(new Of,{Color:"0000FF",Alt:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"})),e.push((0,U.m)(new Of,{Color:"00C0FF",Alt:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"})),e.push((0,U.m)(new Of,{Color:"00FFFF",Alt:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"})),e.push((0,U.m)(new Of,{Color:"50D092",Alt:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorLightGreen),DisplayColor:"#92D050"})),e.push((0,U.m)(new Of,{Color:"50B000",Alt:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),e.push((0,U.m)(new Of,{Color:"F0B000",Alt:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),e.push((0,U.m)(new Of,{Color:"C07000",Alt:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"})),e.push((0,U.m)(new Of,{Color:"602000",Alt:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"})),e.push((0,U.m)(new Of,{Color:"A03070",Alt:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"})),e},e.GetThemeColors=function(t,n){var i=t.get_properties().getValueWithDefault(Array,os.j.themeColors,null),r=t.get_properties().getValue(String,os.j.themeTooltips).split(" "),o=new Array(10);o[0]=Box4Intl.Box4Strings.l_ThemeLabel1,o[1]=Box4Intl.Box4Strings.l_ThemeLabel2,o[2]=Box4Intl.Box4Strings.l_ThemeLabel3,o[3]=Box4Intl.Box4Strings.l_ThemeLabel4,o[4]=Box4Intl.Box4Strings.l_ThemeLabel5,o[5]=Box4Intl.Box4Strings.l_ThemeLabel6,o[6]=Box4Intl.Box4Strings.l_ThemeLabel7,o[7]=Box4Intl.Box4Strings.l_ThemeLabel8,o[8]=Box4Intl.Box4Strings.l_ThemeLabel9,o[9]=Box4Intl.Box4Strings.l_ThemeLabel10;for(var a=new Array(0),l=0;l<e.ThemeColorRows;l++)for(var s=0;s<e.ThemeColorsPerRow;s++){var u=l*e.ThemeColorsPerRow+s,c=i[u],d=u+1<<24,g=4278190080&c|(255&c)<<16|65280&c|(16711680&c)>>>16,p=n[r[s]],h=e.toolTipForModifiedColor(o,l,s,p,i[s]);a.push((0,U.m)(new Of,{Color:Rn.l.convertToHex(d,8),DisplayColor:"#"+Rn.l.convertToHex(g,6),Alt:Rn.l.xmlEncode(h)}))}return a},e.toolTipForModifiedColor=function(e,t,n,i,r){if(t){var o=255&r,a=(65280&r)>>>8,l=(16711680&r)>>>16,s=Math.min(Math.min(o,a),l),u=Math.max(Math.max(o,a),l),c=Math.floor((s+u)/2),d=t-1,g=void 0,p=void 0;if(c)if(255===c){g=!0,p=[242,217,191,166,127][d]}else if(c>204){g=!1,p=[229,191,127,64,25][d]}else if(c<51){g=!0,p=[25,64,127,191,229][d]}else{var h=[51,102,153];p=(g=d<h.length)?h[d]:[191,127][d-h.length]}else{g=!1,p=[127,166,191,217,242][d]}return p=255-p,String.format(g?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,i,e[n],Math.round(100*p/255))}return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,i,e[n])},e.ThemeColorRows=6,e.ThemeColorsPerRow=10,e.MaxRecentColorsCount=10,e}();(0,o.l)(Gf,"1198ff2f$ColorMenu",null,[Bf]);var Wf=function(){function e(e){this._colorMenu=null,this._menuCacheInvalidator=null,this._menuCacheInvalidator=e}return e.prototype.get_fontColorMenu=function(){return this._colorMenu||(this._colorMenu=new Gf(e.colorMenuName),this.initializeMenu(this._colorMenu)),this._colorMenu},e.prototype.initializeMenu=function(e){e.addMenuControl(1,Oi.u.clearFontColor),e.addMenuControl(3,Oi.u.setFontColor),e.addMenuControl(4,Oi.u.setFontColor),e.addMenuControl(5,Oi.u.setFontColor),e.addToMenuCacheInvalidator(this._menuCacheInvalidator,1)},e.prototype.registerActions=function(){var e=L.AFrameworkApplication.get_theActionManager();e.addAction(Oi.u.populateFontColor,ol.d.view,o.i(this,this.populateFontColor,"populateFontColor")),e.setActionFlags(Oi.u.populateFontColor,103)},e.prototype.populateFontColor=function(t,n,i,r,o){if(1===i)return 32;if(2===i&&!o)return 8;var a=e.get_PageReader().getPageContentNodeFromContext(n),l=o;if(L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()){var s=this.get_fontColorMenu().generateColorControlProperties(a,yi.App.colorMenuThemeStringsType);if(!s)return 8;l.MenuItems=s}var u=this.get_fontColorMenu().createColorControl(a,yi.App.colorMenuThemeStringsType);return u?(l.PopulationXML=u,32):8},e.prototype.addRecentColor=function(e){this.get_fontColorMenu().addRecentColor(e)},e.GetFontColorActorWithResolvedDependencies=function(){return new e(Lf.d.get_instance())},e.get_instance=function(){return e._singletonInstance||(e._singletonInstance=e.GetFontColorActorWithResolvedDependencies())},e.get_PageReader=function(){return $s.PageReader.get_instance()},e.colorMenuName="Font",e._singletonInstance=null,e}();(0,o.l)(Wf,"f73d4b64$FontColorActor",null,[]);var Vf=n(5384),$f=function(){function e(){}return e.get_ContextSetEditor=function(){return am.ContextSetEditor.get_instance()},e.get_LockedRangeEditor=function(){return za.k.get_instance()},e.get_ActivityManager=function(){return xr.y.get_instance()},e.get_FeatureHelper=function(){return e._featureHelper||(e._featureHelper=Ge.w.get_instance().resolve(Yh.d))},e.get_ExternalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=Ge.w.get_instance().resolveFuture(kg.i))},e.get_ParagraphIndentationReader=function(){return e._paragraphIndentationReader||(e._paragraphIndentationReader=Ge.w.get_instance().resolve(Sg.p))},e.applyFormattingToView=function(t,n,i,r,o){var a=!0;if(!n.view.get_isInteractiveView())return 2;var l=n.view,s=l.get_selectionManager();if(s&&s.get_selectionCollection().get_currentSelection()||(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),a=!1),Gl.n.get_instance().get_item(11)&&(e.get_ContextSetEditor().contextContentsCheck(pa.ImageReader.isImageContext,l.get_selectionManager().get_selectionContextForActionDispatch())&&(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsImage}),a=!1),e.get_ContextSetEditor().contextContentsCheck(pa.ImageReader.isAnchoredImageContext,l.get_selectionManager().get_selectionContextForActionDispatch())))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsAnchoredImage}),8;Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().isContextSetInLockedParagraphs(l.get_selectionManager().get_selectionContextForActionDispatch())&&(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsLockedRange}),a=!1),e.get_ContextSetEditor().contextContentsCheck(pa.ImageReader.isFloatingImageContext,l.get_selectionManager().get_selectionContextForActionDispatch())&&(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsFloatingImage}),a=!1),e.get_ContextSetEditor().contextContentsCheck(Bm.r.isFloatingInkContext,l.get_selectionManager().get_selectionContextForActionDispatch())&&(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsFloatingInk}),a=!1),e.get_ContextSetEditor().contextContentsCheck(Vf.q.isFloatingIFrameContext,l.get_selectionManager().get_selectionContextForActionDispatch())&&(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsFloatingIFrame}),a=!1),e.get_ExternalSelectionManagerFuture()&&e.get_ExternalSelectionManagerFuture().get_instance()&&e.get_ExternalSelectionManagerFuture().get_instance().isExternalSelectionContext(l.get_selectionManager().get_selectionContextForActionDispatch())&&(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.externalSelection}),a=!1),t!==Oi.u.setLineSpacing||Gl.n.get_instance().get_item(54)||Gl.n.get_instance().get_item(84)||(a=!1);var u=null;if(s&&s.get_selectionCollection().get_currentSelection()&&(u=s.get_selectionCollection().get_currentSelection()),t===Oi.u.specialIndentMenuOpen&&u&&u.get_containsSingleContext()&&Ga.ParagraphReader.isGraphNodeInsideList(u.get_firstContext().get_node())&&!gs.ListReader.get_isListMarkerEnabled()&&(a=!1),1===i||!a||!u)return a?32:8;var c,d=t===Oi.u.leftTextJustify||t===Oi.u.centerTextJustify||t===Oi.u.rightTextJustify||t===Oi.u.fullTextJustify,g=t===Oi.u.promoteFirstLineIndent||t===Oi.u.demoteFirstLineIndent||t===Oi.u.removeFirstLineIndent,p=t===Oi.u.setSpacingAfterLine||t===Oi.u.setSpacingBeforeLine||t===Oi.u.setLineSpacing,h=new Ma.GraphTransaction(15);h.setFromNode(u.get_firstContext().get_node());var _=new C.c(Number),m=!1;if(d||g||p)Dr.t.mark(7121),c=e.get_ContextSetEditor().generalizeContextToOutlineElementContents(n.get_nextContext());else{if(Dr.t.mark(7119),!(c=Y_.generalizeSelectionToOEs(s.get_selectionCollection(),!0)))return e.get_ActivityManager().recordEvent(ah.f.failedProcessingStep,{Reason:lh.i.failedToGeneralizeToOEs}),h.dispose(),8;var f=t===Oi.u.indentBefore||t===Oi.u.indentBeforePageLayoutTab;c.get_isContextSet()&&f&&(m=e.HasMultipleIndentationTypes(_,c))}if(c.get_isContextSet()&&c.get_length()>1&&e.HasMultipleJustificationTypes(c)){if(o){if(Object.getType(o)!==Object){var y=yi.App.get_activeAppFrame().get_applicationInstance().resolveActionId(t),b=ol.d.getNameFromId(n.get_contextId());S.ULS.sendTraceTag(51427082,306,15,"actionData is not a Dictionary. Type: {0}; ActionName: {1}; ContextName: {2}; Behavior: {3}",Object.getType(o),y,b,i),o={}}}else o={};o.InContextSet=!0}return L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(c,t,i,!0,r,o),m&&e.NormalizeHybridGraphNodesLeftValues(_,c,o),h.dispose(),yi.App.get_activeAppFrame().updateCommandUI(),d||g||p?Dr.t.mark(7122):Dr.t.mark(7120),32},e.HasMultipleIndentationTypes=function(t,n){if(!n.get_isContextSet())return!1;for(var i=n,r=!1,o=!1,a=0;a<i.get_length();a++)if(i.getContext(a).get_isGraphNodeContext()){var l=i.getContext(a).get_node();if(l){var s=e.get_ParagraphIndentationReader().getIndentInfo(l);2===s.specialIndentType?(r=!0,t.add(a)):1!==s.specialIndentType&&s.specialIndentType||(o=!0)}}return o&&r},e.NormalizeHybridGraphNodesLeftValues=function(t,n,i){if(n.get_isContextSet())for(var r=n,o=i,a=0;a<t.get_count();a++){var l=r.getContext(t.get_item(a));if(l.get_isGraphNodeContext()){var s=l.get_node(),u=e.get_ParagraphIndentationReader().getIndentInfo(s);2!==u.specialIndentType||as.s.isEqualish(o.value,u.indentLeftValue)||s.setValue(os.j.paraIndentLeft,u.indentLeftValue-u.specialIndentValueTwips)}}},e.shouldExecuteParagraphAction=function(t,n,i){var r=!0;return n.get_contextId()!==ol.d.paragraph?r=!1:Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().isParaStartOrEndInLockedRange(n)?(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),r=!1):e.get_ExternalSelectionManagerFuture()&&e.get_ExternalSelectionManagerFuture().get_instance()&&e.get_ExternalSelectionManagerFuture().get_instance().isExternalSelectionContext(n)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.externalSelection}),r=!1),i.val=r?32:8,1!==t&&r},e.shouldExecuteImageAction=function(e,t,n){var i=!0;return t.get_contextId()!==ol.d.image&&t.get_contextId()!==ol.d.embeddedFile&&(i=!1),Gl.n.get_instance().get_item(11)&&(i=!1),n.val=i?32:8,1!==e&&i},e.HasMultipleJustificationTypes=function(e){if(!e.get_isContextSet())return!1;for(var t=e,n=1,i=0;i<t.get_length();i++)if(t.getContext(i).get_isGraphNodeContext()){var r=t.getContext(i).get_node();if(r){var o=Ga.ParagraphReader.getJustification(r);if(i){if(o!==n)return!0}else n=o}}return!1},e._featureHelper=null,e._externalSelectionManagerFuture=null,e._paragraphIndentationReader=null,e}();(0,o.l)($f,"e505174e$FormattingActionHelper",null,[]);var zf=function(e){function t(t,n,i,r,o,a,l,s){var u=e.call(this)||this;return u._transaction=null,u._selectionReference=null,u._ViewOperationStage=0,u._isEnabled=!1,u._context=null,u._finishedStageProcessor=null,u._externalSelectionManagerFuture=null,u.init(t),u.setDebugName("FormattingViewOperation"),u.initAction(L.AFrameworkApplication.get_theActionManager(),n,r,o,a),u._context=i,u._ViewOperationStage=0,u._isEnabled=!0,u._finishedStageProcessor=l,u._externalSelectionManagerFuture=s,u}return(0,v.t)(t,e),t.prototype.get_ExternalSelectionManager=function(){return this._externalSelectionManagerFuture.get_instance()},t.prototype.run=function(){var e=this._context.view,n=null;(e.get_isInteractiveView()&&(n=e.get_selectionManager()),n)?!(i=n.get_selectionCollection().get_currentSelection())||Gl.n.get_instance().get_item(14)&&t.get_LockedRangeEditor().isSelectionInLockedRange(i)?(t.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsLockedRange}),this._isEnabled=!1):this.get_ExternalSelectionManager()&&this.get_ExternalSelectionManager().isExternalSelection(i)&&(t.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.externalSelection}),this._isEnabled=!1):(t.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelectionManager}),this._isEnabled=!1);if(1===this.get_behavior()||!this._isEnabled){if(this._isEnabled){var i=n.get_selectionCollection().get_currentSelection();1===n.get_selectionCollection().get_length()&&1===i.get_length()&&ga.SelectionEditor.isTextRangeContext(i.get_firstContext())&&Cd.f.containsNonFormattableBlobs(i.get_firstContext())&&(t.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsNonFormattableBlob}),this._isEnabled=!1)}var r=this._isEnabled;if(r&&this.get_actionId()===Oi.u.setLanguage){i=n.get_selectionCollection().get_currentSelection();(r=Kc.Enumerable.AT(Wa.y,i,vc.FormattingReader.containsFormatting))||t.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.doesNotContainParagraph})}this.set_response(r?32:8),this._ViewOperationStage=3}if(!this._ViewOperationStage){Dr.t.mark(5730),this._selectionReference=lm.a.get_instance().createReferenceToCurrentSelection();var o=n.get_selectionCollection().get_currentSelection().get_firstContext();this._transaction=new Ma.GraphTransaction(15),this._transaction.setFromNode(o.get_node()),this._ViewOperationStage=1}if(1===this._ViewOperationStage){if(this.get_childOperation()||this.setCurrentOperationFromContext(this._context.get_nextContext()),1===this.processCurrentOperation())return;this._ViewOperationStage=2}if(2===this._ViewOperationStage){if(this.get_actionId()===Oi.u.setLanguage){var a=n.get_selectionContextForActionDispatch();if(a.get_isContextSet())for(var l=a,s=0;s<l.get_length();s++){o=l.getContext(s);this.TrySpellCheckGraphNodeContext(o)}else o=a,this.TrySpellCheckGraphNodeContext(o)}var u=this.get_actionId()===Oi.u.setFontBackgroundColor||this.get_actionId()===Oi.u.clearFontBackgroundColor||this.get_actionId()===Oi.u.clearFormatting||this.get_actionId()===Oi.u.clearFontColor;this._selectionReference.restoreSelection(u);var c=(0,y.e)(Mf.p,this.get_actionData());c&&!c.get_shouldCanvasTakeFocus()||St.FocusManager.instance().setScope(e.get_focusScopeId()),this._transaction.dispose(),this._transaction=null,yi.App.get_activeAppFrame().updateCommandUI(),Dr.t.mark(5731),this._ViewOperationStage=3,this.set_response(32)}3===this._ViewOperationStage&&(this._finishedStageProcessor.process(this.get_actionId(),this._context,this.get_behavior(),this.get_response()),this.setIsCompleted())},t.prototype.TrySpellCheckGraphNodeContext=function(e){return!(!ga.SelectionEditor.isInsertionPointOrTextRangeContext(e)&&!ga.SelectionEditor.isEndOfParagraphContext(e))&&(yi.App.theProofingManager.spellCheck(e.get_node()),!0)},t.get_LockedRangeEditor=function(){return za.k.get_instance()},t.get_ActivityManager=function(){return xr.y.get_instance()},t}(mh.g);(0,o.l)(zf,"bbae636e$FormattingViewOperation",mh.g,[]);var Kf=n(6075),qf=function(){function e(e,t,n){this._eopFormattingStrategy=null,this._textRenderingStrategy=null,this._clearFormattingTrackChangesIsEnabled=!1,this._recentFontColorIsEnabled=null,this._formattingViewOperationFinishedStageProcessor=null,this._formattingViewOperationFinishedStageProcessor=e,this._eopFormattingStrategy=t,this._textRenderingStrategy=n,this._clearFormattingTrackChangesIsEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ClearFormattingTrackChangesIsEnabled")}return e.prototype.get_IsRecentFontColorMenuSectionEnabled=function(){return null==this._recentFontColorIsEnabled&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordRecentFontColorSettings"),L.AFrameworkApplication.appSettingsManager?this._recentFontColorIsEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RecentFontColorIsEnabled"):this._recentFontColorIsEnabled=!1),this._recentFontColorIsEnabled},e.prototype.RegisterActions=function(){var t=L.AFrameworkApplication.get_theActionManager(),n=o.i(this,this.QueryNonParagraphFormatting,"QueryNonParagraphFormatting");!!Gl.n.get_instance().get_item(105)&&(e.get_FeatureHelper()?e.get_FeatureHelper().isFeatureUIEnabled(49):L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("Box4EndOfParagraphFormattingIsEnabled"))?(t.addAction(Oi.u.font,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.setFontSize,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.growFontSize,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.shrinkFontSize,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.setFontColor,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.clearFontColor,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.setFontBackgroundColor,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.clearFontBackgroundColor,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.bold,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.setItalic,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.underline,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.setUnderlineType,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.superscript,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.subscript,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.strikethrough,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.doubleStrikethrough,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.setLanguage,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP")),t.addAction(Oi.u.clearFormatting,ol.d.endOfParagraph,o.i(this,this.ApplyFormattingEOP,"ApplyFormattingEOP"))):yi.App.listBulletFormattingIsEnabled&&(t.addAction(Oi.u.font,ol.d.endOfParagraph,o.i(this,this.ApplyListFormattingEOP,"ApplyListFormattingEOP")),t.addAction(Oi.u.setFontSize,ol.d.endOfParagraph,o.i(this,this.ApplyListFormattingEOP,"ApplyListFormattingEOP")),t.addAction(Oi.u.setFontColor,ol.d.endOfParagraph,o.i(this,this.ApplyListFormattingEOP,"ApplyListFormattingEOP")),t.addAction(Oi.u.clearFontColor,ol.d.endOfParagraph,o.i(this,this.ApplyListFormattingEOP,"ApplyListFormattingEOP")),gs.ListReader.get_isListMarkerEnabled()&&(t.addAction(Oi.u.bold,ol.d.endOfParagraph,o.i(this,this.ApplyListFormattingEOP,"ApplyListFormattingEOP")),t.addAction(Oi.u.setItalic,ol.d.endOfParagraph,o.i(this,this.ApplyListFormattingEOP,"ApplyListFormattingEOP")),t.addAction(Oi.u.superscript,ol.d.endOfParagraph,o.i(this,this.ApplyListFormattingEOP,"ApplyListFormattingEOP")),t.addAction(Oi.u.subscript,ol.d.endOfParagraph,o.i(this,this.ApplyListFormattingEOP,"ApplyListFormattingEOP")),t.addAction(Oi.u.strikethrough,ol.d.endOfParagraph,o.i(this,this.ApplyListFormattingEOP,"ApplyListFormattingEOP")),t.addAction(Oi.u.doubleStrikethrough,ol.d.endOfParagraph,o.i(this,this.ApplyListFormattingEOP,"ApplyListFormattingEOP"))),(Gl.n.get_instance().get_item(94)||Gl.n.get_instance().get_item(96))&&(t.addAction(Oi.u.growFontSize,ol.d.endOfParagraph,o.i(this,this.ApplyListFormattingEOP,"ApplyListFormattingEOP")),t.addAction(Oi.u.shrinkFontSize,ol.d.endOfParagraph,o.i(this,this.ApplyListFormattingEOP,"ApplyListFormattingEOP"))));var i=yi.App.theContextSetActor.createDelegatedViewHandler((function(e){return Y_.generalizeSelectionToOEs(e.get_selectionCollection(),!0)}));Gl.n.get_instance().get_item(77)||t.addAction(Oi.u.queryParagraphFormatting,ol.d.table,o.i(this,this.QueryTableFormatting,"QueryTableFormatting")),t.addAction(Oi.u.queryFormatting,ol.d.view,o.i(this,this.QueryCharacterFormatting,"QueryCharacterFormatting")),t.addAction(Oi.u.queryFormattingFromAgaveRichAPI,ol.d.view,o.i(this,this.QueryCharacterFormatting,"QueryCharacterFormatting")),t.addAction(Oi.u.queryParagraphFormatting,ol.d.view,i),t.addAction(Oi.u.queryParagraphFormatting,ol.d.paragraph,o.i(this,this.QueryParagraphFormatting,"QueryParagraphFormatting")),t.addAction(Oi.u.queryParagraphFormatting,ol.d.image,o.i(this,this.QueryImageFormatting,"QueryImageFormatting")),t.addAction(Oi.u.queryParagraphFormatting,ol.d.unsupportedObject,n),t.setActionFlags(Oi.u.queryFormatting,99|(Gl.n.get_instance().get_item(7)?0:1028)),t.setActionFlags(Oi.u.queryFormattingFromAgaveRichAPI,1127),t.setActionFlags(Oi.u.queryParagraphFormatting,97|(Gl.n.get_instance().get_item(7)?0:1028)),this.AddDefaultFormattingActionHandlers(t,Oi.u.font),this.AddDefaultFormattingActionHandlers(t,Oi.u.setFontSize),(Gl.n.get_instance().get_item(94)||Gl.n.get_instance().get_item(96))&&(this.AddDefaultFormattingActionHandlers(t,Oi.u.growFontSize),this.AddDefaultFormattingActionHandlers(t,Oi.u.shrinkFontSize)),Gl.n.get_instance().get_item(48)&&(t.addAsyncAction(Oi.u.fontColorMenuOpen,ol.d.view,o.i(this,this.ApplyCharacterFormattingViewAsync,"ApplyCharacterFormattingViewAsync")),t.setActionFlags(Oi.u.fontColorMenuOpen,1092)),this.AddDefaultFormattingActionHandlers(t,Oi.u.setFontColor),this.AddDefaultFormattingActionHandlers(t,Oi.u.clearFontColor),this.AddDefaultFormattingActionHandlers(t,Oi.u.setFontBackgroundColor),this.AddDefaultFormattingActionHandlers(t,Oi.u.changeCaseSentence),this.AddDefaultFormattingActionHandlers(t,Oi.u.changeCaseLower),this.AddDefaultFormattingActionHandlers(t,Oi.u.changeCaseUpper),this.AddDefaultFormattingActionHandlers(t,Oi.u.changeCaseCapitalizeEachWord),this.AddDefaultFormattingActionHandlers(t,Oi.u.changeCaseToggle),this.AddDefaultFormattingActionHandlers(t,Oi.u.clearFontBackgroundColor),this.AddDefaultFormattingActionHandlers(t,Oi.u.bold),t.setActionDataGenerator(Oi.u.bold,o.i(this,this.GenerateActionArguments,"GenerateActionArguments")),this.AddDefaultFormattingActionHandlers(t,Oi.u.setItalic),t.setActionDataGenerator(Oi.u.setItalic,o.i(this,this.GenerateActionArguments,"GenerateActionArguments")),this.AddDefaultFormattingActionHandlers(t,Oi.u.underline),t.setActionDataGenerator(Oi.u.underline,o.i(this,this.GenerateActionArguments,"GenerateActionArguments")),this.AddDefaultFormattingActionHandlers(t,Oi.u.setUnderlineType),this.AddDefaultFormattingActionHandlers(t,Oi.u.superscript),t.setActionDataGenerator(Oi.u.superscript,o.i(this,this.GenerateActionArguments,"GenerateActionArguments")),this.AddDefaultFormattingActionHandlers(t,Oi.u.subscript),t.setActionDataGenerator(Oi.u.subscript,o.i(this,this.GenerateActionArguments,"GenerateActionArguments")),this.AddDefaultFormattingActionHandlers(t,Oi.u.strikethrough),t.setActionDataGenerator(Oi.u.strikethrough,o.i(this,this.GenerateActionArguments,"GenerateActionArguments")),this.AddDefaultFormattingActionHandlers(t,Oi.u.doubleStrikethrough),t.setActionDataGenerator(Oi.u.doubleStrikethrough,o.i(this,this.GenerateActionArguments,"GenerateActionArguments")),t.addActionWithFlags(Oi.u.ipProperties,ol.d.textRange,o.i(this,this.ApplyCharacterFormatting,"ApplyCharacterFormatting"),96),t.addAsyncAction(Oi.u.setLanguage,ol.d.view,o.i(this,this.ApplyCharacterFormattingViewAsync,"ApplyCharacterFormattingViewAsync")),t.addAction(Oi.u.setLanguage,ol.d.paragraph,o.i(this,this.ApplyParagraphFormatting,"ApplyParagraphFormatting")),t.addAction(Oi.u.setLanguage,ol.d.textRange,o.i(this,this.ApplyCharacterFormatting,"ApplyCharacterFormatting")),t.addAction(Oi.u.setLanguage,ol.d.insertionPoint,o.i(this,this.ApplyFormattingIp,"ApplyFormattingIp")),t.addAction(Oi.u.clearFormatting,ol.d.view,o.i(this,this.ClearFormattingView,"ClearFormattingView")),t.addAction(Oi.u.clearFormatting,ol.d.paragraph,o.i(this,this.ClearFormattingParagraph,"ClearFormattingParagraph")),t.addAction(Oi.u.clearFormatting,ol.d.textRange,o.i(this,this.ApplyCharacterFormatting,"ApplyCharacterFormatting")),t.addAction(Oi.u.clearFormatting,ol.d.insertionPoint,o.i(this,this.ApplyFormattingIp,"ApplyFormattingIp")),t.setActionFlags(Oi.u.clearFormatting,1028),t.addAction(Oi.u.clearFormattingParagraphLevel,ol.d.textRange,o.i(this,this.ClearFormattingParagraphLevel,"ClearFormattingParagraphLevel")),t.addAction(Oi.u.clearFormattingParagraphLevel,ol.d.insertionPoint,o.i(this,this.ClearFormattingParagraphLevel,"ClearFormattingParagraphLevel")),t.addAction(Oi.u.clearFormattingMultiParagraphLevel,ol.d.view,o.i(this,this.ClearFormattingMultiParagraphLevel,"ClearFormattingMultiParagraphLevel")),t.addAction(Oi.u.setTextDirectionLeftToRight,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.setTextDirectionLeftToRight,ol.d.paragraph,o.i(this,this.ApplyParagraphFormatting,"ApplyParagraphFormatting")),t.addAction(Oi.u.setTextDirectionLeftToRight,ol.d.image,o.i(this,this.ApplyTextDirectionToImage,"ApplyTextDirectionToImage")),t.addAction(Oi.u.setTextDirectionLeftToRight,ol.d.unsupportedObject,o.i(this,this.ApplyTextDirectionToNonParagraph,"ApplyTextDirectionToNonParagraph")),t.setActionFlags(Oi.u.setTextDirectionLeftToRight,1028),t.addAction(Oi.u.setTextDirectionRightToLeft,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.setTextDirectionRightToLeft,ol.d.paragraph,o.i(this,this.ApplyParagraphFormatting,"ApplyParagraphFormatting")),t.addAction(Oi.u.setTextDirectionRightToLeft,ol.d.image,o.i(this,this.ApplyTextDirectionToImage,"ApplyTextDirectionToImage")),t.addAction(Oi.u.setTextDirectionRightToLeft,ol.d.unsupportedObject,o.i(this,this.ApplyTextDirectionToNonParagraph,"ApplyTextDirectionToNonParagraph")),t.setActionFlags(Oi.u.setTextDirectionRightToLeft,1028)},e.prototype.AddDefaultFormattingActionHandlers=function(e,t){e.addAsyncAction(t,ol.d.view,o.i(this,this.ApplyCharacterFormattingViewAsync,"ApplyCharacterFormattingViewAsync")),e.addAction(t,ol.d.textRange,o.i(this,this.ApplyCharacterFormatting,"ApplyCharacterFormatting")),e.addAction(t,ol.d.insertionPoint,o.i(this,this.ApplyFormattingIp,"ApplyFormattingIp")),e.setActionFlags(t,1028)},e.prototype.GenerateActionArguments=function(){return new xc.b(2)},e.prototype.QueryCharacterFormatting=function(e,t,n,i,r){var o=!0;if(t.get_contextId()!==ol.d.view&&(o=!1),1===n&&!o)return 8;var a=t,l=null,s=null;if(e===Oi.u.queryFormattingFromAgaveRichAPI){var u=r;l=u.formatting,s=u.sourceData}else{if(!a.view||!a.view.get_isInteractiveView())return 2;var c=a.view;if(!c.get_selectionManager()||!c.get_selectionManager().get_selectionCollection().get_currentSelection())return 8;l=r,s=c.get_selectionManager().get_selectionCollection()}return this.ComputeConsistentFormattingFromSelection(s,l),32},e.prototype.ComputeConsistentFormattingFromSelection=function(e,t){for(var n=e.getEnumerator();n.$$mn();)for(var i=n.$$cu(),r=i.get_isTableCellSelection(),o=i.getEnumerator();o.$$mn();){var a=o.$$cu(),l=null;if(a.get_contextId()===ol.d.textRange){if(Cd.f.containsNonFormattableBlobs(a))continue;if(l=[],_=a.get_node().get_characterProperties()){for(var s=_.get_length()-1,u=a.get_cpBegin(),c=a.get_cpEnd(),d=!1,g=0;g<s;g++){var p=_.get_item(g).get_cp(),h=_.get_item(g+1).get_cp();if(_.get_item(g).get_formatting()&&Math.max(p,u)<Math.min(h,c))d=!0,Array.add(l,_.get_item(g).get_formatting());else if(d)break}_.get_item(s).get_formatting()&&a.get_cpEnd()>_.get_item(s).get_cp()&&Array.add(l,_.get_item(s).get_formatting())}}else if(a.get_contextId()===ol.d.paragraph){var _;if(l=[],_=a.get_node().get_characterProperties())for(g=0;g<_.get_length();g++)_.get_item(g).get_formatting()&&Array.add(l,_.get_item(g).get_formatting())}else if(a.get_contextId()===ol.d.endOfParagraph){l=[vc.FormattingReader.getFormattingObject(a)]}else if(a.get_contextId()===ol.d.insertionPoint)return void this.QueryCharacterFormattingIp(a,t);if(l&&l.length>0)for(var m=0,f=l;m<f.length;m++){var y=f[m];if(vc.FormattingReader.updateConsistentFormatting(t,y.get_cache(),a,r))return}}},e.prototype.QueryCharacterFormattingIp=function(t,n){var i=vc.FormattingReader.getFormattingObject(t);if(i){var r,o=i.get_cache();r=e.get_InsertionPointFormatting().getPropertyWithDefault(Boolean,is.b.bold,o.get_isBold()),n.bold=r?1:0,r=e.get_InsertionPointFormatting().getPropertyWithDefault(Boolean,is.b.italic,o.get_isItalic()),n.italic=r?1:0,r=e.get_InsertionPointFormatting().getPropertyWithDefault(Boolean,is.b.underline,o.get_isUnderline()),n.underline=r?1:0,n.underlineType=e.get_InsertionPointFormatting().getPropertyWithDefault(Number,is.b.underlineType,o.get_underlineType()),r=e.get_InsertionPointFormatting().getPropertyWithDefault(Boolean,is.b.superscript,o.get_isSuperscript()),n.superscript=r?1:0,r=e.get_InsertionPointFormatting().getPropertyWithDefault(Boolean,is.b.subscript,o.get_isSubscript()),n.subscript=r?1:0,r=e.get_InsertionPointFormatting().getPropertyWithDefault(Boolean,is.b.strikethrough,o.get_isStrikethrough()),n.strikethrough=r?1:0,r=e.get_InsertionPointFormatting().getPropertyWithDefault(Boolean,rs.o.doubleStrikethrough,o.get_isDoubleStrikethrough()),n.doubleStrikethrough=r?1:0;var a=e.get_InsertionPointFormatting().getPropertyWithDefault(String,is.b.font,o.get_fontFace());n.fontName=Cc.Font.getFontNameFromFace(a),n.themeFontIndex=o.get_themeFont(),n.fontSize=this._textRenderingStrategy.getFontSize(e.get_InsertionPointFormatting().getPropertyWithDefault(Number,is.b.fontSize,o.get_fontSize()),t.get_node()),n.fontColor=e.get_InsertionPointFormatting().getPropertyWithDefault(Number,is.b.fontColor,o.get_fontColor()),n.highlight=e.get_InsertionPointFormatting().getPropertyWithDefault(Number,is.b.highlight,o.get_highlight())}},e.prototype.ApplyCharacterFormattingViewAsync=function(t,n,i,r,o,a){return new zf(t,n,i,r,o,a,this._formattingViewOperationFinishedStageProcessor,e.get_ExternalSelectionManagerFuture())},e.prototype.ApplyCharacterFormatting=function(t,n,i,r,o){var a=this,l=!0,s=n;if(n.get_contextId()!==ol.d.textRange&&n.get_contextId()!==ol.d.insertionPoint?l=!1:(Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().isIpOrTextRangeContextInLockedRange(s)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),l=!1),e.get_ExternalSelectionManagerFuture()&&e.get_ExternalSelectionManagerFuture().get_instance()&&e.get_ExternalSelectionManagerFuture().get_instance().isExternalSelectionContext(s)&&(l=!1),l&&ga.SelectionEditor.isTextRangeContext(n)&&Cd.f.containsNonFormattableBlobs(s)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsNonFormattableBlob}),l=!1)),1===i||!l)return l?32:8;if(n.get_contextId()===ol.d.insertionPoint)return 2;if(this._textRenderingStrategy.shouldTrimWhiteSpaceForApplyCharacterFormatting(t)){var u=ga.SelectionEditor.trimWhitespaceFromTextRange(s);ga.SelectionEditor.isInsertionPointContext(u)||(s=u)}var c="boolean"==typeof o&&o;return e.get_TextFormattingHelper().applyCharacterFormattingOnTextRange(s,(function(e){a.SetCharacterFormatting(e,t,o,s.get_cpEnd())}),c),this.IsChangeCaseCommand(t)&&this.ChangeCaseHandler(s,t),32},e.prototype.SetCharacterFormatting=function(t,n,i,r){var o,a=t.get_cache(),l=(0,y.e)(Mf.p,i);switch(n){case Oi.u.bold:2===(o=i).value&&(o.value=a.get_isBold()?0:1),e.get_FormattingEditor().setBold(t,1===o.value);break;case Oi.u.setItalic:2===(o=i).value&&(o.value=a.get_isItalic()?0:1),e.get_FormattingEditor().setItalic(t,1===o.value);break;case Oi.u.underline:2===(o=i).value&&(o.value=a.get_isUnderline()?0:1),e.get_FormattingEditor().setUnderline(t,1===o.value);break;case Oi.u.setUnderlineType:e.get_FormattingEditor().setUnderlineType(t,i);break;case Oi.u.superscript:2===(o=i).value&&(o.value=a.get_isSuperscript()?0:1),e.get_FormattingEditor().setSuperscript(t,1===o.value);break;case Oi.u.subscript:2===(o=i).value&&(o.value=a.get_isSubscript()?0:1),e.get_FormattingEditor().setSubscript(t,1===o.value);break;case Oi.u.strikethrough:2===(o=i).value&&(o.value=a.get_isStrikethrough()?0:1),e.get_FormattingEditor().setStrikethrough(t,1===o.value);break;case Oi.u.doubleStrikethrough:2===(o=i).value&&(o.value=a.get_isDoubleStrikethrough()?0:1),e.get_FormattingEditor().setDoubleStrikethrough(t,1===o.value);break;case Oi.u.font:if(l&&l.get_actionData()){var s=l.get_actionData(),u=void 0,c=-1;if("string"==typeof s)u=s;else{var d=s;u=d.fontName,c=d.themeFontIndex}u=u.substr(0,e.MaxFontNameChars),e.get_FormattingEditor().setFontFace(t,u),Gl.n.get_instance().get_item(53)&&e.get_FormattingEditor().setThemeFont(t,c)}break;case Oi.u.setFontColor:e.get_FormattingEditor().setFontColor(t,i,null),this.get_IsRecentFontColorMenuSectionEnabled()&&Wf.get_instance().addRecentColor(i);break;case Oi.u.clearFontColor:e.get_FormattingEditor().clearFontColor(t);break;case Oi.u.setFontBackgroundColor:e.get_FormattingEditor().setFontHighlight(t,i);break;case Oi.u.clearFontBackgroundColor:e.get_FormattingEditor().clearFontHighlight(t);break;case Oi.u.setFontSize:e.get_FormattingEditor().setFontSize(t,l.get_actionData());break;case Oi.u.growFontSize:e.get_FormattingEditor().growFontSizeAndSet(t);break;case Oi.u.shrinkFontSize:e.get_FormattingEditor().shrinkFontSizeAndSet(t);break;case Oi.u.setLanguage:var g=i,p=Gl.n.get_instance().get_item(20)?os.j.noProof:Pl.k.noProofBox4,h=g.getValueWithDefault(Boolean,p,!1);e.get_FormattingEditor().setLanguageOnRange(t,g.getValue(Number,is.b.languageID),r,h);break;case Oi.u.ipProperties:e.get_FormattingEditor().setFormattingFromIp(t);break;case Oi.u.clearFormatting:e.get_FormattingEditor().clearCharacterFormatting(t);break;case Oi.u.changeCaseLower:case Oi.u.changeCaseUpper:case Oi.u.changeCaseSentence:case Oi.u.changeCaseCapitalizeEachWord:case Oi.u.changeCaseToggle:a.get_hasCapitalization()&&2===a.get_capitalization()&&e.get_FormattingEditor().clearCapitalization(t)}},e.prototype.ClearFormattingParagraphLevel=function(t,n,i,r,o){var a=!0,l=n;if(n.get_contextId()!==ol.d.textRange&&n.get_contextId()!==ol.d.insertionPoint?a=!1:(Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().isIpOrTextRangeContextInLockedRange(l)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),a=!1),a&&ga.SelectionEditor.isTextRangeContext(n)&&Cd.f.containsNonFormattableBlobs(l)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsNonFormattableBlob}),a=!1)),1===i||!a)return a?32:8;var s=l.get_node();return e.get_ParagraphEditor().clearParagraphFormatting(s,!1),32},e.prototype.ClearFormattingMultiParagraphLevel=function(t,n,i,r,o){var a={};a[sm.viewActionPerfMarkStart]=6168,a[sm.viewActionPerfMarkEnd]=6169;var l=n.view,s=null;l.get_isPageView()&&(s=l);var u=!0,c=null,d=32;if(s&&(c=s.get_selectionManager().get_selectionCollection().get_currentSelection())&&Gl.n.get_instance().get_item(14)&&(e.get_LockedRangeEditor().isSelectionInLockedRange(c)?(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsLockedRange}),d=8,u=!1):1===i&&(d=32,u=!1)),u&&Gl.n.get_instance().get_item(54)){var g=1===i?3:15,p=new Ma.GraphTransaction(g);p.setFromNode(l.get_root()),d=sm.performGenericViewLevelAction(Oi.u.clearFormattingParagraphLevel,n,i,r,o,a,12),p.dispose()}return d},e.prototype.ApplyFormattingIp=function(t,n,i,r,o){var a=!0,l=32;if(n.get_contextId()!==ol.d.insertionPoint?a=!1:Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().isIpOrTextRangeContextInLockedRange(n)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),a=!1),1===i||!a)return a?32:8;var s=n,u=s.get_node(),c=null;if(Gl.n.get_instance().get_item(54)&&Gl.n.get_instance().get_item(61)&&t===Oi.u.clearFormatting){e.get_ListEditor().clearListFromParagraph(u),e.get_ParagraphEditor().clearWordParagraphFormatting(u);var d=bs.StyleReader.getStyleSetFromParagraphNode(u).getStyleById(bs.StyleReader.get_wordStyleIdNormal());e.get_StyleEditor().setStyleOnParagraphNode(d,u,!0)}if((t!==Oi.u.clearFormatting||Gl.n.get_instance().get_item(49))&&(c=e.get_InsertionPointFormatting().getSelectionForIpFormatting(s)),c){var g=fa.SelectionManager.createMultiRangeOrGraphContext(c);l=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(g,t,2,!1,r,o)}else{var p=void 0,h=(0,y.e)(Mf.p,o),_=vc.FormattingReader.getFormattingObject(s).get_cache();switch(t){case Oi.u.font:if(h&&h.get_actionData()){var m=h.get_actionData(),f=void 0,C=-1;if("string"==typeof m)f=m;else{var S=m;f=S.fontName,C=S.themeFontIndex}e.get_InsertionPointFormatting().setFontName(f),Gl.n.get_instance().get_item(53)&&e.get_InsertionPointFormatting().setThemeFont(C)}break;case Oi.u.setFontColor:e.get_InsertionPointFormatting().setFontColor(o),this.get_IsRecentFontColorMenuSectionEnabled()&&Wf.get_instance().addRecentColor(o);break;case Oi.u.clearFontColor:e.get_InsertionPointFormatting().clearFontColor();break;case Oi.u.setFontBackgroundColor:e.get_InsertionPointFormatting().setFontHighlight(o);break;case Oi.u.clearFontBackgroundColor:e.get_InsertionPointFormatting().clearFontHighlight();break;case Oi.u.setFontSize:h.get_actionData();e.get_InsertionPointFormatting().setFontSize(h.get_actionData());break;case Oi.u.growFontSize:p=e.get_InsertionPointFormatting().getPropertyWithDefault(Number,is.b.fontSize,_.get_fontSize()),e.get_InsertionPointFormatting().setFontSize(e.get_FormattingEditor().growFontSize(p));break;case Oi.u.shrinkFontSize:p=e.get_InsertionPointFormatting().getPropertyWithDefault(Number,is.b.fontSize,_.get_fontSize()),e.get_InsertionPointFormatting().setFontSize(e.get_FormattingEditor().shrinkFontSize(p));break;case Oi.u.bold:var b=e.get_InsertionPointFormatting().getPropertyWithDefault(Boolean,is.b.bold,_.get_isBold());e.get_InsertionPointFormatting().setBold(!b);break;case Oi.u.setItalic:var v=e.get_InsertionPointFormatting().getPropertyWithDefault(Boolean,is.b.italic,_.get_isItalic());e.get_InsertionPointFormatting().setItalic(!v);break;case Oi.u.underline:var T=e.get_InsertionPointFormatting().getPropertyWithDefault(Boolean,is.b.underline,_.get_isUnderline());e.get_InsertionPointFormatting().setUnderline(!T);break;case Oi.u.setUnderlineType:e.get_InsertionPointFormatting().setUnderlineType(o);break;case Oi.u.superscript:var A=e.get_InsertionPointFormatting().getPropertyWithDefault(Boolean,is.b.superscript,_.get_isSuperscript());e.get_InsertionPointFormatting().setSuperscript(!A);break;case Oi.u.subscript:var I=e.get_InsertionPointFormatting().getPropertyWithDefault(Boolean,is.b.subscript,_.get_isSubscript());e.get_InsertionPointFormatting().setSubscript(!I);break;case Oi.u.strikethrough:var w=e.get_InsertionPointFormatting().getPropertyWithDefault(Boolean,is.b.strikethrough,_.get_isStrikethrough());e.get_InsertionPointFormatting().setStrikethrough(!w);break;case Oi.u.doubleStrikethrough:var x=e.get_InsertionPointFormatting().getPropertyWithDefault(Boolean,rs.o.doubleStrikethrough,_.get_isDoubleStrikethrough());e.get_InsertionPointFormatting().setDoubleStrikethrough(!x);break;case Oi.u.clearFormatting:e.get_InsertionPointFormatting().resetFormatting(),Gl.n.get_instance().get_item(54)||(e.get_ListEditor().clearListFromParagraph(u),e.get_ParagraphEditor().clearParagraphFormatting(u,!0),Gl.n.get_instance().get_item(71)&&e.get_StyleEditor().clearStyleOnParagraphNode(u));break;case Oi.u.setLanguage:var E=o;E.hasProperty(is.b.languageID)&&e.get_InsertionPointFormatting().setLanguage(E.getValue(Number,is.b.languageID));var F=Gl.n.get_instance().get_item(20)?os.j.noProof:Pl.k.noProofBox4;if(E.hasProperty(F)){var P=E.getValue(Boolean,F);e.get_InsertionPointFormatting().setNoProof(P)}}}return yi.App.get_activeAppFrame().updateCommandUI(),l},e.prototype.RemoveRTLFormattingProperty=function(e,t){this._clearFormattingTrackChangesIsEnabled&&Oi.u.clearFormatting===t&&_s.OutlineElementNavigator.getContainingOutlineElementNode(e).get_properties().removeProperty(is.b.outlineElementRTL)},e.prototype.ApplyFormattingEOP=function(t,n,i,r,o){var a=e.get_ActivityManager().startActivity(Oi.u.setEndOfParagraphFormatting),l=!0,s=!1;if(n.get_contextId()!==ol.d.endOfParagraph&&(l=!1),1===i||!l)return l?32:8;var u=n,c=u.get_node(),d=ha.g.createFromNode(u.get_node());d.tryToRootAtOutlineAncestor();var g=d.goToFirstSiblingByRole(4);if((s=!!g&&e.get_ListReader().isListNode(g))&&!yi.App.listBulletFormattingIsEnabled)return 8;var p=!Ga.ParagraphReader.textLength(c);if(a.get_properties().set_item("Action",t.toString()),a.get_properties().set_item("ListContext",s.toString()),a.get_properties().set_item("IsEmptyParagraph",p.toString()),S.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",t,s,p),this._eopFormattingStrategy.supportsListFormattingProperties(s))this.UpdateListFormattingProperties(t,o,g);else{var h=c,_=h.get_characterProperties().get_last();this.RemoveRTLFormattingProperty(h,t);var m=_.get_formatting(),f=e.get_CharacterPropertiesEditor().ensureEndOfParagraphFormatting(h);if(this._eopFormattingStrategy.isOnlySetEopFormatSupported(m)){var y=f.cloneUnderDifferentChp(f.get_containingProperties());this.SetCharacterFormatting(f,t,o,_.get_cp()),e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_TrackChangeEditor().setFormattingTrackChangeOnParagraph(h,_,u.get_cpBegin(),u.get_cpEnd(),y,f,e.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled())}}return a.end(),32},e.prototype.UpdateListFormattingProperties=function(t,n,i){var r=!1,o=(0,y.e)(Mf.p,n);switch(t){case Oi.u.setFontColor:e.get_ListFormattingEditor().setFontColor(i,n);break;case Oi.u.setFontSize:e.get_ListFormattingEditor().setFontSize(i,o.get_actionData());break;case Oi.u.clearFontColor:e.get_ListFormattingEditor().clearFontColor(i);break;case Oi.u.growFontSize:e.get_ListFormattingEditor().growFontSize(i);break;case Oi.u.shrinkFontSize:e.get_ListFormattingEditor().shrinkFontSize(i);break;case Oi.u.font:e.get_ListFormattingEditor().setFontFaceAndTheme(i,o.get_actionData());break;case Oi.u.bold:r=this.ResolveTriStateValueListNode(n,is.b.bold,i),e.get_ListFormattingEditor().setBold(i,r);break;case Oi.u.setItalic:r=this.ResolveTriStateValueListNode(n,is.b.italic,i),e.get_ListFormattingEditor().setItalic(i,r);break;case Oi.u.subscript:r=this.ResolveTriStateValueListNode(n,is.b.subscript,i),e.get_ListFormattingEditor().setSubscript(i,r);break;case Oi.u.superscript:r=this.ResolveTriStateValueListNode(n,is.b.superscript,i),e.get_ListFormattingEditor().setSuperscript(i,r);break;case Oi.u.strikethrough:r=this.ResolveTriStateValueListNode(n,is.b.strikethrough,i),e.get_ListFormattingEditor().setStrikethrough(i,r);break;case Oi.u.doubleStrikethrough:r=this.ResolveTriStateValueListNode(n,rs.o.doubleStrikethrough,i),e.get_ListFormattingEditor().setDoubleStrikethrough(i,r)}},e.prototype.ResolveTriStateValueListNode=function(e,t,n){var i=e;return 2===i.value&&(i.value=n?n.getValueWithDefault(Boolean,t,!1)?0:1:0),1===i.value},e.prototype.ApplyListFormattingEOP=function(t,n,i,r,o){var a=!0,l=n,s=ha.g.createFromNode(l.get_node());s.tryToRootAtOutlineAncestor(),n.get_contextId()===ol.d.endOfParagraph&&s.goToFirstSiblingByRole(4)||(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.listNotApplied}),a=!1);var u=s.get_currentNode();return e.get_ListReader().isListNode(u)?1!==i&&a?(this.UpdateListFormattingProperties(t,o,u),32):a?32:8:8},e.prototype.QueryParagraphFormatting=function(t,n,i,r,o){var a=!0;if(n.get_contextId()!==ol.d.paragraph&&(a=!1),1===i&&!a)return 8;var l=o,s=n.get_node();if(-1!==l.layoutAlignmentInParent?l.layoutAlignmentInParent!==Ga.ParagraphReader.getJustification(s)&&(l.layoutAlignmentInParent=0):l.layoutAlignmentInParent=Ga.ParagraphReader.getJustification(s),Gl.n.get_instance().get_item(54)&&Gl.n.get_instance().get_item(59)){var u=e.get_ParagraphIndentationReader().getIndentInfo(s);l.indentInfo?(!l.hasMultipleIndentTypes&&this.HasMultipleParagraphIndentTypes(l.indentInfo,u)&&2===l.indentInfo.specialIndentType&&(l.indentInfo.specialIndentType=0),l.indentInfo.indentLeftUnit===u.indentLeftUnit&&as.s.isEqualish(l.indentInfo.indentLeftValue,u.indentLeftValue)||(l.indentInfo.indentLeftValue=Number.MAX_VALUE),l.indentInfo.indentRightUnit===u.indentRightUnit&&as.s.isEqualish(l.indentInfo.indentRightValue,u.indentRightValue)||(l.indentInfo.indentRightValue=Number.MAX_VALUE)):l.indentInfo=u;var c=e.get_ContextSetEditor().attemptToGeneralizeToOutlineNodeContext(n.get_nextContext());if(null!=c){var d=c.get_node();if(null!=d){var g=up.d.get_instance().navigateToWordSectionNode(d);if(null!=g){var p=e.get_WordSectionReader().getPageWidth(g)-(e.get_WordSectionReader().getMarginLeft(g)+e.get_WordSectionReader().getMarginRight(g)+yi.App.wordPageBufferInTwips);u.indentRightMax=p-u.indentLeftValue,u.indentLeftMax=p-u.indentRightValue,l.indentInfo.indentLeftMax=Math.min(l.indentInfo.indentLeftMax,u.indentLeftMax),l.indentInfo.indentRightMax=Math.min(l.indentInfo.indentRightMax,u.indentRightMax)}}}}if(Gl.n.get_instance().get_item(54)&&Gl.n.get_instance().get_item(59)||Gl.n.get_instance().get_item(84)){var h=e.get_LineSpacingHelper().getParagraphSpacing(s);l.spacing?(l.spacing.beforeSpacing=e.AdjustCumulativeSpacingProperty(h.beforeSpacing,l.spacing.beforeSpacing),l.spacing.afterSpacing=e.AdjustCumulativeSpacingProperty(h.afterSpacing,l.spacing.afterSpacing),l.spacing.lineSpacing.unit===h.lineSpacing.unit&&as.s.isEqualish(l.spacing.lineSpacing.value,h.lineSpacing.value)||(l.spacing.lineSpacing.unit=0,l.spacing.lineSpacing.value=0)):l.spacing=h}var _=new ha.g;_.set(s),_.tryToRootAtAncestorOfType(11);var m=_.returnToAncestorOfType(11);m&&(l.isRtl=Ss.OutlineElementReader.isRtlForView(m));var f=e.get_ListReader().getListInfo(_),y=16;return null!=f&&(y=f.get_listType()),l.listType=e.GetCumulativeListType(l.listType,y),l.listInfo=16===l.listType?null:f,32},e.prototype.HasMultipleParagraphIndentTypes=function(e,t){return this.AreIndentationsDifferent(e,t)||this.AreIndentationsDifferent(t,e)},e.prototype.AreIndentationsDifferent=function(e,t){return(1===e.specialIndentType||!e.specialIndentType)&&2===t.specialIndentType},e.prototype.QueryNonParagraphFormatting=function(e,t,n,i,r){var o=r,a=t.get_node(),l=_s.OutlineElementNavigator.getContainingOutlineElementNode(a);return o.isRtl=Ss.OutlineElementReader.isRtlForView(l),32},e.prototype.ApplyTextDirectionToNonParagraph=function(t,n,i,r,o){var a;if(t===Oi.u.setTextDirectionRightToLeft)a=!0;else{if(t!==Oi.u.setTextDirectionLeftToRight)return 2;a=!1}if(a&&this.LogRtlUsage(n),1===i)return 32;var l=n.get_node(),s=_s.OutlineElementNavigator.getContainingOutlineElementNode(l);return e.get_OutlineElementEditor().setRtl(s,a),32},e.prototype.QueryImageFormatting=function(e,t,n,i,r){var o=r,a=t.get_node(),l=_s.OutlineElementNavigator.getContainingOutlineElementNode(a);return o.isRtl=Ss.OutlineElementReader.isRtl(l),o.layoutAlignmentInParent=pa.ImageReader.getJustification(a),32},e.prototype.QueryTableFormatting=function(e,t,n,i,r){var o=r,a=t.get_node(),l=_s.OutlineElementNavigator.getContainingOutlineElementNode(a);return o.isRtl=Ss.OutlineElementReader.isRtl(l),o.layoutAlignmentInParent=us.TableReader.getJustification(a),-1!==o.layoutAlignmentInParent&&o.layoutAlignmentInParent||(o.layoutAlignmentInParent=o.isRtl?3:1),32},e.prototype.ApplyTextDirectionToImage=function(t,n,i,r,o){var a;if(!$f.shouldExecuteImageAction(i,n,(0,g.m)((function(){return a}),(function(e){return a=e}))))return a;var l=n.get_node();switch(t){case Oi.u.setTextDirectionLeftToRight:case Oi.u.setTextDirectionRightToLeft:var s=_s.OutlineElementNavigator.getContainingOutlineElementNode(l),u=!0;t===Oi.u.setTextDirectionLeftToRight&&(u=!1),e.get_OutlineElementEditor().setRtl(s,u),u&&this.LogRtlUsage(n)}return 32},e.prototype.ApplyParagraphFormatting=function(t,n,i,r,o){var a;if(!$f.shouldExecuteParagraphAction(i,n,(0,g.m)((function(){return a}),(function(e){return a=e}))))return a;var l=n,s=l.get_node();switch(t){case Oi.u.setTextDirectionLeftToRight:e.get_OutlineElementEditor().setTextDir(s,!1);break;case Oi.u.setTextDirectionRightToLeft:this.LogRtlUsage(n),e.get_OutlineElementEditor().setTextDir(s,!0);break;case Oi.u.setLanguage:32===(a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(l.get_nextContext(),t,i,!0,r,o))&&Ga.ParagraphReader.isParagraphContext(l)&&e.get_ProofingManager()&&e.get_ProofingManager().spellCheck(s)}return 32},e.prototype.ClearFormattingView=function(t,n,i,r,o){var a={};a[sm.viewActionPerfMarkStart]=6168,a[sm.viewActionPerfMarkEnd]=6169;var l=n.view,s=1===i?3:15,u=new Ma.GraphTransaction(s);u.setFromNode(l.get_root());var c=sm.performGenericViewLevelAction(t,n,i,r,o,a,0),d=null;l.get_isPageView()&&(d=l);var g=!0,p=null;return d&&(p=d.get_selectionManager().get_selectionCollection().get_currentSelection())&&Gl.n.get_instance().get_item(14)&&(e.get_LockedRangeEditor().isSelectionInLockedRange(p)?(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsLockedRange}),c=8,g=!1):1===i&&(c=32,g=!1)),g&&this.IsSuperParagraphSelection(p)&&(c=Gl.n.get_instance().get_item(54)?sm.performGenericViewLevelAction(Oi.u.clearFormattingParagraphLevel,n,i,r,o,a,12):sm.performGenericViewLevelAction(t,n,i,r,o,a,12)),u.dispose(),c},e.prototype.ClearFormattingParagraph=function(t,n,i,r,o){var a=!0;if(n.get_contextId()!==ol.d.paragraph&&n.get_contextId()!==ol.d.insertionPoint?a=!1:Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().isParaStartOrEndInLockedRange(n)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),a=!1),1===i||!a)return a?32:8;var l=n.get_node(),s=new Ma.GraphTransaction(15);return s.setFromNode(l),e.get_ListEditor().clearListFromParagraph(l),e.get_ParagraphEditor().clearParagraphFormatting(l,!0),e.get_StyleEditor().clearStyleOnParagraphNode(l),s.dispose(),2},e.prototype.IsSuperParagraphSelection=function(e){return!!e&&(!ga.SelectionEditor.isInsertionPointSelection(e)&&!(1===e.get_length()&&ga.SelectionEditor.isTextRangeContext(e.get_firstContext())&&!ga.SelectionEditor.isEntireParagraphTextContext(e.get_firstContext())))},e.prototype.LogRtlUsage=function(t){e._rtlUsageLoggingDictionary.containsKey(t.get_contextId())||(S.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",t.get_contextId()),e._rtlUsageLoggingDictionary.set_item(t.get_contextId(),!0))},e.prototype.IsChangeCaseCommand=function(e){return e===Oi.u.changeCaseSentence||e===Oi.u.changeCaseLower||e===Oi.u.changeCaseUpper||e===Oi.u.changeCaseCapitalizeEachWord||e===Oi.u.changeCaseToggle},e.prototype.ChangeCaseHandler=function(t,n){var i=t.get_node(),r=i.get_characterData().substr(t.get_cpBegin(),t.get_cpEnd()-t.get_cpBegin()),o=e.textChangeCase(r,n);i.get_characterData();return i.set_characterData(i.get_characterData().substr(0,t.get_cpBegin())+o+i.get_characterData().substr(t.get_cpEnd())),32},e.get_FormattingEditor=function(){return e._formattingEditor||(e._formattingEditor=Ge.w.get_instance().resolve(Vs.z))},e.get_CharacterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=Ge.w.get_instance().resolve(ba.x))},e.get_ParagraphEditor=function(){return e._paragraphEditor||(e._paragraphEditor=Ge.w.get_instance().resolve(ns.g))},e.get_LineSpacingHelper=function(){return e._lineSpacingHelper||(e._lineSpacingHelper=Ge.w.get_instance().resolve(kf.r))},e.get_StyleEditor=function(){return e._styleEditor||(e._styleEditor=Ge.w.get_instance().resolve(ts.e))},e.get_OutlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=Ge.w.get_instance().resolve(ql.p))},e.get_InsertionPointFormatting=function(){return e._insertionPointFormatting||(e._insertionPointFormatting=Ge.w.get_instance().resolve(Fg.c))},e.get_ListFormattingEditor=function(){return e._listFormattingEditor||(e._listFormattingEditor=Ge.w.get_instance().resolve(Nf.a))},e.get_ParagraphIndentationReader=function(){return e._paragraphIndentationReader||(e._paragraphIndentationReader=Ge.w.get_instance().resolve(Sg.p))},e.get_ExternalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=Ge.w.get_instance().resolveFuture(kg.i))},e.get_ContextSetEditor=function(){return am.ContextSetEditor.get_instance()},e.get_LockedRangeEditor=function(){return za.k.get_instance()},e.get_ActivityManager=function(){return xr.y.get_instance()},e.get_FeatureHelper=function(){return e._featureHelper||(e._featureHelper=Ge.w.get_instance().tryResolve(Yh.d))},e.get_ProofingManager=function(){return yi.App.theProofingManager},e.get_TrackChangeManager=function(){return e._trackChangeManager||(e._trackChangeManager=Ge.w.get_instance().resolve(xa.b).get_instance())},e.get_TrackChangeEditor=function(){return e._trackChangeEditor||(e._trackChangeEditor=Ge.w.get_instance().resolve(es.x).get_instance())},e.get_TextFormattingHelper=function(){return e._textFormattingHelper||(e._textFormattingHelper=Ge.w.get_instance().resolve(Kf.d))},e.get_ListReader=function(){return e._listReader||(e._listReader=Ge.w.get_instance().resolve(Ql.c))},e.get_ListEditor=function(){return e._listEditor||(e._listEditor=Ge.w.get_instance().resolve(jl.v))},e.get_WordSectionReader=function(){return cp.p.get_instance()},e.GetCumulativeListType=function(e,t){return 42===e?t:e!==t||16===e?16:e},e.AdjustCumulativeSpacingProperty=function(e,t){return e.isContextualSpacing||(t.isContextualSpacing?t=e:t.unit===e.unit&&as.s.isEqualish(t.value,e.value)||(t.value=-1)),t},e.textChangeCase=function(t,n){switch(n){case Oi.u.changeCaseLower:return t.toLowerCase();case Oi.u.changeCaseUpper:return t.toUpperCase();case Oi.u.changeCaseSentence:case Oi.u.changeCaseCapitalizeEachWord:return e.ChangeTitleCase(t,n===Oi.u.changeCaseCapitalizeEachWord);case Oi.u.changeCaseToggle:return e.ToggleTextCase(t);default:return t}},e.ToggleTextCase=function(e){for(var t="",n=0;n<e.length;n++)e.charAt(n)===e.charAt(n).toUpperCase()?t+=e.charAt(n).toLowerCase():t+=e.charAt(n).toUpperCase();return t},e.ChangeTitleCase=function(t,n){for(var i,r,o=!0,a=t.length,l=0,s=e.IsSubSetenceAllCaps(t,l,a);a>0;){i=!1,r=!1;var u,c,d=a,g=0;for(g=0;d>0&&e.ChecksIfWhiteSpacePunctuationOrNonAlphaNumericChar(t.charAt(l+g));g++,d--)r=e.IsSentenceBreak(t.charAt(l+g));for(u=g;d>0&&(!(i=e.IsSentenceBreak(t.charAt(l+g)))&&" "!==t.charAt(l+g)&&"/"!==t.charAt(l+g));g++,d--);if((c=g-u)<=0)break;l+=u;var p=t.substr(l,c),h=p===p.toUpperCase();!s&&h||(t=o||r||n?t.substr(0,l)+t.charAt(l).toUpperCase()+t.substr(l+1,c-1).toLowerCase()+t.substr(l+c):t.substr(0,l)+t.substr(l,c).toLowerCase()+t.substr(l+c)),a-=c+u,l+=c,o=i,i&&(l++,a--,s=e.IsSubSetenceAllCaps(t,l,a))}return t},e.IsSubSetenceAllCaps=function(t,n,i){for(;i>0&&!e.IsSentenceBreak(t.charAt(n));){if(t.charAt(n)!==t.charAt(n).toUpperCase())return!1;n++,i--}return!0},e.IsSentenceBreak=function(e){return"."===e||"!"===e||"?"===e},e.ChecksIfWhiteSpacePunctuationOrNonAlphaNumericChar=function(e){return-1==="0123456789".indexOf(e)&&e.toUpperCase()===e.toLowerCase()},e.MaxFontNameChars=31,e._formattingEditor=null,e._outlineElementEditor=null,e._rtlUsageLoggingDictionary=new d.w(Boolean),e._lineSpacingHelper=null,e._characterPropertiesEditor=null,e._paragraphEditor=null,e._styleEditor=null,e._insertionPointFormatting=null,e._listFormattingEditor=null,e._paragraphIndentationReader=null,e._externalSelectionManagerFuture=null,e._featureHelper=null,e._trackChangeManager=null,e._trackChangeEditor=null,e._textFormattingHelper=null,e._listReader=null,e._listEditor=null,e}();(0,o.l)(qf,"4fd18f20$TextFormattingActor",null,[]);var jf=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.get_ActionManager=function(){return this._actionManager},e.prototype.setFormattingFromIp=function(e,t){void 0===t&&(t=!1),this.get_ActionManager().processActionAgainstContext(e,Oi.u.ipProperties,2,!0,null,t)},e.prototype.setLanguage=function(e){this.get_ActionManager().processActionWithData(Oi.u.setLanguage,2,e)},e}();(0,o.l)(jf,"b9d6b49f$TextFormattingCommands",null,[su.n]);var Qf=(0,o.y)("68968943$IViewActionHandler"),Jf=function(){function e(){}return e.prototype.get_viewActionPerfMarkStart=function(){return sm.viewActionPerfMarkStart},e.prototype.get_viewActionPerfMarkEnd=function(){return sm.viewActionPerfMarkEnd},e.prototype.get_viewActionCollapseIp=function(){return sm.viewActionCollapseIp},e.prototype.performGenericViewLevelAction=function(e,t,n,i,r,o,a){return sm.performGenericViewLevelAction(e,t,n,i,r,o,a)},e.prototype.performGenericViewLevelActionAgainstOEs=function(e,t,n,i,r,o){return sm.performGenericViewLevelActionAgainstOEs(e,t,n,i,r,o)},e.get_instance=function(){return e._instance||(e._instance=new e),e._instance},e._instance=null,e}();(0,o.l)(Jf,"83852ec6$ViewActionHandlerProxy",null,[Qf]);var Xf=n(8083),Yf=function(e){function t(){var t=e.call(this,1,3)||this;return t.testHook=!1,t}return(0,v.t)(t,e),t.prototype.disposeFloatie=function(){var e=(0,y.e)(Sys.IDisposable,this._floatie);e&&e.dispose(),this._floatie=null},t.prototype.showFloatieAt=function(e,t,n){var i=n?this.rtlReferencePoint:this.ltrReferencePoint;this.ensureFloatieConstructedIfAvailable(),this._floatie&&(this._floatie.get_isVisible()&&this._floatie.dismissFloatie(),this.testHook||(0,y.e)(Wc.z,this._floatie).pollForStateAndUpdate(),this._floatie.showFloatieAt(e,i,t,!0))},t.prototype.ensureFloatieConstructedIfAvailable=function(){return this.get_floatieFactory()&&!this._floatie&&(this._floatie=this._floatieFactory()),this._floatie},t.prototype.expandFloatie=function(){if(this._floatie&&this._floatie.get_isVisible()){var e=(0,y.e)(cr.Control,this._floatie.get_controls()["PasteFloatie.FlyoutAnchor"]);e.behavior.doDefaultAction(e.getDisplayedComponentElement(),1,null)}},t}(Xf.r);(0,o.l)(Yf,"41c0ef59$PasteFloatieManager",Xf.r,[]);var Zf=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.get_ActionManager=function(){return this._actionManager},e.prototype.moveCursor=function(e){var t;if(4===e)t=Oi.u.leftArrow;else if(2===e)t=Oi.u.rightArrow;else if(1===e)t=Oi.u.upArrow;else{if(3!==e)return;t=Oi.u.downArrow}this.get_ActionManager().processAction(t,2)},e.prototype.expandSelection=function(){this.get_ActionManager().processAction(Oi.u.expandSelection,2)},e}();(0,o.l)(Zf,"51040b2b$SelectionCommands",null,[xg.i]);var ey=n(445),ty=function(){function e(){}return e.prototype.createIpSelection=function(e,t){return Ua.SelectionFactory.createIpSelection(e,t)},e.prototype.extendSelection=function(e,t){return Ua.SelectionFactory.extendSelection(e,t)},e.prototype.createSelectionFromContext=function(e,t){return void 0===t&&(t=!0),Ua.SelectionFactory.createSelectionFromContext(e,t)},e.prototype.createTextRangeOrIpSelection=function(e,t,n){return Ua.SelectionFactory.createTextRangeOrIpSelection(e,t,n)},e.prototype.createSelectionFromNode=function(e){return Ua.SelectionFactory.createSelectionFromNode(e)},e.prototype.tryExtendTableCellSelection=function(e,t,n,i){return void 0===i&&(i=!1),Ua.SelectionFactory.tryExtendTableCellSelection(e,t,n,i)},e}();(0,o.l)(ty,"d5e05287$SelectionFactoryProxy",null,[Kd]);var ny=n(6177),iy=n(1705),ry=n(9394),oy=function(e){function t(t,n,i,r,o,a,l,s){void 0===l&&(l=null),void 0===s&&(s=null);var u=e.call(this,t,a,l,s)||this;return u._internalLinkManager=null,u._paragraphEditor=null,u._formatting=null,u._formattingInvalidated=!1,u._pastingIntoList=!1,u._nestedListCount=0,u._tableSteward=null,u.indentationEditor=null,u.listEditor=null,u.listReader=null,u.box4PasteStewardBridge=null,u._followDestinationFormattingPasteIsEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FollowDestinationFormattingPasteIsEnabled"),u._tablesToDelist=new C.c(mm.k),El.r.shipAssertTag(8128527,307,Ss.OutlineElementReader.isOutlineElement(t)),u._tableSteward=n,u._tableSteward.bindToOwnerSteward(u),u.indentationEditor=i,u.listEditor=r,u.listReader=o,u.box4PasteStewardBridge=s,u._pastingIntoList=gs.ListReader.isListOutlineElement(u._iterator),u}return(0,v.t)(t,e),t.prototype.get_InternalLinkManager=function(){return this._internalLinkManager||(this._internalLinkManager=Ge.w.get_instance().tryResolve(Na.v))},t.prototype.get_ParagraphEditor=function(){return this._paragraphEditor||(this._paragraphEditor=Ge.w.get_instance().resolve(ns.g))},t.prototype.get_currentFormatting=function(){return null},t.prototype.get_continuingExistingList=function(){return this._pastingIntoList&&!this._tableSteward.get_currentlyInsidePastedTable()},t.prototype.get_currentlyUnderPastedList=function(){return this._nestedListCount>0},t.prototype.get_indentationEditor=function(){return this.indentationEditor},t.prototype.get_listEditor=function(){return this.listEditor},t.prototype.get_listReader=function(){return this.listReader},t.prototype.get_box4PasteStewardBridge=function(){return this.box4PasteStewardBridge},t.prototype.onText=function(e,t){if(!this._box4PasteStewardBridge.tryHandlePageBreak(this._iterator,t,!0)){El.r.shipAssertTag(8701077,307,Ga.ParagraphReader.isParagraph(this._iterator));var n=this._iterator.get_currentNode(),i=Wa.y.createIpContextAtEndOfParagraph(n);if(this._followDestinationFormattingPasteIsEnabled&&this._formatting.get_formattingObject()){var r=n.get_characterProperties().get_last();this._formattingInvalidated&&(r.set_formatting(this._formatting.get_formattingObject().cloneUnderDifferentChp(r)),this._formattingInvalidated=!1),e=this._box4PasteStewardBridge.handleParagraphEnd(e,t),this._box4PasteStewardBridge.setParagraphProperties(this._iterator.get_currentNode(),this._formatting.get_paragraphProperties(),t)}this.get_characterPropertiesEditor().replaceTextRange(i,e)}},t.prototype.onLineBreak=function(e){El.r.shipAssertTag(8701078,307,Ga.ParagraphReader.isParagraph(this._iterator));var t=this._iterator.get_currentNode(),n=Wa.y.createIpContextAtEndOfParagraph(t);this.get_characterPropertiesEditor().insertBlobAtIp(n,(function(e){return new Lm.y(e,Lm.y.defaultLineBreakText)}),cs.AParagraphNode.embeddedObjectText)},t.prototype.onTab=function(e){this._box4PasteStewardBridge.handleTabCharacter(this._iterator,e)},t.prototype.onFormattingChange=function(e){this._followDestinationFormattingPasteIsEnabled&&(this._formattingInvalidated=!0)},t.prototype.onAnchorStart=function(e,t){El.r.shipAssertTag(8701079,307,Ga.ParagraphReader.isParagraph(this._iterator))},t.prototype.onAnchorEnd=function(){El.r.shipAssertTag(8701080,307,Ga.ParagraphReader.isParagraph(this._iterator))},t.prototype.onParagraphStart=function(e){this._tableSteward.get_currentlyInsidePastedTable()||(this._followDestinationFormattingPasteIsEnabled?(this.AppendNewParagraph(e),this._formatting.tryApplyParagraphStyle(this._iterator.get_currentNode()),e&&"P"===e.get_ownerHtmlElementInfo().get_htmlElementType()&&this.get_box4PasteStewardBridge().setParagraphSpacing(this._iterator.get_currentNode(),this._formatting.get_paragraphSpacing()),this._box4PasteStewardBridge.setParagraphProperties(this._iterator.get_currentNode(),this._formatting.get_paragraphProperties(),e)):this.BeginParagraph(e))},t.prototype.onParagraphEnd=function(){this._tableSteward.get_currentlyInsidePastedTable()||this.EndParagraph()},t.prototype.onMathStart=function(e,t){},t.prototype.onMathEnd=function(){},t.prototype.onListStart=function(e){El.r.shipAssertTag(8701081,307,Ss.OutlineElementReader.isOutlineElement(this._iterator)||ys.OutlineReader.isOutline(this._iterator)||Ga.ParagraphReader.isParagraph(this._iterator)&&this._tableSteward.get_currentlyInsidePastedTable());var t=!1;this.get_currentlyUnderPastedList()||(t=this.get_continuingExistingList()||this.get_listReader().doListItemsAutoIndent()),t||this.set_pendingIndentationLevel(this.get_pendingIndentationLevel()+1),this._nestedListCount++},t.prototype.onListEnd=function(){this._nestedListCount--;var e=!1;this.get_currentlyUnderPastedList()||(e=this.get_continuingExistingList()||this.get_listReader().doListItemsAutoIndent(),this.get_listEditor().removeListsFromTablesIfNecessary(this._tablesToDelist)),e||(this.set_pendingIndentationLevel(this.get_pendingIndentationLevel()-1),this.get_pendingIndentationLevel())},t.prototype.onListItemStart=function(e){El.r.shipAssertTag(8701082,307,Ss.OutlineElementReader.isOutlineElement(this._iterator)||ys.OutlineReader.isOutline(this._iterator)||Ga.ParagraphReader.isParagraph(this._iterator)&&this._tableSteward.get_currentlyInsidePastedTable()),El.r.shipAssertTag(8701083,307,!!e.get_listStyleType())},t.prototype.onListItemEnd=function(){El.r.shipAssertTag(8701084,307,Ss.OutlineElementReader.isOutlineElement(this._iterator)||Ga.ParagraphReader.isParagraph(this._iterator)&&this._tableSteward.get_currentlyInsidePastedTable()),this._tableSteward.get_currentlyInsidePastedTable()||El.r.shipAssertTag(8701085,307,this._iterator.hasChildrenOfRole(2))},t.prototype.onTableStart=function(e){this._tableSteward.onTableStart(e)},t.prototype.onTableEnd=function(){this._tableSteward.onTableEnd()},t.prototype.trackTableToDelist=function(e){this._tablesToDelist.add(e)},t.prototype.onTableRowStart=function(e){this._tableSteward.onTableRowStart(e)},t.prototype.onTableRowEnd=function(){this._tableSteward.onTableRowEnd()},t.prototype.onTableCellStart=function(e){this._tableSteward.onTableCellStart(e)},t.prototype.onTableCellEnd=function(){this._tableSteward.onTableCellEnd()},t.prototype.onTablePartStart=function(e){this._tableSteward.onTablePartStart(e)},t.prototype.onTablePartEnd=function(){this._tableSteward.onTablePartEnd()},t.prototype.BeginParagraph=function(e){this.moveToNextOutlineElementForHtmlImport(!1),(new ha.g).setFrom(this._iterator);var t=ry.a.get_outlineElementEditor().createParagraph(this._iterator,this.getNewOutlineElementInfo(e));El.r.shipAssertTag(8128534,307,t===this._iterator.get_currentNode()),El.r.shipAssertTag(8128535,307,Ga.ParagraphReader.isParagraphNode(t))},t.prototype.EndParagraph=function(){El.r.shipAssertTag(8128536,307,Ga.ParagraphReader.isParagraph(this._iterator)),_s.OutlineElementNavigator.returnToOutlineElement(this._iterator)},t.prototype.reset=function(){this._followDestinationFormattingPasteIsEnabled&&(e.prototype.reset.call(this),this._formatting=this.getDefaultFormatting(!0))},t.prototype.AppendNewParagraph=function(e){this.moveToNextOutlineElementForHtmlImport(!1),(new ha.g).setFrom(this._iterator);var t=ry.a.get_outlineElementEditor().createParagraph(this._iterator,this.getNewOutlineElementInfo(e));El.r.shipAssertTag(36577367,307,t===this._iterator.get_currentNode()),El.r.shipAssertTag(36577368,307,Ga.ParagraphReader.isParagraphNode(t)),-1!==this._formatting.get_justification()&&this.get_ParagraphEditor().setJustification(t,this._formatting.get_justification()),this._formatting.get_lineSpacing()&&this.get_box4PasteStewardBridge().setLineSpacing(t,this._formatting.get_lineSpacing()),this._formatting.get_specialIndent()&&this.get_box4PasteStewardBridge().setSpecialIndent(t,this._formatting.get_specialIndent()),this._formatting.get_leftIndent()&&this.get_box4PasteStewardBridge().setLeftIndent(t,this._formatting.get_leftIndent()),this._formattingInvalidated=!0,this._formatting.set_paragraph(t)},t.ConvertToTwips=function(e,t){var n=0;switch(t){case 3:n=Vu.r.inchesToTwips(e);break;case 7:n=np.j.pixelsToTwips(e,0);break;case 1:n=Vu.r.centimetersToTwips(e);break;case 5:var i=Vu.r.pointsToInches(e);n=Vu.r.inchesToTwips(i);break;default:S.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",e,t)}return n},t}(ry.a);(0,o.l)(oy,"e929e2f4$TextOnlyBox4PasteSteward",ry.a,[]);var ay=function(){function e(e,t,n,i){this._outlineElementIndentationEditor=null,this._listEditor=null,this._listReader=null,this._box4PasteStewardBridge=null,this._outlineElementIndentationEditor=e,this._listEditor=t,this._listReader=n,this._box4PasteStewardBridge=i}return e.prototype.create=function(e,t,n,i,r,o){return void 0===r&&(r=null),void 0===o&&(o=null),1===e?new oy(t,i,this._outlineElementIndentationEditor,this._listEditor,this._listReader,r,o,this._box4PasteStewardBridge):new iy.Box4PasteSteward(t,n,i,this._outlineElementIndentationEditor,this._listEditor,this._listReader,r,o,this._box4PasteStewardBridge)},e}();(0,o.l)(ay,"4aec30a9$Box4PasteStewardFactory",null,[kd]);var ly=(0,o.y)("d5d54079$IBox4TableSteward"),sy=function(){function e(){}return e.get_HtmlClassStyleToPersistedStyleName=function(){return e._htmlClassStyleToBuildInStyleName},e.get_HtmlValignStyleToVerticalAlignPersistedValue=function(){return e._htmlValignStyleToVerticalAlignPersistedValue},e.get_HtmlStyleToBorderPersistedValue=function(){return e._htmlStyleToBorderPersistedValue},e.ProcessMergedCell=function(t,n){var i=t.get_currentNode();Pd.TableNavigator.forEachCell(t,n.rowSpan,n.colSpan,(function(t,r,o){var a=t.get_currentNode();a!==i&&(a.set_isGhostCell(!0),e.DetachChildrenNodes(t),o||n.colSpan>=1&&a.set_colSpan(n.colSpan),e.SetGhostCellBorders(t,n.tableCellBorderProperties,r,o,n.rowSpan,n.colSpan))}))},e.ProcessSkippedCell=function(t,n){Pd.TableNavigator.forEachCell(t,n.rowSpan,n.colSpan,(function(t,n,i){e.ApplySkippedCellProperties(t),e.DetachChildrenNodes(t)}))},e.ApplySkippedCellProperties=function(e){var t=e.get_currentNode();t.set_isGhostCell(!0),t.set_isSkippedCell(!0),t.set_shouldRenderCell(!0)},e.DetachChildrenNodes=function(e){e&&(e.goToFirstChildByRole(1),o.r(dm.w,e.get_currentNode())&&e.disconnectNodeAndReturnToParent())},e.ApplyWidthToCell=function(e,t,n){if(t>0){var i=(0,y.e)(pm.TableCellNode,e.get_currentNode());if(!i)return;i.set_width(n?t:np.j.pixelsToMu(t,0))}},e.ApplyIdentationToTable=function(e,t,n){var i=(0,y.e)(Ym.f,e.get_currentNode());i&&(t>0&&i.set_paraSpacingLeft(np.j.pixelsToTwips(t,0)),n>0&&i.set_paraSpacingRight(np.j.pixelsToTwips(n,0)))},e.ApplyVerticalAlignToCell=function(t,n){null!=n&&t.get_currentNode().get_properties().setValue(os.j.tableCellVerticalAlignment,e.get_HtmlValignStyleToVerticalAlignPersistedValue()[n+""])},e.ApplyShadingToCell=function(e,t){if(null!=t&&""!==t){var n=parseInt(iy.Box4PasteSteward.ConvertRgbToBgr(t),16);e.get_currentNode().get_properties().setValue(is.b.cellShadingColor,n)}},e.GetUsablePageWidth=function(e){var t=new ha.g;t.setFrom(e);var n=fs.OutlineNavigator.returnToOutline(t);return n&&ys.OutlineReader.isOutline(t)?n.getProperty_Unchecked(os.j.pageWidth)-n.getProperty_Unchecked(os.j.marginLeft)-n.getProperty_Unchecked(os.j.marginRight):0},e.IsRenderableBorder=function(e){return!(null==e||1===e)},e.SetBorderWidth=function(t,n,i,r,o){if(null==n||""!==n){var a=0;switch(n){case"thin":a=Vu.r.pointsToEighths(.25);break;case"initial":case"medium":a=Vu.r.pointsToEighths(.5);break;case"thick":a=Vu.r.pointsToEighths(1);break;default:a=e.GetStorableBorderWidthFromValue(n,i,r)}o.get_currentNode().get_properties().setValue(t,a)}},e.SetBorderStyle=function(t,n,i){null!=n&&n&&i.get_currentNode().get_properties().setValue(t,e.get_HtmlStyleToBorderPersistedValue()[n+""])},e.SetBorderColor=function(e,t,n){if(null!=t&&""!==t){var i=parseInt(iy.Box4PasteSteward.ConvertRgbToBgr(t),16);n.get_currentNode().get_properties().setValue(e,i)}},e.GetStorableBorderWidthFromValue=function(e,t,n){var i=0,r=0,o=iy.Box4PasteSteward.ParseCssValue(e,(0,g.m)((function(){return r}),(function(e){return r=e})));switch(r){case 5:i=Vu.r.pointsToEighths(o);break;case 1:i=Vu.r.centimetersToEighths(o);break;case 3:i=Vu.r.inchesToEighths(o);break;case 7:i=np.j.pixelsToEighths(o,n)}return 6!==t&&7!==t&&10!==t||(i/=3),Math.round(i)},e.GetStorableMarginFromValue=function(e,t){var n=0,i=0,r=iy.Box4PasteSteward.ParseCssValue(e,(0,g.m)((function(){return i}),(function(e){return i=e})));switch(i){case 5:n=Vu.r.pointsToMu(r);break;case 1:n=Vu.r.centimetersToMu(r);break;case 3:n=Vu.r.inchesToMu(r);break;case 7:n=np.j.pixelsToMu(r,t)}return n},e.SetCellBorders=function(t,n,i,r,o,a,l){if(o&&(!l||16===o.get_currentNodeType()||l||14!==o.get_currentNodeType())&&12!==i){var s,u,c,d;if(l)switch(r){case 5:s=os.j.tableBorderTopColor,u=os.j.tableBorderTopStyle,c=os.j.tableBorderTopSize,d=0;break;case 4:s=os.j.tableBorderRightColor,u=os.j.tableBorderRightStyle,c=os.j.tableBorderRightSize,d=1;break;case 0:s=os.j.tableBorderBottomColor,u=os.j.tableBorderBottomStyle,c=os.j.tableBorderBottomSize,d=0;break;case 3:s=os.j.tableBorderLeftColor,u=os.j.tableBorderLeftStyle,c=os.j.tableBorderLeftSize,d=1;break;default:return}else switch(r){case 5:s=os.j.tableCellBorderTopColor,u=os.j.tableCellBorderTopStyle,c=os.j.tableCellBorderTopSize,d=0;break;case 4:s=os.j.tableCellBorderRightColor,u=os.j.tableCellBorderRightStyle,c=os.j.tableCellBorderRightSize,d=1;break;case 0:s=os.j.tableCellBorderBottomColor,u=os.j.tableCellBorderBottomStyle,c=os.j.tableCellBorderBottomSize,d=0;break;case 3:s=os.j.tableCellBorderLeftColor,u=os.j.tableCellBorderLeftStyle,c=os.j.tableCellBorderLeftSize,d=1;break;default:return}void 0!==o.get_currentNode()&&null!==o.get_currentNode()&&(e.IsRenderableBorder(i)?(e.SetBorderColor(s,t,o),e.SetBorderStyle(u,i,o),e.SetBorderWidth(c,n,i,d,o)):a||l||o.get_currentNode().get_properties().setValue(u,"nil"))}},e.SetGhostCellBorders=function(t,n,i,r,o,a){r||(e.ApplyLeftCellBorder(n,t,!1,!1),e.ApplyRightCellBorder(n,t,!0,!1)),r===a-1&&e.ApplyRightCellBorder(n,t,!0,!1),i||e.ApplyTopCellBorder(n,t,!0,!1),i===o-1&&e.ApplyBottomCellBorder(n,t,!0,!1)},e.ApplyAllTableCellBorders=function(t,n,i,r){t&&(e.ApplyTopCellBorder(t,n,i,r),e.ApplyRightCellBorder(t,n,i,r),e.ApplyBottomCellBorder(t,n,i,r),e.ApplyLeftCellBorder(t,n,i,r))},e.ApplyTopCellBorder=function(t,n,i,r){e.SetCellBorders(t.borderTopColor,t.borderTopWidth,t.borderTopStyle,5,n,i,r)},e.ApplyRightCellBorder=function(t,n,i,r){e.SetCellBorders(t.borderRightColor,t.borderRightWidth,t.borderRightStyle,4,n,i,r)},e.ApplyBottomCellBorder=function(t,n,i,r){e.SetCellBorders(t.borderBottomColor,t.borderBottomWidth,t.borderBottomStyle,0,n,i,r)},e.ApplyLeftCellBorder=function(t,n,i,r){e.SetCellBorders(t.borderLeftColor,t.borderLeftWidth,t.borderLeftStyle,3,n,i,r)},e.SetCellMargin=function(t,n,i){if(i&&16===i.get_currentNodeType()&&""!==t){var r,o;switch(n){case 3:r=os.j.tableCellTopMargin,o=0;break;case 2:r=os.j.tableCellRightMargin,o=1;break;case 0:r=os.j.tableCellBottomMargin,o=0;break;case 1:r=os.j.tableCellLeftMargin,o=1;break;default:return}var a=e.GetStorableMarginFromValue(t,o);a&&i.get_currentNode().get_properties().setValue(r,a)}},e.ApplyAllTableCellMargins=function(t,n){n&&(e.ApplyTopCellMargin(n,t),e.ApplyRightCellMargin(n,t),e.ApplyBottomCellMargin(n,t),e.ApplyLeftCellMargin(n,t))},e.ApplyTopCellMargin=function(t,n){e.SetCellMargin(t.cellMarginTop,3,n)},e.ApplyRightCellMargin=function(t,n){e.SetCellMargin(t.cellMarginRight,2,n)},e.ApplyBottomCellMargin=function(t,n){e.SetCellMargin(t.cellMarginBottom,0,n)},e.ApplyLeftCellMargin=function(t,n){e.SetCellMargin(t.cellMarginLeft,1,n)},e.NestedTablePixelsToChop=8,e.NormalTableStyleIdName="Normal Table",e.DefaultTableStyleIdName="Table Grid",e._htmlClassStyleToBuildInStyleName=P.j.toDictionary("MsoNormalTable","Normal Table","MsoTableGrid",e.DefaultTableStyleIdName,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6"),e._htmlValignStyleToVerticalAlignPersistedValue=P.j.toDictionary("0","center","1","top","2","center","3","bottom"),e._htmlStyleToBorderPersistedValue=P.j.toDictionary("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset"),e}();(0,o.l)(sy,"9b5c9536$Box4TableStewardHelper",null,[]);var uy=function(){function e(e,t,n,i,r,o){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),this._iterator=null,this._box4PasteSteward=null,this._pasteTableImprovementsIsEnabled=!1,this._pasteComplexTableImprovementsIsEnabled=!1,this._pasteTableCellMarginImprovementsIsEnabled=!1,this._nestedTableCount=0,this.listEditor=null,this.tableEditor=null,this._iterator=e,this.listEditor=t,this.tableEditor=n,this._pasteTableImprovementsIsEnabled=i,this._pasteComplexTableImprovementsIsEnabled=r,this._pasteTableCellMarginImprovementsIsEnabled=o}return e.prototype.bindToOwnerSteward=function(e){this._box4PasteSteward=e},e.prototype.get_currentlyInsidePastedTable=function(){return this._nestedTableCount>0},e.prototype.onTableStart=function(e){El.r.shipAssertTag(7869459,307,!!this._box4PasteSteward),El.r.shipAssertTag(7869460,307,Ss.OutlineElementReader.isOutlineElement(this._iterator)||ys.OutlineReader.isOutline(this._iterator)),El.r.traceTag(38563978,307,50,"Table pasting started"),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableImprovementsSettings"),this._box4PasteSteward.moveToNextOutlineElementForHtmlImport(!0);var t=new ha.g;t.setFrom(this._iterator);var n=(0,y.e)(String,sy.get_HtmlClassStyleToPersistedStyleName()[e.styleId]);e.tableLook;n||(n=sy.DefaultTableStyleIdName);var i=this.tableEditor.recreatePastedTable(this._iterator,e.rowCount,e.colCount,n,e.tableLook,this._box4PasteSteward.getNewOutlineElementInfo(e),e.isBorderHidden);if(this._pasteTableImprovementsIsEnabled&&(El.r.traceTag(23938568,307,50,e.colWidths?"Table-widths exist":"Table-widths missing, table may be invalid"),e.tableBorderProperties&&sy.ApplyAllTableCellBorders(e.tableBorderProperties,this._iterator,!1,!0),sy.ApplyIdentationToTable(this._iterator,e.indentationProperties.spaceBefore,e.indentationProperties.spaceAfter),e.colWidths)){var r=0,o=new Array(e.colWidths.length),a=0;e.isRelativeWidth&&Gl.n.get_instance().get_item(63)&&(a=(a=Vu.r.twipsToMu(sy.GetUsablePageWidth(this._iterator)))||1);for(var l=0;l<e.colWidths.length;l++)o[l]=a>0?e.colWidths[l]*(a/100):np.j.pixelsToMu(e.colWidths[l],0),r+=o[l];var s=i.getValue(Array,is.b.tableColumnWidths),u=new ha.g;u.setFrom(this._iterator);var c=0;if(js.TableCellReader.isInTableCell(u)){var d=Pd.TableNavigator.returnToContainingCell(u);d&&(c=d.get_width());var g=Fd.s.getColumnIndex(u),p=Pd.TableNavigator.returnToContainingTable(u);if(-1!==g&&g<=p.get_columnWidths().length){var h=0;for(l=g;l<g+d.get_colSpan()&&l<p.get_columnWidths().length;l++)h+=p.get_columnWidths()[l];(c=Math.min(c,h))===h&&(c-=np.j.pixelsToMu(sy.NestedTablePixelsToChop,0))}}else if(s)for(l=0;l<s.length;l++)c+=s[l];if(c>0&&r>c&&r){var _=c/r;for(l=0;l<o.length;l++)o[l]*=_}i.setValue(is.b.tableColumnWidths,o)}this._box4PasteSteward.applyPendingListAndIndentationInfo(t,!1),this._nestedTableCount++,Gl.n.get_instance().get_item(63)&&gs.ListReader.isListOutlineElement(t)&&this._box4PasteSteward.trackTableToDelist(t.get_currentNode()),El.r.shipAssertTag(7869461,307,us.TableReader.isTable(this._iterator))},e.prototype.onTableEnd=function(){El.r.shipAssertTag(7869462,307,!!this._box4PasteSteward),El.r.shipAssertTag(7869463,307,Dd.v.isTableRow(this._iterator)),El.r.traceTag(38563979,307,50,"Table pasting finished"),_s.OutlineElementNavigator.returnToOutlineElement(this._iterator),this._nestedTableCount--},e.prototype.onTableRowStart=function(e){El.r.shipAssertTag(7869464,307,!!this._box4PasteSteward),us.TableReader.isTable(this._iterator)?Pd.TableNavigator.moveToFirstRow(this._iterator):Dd.v.isTableRow(this._iterator)&&Pd.TableNavigator.moveToNextRow(this._iterator),this._pasteTableImprovementsIsEnabled&&e.height&&this._iterator.get_currentNode().setValue(os.j.tableRowHeight,np.j.pixelsToMu(e.height,1)),El.r.shipAssertTag(7869465,307,Dd.v.isTableRow(this._iterator))},e.prototype.onTableRowEnd=function(){El.r.shipAssertTag(7869466,307,!!this._box4PasteSteward),El.r.shipAssertTag(7869467,307,js.TableCellReader.isTableCell(this._iterator)),Pd.TableNavigator.returnToContainingRow(this._iterator)},e.prototype.onTableCellStart=function(e){if(El.r.shipAssertTag(7869468,307,!!this._box4PasteSteward),El.r.shipAssertTag(7869469,307,!this._box4PasteSteward.get_pendingIndentationLevel()),Dd.v.isTableRow(this._iterator)?Pd.TableNavigator.moveToFirstColumn(this._iterator):js.TableCellReader.isTableCell(this._iterator)?Pd.TableNavigator.moveToNextColumn(this._iterator):El.r.shipAssertTag(7869471,307,!1),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this._pasteComplexTableImprovementsIsEnabled){if(!this._iterator.get_currentNode())return;var t=(0,y.e)(pm.TableCellNode,this._iterator.get_currentNode()),n=!t&&16!==this._iterator.get_currentNode().get_type()||!!t&&16===this._iterator.get_currentNode().get_type();if(El.r.shipAssertTag(50689760,307,n),!t)return;if((r=new ha.g).setFrom(this._iterator),!e.colSpan||!e.rowSpan)return;if(e.isSkipCell)return void sy.ProcessSkippedCell(r,e);if(e.colSpan>1||e.rowSpan>1){var i=Pd.TableNavigator.returnToContainingTable(r);if(!i)return;i.setValue(os.j.complexTable,!0),r.setFrom(this._iterator),sy.ProcessMergedCell(r,e),t.set_rowSpan(e.rowSpan),t.set_colSpan(e.colSpan)}}if(this._pasteTableImprovementsIsEnabled&&(sy.ApplyShadingToCell(this._iterator,e.shadingColor),sy.ApplyVerticalAlignToCell(this._iterator,e.verticalAlignment),this._pasteTableCellMarginImprovementsIsEnabled&&sy.ApplyAllTableCellMargins(this._iterator,e.tableCellMarginProperties)),this._pasteComplexTableImprovementsIsEnabled&&sy.ApplyAllTableCellBorders(e.tableCellBorderProperties,this._iterator,!e.colSpan&&!e.rowSpan,!1),this._pasteTableImprovementsIsEnabled){var r;if(!this._pasteComplexTableImprovementsIsEnabled)(r=new ha.g).setFrom(this._iterator),Pd.TableNavigator.forEachCell(r,e.rowSpan,e.colSpan,(function(t,n,i){sy.ApplyShadingToCell(t,e.shadingColor),sy.ApplyVerticalAlignToCell(t,e.verticalAlignment),sy.SetGhostCellBorders(t,e.tableCellBorderProperties,n,i,e.rowSpan,e.colSpan)}));sy.ApplyWidthToCell(this._iterator,e.width,e.isRelativeWidth)}El.r.shipAssertTag(7869472,307,ys.OutlineReader.isOutline(this._iterator))},e.prototype.onTableCellEnd=function(){El.r.shipAssertTag(7869473,307,!!this._box4PasteSteward),El.r.shipAssertTag(7869474,307,Ss.OutlineElementReader.isOutlineElement(this._iterator)||js.TableCellReader.isTableCell(this._iterator)),Pd.TableNavigator.returnToCell(this._iterator),El.r.shipAssertTag(7869475,307,this._box4PasteSteward.get_pendingIndentationLevel()<=0),this._box4PasteSteward.clearPendingIndentation()},e.prototype.onTablePartStart=function(e){El.r.shipAssertTag(7869504,307,!1)},e.prototype.onTablePartEnd=function(){El.r.shipAssertTag(7869505,307,!1)},e.get_OutlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=Ge.w.get_instance().resolve(ql.p))},e._outlineElementEditor=null,e}();(0,o.l)(uy,"732cd2b0$Box4TableSteward",null,[ly,__.p]);var cy=function(){function e(e,t,n){this._iterator=null,this._box4PasteSteward=null,this._nestedTableCount=0,this.listEditor=null,this.tableEditor=null,this._iterator=e,this.listEditor=t,this.tableEditor=n}return e.prototype.bindToOwnerSteward=function(e){this._box4PasteSteward=e},e.prototype.get_currentlyInsidePastedTable=function(){return this._nestedTableCount>0},e.prototype.onTableStart=function(e){this.get_currentlyInsidePastedTable()&&(El.r.shipAssertTag(8787101,307,Ga.ParagraphReader.isParagraph(this._iterator)),_s.OutlineElementNavigator.returnToOutlineElement(this._iterator)),El.r.shipAssertTag(8701086,307,!!this._box4PasteSteward),El.r.shipAssertTag(8701087,307,Ss.OutlineElementReader.isOutlineElement(this._iterator)||ys.OutlineReader.isOutline(this._iterator)),this._nestedTableCount++},e.prototype.onTableEnd=function(){if(El.r.shipAssertTag(8701088,307,!!this._box4PasteSteward),_s.OutlineElementNavigator.returnToOutlineElement(this._iterator),this._nestedTableCount--,this.get_currentlyInsidePastedTable()){this._box4PasteSteward.moveToNextOutlineElementForHtmlImport(!0);var t=e.get_OutlineElementEditor().createParagraph(this._iterator);El.r.shipAssertTag(8787102,307,t===this._iterator.get_currentNode()),El.r.shipAssertTag(8787103,307,Ga.ParagraphReader.isParagraph(this._iterator))}},e.prototype.onTableRowStart=function(t){El.r.shipAssertTag(8701089,307,!!this._box4PasteSteward),this._box4PasteSteward.moveToNextOutlineElementForHtmlImport(!0);var n=new ha.g;n.setFrom(this._iterator),this._box4PasteSteward.applyPendingListAndIndentationInfo(n,!1),Gl.n.get_instance().get_item(63)&&gs.ListReader.isListOutlineElement(n)&&this._box4PasteSteward.trackTableToDelist(n.get_currentNode());var i=e.get_OutlineElementEditor().createParagraph(this._iterator,this._box4PasteSteward.getNewOutlineElementInfo(t));El.r.shipAssertTag(8701090,307,i===this._iterator.get_currentNode()),El.r.shipAssertTag(8701091,307,Ga.ParagraphReader.isParagraph(this._iterator))},e.prototype.onTableRowEnd=function(){El.r.shipAssertTag(8701120,307,!!this._box4PasteSteward),El.r.shipAssertTag(8701121,307,Ga.ParagraphReader.isParagraph(this._iterator)),_s.OutlineElementNavigator.returnToOutlineElement(this._iterator)},e.prototype.onTableCellStart=function(e){El.r.shipAssertTag(8701122,307,!!this._box4PasteSteward),El.r.shipAssertTag(8701123,307,Ga.ParagraphReader.isParagraph(this._iterator)),El.r.shipAssertTag(8701124,307,!this._box4PasteSteward.get_pendingIndentationLevel());var t=this._iterator.get_currentNode();if(Ga.ParagraphReader.textLength(t)){var n=Wa.y.createIpContextAtEndOfParagraph(t);this._box4PasteSteward.get_characterPropertiesEditor().replaceTextRange(n,", ")}},e.prototype.onTableCellEnd=function(){El.r.shipAssertTag(8701125,307,!!this._box4PasteSteward),El.r.shipAssertTag(8701126,307,Ga.ParagraphReader.isParagraph(this._iterator)),El.r.shipAssertTag(8701127,307,this._box4PasteSteward.get_pendingIndentationLevel()<=0),this._box4PasteSteward.clearPendingIndentation()},e.prototype.onTablePartStart=function(e){El.r.shipAssertTag(8701128,307,!1)},e.prototype.onTablePartEnd=function(){El.r.shipAssertTag(8701129,307,!1)},e.get_OutlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=Ge.w.get_instance().resolve(ql.p))},e._outlineElementEditor=null,e}();(0,o.l)(cy,"cf5f1e19$TextOnlyBox4TableSteward",null,[ly,__.p]);var dy=function(){function e(e,t,n,i,r){void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===r&&(r=!1),this._listEditor=null,this._tableEditor=null,this._pasteTableImprovementsIsEnabled=!1,this._pasteComplexTableImprovementsIsEnabled=!1,this._pasteTableCellMarginImprovementsIsEnabled=!1,this._listEditor=e,this._tableEditor=t,this._pasteTableImprovementsIsEnabled=n,this._pasteComplexTableImprovementsIsEnabled=i,this._pasteTableCellMarginImprovementsIsEnabled=r}return e.prototype.create=function(e,t){return 1===e?new cy(t,this._listEditor,this._tableEditor):new uy(t,this._listEditor,this._tableEditor,this._pasteTableImprovementsIsEnabled,this._pasteComplexTableImprovementsIsEnabled,this._pasteTableCellMarginImprovementsIsEnabled)},e}();(0,o.l)(dy,"e9ad7b04$Box4TableStewardFactory",null,[hg]);var gy=n(3436),py=function(){function e(){}return e.prototype.create=function(){return new r_.z},e}();(0,o.l)(py,"e3ee4a5e$Factory",null,[qd]);var hy=function(){function e(){}return e.prototype.configure=function(e){e.register(ay).as(kd).singleInstance().usingFactory((function(){return new ay(hs.z.get_getOutlineElementIndentationEditor(),e.resolve(jl.v),e.resolve(Ql.c),e.resolve(Nd.n))})),e.register(Cp).as(Ld).singleInstance().usingFactory((function(){return new Cp(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacPasteBrAsNewParagraphIsEnabled"))})),e.register(oh.ClipboardActor).singleInstance().usingFactory((function(){return new oh.ClipboardActor(e.resolveLazy(Bd.d),e.resolve(Od),xr.y.get_instance(),e.resolve(Ud.t),fa.SelectionManager.get_instance(),L.AFrameworkApplication.get_theActionManager(),e.resolve(wa.n),L.AFrameworkApplication.appSettingsManager)})),e.register(Hd).singleInstance().usingFactory((function(){return new Hg(L.AFrameworkApplication.appSettingsManager)})),e.register(Gd).singleInstance().usingFactory((function(){return new gf(L.AFrameworkApplication.appSettingsManager,e.resolve(Hd),e.resolve(Ud.t),$g.k.get_instance())})),e.register(Wd).singleInstance().usingFactory((function(){return e.resolve(Gd).create()})),e.register(Od).singleInstance().usingFactory((function(){return new af(e.resolve(Wd),Si.InteractiveViewManager.get_instance(),yi.App.get_activeAppFrame().workspace,St.FocusManager.instance(),e.resolve(mi.q),e.resolve(Vd.d),$g.k.get_instance())})),e.register($d).singleInstance().usingFactory((function(){return new gh})),e.register(zd).singleInstance().usingFactory((function(){return new pf})),e.register(Kd).singleInstance().usingFactory((function(){return new ty})),e.register(qd).singleInstance().usingFactory((function(){return new py})),e.register(jd).singleInstance().usingFactory((function(){return new Wg})),e.register(Qd).singleInstance().usingFactory((function(){return new Uh(fa.SelectionManager.get_instance(),e.resolve(Jd.s),e.resolve(Xd.h),Gl.n.get_instance().get_item(71))})),e.register(Zm).singleInstance().usingFactory((function(){return new Zm(fa.SelectionManager.get_instance(),e.resolve(Yd.d),Si.InteractiveViewManager.get_instance(),bt.g.getElementBounds,e.resolve(Yf))})),e.register(Km).singleInstance().usingFactory((function(){return new Km(e.resolve(Ud.t),yi.App.get_box4Bridge().get_commandUi())})),e.register(zm).singleInstance().usingFactory((function(){return new zm(e.resolve(Yf),e.resolve(Zd.z),Si.InteractiveViewManager.get_instance(),Vg.f.instance(),L.AFrameworkApplication.get_activeFrame(),e.resolve(Zm),e.resolve(eg.x),e.resolve(Km),yi.App.theNotebookManager.get_theGraph().getSpecificEventHandlers(12),e.resolve(tg.w),yi.App.get_mode())})),e.register(ng).singleInstance().usingFactory((function(){return new Bh(xr.y.get_instance(),e.resolve(Om),e.resolve(Gm),kh.z.get_instance(),fa.SelectionManager.get_instance(),L.AFrameworkApplication.get_theActionManager(),e.resolve(ig),e.resolveLazy(wa.n),e.resolve(jd),e.resolve(Qd),e.resolve(xa.b).get_instance())})),e.register(rg).singleInstance().usingFactory((function(){return new dh(L.AFrameworkApplication.get_theActionManager(),xr.y.get_instance(),e.resolve(Om),e.resolve(ql.p),fa.SelectionManager.get_instance(),e.resolve(Od),e.resolve(Jd.s),ey.e.get_instance(),e.resolve(og.j),e.resolve(ag.v),e.resolve(lg.x),e.resolve(qd),e.resolve(Kd),e.resolve(eg.x),e.resolve(Ud.t))})),e.register(sg).singleInstance().usingFactory((function(){return new sh(xr.y.get_instance(),$g.k.get_instance(),e.resolve(Od),e.resolve(ug.h),L.AFrameworkApplication.appSettingsManager.get_appSettings().ChromeClipboardAccessOperationTimeout)})),e.register(ig).singleInstance().usingFactory((function(){return new zh(L.AFrameworkApplication.appSettingsManager)})),e.register(Bd.d).singleInstance().usingFactory((function(){return new Rh(e.resolve(Om),L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ChromeClipboardAccessIsEnabled"),xr.y.get_instance(),ey.e.get_instance(),$g.k.get_instance(),e.resolve(cg.c),e.resolve(ng),e.resolve(rg),e.resolve(sg),e.resolve(Kh),e.resolve(dg.b),e.resolve(ug.h),e.resolve(Ta.p).get_instance(),e.resolve(xa.b).get_instance(),e.resolve(wa.n),e.resolve(Zd.z),e.resolve(nl.s))})),e.register(gg).singleInstance().usingFactory((function(){return new R_(e.resolveLazy(kd),e.resolveLazy(pg),e.resolveLazy(hg),e.resolveLazy(_g),e.resolve(mg),e.tryResolve(fg),e.resolve(eg.x),e.resolve(yg),e.resolve(Cg))})),e.register(Om).singleInstance().usingFactory((function(){return new Om(e.resolve(Za.w),e.resolve(au.z),e.resolve(zl.a),e.resolve(ql.p),e.resolve(jl.v),yi.App.theNotebookManager,e.resolve(Sg.p),L.AFrameworkApplication.appSettingsManager,e.resolve(bg.u),e.resolve(cg.c),e.tryResolve(fg),e.resolve(vg.v),e.resolve(Ta.p).get_instance(),e.resolve(xa.b).get_instance(),e.resolve(Tg.b).get_sequenceCodePrefix(),e.resolve(Yl.x))})),e.register(Ag).singleInstance().usingFactory((function(){return new Hm(e.resolve(Om),e.tryResolve(fg),new nt.q(gy.g,(function(){return yi.App.get_activeAppFrame().workspace.get_contentView()})))})),e.register(Ig.c).singleInstance().usingFactory((function(){return new Cf(L.AFrameworkApplication.get_theActionManager())})),e.register(Gm).singleInstance().usingFactory((function(){return new Gm(e.resolve(Om),e.resolve(Ag),e.resolve(gg))})),Gl.n.get_instance().get_item(78)||(e.register(fp).as(pg).singleInstance().usingFactory((function(){return new fp(e.resolve(Za.w),L.AFrameworkApplication.get_theTaskManager(),e.resolve(wa.n),e.tryResolve(wg),yi.App.get_activeAppFrame().get_notificationBar(),e.resolve(eg.x).getBooleanAppSetting("WordEditorPastePictureFailedImprovementIsEnabled"),e.resolve(eg.x).getBooleanAppSetting("NotificationBarImageErrorIsEnabled"))})),e.register(dy).as(hg).singleInstance().usingFactory((function(){return new dy(Ge.w.get_instance().resolve(jl.v),Ge.w.get_instance().resolve(au.z),e.resolve(eg.x).getBooleanAppSetting("WordEditorPasteTableImprovementsIsEnabled"),e.resolve(eg.x).getBooleanAppSetting("PasteComplexTablesIsEnabled"),e.resolve(eg.x).getBooleanAppSetting("PasteTableCellMarginImprovementsIsEnabled"))}))),e.register(Kh).singleInstance().usingFactory((function(){return new Kh(xr.y.get_instance(),fa.SelectionManager.get_instance(),yi.App.get_theCoauthManager(),za.k.get_instance(),Gl.n.get_instance().get_item(14),Gl.n.get_instance().get_item(50))})),e.register(rh).as(_g).singleInstance().usingFactory((function(){return new rh(L.AFrameworkApplication.appSettingsManager)})),e.register(yg).singleInstance().usingFactory((function(){return new qh(L.AFrameworkApplication.appSettingsManager)})),e.register(xg.i).singleInstance().usingFactory((function(){return new Zf(L.AFrameworkApplication.get_theActionManager())})),e.register(su.n).singleInstance().usingFactory((function(){return new jf(L.AFrameworkApplication.get_theActionManager())})),e.register(Md).singleInstance().usingFactory((function(){return new Md(e.resolveFuture(ea.t),e.resolve(Eg.d))})),e.register(yf).as(Fg.c).singleInstance().usingFactory((function(){return new yf(e.tryResolve(Pg.c),e.resolve(Dg))})),e.register(Yf).as(Rg.h).singleInstance().usingFactory((function(){return new Yf})),e.register(xf).singleInstance().usingFactory((function(){return new xf(Ge.w.get_instance().resolve(Eg.d),L.AFrameworkApplication.get_theActionManager(),(function(){return Ge.w.get_instance().resolve(Mg)}),Ge.w.get_instance().resolve(ba.x),Ge.w.get_instance().resolve(cg.c),fa.SelectionManager.get_instance(),Ge.w.get_instance().resolveFuture(kg.i),ey.e.get_instance(),Ge.w.get_instance().resolve(Bc.f),za.k.get_instance(),xr.y.get_instance(),Ge.w.get_instance().resolve(tu.k),Ge.w.get_instance().resolve(Ng.c),Ge.w.get_instance().resolveFuture(Lg),Gl.n.get_instance())})),e.register(Rf).singleInstance().usingFactory((function(){return new Rf(Ge.w.get_instance().resolve(ba.x),Ge.w.get_instance().resolve(ts.e),ny.z.get_instance(),Ge.w.get_instance().resolve(Vs.z),am.ContextSetEditor.get_instance(),Ge.w.get_instance().resolve(Fg.c),za.k.get_instance(),xr.y.get_instance(),Ge.w.get_instance().resolve(Kf.d),Jf.get_instance())})),e.register(qf).singleInstance().usingFactory((function(){return new qf(e.resolve(Bg),e.resolve(Og),e.resolve(Ug.s))})),e.register(zg).singleInstance().usingFactory((function(){return new zg(L.AFrameworkApplication.get_theActionManager(),xr.y.get_instance(),(function(){return Ge.w.get_instance().resolve(cu)}))}))},e}();(0,o.l)(hy,"e8bb2367$Box4ActorsComponentConfiguration",null,[u.s]);var _y=function(){function e(){}return e.registerActions=function(){var t=e.DownloadEmbeddedFileDialog;L.AFrameworkApplication.get_theActionManager().addAction(Oi.u.downloadEmbeddedFileDialog,ol.d.embeddedFile,t),L.AFrameworkApplication.get_theActionManager().addAction(Oi.u.downloadEmbeddedFile,ol.d.embeddedFile,e.DownloadEmbeddedFile),L.AFrameworkApplication.get_theActionManager().addAction(Oi.u.downloadEmbeddedFile,ol.d.floatingEmbeddedFile,e.DownloadEmbeddedFile)},e.DownloadEmbeddedFileDialog=function(t,n,i,r,o){if(yi.App.disableEmbedDownload)return 8;if(2===i){var a=new Vn.StandardDialog;return a.set_buttonsOption(4),a.setDefaultButton(1),a.setButtonText(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),a.setButtonText(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),a.showQuestion(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,e.EmbeddedFileDialogHandler),32}return 2},e.EmbeddedFileDialogHandler=function(e,t){1===e&&L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.downloadEmbeddedFile,2)},e.DownloadEmbeddedFile=function(t,n,i,r,o){if(yi.App.disableEmbedDownload)return 8;if(1===i)return(a=n.get_node()).hasProperty(is.b.embeddedFileContainer)?32:2;if(2===i&&(n.get_contextId()===ol.d.view&&n.view.get_selectionManager()&&(n=n.view.get_selectionManager().get_selectionContextForActionDispatch()),N_.EmbeddedFileReader.isEmbeddedFileOrFloatingEmbeddedFileContext(n))){var a=n.get_node(),l=N_.EmbeddedFileReader.getFileUrl(a);e.SetShortLivedCookie();try{e.saveFile(l)}catch(e){S.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",e)}}return 32},e.saveFile=function(e){if(1!==yi.App.get_mode()||!L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteSaveFileThroughRequest")||L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsTeamsSession")&&W.y.get_isElectron())window.open(e);else{var t=new oi.QueryStringBuilder(e).getParam("Filename"),n=new XMLHttpRequest;n.onloadstart=function(e){n.responseType="blob"},n.open("GET",e,!0),n.onload=function(i){try{var r=n.response,o=t;if(!o&&(o="GetImage",r.type&&-1!=r.type.indexOf("image/"))){["bmp","gif","ico","jpeg","png","svg","tiff","webp"].forEach((function(e){-1!=r.type.indexOf(e)&&(o="GetImage."+e)}))}if(W.y.get_isInternetExplorerOrEdge())return"undefined"!=typeof navigator.msSaveBlob?void navigator.msSaveBlob(r,o):void window.open(e);var a=window.URL||window.webkitURL,l=a.createObjectURL(r),s=document.createElement("a");s.href=l,s.download=o,document.body.appendChild(s),s.click(),setTimeout((function(){document.body.removeChild(s),a.revokeObjectURL(l)}),0)}catch(t){window.open(e)}},n.send()}},e.SetShortLivedCookie=function(){re.z.setWithExpirationMillisecondsAndPath("DownloadCheck","1",6e4,"/o/GetImage.ashx")},e}();(0,o.l)(_y,"b423b42$EmbeddedFileActor",null,[]);var my=n(8158),fy=n(878),yy=(0,o.y)("5e88ed23$IInsertLinkDialogFactory"),Cy=function(){function e(t,n){if(this._internalLinkManager=null,this._trackChangeEditor=null,this._interactiveView=null,this._selectedContext=null,this._friendlyText=null,this._isDisplayTextDisabled=!1,this._interactiveView=Si.InteractiveViewManager.get_instance().get_selectionView(),this._selectedContext=t,e.get_addHyperlinkWhenSelectionContainsLineBreak()&&ga.SelectionEditor.isTextRangeContext(t)){var i=ga.SelectionEditor.trimLeadingLineBreakObjectFromTextRange(this._selectedContext);ga.SelectionEditor.isTextRangeContext(i)?this._selectedContext=i:S.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}var r=ga.SelectionEditor.trimWhitespaceFromTextRange(this._selectedContext);ga.SelectionEditor.isTextRangeContext(r)&&(this._selectedContext=r)}return e.prototype.get_internalLinkManager=function(){return this._internalLinkManager||(this._internalLinkManager=Ge.w.get_instance().tryResolve(Na.v))},e.prototype.get_trackChangeEditor=function(){return this._trackChangeEditor||(this._trackChangeEditor=Ge.w.get_instance().resolve(es.x).get_instance())},e.prototype.get_titleText=function(){return Box4Intl.Box4Strings.l_InsertLinkTitle},e.prototype.get_insertButtonText=function(){return Box4Intl.Box4Strings.l_InsertLinkButtonText},e.prototype.dispose=function(){},e.prototype.expandSelectionToFullHyperlink=function(e,t,n){if(t!==this._selectedContext.get_cpEnd()||e!==this._selectedContext.get_cpBegin()){var i=Ua.SelectionFactory.createTextRangeOrIpSelection(n,e,t);this._interactiveView.get_selectionManager().setSelection(i);var r=ga.SelectionEditor.trimWhitespaceFromTextRange(i.get_firstContext().clone());this._selectedContext=r}},e.prototype.getDialogContent=function(t,n,i,r,o){if(o.val=Ha.HyperlinkReader.getSelectedHyperlinks(this._selectedContext),i.val=this._selectedContext.get_cpBegin(),r.val=this._selectedContext.get_cpEnd(),n.val="",!o.val.length)return this._friendlyText=t.substring(this._selectedContext.get_cpBegin(),this._selectedContext.get_cpEnd()),!0;if(o.val[0].hyperlink){for(var a=0,l=0,s=Math.max(0,t.length-1),u=0,c=0;c<o.val.length;c++)o.val[c].cpBegin>=l&&(e.get_hyperlinkStrategy().getHyperlink(this._selectedContext,o.val[c],(0,g.m)((function(){return a}),(function(e){return a=e})),(0,g.m)((function(){return l}),(function(e){return l=e}))),s=Math.min(a,s),u=Math.max(l,u));return i.val=Math.min(s,i.val),r.val=Math.max(u,r.val),this._friendlyText=t.substring(i.val,r.val),i.val===s&&(n.val=o.val[0].hyperlink.get_url()),!0}return!1},e.prototype.TrimTrackedChanges=function(t){e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeManager().trimTrackChangeOnTextRange(t)},e.prototype.insertLinkDialogHandler=function(t,n){if(this._interactiveView.get_isAttached()){var i;i=e.get_hyperlinkExpandEditEnabled()?Ha.HyperlinkReader.getSelectedHyperlinks(this._selectedContext):Ha.HyperlinkReader.getHyperlinksInRange(this._selectedContext,!0);var r=this._interactiveView.get_selectionManager().get_selectionCollection().get_currentSelection();if(r){var o=r.get_firstContext();if(Ga.ParagraphReader.isParagraphContext(o)&&(o=Wa.y.createTextRange(o.get_node(),0,Ga.ParagraphReader.textLength(o.get_node()))),e.get_addHyperlinkWhenSelectionContainsLineBreak()&&ga.SelectionEditor.isTextRangeContext(o)){var a=ga.SelectionEditor.trimLeadingLineBreakObjectFromTextRange(o);ga.SelectionEditor.isTextRangeContext(a)?o=a:S.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}var l=ga.SelectionEditor.trimWhitespaceFromTextRange(o);if(ga.SelectionEditor.isTextRangeContext(l)&&(o=l),0===t||Gl.n.get_instance().get_item(22)&&32!==L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(o,Oi.u.insertHyperlink,1,!0,null,null)||this.IsInvalidSelectionForHyperlinkDialog(i)||!this._selectedContext.equals(o))this._interactiveView.synchronizeEditingView();else{Dr.t.mark(5562),Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager()&&yi.App.get_theCoauthManager().get_isCoauthorable()&&this._interactiveView.get_selectionManager().acquireLocksForSelection();var s=new Ma.GraphTransaction(15);s.setFromNode(this._selectedContext.get_node()),this._selectedContext.get_node().getGraphSpace().get_graphTransactionOperations().blockRttSend(4);var u=n.txtDisplay,c=n.txtLink.trim();this.insertLink(u,c,i),s.dispose(),Dr.t.mark(5563),this.cleanUp()}}else S.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}},e.prototype.IsInvalidSelectionForHyperlinkDialog=function(t){return!e.get_hyperlinkExpandEditEnabled()&&(t.length>1||1===t.length&&(t[0].cpBegin>this._selectedContext.get_cpBegin()||t[0].cpEnd<this._selectedContext.get_cpEnd()))},e.prototype.insertLink=function(t,n,i){var r=null;if(t||(t=n),n&&(!i.length||n!==i[0].hyperlink.get_url())){n=Ha.HyperlinkReader.getSanitizedUrl(n);var o="",a="";this.get_internalLinkManager()&&this.get_internalLinkManager().tryConvertToRelativeLink(n,(0,g.m)((function(){return o}),(function(e){return o=e})),!1,(0,g.m)((function(){return a}),(function(e){return a=e})))&&(n=o)}this._isDisplayTextDisabled||(t=e.get_hyperlinkEditor().replaceWhiteSpaceForRender(t));var l=!1;if(i.length&&!e.get_hyperlinkExpandEditEnabled()||!n){if(i.length>0){var s,u,c=i[0],d=e.get_hyperlinkStrategy().getHyperlink(this._selectedContext,c,(0,g.m)((function(){return s}),(function(e){return s=e})),(0,g.m)((function(){return u}),(function(e){return u=e})));if(n)if(c.hyperlink.get_hasEmbeddedRuns()){if(n!==c.hyperlink.get_url())if(e.get_trackChangeManager().get_trackHyperlinkIsEnabled()){h=Wa.y.createTextRange(this._selectedContext.get_node(),s,s+t.length);e.get_hyperlinkEditor().editHyperlinkUrl(h,c.hyperlink,n)}else e.get_hyperlinkStrategy().updateHyperlinksUrl(n,d),l=!0;if(t!==this._friendlyText){e.get_hyperlinkStrategy().needGroupHyperlinkRanges()&&e.get_hyperlinkStrategy().removeHyperlinks(this._selectedContext,d),e.get_characterPropertiesEditor().replaceTextRange(Wa.y.createTextRange(this._selectedContext.get_node(),s,u),t,!0);var p=Wa.y.createTextRange(this._selectedContext.get_node(),s,s+t.length);this.TrimTrackedChanges(p),e.get_hyperlinkStrategy().needGroupHyperlinkRanges()&&e.get_hyperlinkEditor().createHyperlink(p,n),r=Ua.SelectionFactory.createIpSelection(this._selectedContext.get_node(),s+t.length),l=!0}}else{e.get_hyperlinkStrategy().removeHyperlinks(this._selectedContext,d),e.get_characterPropertiesEditor().replaceTextRange(Wa.y.createTextRange(this._selectedContext.get_node(),s,u),t,!0);var h=Wa.y.createTextRange(this._selectedContext.get_node(),s,s+t.length);!e.get_trackChangeManager().get_trackHyperlinkIsEnabled()&&e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&(this.TrimTrackedChanges(h),l=!0),e.get_hyperlinkEditor().createHyperlink(h,n),r=Ua.SelectionFactory.createIpSelection(this._selectedContext.get_node(),s+t.length)}else e.get_hyperlinkEditor().removeHyperlink(c.paragraph,c.hyperlink),e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&!e.get_trackChangeManager().get_trackHyperlinkIsEnabled()&&(l=!0)}}else{i.length>0&&e.get_hyperlinkStrategy().removeHyperlinks(this._selectedContext,i);var _=!0;if(e.get_isKeepHyperlinkFormatFixEnabled())_=Ga.ParagraphReader.text(this._selectedContext.get_node()).substring(this._selectedContext.get_cpBegin(),this._selectedContext.get_cpEnd())!==t;_&&e.get_characterPropertiesEditor().replaceTextRange(this._selectedContext,t,!0),!_&&e.get_trackChangeManager().get_trackHyperlinkIsEnabled()&&this.get_trackChangeEditor().setTrackChangeOnContext(this._selectedContext,1);var h=Wa.y.createTextRange(this._selectedContext.get_node(),this._selectedContext.get_cpBegin(),this._selectedContext.get_cpBegin()+t.length);!e.get_trackChangeManager().get_trackHyperlinkIsEnabled()&&e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&(this.TrimTrackedChanges(h),l=!0),e.get_hyperlinkEditor().createHyperlink(h,n),r=Ua.SelectionFactory.createIpSelection(this._selectedContext.get_node(),this._selectedContext.get_cpBegin()+t.length)}l&&e.get_trackChangeManager().alertUntrackedChange(4),r&&this._interactiveView.get_selectionManager().setSelection(r)},e.get_hyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=Ge.w.get_instance().resolve(Ba.o))},e.get_characterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=Ge.w.get_instance().resolve(ba.x))},e.get_trackChangeManager=function(){return e._trackChangeManager||(e._trackChangeManager=Ge.w.get_instance().resolve(xa.b).get_instance())},e.get_hyperlinkStrategy=function(){return e._hyperlinkStrategy||(e._hyperlinkStrategy=Ge.w.get_instance().resolve(my.n))},e.get_hyperlinkExpandEditEnabled=function(){return null==e._HyperlinkExpandEditEnabled&&(L.AFrameworkApplication.appSettingsManager?e._HyperlinkExpandEditEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HyperlinkExpandEditEnabled"):e._HyperlinkExpandEditEnabled=!1),e._HyperlinkExpandEditEnabled},e.get_isKeepHyperlinkFormatFixEnabled=function(){return null==e._isKeepHyperlinkFormatFixEnabled&&(L.AFrameworkApplication.appSettingsManager?e._isKeepHyperlinkFormatFixEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("KeepHyperlinkFormatFixIsEnabled"):e._isKeepHyperlinkFormatFixEnabled=!1),e._isKeepHyperlinkFormatFixEnabled},e.get_isHyperlinkUrlValidationEnabled=function(){return null==e._isHyperlinkUrlValidationEnabled&&(L.AFrameworkApplication.appSettingsManager?e._isHyperlinkUrlValidationEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HyperlinkUrlValidationIsEnabled"):e._isHyperlinkUrlValidationEnabled=!1),e._isHyperlinkUrlValidationEnabled},e.get_addHyperlinkWhenSelectionContainsLineBreak=function(){return null==e._AddHyperlinkWhenSelectionContainsLineBreak&&(L.AFrameworkApplication.appSettingsManager?e._AddHyperlinkWhenSelectionContainsLineBreak=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AddHyperlinkWhenSelectionContainsLineBreak"):e._AddHyperlinkWhenSelectionContainsLineBreak=!1),e._AddHyperlinkWhenSelectionContainsLineBreak},e._hyperlinkEditor=null,e._characterPropertiesEditor=null,e._trackChangeManager=null,e._hyperlinkStrategy=null,e._HyperlinkExpandEditEnabled=null,e._isKeepHyperlinkFormatFixEnabled=null,e._isHyperlinkUrlValidationEnabled=null,e._AddHyperlinkWhenSelectionContainsLineBreak=null,e.source="Source",e.commandingSource="CommandingInterface",e.displayText="DisplayText",e.url="Url",e.id="InsertLinkDialog",e}();(0,o.l)(Cy,"14f33c1f$AInsertLinkDialog",null,[Sys.IDisposable]);var Sy=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)},e.DialogHtmlFormat="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>",e}();(0,o.l)(Sy,"4e6d2e7f$InsertLinkDialogHtml",null,[]);var by=function(e){function t(t,n){var i=e.call(this,t,n)||this;i._dialog=null,i._dialog=new Bi.o,i._dialog.set_dialogId(Cy.id),i._friendlyText="";var r,a="",l=Ga.ParagraphReader.text(i._selectedContext.get_node()),s=i._selectedContext.get_cpBegin(),u=i._selectedContext.get_cpEnd();Cy.get_hyperlinkExpandEditEnabled()?i.getDialogContent(l,(0,g.m)((function(){return a}),(function(e){return a=e})),(0,g.m)((function(){return s}),(function(e){return s=e})),(0,g.m)((function(){return u}),(function(e){return u=e})),(0,g.m)((function(){return r}),(function(e){return r=e}))):1===(r=Ha.HyperlinkReader.getHyperlinksInRange(i._selectedContext,!0)).length&&r[0].cpBegin<=i._selectedContext.get_cpBegin()&&r[0].cpEnd>=i._selectedContext.get_cpEnd()&&r[0].hyperlink?(i._friendlyText=Cy.get_hyperlinkStrategy().getHyperlinkText(t,r[0],l),a=r[0].hyperlink.get_url()):r.length||(i._friendlyText=l.substring(i._selectedContext.get_cpBegin(),i._selectedContext.get_cpEnd()));var c=(0,y.e)(Object,n);if(c&&(c[Cy.source]&&c[Cy.source]===Cy.commandingSource||c[Cy.url]&&c[Cy.displayText])){var d=c[Cy.displayText],p=c[Cy.url];return i.insertLink(d,p,r),i}Cy.get_hyperlinkExpandEditEnabled()&&r[0]&&i.expandSelectionToFullHyperlink(s,u,r[0].paragraph),i._dialog.set_dialogHtml(Sy.get_dialogHtml()),""===a.trim()&&i._dialog.setButtonText(1,i.get_insertButtonText());var h={txtLink:a,txtDisplay:i._friendlyText};if(i._dialog.set_dialogOnKeyPressHandler(o.i(i,i.DialogDefaultEnterKeyHandler,"DialogDefaultEnterKeyHandler")),i._dialog.set_dialogOnKeyDownHandler(o.i(i,i.DialogDefaultEnterKeyHandler,"DialogDefaultEnterKeyHandler")),i._dialog.initializeAndShow(i.get_titleText(),o.i(i,i.insertLinkDialogHandler,"insertLinkDialogHandler"),h),Cy.get_isHyperlinkUrlValidationEnabled()){var _=document.getElementById("txtLink");wo.n.addHandler(_,me.d.input,o.i(i,i.OnLinkChanged,"OnLinkChanged")),wo.n.addHandler(_,me.d.change,o.i(i,i.OnLinkChanged,"OnLinkChanged"))}(document.getElementById("txtLink").focus(),Cy.get_addHyperlinkWhenSelectionContainsLineBreak())?Cd.f.getBlobObjectsInRange(Wa.y.createContextFromCpResult(s,u,!1,i._selectedContext.get_node())).length>0&&(i._isDisplayTextDisabled=!0,document.getElementById("txtDisplay").disabled=!0):r.length<=1&&Cy.get_hyperlinkStrategy().containsBlob(t,r[0],1===r.length)&&(i._isDisplayTextDisabled=!0,document.getElementById("txtDisplay").disabled=!0);return i}return(0,v.t)(t,e),t.prototype.OnLinkChanged=function(e){if(this._dialog){var t=document.getElementById("txtLink");this._dialog.setButtonState(1,!t||!t.value.length||Ha.HyperlinkReader.isValidUrl(t.value))}},t.prototype.DialogDefaultEnterKeyHandler=function(e){return!!this._dialog&&(Cy.get_isHyperlinkUrlValidationEnabled()?!!this._dialog.getButtonState(this._dialog.getDefaultButton())&&this._dialog.dialogDefaultEnterKeyHandler(e):this._dialog.dialogDefaultEnterKeyHandler(e))},t.prototype.cleanUp=function(){if(Cy.get_isHyperlinkUrlValidationEnabled()){var e=document.getElementById("txtLink");e&&(wo.n.removeHandler(e,me.d.change,o.i(this,this.OnLinkChanged,"OnLinkChanged")),wo.n.removeHandler(e,me.d.input,o.i(this,this.OnLinkChanged,"OnLinkChanged")))}this._dialog&&(this._dialog=null)},t}(Cy);(0,o.l)(by,"5d246cbe$InsertLinkDialog",Cy,[]);var vy=function(e){function t(t,n){var i=e.call(this,t,n)||this,r=new Bi.o(!1,!1,!0),a={};a.displayTextLabel=Box4Intl.Box4Strings.l_InsertLinkDisplayText,a.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress,i._friendlyText="";var l,s="",u=Ga.ParagraphReader.text(i._selectedContext.get_node()),c=i._selectedContext.get_cpBegin(),d=i._selectedContext.get_cpEnd();Cy.get_hyperlinkExpandEditEnabled()?i.getDialogContent(u,(0,g.m)((function(){return s}),(function(e){return s=e})),(0,g.m)((function(){return c}),(function(e){return c=e})),(0,g.m)((function(){return d}),(function(e){return d=e})),(0,g.m)((function(){return l}),(function(e){return l=e}))):1===(l=Ha.HyperlinkReader.getHyperlinksInRange(i._selectedContext,!0)).length&&l[0].cpBegin<=i._selectedContext.get_cpBegin()&&l[0].cpEnd>=i._selectedContext.get_cpEnd()&&l[0].hyperlink?(i._friendlyText=Cy.get_hyperlinkStrategy().getHyperlinkText(t,l[0],u),s=l[0].hyperlink.get_url()):l.length||(i._friendlyText=u.substring(i._selectedContext.get_cpBegin(),i._selectedContext.get_cpEnd()));var p=(0,y.e)(Object,n);if(p&&(p[Cy.source]&&p[Cy.source]===Cy.commandingSource||p[Cy.url]&&p[Cy.displayText])){var h=p[Cy.displayText],_=p[Cy.url];return i.insertLink(h,_,l),i}Cy.get_hyperlinkExpandEditEnabled()&&l[0]&&i.expandSelectionToFullHyperlink(c,d,l[0].paragraph);var m=CommonUIStrings.l_DialogOk;(""===s.trim()&&(m=i.get_insertButtonText()),r.setButtonText(1,m),a.txtLink=s,a.txtDisplay=i._friendlyText,Cy.get_addHyperlinkWhenSelectionContainsLineBreak())?Cd.f.getBlobObjectsInRange(Wa.y.createContextFromCpResult(c,d,!1,i._selectedContext.get_node())).length>0&&(i._isDisplayTextDisabled=!0,a.textDisplayDisabled=!0):l.length<=1&&Cy.get_hyperlinkStrategy().containsBlob(t,l[0],1===l.length)&&(i._isDisplayTextDisabled=!0,a.textDisplayDisabled=!0);var f={id:Cy.id,bodyControls:a};return r.initializeAndShow(i.get_titleText(),o.i(i,i.insertLinkDialogHandler,"insertLinkDialogHandler"),f),i}return(0,v.t)(t,e),t.prototype.cleanUp=function(){},t}(Cy);(0,o.l)(vy,"dc81861f$ReactInsertLinkDialog",Cy,[]);var Ty=function(){function e(){this._isReactDialogEnabled=!1,this._isReactDialogEnabled=!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactDialogEnabled()}return e.prototype.createInsertLinkDialog=function(e,t){return this._isReactDialogEnabled?new vy(e,t):new by(e,t)},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();(0,o.l)(Ty,"279a92ca$InsertLinkDialogFactory",null,[yy]);var Ay=function(e){function t(n,i){var r=this;r._selectedContexts=null,r._interactiveView=null,r._selection=null,r.firstExpandedCpBegin=0,r.lastExpandedCpEnd=0,(r=e.call(this)||this)._selectedContexts=n,r._interactiveView=Si.InteractiveViewManager.get_instance().get_selectionView(),r._selection=r._interactiveView.get_selectionManager().get_selectionCollection().get_currentSelection();var o="";return r.firstExpandedCpBegin=n[0].get_cpBegin(),r.lastExpandedCpEnd=n[n.length-1].get_cpEnd(),r.set_dialogId(t.Id),r.UpdateExpandCpsAndGetSelectedUrl((0,g.m)((function(){return o}),(function(e){return o=e}))),r.showDialog("",o),r}return(0,v.t)(t,e),t.prototype.showDialog=function(e,n){S.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows."),this.set_dialogHtml(Sy.get_dialogHtml()),""===n.trim()&&this.setButtonText(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);var i={txtLink:n,txtDisplay:e};if(this.initializeAndShow(Box4Intl.Box4Strings.l_InsertLinkTitle,o.i(this,this.InsertLinkDialogHandler,"InsertLinkDialogHandler"),i),document.getElementById("txtLink").focus(),document.getElementById("txtDisplay").disabled=!0,t.get_IsHyperlinkUrlValidationEnabled()){var r=document.getElementById("txtLink");wo.n.addHandler(r,me.d.input,o.i(this,this.OnLinkChanged,"OnLinkChanged")),wo.n.addHandler(r,me.d.change,o.i(this,this.OnLinkChanged,"OnLinkChanged"))}},t.prototype.hide=function(){if(t.get_IsHyperlinkUrlValidationEnabled()){var n=document.getElementById("txtLink");n&&(wo.n.removeHandler(n,me.d.change,o.i(this,this.OnLinkChanged,"OnLinkChanged")),wo.n.removeHandler(n,me.d.input,o.i(this,this.OnLinkChanged,"OnLinkChanged")))}e.prototype.hide.call(this)},t.prototype.OnLinkChanged=function(e){var t=document.getElementById("txtLink");this.setButtonState(1,!t||!t.value.length||Ha.HyperlinkReader.isValidUrl(t.value))},t.prototype.dialogDefaultEnterKeyHandler=function(n){return t.get_IsHyperlinkUrlValidationEnabled()?!!this.getButtonState(this.getDefaultButton())&&e.prototype.dialogDefaultEnterKeyHandler.call(this,n):e.prototype.dialogDefaultEnterKeyHandler.call(this,n)},t.prototype.UpdateExpandCpsAndGetSelectedUrl=function(e){var n,i;e.val="";var r=this._selectedContexts.length,o=Ha.HyperlinkReader.getHyperlinksInRange(this._selectedContexts[0],!1);o.length>0&&(t.get_HyperlinkStrategy().getHyperlink(this._selectedContexts[0],o[0],(0,g.m)((function(){return n}),(function(e){return n=e})),(0,g.m)((function(){return i}),(function(e){return i=e}))),n<=this._selectedContexts[0].get_cpBegin()&&(e.val=o[0].hyperlink.get_url()),this.firstExpandedCpBegin=Math.min(this.firstExpandedCpBegin,n));var a=Ha.HyperlinkReader.getHyperlinksInRange(this._selectedContexts[r-1],!1);a.length>0&&(t.get_HyperlinkStrategy().getHyperlink(this._selectedContexts[r-1],a[a.length-1],(0,g.m)((function(){return n}),(function(e){return n=e})),(0,g.m)((function(){return i}),(function(e){return i=e}))),this.lastExpandedCpEnd=Math.max(this.lastExpandedCpEnd,i)),this.TryExpandSelectionToFullHyperlink(this.firstExpandedCpBegin,this.lastExpandedCpEnd)},t.prototype.TryExpandSelectionToFullHyperlink=function(e,t){var n=this._selectedContexts.length;if(e!==this._selectedContexts[0].get_cpBegin()||t!==this._selectedContexts[n-1].get_cpEnd()){var i=Wa.y.createIpContext(this._selectedContexts[0].get_node(),e),r=Ua.SelectionFactory.createSelectionFromContext(i),o=Wa.y.createIpContext(this._selectedContexts[n-1].get_node(),t),a=Ua.SelectionFactory.extendSelection(r,o),l=this.GetTextRangeContext(a.get_firstContext().clone()),s=this.GetTextRangeContext(a.get_lastContext().clone());l&&s&&(this._selectedContexts[0]=l,this._selectedContexts[n-1]=s,this._interactiveView.get_selectionManager().setSelection(a),this._selection=a)}},t.prototype.InsertLinkDialogHandler=function(e,n){if(this._interactiveView.get_isAttached()){var i=this._interactiveView.get_selectionManager().get_selectionCollection().get_currentSelection();if(i)if(i.equals(this._selection)&&0!==e){var r=new Ma.GraphTransaction(15);r.setFromNode(this._selectedContexts[0].get_node());for(var o=0;o<this._selectedContexts.length;o++)this._selectedContexts[o].get_node().getGraphSpace().get_graphTransactionOperations().blockRttSend(4);var a=n.txtLink.trim(),l=this.DeleteAllExistHyperlinks(),s=this.InsertHyperlinks(a);(l||s)&&t.get_TrackChangeManager().alertUntrackedChange(4),this.hide(),r.dispose()}else this._interactiveView.synchronizeEditingView()}},t.prototype.InsertHyperlinks=function(e){if(!e)return!1;e=Ha.HyperlinkReader.getSanitizedUrl(e);for(var n=0;n<this._selectedContexts.length;n++){var i=this._selectedContexts[n];if(!t.get_AddHyperlinkWhenSelectionContainsLineBreak()||!ga.SelectionEditor.isTextRangeContext(i)||(i=ga.SelectionEditor.trimLeadingLineBreakObjectFromTextRange(i),ga.SelectionEditor.isTextRangeContext(i))){var r=Wa.y.createTextRange(this._selectedContexts[n].get_node(),i.get_cpBegin(),i.get_cpEnd());this.TrimTrackedChanges(r),t.get_HyperlinkEditor().createHyperlink(r,e)}}return!0},t.prototype.TrimTrackedChanges=function(e){t.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&t.get_TrackChangeManager().trimTrackChangeOnTextRange(e)},t.prototype.GetTextRangeContext=function(e){return Ga.ParagraphReader.isParagraphContext(e)&&!ga.SelectionEditor.isBlockContext(e)&&Ga.ParagraphReader.textLength(e.get_node())?Wa.y.createTextRange(e.get_node(),0,Ga.ParagraphReader.textLength(e.get_node())):ga.SelectionEditor.isTextRangeContext(e)?e:null},t.prototype.DeleteAllExistHyperlinks=function(){for(var e=!1,n=0,i=this._selectedContexts;n<i.length;n++){var r=i[n],o=Ha.HyperlinkReader.getHyperlinksInRange(r,!1);o&&(e=t.get_HyperlinkStrategy().removeHyperlinks(r,o)||e)}return e},t.get_HyperlinkStrategy=function(){return t._hyperlinkStrategy||(t._hyperlinkStrategy=Ge.w.get_instance().resolve(my.n))},t.get_TrackChangeManager=function(){return t._trackChangeManager||(t._trackChangeManager=Ge.w.get_instance().resolve(xa.b).get_instance())},t.get_HyperlinkEditor=function(){return t._hyperlinkEditor||(t._hyperlinkEditor=Ge.w.get_instance().resolve(Ba.o))},t.get_AddHyperlinkWhenSelectionContainsLineBreak=function(){return null==t._AddHyperlinkWhenSelectionContainsLineBreak&&(L.AFrameworkApplication.appSettingsManager?t._AddHyperlinkWhenSelectionContainsLineBreak=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AddHyperlinkWhenSelectionContainsLineBreak"):t._AddHyperlinkWhenSelectionContainsLineBreak=!1),t._AddHyperlinkWhenSelectionContainsLineBreak},t.get_IsHyperlinkUrlValidationEnabled=function(){return null==t._isHyperlinkUrlValidationEnabled&&(L.AFrameworkApplication.appSettingsManager?t._isHyperlinkUrlValidationEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HyperlinkUrlValidationIsEnabled"):t._isHyperlinkUrlValidationEnabled=!1),t._isHyperlinkUrlValidationEnabled},t._hyperlinkStrategy=null,t._trackChangeManager=null,t._hyperlinkEditor=null,t._AddHyperlinkWhenSelectionContainsLineBreak=null,t._isHyperlinkUrlValidationEnabled=null,t.Id="InsertMultiParagraphLinkDialog",t}(Bi.o);(0,o.l)(Ay,"a011d129$InsertMultiParagraphLinkDialog",Bi.o,[]);var Iy=function(){function e(){}return e.get_LockedRangeEditor=function(){return za.k.get_instance()},e.get_HyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=Ge.w.get_instance().resolve(Ba.o))},e.get_ContentControlChpHelper=function(){return e._ccChpHelper||(e._ccChpHelper=Ge.w.get_instance().tryResolve(K_.k))},e.get_HyperlinkStrategy=function(){return e._hyperlinkStrategy||(e._hyperlinkStrategy=Ge.w.get_instance().resolve(my.n))},e.get_ExternalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=Ge.w.get_instance().resolveFuture(kg.i))},e.get_TrackChangeManager=function(){return e._trackChangeManager||(e._trackChangeManager=Ge.w.get_instance().resolve(xa.b).get_instance())},e.get_TrackChangeReader=function(){return e._trackChangeReader||(e._trackChangeReader=Ge.w.get_instance().resolve(Ta.p).get_instance())},e.get_ViewAndOpenImageHyperlinksEnabled=function(){return null==e._ViewAndOpenImageHyperlinksEnabled&&(L.AFrameworkApplication.appSettingsManager?e._ViewAndOpenImageHyperlinksEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ViewAndOpenImageHyperlinksIsEnabled"):e._ViewAndOpenImageHyperlinksEnabled=!1),e._ViewAndOpenImageHyperlinksEnabled},e.get_HyperlinkExpandEditEnabled=function(){return null==e._HyperlinkExpandEditEnabled&&(L.AFrameworkApplication.appSettingsManager?e._HyperlinkExpandEditEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HyperlinkExpandEditEnabled"):e._HyperlinkExpandEditEnabled=!1),e._HyperlinkExpandEditEnabled},e.get_MultiParagraphHyperlinkEditEnabled=function(){return null==e._MultiParagraphHyperlinkEditEnabled&&(L.AFrameworkApplication.appSettingsManager?e._MultiParagraphHyperlinkEditEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("MultiParagraphHyperlinkEditEnabled"):e._MultiParagraphHyperlinkEditEnabled=!1),e._MultiParagraphHyperlinkEditEnabled},e.get_AddHyperlinkWhenSelectionContainsLineBreak=function(){return null==e._AddHyperlinkWhenSelectionContainsLineBreak&&(L.AFrameworkApplication.appSettingsManager?e._AddHyperlinkWhenSelectionContainsLineBreak=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AddHyperlinkWhenSelectionContainsLineBreak"):e._AddHyperlinkWhenSelectionContainsLineBreak=!1),e._AddHyperlinkWhenSelectionContainsLineBreak},e.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(Oi.u.insertHyperlink,ol.d.view,e.HyperlinkActionViewHandler),t.addAction(Oi.u.insertHyperlink,ol.d.insertionPoint,e.InsertLink),t.addAction(Oi.u.insertHyperlink,ol.d.textRange,e.InsertLink),t.setActionFlags(Oi.u.insertHyperlink,1028),t.addAction(Oi.u.removeHyperlink,ol.d.view,e.HyperlinkActionViewHandler),t.addAction(Oi.u.removeHyperlink,ol.d.insertionPoint,e.RemoveLink),t.addAction(Oi.u.removeHyperlink,ol.d.textRange,e.RemoveLink),t.setActionFlags(Oi.u.removeHyperlink,1028),t.addAction(Oi.u.selectHyperlink,ol.d.view,e.HyperlinkActionViewHandler),t.addAction(Oi.u.selectHyperlink,ol.d.insertionPoint,e.SelectLink),t.addAction(Oi.u.selectHyperlink,ol.d.textRange,e.SelectLink),t.addAction(Oi.u.openHyperlink,ol.d.view,e.HyperlinkActionViewHandler),t.addAction(Oi.u.openHyperlink,ol.d.insertionPoint,e.OpenTextLink),t.addAction(Oi.u.openHyperlink,ol.d.textRange,e.OpenTextLink),t.addAction(Oi.u.openHyperlink,ol.d.image,e.OpenImageLink),t.addAction(Oi.u.openHyperlink,ol.d.floatingImage,e.OpenImageLink),e.get_ViewAndOpenImageHyperlinksEnabled()&&t.addAction(Oi.u.openHyperlink,ol.d.anchoredObject,e.OpenImageLink),t.addAction(Oi.u.copyHyperlink,ol.d.view,e.HyperlinkActionViewHandler)},e.HyperlinkActionViewHandler=function(t,n,i,r,o){if(e.get_MultiParagraphHyperlinkEditEnabled())return e.HyperlinksActionViewHandler(t,n,i,r,o);if(!n.view.get_isInteractiveView())return 2;var a=n.view.get_selectionManager();if(!a||!a.get_selectionCollection()||!a.get_selectionCollection().get_length())return 8;var l=a.get_selectionCollection().get_currentSelection(),s=l.get_firstContext().clone();if(2===l.get_length()){var u=l.get_item(1);if(!ga.SelectionEditor.isTextRangeContext(s)||!ga.SelectionEditor.isEndOfParagraphContext(u)||s.get_node()!==u.get_node())return 8}else if(l.get_length()>2)return 8;if(a.get_selectionCollection().isOutlineLevelSelection)return 8;if(Ga.ParagraphReader.isParagraphContext(s)&&!ga.SelectionEditor.isBlockContext(s)){var c=s.get_node();s=Wa.y.createTextRange(c,0,Ga.ParagraphReader.textLength(c))}return t===Oi.u.copyHyperlink?e.CopyLinkHelper(t,n,s,i,r,o):L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(s,t,i,!0,r,o)},e.HyperlinksActionViewHandler=function(t,n,i,r,o){if(!n.view.get_isInteractiveView())return 2;var a=n.view.get_selectionManager();if(!a||!a.get_selectionCollection()||!a.get_selectionCollection().get_length())return 8;if(a.get_selectionCollection().isOutlineLevelSelection)return 8;var l,s=a.get_selectionCollection().get_currentSelection(),u=e.IsSingleParagraphContext(s);if(u)l=e.GetTextRangeFromParagraph(s.get_firstContext().clone(),!0);else{for(var c=s.get_item(0).clone(),d=1;d<s.get_length()&&(!Ga.ParagraphReader.textLength(c.get_node())||ga.SelectionEditor.isEndOfParagraphContext(c)||e.get_AddHyperlinkWhenSelectionContainsLineBreak()&&Cd.f.onlyContainsLineBreakBlobInRange(c));)c=s.get_item(d).clone(),d++;l=e.GetTextRangeFromParagraph(c,!1)}return e.get_AddHyperlinkWhenSelectionContainsLineBreak()&&ga.SelectionEditor.isTextRangeContext(l)&&Cd.f.onlyContainsLineBreakBlobInRange(l)?8:ga.SelectionEditor.isTextRangeContext(l)||u?t===Oi.u.copyHyperlink?e.CopyLinkHelper(t,n,l,i,r,o):L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(l,t,i,!0,r,o):8},e.IsSingleParagraphContext=function(e){if(1===e.get_length())return!0;if(2===e.get_length()){var t=e.get_firstContext().clone(),n=e.get_item(1);return!(!ga.SelectionEditor.isTextRangeContext(t)||!ga.SelectionEditor.isEndOfParagraphContext(n)||t.get_node()!==n.get_node())}return!1},e.ComposeHyperlinkEditableContexts=function(t,n){t.val=null;for(var i=[],r=0;r<n.get_length();r++){var o=e.GetTextRangeFromParagraph(n.get_item(r).clone(),!1);if(!ga.SelectionEditor.isTextRangeContext(o)){if(ga.SelectionEditor.isEndOfParagraphContext(o)||Ga.ParagraphReader.isParagraphContext(o))continue;return!1}e.get_AddHyperlinkWhenSelectionContainsLineBreak()&&Cd.f.onlyContainsLineBreakBlobInRange(o)||Array.add(i,o)}return t.val=tc.p.toTypedArray(z_.s,i),!e.get_AddHyperlinkWhenSelectionContainsLineBreak()||t.val.length>0},e.InsertLink=function(t,n,i,r,o){if(e.get_MultiParagraphHyperlinkEditEnabled())return e.InsertLinks(t,n,i,r,o);if(!e.CanInsertHyperlink()||!e.CanMakeHyperlinkModification(n))return 8;if(fa.SelectionManager.get_instance().get_selectionCollection().isOutlineLevelSelection)return 8;if(e.get_ViewAndOpenImageHyperlinksEnabled()&&ga.SelectionEditor.isInlineImageContext(n))return 2;var a,l=n;if(!e.IsValidTextContextForHyperlinkAction(l,!0,(0,g.m)((function(){return a}),(function(e){return a=e})))||e.ContainsDeletedTrackedChanges(l))return 8;if(1===i)return 32;if(!a&&ga.SelectionEditor.isInsertionPointContext(l)&&ga.SelectionEditor.isSelectionExpandableToWord(l)){var s=ga.SelectionEditor.expandSelectionToWordBoundary(l,!1);if(s&&(fa.SelectionManager.get_instance().setSelection(s),l=s.get_firstContext(),e.ContainsDeletedTrackedChanges(l)))return e.get_TrackChangeManager().showDeletedContentSelectedDialog(!1),8}return Ty.get_instance().createInsertLinkDialog(l,o),32},e.InsertLinks=function(t,n,i,r,o){var a,l=fa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection(),s=e.IsSingleParagraphContext(l);if(s)a=[n];else if(!e.ComposeHyperlinkEditableContexts((0,g.m)((function(){return a}),(function(e){return a=e})),l))return 8;if(!e.CanInsertHyperlink())return 8;for(var u=0;u<a.length;u++)if(!e.CanMakeHyperlinkModification(a[u]))return 8;if(fa.SelectionManager.get_instance().get_selectionCollection().isOutlineLevelSelection)return 8;var c=new Array(a.length),d=null;for(u=0;u<a.length;u++)if(c[u]=a[u],!e.IsValidTextContextForHyperlinkAction(c[u],!0,(0,g.m)((function(){return d}),(function(e){return d=e})))||e.ContainsDeletedTrackedChanges(c[u]))return 8;if(1===i)return 32;if(!d&&1===c.length&&s&&ga.SelectionEditor.isInsertionPointContext(c[0])&&ga.SelectionEditor.isSelectionExpandableToWord(c[0])){var p=ga.SelectionEditor.expandSelectionToWordBoundary(c[0],!1);if(p&&(fa.SelectionManager.get_instance().setSelection(p),c[0]=p.get_firstContext(),e.ContainsDeletedTrackedChanges(c[0])))return e.get_TrackChangeManager().showDeletedContentSelectedDialog(!1),8}return s?Ty.get_instance().createInsertLinkDialog(c[0],o):new Ay(c,o),32},e.RemoveLink=function(t,n,i,r,o){if(e.get_MultiParagraphHyperlinkEditEnabled())return e.RemoveLinks(t,n,i,r,o);if(!e.CanMakeHyperlinkModification(n))return 2;if(e.get_ViewAndOpenImageHyperlinksEnabled()&&ga.SelectionEditor.isInlineImageContext(n))return 2;var a,l=n;if(!e.IsValidTextContextForHyperlinkAction(l,!1,(0,g.m)((function(){return a}),(function(e){return a=e}))))return 2;if(2===i){var s=new Ma.GraphTransaction(15);try{s.set_undoActionId(t),s.setFromNode(a.paragraph),e.get_HyperlinkExpandEditEnabled()?e.RemoveSelectedHyperlinks(l):e.get_HyperlinkStrategy().removeHyperlink(l,a)}finally{s&&s.dispose()}e.get_TrackChangeManager().get_trackHyperlinkIsEnabled()||e.get_TrackChangeManager().alertUntrackedChange(4)}return 32},e.RemoveLinks=function(t,n,i,r,o){var a,l,s=fa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection();if(e.IsSingleParagraphContext(s))a=[n];else if(!e.ComposeHyperlinkEditableContexts((0,g.m)((function(){return a}),(function(e){return a=e})),s))return 8;if(!e.CanInsertHyperlink())return 8;for(var u=0;u<a.length;u++)if(!e.CanMakeHyperlinkModification(a[u]))return 8;if(1===i){var c=a[0];if(!e.IsValidTextContextForHyperlinkAction(c,!1,(0,g.m)((function(){return l}),(function(e){return l=e}))))return 2}if(2===i){for(u=0;u<a.length;u++){c=a[u];if(!e.IsValidTextContextForHyperlinkAction(c,!0,(0,g.m)((function(){return l}),(function(e){return l=e}))))return 2}var d=new Ma.GraphTransaction(15);try{c=a[0];d.set_undoActionId(t),d.setFromNode(c.get_node());for(u=0;u<a.length;u++)e.RemoveSelectedHyperlinks(a[u])}finally{d&&d.dispose()}e.get_TrackChangeManager().alertUntrackedChange(4)}return 32},e.RemoveSelectedHyperlinks=function(t){for(var n=Ha.HyperlinkReader.getSelectedHyperlinks(t),i=0,r=0,o=0;o<n.length;o++)if(n[o].cpBegin>=r){var a=e.get_HyperlinkStrategy().getHyperlink(t,n[o],(0,g.m)((function(){return i}),(function(e){return i=e})),(0,g.m)((function(){return r}),(function(e){return r=e})));e.get_HyperlinkStrategy().removeHyperlinks(t,a)}},e.SelectLink=function(t,n,i,r,o){if(e.get_ViewAndOpenImageHyperlinksEnabled()&&pa.ImageReader.isAnyImageContext(n))return 2;var a,l,s,u=n;if(!e.IsValidTextContextForHyperlinkAction(u,!1,(0,g.m)((function(){return a}),(function(e){return a=e}))))return 2;2===i&&(e.get_HyperlinkStrategy().getHyperlink(u,a,(0,g.m)((function(){return l}),(function(e){return l=e})),(0,g.m)((function(){return s}),(function(e){return s=e}))),fa.SelectionManager.get_instance().setSelection(Ua.SelectionFactory.createTextRangeOrIpSelection(a.paragraph,l,s)));return 32},e.OpenTextLink=function(t,n,i,r,o){var a,l=n;if(e.get_ViewAndOpenImageHyperlinksEnabled()&&e.IsValidImageBlobForHyperlinkAction(l,(0,g.m)((function(){return a}),(function(e){return a=e}))))S.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!e.IsValidTextContextForHyperlinkAction(l,!1,(0,g.m)((function(){return a}),(function(e){return a=e}))))return 2;return 2===i&&yi.App.followUrl(a.hyperlink.get_url()),32},e.OpenImageLink=function(e,t,n,i,r){var o=t,a=pa.ImageReader.getHyperlink(o.get_node());return a?(2===n&&yi.App.followUrl(a),32):2},e.CopyLinkHelper=function(t,n,i,r,o,a){if(e.get_ViewAndOpenImageHyperlinksEnabled()&&pa.ImageReader.isAnyImageContext(i))return 2;var l,s,u,c=Si.InteractiveViewManager.get_instance().get_editingView();if(!c.get_isContentEditableView())return 2;if(!e.IsValidTextContextForHyperlinkAction(i,!1,(0,g.m)((function(){return l}),(function(e){return l=e}))))return 2;if(1===r)return 32;e.get_HyperlinkStrategy().getHyperlink(i,l,(0,g.m)((function(){return s}),(function(e){return s=e})),(0,g.m)((function(){return u}),(function(e){return u=e}))),fa.SelectionManager.get_instance().setSelection(Ua.SelectionFactory.createTextRangeOrIpSelection(l.paragraph,s,u));var d=c.get_ownerDocument(),p=c.get_editingElement(),h=new Gg.w(p);ji.s.clearElement(p);var _=d.createElement("span");p.appendChild(_),_.innerText=l.hyperlink.get_url(),c.selectAllContent(),c.setSequenceCodeOnHtml();var m=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,Oi.u.copy,2,!0,o,a);return h.restore(),m},e.IsValidTextContextForHyperlinkAction=function(t,n,i){if(i.val=null,ga.SelectionEditor.isTextRangeContext(t)){var r=Cd.f.getBlobObjectsInRange(t),o=tc.p.all(fy.y,r,(function(e){return 6===e.get_blobType()}));if(r.length>0&&(!e.get_AddHyperlinkWhenSelectionContainsLineBreak()||!o))return!1;if(e.get_LockedRangeEditor().get_isContentControlEditingEnabled()&&e.get_ContentControlChpHelper())if(e.get_ContentControlChpHelper().getContentControlBoundariesInTextRange(t).get_count()>0)return!1}if(e.get_HyperlinkExpandEditEnabled())return e.IsValidContextForExpandedHyperlinkAction(t,n,i);var a=Ha.HyperlinkReader.getHyperlinksInRange(t,!0);return 1===a.length&&a[0].cpBegin<=t.get_cpBegin()&&a[0].cpEnd>=t.get_cpEnd()&&a[0].hyperlink?(i.val=a[0],!0):!a.length&&n},e.IsValidImageBlobForHyperlinkAction=function(e,t){return t.val=null,!(!pa.ImageReader.isAnyImageContext(e)||(t.val=Ha.HyperlinkReader.getImageHyperlink(e),!t.val))},e.IsValidContextForExpandedHyperlinkAction=function(e,t,n){n.val=null;var i=Ha.HyperlinkReader.getSelectedHyperlinks(e);return i.length?!!i[0].hyperlink&&(n.val=i[0],!(e.get_cpBegin()<i[0].cpBegin)||t):t},e.ContainsDeletedTrackedChanges=function(t){if(e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled())for(var n=e.get_TrackChangeReader().getTrackedChangesInRange(t.get_node(),t.get_cpBegin(),t.get_cpEnd()),i=0;i<n.get_count();++i)if(2===n.get_item(i).changeInfo.changeType)return!0;return!1},e.CanInsertHyperlink=function(){return!!e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()||(!Gl.n.get_instance().get_item(45)||!yi.App.get_box4Bridge().get_trackedChangesEnabled())},e.CanMakeHyperlinkModification=function(t){return(!Gl.n.get_instance().get_item(14)||!e.get_LockedRangeEditor().contextSetContainsLockedRange(t))&&!(e.get_ExternalSelectionManagerFuture()&&e.get_ExternalSelectionManagerFuture().get_instance()&&e.get_ExternalSelectionManagerFuture().get_instance().isExternalSelectionContext(t))},e.GetTextRangeFromParagraph=function(e,t){return Ga.ParagraphReader.isParagraphContext(e)&&!ga.SelectionEditor.isBlockContext(e)&&(Ga.ParagraphReader.textLength(e.get_node())||t)?Wa.y.createTextRange(e.get_node(),0,Ga.ParagraphReader.textLength(e.get_node())):e},e._hyperlinkEditor=null,e._ccChpHelper=null,e._hyperlinkStrategy=null,e._externalSelectionManagerFuture=null,e._trackChangeManager=null,e._trackChangeReader=null,e._ViewAndOpenImageHyperlinksEnabled=null,e._HyperlinkExpandEditEnabled=null,e._MultiParagraphHyperlinkEditEnabled=null,e._AddHyperlinkWhenSelectionContainsLineBreak=null,e}();(0,o.l)(Iy,"93f034fc$HyperlinkActor",null,[]);var wy=function(){function e(){}return e.get_IndentationEditor=function(){return hs.z.get_getOutlineElementIndentationEditor()},e.get_ContextSetEditor=function(){return am.ContextSetEditor.get_instance()},e.get_LockedRangeEditor=function(){return za.k.get_instance()},e.get_ActivityManager=function(){return xr.y.get_instance()},e.get_ExternalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=Ge.w.get_instance().resolveFuture(kg.i))},e.get_ParagraphEditor=function(){return e._paragraphEditor||(e._paragraphEditor=Ge.w.get_instance().resolve(ns.g))},e.get_ParagraphReader=function(){return e._paragraphReader||(e._paragraphReader=Ge.w.get_instance().resolve(Jd.s))},e.get_ParagraphIndentationReader=function(){return e._paragraphIndentationReader||(e._paragraphIndentationReader=Ge.w.get_instance().resolve(Sg.p))},e.get_ParagraphIndentationEditor=function(){return e.get_ParagraphEditor().getIndentationEditor()},e.get_ListReader=function(){return e._listReader||(e._listReader=Ge.w.get_instance().resolve(Ql.c))},e.RegisterActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(Oi.u.promoteIndent,ol.d.view,e.ApplyPromoteDemoteView),t.addAction(Oi.u.promoteIndent,ol.d.outlineElement,e.ApplyPromoteDemote),t.setActionFlags(Oi.u.promoteIndent,4),t.addAction(Oi.u.demoteIndent,ol.d.view,e.ApplyPromoteDemoteView),t.addAction(Oi.u.demoteIndent,ol.d.outlineElement,e.ApplyPromoteDemote),t.setActionFlags(Oi.u.demoteIndent,4)},e.ApplyPromoteDemoteView=function(t,n,i,r,o){var a=n.view;if(!a.get_isInteractiveView())return 2;var l=a.get_selectionManager();if(!l)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelectionManager}),8;var s=l.get_selectionContextForActionDispatch();if(!s)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),8;if(Gl.n.get_instance().get_item(62)&&1===i)return 32;if(Gl.n.get_instance().get_item(11)&&e.get_ContextSetEditor().contextContentsCheck(e.AnchoredImageCheck,s))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsAnchoredImage}),8;if(Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().isContextSetInLockedParagraphs(s))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsLockedRange}),8;if(e.get_ExternalSelectionManagerFuture()&&e.get_ExternalSelectionManagerFuture().get_instance()&&e.get_ExternalSelectionManagerFuture().get_instance().isExternalSelectionContext(s))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.externalSelection}),8;var u={};u[sm.viewActionPerfMarkStart]=5794,u[sm.viewActionPerfMarkEnd]=5795;var c=2;if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("Box4PartialPromoteDemoteIsEnabled")){var d=e.CanPromoteDemoteContext(t===Oi.u.promoteIndent,n,!0);if(1===i)return d?32:8;d&&(c=sm.performGenericViewLevelActionAgainstOEs(t,n,i,r,o,u))}else if(c=sm.performGenericViewLevelActionAgainstOEs(t,n,1,r,o,u),1!==i&&32===c){a.get_selectionManager().onSelectionTopologyChange();var g=new Ma.GraphTransaction(15);g.setFromNode(n.view.get_targetNode()),c=e.CanPromoteDemoteContext(t===Oi.u.promoteIndent,n,!1)?sm.performGenericViewLevelActionAgainstOEs(t,n,i,r,o,u):8,g.dispose()}else 1!==i&&8===c&&(a.get_selectionManager().onSelectionTopologyChange(),e.CompletePromoteDemoteAndIndentationAdjust(t,n,l));return c},e.CanPromoteDemoteContext=function(t,n,i){var r=n.view.get_selectionManager();if(!r||!r.get_selectionCollection().get_currentSelection())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.nonInteractiveView}),!1;if(r.get_selectionCollection().isOutlineLevelSelection)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsOutline}),!1;var o=Y_.generalizeSelectionToOEs(r.get_selectionCollection(),!1);if(!o)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.failedToGeneralizeToOEs}),!1;for(var a=!1,l=0;l<o.get_length();l++){var s=o.getContext(l),u=new ha.g;if(u.set(s.get_node()),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(u),!Ss.OutlineElementReader.isOutlineElement(u)){if(i)continue;return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.doesNotContainOe}),!1}if(!(t?e.get_IndentationEditor().canPromote(u,-1):e.get_IndentationEditor().canDemote(u,1))){if(i)continue;return e.get_ActivityManager().recordEvent(ah.f.doNothingResult,{Reason:lh.i.cannotPromoteOrDemote}),!1}a=!0}return!i||a},e.ApplyPromoteDemote=function(t,n,i,r,o){if(n.get_contextId()!==ol.d.outlineElement)return 2;var a=n;if(Gl.n.get_instance().get_item(14)){var l=a.clone().specialize();if(us.TableReader.isTableContext(l)){if(e.get_LockedRangeEditor().isTableContextInLockedRange(l))return e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),8}else if(e.get_LockedRangeEditor().isParaStartOrEndInLockedRange(l))return e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),2}var s=new ha.g;if(s.set(a.get_node()),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(s),!Ss.OutlineElementReader.isOutlineElement(s))return 2;var u=!1;switch(t){case Oi.u.promoteIndent:u=e.get_IndentationEditor().canPromote(s,-1);break;case Oi.u.demoteIndent:u=e.get_IndentationEditor().canDemote(s,1);break;default:return 2}if(1===i||!u)return u?32:8;var c=0;switch(t===Oi.u.demoteIndent&&o&&o.getValueWithDefault(Boolean,Pl.k.autoDemoteLists,!1)&&(c|=2),t){case Oi.u.promoteIndent:e.get_IndentationEditor().promote(s,-1,c);break;case Oi.u.demoteIndent:e.get_IndentationEditor().demote(s,1,c)}return 32},e.CompletePromoteDemoteAndIndentationAdjust=function(t,n,i){var r=new Ma.GraphTransaction(15);try{r.setFromNode(n.view.get_targetNode());for(var o=!0,a=Y_.generalizeSelectionToOEs(i.get_selectionCollection(),!1),l=0;l<a.get_length();l++){var s=a.getContext(l);if((h=new ha.g).set(s.get_node()),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(h),Ss.OutlineElementReader.isOutlineElement(h)){if(t===Oi.u.promoteIndent?e.get_IndentationEditor().canPromote(h,-1):e.get_IndentationEditor().canDemote(h,1))switch(o=!1,t){case Oi.u.promoteIndent:e.get_IndentationEditor().promote(h,-1,0);break;case Oi.u.demoteIndent:e.get_IndentationEditor().demote(h,1,0)}}else o=!1}if(o){var u=i.get_selectionCollection().get_currentSelection();for(l=0;l<u.get_length();l++){var c=u.get_item(l);if(c.get_isGraphNodeContext()){var d=c.get_node(),g=e.get_ParagraphIndentationReader().getIndentInfo(d),p=g.specialIndentValueTwips;if(t===Oi.u.promoteIndent?g.indentLeftValue>p:g.indentLeftValue<2*p*9){var h;(h=new ha.g).set(c.get_node());var _=p;_=t===Oi.u.promoteIndent?g.indentLeftValue>=2.5*p?g.indentLeftValue-2*p:p:g.indentLeftValue<2*p*8?g.indentLeftValue+2*p:2*p*9,e.get_ParagraphIndentationEditor().setIndentLeft(h,1,_)}}}}}finally{r&&r.dispose()}},e._externalSelectionManagerFuture=null,e._paragraphEditor=null,e._paragraphReader=null,e._paragraphIndentationReader=null,e._listReader=null,e.AnchoredImageCheck=pa.ImageReader.isAnchoredImageContext,e}();(0,o.l)(wy,"27ea094b$IndentationActor",null,[]);var xy=function(){function e(){}return e.get_ImageEditor=function(){return e._imageEditor||(e._imageEditor=Ge.w.get_instance().resolve(Za.w))},e.get_ParagraphEditor=function(){return e._paragraphEditor||(e._paragraphEditor=Ge.w.get_instance().resolve(ns.g))},e.get_TableEditor=function(){return e._tableEditor||(e._tableEditor=Ge.w.get_instance().resolve(au.z))},e.get_LockedRangeEditor=function(){return za.k.get_instance()},e.get_ActivityManager=function(){return xr.y.get_instance()},e.get_ExternalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=Ge.w.get_instance().resolveFuture(kg.i))},e.RegisterActions=function(){var t=L.AFrameworkApplication.get_theActionManager();Gl.n.get_instance().get_item(77)||(t.addAction(Oi.u.leftJustify,ol.d.table,e.ApplyTableJustification),t.addAction(Oi.u.centerJustify,ol.d.table,e.ApplyTableJustification),t.addAction(Oi.u.rightJustify,ol.d.table,e.ApplyTableJustification)),t.addAction(Oi.u.leftJustify,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.leftJustify,ol.d.paragraph,e.ApplyParagraphJustification),t.addAction(Oi.u.leftJustify,ol.d.image,e.ApplyImageJustification),t.addAction(Oi.u.leftJustify,ol.d.embeddedFile,e.ApplyImageJustification),t.setActionFlags(Oi.u.leftJustify,4),t.addAction(Oi.u.centerJustify,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.centerJustify,ol.d.paragraph,e.ApplyParagraphJustification),t.addAction(Oi.u.centerJustify,ol.d.image,e.ApplyImageJustification),t.addAction(Oi.u.centerJustify,ol.d.embeddedFile,e.ApplyImageJustification),t.setActionFlags(Oi.u.centerJustify,4),t.addAction(Oi.u.rightJustify,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.rightJustify,ol.d.paragraph,e.ApplyParagraphJustification),t.addAction(Oi.u.rightJustify,ol.d.image,e.ApplyImageJustification),t.addAction(Oi.u.rightJustify,ol.d.embeddedFile,e.ApplyImageJustification),t.setActionFlags(Oi.u.rightJustify,4),Gl.n.get_instance().get_item(54)&&(t.addAction(Oi.u.fullJustify,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.fullJustify,ol.d.paragraph,e.ApplyParagraphJustification),t.setActionFlags(Oi.u.fullJustify,4),t.addAction(Oi.u.distributedJustify,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.distributedJustify,ol.d.paragraph,e.ApplyParagraphJustification),t.setActionFlags(Oi.u.distributedJustify,4),t.addAction(Oi.u.kashidaJustify,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.kashidaJustify,ol.d.paragraph,e.ApplyParagraphJustification),t.setActionFlags(Oi.u.kashidaJustify,4),t.addAction(Oi.u.setThaiDistributedJustify,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.setThaiDistributedJustify,ol.d.paragraph,e.ApplyParagraphJustification),t.setActionFlags(Oi.u.setThaiDistributedJustify,4)),t.addAction(Oi.u.leftTextJustify,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.leftTextJustify,ol.d.paragraph,e.ApplyParagraphJustification),t.addAction(Oi.u.leftTextJustify,ol.d.image,e.ApplyImageJustification),t.setActionFlags(Oi.u.leftTextJustify,4),t.addAction(Oi.u.centerTextJustify,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.centerTextJustify,ol.d.paragraph,e.ApplyParagraphJustification),t.addAction(Oi.u.centerTextJustify,ol.d.image,e.ApplyImageJustification),t.setActionFlags(Oi.u.centerTextJustify,4),t.addAction(Oi.u.rightTextJustify,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.rightTextJustify,ol.d.paragraph,e.ApplyParagraphJustification),t.addAction(Oi.u.rightTextJustify,ol.d.image,e.ApplyImageJustification),t.setActionFlags(Oi.u.rightTextJustify,4),Gl.n.get_instance().get_item(54)&&(t.addAction(Oi.u.fullTextJustify,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.fullTextJustify,ol.d.paragraph,e.ApplyParagraphJustification),t.setActionFlags(Oi.u.fullTextJustify,4))},e.ApplyTableJustification=function(t,n,i,r,o){var a=!0,l=n;if(!l)return 8;if(us.TableReader.isTableContext(l)?Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().isTableContextInLockedRange(l)?(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),a=!1):e.get_ExternalSelectionManagerFuture()&&e.get_ExternalSelectionManagerFuture().get_instance()&&e.get_ExternalSelectionManagerFuture().get_instance().isExternalSelectionContext(n)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.externalSelection}),a=!1):(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.doesNotContainTable}),a=!1),1===i||!a)return a?32:8;var s=l.get_node();switch(t){case Oi.u.leftJustify:e.get_TableEditor().setJustification(s,1);break;case Oi.u.centerJustify:e.get_TableEditor().setJustification(s,2);break;case Oi.u.rightJustify:e.get_TableEditor().setJustification(s,3)}return 32},e.ApplyImageJustification=function(t,n,i,r,o){var a;if(!$f.shouldExecuteImageAction(i,n,(0,g.m)((function(){return a}),(function(e){return a=e}))))return a;var l=n.get_node();switch(t){case Oi.u.leftJustify:case Oi.u.leftTextJustify:e.get_ImageEditor().setJustification(l,1);break;case Oi.u.centerJustify:case Oi.u.centerTextJustify:e.get_ImageEditor().setJustification(l,2);break;case Oi.u.rightJustify:case Oi.u.rightTextJustify:e.get_ImageEditor().setJustification(l,3)}return 32},e.ApplyParagraphJustification=function(t,n,i,r,o){var a=!0;if(n.get_contextId()!==ol.d.paragraph?a=!1:Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().isParaStartOrEndInLockedRange(n)?(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),a=!1):e.get_ExternalSelectionManagerFuture()&&e.get_ExternalSelectionManagerFuture().get_instance()&&e.get_ExternalSelectionManagerFuture().get_instance().isExternalSelectionContext(n)&&(e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.externalSelection}),a=!1),1===i||!a)return a?32:8;var l=n.get_node(),s=Ga.ParagraphReader.getJustification(l);switch(t){case Oi.u.leftJustify:case Oi.u.leftTextJustify:e.get_ParagraphEditor().setJustification(l,1===s&&e.IsToggleActionEnabled(o)?6:1);break;case Oi.u.centerJustify:case Oi.u.centerTextJustify:e.get_ParagraphEditor().setJustification(l,2===s&&e.IsToggleActionEnabled(o)?1:2);break;case Oi.u.rightJustify:case Oi.u.rightTextJustify:e.get_ParagraphEditor().setJustification(l,3===s&&e.IsToggleActionEnabled(o)?1:3);break;case Oi.u.fullJustify:case Oi.u.fullTextJustify:e.get_ParagraphEditor().setJustification(l,6===s&&e.IsToggleActionEnabled(o)?1:6);break;case Oi.u.kashidaJustify:e.get_ParagraphEditor().setJustification(l,11);break;case Oi.u.distributedJustify:e.get_ParagraphEditor().setJustification(l,7);break;case Oi.u.setThaiDistributedJustify:e.get_ParagraphEditor().setJustification(l,13)}return 32},e.IsToggleActionEnabled=function(e){var t=!1;return null!==e&&Object.getType(e)===Object&&e.hasOwnProperty("InContextSet")&&(t=e.InContextSet),!t&&Gl.n.get_instance().get_item(110)},e._imageEditor=null,e._tableEditor=null,e._paragraphEditor=null,e._externalSelectionManagerFuture=null,e}();(0,o.l)(xy,"7ce5cca$JustificationActor",null,[]);var Ey=function(){function e(){}return e.RegisterActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(Oi.u.save,Ue.m.frame,e.Save),t.addAction(Oi.u.sync,Ue.m.frame,e.Sync)},e.Sync=function(e,t,n,i,r){return 1===n?32:(L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.cancelFindAndSearch,2),yi.App.theNotebookManager.syncNotebook(),32)},e.Save=function(e,t,n,i,r){return 1===n?2===yi.App.get_activeAppFrame().get_mode()?32:8:(L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.cancelFindAndSearch,2),2!==yi.App.get_activeAppFrame().get_mode()?32:(yi.App.theNotebookManager.saveNotebook(null,null,null,!1),32))},e}();(0,o.l)(Ey,"d6c162d3$NotebookActor",null,[]);var Fy=function(){function e(){}return e.prototype.RegisterActions=function(){var e=L.AFrameworkApplication.get_theActionManager();e.addAction(Oi.u.activateRibbonTab,ol.d.view,o.i(this,this.ActivateRibbonTab,"ActivateRibbonTab")),e.setActionFlags(Oi.u.activateRibbonTab,5),e.addAction(Oi.u.jewelOpenMenuShortcut,ol.d.view,o.i(this,this.LaunchJewelOpenMenuShortcut,"LaunchJewelOpenMenuShortcut"))},e.prototype.ActivateRibbonTab=function(e,t,n,i,r){return yi.App.get_box4Bridge().get_commandUi().ribbonActivateTab(r.toString()),32},e.prototype.LaunchJewelOpenMenuShortcut=function(e,t,n,i,r){return L.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings"),yi.App.get_box4Bridge().get_commandUi().jewelMenuLaunch(1,r.toString()),32},e.get_instance=function(){return e._instance||(e._instance=e.GetInstanceWithResolvedDependencies())},e.GetInstanceWithResolvedDependencies=function(){return new e},e._instance=null,e}();(0,o.l)(Fy,"1c942bd0$RibbonActor",null,[]);var Py=n(1109),Dy=n(3200),Ry=function(){function e(e,t){this._undoManager=null,this._undoManagerFactory=null,this._coauthTelemetry=null,this._undoManagerFactory=e,this._coauthTelemetry=t}return e.prototype.get_UndoManager=function(){return this._undoManager||(this._undoManager=this._undoManagerFactory())},e.prototype.RegisterActions=function(){var e=L.AFrameworkApplication.get_theActionManager(),t=o.i(this,this.UndoRedo,"UndoRedo");e.addActionWithFlags(Oi.u.undo,ol.d.view,t,1028),e.addActionWithFlags(Oi.u.redo,ol.d.view,t,1028)},e.prototype.UndoRedo=function(t,n,i,r,o){var a,l=n.view;if(!l.get_isInteractiveView())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.nonInteractiveView}),8;var s=l;if(a=t===Oi.u.undo?this.get_UndoManager().get_hasUndoEntries():this.get_UndoManager().get_hasRedoEntries(),1===i)return a?32:8;if(!a)return S.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",t===Oi.u.undo?"undo":"redo"),this._coauthTelemetry.get_value().undoRedoAttemptedWhenThereIsNoStack(),e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.undoDisabled}),2;var u,c=new Ma.GraphTransaction(3);if(c.setFromNode(s.get_targetNode()),c.setAsyncOperationWithoutParent(),u=t===Oi.u.undo?this.get_UndoManager().undo():this.get_UndoManager().redo(),c.dispose(),o){var d=o;Dy.o.get_instance().updateVisibilityFromInputMethod(d.inputMethod)}return u?32:(e.get_ActivityManager().recordEvent(ah.f.doNothingResult,{Reason:lh.i.noEntries}),8)},e.get_Instance=function(){return e._instance||(e._instance=e.GetInstanceWithResolvedDependencies())},e.GetInstanceWithResolvedDependencies=function(){var t=Ge.w.get_instance();return new e((function(){return t.resolve(wa.n)}),t.resolveLazy(Py.a))},e.get_ActivityManager=function(){return xr.y.get_instance()},e._instance=null,e}();(0,o.l)(Ry,"4a2a3ada$UndoActor",null,[]);var My=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.Actors"},e.prototype.configure=function(e){this._container=e,(new hy).configure(e)},e.prototype.init=function(){(this._container.resolve(oh.ClipboardActor).RegisterActions(),_y.registerActions(),Wf.get_instance().registerActions(),Iy.registerActions(),wy.RegisterActions(),xy.RegisterActions(),this._container.resolve(md).registerActions(),Ey.RegisterActions(),Gl.n.get_instance().get_item(70))&&this._container.resolve(xf).RegisterActions();(Fy.get_instance().RegisterActions(),Gl.n.get_instance().get_item(71))&&this._container.resolve(Rf).RegisterActions();Em.registerActions(yi.App.theContextSetActor),this._container.resolve(qf).RegisterActions(),Ry.get_Instance().RegisterActions(),this._container.resolve(Md).RegisterContentDetailsProviders(),this._container.resolve(fd.h),this._container.resolve(zm),yi.App.get_activeAppFrame().updateCommandUI()},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(My,"9b53b422$Box4ActorsPackage",null,[s.u,u.s]);var ky=function(){function e(e,t,n,i){this._colorMenu=null,this._actionManager=null,this._themeColorResolver=null,this._menuCacheInvalidator=null,this._pageReader=null,this._actionManager=e,this._themeColorResolver=t,this._menuCacheInvalidator=n,this._pageReader=i}return e.prototype.get_shadingColorMenu=function(){return this._colorMenu||(this._colorMenu=new Gf(e.ColorMenuName),this.initializeMenu(this._colorMenu)),this._colorMenu},e.prototype.initializeMenu=function(e){e.addMenuControl(2,Oi.u.clearCellShadingColor),e.addMenuControl(3,Oi.u.setCellShadingColor),e.addMenuControl(4,Oi.u.setCellShadingColor),e.addToMenuCacheInvalidator(this._menuCacheInvalidator,1)},e.prototype.registerActions=function(){this._actionManager.addAction(Oi.u.populateCellShadingColor,ol.d.view,o.i(this,this.populateCellShadingColor,"populateCellShadingColor")),this._actionManager.addAction(Oi.u.populateCellShadingColor,ol.d.tableCell,o.i(this,this.populateCellShadingColor,"populateCellShadingColor")),this._actionManager.setActionFlags(Oi.u.populateCellShadingColor,102),this._actionManager.addAction(Oi.u.cellShadingColorMenuOpen,ol.d.view,Em.genericViewActionTableCellHandler),this._actionManager.addAction(Oi.u.cellShadingColorMenuOpen,ol.d.tableCell,o.i(this,this.cellShadingColorMenuOpen,"cellShadingColorMenuOpen")),this._actionManager.setActionFlags(Oi.u.cellShadingColorMenuOpen,4),this._actionManager.addAction(Oi.u.setCellShadingColor,ol.d.view,Em.genericViewActionTableCellHandler),this._actionManager.addAction(Oi.u.setCellShadingColor,ol.d.tableCell,o.i(this,this.cellShadingColor,"cellShadingColor")),this._actionManager.setActionFlags(Oi.u.setCellShadingColor,4),this._actionManager.addAction(Oi.u.clearCellShadingColor,ol.d.view,Em.genericViewActionTableCellHandler),this._actionManager.addAction(Oi.u.clearCellShadingColor,ol.d.tableCell,o.i(this,this.clearCellShadingColor,"clearCellShadingColor")),this._actionManager.setActionFlags(Oi.u.clearCellShadingColor,4)},e.prototype.cellShadingColorMenuOpen=function(e,t,n,i,r){return this.isShadingActionEnabled(t,n,r,!1)?32:8},e.prototype.cellShadingColor=function(e,t,n,i,r){var o;if(!this.shouldExecuteShadingAction(t,n,r,!0,(0,g.m)((function(){return o}),(function(e){return o=e}))))return o;var a=t,l=this._themeColorResolver.colorFromThemeColor(a.get_node(),r);return this.performShadingColorTransaction(a.get_node(),l),32},e.prototype.clearCellShadingColor=function(e,t,n,i,r){var o;if(!this.shouldExecuteShadingAction(t,n,r,!1,(0,g.m)((function(){return o}),(function(e){return o=e}))))return o;var a=t;return this.performClearShadingColorTransaction(a.get_node()),32},e.prototype.populateCellShadingColor=function(e,t,n,i,r){if(1===n)return 32;var o=t.get_contextId()===ol.d.view?this._pageReader.getPageContentNodeFromContext(t):this.getPageContentNodeFromTableCellContext(t),a=r;if(L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()){var l=this.get_shadingColorMenu().generateColorControlProperties(o,yi.App.colorMenuThemeStringsType);if(!l)return 8;a.MenuItems=l}var s=this.get_shadingColorMenu().createColorControl(o,yi.App.colorMenuThemeStringsType);return s?(a.PopulationXML=s,32):8},e.prototype.shouldExecuteShadingAction=function(e,t,n,i,r){return this.isShadingActionEnabled(e,t,n,i)?(r.val=32,2===t):(r.val=8,!1)},e.prototype.isShadingActionEnabled=function(e,t,n,i){if(e.get_contextId()!==ol.d.tableCell)return!1;if(2===t){if(i&&!n)return!1;if(!e.get_node())return!1}return!0},e.prototype.performShadingColorTransaction=function(e,t){var n=new Ma.GraphTransaction(15);n.setFromNode(e),e.get_properties().setValue(is.b.cellShadingColor,t),n.dispose()},e.prototype.performClearShadingColorTransaction=function(e){var t=new Ma.GraphTransaction(15);t.setFromNode(e),e.get_properties().removeProperty(is.b.cellShadingColor),t.dispose()},e.prototype.getPageContentNodeFromTableCellContext=function(t){if(t.get_contextId()!==ol.d.tableCell)return null;var n=t,i=e.get_PageNavigator().navigateToPageContentNode(n.get_node());return i||null},e.GetCellShadingActorWithResolvedDependencies=function(){return new e(L.AFrameworkApplication.get_theActionManager(),mf.m.get_instance(),Lf.d.get_instance(),$s.PageReader.get_instance())},e.get_PageNavigator=function(){return Ii.PageNavigator.get_instance()},e.get_instance=function(){return e._singletonInstance||(e._singletonInstance=e.GetCellShadingActorWithResolvedDependencies())},e.ColorMenuName="Shading",e._singletonInstance=null,e}();(0,o.l)(ky,"74ab58b2$CellShadingActor",null,[]);var Ny=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.CellShading"},e.prototype.configure=function(e){this._container=e},e.prototype.init=function(){var e=this,t=this._container.tryResolve(Yh.d);t?t.get_graphFeaturesNodeTask().CW((function(t){e.OnAfterGraphFeaturesNodeLoaded()})):this.OnAfterGraphFeaturesNodeLoaded()},e.prototype.OnAfterGraphFeaturesNodeLoaded=function(){var e=this._container.tryResolve(Yh.d);(e?e.isFeatureEnabled(17):yi.App.cellShadingUIIsEnabled)&&(ky.get_instance().registerActions(),yi.App.get_activeAppFrame().updateCommandUI())},e.prototype.dispose=function(){},e}();(0,o.l)(Ny,"d4fd70a3$CellShadingPackage",null,[s.u,u.s]);var Ly=function(){function e(){}return e.main=function(){B.o.get_instance().registerPackage(new Ny)},e}();(0,o.l)(Ly,"90166255$Program",null,[]);var By,Oy=n(1983),Uy=n(38);!function(e){e[e.element=1]="element",e[e.attribute=2]="attribute",e[e.text=3]="text",e[e.characterData=4]="characterData",e[e.entityReference=5]="entityReference",e[e.entity=6]="entity",e[e.processingInstruction=7]="processingInstruction",e[e.comment=8]="comment",e[e.document=9]="document",e[e.documentType=10]="documentType",e[e.documentFragment=11]="documentFragment",e[e.notation=12]="notation"}(By||(By={})),(0,o.h)("4a68fc17$XmlNodeType",By);var Hy=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)},e.DialogHtmlFormat="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>",e}();(0,o.l)(Hy,"919cc6c3$InsertClipartDialogHtml",null,[]);var Gy=n(4882),Wy=n(7928),Vy=function(){function e(){this._clipUrl=null,this._assetId=null,this._thumbnailUrl=null,this._previewUrl=null,this._width=null,this._height=null,this._resolution=0,this._rating=null,this._numOfRatings=null,this._displayName=null,this._contentLength=0,this._keywords=null,this._provider=null,this._attributionLink=null,this._isCSC=!1,this._additionalValue=null,this._additionalCaption=null,this._additionalString=null}return e.prototype.get_clipUrl=function(){return this._clipUrl},e.prototype.get_assetId=function(){return this._assetId},e.prototype.get_thumbnailUrl=function(){return this._thumbnailUrl},e.prototype.get_previewUrl=function(){return this._previewUrl},e.prototype.get_displayName=function(){return this._displayName},e.prototype.get_dimensions=function(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,this._width,this._height)},e.prototype.get_additionalLink=function(){if(this._additionalCaption&&this._additionalString&&this._additionalValue){var e=document.createElement("a");return e.setAttribute("href",this._additionalValue),e.setAttribute("target","_blank"),e.innerText=this._additionalString,e}return null},e.prototype.get_additionalCaption=function(){return this._additionalCaption},e.prototype.get_fileSize=function(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this._contentLength)},e.prototype.get_ratingSpan=function(){var e=document.createElement("span"),t=0;if(this._rating&&this._rating.length>0){for(var n=this._rating.indexOf("."),i=n<0?this._rating:this._rating.substring(0,n),r=Number.parseInvariant(i);t<r&&t<5;t++)e.appendChild(Ct.ImageClusteringHelper.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Wy.f.box4Image("box42.png"),"","",!0,""));if(n>0){var o=Number.parseInvariant(this._rating.substr(n+1));o<3?e.appendChild(Ct.ImageClusteringHelper.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Wy.f.box4Image("box42.png"),"","",!0,"")):o<8?e.appendChild(Ct.ImageClusteringHelper.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",Wy.f.box4Image("box42.png"),"","",!0,"")):e.appendChild(Ct.ImageClusteringHelper.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Wy.f.box4Image("box42.png"),"","",!0,"")),t++}}for(var a=t;a<5;a++)e.appendChild(Ct.ImageClusteringHelper.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Wy.f.box4Image("box42.png"),"","",!0,""));if(this._numOfRatings){var l=document.createElement("span");l.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this._numOfRatings),e.appendChild(l)}return e},e.prototype.get_resolution=function(){return this._resolution>0?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this._resolution):""},e.prototype.get_attributionLink=function(){var t;return this._isCSC?((t=document.createElement("span")).innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity,t):this._attributionLink&&this._provider?e.CreateLink(this._attributionLink,this._provider):((t=document.createElement("span")).innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft,t)},e.prototype.get_keywords=function(){var e;if(this._keywords){var t=this._keywords.split(",");e=new Array(t.length);for(var n=0;n<t.length;n++)e[n]=t[n].trim()}else e=new Array(0);return e},e.fromXML=function(t){for(var n=new e,i=0;i<t.childNodes.length;i++){var r=t.childNodes[i];if(r.nodeType===By.element)try{var o=r.firstChild.nodeValue;switch(r.nodeName){case e.c_ClipUrl:n._clipUrl=o;break;case e.c_AssetId:n._assetId=o;break;case e.c_ThumbnailUrl:"64x64"===r.attributes.getNamedItem("size").nodeValue?n._thumbnailUrl=e.TrimProtocol(o):"192x192"===r.attributes.getNamedItem("size").nodeValue&&(n._previewUrl=e.TrimProtocol(o));break;case e.c_ResponseWidth:if(o){var a=o.indexOf("x");a>0&&a<o.length&&(n._width=o.substr(0,a),n._height=o.substr(a+1))}break;case e.c_Resolution:n._resolution=Number.parseInvariant(o);break;case e.c_Rating:n._rating=o;break;case e.c_NumOfRatings:n._numOfRatings=o;break;case e.c_DisplayName:n._displayName=o;break;case e.c_ContentLength:n._contentLength=Number.parseInvariant(o)/1024;break;case e.c_Keywords:n._keywords=o;break;case e.c_Provider:n._provider=o;break;case e.c_AttributionLink:n._attributionLink=o;break;case e.c_IsCSC:n._isCSC=1===Number.parseInvariant(o);break;case e.c_Additional:var l=r.firstChild;if(r.hasChildNodes()&&l&&"id"===l.nodeName&&1===Number.parseInvariant(l.text))for(var s=0;s<r.childNodes.length;s++){var u=r.childNodes[s];switch(u.nodeName){case"caption":n._additionalCaption=u.text;break;case"value":n._additionalValue=u.text;break;case"string":n._additionalString=u.text}}}}catch(e){}}return n},e.CreateLink=function(e,t){var n=document.createElement("a");return n.setAttribute("href",e),n.setAttribute("target","_blank"),n.innerText=t,n},e.TrimProtocol=function(e){var t;return e&&(t=e.indexOf("://"))>0?e.substr(t+1):e},e.c_ClipUrl="src",e.c_AssetId="assetid",e.c_ThumbnailUrl="thumb",e.c_ResponseWidth="imagedim",e.c_Resolution="resolution",e.c_Rating="rating",e.c_NumOfRatings="numofratings",e.c_DisplayName="displayname",e.c_ContentLength="contentlength",e.c_Provider="provider",e.c_AttributionLink="attributionlink",e.c_Keywords="subject",e.c_IsCSC="iscsc",e.c_Additional="additional",e}();(0,o.l)(Vy,"29ba385e$ClipArtSearchResult",null,[]);var $y=function(e){function t(n){var i=this;return i._textInput=null,i._searchResult=null,i._clipartUploader=null,i._iSelectedClip=0,i._iFocusedClip=0,i._prevQuery=null,i._prevSimilar=!1,i._images=null,i._divPreview=null,i._divDisplayName=null,i._divSeeSimilar=null,i._divDimensions=null,i._divAdditional=null,i._divRating=null,i._divAttribution=null,i._divKeywords=null,i._btnSearch=null,i._divAdditionalName=null,i._divRatingName=null,i._divAttributionName=null,i._progress=null,i._searchResultsKeyDownHandler=null,i._textInputKeyDownHandler=null,i._textInputKeyPressHandler=null,i._textInputPasteHandler=null,i._searchButtonClickHandler=null,i._searchResultScrollHandler=null,i._previewClipHandler=null,i._thumbnailLoadErrorHandler=null,i._previewLoadErrorHandler=null,i._hyperlinkClickHandler=null,i._hyperlinkKeyDownHandler=null,i._keywordClickHandler=null,i._keywordKeyDownHandler=null,i._seeSimilarClickHandler=null,i._seeSimilarKeyDownHandler=null,(i=e.call(this)||this)._clipartUploader=n,i.set_dialogHtml(Hy.get_dialogHtml()),i.set_dialogId(t.Id),i.setButtonText(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText),i.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,o.i(i,i.InsertClipartDialogHandler,"InsertClipartDialogHandler")),i._searchResult=document.getElementById("clipartsearchresults"),i._searchResultsKeyDownHandler=o.i(i,i.OnKeyDown,"OnKeyDown"),wo.n.addHandler(i._searchResult,"keydown",i._searchResultsKeyDownHandler),i._searchResultScrollHandler=o.i(i,i.OnScroll,"OnScroll"),wo.n.addHandler(i._searchResult,"scroll",i._searchResultScrollHandler),i._textInput=document.getElementById("textInput"),i._textInputKeyDownHandler=o.i(i,i.OnSearchQueryKeyDown,"OnSearchQueryKeyDown"),wo.n.addHandler(i._textInput,"keydown",i._textInputKeyDownHandler),i._textInputKeyPressHandler=o.i(i,i.OnSearchQueryAddCharacters,"OnSearchQueryAddCharacters"),wo.n.addHandler(i._textInput,"keypress",i._textInputKeyPressHandler),i._textInputPasteHandler=o.i(i,i.OnSearchQueryAddCharacters,"OnSearchQueryAddCharacters"),wo.n.addHandler(i._textInput,"paste",i._textInputPasteHandler),i._btnSearch=document.getElementById("btnSearch"),i._btnSearch.setAttribute("src",Wy.f.box4Image("search.16x16x32.png")),i._searchButtonClickHandler=o.i(i,i.OnSearchButton,"OnSearchButton"),wo.n.addHandler(i._btnSearch,"click",i._searchButtonClickHandler),i._divPreview=document.getElementById("clipartpreviewimage"),i._divDisplayName=document.getElementById("clipartattributedisplayname"),i._divSeeSimilar=document.getElementById("clipartseesimilar"),i._divDimensions=document.getElementById("clipartdimensions"),i._divAdditional=document.getElementById("clipartadditionalvalue"),i._divRating=document.getElementById("clipartratingvalue"),i._divAttribution=document.getElementById("clipartattributionvalue"),i._divKeywords=document.getElementById("clipartkeywords"),i._divAdditionalName=document.getElementById("clipartadditionalname"),i._divRatingName=document.getElementById("clipartratingname"),i._divAttributionName=document.getElementById("clipartattributionname"),i._previewClipHandler=o.i(i,i.OnPreviewClip,"OnPreviewClip"),i._thumbnailLoadErrorHandler=o.i(i,i.OnThumbnailLoadError,"OnThumbnailLoadError"),i._hyperlinkClickHandler=o.i(i,i.OnHyperlinkClick,"OnHyperlinkClick"),i._hyperlinkKeyDownHandler=o.i(i,i.OnHyperlinkKeyDown,"OnHyperlinkKeyDown"),i._keywordClickHandler=o.i(i,i.OnKeywordClick,"OnKeywordClick"),i._keywordKeyDownHandler=o.i(i,i.OnKeywordKeyDown,"OnKeywordKeyDown"),i._seeSimilarClickHandler=o.i(i,i.OnSeeSimilarClick,"OnSeeSimilarClick"),i._seeSimilarKeyDownHandler=o.i(i,i.OnSeeSimilarKeyDown,"OnSeeSimilarKeyDown"),i._textInput.focus(),i.setButtonState(1,!1),i}return(0,v.t)(t,e),t.prototype.dispose=function(){this._searchResult&&this.CleanupSearchResults(),this._searchResult&&this._searchResultsKeyDownHandler&&(wo.n.removeHandler(this._searchResult,"keydown",this._searchResultsKeyDownHandler),this._searchResultsKeyDownHandler=null),this._searchResult&&this._searchResultScrollHandler&&(wo.n.removeHandler(this._searchResult,"scroll",this._searchResultScrollHandler),this._searchResultScrollHandler=null),this._searchResult=null,this._textInput&&this._textInputKeyDownHandler&&(wo.n.removeHandler(this._textInput,"keydown",this._textInputKeyDownHandler),this._textInputKeyDownHandler=null),this._textInput&&this._textInputKeyPressHandler&&(wo.n.removeHandler(this._textInput,"keypress",this._textInputKeyPressHandler),this._textInputKeyPressHandler=null),this._textInput&&this._textInputPasteHandler&&(wo.n.removeHandler(this._textInput,"paste",this._textInputPasteHandler),this._textInputPasteHandler=null),this._textInput=null,this._btnSearch&&this._searchButtonClickHandler&&(wo.n.removeHandler(this._btnSearch,"click",this._searchButtonClickHandler),this._searchButtonClickHandler=null,this._btnSearch=null),this._previewClipHandler=null,this._thumbnailLoadErrorHandler=null,this._previewLoadErrorHandler=null,this._hyperlinkClickHandler=null,this._hyperlinkKeyDownHandler=null,this._keywordClickHandler=null,this._keywordKeyDownHandler=null,this._seeSimilarClickHandler=null,this._seeSimilarKeyDownHandler=null,this._divPreview=null,this._divDisplayName=null,this._divSeeSimilar=null,this._divDimensions=null,this._divAdditional=null,this._divRating=null,this._divAttribution=null,this._divKeywords=null,this._divAdditionalName=null,this._divRatingName=null,this._divAttributionName=null,this._progress&&(this._progress.dispose(),this._progress=null),e.prototype.dispose.call(this)},t.prototype.sizeAndPositionDialog=function(){e.prototype.sizeAndPositionDialog.call(this);document.getElementById(this.myId("WACDialogPanel")).style.width=String.format("{0}px",656)},t.prototype.OnSearchButton=function(e){var t=this._textInput.value;t&&t.trim().length>0&&(this.Search(this._textInput.value),this.setButtonState(1,!1)),e.preventDefault(),e.stopPropagation()},t.prototype.Search=function(e){this.SendSearchRequest(e,!1,o.i(this,this.ProcessSearchResults,"ProcessSearchResults"))},t.prototype.SendSearchRequest=function(e,t,n){if(this._iSelectedClip=0,this._iFocusedClip=0,this.CleanupSearchResults(),this._images&&e===this._prevQuery&&this._prevSimilar===t)window.setTimeout(o.i(this,this.DisplaySearchResults,"DisplaySearchResults"),500);else{this._images&&(Array.clear(this._images),this._images=null),this._prevQuery=e,this._prevSimilar=t;var i=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');i.append("<query>"),i.append(Rn.l.xmlEncode(e)),i.append("</query>"),i.append("<mediatype>Illustration</mediatype>"),i.append("<mediatype>Photo</mediatype>"),i.append("<filetype>jpg</filetype>"),i.append("<filetype>jpeg</filetype>"),i.append("<filetype>gif</filetype>"),i.append("<filetype>bmp</filetype>"),i.append("<filetype>tif</filetype>"),i.append("<filetype>tiff</filetype>"),i.append("<filetype>png</filetype>"),i.append("</search>");for(var r={"Content-Type":"text/xml; charset=utf-8"},a=L.AFrameworkApplication.lcid.toString(16).toUpperCase(),l=a.length;l<4;l++)a="0"+a;L.AFrameworkApplication.theClientRequestManager.addRequest(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",yi.App.webServiceBase,a,gp.a.similar,t.toString()),2,i.toString(),r,!0,2,n,o.i(this,this.OnError,"OnError"),null)}},t.prototype.SearchSimilar=function(e){this.SendSearchRequest(e.get_assetId(),!0,o.i(this,this.ProcessSearchResults,"ProcessSearchResults")),this._images||(this._images=[],Array.add(this._images,e))},t.prototype.OnSearchQueryKeyDown=function(e){(e?e.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.OnSearchButton(e),e.preventDefault(),e.stopPropagation())},t.prototype.OnSearchQueryAddCharacters=function(e){this._textInput.value.length>=100&&(e.preventDefault(),e.stopPropagation())},t.prototype.OnPreviewClip=function(e){var t=e.target.parentNode.id,n=Number.parseInvariant(t.substr(4));this.PreviewClip(n),this.SetFocusOnClip(n)},t.prototype.OnScroll=function(e){var t=this._searchResult.scrollTop;if(this._searchResult&&this._searchResult.children&&!(this._searchResult.children.length<2)){var n=this._searchResult.children[0].children[0],i=this._searchResult.clientHeight-(n.clientHeight-n.children[0].clientHeight+2)+this._searchResult.scrollTop,r=n.clientHeight+2,o=parseInt(String(t/r)),a=parseInt(String(i/r)),l=parseInt(String(this._searchResult.clientWidth/r));a<i/r&&a<parseInt(String(this._images.length/l))&&a++;for(var s=o;s<a;s++)for(var u=0;u<l;u++){var c=s*l+u,d=this._images[c],g=document.getElementById("clip"+c);if(g&&!g.childNodes.length){var p=this.CreateThumbnailImage(d);g.appendChild(p)}}}},t.prototype.CreateThumbnailImage=function(e){var t,n=document.createElement("img");return Sys.UI.DomElement.addCssClass(n,"ClipartThumbImage"),n.setAttribute("src",e.get_thumbnailUrl()),t=e.get_displayName()?e.get_displayName():Box4Intl.Box4Strings.l_ClipartImageAltNoCaption,n.setAttribute("title",t),n.setAttribute("alt",t),wo.n.addHandler(n,"click",this._previewClipHandler),wo.n.addHandler(n,"error",this._thumbnailLoadErrorHandler),n},t.prototype.DeleteThumbnailImage=function(e){if(1===e.childNodes.length){var t=e.childNodes[0];wo.n.removeHandler(t,"click",this._previewClipHandler),wo.n.removeHandler(t,"error",this._thumbnailLoadErrorHandler)}},t.prototype.OnThumbnailLoadError=function(e){e.target.setAttribute("src",Wy.f.box4Image("phthumb.64x64x32.png"))},t.prototype.OnPreviewLoadError=function(e){e.target.setAttribute("src",Wy.f.box4Image("phpreview.96x96x32.png"))},t.prototype.PreviewClip=function(e){var t=this._images[e],n=t.get_previewUrl();t.get_clipUrl();this.CleanupPreview(),this._previewLoadErrorHandler=o.i(this,this.OnPreviewLoadError,"OnPreviewLoadError");var i,r=document.createElement("img");if(r.setAttribute("src",n),t.get_displayName())i=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,t.get_displayName());else{for(var a=new Sys.StringBuilder,l=0;l<t.get_keywords().length&&l<5;l++)l&&a.append(", "),a.append(t.get_keywords()[l]);i=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,a.toString())}r.setAttribute("title",i),r.setAttribute("alt",i),wo.n.addHandler(r,"error",this._previewLoadErrorHandler),this._divPreview.appendChild(r);var s=document.getElementById("clip"+this._iSelectedClip);Sys.UI.DomElement.removeCssClass(s,"ClipartSelectedImage"),s=document.getElementById("clip"+e),Sys.UI.DomElement.addCssClass(s,"ClipartSelectedImage"),this._iSelectedClip=e,t.get_displayName()&&(this._divDisplayName.innerText=t.get_displayName());var u=document.createElement("a");u.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink,u.setAttribute("href",'""'),wo.n.addHandler(u,"click",this._seeSimilarClickHandler),wo.n.addHandler(u,"keydown",this._seeSimilarKeyDownHandler),this._divSeeSimilar.appendChild(u),this._divDimensions.innerText=String.format("{0} | {1} | {2}",t.get_dimensions(),t.get_resolution(),t.get_fileSize());var c=t.get_additionalLink();c&&t.get_additionalCaption()?(this._divAdditional.parentNode.style.display="block",this._divAdditionalName.innerText=t.get_additionalCaption(),this._divAdditional.appendChild(c)):this._divAdditional.parentNode.style.display="none",this._divRating.appendChild(t.get_ratingSpan()),ji.s.clearElementHtml(this._divAttribution);var d=t.get_attributionLink();d&&(this._divAttribution.appendChild(d),"a"===d.nodeName.toLowerCase()&&(wo.n.addHandler(d,"click",this._hyperlinkClickHandler),wo.n.addHandler(d,"keydown",this._hyperlinkKeyDownHandler))),this._divKeywords.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(l=0;l<t.get_keywords().length;l++){var g=t.get_keywords()[l],p=document.createElement("a");if(p.innerText=g,p.setAttribute("href",'""'),wo.n.addHandler(p,"click",this._keywordClickHandler),wo.n.addHandler(p,"keydown",this._keywordKeyDownHandler),this._divKeywords.appendChild(p),l<t.get_keywords().length-1){var h=document.createElement("span");h.innerText=", ",this._divKeywords.appendChild(h)}}this._divRatingName.innerText=Box4Intl.Box4Strings.l_ClipartRating,this._divAttributionName.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy,this.setButtonState(1,!0)},t.prototype.CleanupPreview=function(){if(this._divPreview&&1===this._divPreview.childNodes.length&&(this._previewLoadErrorHandler&&(wo.n.removeHandler(this._divPreview.childNodes[0],"error",this._previewLoadErrorHandler),this._previewLoadErrorHandler=null),ji.s.clearElementHtml(this._divPreview)),this._divAttribution&&this._divAttribution.childNodes.length>0&&"a"===this._divAttribution.childNodes[0].nodeName.toLowerCase()&&(this._hyperlinkClickHandler&&wo.n.removeHandler(this._divAttribution.childNodes[0],"click",this._hyperlinkClickHandler),this._hyperlinkKeyDownHandler&&wo.n.removeHandler(this._divAttribution.childNodes[0],"keydown",this._hyperlinkKeyDownHandler)),this._divSeeSimilar&&this._divSeeSimilar.children.length>0&&"a"===this._divSeeSimilar.children[0].nodeName.toLowerCase()&&(this._seeSimilarClickHandler&&wo.n.removeHandler(this._divSeeSimilar.children[0],"click",this._seeSimilarClickHandler),this._seeSimilarKeyDownHandler&&wo.n.removeHandler(this._divSeeSimilar.children[0],"keydown",this._seeSimilarKeyDownHandler),ji.s.clearElementHtml(this._divSeeSimilar)),this._divKeywords){for(var e=0;e<this._divKeywords.childNodes.length;e++){var t=this._divKeywords.childNodes[e];"a"===t.nodeName.toLowerCase()&&(wo.n.removeHandler(t,"click",this._keywordClickHandler),wo.n.removeHandler(t,"keydown",this._keywordKeyDownHandler))}ji.s.clearElementHtml(this._divKeywords)}this._divDisplayName.innerText="",this._divDimensions.innerText="",ji.s.clearElementHtml(this._divAdditional),ji.s.clearElementHtml(this._divRating),ji.s.clearElementHtml(this._divAttribution),this._divKeywords.innerText="",this._divAdditionalName.innerText="",this._divRatingName.innerText="",this._divAttributionName.innerText=""},t.prototype.ForceRepeatSearch=function(e){this._prevQuery=null,this._prevSimilar?(this._iSelectedClip=0,this._iFocusedClip=0,this.OnSeeSimilarClick(e)):this.OnSearchButton(e)},t.prototype.OnHyperlinkClick=function(e){window.open(e.target.attributes.getNamedItem("href").value,e.target.attributes.getNamedItem("target").value),e.stopPropagation(),e.preventDefault()},t.prototype.OnHyperlinkKeyDown=function(e){(e?e.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.OnHyperlinkClick(e)},t.prototype.OnKeywordClick=function(e){var t=e.target.innerText;this._textInput&&(this._textInput.value=t),this.Search(t),e.stopPropagation(),e.preventDefault(),this.setButtonState(1,!1)},t.prototype.OnKeywordKeyDown=function(e){(e?e.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.OnKeywordClick(e)},t.prototype.OnSeeSimilarClick=function(e){this._images&&(this.SearchSimilar(this._images[this._iSelectedClip]),e.stopPropagation(),e.preventDefault(),this._textInput.value="",this.setButtonState(1,!1))},t.prototype.OnSeeSimilarKeyDown=function(e){(e?e.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.OnSeeSimilarClick(e)},t.prototype.OnKeyDown=function(e){if(e.keyCode>=Sys.UI.Key.left&&e.keyCode<=Sys.UI.Key.down){var t=0;switch(e.keyCode){case Sys.UI.Key.up:t=-5;break;case Sys.UI.Key.down:t=5;break;case Sys.UI.Key.left:t=-1;break;case Sys.UI.Key.right:t=1}this._iFocusedClip=this._iFocusedClip+t<this._searchResult.children.length-1?this._iFocusedClip+t<0?0:this._iFocusedClip+t:this._searchResult.children.length-1,this.SetFocusOnClip(this._iFocusedClip),e.preventDefault(),e.stopPropagation()}else if(e.keyCode===Sys.UI.Key.enter){var n=e.target.id,i=Number.parseInvariant(n.substr(4));i>=0&&i<this._searchResult.children.length&&this.SelectSearchResult(i)}else e.keyCode===Sys.UI.Key.tab&&(this._iFocusedClip=e.shiftKey?Math.max(0,this._iFocusedClip-1):Math.min(this._iFocusedClip+1,this._searchResult.children.length-1))},t.prototype.SelectSearchResult=function(e){if(!(this._searchResult.children.length<=e||e<0)){var t=this._searchResult.children[e],n=this._searchResult.children[0],i=n.clientHeight-n.children[0].clientHeight+2;this._searchResult.scrollTop+this._searchResult.clientHeight<t.offsetTop+t.clientHeight?this._searchResult.scrollTop=t.offsetTop-3*t.clientHeight-i:this._searchResult.scrollTop>t.offsetTop&&(this._searchResult.scrollTop=t.offsetTop-i/2),this.PreviewClip(e)}},t.prototype.validate=function(){return!0},t.prototype.OnError=function(e){this._searchResult&&(this._searchResult.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)},t.prototype.ProcessSearchResults=function(e){if(this._searchResult)if(e.get_data().responseXml){var t=e.get_data().responseXml.lastChild.childNodes;this._images||(this._images=[]);for(var n=0;n<t.length&&this._images.length<100;n++){var i=t[n];if(By.element===i.nodeType&&"image"===i.nodeName){var r=Vy.fromXML(i);Array.add(this._images,r)}}this.DisplaySearchResults(),this._images.length||(this._searchResult.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(e.get_data().responseData){var o=e.get_data().responseData,a=Rn.l.stripPreTag(o),l=void 0;try{l=parseInt(a)}catch(e){l=14}this._searchResult.innerText=26===l?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}},t.prototype.DisplaySearchResults=function(){if(this._images){ji.s.clearElementHtml(this._searchResult),this._progress&&(this._progress.dispose(),this._progress=null),this._searchResult.focus(),Sys.UI.DomElement.removeCssClass(this._searchResult,"ClipartSearchInProgress");for(var e=0;e<this._images.length;e++){var t=document.createElement("a");t.setAttribute("href","#"),t.id="itab"+e;var n=document.createElement("span");if(n.id="clip"+e,Sys.UI.DomElement.addCssClass(n,"ClipartImageContainer"),t.appendChild(n),this._searchResult.appendChild(t),e<parseInt(String(this._searchResult.clientHeight/n.clientHeight))*parseInt(String(this._searchResult.clientWidth/n.clientWidth))){var i=this.CreateThumbnailImage(this._images[e]);n.appendChild(i)}}this._prevSimilar&&(this.SelectSearchResult(this._iSelectedClip),this.SetFocusOnClip(this._iSelectedClip))}},t.prototype.CleanupSearchResults=function(){if(St.FocusManager.usable()){var e=St.FocusManager.instance().getRegion(this.get_fullDialogFocusId());e&&e.listing.trySetCurrentElement(this._textInput)}else this._textInput.focus();for(var t=0;t<this._searchResult.childNodes.length;t++){var n=this._searchResult.childNodes[t];1===n.childNodes.length&&this.DeleteThumbnailImage(n.childNodes[0])}ji.s.clearElementHtml(this._searchResult),this.CleanupPreview(),this.setButtonState(1,!1),this._progress=new Gy.k(Box4Intl.Box4Strings.l_ClipartSearching),this._progress.set_isSmall(!1),this._searchResult.appendChild(this._progress.get_element()),Sys.UI.DomElement.addCssClass(this._searchResult,"ClipartSearchInProgress")},t.prototype.InsertClipartDialogHandler=function(e,n){if(1===e&&this._images&&(2!==yi.App.get_mode()||t.get_ImageEditor().canInsertPictureInContext(this._clipartUploader.get_context()))){var i=this._images[this._iSelectedClip];i&&this._clipartUploader.StartUpload(i)}},t.prototype.SetFocusOnClip=function(e){this._iFocusedClip=e;var t=this._searchResult.children[this._iFocusedClip];St.FocusManager.usable()?St.FocusManager.instance().getRegion(this.get_fullDialogFocusId()).listing.trySetCurrentElement(t):t.focus()},t.get_ImageEditor=function(){return t._imageEditor=t._imageEditor||Ge.w.get_instance().resolve(Za.w)},t.Id="InsertClipartDialog",t.DebugLogCategory="insertclipart",t._imageEditor=null,t}(Bi.o);(0,o.l)($y,"ad8f5ac6$InsertClipartDialog",Bi.o,[]);var zy=n(7339),Ky=function(e){function t(t,n,i,r,o,a){return e.call(this,t,n,i,r,o,a)||this}return(0,v.t)(t,e),t.prototype.showDialog=function(){new $y(this)},t.prototype.StartUpload=function(e){this.insertPlaceholder()&&this._node.getParentGraphSpace().get_contentReplicator().forceOutbound(o.i(this,this.OnPlaceholderNodeSaved$3,"OnPlaceholderNodeSaved$3"),null,e)},t.prototype.OnPlaceholderNodeSaved$3=function(e){if(this.isPlaceholderValid()){var t=this._node.getParentGraphSpace(),n=t.get_contentReplicator().get_lastReplicated().toString(),i=e,r=new Sys.Net.WebRequest;r.set_url("ClipArtUpload.ashx");var a=new Sys.StringBuilder(r.getResolvedUrl());this.AddEscapedAttribute(a,gp.a.assetId,i.get_assetId(),!0),this.AddEscapedAttribute(a,dp.h.lcid,L.AFrameworkApplication.lcid.toString());var l=this._blob?this._blob.id.toString():this._node.get_id().toString();this.AddEscapedAttribute(a,dp.h.nodeId,l),this.AddEscapedAttribute(a,dp.h.cellId,t.get_objectSpaceId().toString()),this.AddEscapedAttribute(a,dp.h.fileId,t.get_fileQuerySignature()),this.AddEscapedAttribute(a,dp.h.baseRevisionId,n),this.AddEscapedAttribute(a,dp.h.desiredRevisionId,this._desiredRevisionId.toString());var s=ip.z.lockIdNil;Gl.n.get_instance().get_item(50)&&(s=this._node.getValueWithDefault(Number,ep.p.lockId,ip.z.lockIdNil)),this.AddEscapedAttribute(a,dp.h.lockId,s.toString()),Gl.n.get_instance().get_item(11)&&this.AddEscapedAttribute(a,dp.h.wordMode,"1"),t.get_encryptionSessionString()&&this.AddEscapedAttribute(a,dp.h.encryptionSessionString,t.get_encryptionSessionString());var u=this._blob?this._blob.properties.get_runtimeClassId().toString():this._node.get_runtimeClassId().toString();this.AddEscapedAttribute(a,dp.h.classId,u),this._propertySet.hasProperty(os.j.imageType)&&this.AddEscapedAttribute(a,gp.a.imageType,this._propertySet.getValue(Number,os.j.imageType).toString()),pp.n.get_instance().addToUrlStringBuilder(a),L.AFrameworkApplication.theClientRequestManager.addRequest(a.toString(),2,"",{},!1,2,o.i(this,this.UploadFinished,"UploadFinished"),o.i(this,this.UploadFailed,"UploadFailed"),null),Oy.e.numberOfImagesUploading++}},t.prototype.AddEscapedAttribute=function(e,t,n,i){e.append(i?"?":"&"),e.append(Rn.l.urlKeyValueEncode(t)),e.append("="),e.append(Rn.l.urlKeyValueEncode(n))},t.prototype.UploadFinished=function(e){var t,n=e.get_data().responseData;if(hp.j.tryDeserializeServerResponse(n,(0,g.m)((function(){return t}),(function(e){return t=e})))){var i=t.Responses[0];i.requestInvokedTime=e.get_data().invokedTime,i.correlation=e.get_data().responseHeaders?e.get_data().responseHeaders[Uy.h.correlationIdHeaderName]:"",this.uploadResponseReceived(i)}else this.UploadFailed(null)},t.prototype.UploadFailed=function(e){e&&e.get_data()&&e.get_data().responseData;var t=new zy.x;t.StatusCode=14,this.uploadResponseReceived(t)},t.prototype.errorMessageFromCode=function(t){switch(t){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return e.prototype.errorMessageFromCode.call(this,t)}},t.prototype.uploadResponseReceived=function(t){e.prototype.uploadResponseReceived.call(this,t),Oy.e.numberOfImagesUploading--},t.get_ImageEditor=function(){return t._imageEditor||(t._imageEditor=Ge.w.get_instance().resolve(Za.w))},t._imageEditor=null,t}(Oy.e);(0,o.l)(Ky,"bd20d5ad$ClipartUploader",Oy.e,[]);var qy=function(){function e(e,t,n){this._imageEditor=null,this._undoManager=null,this._actionManager=null,this._imageEditor=e,this._undoManager=t,this._actionManager=n}return e.prototype.registerActions=function(){this._actionManager.addActionWithFlags(Oi.u.insertClipartDialog,ol.d.view,o.i(this,this.InsertClipartDialogView,"InsertClipartDialogView"),260)},e.prototype.InsertClipartDialogView=function(e,t,n,i,r){var o=this._imageEditor.canInsertPictureInContext(t),a=r;return 2===n&&o?(new Ky(t,Ce.y.get_instance(),L.AFrameworkApplication.appSettingsManager,a,this._undoManager,this._actionManager),32):1===n?o&&yi.App.clipartInsertEnabled?32:8:2},e}();(0,o.l)(qy,"88458ef2$ClipArtActor",null,[]);var jy=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.ClipArt"},e.prototype.configure=function(e){this._container=e,e.register(qy).singleInstance().usingFactory((function(){return new qy(e.resolve(Za.w),e.resolve(wa.n),L.AFrameworkApplication.get_theActionManager())}))},e.prototype.init=function(){this._container.resolve(qy).registerActions();var e=yi.App.get_activeAppFrame();e&&e.updateCommandUI()},e.prototype.dispose=function(){},e}();(0,o.l)(jy,"a731c803$ClipartPackage",null,[s.u,u.s]);var Qy=function(){function e(){}return e.main=function(){B.o.get_instance().registerPackage(new jy)},e}();(0,o.l)(Qy,"de6e5abc$Program",null,[]);var Jy=(0,o.y)("cc8edbf8$IListMarker"),Xy=function(){function e(e,t){this._listMarker=null,this._font=null,this.$$pf_LevelInfo=null,this.$$pf_MultilevelDefInfo=null,this._listMarker=e,this._font=t}return e.prototype.get_previewContent=function(){return this.get_levelText()},e.prototype.get_levelInfo=function(){return this.$$pf_LevelInfo},e.prototype.set_levelInfo=function(e){return this.$$pf_LevelInfo=e,e},e.prototype.get_levelText=function(){return this._listMarker},e.prototype.get_listStyle=function(){return 6},e.prototype.get_justification=function(){return"left"},e.prototype.get_multilevelDefInfo=function(){return this.$$pf_MultilevelDefInfo},e.prototype.set_multilevelDefInfo=function(e){return this.$$pf_MultilevelDefInfo=e,e},e.prototype.get_font=function(){return this._font},e}();(0,o.l)(Xy,"ba533137$ListMarkerBullet",null,[Jy]);var Yy=(0,o.y)("502b82c1$IListMarkerGalleryLoader"),Zy=function(){function e(){this._listMarkersDictionary=null,this._listMarkersInDocumentDictionary=null,this._listMarkersDictionary=new nt.q(Object,o.i(this,this.createListMarkerDictionary,"createListMarkerDictionary")),this._listMarkersInDocumentDictionary={}}return e.prototype.get_listMarkersDictionary=function(){return this._listMarkersDictionary},e.prototype.get_listMarkersInDocumentDictionary=function(){return this._listMarkersInDocumentDictionary},e}();(0,o.l)(Zy,"26b124c9$AListMarkerGalleryLoader",null,[Yy]);var eC=n(8142),tC=function(e){function t(){var t=e.call(this)||this;return t.LevelInfo=null,t}return(0,v.t)(t,e),t.prototype.get_Type=function(){return 4},t}(Wu.f);(0,o.l)(tC,"622dc8af$ListGalleryButtonProps",Wu.f,[]);var nC=function(){function e(e,t,n,i){switch(this._listMarkerType=0,this._listMarkerIdPrefix=null,this._listReader=null,this._isSimplifiedRibbonEnabled=!1,this.BulletExternalGalleryId="BulletLibraryGallery",this.NumberingExternalGalleryId="NumberingLibraryGallery",this.MultilevelExternalGalleryId="MultilevelGallery",this.BulletsInDocumentGalleryExternalId="BulletDocumentGallery",this.NumberingInDocumentGalleryExternalId="NumberingDocumentGallery",this.listMarkersLoader=null,this._listMarkerType=e,this.listMarkersLoader=t,e){case 0:this._listMarkerIdPrefix="BulletStyle";break;case 1:this._listMarkerIdPrefix="NumberingStyle";break;case 2:this._listMarkerIdPrefix="MultilevelStyle";break;default:this._listMarkerIdPrefix="BulletStyle"}this._listReader=n,this._isSimplifiedRibbonEnabled=i}return e.prototype.get_listMarkersLoader=function(){return this.listMarkersLoader},e.prototype.getListMarkerGalleryDropDownXml=function(){var e=this.getListMarkerGalleryDropDownProps();return Yu.s.getXmlFromMenuProps(e)},e.prototype.getListMarkerGalleryDropDownProps=function(e){void 0===e&&(e=!1);var t=(0,U.m)(new $o.b,{Id:"menuListMarkersDropDown",MenuSectionList:[]});return Array.add(t.MenuSectionList,this.AddListMarkersPositionsGallery(e)),this.get_listMarkersLoader().updateListMarkersInDocumentDictionary(this._listReader),M_.p.getKeys(this.get_listMarkersLoader().get_listMarkersInDocumentDictionary()).length>0&&Array.add(t.MenuSectionList,this.AddListMarkersInDocumentGallery()),this._listMarkerType||Array.add(t.MenuSectionList,this.AddDefineNewBulletButton()),t},e.prototype.AddListMarkersPositionsGallery=function(t){var n,i,r=1,o="";switch(this._listMarkerType){case 0:n=Box4Intl.Box4Strings.L_BulletsLibraryTitle,i="BulletsLibrary",o="BulletsLibrary";break;case 1:n=Box4Intl.Box4Strings.L_NumberingLibraryTitle,i="NumberingLibrary",r=4,o="NumberingLibrary";break;case 2:n=Box4Intl.Box4Strings.L_ListLibraryTitle,i="MultilevelLibrary",r=4,o="Multilevel";break;default:n=Box4Intl.Box4Strings.L_BulletsLibraryTitle,i="BulletsLibrary",o="BulletsLibrary"}for(var a=(0,U.m)(new zo.x,{Id:String.format("msListMarkersPosition{0}",i),Title:n,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),l=this._listMarkerType?"Size48by48":"Size40by40",s=(0,U.m)(new Fu.b,{Id:String.format("galleryListMarkersPosition{0}",i),ExternalId:o,ExternalGalleryId:this.GetGalleryExternalId(this._listMarkerType),Type:r,Width:e.NoOfPositionPerRow,ElementDimensions:l,GalleryItems:new Array(0)}),u=this.get_listMarkersLoader().get_listMarkersDictionary().get_value(),c=M_.p.getKeys(u),d=Math.min(e.NoOfListMarkersInDropdown,c.length),g=0;g<d;g++){var p=u[c[g]];this._isSimplifiedRibbonEnabled&&t&&(!(1!==this._listMarkerType&&2!==this._listMarkerType||p.get_levelInfo())||!this._listMarkerType&&p.get_levelText()===Box4Intl.Box4Strings.L_ListStyleNone)||s.GalleryItems.push(this.GetGalleryButtonPropsForListMarker(this._listMarkerIdPrefix+i+"_"+g,p,this._listMarkerType))}return Array.add(a.ControlList,s),a},e.prototype.GetGalleryExternalId=function(e){switch(e){case 0:return this.BulletExternalGalleryId;case 1:return this.NumberingExternalGalleryId;case 2:return this.MultilevelExternalGalleryId;default:return this.BulletExternalGalleryId}},e.prototype.GetInDocumentGalleryExternalId=function(e){switch(e){case 0:return this.BulletsInDocumentGalleryExternalId;case 1:return this.NumberingInDocumentGalleryExternalId;default:return this.BulletsInDocumentGalleryExternalId}},e.prototype.AddListMarkersInDocumentGallery=function(){var t,n,i=1,r="";switch(this._listMarkerType){case 0:n=Box4Intl.Box4Strings.L_BulletsInDocumentTitle,t="DocumentBullets",r="BulletsInDocument";break;case 1:n=Box4Intl.Box4Strings.L_NumberingInDocumentTitle,t="DocumentNumbering",i=4,r="NumberingInDocument";break;case 2:n=Box4Intl.Box4Strings.L_MultilevelInDocumentTitle,t="DocumentMultilevelList",i=4;break;default:n=Box4Intl.Box4Strings.L_BulletsLibraryTitle,t="DocumentBullets",r="BulletsInDocument"}for(var o=(0,U.m)(new zo.x,{Id:String.format("msListMarkersPosition{0}",t),Title:n,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),a=this._listMarkerType?"Size48by48":"Size40by40",l=(0,U.m)(new Fu.b,{Id:String.format("galleryListMarkersInDocument{0}",t),ExternalId:r,ExternalGalleryId:this.GetInDocumentGalleryExternalId(this._listMarkerType),Type:i,Width:e.NoOfPositionPerRow,ElementDimensions:a,GalleryItems:new Array(0)}),s=M_.p.getKeys(this.get_listMarkersLoader().get_listMarkersInDocumentDictionary()),u=Math.min(e.NoOfListMarkersInDropdown,s.length),c=M_.p.getKeys(this.get_listMarkersLoader().get_listMarkersDictionary().get_value()).length,d=0;d<u;d++){var g=s[d];l.GalleryItems.push(this.GetGalleryButtonPropsForListMarker(this._listMarkerIdPrefix+t+"_"+(d+c),this.get_listMarkersLoader().get_listMarkersInDocumentDictionary()[g],this._listMarkerType))}return Array.add(o.ControlList,l),o},e.prototype.AddDefineNewBulletButton=function(){var e=this._listMarkerType?Box4Intl.Box4Strings.L_NumberingInDocumentTitle:Box4Intl.Box4Strings.L_BulletsInDocumentTitle,t=(0,U.m)(new zo.x,{Id:String.format("msListMarkersPosition{0}","DefineNewBullet"),Title:e,ControlsId:"ctrlMoreCommandsBullets",DisplayMode:"Menu16",ControlList:[]}),n=(0,U.m)(new Ko.k,{Command:"1851657168",LabelText:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_DefineNewBullet),Id:"DefineNewBullet",Alt:Rn.l.xmlEncode(Box4Intl.Box4Strings.L_DefineNewBullet)});return Array.add(t.ControlList,n),t},e.prototype.GetFontStyle=function(e){var t={},n=yc.v.convertFontNameToCSSValue(e.get_font());return t.fontFamily=yc.v.addWebFontsToFallback(n,e.get_font(),!0,!1,!1),t},e.prototype.GetGalleryButtonPropsForListMarker=function(t,n,i){var r,o,a="",l=!1;if(!i&&n.get_levelText()!==Box4Intl.Box4Strings.L_ListStyleNone){var s=Rn.l.convertToHex(n.get_levelText().charCodeAt(0),4);s=e.isAsciiFont(n.get_font())&&!s.indexOf("f")?" 0x0"+s.substr(1):" 0x"+s,a=n.get_font()+s,l=!0}var u=null;switch(i){case 0:r=Oi.u.toggleBulletsList,o=Oi.u.queryListMarkerBullets,u=(0,U.m)(new eC.n,{Character:n.get_levelText(),Style:this.GetFontStyle(n)});break;case 1:r=Oi.u.toggleNumberedList,o=Oi.u.queryListMarkerNumbering,u=(0,U.m)(new tC,{LevelInfo:n.get_levelInfo()});break;case 2:r=Oi.u.multilevelList,o=Oi.u.queryListMarkerMultilevel,u=(0,U.m)(new tC,{LevelInfo:n.get_levelInfo()}),n.get_multilevelDefInfo()&&(a=n.get_multilevelDefInfo().description,l=!0);break;default:r=Oi.u.toggleBulletsList,o=Oi.u.queryListMarkerBullets,u=(0,U.m)(new eC.n,{Character:n.get_levelText(),Style:this.GetFontStyle(n)})}return u.Id=t,u.Command=r.toString(),u.QueryCommand=o.toString(),u.Alt=a,u.InnerHTML=Rn.l.xmlEncode(this.ListMarkerGalleryButtonInnerHtml(n)),u.ShouldSetTitle=l.toString(),u},e.prototype.ListMarkerGalleryButtonInnerHtml=function(e){return String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',this.GetListMarkerPreviewCssString(e),this.GetListMarkerContentString(e))},e.prototype.GetListMarkerPreviewCssString=function(t){var n=new Sys.StringBuilder;if(n.append("position: relative; "),t.get_previewContent()===Box4Intl.Box4Strings.L_ListStyleNone&&t.get_font()===e.InvalidFontName)n.append("font-size: 12pt; "),n.append("top: 22%;");else{n.append("font-family: ");var i=yc.v.convertFontNameToCSSValue(t.get_font());n.append(yc.v.addWebFontsToFallback(i,t.get_font(),!0,!1,!1)),n.append("; "),n.append("font-size: 24pt;")}return n.toString()},e.prototype.GetListMarkerContentString=function(e){return e.get_previewContent()},e.generalizeLevelText=function(e){var t=new RegExp("%[1-9]");return e.replace(t,"%1")},e.isAsciiFont=function(t){for(var n=0;n<e.asciiFonts.length;n++)if(t===e.asciiFonts[n])return!0;return!1},e.NoOfPositionPerRow=6,e.NoOfListMarkersInDropdown=18,e.InvalidFontName="EXYdHRyjlYTe8nDSGfyW",e.asciiFonts=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"],e}();(0,o.l)(nC,"1610f859$ListMarkerGalleryUtility",null,[]);var iC=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.createListMarkerDictionary=function(){var e={};return e[0]=new Xy(Box4Intl.Box4Strings.L_ListStyleNone,nC.InvalidFontName),e[1]=new Xy(String.fromCharCode(61623),"Symbol"),e[2]=new Xy(String.fromCharCode(111),"Courier New"),e[3]=new Xy(String.fromCharCode(61607),"Wingdings"),e[4]=new Xy(String.fromCharCode(9643),"Courier New"),e[5]=new Xy(String.fromCharCode(61611),"Wingdings"),e[6]=new Xy(String.fromCharCode(61614),"Symbol"),e[7]=new Xy(String.fromCharCode(61483),"Symbol"),e[8]=new Xy(String.fromCharCode(61485),"Symbol"),e[9]=new Xy(String.fromCharCode(9830),"Courier New"),e[10]=new Xy(String.fromCharCode(61664),"Symbol"),e[11]=new Xy(String.fromCharCode(61558),"Wingdings"),e[12]=new Xy(String.fromCharCode(61656),"Wingdings"),e[13]=new Xy(String.fromCharCode(61514),"Wingdings"),e[14]=new Xy(String.fromCharCode(61516),"Wingdings"),e[15]=new Xy(String.fromCharCode(61692),"Wingdings"),e[16]=new Xy(String.fromCharCode(61691),"Wingdings"),e[17]=new Xy(String.fromCharCode(61553),"Wingdings"),e},t.prototype.updateListMarkersInDocumentDictionary=function(e){var t=Si.InteractiveViewManager.get_instance().get_editingView().get_targetNode();if(!t)return this.get_listMarkersInDocumentDictionary();var n=t.get_containingObjectSpace();if(!n)return this.get_listMarkersInDocumentDictionary();var i=e.get_listDefinitions();if(!i)return this.get_listMarkersInDocumentDictionary();for(var r=null,o=null,a=null,l=!1,s=0;s<i.length;s++)if(l=!1,r=n.getObject(i[s]),(o=e_.j.createFromExistingPropertySet(r,null))&&!o.get_isOrdered()&&o.get_hasLevelText()&&o.get_hasFont()){for(var u=M_.p.getKeys(this.get_listMarkersInDocumentDictionary()),c=u.length,d=void 0,g=0;g<c;g++)if(d=u[g],(a=this.get_listMarkersInDocumentDictionary()[d]).get_levelText()===o.get_levelText()&&a.get_font()===o.get_font()){l=!0;break}if(!l){var p=c+M_.p.getKeys(this.get_listMarkersDictionary().get_value()).length+"";this.get_listMarkersInDocumentDictionary()[p]=new Xy(o.get_levelText(),o.get_font())}}return this.get_listMarkersInDocumentDictionary()},t}(Zy);(0,o.l)(iC,"273d96e6$ListMarkerBulletLoader",Zy,[]);var rC=function(){return function(){this.textAtLevel=null,this.styleAtLevel=null}}();(0,o.l)(rC,"bc0d985e$InfoAtLevel",null,[]);var oC=function(){function e(e){this._multilevelDefInfo=null,this._multilevelDefInfo=e}return e.prototype.get_font=function(){return"Calibri"},e.prototype.get_listStyle=function(){return 42},e.prototype.get_justification=function(){return"left"},e.prototype.get_multilevelDefInfo=function(){return this._multilevelDefInfo},e.prototype.get_previewContent=function(){return this._multilevelDefInfo?this.PreviewMultiLevelButton(3):this.PreviewMultilevelNoneButton()},e.prototype.get_levelInfo=function(){return this._multilevelDefInfo?this.PreviewMultiLevelButtonWithoutCSS(3):null},e.prototype.get_levelText=function(){return""},e.prototype.GetFirstNumberForStyle=function(e){switch(e){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}},e.prototype.PreviewMultiLevelButton=function(t){for(var n="",i=0;i<t;i++)n+=this.GetPreviewLine(i);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',e.GetCssString(),n)},e.prototype.PreviewMultiLevelButtonWithoutCSS=function(e){for(var t=new Array(0),n=0;n<e;n++)t.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewLineWithoutCSS(n),styleAtLevel:this.GetStyleForLevel(n)}));return t},e.prototype.PreviewMultilevelNoneButton=function(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',e.GetCssStringForNone(),Box4Intl.Box4Strings.L_ListStyleNone)},e.prototype.GetPreviewLineWithoutCSS=function(e){for(var t=this._multilevelDefInfo.levelTextArray[e],n=0;n<9;n++){var i=this._multilevelDefInfo.listStyleArray[n];t=Rn.l.replaceAll(t,"%"+(n+1),this.GetFirstNumberForStyle(i))}return t},e.prototype.GetStyleForLevel=function(e){var t={},n=this._multilevelDefInfo.listStyleArray[e];return t.fontFamily=6===n?this._multilevelDefInfo.fontArray[e]:this.get_font(),t},e.prototype.GetPreviewLine=function(e){var t=this.GetPreviewLineWithoutCSS(e),n=new Sys.StringBuilder;6===this._multilevelDefInfo.listStyleArray[e]&&n.append(String.format("font-family:{0};",this._multilevelDefInfo.fontArray[e]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',e,n.toString(),t)},e.GetCssString=function(){var e=new Sys.StringBuilder;return e.append("padding-left: 2pt; "),e.append("font-size: 9pt; "),e},e.GetCssStringForNone=function(){var e=new Sys.StringBuilder;return e.append("text-align: center; "),e.append("margin-top: 22%; "),e.append("font-size: 12pt; "),e},e}();(0,o.l)(oC,"d2e70aae$ListMarkerMultilevel",null,[Jy]);var aC=function(){return function(e,t,n,i,r){this.levelTextArray=null,this.listStyleArray=null,this.justificationArray=null,this.fontArray=null,this.description=null,this.levelTextArray=e,this.listStyleArray=t,this.justificationArray=i,this.fontArray=n,this.description=r}}();(0,o.l)(aC,"db9cf514$MultilevelDefInfo",null,[]);var lC=function(){function e(){}return e.prototype.createDefaultMultilevel=function(e){for(var t="",n=new Array(9),i=new Array(9),r=new Array(9),o=new Array(9),a=0;a<9;a++)t+="%"+(a+1)+".",n[a]=t,i[a]=1,r[a]="left";return new aC(n,i,o,r,e)},e.prototype.createNumbers=function(e,t,n){for(var i=new Array(9),r=new Array(9),o=0;o<9;o++)i[o]=o%3==2?"right":"left";return new aC(e,t,r,i,n)},e.prototype.createBullets=function(e,t,n){for(var i=new Array(9),r=new Array(9),o=new Array(9),a=0;a<9;a++)o[a]=String.fromCharCode(e[a]),i[a]=6,r[a]="left";return new aC(o,i,t,r,n)},e}();(0,o.l)(lC,"9bc931ba$MultilevelDefInfoAdaptor",null,[]);var sC=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.createListMarkerDictionary=function(){var e=new lC,t={};return t[0]=new oC(null),t[1]=new oC(e.createDefaultMultilevel(Box4Intl.Box4Strings.L_MultilevelListLabelNumericalStyle)),t[2]=new oC(e.createNumbers(["%1)","%2)","%3)","(%4)","(%5)","(%6)","%7.","%8.","%9."],[1,2,3,1,2,3,1,2,3],Box4Intl.Box4Strings.L_MultilevelListLabelAlphanumericalStyle)),t[3]=new oC(e.createBullets([61558,61656,61607,61623,9830,61656,61607,61623,9830],["Wingdings","Wingdings","Wingdings","Symbol","Courier New","Wingdings","Wingdings","Symbol","Courier New"],Box4Intl.Box4Strings.L_MultilevelListLabelBulletedStyle)),t},t.prototype.updateListMarkersInDocumentDictionary=function(e){return this.get_listMarkersInDocumentDictionary()},t}(Zy);(0,o.l)(sC,"d963ebff$ListMarkerMultilevelLoader",Zy,[]);var uC=function(){function e(e,t){this._levelText=null,this._listStyle=0,this.$$pf_MultilevelDefInfo=null,this._levelText=e,this._listStyle=t}return e.prototype.get_font=function(){return"Calibri"},e.prototype.get_listStyle=function(){return this._listStyle},e.prototype.get_justification=function(){switch(this._listStyle){case 3:case 5:return"right";default:return"left"}},e.prototype.get_multilevelDefInfo=function(){return this.$$pf_MultilevelDefInfo},e.prototype.set_multilevelDefInfo=function(e){return this.$$pf_MultilevelDefInfo=e,e},e.prototype.get_previewContent=function(){switch(this._listStyle){case 1:return this.PreviewNumberingButton("1","2","3");case 2:return this.PreviewNumberingButton("a","b","c");case 3:return this.PreviewNumberingButton("i","ii","iii");case 4:return this.PreviewNumberingButton("A","B","C");case 5:return this.PreviewNumberingButton("I","II","III");case 0:return this.PreviewNumberingNoneButton();default:return this.PreviewNumberingButton("1","2","3")}},e.prototype.get_levelInfo=function(){var e=new Array(0),t={};switch(t.fontFamily=yc.v.convertFontNameToCSSValue(this.get_font()),this._listStyle){case 1:return e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("1"),styleAtLevel:t})),e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("2"),styleAtLevel:t})),e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("3"),styleAtLevel:t})),e;case 2:return e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("a"),styleAtLevel:t})),e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("b"),styleAtLevel:t})),e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("c"),styleAtLevel:t})),e;case 3:return e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("i"),styleAtLevel:t})),e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("ii"),styleAtLevel:t})),e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("iii"),styleAtLevel:t})),e;case 4:return e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("A"),styleAtLevel:t})),e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("B"),styleAtLevel:t})),e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("C"),styleAtLevel:t})),e;case 5:return e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("I"),styleAtLevel:t})),e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("II"),styleAtLevel:t})),e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("III"),styleAtLevel:t})),e;case 0:return null;default:return e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("1"),styleAtLevel:t})),e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("2"),styleAtLevel:t})),e.push((0,U.m)(new rC,{textAtLevel:this.GetPreviewListCharacter("3"),styleAtLevel:t})),e}},e.prototype.get_levelText=function(){return this._levelText},e.prototype.PreviewNumberingButton=function(t,n,i){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',e.GetCssString(),this.GetPreviewLine(t),this.GetPreviewLine(n),this.GetPreviewLine(i))},e.prototype.PreviewNumberingNoneButton=function(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',e.GetCssStringForNone(),Box4Intl.Box4Strings.L_ListStyleNone)},e.prototype.GetPreviewLine=function(e){var t=this.GetPreviewListCharacter(e);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',t)},e.prototype.GetPreviewListCharacter=function(e){return Rn.l.replaceAll(this._levelText,"%1",e)},e.GetCssString=function(){var e=new Sys.StringBuilder;return e.append("padding-left: 2pt; "),e.append("font-size: 9pt; "),e},e.GetCssStringForNone=function(){var e=new Sys.StringBuilder;return e.append("text-align: center; "),e.append("margin-top: 22%; "),e.append("font-size: 12pt; "),e},e}();(0,o.l)(uC,"de83bed2$ListMarkerNumbering",null,[Jy]);var cC=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.IsSimpleNumberingLevelText=function(e){var t=new RegExp("%[1-9]","g"),n=e.match(t);return!!n&&1===n.length},t.prototype.createListMarkerDictionary=function(){var e={};return e[0]=new uC(Box4Intl.Box4Strings.L_ListStyleNone,0),e[1]=new uC("%1.",5),e[2]=new uC("%1.",4),e[3]=new uC("%1.",1),e[4]=new uC("%1.",2),e[5]=new uC("%1.",3),e[6]=new uC("%1)",5),e[7]=new uC("%1)",4),e[8]=new uC("%1)",1),e[9]=new uC("%1)",2),e[10]=new uC("%1)",3),e[11]=new uC("(%1)",5),e[12]=new uC("(%1)",4),e[13]=new uC("(%1)",1),e[14]=new uC("(%1)",2),e[15]=new uC("(%1)",3),e},t.prototype.updateListMarkersInDocumentDictionary=function(e){var t=Si.InteractiveViewManager.get_instance().get_editingView().get_targetNode();if(!t)return this.get_listMarkersInDocumentDictionary();var n=t.get_containingObjectSpace();if(!n)return this.get_listMarkersInDocumentDictionary();var i=e.get_listDefinitions();if(!i)return this.get_listMarkersInDocumentDictionary();for(var r=null,o=null,a=null,l=!1,s=0;s<i.length;s++)if(l=!1,r=n.getObject(i[s]),(o=e_.j.createFromExistingPropertySet(r,null))&&o.get_isOrdered()&&o.get_hasLevelText()&&this.IsSimpleNumberingLevelText(o.get_levelText())&&o.get_listStyle()){for(var u=M_.p.getKeys(this.get_listMarkersInDocumentDictionary()),c=u.length,d=void 0,g=nC.generalizeLevelText(o.get_levelText()),p=0;p<c;p++)if(d=u[p],a=this.get_listMarkersInDocumentDictionary()[d],nC.generalizeLevelText(a.get_levelText())===g&&a.get_listStyle()===o.get_listStyle()){l=!0;break}if(!l&&g){var h=c+M_.p.getKeys(this.get_listMarkersDictionary().get_value()).length+"";this.get_listMarkersInDocumentDictionary()[h]=new uC(g,o.get_listStyle())}}return this.get_listMarkersInDocumentDictionary()},t}(Zy);(0,o.l)(cC,"c632b463$ListMarkerNumberingLoader",Zy,[]);var dC=function(){function e(){}return e.get_ListEditor=function(){return e._listEditor||(e._listEditor=Ge.w.get_instance().resolve(jl.v))},e.get_ListReader=function(){return e._listReader||(e._listReader=Ge.w.get_instance().resolve(Ql.c))},e.get_InsertionPointFormatting=function(){return e._insertionPointFormatting||(e._insertionPointFormatting=Ge.w.get_instance().resolve(Fg.c))},e.get_ExternalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=Ge.w.get_instance().resolveFuture(kg.i))},e.get_ContextSetEditor=function(){return am.ContextSetEditor.get_instance()},e.get_LockedRangeEditor=function(){return za.k.get_instance()},e.get_ActivityManager=function(){return xr.y.get_instance()},e.get_listSettings=function(){return e._listSettings||(e._listSettings=Ge.w.get_instance().tryResolve(t_.r))},e.get_SingleLevelListEditor=function(){return e._singleLevelListEditor||(e._singleLevelListEditor=Ge.w.get_instance().tryResolve(Qh))},e.RegisterActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(Oi.u.toggleBulletsList,ol.d.view,e.ApplyBulletsNumberingView),t.addAction(Oi.u.toggleBulletsList,ol.d.outlineElement,e.ApplyBulletsNumbering),t.setActionFlags(Oi.u.toggleBulletsList,12),t.addAction(Oi.u.toggleNumberedList,ol.d.view,e.ApplyBulletsNumberingView),t.addAction(Oi.u.toggleNumberedList,ol.d.outlineElement,e.ApplyBulletsNumbering),t.setActionFlags(Oi.u.toggleNumberedList,12),e.get_ListReader().get_listSymbolsImprovementsEnabled()&&(t.addAction(Oi.u.multilevelList,ol.d.view,e.ApplyBulletsNumberingView),t.addAction(Oi.u.multilevelList,ol.d.outlineElement,e.ApplyBulletsNumbering),t.setActionFlags(Oi.u.multilevelList,12)),t.addAction(Oi.u.applyList,ol.d.view,Le.ActionManager.doNothingButReportHandler),t.addAction(Oi.u.clearList,ol.d.view,Le.ActionManager.doNothingButReportHandler),t.addAction(Oi.u.joinList,ol.d.view,Le.ActionManager.doNothingButReportHandler),t.addAction(Oi.u.applyBulletsList,ol.d.view,Le.ActionManager.doNothingButReportHandler),t.addAction(Oi.u.applyNumberingList,ol.d.view,Le.ActionManager.doNothingButReportHandler),t.addAction(Oi.u.switchListStyleByIP,ol.d.view,Le.ActionManager.doNothingButReportHandler),t.addAction(Oi.u.switchListStyleByRange,ol.d.view,Le.ActionManager.doNothingButReportHandler),t.addAction(Oi.u.unList,ol.d.view,Le.ActionManager.doNothingButReportHandler)},e.ApplyBulletsNumberingView=function(t,n,i,r,o){if(!n.view.get_isInteractiveView())return 2;var a=e.get_ActivityManager().startActivity(Oi.u.applyBulletsNumberingView);r.dataValue1=42,r.dataValue2=42;var l={};l[sm.viewActionPerfMarkStart]=5796,l[sm.viewActionPerfMarkEnd]=5797;var s=n.view;if(Gl.n.get_instance().get_item(11)){if(e.get_ContextSetEditor().contextContentsCheck(e.ImageCheck,s.get_selectionManager().get_selectionContextForActionDispatch()))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsImage}),a.end(),8;if(e.get_ContextSetEditor().contextContentsCheck(e.AnchoredImageCheck,s.get_selectionManager().get_selectionContextForActionDispatch()))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsAnchoredImage}),a.end(),8}if(Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().isContextSetInLockedParagraphs(s.get_selectionManager().get_selectionContextForActionDispatch()))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsLockedRange}),a.end(),8;if(e.get_ExternalSelectionManagerFuture()&&e.get_ExternalSelectionManagerFuture().get_instance()&&e.get_ExternalSelectionManagerFuture().get_instance().isExternalSelectionContext(n))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.externalSelection}),a.end(),8;if(1===i)return a.end(),32;o||(o=new Dl.DictionaryPropertySet);var u=null,c=2;if(2===i){(u=new Ma.GraphTransaction(15)).setFromNode(n.view.get_targetNode()),e.isSwitchStyleByRangeSelect=!1;var d=s.get_selectionManager(),g=Y_.generalizeSelectionToOEs(d.get_selectionCollection(),!1);if(!g)return u.dispose(),e.get_ActivityManager().recordEvent(ah.f.failedProcessingStep,{Reason:lh.i.failedToGeneralizeToOEs}),a.end(),8;L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),g.get_length()>1&&o.setValue(Pl.k.multipleOeSelection,null);var p=o.getValueWithDefault(Number,Pl.k.listStyleId,-1),h=o.getValueWithDefault(Number,Pl.k.listSoftType,-1);if(e.get_listSettings().isSingleLevelListImprovementEnabled&&e.get_SingleLevelListEditor()&&e.get_SingleLevelListEditor().checkTargetSetForSingleLevelListAndInflateIfNeeded(g),e.get_ListReader().get_switchListByRangeSelectionImprovementIsEnabled()){var _=e.ShouldClearList(p,h,g);_&&(o.setValue(Pl.k.listSoftType,16),o.setValue(Pl.k.listSoftStyle,0));var m=s.get_selectionManager().get_selectionContextForActionDispatch();if(!ga.SelectionEditor.isInsertionPointContext(m)&&!_&&t!==Oi.u.multilevelList&&g.get_length()>0&&p){for(var f=new ha.g,y=new Array(g.get_length()),C=0;C<g.get_length();C++)f.set(g.getContext(C).get_node()),y[C]=e.get_ListReader().getListInfo(f);if(e.shouldCleanListBeforeApplyNewListStlye(y,o)){var b=new Dl.DictionaryPropertySet;b.setValue(Pl.k.listSoftType,16),b.setValue(Pl.k.listSoftStyle,0),c=sm.performGenericViewLevelAction(t,n,i,r,b,l,11),L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.switchListStyleByRange,2),S.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),e.isSwitchStyleByRangeSelect=!0}}}var v=new ha.g;v.set(g.getContext(0).get_node());var T=e.get_ListReader().getListInfo(v);e.LogListActionsTelemetry(p,h,T,g.get_length())}return Gl.n.get_instance().get_item(63)||Gl.n.get_instance().get_item(77)?c=sm.performGenericViewLevelAction(t,n,i,r,o,l,11):Gl.n.get_instance().get_item(30)&&(c=sm.performGenericViewLevelActionAgainstOEs(t,n,i,r,o,l)),32===c&&o.getValueWithDefault(Boolean,Pl.k.autoDemoteLists,!1)&&(Gl.n.get_instance().get_item(62)?c=sm.performGenericViewLevelAction(Oi.u.demoteIndent,n,i,r,o,l,11):Gl.n.get_instance().get_item(29)?c=sm.performGenericViewLevelActionAgainstOEs(Oi.u.demoteIndent,n,i,r,o,l):Gl.n.get_instance().get_item(76)),u&&u.dispose(),a.end(),c},e.shouldCleanListBeforeApplyNewListStlye=function(e,t){for(var n=null,i=!1,r=e.length-1;r>=0;r--){if(n){var o=e[r];i=-1!==t.getValueWithDefault(Number,Pl.k.listStyleId,-3)?!o||(n.get_listType()!==o.get_listType()||n.get_listStyle()!==o.get_listStyle()):!o||n.get_listType()!==o.get_listType()}else n=e[r];if(i)break}if(n){var a=!1;if(!i){var l=t.getValueWithDefault(Number,Pl.k.listSoftType,42),s=t.getValueWithDefault(Number,Pl.k.listStyleId,-3);a=l!==n.get_listType()||s>0}if(i||a)return!0}return!1},e.LogListActionsTelemetry=function(t,n,i,r){if(!(r<=0||e.isSwitchStyleByRangeSelect)){if(!t)return L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.unList,2),void S.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style");if(!i)return L.AFrameworkApplication.get_theActionManager().processAction(n?Oi.u.applyBulletsList:Oi.u.applyNumberingList,2),void S.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",n?"Bullet":"Numbering");var o=i.get_listType();return-1===t&&n===o?(L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.unList,2),void S.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):t>0&&(!n||1===n)?(L.AFrameworkApplication.get_theActionManager().processAction(n?Oi.u.applyBulletsList:Oi.u.applyNumberingList,2),void S.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",n?"Bullet":"Numbering")):void 0}},e.ShouldClearList=function(t,n,i){if(-1!==t&&t||!i.get_length())return!1;for(var r=new ha.g,o=null,a=i.get_length()-1;a>=0&&(r.set(i.getContext(a).get_node()),!(o=e.get_ListReader().getListInfo(r)));a--);return!(!o||n!==o.get_listType())},e.ApplyBulletsNumbering=function(t,n,i,r,o){if(n.get_contextId()!==ol.d.outlineElement)return 2;var a=n;if(Gl.n.get_instance().get_item(14)){var l=a.clone().specialize();if(e.get_LockedRangeEditor().isParaStartOrEndInLockedRange(l))return e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),2}var s=new ha.g;if(s.set(a.get_node()),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(s),!Ss.OutlineElementReader.isOutlineElement(s))return 2;if(1===i)switch(t){case Oi.u.toggleBulletsList:case Oi.u.toggleNumberedList:case Oi.u.multilevelList:return 32;default:return 2}var u,c=e.get_ListReader().getListInfo(s),d=o;if(!d)return 8;gs.ListReader.get_isListMarkerEnabled()||t===Oi.u.toggleNumberedList&&s.goToPreviousSibling()&&(s.hasChildrenOfRole(4)||d.setValue(Pl.k.listLastStartAt,1),s.goToNextSibling());if(e.get_ListReader().get_listSymbolsImprovementsEnabled()?(t===Oi.u.toggleNumberedList||t===Oi.u.toggleBulletsList?(d=e.get_ListEditor().ensureValidPropertySetFromAction(t,d),u=e_.j.createFromScratch(d.getValue(Number,Pl.k.listSoftType),d.getValue(Number,Pl.k.listSoftStyle))):u=t===Oi.u.multilevelList?e_.j.createFromScratch(0,1):null,e.LogUsageData(t,d),e.setListPropertiesForListInfo(u,d)):(d=e.get_ListEditor().ensureValidPropertySetFromAction(t,d),u=e_.j.createFromScratch(d.getValue(Number,Pl.k.listSoftType),d.getValue(Number,Pl.k.listSoftStyle))),gs.ListReader.get_isListMarkerEnabled()||u.set_restartAt(d.getValueWithDefault(Number,is.b.listRestart,Zh.z.startAtNone)),e.SetPropertyValuesFromIp(d,s),!e.get_ListEditor().applyBulletsNumbering(d,s,(0,g.m)((function(){return u}),(function(e){return u=e})),!1))return e.get_ActivityManager().recordEvent(ah.f.noApply,{Reason:lh.i.listNotApplied}),2;if(2===i){L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings");var p=o.getValueWithDefault(Number,Pl.k.listSoftType,-1);if(u&&-1!==p){var h=o.getValueWithDefault(String,os.j.listMultiLevelType,"Invalid MultiLevel Type");c?u.get_listType()&&1!==u.get_listType()||e.isSwitchStyleByRangeSelect||(L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.switchListStyleByIP,2),S.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",p?"Bullet":"Numbering",h)):16===u.get_listType()?(L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.clearList,2),S.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",p?"Bullet":"Numbering",h)):u.get_listType()&&1!==u.get_listType()||e.isSwitchStyleByRangeSelect||(L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.applyList,2),S.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",p?"Bullet":"Numbering",h))}var _=St.FocusManager.instance();_.get_currentScope().name===Yc.u.ribbonFocusId&&_.scopeChanged(Pe.AFrame.documentFocusID)}return r.dataValue1=u.get_listType(),r.dataValue2=u.get_listStyle(),32},e.SetPropertyValuesFromIp=function(t,n){var i=new ha.g;i.setFrom(n);var r=i.goToFirstChildByRole(2);if(r&&Ga.ParagraphReader.isParagraphNode(r)){var o=fa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection();if(!o||!o.get_firstContext())return;var a=r;if(o.get_firstContext().get_node()!==a)return;ga.SelectionEditor.isSelectionIpAtParagraphEnd(o)&&(e.SetFontSizeFromIp(t),e.SetFontColorFromIp(t))}},e.setListPropertiesForListInfo=function(t,n){if(n.hasProperty(os.j.listMultiLevelType)&&t.setListMultiLevelType(n.getValue(String,os.j.listMultiLevelType)),t.set_listStyleId(n.getValueWithDefault(Number,Pl.k.listStyleId,-1)),t.get_isStyleSelected()){var i=e.GetListMarker(t,n);e.SetPropertiesFromListMarker(t,i)}else e.SetDefaultProperties(t)},e.SetDefaultProperties=function(e){if(e.get_isOrdered())e.get_hasListStyleId()&&-1===e.get_listStyleId()||(e.set_levelText("%1."),e.get_propertySet().hasProperty(is.b.numberListFormat)||e.setListStyle(0,1));else{if(1!==e.get_listType())return;e.get_hasListStyleId()&&-1===e.get_listStyleId()||(e.set_font(Zh.z.defaultBulletFont),e.set_levelText(Zh.z.defaultBullet),e.get_propertySet().hasProperty(is.b.numberListFormat)||e.setListStyle(1,6))}e.set_justification("left")},e.SetPropertiesFromListMarker=function(t,n){1===t.get_listMultiLevelType()?e.SetMulitlevelListPropertiesFromListMarker(t,n):e.SetHybridListPropertiesFromListMarker(t,n)},e.SetMulitlevelListPropertiesFromListMarker=function(e,t){e.multilevelDefInfo=t.get_multilevelDefInfo()},e.SetHybridListPropertiesFromListMarker=function(e,t){if(e.set_levelText(t.get_levelText()),e.get_isOrdered()){var n=t.get_listStyle();e.setListStyle(0,n)}else e.set_font(t.get_font()),e.setListStyle(1,1);e.set_justification(t.get_justification())},e.GetListMarker=function(e,t){var n=null;2===e.get_listMultiLevelType()?n=e.get_isOrdered()?Ge.w.get_instance().tryResolve(cC):Ge.w.get_instance().tryResolve(iC):1===e.get_listMultiLevelType()&&(n=Ge.w.get_instance().tryResolve(sC));var i=n.get_listMarkersDictionary().get_value(),r=e.get_listStyleId()+"";if(r in i||(i=n.get_listMarkersInDocumentDictionary()),!(r in i)&&t.hasProperty(is.b.font)){var o=t.getValueWithDefault(String,is.b.font,""),a=Rn.l.fromCharCode(parseInt(r));return new Xy(a,o)}return i[r]},e.SetFontColorFromIp=function(t){e.get_InsertionPointFormatting().hasProperty(is.b.fontColor)&&t.setValue(is.b.fontColor,e.get_InsertionPointFormatting().fontColor())},e.SetFontSizeFromIp=function(t){e.get_InsertionPointFormatting().hasProperty(is.b.fontSize)&&t.setValue(is.b.fontSize,e.get_InsertionPointFormatting().fontSize())},e.LogUsageData=function(e,t){var n=e===Oi.u.toggleBulletsList?0:e===Oi.u.toggleNumberedList?1:e===Oi.u.multilevelList?2:-1,i=t.getValueWithDefault(Number,Pl.k.listStyleId,-1);S.ULS.sendTraceTag(22923024,324,50,"{ListType:%1, ListStyleId:%2}",n,i)},e.ImageCheck=pa.ImageReader.isImageContext,e.AnchoredImageCheck=pa.ImageReader.isAnchoredImageContext,e._listEditor=null,e._listReader=null,e._insertionPointFormatting=null,e._externalSelectionManagerFuture=null,e._listSettings=null,e._singleLevelListEditor=null,e.isSwitchStyleByRangeSelect=!1,e}();(0,o.l)(dC,"2aeecf48$ListActor",null,[]);var gC=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.ListMarker"},e.prototype.init=function(){dC.RegisterActions()},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e,this._container.register(iC).singleInstance().usingFactory((function(){return new iC})),this._container.register(cC).singleInstance().usingFactory((function(){return new cC})),this._container.register(sC).singleInstance().usingFactory((function(){return new sC}))},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(gC,"8b2a2c62$Box4ListMarkerPackage",null,[s.u,u.s]);var pC=(0,o.y)("48ab232b$IListMarkerGalleryActor"),hC=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,"")},e.DialogHtmlFormat="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>",e}();(0,o.l)(hC,"efcf5683$DefineNewBulletDialogHtml",null,[]);var _C=function(e){function t(n,i,r,a,l){var s=this;if(s._theStandaloneRoot=null,s._disposed$4=!1,s.focusManager=null,s._actionManager=null,s._lastFocusedSymbol=null,s._lastSelectedListMarkerId=null,s._listMarkerClickHandler=null,s._listMarkerKeyHandler=null,s._offsetForIndex=0,s._isDefineNewBulletTableCellClassNameEnabled=!0,s.initialPopulateOfFontDropdown=!0,s.fontName=null,s.asciiFonts=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"],s=e.call(this)||this,L.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordDefineNewBulletTableCellClassNameSettings"),s._isDefineNewBulletTableCellClassNameEnabled=a.getBooleanAppSetting("DefineNewBulletTableCellClassNameIsEnabled"),s._theStandaloneRoot=n,s.focusManager=i,s._actionManager=r,s._disposed$4=!1,l){var u=l.indexOf(",");-1!==u&&(l=l.substring(0,u))}return s.fontName=l,s.set_dialogId(t.Id),s.set_dialogHtml(hC.get_dialogHtml()),s.setButtonText(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText),s.setButtonText(0,CommonUIStrings.l_DialogClose),s.initializeAndShow(Box4Intl.Box4Strings.L_SymbolSingle,o.i(s,s.DefineNewBulletHandler,"DefineNewBulletHandler"),null),s._hideOnButtonClick=!1,s.RebindTabNavigationHandlers(),document.getElementById(t.fontStyleComboBoxId).focus(),s}return(0,v.t)(t,e),t.prototype.RebindTabNavigationHandlers=function(){this.focusManager.getCurrentRegion().scope.unBindAction(St.FocusManager.instance()._tabInput),this.focusManager.getCurrentRegion().scope.unBindAction(St.FocusManager.instance()._tabShiftInput),this.focusManager.getCurrentRegion().scope.bindAction(St.FocusManager.instance()._tabInput,Oi.u.defineNewBulletMoveFocusForward),this.focusManager.getCurrentRegion().scope.bindAction(St.FocusManager.instance()._tabShiftInput,Oi.u.defineNewBulletMoveFocusBackward)},t.prototype.onInnerHtmlSet=function(){this.BuildFontComboBox(t.fontStyleComboBoxId,t.FontStylePlaceholder,"1850463992","1223894949","715955193",Box4Intl.Box4Strings.L_FontName,t.FontStyleComboBoxWidth),this.buildDefineNewBulletListMarkerTable()},t.prototype.sizeAndPositionDialog=function(){e.prototype.sizeAndPositionDialog.call(this),document.getElementById(this.myId("WACDialogPanel")).style.width="auto"},t.prototype.BuildFontComboBox=function(e,n,i,r,o,a,l){var s=Yu.s.buildComboBoxXml(e,i,!0,!0,r,o,Rn.l.xmlEncode(a),!0,l);this.CreateDomElementFromXml(e,n,s,t.Medium)},t.prototype.buildDefineNewBulletListMarkerTable=function(){var e=document.getElementById(t.defineNewBulletTableContainerId);e&&(e.innerHTML=this.GetDefineNewBulletListMarkerTableHtml(),this.RegisterFocusForListMarkersInTable(e))},t.prototype.RegisterFocusForListMarkersInTable=function(e){var n=this._isDefineNewBulletTableCellClassNameEnabled?e.getElementsByClassName(t.DefineNewBulletTableCellId):e.getElementsByTagName("a");if(n)for(var i=0;i<n.length;i++)wo.n.addHandler(n[i],me.d.focus,o.i(this,this.DefineNewBulletListMarkerTableFocusHandler,"DefineNewBulletListMarkerTableFocusHandler"))},t.prototype.updateFontOnListMarkerTable=function(){var e=document.getElementById(t.defineNewBulletTableContainerId);if(e){var n=this.fontName,i=nC.isAsciiFont(this.fontName);if(i&&this._offsetForIndex!==t.OffsetForAscii||!i&&this._offsetForIndex!==t.OffsetForUnicode)e.innerHTML=this.GetDefineNewBulletListMarkerTableHtml(),this.RegisterFocusForListMarkersInTable(e);else{var r=e.getElementsByTagName("table");r&&1===r.length&&n&&(n=this.AddQuotesToFontIfNeeded(n),r[0].style.fontFamily=n)}}},t.prototype.DefineNewBulletListMarkerTableFocusHandler=function(e){if(this._lastFocusedSymbol&&e.target!==this._lastFocusedSymbol){var t=this.focusManager.getCurrentRegion();t&&t.listing&&(t.listing.trySetCurrentElement(e.target),this._lastFocusedSymbol=e.target)}this.onSelectedListMarkerChanged(e.target.id)},t.prototype.onSelectedListMarkerChanged=function(e){this.SetListMarkereElementSelectedState(this._lastSelectedListMarkerId,!1),this._lastSelectedListMarkerId=e,this.SetListMarkereElementSelectedState(e,!0);var n=document.getElementById("CharacterCodeValueLabel");if(n&&this._lastSelectedListMarkerId){var i=parseInt(this._lastSelectedListMarkerId.substr(this._lastSelectedListMarkerId.lastIndexOf("_")+1));-1!==i&&(i-=this._offsetForIndex===t.OffsetForAscii?t.OffsetForAscii-t.OffsetForUnicode:0,n.innerText=Rn.l.convertToHex(i,4))}},t.prototype.SetListMarkereElementSelectedState=function(e,t){var n=this.GetListMarkerElement(e);n&&(t?n.setAttribute("selected","true"):n.removeAttribute("selected"))},t.prototype.GetListMarkerElement=function(e){var n=document.getElementById(t.defineNewBulletTableContainerId);return n?n.querySelector("#"+e):null},t.prototype.attachDialogEvents=function(){var n=document.getElementById(t.defineNewBulletTableContainerId);n&&(this._listMarkerClickHandler||(this._listMarkerClickHandler=o.i(this,this.ListMarkerTableClickHandler,"ListMarkerTableClickHandler"),this._clickManager.registerHandler(me.d.click,n,this._listMarkerClickHandler)),this._listMarkerKeyHandler||(this._listMarkerKeyHandler=o.i(this,this.ListMarkerTableKeyHandler,"ListMarkerTableKeyHandler"),this._keyInputManager.registerHandler(me.d.keyDown,n,this._listMarkerKeyHandler),this._keyInputManager.registerHandler(me.d.keyPress,n,this._listMarkerKeyHandler),this._keyInputManager.registerHandler(me.d.keyUp,n,this._listMarkerKeyHandler))),e.prototype.attachDialogEvents.call(this)},t.prototype.IsValidElementForHandler=function(e){return this._isDefineNewBulletTableCellClassNameEnabled?Sys.UI.DomElement.containsCssClass(e,t.DefineNewBulletTableCellId):"a"===e.tagName.toLowerCase()},t.prototype.ListMarkerTableClickHandler=function(e){var t=e.get_sourceElement();return!!this.IsValidElementForHandler(t)&&(this.focusManager.getCurrentRegion().listing.trySetCurrentElement(t),t.focus(),!0)},t.prototype.ListMarkerTableKeyHandler=function(e){var n=e.get_sourceElement();if(!this.IsValidElementForHandler(n))return!1;var i=n.id,r=parseInt(i.substr(i.lastIndexOf("_")+1))-this._offsetForIndex;if(e.innerEvent.ctrlKey||e.innerEvent.altKey||e.innerEvent.keyCode>=Re.v.vK_F1&&e.innerEvent.keyCode<=Re.v.vK_F12)return!1;var o=e.innerEvent.keyCode;if(e.eventName===me.d.keyDown){var a=-1;if(o===Sys.UI.Key.enter)return this.focusManager.getCurrentRegion().listing.trySetCurrentElement(n),n.focus(),this.OnInsertNewListMarker(n.id),this.hide(),!0;if(o===Sys.UI.Key.up?a=r-t.GalleryWidth:o===Sys.UI.Key.down?a=r+t.GalleryWidth:o===Sys.UI.Key.left?a=L.AFrameworkApplication.get_isRtl()?r+1:r-1:o===Sys.UI.Key.right&&(a=L.AFrameworkApplication.get_isRtl()?r-1:r+1),a>=0){var l=this.GetListMarkerElement(t.defineNewBulletTableContainerId+"_"+(a+this._offsetForIndex));l&&l.focus()}}return!0},t.prototype.OnInsertNewListMarker=function(e){if(e){var t=e.split("_"),n=new Dl.DictionaryPropertySet;n.setValue(Pl.k.listStyleId,parseInt(t[1])),n.setValue(is.b.font,this.fontName),n.setValue(Pl.k.listSoftType,1),this._actionManager.processActionWithData(Oi.u.toggleBulletsList,2,n)}this.focusManager.pushScope(this.get_fullDialogFocusId(),!0)},t.prototype.GetDefineNewBulletListMarkerTableHtml=function(){var e=new Sys.StringBuilder,n=nC.isAsciiFont(this.fontName),i=this.fontName;return i=this.AddQuotesToFontIfNeeded(i),e.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',i)),n?(this._offsetForIndex=t.OffsetForAscii,e.append(this._isDefineNewBulletTableCellClassNameEnabled?t.AsciiTableBodyWithCellClassName:t.AsciiTableBody)):(this._offsetForIndex=t.OffsetForUnicode,e.append(this._isDefineNewBulletTableCellClassNameEnabled?t.UnicodeTableBodyWithCellClassName:t.UnicodeTableBody)),e.append("</table>"),e.toString()},t.prototype.AddQuotesToFontIfNeeded=function(e){return e&&-1!==e.indexOf(" ")&&(e="'"+e+"'"),e},t.prototype.CreateDomElementFromXml=function(e,t,n,i){var r=document.getElementById(t);this._theStandaloneRoot.addControl(e,n);var o=this._theStandaloneRoot.getDOMElementForControlDisplayMode(e,i);r.appendChild(o),this._theStandaloneRoot.pollForControlState(e)},t.prototype.DefineNewBulletHandler=function(e,t){1===e&&this.OnInsertNewListMarker(this._lastSelectedListMarkerId),this.hide()},t.prototype.dispose=function(){this._disposed$4||(this._theStandaloneRoot.removeControl(t.fontStyleComboBoxId),this._disposed$4=!0),e.prototype.dispose.call(this)},t.Id="DefineNewBulletDialog",t.fontStyleComboBoxId="DefineNewBulletFontStyleComboBox",t.defineNewBulletTableContainerId="DefineNewBulletTableContainer",t.DefineNewBulletTableCellId="DefineNewBulletTableCell",t.FontStylePlaceholder="DefineNewBulletFontPlaceholder",t.FontStyleComboBoxWidth="100px",t.Medium="Medium",t.OffsetForUnicode=32,t.OffsetForAscii=61472,t.GalleryWidth=17,t.UnicodeTableBody='<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\x7f</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\x80</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\x81</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\x82</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\x83</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\x84</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0">\x85</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\x86</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\x87</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\x88</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\x89</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\x8a</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\x8b</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\x8c</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\x8d</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\x8e</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\x8f</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\x90</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\x91</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\x92</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\x93</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\x94</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\x95</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\x96</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\x97</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\x98</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\x99</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\x9a</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\x9b</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\x9c</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\x9d</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\x9e</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\x9f</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\xa1</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\xa2</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\xa3</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\xa4</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\xa5</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\xa6</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\xa7</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\xa8</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\xa9</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\xaa</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\xab</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\xac</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\xad</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\xae</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\xaf</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\xb0</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\xb1</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\xb2</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\xb3</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\xb4</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\xb5</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\xb6</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\xb7</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\xb8</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\xb9</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\xba</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\xbb</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\xbc</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\xbd</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\xbe</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\xbf</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\xc0</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\xc1</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\xc2</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\xc3</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\xc4</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\xc5</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\xc6</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\xc7</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\xc8</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\xc9</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\xca</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\xcb</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\xcc</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\xcd</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\xce</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\xcf</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\xd0</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\xd1</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\xd2</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\xd3</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\xd4</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\xd5</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\xd6</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\xd7</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\xd8</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\xd9</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\xda</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\xdb</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\xdc</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\xdd</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\xde</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\xdf</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\xe0</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\xe1</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\xe2</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\xe3</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\xe4</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\xe5</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\xe6</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\xe7</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\xe8</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\xe9</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\xea</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\xeb</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\xec</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\xed</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\xee</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\xef</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\xf0</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\xf1</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\xf2</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\xf3</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\xf4</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\xf5</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\xf6</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\xf7</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\xf8</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\xf9</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\xfa</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\xfb</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\xfc</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\xfd</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\xfe</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\xff</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>',t.AsciiTableBody='<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<a href = "#" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</a>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>',t.UnicodeTableBodyWithCellClassName='<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\x7f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\x80</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\x81</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\x82</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\x83</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\x84</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\x86</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\x87</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\x88</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\x89</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\x8a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\x8b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\x8c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\x8d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\x8e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\x8f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\x90</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\x91</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\x92</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\x93</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\x94</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\x95</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\x96</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\x97</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\x98</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\x99</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\x9a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\x9b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\x9c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\x9d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\x9e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\x9f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\xa1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\xa2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\xa3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\xa4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\xa5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\xa6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\xa7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\xa8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\xa9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\xaa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\xab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\xac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\xad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\xae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\xaf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\xb0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\xb1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\xb2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\xb3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\xb4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\xb5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\xb6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\xb7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\xb8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\xb9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\xba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\xbb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\xbc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\xbd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\xbe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\xbf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\xc0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\xc1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\xc2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\xc3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\xc4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\xc5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\xc6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\xc7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\xc8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\xc9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\xca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\xcb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\xcc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\xcd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\xce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\xcf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\xd0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\xd1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\xd2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\xd3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\xd4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\xd5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\xd6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\xd7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\xd8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\xd9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\xda</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\xdb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\xdc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\xdd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\xde</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\xdf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\xe0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\xe1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\xe2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\xe3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\xe4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\xe5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\xe6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\xe7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\xe8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\xe9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\xea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\xeb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\xec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\xed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\xee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\xef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\xf0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\xf1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\xf2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\xf3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\xf4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\xf5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\xf6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\xf7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\xf8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\xf9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\xfa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\xfb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\xfc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\xfd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\xfe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\xff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>',t.AsciiTableBodyWithCellClassName='<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>',t}(Bi.o);(0,o.l)(_C,"fc21bd46$DefineNewBulletDialog",Bi.o,[]);var mC=(0,o.y)("d8042e84$IListMarkerGalleryCommands"),fC=function(){function e(){}return e.prototype.getListMarkerGalleryOpenCommand=function(){return Oi.u.listMarkerBulletsDropDownOpen},e.prototype.getPopulateListMarkerGalleryDropDownCommand=function(){return Oi.u.populateListMarkerBulletsDropDown},e}();(0,o.l)(fC,"e8638b8b$ListMarkerGalleryBulletCommands",null,[mC]);var yC=function(){function e(){}return e.prototype.getListMarkerGalleryOpenCommand=function(){return Oi.u.listMarkerMultilevelDropDownOpen},e.prototype.getPopulateListMarkerGalleryDropDownCommand=function(){return Oi.u.populateListMarkerMultilevelDropDown},e}();(0,o.l)(yC,"83eaf2b2$ListMarkerGalleryMultilevelCommands",null,[mC]);var CC=function(){function e(){}return e.prototype.getListMarkerGalleryOpenCommand=function(){return Oi.u.listMarkerNumberingsDropDownOpen},e.prototype.getPopulateListMarkerGalleryDropDownCommand=function(){return Oi.u.populateListMarkerNumberingsDropDown},e}();(0,o.l)(CC,"5347a2ce$ListMarkerGalleryNumberingCommands",null,[mC]);var SC=function(){function e(e,t,n,i){var r;switch(this._actionManager=null,this._listMarkerGalleryUtility=null,this._listMarkerGalleryCommands=null,this._listReader=null,this._standalone=null,this._defineNewBulletDialog=null,this._listMarkerType=0,this.FloatieMenuIds=["floatiesbBulletGallery","floatiesbNumberingGallery","floatieflyMultilevelGallery"],this._actionManager=e,this._listReader=i.resolve(Ql.c),this._listMarkerType=t,this._standalone=n,this._listMarkerType){case 0:r=i.resolve(iC),this._listMarkerGalleryCommands=new fC;break;case 1:r=i.resolve(cC),this._listMarkerGalleryCommands=new CC;break;case 2:r=i.resolve(sC),this._listMarkerGalleryCommands=new yC;break;default:r=i.resolve(iC),this._listMarkerGalleryCommands=new fC}r.updateListMarkersInDocumentDictionary(this._listReader),this._listMarkerGalleryUtility=new nC(t,r,this._listReader,!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled())}return e.prototype.registerActions=function(){var e=yi.App.theContextSetActor.createDelegatedViewHandlerForNodeType(11);this._actionManager.addAction(this._listMarkerGalleryCommands.getPopulateListMarkerGalleryDropDownCommand(),ol.d.view,e),this._actionManager.addAction(this._listMarkerGalleryCommands.getPopulateListMarkerGalleryDropDownCommand(),ol.d.outlineElement,o.i(this,this.populateListMarkerGalleryDropDown,"populateListMarkerGalleryDropDown")),this._actionManager.setActionFlags(this._listMarkerGalleryCommands.getPopulateListMarkerGalleryDropDownCommand(),100),this._listMarkerType||(this._actionManager.addActionWithFlags(Oi.u.launchDefineNewBulletDialog,ol.d.view,o.i(this,this.launchDefineNewBulletDialogHandler,"launchDefineNewBulletDialogHandler"),4),this._actionManager.addActionWithFlags(Oi.u.populateDefineNewBulletFontDropdown,ol.d.view,o.i(this,this.PopulateDefineNewBulletFontDropdown,"PopulateDefineNewBulletFontDropdown"),100),this._actionManager.addActionWithFlags(Oi.u.defineNewBulletFont,ol.d.view,o.i(this,this.DefineNewBulletFontNameHandler,"DefineNewBulletFontNameHandler"),4),this._actionManager.addActionWithFlags(Oi.u.defineNewBulletMoveFocusForward,Ue.m.frame,o.i(this,this.DefineNewBulletMoveFocusForTabsHandler,"DefineNewBulletMoveFocusForTabsHandler"),64),this._actionManager.addActionWithFlags(Oi.u.defineNewBulletMoveFocusBackward,Ue.m.frame,o.i(this,this.DefineNewBulletMoveFocusForTabsHandler,"DefineNewBulletMoveFocusForTabsHandler"),64)),this._actionManager.addAction(this._listMarkerGalleryCommands.getListMarkerGalleryOpenCommand(),ol.d.view,o.i(this,this.listMarkerGalleryMenuOpen,"listMarkerGalleryMenuOpen")),this._actionManager.addAction(this._listMarkerGalleryCommands.getListMarkerGalleryOpenCommand(),ol.d.outlineElement,o.i(this,this.listMarkerGalleryMenuOpen,"listMarkerGalleryMenuOpen")),this._actionManager.setActionFlags(this._listMarkerGalleryCommands.getListMarkerGalleryOpenCommand(),100)},e.prototype.DefineNewBulletMoveFocusForTabsHandler=function(e,t,n,i,r){if(!this._defineNewBulletDialog)return 2;if(this._defineNewBulletDialog.focusManager.getCurrentRegion().listing.get_currentElement().id.startsWith(_C.defineNewBulletTableContainerId)){var o=null;if(e===Oi.u.defineNewBulletMoveFocusForward?o=this._defineNewBulletDialog.get_btnAction():e===Oi.u.defineNewBulletMoveFocusBackward&&(o=document.getElementById(_C.fontStyleComboBoxId)),!o)return 2;this._defineNewBulletDialog.focusManager.getCurrentRegion().listing.trySetCurrentElement(o),o.focus()}else if(e===Oi.u.defineNewBulletMoveFocusForward)this._defineNewBulletDialog.focusManager.getCurrentRegion().moveForward();else{if(e!==Oi.u.defineNewBulletMoveFocusBackward)return 2;this._defineNewBulletDialog.focusManager.getCurrentRegion().moveBackward()}return 32},e.prototype.listMarkerGalleryMenuOpen=function(e,t,n,i,r){var o=t,a=null;return o.view.get_isInteractiveView()&&(a=o.view),a&&a.get_selectionManager()?32:(El.r.traceTag(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",t.toString()),8)},e.prototype.launchDefineNewBulletDialogHandler=function(e,t,n,i,r){if(1===n)return 32;if(2===n){var o=this.GetSelectedGraphNodeContextFromViewContext(t),a=vc.FormattingReader.getFormattingObject(o).get_cache().get_fontFace();return this._defineNewBulletDialog=new _C(this._standalone,St.FocusManager.instance(),L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.appSettingsManager,a),32}return 8},e.prototype.GetSelectedGraphNodeContextFromViewContext=function(e){return this.GetCollapsedSelectionFromContext(e).get_firstContext()},e.prototype.GetCollapsedSelectionFromContext=function(e){var t=null,n=e.view;return n&&(t=ga.SelectionEditor.collapseToIp(n.get_selectionManager().get_selectionCollection().get_item(0),!1,!1))||t},e.prototype.PopulateDefineNewBulletFontDropdown=function(e,t,n,i,r){if(1===n)return 32;if(2===n&&!r)return 8;if(this._defineNewBulletDialog.initialPopulateOfFontDropdown){for(var o=function(e){var t;yc.v.trySupportDocumentFont(nC.asciiFonts[e],(0,g.m)((function(){return t}),(function(e){return t=e})))},a=0;a<nC.asciiFonts.length;a++)o(a);this._defineNewBulletDialog.initialPopulateOfFontDropdown=!1}return Cc.Font.initializeFontDropDown(t),r.PopulationXML=yc.v.generateFontDropdownXml(Cc.Font.shouldShowThemeFont,Cc.Font.formatThemeFontDisplayNameDelegate,Oi.u.defineNewBulletFont,!1),32},e.prototype.populateListMarkerGalleryDropDown=function(e,t,n,i,r){var o=t.get_contextId()===ol.d.outlineElement;if(1===n||!o)return o?32:8;if(2===n&&!r)return 8;t.get_node();var a=r;if(L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled())a.MenuItems=this._listMarkerGalleryUtility.getListMarkerGalleryDropDownProps(!0),a.MenuId&&Array.contains(this.FloatieMenuIds,a.MenuId)&&(a.PopulationXML=this._listMarkerGalleryUtility.getListMarkerGalleryDropDownXml());else{var l=this._listMarkerGalleryUtility.getListMarkerGalleryDropDownXml();a.PopulationXML=l}return 32},e.prototype.DefineNewBulletFontNameHandler=function(e,t,n,i,r){if(1===n)return 32;if(2===n){var o=(0,y.e)(Mf.p,r);if(!o||!o.get_actionData())return 8;var a=o.get_actionData();return this._defineNewBulletDialog.fontName=a.fontName,this._defineNewBulletDialog.updateFontOnListMarkerTable(),32}return 8},e}();(0,o.l)(SC,"845e0b22$ListMarkerGalleryActor",null,[pC]);var bC=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.ListMarkerGallery"},e.prototype.init=function(){this.RegisterListMarkerGalleryActors()},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e},e.prototype.RegisterListMarkerGalleryActors=function(){new SC(L.AFrameworkApplication.get_theActionManager(),1,this._container.resolve(nu.r).get_sharedStandaloneRoot(),this._container).registerActions(),new SC(L.AFrameworkApplication.get_theActionManager(),0,this._container.resolve(nu.r).get_sharedStandaloneRoot(),this._container).registerActions(),new SC(L.AFrameworkApplication.get_theActionManager(),2,this._container.resolve(nu.r).get_sharedStandaloneRoot(),this._container).registerActions()},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(bC,"18873562$Box4ListMarkerGalleryPackage",null,[s.u,u.s]);var vC=(0,o.y)("27afe407$IBusinessBarRankProvider"),TC=n(6958),AC=n(1582),IC=n(5971),wC=(0,o.y)("eb21cf8e$IBusinessBarDom"),xC=n(2715),EC=n(6750),FC=n(7798),PC=n(10),DC=function(){function e(){}return e.UpdateBusinessBarTargetElement=function(t,n,i,r){var o=ji.s.parseCssSize(t.style.top);PC.WacAirSpace.setAnimationClass(t,e.BusinessBarAnimationClass);var a=new EC.r(t);a.animateY(o,n),PC.WacAirSpace.animate(a,i,r)},e.AddBusinessBar=function(t,n,i,r){PC.WacAirSpace.setAnimationClass(t,e.BusinessBarAnimationClass);var o=new FC.g(t);o.animateOpacity(0,1),PC.WacAirSpace.animate(o,null,null);var a=new EC.r(t);a.animateY(t.clientTop-30,t.clientTop),PC.WacAirSpace.animate(a,null,r);for(var l=i+1;l<n.length;l++){var s=n[l];PC.WacAirSpace.setAnimationClass(s,e.BusinessBarAnimationClass);var u=new EC.r(s);u.animateY(s.clientTop-t.clientHeight,s.clientTop),PC.WacAirSpace.animate(u,null,null)}},e.RemoveBusinessBar=function(t,n,i,r){PC.WacAirSpace.setAnimationClass(t,e.BusinessBarAnimationClass);var o=new xC.y(t);o.animateOpacity(1,0),PC.WacAirSpace.animate(o,i,r);for(var a=!1,l=0;l<n.length;l++){if(a){var s=n[l];PC.WacAirSpace.setAnimationClass(s,e.BusinessBarAnimationClass);var u=new EC.r(s);u.animateY(s.clientTop,-t.clientHeight),PC.WacAirSpace.animate(u,null,e.OnAfterMoveBusinessBarsUp)}a||n[l]!==t||(a=!0)}},e.OnAfterMoveBusinessBarsUp=function(e){e.get_element().style.top=""},e.BusinessBarAnimationClass="Shared_BasicClass",e}();(0,o.l)(DC,"d5569622$BusinessBarAnimator",null,[]);var RC,MC=n(7742),kC=function(){function e(t,n,i){var r=this;this._businessBar=null,this._visible=!1,this._element=null,this._target=null,this._targetOffset=0,this._currentHeight=0,this._originalTargetTop=null,this._contextMenuHandler=null,this._target=t,this._targetOffset=n,this._businessBar=i;var o=t.ownerDocument;this._element=o.createElement("div"),this._element.className=e._wacBusinessBar,ar.r.get_instance().executeWhen(14,(function(){Sys.UI.DomElement.addCssClass(r._element,"regionComposer")})),this._element.id=e._wacBusinessBar,W.y.get_isFirefox()&&Sys.UI.DomElement.addCssClass(this._element,"FireFox")}return e.prototype.get_htmlElement=function(){return this._element},e.prototype.get_visible=function(){return this._visible},e.prototype.set_visible=function(e){return this._visible===e?e:(this._visible=e,e?this.AttachToTarget():this.DetachFromTarget(),e)},e.prototype.dispose=function(){this.get_visible()&&this.DetachFromTarget(),ji.s.clearElementHtml(this._element),this._element=null,this._target=null},e.prototype.showEntry=function(e,t){var n=e.get_htmlElement()||e.createElement();t===this._element.childNodes.length?this._element.appendChild(n):this._element.insertBefore(n,this._element.childNodes[t]),e.resizeToFit(),this._currentHeight+=e.get_htmlElement().clientHeight,DC.AddBusinessBar(n,this._element.childNodes,t,o.i(this,this.OnAfterShowEntry,"OnAfterShowEntry")),e.showEntryForScreenReader(),this.set_visible(!0)},e.prototype.hideEntry=function(e){var t=e.get_htmlElement();if(ji.s.isInDocument(t)){this._currentHeight-=e.get_htmlElement().clientHeight;var n=t.parentNode;DC.RemoveBusinessBar(t,n.children,null,o.i(this,this.OnAfterHideEntry,"OnAfterHideEntry"))}},e.prototype.OnAfterShowEntry=function(e){e.get_element().style.top="",L.AFrameworkApplication.get_activeFrame().notifyResize()},e.prototype.OnAfterHideEntry=function(e){e.get_element().parentNode.removeChild(e.get_element()),this._element.hasChildNodes()||this.set_visible(!1),L.AFrameworkApplication.get_activeFrame().notifyResize()},e.prototype.AttachToTarget=function(){var e=this;""===this._target.style.top.trim()&&(this._target.style.top=this._target.offsetTop+"px"),this._element.style.left=this._target.style.left,this._element.style.top=this._target.style.top,this._element.style.height="auto",this._element.style.visibility="visible";var t=Sys.UI.DomElement.getBounds(this._element);if(this._originalTargetTop=this._target.style.top,this._currentHeight=t.height,this.updateTarget(),L.AFrameworkApplication.get_activeFrame().add_onResize(o.i(this,this.OnResize,"OnResize")),wo.n.addHandler(this._element,me.d.selectStart,wo.n.cancelEventHandler),this._contextMenuHandler=o.i(this,this.ContextMenuHandler,"ContextMenuHandler"),L.AFrameworkApplication.get_activeFrame().get_theContextMenuInputManager().registerHandler(this._element,this._contextMenuHandler,null),St.FocusManager.usable()){var n=St.FocusManager.instance(),i=n.getScope(MC.t.businessBarFocusID);i.parent=Pe.AFrame.mainAppFocusId;var r=new De.DOMFocusListing((function(){return e._element}));r.addValidTag(1),r.addValidTag(2),r.addValidTag(8),n.buildRegionWithDelegate((function(){return e._element}),i,r);var a=n.getRegion(MC.t.businessBarFocusID);a.rememberFocusStealers(),a.looped=!0,a.contained=!0;var l=L.AFrameworkApplication.get_activeFrame().get_theF6Manager();i.addDispose((function(){l.deactivateFocus(MC.t.businessBarFocusID)})),l.addF6KeyBindings(MC.t.businessBarFocusID),r.get_firstElement()&&l.activateFocus(MC.t.businessBarFocusID)}},e.prototype.DetachFromTarget=function(){if(this._businessBar.get_displayOverTarget()||(this._target.style.top=this._originalTargetTop),this._element.style.visibility="hidden",L.AFrameworkApplication.get_activeFrame()){if(St.FocusManager.usable())St.FocusManager.instance().removeScope(MC.t.businessBarFocusID);this._contextMenuHandler&&(L.AFrameworkApplication.get_activeFrame().get_theContextMenuInputManager().unregisterHandler(this._element,this._contextMenuHandler),this._contextMenuHandler=null)}wo.n.removeHandler(this._element,me.d.selectStart,wo.n.cancelEventHandler)},e.prototype.updateTarget=function(){!this._businessBar.get_displayOverTarget()&&this.get_visible()&&DC.UpdateBusinessBarTargetElement(this._target,this._currentHeight+this._targetOffset,null,null)},e.prototype.OnResize=function(){for(var e,t=this._businessBar.get_entries().length,n=Sys.UI.DomElement.getBounds(this._element).height,i=0;i<t;++i)(e=this._businessBar.get_entries()[i]).get_htmlElement()&&e.resizeToFit();this._currentHeight=Sys.UI.DomElement.getBounds(this._element).height,n!==this._currentHeight&&this.updateTarget()},e.prototype.ContextMenuHandler=function(e){return!0},e._wacBusinessBar="WACBusinessBar",e}();(0,o.l)(kC,"35579ee7$BusinessBarDom",null,[wC,Sys.IDisposable]),function(e){e[e.none=0]="none",e[e.corruptPage=1]="corruptPage",e[e.currentPageStatus=2]="currentPageStatus",e[e.documentMarkedAsFinal=3]="documentMarkedAsFinal",e[e.documentSigned=4]="documentSigned",e[e.fileAccess=5]="fileAccess",e[e.kickoutWithDataLoss=6]="kickoutWithDataLoss",e[e.lostSession=7]="lostSession",e[e.malformedHyperlinkUris=8]="malformedHyperlinkUris",e[e.odt=9]="odt",e[e.readonlyRecommended=10]="readonlyRecommended",e[e.saveReplaySuccess=11]="saveReplaySuccess",e[e.saveReplayFailed=12]="saveReplayFailed",e[e.unsupportedObjects=13]="unsupportedObjects",e[e.word11Compat=14]="word11Compat",e[e.unsupportedBrowser=15]="unsupportedBrowser",e[e.applicationNotification=16]="applicationNotification",e[e.skypeDocChatFailed=17]="skypeDocChatFailed",e[e.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo",e[e.sessionExpired=19]="sessionExpired",e[e.irmPolicyDescription=20]="irmPolicyDescription",e[e.policyWarningMessage=21]="policyWarningMessage",e[e.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled",e[e.gdprPrivacyNotice=23]="gdprPrivacyNotice",e[e.datacenterDecommissionWarning=24]="datacenterDecommissionWarning",e[e.graphMergePrompt=25]="graphMergePrompt",e[e.readOnlyDocument=26]="readOnlyDocument",e[e.dictationSilence=27]="dictationSilence",e[e.autoSensitivityLabel=28]="autoSensitivityLabel",e[e.recommendedSensitivityLabel=29]="recommendedSensitivityLabel",e[e.testEntry1=30]="testEntry1",e[e.testEntry2=31]="testEntry2",e[e.testEntry3=32]="testEntry3",e[e.testEntry4=33]="testEntry4",e[e.testEntry5=34]="testEntry5",e[e.testEntry6=35]="testEntry6",e[e.testEntry7=36]="testEntry7"}(RC||(RC={})),(0,o.h)("5db1534$BusinessBarId",RC);var NC=function(){function e(e,t,n,i){void 0===t&&(t=0),void 0===n&&(n=null),void 0===i&&(i=null),this._displayOverTarget=!1,this._priorityMap=null,this._businessBarDom=null,this._entries=[],this._businessBarDom=i||new kC(e,t,this),this.InitializePriorityMap(n)}return e.prototype.InitializePriorityMap=function(e){if(e){this._priorityMap={};for(var t=e.get_ranking(),n=0;n<t.length;n++)this._priorityMap[RC[t[n]]]=n}},e.prototype.dispose=function(){this._businessBarDom.dispose(),gi.d.safeDisposeArray(this._entries),this._entries=null},e.prototype.get_htmlElement=function(){return this._businessBarDom.get_htmlElement()},e.prototype.get_visible=function(){return this._businessBarDom.get_visible()},e.prototype.get_displayOverTarget=function(){return this._displayOverTarget},e.prototype.set_displayOverTarget=function(e){return this._displayOverTarget=e,e},e.prototype.get_entries=function(){return this._entries},e.prototype.set_entries=function(e){return this._entries=e,e},e.prototype.isEntryExistent=function(e){for(var t=0;t<this._entries.length;t++)if(this._entries[t].get_id()===e)return!0;return!1},e.prototype.addEntry=function(t,n){void 0===n&&(n=!1),t.set_businessBar(this);var i=this.GetIndexForNewEntry(t.get_id());n&&!this._priorityMap&&(i=0),i<e.maxBarsVisible&&(this._businessBarDom.showEntry(t,i),this._entries.length>=e.maxBarsVisible&&this._businessBarDom.hideEntry(this._entries[e.maxBarsVisible-1]),this._businessBarDom.updateTarget()),Array.insert(this._entries,i,t),S.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",RC[t.get_id()],void 0===t.get_containerID()||null===t.get_containerID()?"":t.get_containerID()),t.get_errorCode()&&L.AFrameworkApplication.reportError(t.get_errorCode())},e.prototype.removeEntry=function(t){var n=Array.indexOf(this._entries,t);-1!==n&&n<e.maxBarsVisible&&(this._entries.length>e.maxBarsVisible&&this._businessBarDom.showEntry(this._entries[e.maxBarsVisible],e.maxBarsVisible),this._businessBarDom.hideEntry(t),this._businessBarDom.updateTarget()),Array.remove(this._entries,t),t.set_businessBar(null),t.dispose()},e.prototype.GetIndexForNewEntry=function(e){if(!this._priorityMap)return this._entries.length;if(!e)return this._entries.length;var t=this._priorityMap[RC[e]];if(null==t)return this._entries.length;for(var n=0;n<this._entries.length;n++)if(t<this._priorityMap[RC[this._entries[n].get_id()]])return n;return this._entries.length},e.maxBarsVisible=2,e}();(0,o.l)(NC,"b26eb541$BusinessBar",null,[ci.c,Sys.IDisposable]);var LC=n(7714),BC=function(){function e(){}return e.prototype.create=function(e,t,n){return new LC.l(e,t,n)},e}();(0,o.l)(BC,"2e6dc161$Factory",null,[di]);var OC=function(){function e(){}return e.configureBusinessBar=function(e,t,n){void 0===n&&(n=0),e.register(NC).as(ci.c).singleInstance().usingFactory((function(){return new NC(t.get_value(),n,e.tryResolve(vC))})),e.register(BC).as(di).singleInstance()},e}();(0,o.l)(OC,"fd1538d8$CommonUIComponentConfiguration",null,[]);var UC=function(){function e(){}return e.prototype.get_ranking=function(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,25,26,27,28,29]},e}();(0,o.l)(UC,"273e631d$BusinessBarRankProvider",null,[vC]);var HC=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Wonca.UI"},e.prototype.configure=function(e){this._container=e,e.register(vC).singleInstance().usingFactory((function(){return new UC})),OC.configureBusinessBar(e,new nt.q(Object,(function(){return yi.App.get_activeAppFrame().get_documentPanelContent()}))),e.register(ac).singleInstance().usingFactory((function(){return new ac(e.resolve(gu),e.resolve(Ng.c),e.resolve(TC.o),L.AFrameworkApplication.get_imageClusterName(),L.AFrameworkApplication.get_imageClusterPath(),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordEditorProofingIgnoreAll"),e.resolve(AC.d))}))},e.prototype.init=function(){this._container.resolve(IC.x),this._container.resolve(ci.c)},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(HC,"2e65fdef$WoncaUIPackage",null,[s.u,u.s]);var GC=n(5893),WC=function(){function e(){}return e.editInBrowser="UI_EditInBrowser",e.newPage="NewPage",e.navigationResult="WacPageNavigationResult",e}();(0,o.l)(WC,"a289bd55$MessageId",null,[]);var VC=function(){function e(){}return e.pageId="PageId",e.pageTarget="PageTarget",e.sectionName="SectionName",e.succeeded="Succeeded",e.url="Url",e}();(0,o.l)(VC,"2403878f$MessageKey",null,[]);var $C=function(){function e(e,t){this.HostingAppUrl=null,this._hostPostMessenger=null,this.HostingAppUrl=e,this._hostPostMessenger=t}return e.prototype.sendNavigationResult=function(e,t,n){if(!this._hostPostMessenger)return!1;var i=new ul.f;i.MessageId=WC.navigationResult;var r={};return r[VC.sectionName]=e,r[VC.pageId]=t,r[VC.succeeded]=n,i.Values=r,this._hostPostMessenger.send(i,this.HostingAppUrl)},e.prototype.sendMessageToHostApp=function(e,t){if(!this._hostPostMessenger)return!1;var n=new ul.f;return n.MessageId=e,n.Values=t,this._hostPostMessenger.send(n,this.HostingAppUrl)},e.prototype.sendNewPageMesssageToHostApp=function(e,t){var n=String.format("https://{0}.one&page-id={1}&end",encodeURIComponent(e),t),i=(new ul.f,{});return i[VC.url]=n,this.sendMessageToHostApp(WC.newPage,i)},e.prototype.sendEditInBrowser=function(e){var t={};return t[VC.pageTarget]=e,this.sendMessageToHostApp(WC.editInBrowser,t)},e}();(0,o.l)($C,"540873$OneNoteEmbeddingMessageSender",null,[]);var zC=function(){function e(){}return e.getWacCommandId=function(t){switch(t){case e.undo:return"3136828847";case e.redo:return"2639435831";case e.copy:return"3383614517";case e.paste:return"237279923";case e.cut:return"2309168610";case e.bold:return"4143129361";case e.italic:return"3569444222";case e.underline:return"1863297734";case e.superscript:return"1107614";case e.subscript:return"1455408143";case e.strikethrough:return"4169095173";case e.font:return"3430668515";case e.fontSize:return"3217001754";case e.fontColor:return"2652969281";case e.fontBackgroundColor:return"1000936187";case e.insertTable:return"1473951236";case e.insertImage:return"2670646631";case e.insertOnlinePicture:return"576018453";case e.insertHyperlink:return"2583004990";case e.insertSymbol:return"2733690884";case e.centerJustify:return"4284004393";case e.leftJustify:return"2539120357";case e.rightJustify:return"393413924";case e.demote:return"4073520836";case e.promote:return"3376107472";case e.navPage:return"1526710486";case e.newPage:return"4279018031";case e.enterMarqueeSelectMode:return"3414872289";case e.enterInkingPenMode:return"4211422424";case e.enterInkingHighlighterMode:return"501553948";case e.enterEraserMode:return"2456990301";case e.exitInkingOrEraserMode:return"1951024620";case e.changeInkColor:return"2339730315";case e.changeInkThickness:return"737662428";default:S.ULS.sendTraceTag(17646671,339,15,"Unhandled command in Commanding interface {0}",t)}return null},e.undo=0,e.redo=1,e.copy=2,e.paste=3,e.cut=4,e.bold=5,e.italic=6,e.underline=7,e.superscript=8,e.subscript=9,e.strikethrough=10,e.font=11,e.fontSize=12,e.fontColor=13,e.fontBackgroundColor=14,e.insertTable=15,e.insertImage=16,e.insertOnlinePicture=17,e.insertHyperlink=18,e.insertSymbol=19,e.centerJustify=20,e.leftJustify=21,e.rightJustify=22,e.demote=23,e.promote=24,e.navPage=25,e.newPage=26,e.enterInkingPenMode=27,e.enterInkingHighlighterMode=28,e.enterEraserMode=29,e.exitInkingOrEraserMode=30,e.changeInkColor=31,e.changeInkThickness=32,e.enterMarqueeSelectMode=33,e}();(0,o.l)(zC,"febbe89e$CommandingID",null,[]);var KC=function(){function e(){}return e.messageKey="Message",e.commandName="CommandName",e.actionId="ActionId",e.handlerLoadedMessageId="HandlerLoaded",e.handlerLoadedMessage="Handler is ready for commands",e.actionResponse="CommandingInterfaceResponse",e.actionResponseInvalidId="CommandId is not valid",e.actionFailed="Failed",e.actionResult="Result",e.cause="Cause",e.titleChanged="TitleChanged",e.title="Title",e}();(0,o.l)(KC,"4a901b07$MessageValues",null,[]);var qC=function(){function e(e,t,n,i){this._hostPostmessengerFuture=null,this._hostPostmessenger=null,this._cuiuser=null,this._hostingApp=null,this._graphInstance=null,this._pageReader=null,this._messageSender=null,this._hostPostmessengerFuture=e,this._hostingApp=t,this._graphInstance=n.get_theGraph(),this._pageReader=i}return e.prototype.RegisterActions=function(e){Ti.App.get_isEmbedMessageEnabled()&&(this._hostPostmessengerFuture.execute(o.i(this,this.OnHostPostmessengerCreated,"OnHostPostmessengerCreated")),this._cuiuser=e,this._graphInstance&&(S.ULS.sendTraceTag(17646672,339,50,"GraphInstance Avaliable"),this._graphInstance.getSpecificEventHandlers(1).add_onPropertyChanged(o.i(this,this.OnTitlePropertyChanged,"OnTitlePropertyChanged"))),this._messageSender=new $C(this._hostingApp,this._hostPostmessenger))},e.prototype.OnTitlePropertyChanged=function(e,t){if(t.get_property().id===is.b.pageTitle.id){var n=t.get_node(),i=this._pageReader.getPageTitle(n),r={};r[KC.title]=i,this._messageSender.sendMessageToHostApp(KC.titleChanged,r)}},e.prototype.OnHostPostmessengerCreated=function(t){this._hostPostmessenger=t,this._hostPostmessenger.addAllowedReceivingMessage(he.a.commanding),this._hostPostmessenger.addAllowedOrigin(e.onenoteOrigin),this._hostPostmessenger.addAllowedOrigin(e.onenoteEdogOrigin),this._hostPostmessenger.registerCallback(he.a.commanding,o.i(this,this.CommandingHandler,"CommandingHandler"));var n={};n[KC.messageKey]=KC.handlerLoadedMessage,this._messageSender.sendMessageToHostApp(KC.handlerLoadedMessageId,n)},e.prototype.CommandingHandler=function(e){S.ULS.sendTraceTag(17646674,339,50,"Commanding Handler Received Message");var t=e.Values.ActionId?e.Values.ActionId:"",n=parseInt(t);if(""!==t&&isFinite(n)){var i=zC.getWacCommandId(n);if(i){var r=e.Values,o=this._cuiuser.executeRootCommand(i,r,null);S.ULS.sendTraceTag(17646675,339,50,"Commanding Interface Processed Command "+i+" with result "+o);var a={};a[KC.commandName]=t,a[KC.actionResult]=o,this._messageSender.sendMessageToHostApp(KC.actionResponse,a)}else this.SendExecutionFailedMessage(t)}else this.SendExecutionFailedMessage(t)},e.prototype.SendExecutionFailedMessage=function(e){var t={};t[KC.commandName]=e,t[KC.actionResult]=KC.actionFailed,t[KC.cause]=KC.actionResponseInvalidId,this._messageSender.sendMessageToHostApp(KC.actionResponse,t)},e.onenoteOrigin="https://www.onenote.com",e.onenoteEdogOrigin="https://edog.onenote.com",e}();(0,o.l)(qC,"c0462e0$CommandingMessageHandler",null,[]);var jC,QC=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"OneNote.CommandingEditors"},e.prototype.configure=function(e){this._container=e,e.register(qC).singleInstance().usingFactory((function(){return new qC(e.resolveFuture(se.i),L.AFrameworkApplication.appSettingsManager.get_appSettings().OneNoteEmbedHostingApp,e.resolve(GC.m),$s.PageReader.get_instance())}))},e.prototype.getContainingGraph=function(){return yi.App.get_activeAppFrame().workspace&&yi.App.get_activeAppFrame().workspace.get_contentView()&&yi.App.get_activeAppFrame().workspace.get_contentView().get_targetNode()?yi.App.get_activeAppFrame().workspace.get_contentView().get_targetNode().get_containingGraph():null},e.prototype.init=function(){if(Ti.App.get_isEmbedMessageEnabled()){var e=this._container.resolve(ou.h);this._container.resolve(qC).RegisterActions(e)}},e.prototype.dispose=function(){},e.main=function(){Ti.App.get_isEmbedMessageEnabled()&&B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(QC,"3e1b53ef$OneNoteCommandingEditorsPackage",null,[s.u,u.s]),"undefined"==typeof jC&&(jC={}),window.MSOJS=jC,jC.ClientUtils=function(){function e(){return Boolean(Q)||(Q=!0,J=i("Windows NT")),J>=6.1&&!(window.navigator.userAgent.indexOf("ARM;")>=0)&&(s()||p()||d())}function t(){return window.navigator.userAgent.indexOf("Windows")>=0}function n(){return window.navigator.userAgent.indexOf("Windows Phone")>=0}function i(e){var t=new RegExp(e+"\\s+(\\d+(\\.\\d*)?)").exec(window.navigator.userAgent),n=-1;return null!=t&&t.length>=2&&(n=parseFloat(t[1]),isNaN(n)&&(n=-1)),n}function r(){return Boolean(X)||(X=!0,Y=i("Windows Phone")),Y>=8}function o(){return"function"==typeof navigator.msLaunchUri&&!n()&&!g()&&!l()}function a(){return window.navigator.userAgent.indexOf("Macintosh")>=0}function l(){return window.navigator.userAgent.indexOf("Edge/")>=0}function s(){return window.navigator.userAgent.indexOf(" MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0}function u(){return!!s()&&8==window.document.documentMode}function c(){return window.navigator.userAgent.indexOf(" Firefox/")>=0}function d(){return window.navigator.userAgent.toLowerCase().indexOf("chrome")>=0}function g(){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("android")>=0&&e.indexOf("chrome")>=0}function p(){return(c()?_("firefox/"):0)>=3}function h(){return(window.navigator.userAgent.indexOf(" AppleWebKit/")>=0?_("version/"):0)>=3}function _(e){var t,n,i=window.navigator.userAgent.toLowerCase(),r=i.indexOf(e);return r>=0?(t=r+e.length,n=i.length,parseInt(i.substring(t,n))):0}function m(e,t,n,i){i&&null!=t?t():o()?navigator.msLaunchUri(e,t,n):!d()&&!(window.navigator.userAgent.indexOf("iPhone")>=0||window.navigator.userAgent.indexOf("iPad")>=0)||l()?y(e,t,n):f(e,t,n)}function f(e,t,n){var i="OICLinkTag",r=document.getElementById(i);null==r&&((r=document.createElement("a")).id=i,r.style.visibility="hidden",r.href="",r.target=S(j)?"_top":"_blank",document.body.appendChild(r),null!=r.addEventListener&&r.addEventListener("click",(function(e){null!=e.stopPropagation&&e.stopPropagation()}),!1));try{r.href=e,r.click()}catch(e){return void(null!=n&&n())}null!=t&&t()}function y(e,t,n){var i="OICFrame",r=document.getElementById(i);null==r&&((r=document.createElement("iframe")).className="ObjectInDialog",r.style.visibility="hidden",r.src="about:blank",document.body.appendChild(r),r.id=i);try{r.contentWindow.location.href=e}catch(e){return void(null!=n&&n())}null!=t&&t()}function C(e){return 0!=(e.Options&Ae.SkipProtocolHandler)||u()}function S(e){return 0!=(e.Options&Ae.SupportsTopTargetNavigation)}function b(e){return a()&&(e.Application==xe.OneNote||M(oe,!1)||M(ae,!1))}function v(e){return!C(e)&&(!!b(e)||(!!o()||(!!g()||(!(T()||"ActiveXObject"in window&&!n()||d())||W()>=15))))}function T(){return a()&&(p()||h())||p()}function A(e){return e===Te.ReadOnly||e===Te.ReadWrite}function I(e,t,i,o,a){var l,s,u,c;if(e==xe.Visio&&i==Te.ReadWrite&&(i=Te.WriteOnly),l=a,(o=o||n()&&!r())||(s="",s+=A(i)?de+ge:pe,l+=x(s+=he)),l+=x(t),null!=(u=function(e,t){var n,i,r=e.toLowerCase().indexOf("&"+t+"=");return-1==r?void 0:(n=r+(t.length+2),-1==(i=e.indexOf("&",n))?e.substr(n):e.substring(n,i))}(window.location.href,me))&&"undefined"!=typeof u){c="";try{c=decodeURIComponent(u)}catch(e){}c.length>0&&function(e){return RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(e)}(c)&&(l+=_e,l+=c)}return l}function w(e,t,n,i,r){var o=B(e);return null==o?(G(Ie.Unattempted,j.Application),!1):(m(I(e,t,n,i,o),E,F,r),!0)}function x(e){if(a()&&d()){var t="";try{t=decodeURI(e)}catch(e){}if(t==e)return encodeURI(e)}return e}function E(){H(we.ProtocolHandler)}function F(){j.Options|=Ae.SkipProtocolHandler,U(j,$,z)}function P(){null!=K&&K(we.RoamingProtocolHandler)}function D(){null!=q&&q(Ie.ControlNeeded)}function R(){var e,t,n=document.getElementById(se);if(null==n){if(e=ie,a()&&h()&&k(re)&&(e=re),!k(e)){if(!a()||!k(le))return null;e=le}(t=document.createElement("object")).id=se,t.type=e,t.style.width="0px",t.style.height="0px",t.style.setProperty("visibility","hidden",""),document.body.appendChild(t),n=document.getElementById(se)}return n}function M(e,t){var n,i=window.navigator.mimeTypes;return null!=i&&(!!(n=i[e])&&!(t&&!n.enabledPlugin))}function k(e){return M(e,!0)}function N(e){try{if(null!=new ActiveXObject(e))return!0}catch(e){}return!1}function L(e){switch(e){case xe.OneNote:return ce;default:return""}}function B(e){if(e!=xe.OneNote&&n()&&!r())return"office:";switch(e){case xe.Excel:return"ms-excel:";case xe.OneNote:return"onenote:";case xe.PowerPoint:return"ms-powerpoint:";case xe.Visio:return"ms-visio:";case xe.Word:return"ms-word:";case xe.Project:return"ms-project:";case xe.Publisher:return"ms-publisher:";case xe.Infopath:return"ms-infopath:";case xe.Access:return"ms-access:";default:return""}}function O(e){switch(e){case xe.Excel:return"root\\office15\\excel.exe";case xe.PowerPoint:return"root\\office15\\powerpnt.exe";case xe.Visio:return"root\\office15\\visio.exe";case xe.Word:return"root\\office15\\winword.exe";case xe.Project:return"root\\office15\\winproj.exe";case xe.Publisher:return"root\\office15\\mspub.exe";case xe.Infopath:return"root\\office15\\infopath.exe";case xe.Access:return"root\\office15\\msaccess.exe";default:return null}}function U(t,n,i){var r;if(j=t,$=n,z=i,t.DocumentUrl){var o=t.DocumentUrl,l=t.DocumentUrl,c=t.DocumentUrl;try{c=decodeURIComponent(t.DocumentUrl)}catch(e){}try{l=encodeURI(t.DocumentUrl)}catch(e){}if(t.Mode===Te.ReadWrite&&Ae.CheckoutRequired===(t.Options&Ae.CheckoutRequired)&&(t.Mode=Te.ForceCheckout),Ae.HostIsEditOnly===(t.Options&Ae.HostIsEditOnly)&&(t.Mode=Te.WriteOnly),v(t))w(t.Application,t.EncodeUrl?l:o,t.Mode,t.Application==xe.OneNote,t.SilentExternalHandler);else if(u()&&function(e,t,n,i){try{var r=new ActiveXObject(Z);if(r)return r.ViewDocument3(window.self,e,t,i)}catch(e){}return!1}(t.EncodeUrl?o:c,t.Mode,t.Options,L(t.Application)))H(we.O15ActiveX);else if(T()?r=function(e,t,n){var i,r=R();if(null==r)return Ie.Unattempted;i=!1;try{i=r.ViewDocument3(window.self,e,t,n)}catch(e){}if(!i)try{i=A(t)?r.ViewDocument2(window.self,e,n):r.EditDocument2(window.self,e,n)}catch(e){}return i?(H(we.NpapiPlugin),Ie.None):Ie.Failed}(t.EncodeUrl?o:c,t.Mode,L(t.Application)):(function(){try{var e=new ActiveXObject(ue);null!=e&&e.SaveSSOCreds()}catch(e){}}(),r=function(e,t,n,i){var r;try{if(r=new ActiveXObject(ee))return r.ViewDocument3(window.self,e,t,i)?(H(we.O14ActiveX),Ie.None):Ie.Failed}catch(e){}if(Ae.O14Only===(n&Ae.O14Only))return Ie.Unattempted;try{if(r=new ActiveXObject(te))return r.ViewDocument3(window.self,e,t,i)?(H(we.O12ActiveX),Ie.None):Ie.Failed}catch(e){}if(Ae.O12UpOnly===(n&Ae.O12UpOnly))return Ie.Unattempted;try{if(r=new ActiveXObject(ne))return(A(t)?r.ViewDocument2(window.self,e,i):r.EditDocument2(window.self,e,i))?(H(we.O11ActiveX),Ie.None):Ie.Failed}catch(e){}return Ie.Unattempted}(t.EncodeUrl?o:c,t.Mode,t.Options,L(t.Application))),r!=Ie.None){if(t.CouldUseRoamingApps&&e()&&t.Application!=xe.OneNote){if(!jC.ClientUtils.CanUseRoamingControl())return void G(Ie.ControlNeeded,j.Application);if(t.RoamingAppsLauncher)return void function(e){"undefined"!=typeof e.RoamingAppsLauncher&&null!=e.RoamingAppsLauncher?"undefined"==typeof e.RoamingBitsUrl||null==e.RoamingBitsUrl?jC.ClientUtils.LaunchRoamingApps(e.DocumentUrl,e.RoamingAppsLauncher,e.Application,e.ApplicationParameters,$,z):jC.ClientUtils.LaunchRoamingApps2(e.DocumentUrl,e.RoamingAppsLauncher,e.RoamingApplicationExe,e.ApplicationParameters,e.RoamingPlatform,e.RoamingBitsUrl,$,z):G(Ie.Unattempted,j.Application)}(t);if(!t.ContinueIfLauncherIsNull)return void G(Ie.LauncherNeeded,j.Application)}if(!(Ae.NoProtocolHandlerFallback==(t.Options&Ae.NoProtocolHandlerFallback)||C(t)||s()||a()&&r!=Ie.Unattempted))return void w(t.Application,t.EncodeUrl?l:o,t.Mode,t.Application==xe.OneNote,t.SilentExternalHandler);G(r,j.Application)}}else G(Ie.Unattempted,j.Application)}function H(e){null!=$&&$(e)}function G(e,t){"undefined"==typeof t&&(t=null),null!=z&&z(e,t)}function W(){var e,t=0;if(T()||d()){e=R();try{null!=e&&(t=e.GetOfficeVersion())}catch(e){}}else N(Z)?t=15:N(ee)?t=14:N(te)?t=12:N(ne)&&(t=11);return t}function V(){return a()&&(k(ie)||k(re))}var $,z,K,q,j,Q,J,X,Y,Z="SharePoint.OpenDocuments.5",ee="SharePoint.OpenDocuments.4",te="SharePoint.OpenDocuments.3",ne="SharePoint.OpenDocuments.2",ie="application/x-sharepoint",re="application/x-sharepoint-webkit",oe="application/x-sharepoint-protocolhandler",ae="application/x-sharepoint-webkit-protocolhandler",le="application/officelive",se="npSharePointPlugin",ue="IDBHO.IDBHOCtrl",ce="OneNote.Notebook",de="ofv|",ge="ofc|",pe="ofe|",he="u|",_e="|f|",me="wdlor",fe="RoamingOfficeActiveX.RoamingOffice",ye="application/x-vnd.officeondemand",Ce="office:",Se="",be="",ve="",Te={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Ae={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Ie={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5},we={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},xe={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Te,OpenDocumentOptions:Ae,OpenDocumentFailureType:Ie,OpenDocumentControl:we,OfficeApplication:xe,EditDocumentInClient:U,EditDocumentInClientParams:function(){this.DocumentUrl="",this.Mode=0,this.Options=0,this.Application=xe.Unknown,this.CouldUseRoamingApps=!1,this.RoamingAppsLauncher="",this.ContinueIfLauncherIsNull=!1,this.ApplicationParameters="",this.RoamingPlatform="",this.RoamingApplicationExe="",this.RoamingBitsUrl="",this.SilentExternalHandler=!1,this.EncodeUrl=!1},OfficeVersionInstalled:W,IsO14MacPluginInstalled:V,OfferOfficeInDialog:function(){return t()&&W()<=11},OfferOfficeNoIntrusive:function(){return t()&&W()<15},OfferMacOffice:function(){return a()&&!(window.navigator.userAgent.indexOf("PPC Mac")>=0)&&!V()},InstallRoamingControl:function(){c()?window.InstallTrigger.install({Office:{URL:be}}):y(ve,null,null)},CanUseRoamingControl:function(){var e,t;if(o())return!0;if(d())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),Boolean(navigator.mimeTypes[ye]);if(c())return e=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(e),(t=document.createEvent("Events")).initEvent("RoamingOfficeInstalled",!0,!1),e.dispatchEvent(t),Boolean(e.getAttribute("installed"));if(s())try{return new ActiveXObject(fe).HrExists()}catch(e){}return!1},InitUrls:function(e,t,n){Se=e,be=n,ve=t},LaunchRoamingApps:function(e,t,n,i,r,o){jC.ClientUtils.LaunchRoamingApps2(e,t,O(n),i,"x86",Se,r,o)},LaunchRoamingApps2:function(e,t,n,i,r,a,l,u){var g,p,h,_,f="";if(null!=i&&(f+=" "+i),null!=e&&(f+=' "'+e+'"'),o()||d())K=l,q=u,g=Ce,g+=' "'+a+'"',g+=' "'+n+'"',g+=' "ROAMING"',g+=' "'+t+'"',g+=' "'+r+'"',m(g+=" "+f,P,D,!1);else if(c())(p=document.createElement("RoamingExtensionElement")).setAttribute("cabUrl",a),p.setAttribute("app",n),p.setAttribute("licensingEntitlements",t),p.setAttribute("platform",r),p.setAttribute("args",f),document.documentElement.appendChild(p),(h=document.createEvent("Events")).initEvent("RoamingOfficeLaunch",!0,!1),p.dispatchEvent(h),null!=l&&l(we.RoamingFFExtension);else if(s()){if(null!=(_=new ActiveXObject(fe)))try{_.HrConfigureSingle(a,n,t,r,f),null!=l&&l(we.RoamingActiveX)}catch(e){}}else null!=u&&u(Ie.Failed)},ShouldShowDialog:function(){return!n()},NavigateToUrlUsingClickingOnATag:f,OpenDocumentWithProtocolHandler:w,OpenDocumentWithProtocolHandlerNoCallBack:function(e,t,n,i){var r=B(e);return null==r?(G(Ie.Unattempted,j.Application),!1):(m(I(e,t,n,i,r),null,null,!1),!0)}}}(),jC.ClientUtils=jC.ClientUtils;var JC=n(3147),XC=n(1842),YC=function(){function e(e,t){this._actionManager=null,this._hostPostmessengerFuture=null,this.hostPostmessenger=null,this._actionManager=e,this._hostPostmessengerFuture=t}return e.prototype.get_hostPostmessenger=function(){return this.hostPostmessenger},e.prototype.registerActions=function(){this._actionManager.addActionWithFlags(Fe.b.close,Ue.m.frame,o.i(this,this.closeDocument,"closeDocument"),2176),this._actionManager.addActionWithFlags(Fe.b.fileProperties,Ue.m.frame,o.i(this,this.fileProperties,"fileProperties"),128),this._actionManager.addAction(Fe.b.fileSharing,Ue.m.frame,o.i(this,this.fileSharing,"fileSharing")),this._actionManager.addActionWithFlags(Fe.b.copyAndEdit,Ue.m.frame,o.i(this,this.copyAndEdit,"copyAndEdit"),128),this._actionManager.addActionWithFlags(Fe.b.replyWithChanges,Ue.m.frame,o.i(this,this.replyWithChanges,"replyWithChanges"),128),this._actionManager.addActionWithFlags(Fe.b.showFileVersion,Ue.m.frame,o.i(this,this.fileVersion,"fileVersion"),128),this._actionManager.addAction(Fe.b.downloadACopy,Ue.m.frame,o.i(this,this.downloadACopy,"downloadACopy")),this._actionManager.addActionWithFlags(Fe.b.reportAbuseLink,Ue.m.frame,o.i(this,this.reportAbuseLink,"reportAbuseLink"),128),this._actionManager.addActionWithFlags(Fe.b.signIn,Ue.m.frame,o.i(this,this.signInInternal,"signInInternal"),128),this._actionManager.addAction(Fe.b.workflow,Ue.m.frame,o.i(this,this.workflow,"workflow")),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DocumentNameInJewelInfoMenuIsEnabled")&&this._actionManager.addActionWithFlags(Fe.b.queryBreadcrumbDocName,Ue.m.frame,o.i(this,this.queryBreadcrumbDocName,"queryBreadcrumbDocName"),96),this._actionManager.addActionWithFlags(Fe.b.queryCopyAndEditButton,Ue.m.frame,o.i(this,this.queryCopyAndEditButton,"queryCopyAndEditButton"),96),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DiagnosticsInfoInJewelAboutMenuIsEnabled")&&(this._actionManager.addActionWithFlags(Fe.b.queryBuildVersion,Ue.m.frame,o.i(this,this.queryBuildVersion,"queryBuildVersion"),2144),this._actionManager.addActionWithFlags(Fe.b.querySessionId,Ue.m.frame,o.i(this,this.querySessionId,"querySessionId"),2144)),this._actionManager.addAction(Fe.b.conversation,Ue.m.frame,o.i(this,this.conversation,"conversation")),this._hostPostmessengerFuture.execute(o.i(this,this.OnHostPostmessengerCreated,"OnHostPostmessengerCreated"))},e.prototype.OnHostPostmessengerCreated=function(e){this.hostPostmessenger=e},e.prototype.closeDocument=function(e,t,n,i,r){var o=2===n,a=Hi.z.unknown;return r&&(a=r),t&&o&&!this.beforeCloseDocument(a)?8:this.closeDocumentInternal(o,a)},e.prototype.beforeCloseDocument=function(e){return!0},e.prototype.closeDocumentInternal=function(e,t){if(L.AFrameworkApplication.get_activeFrame().get_applicationInstance().shouldCommandBeHostControlled("3033402446"))return S.ULS.sendTraceTag(41231952,306,50,"CloseDocumentInternal - Sending FileClose postMessage to give the host control of closing the page"),this.sendPostmessage(e,he.a.fileClose,!0,{});if(L.AFrameworkApplication.reportAbuseUrl&&t&&t===Hi.z.reportAbuseLink)return S.ULS.sendTraceTag(6070357,306,50,"CloseDocumentInternal - navigating to ReportAbuseUrl"),L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(e,L.AFrameworkApplication.reportAbuseUrl);if(L.AFrameworkApplication.get_isEmbedded())return e&&S.ULS.sendTraceTag(6070358,306,50,"CloseDocumentInternal - cannot close because application is embedded"),8;if(L.AFrameworkApplication.get_closeWindowOnAppClose()){if(!e)return 32;S.ULS.sendTraceTag(6070359,306,50,"CloseDocumentInternal - closing the window");try{return window.top.close(),32}catch(e){return S.ULS.sendTraceTag(6070360,306,10,"CloseDocumentInternal - encountered unexpected exception: {0}",e),8}}var n,i=L.AFrameworkApplication.closeUrl;return i?(t||(t=Hi.z.unknown),t===Hi.z.error||t===Hi.z.unknown?L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(e,i):L.AFrameworkApplication.replyWithChangesUrl?(e&&S.ULS.sendTraceTag(6070362,306,50,"CloseDocumentInternal - Using ReplyWithChanges postmessage"),32!==(n=t===Hi.z.fileMenuRWC||t===Hi.z.closeButton?this.sendPostmessage(e,he.a.replyWithChanges,L.AFrameworkApplication.useReplyWithChangesPostMessage,{event_source:t}):2)?(i=t?Oe.n.addOrReplaceParameterValue(L.AFrameworkApplication.replyWithChangesUrl,Hi.z.key,t):L.AFrameworkApplication.replyWithChangesUrl,L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(e,i)):n):(e&&S.ULS.sendTraceTag(6070363,306,50,"CloseDocumentInternal - Using FileClose postmessage"),32!==(n=t===Hi.z.closeButton?this.sendPostmessage(e,he.a.fileClose,L.AFrameworkApplication.useClosePostMessage,null):2)?L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(e,i):n)):(e&&S.ULS.sendTraceTag(6070361,306,50,"CloseDocumentInternal - no closeUrl found"),8)},e.prototype.signInInternal=function(e,t,n,i,r){var o=r,a=this.sendPostmessage(2===n,he.a.signIn,!0,o);return 8===a&&(window.top.location=L.AFrameworkApplication.signInUrl,a=32),a},e.prototype.fileProperties=function(e,t,n,i,r){var o=this.sendPostmessage(2===n,he.a.fileProperties,L.AFrameworkApplication.useFilePropertiesPostMessage,null);return 32!==o?L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(2===n,L.AFrameworkApplication.filePropertiesUrl):o},e.prototype.fileSharing=function(e,t,n,i,r){var o,a=r,l=ai.l.create().toString(),s={};s.event_source=a,s[En.t.shareCorrelation]=l;var u=r,c=u?u.nav:null;c&&(s[En.t.shareNavId]=c),u&&"CopyLink"===u.SourceControlId&&(u.mode="copy");var d=u?u.mode:null;if(d&&(s[En.t.shareMode]=d),2===n){var g={};g[En.t.shareCorrelation]=l,S.ULS.sendTraceTag(38278995,306,50,x.x.serialize(g))}var p=this.sendPostmessage(2===n,he.a.sharing,L.AFrameworkApplication.useFileSharingPostMessage,s);if(32!==p){if(L.AFrameworkApplication.fileSharingUrl)return o=a?Oe.n.addOrReplaceParameterValue(L.AFrameworkApplication.fileSharingUrl,Hi.z.key,a):L.AFrameworkApplication.fileSharingUrl,L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(2===n,o,!0);S.ULS.sendTraceTag(7985242,306,50,"Sharing PostMessage didn't succeed but there is no FileSharingURL to fallback to.",{Result:p})}return p},e.prototype.conversation=function(e,t,n,i,r){return this.sendPostmessage(2===n,he.a.conversation,!0,{})},e.prototype.workflow=function(e,t,n,i,r){var o=this.sendPostmessage(2===n,he.a.workflow,L.AFrameworkApplication.useWorkflowPostMessage,{WorkflowType:L.AFrameworkApplication.workflowTypeString});if(32!==o){if(L.AFrameworkApplication.workflowUrl)return L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(2===n,L.AFrameworkApplication.workflowUrl,!0);S.ULS.sendTraceTag(19781538,306,50,"Workflow PostMessage didn't succeed.",{Result:o})}return o},e.prototype.reportAbuseLink=function(e,t,n,i,r){var o=2===n;return t&&o&&!this.beforeCloseDocument(Hi.z.reportAbuseLink)?8:L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(o,L.AFrameworkApplication.reportAbuseUrl)},e.prototype.copyAndEdit=function(e,t,n,i,r){var o={};2===n&&(o=L.AFrameworkApplication.get_activeFrame().get_applicationInstance().getCopyAndEditParams());var a=this.sendPostmessage(2===n,he.a.copyAndEdit,L.AFrameworkApplication.useCopyAndEditPostMessage,o);return 32!==a?L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(2===n,L.AFrameworkApplication.copyAndEditUrl,L.AFrameworkApplication.hideHeader):a},e.prototype.downloadACopy=function(e,t,n,i,r){return 1===n?L.AFrameworkApplication.get_protectedFile()?8:32:L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(2===n,L.AFrameworkApplication.downloadACopyUrl,!0)},e.prototype.replyWithChanges=function(e,t,n,i,r){var o=2===n;if(t&&o&&!this.beforeCloseDocument(Hi.z.fileMenuRWC))return 8;var a=this.sendPostmessage(o,he.a.replyWithChanges,L.AFrameworkApplication.useReplyWithChangesPostMessage,{event_source:Hi.z.fileMenuRWC});if(32!==a){var l=Oe.n.addOrReplaceParameterValue(L.AFrameworkApplication.replyWithChangesUrl,Hi.z.key,Hi.z.fileMenuRWC);return L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(o,l)}return a},e.prototype.fileVersion=function(e,t,n,i,r){var o=this.sendPostmessage(2===n,he.a.fileVersions,L.AFrameworkApplication.useFileVersionPostMessage,null);return 32!==o?L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(2===n,L.AFrameworkApplication.fileVersionUrl):o},e.prototype.queryBreadcrumbDocName=function(e,t,n,i,r){if(2===n){if(!r)return 8;var o=r,a=L.AFrameworkApplication.docPropertiesProvider.get_breadcrumbDocName();o.Value=Rn.l.getFileNameWithoutExtension(a)}return 32},e.prototype.queryBuildVersion=function(e,t,n,i,r){if(2===n){if(!r)return 8;r.Text=L.AFrameworkApplication.get_instance().get_diagnosticsBuildVersion()}return 32},e.prototype.querySessionId=function(e,t,n,i,r){if(2===n){if(!r)return 8;r.Text=L.AFrameworkApplication.get_instance().get_diagnosticsSessionId()}return 32},e.prototype.sendPostmessage=function(e,t,n,i){return n?e?this.get_hostPostmessenger().sendMessage(t,i)?32:8:32:2},e.prototype.queryCopyAndEditButton=function(e,t,n,i,r){if(2===n){if(!r)return 8;var o=r;L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsEditAndReplyFlow")&&(o.LabelText=CommonUIStrings.l_EditAndReply)}return 32},e}();(0,o.l)(YC,"642c8078$WebAppFrameCommandUIActor",null,[]);var ZC=function(){function e(e,t,n){this._actionManager=null,this._isMacOfficeTrialOfferEnabled=!1,this._lcid=0,this._actionManager=e,this._isMacOfficeTrialOfferEnabled=t,this._lcid=n}return e.prototype.registerActions=function(){this._actionManager.addAction(Fe.b.tryMacOffice,Ue.m.frame,o.i(this,this.OnTryMacOffice,"OnTryMacOffice")),this._actionManager.addAction(Fe.b.tryMacOfficeFromWordViewer,Ue.m.frame,o.i(this,this.OnTryMacOfficeFromViewer,"OnTryMacOfficeFromViewer")),this._actionManager.addAction(Fe.b.tryMacOfficeFromPowerPointViewer,Ue.m.frame,o.i(this,this.OnTryMacOfficeFromViewer,"OnTryMacOfficeFromViewer"))},e.prototype.OnTryMacOffice=function(e,t,n,i,r){if(1===n)return 32;if(r){var o=r.SourceControlId;"btnjTryMacOfficeForWordEditor"===o?window.open(Oe.n.getFwLinkForUpsellFeatures(12),"_blank"):"PptJewel.About.TryMacOffice"===o&&window.open(Oe.n.getFwLinkForUpsellFeatures(22),"_blank")}else this.launchMacOfficeTrialWindow();return 32},e.prototype.OnTryMacOfficeFromViewer=function(e,t,n,i,r){if(1===n)return 32;switch(e){case Fe.b.tryMacOfficeFromWordViewer:window.open(Oe.n.getFwLinkForUpsellFeatures(15),"_blank");break;case Fe.b.tryMacOfficeFromPowerPointViewer:window.open(Oe.n.getFwLinkForUpsellFeatures(25),"_blank")}return 32},e.prototype.launchMacOfficeTrialWindow=function(t){void 0===t&&(t=null);var n=0;t&&(n=t);var i=2===n?e.OneNoteMacTrialTarget:e.get_macOfficeTrialTarget();window.open(i,"_blank")},e.prototype.get_ShouldOfferMacOfficeTrial=function(){return this._isMacOfficeTrialOfferEnabled&&W.y.get_isMac()&&!W.y.get_isPpcMac()&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()},e.prototype.get_shouldOfferMacOfficeTrialInFileMenu=function(){var t=this.get_ShouldOfferMacOfficeTrial();return t||L.AFrameworkApplication.theWsaClient.setBool(e.DATAID_WACC2RBUTTONTRIMMED,1),t},e.prototype.get_shouldOfferMacOfficeTrialInErrorDialog=function(){return this.get_ShouldOfferMacOfficeTrial()},e.get_macOfficeTrialTarget=function(){return Oe.n.getFwLinkUrl(e.MacOfficeTrialTargetFwLinkId)},e.DATAID_WACC2RBUTTONTRIMMED=9124,e.MacOfficeTrialTargetFwLinkId="522401",e.OneNoteMacTrialTarget="https://go.microsoft.com/fwlink/?LinkId=331579",e}();(0,o.l)(ZC,"9e9c6dfa$MacOfficeOffer",null,[XC.u]);var eS=function(){function e(e,t,n){this._actionManager=null,this._isOfficeTrialOfferEnabled=!1,this._lcid=0,this._actionManager=e,this._isOfficeTrialOfferEnabled=t,this._lcid=n}return e.prototype.registerActions=function(){this._actionManager.addAction(Fe.b.tryOffice,Ue.m.frame,o.i(this,this.OnTryOffice,"OnTryOffice")),this._actionManager.addAction(Fe.b.tryOfficeThroughTellMe,Ue.m.frame,o.i(this,this.TryOfficeThroughTellMe,"TryOfficeThroughTellMe")),this._actionManager.addAction(Fe.b.tryOfficeFromWordViewer,Ue.m.frame,o.i(this,this.TryOfficeThroughViewer,"TryOfficeThroughViewer")),this._actionManager.addAction(Fe.b.tryOfficeFromPowerPointViewer,Ue.m.frame,o.i(this,this.TryOfficeThroughViewer,"TryOfficeThroughViewer"))},e.prototype.OnTryOffice=function(e,t,n,i,r){if(2===n)if(r){var o=r.SourceControlId;"btnjTryOfficeForWordEditor"===o?window.open(Oe.n.getFwLinkForUpsellFeatures(11),"_blank"):"PptJewel.About.TryOffice"===o?window.open(Oe.n.getFwLinkForUpsellFeatures(21),"_blank"):this.launchOffer()}else this.launchOffer();return 32},e.prototype.TryOfficeThroughTellMe=function(t,n,i,r,o){if(2===i)if(o){var a=o.SourceControlId;window.open(Oe.n.getFwLinkUrl(e.OfficeTrialTargetFwLinkId)+this.GetParameterForTellMeFeatures(a),"_blank")}else window.open(Oe.n.getFwLinkUrl(e.OfficeLegacyTrialTargetFwLinkId),"_blank");return 32},e.prototype.TryOfficeThroughViewer=function(e,t,n,i,r){if(2===n)switch(e){case Fe.b.tryOfficeFromWordViewer:window.open(Oe.n.getFwLinkForUpsellFeatures(14),"_blank");break;case Fe.b.tryOfficeFromPowerPointViewer:window.open(Oe.n.getFwLinkForUpsellFeatures(24),"_blank")}return 32},e.prototype.get_offerOfficeTrialInFileMenu=function(){return this.get_ShouldOfferOfficeTrial()},e.prototype.get_offerOfficeTrialInDialog=function(){return this.get_ShouldOfferOfficeTrial()&&MSOJS.ClientUtils.OfferOfficeInDialog()},e.prototype.get_ShouldOfferOfficeTrial=function(){return this._isOfficeTrialOfferEnabled&&!W.y.get_isMac()},e.prototype.launchOffer=function(t){void 0===t&&(t=null);var n=0;t&&(n=t),window.open(e.GetLinkForPlatformAndApplication(n),"_blank")},e.prototype.GetParameterForTellMeFeatures=function(e){var t=0;switch(e){case"jbtnTryOfficeThroughTellMeForWordTrackChanges":t=1;break;case"jbtnTryOfficeThroughTellMeForWordShapes":t=2;break;case"jbtnTryOfficeThroughTellMeForWordLabel":t=3;break;case"jbtnTryOfficeThroughTellMeForWordCitations":t=4;break;case"jbtnTryOfficeThroughTellMeForWordTextBox":t=5;break;case"jbtnTryOfficeThroughTellMeForWordTableOfContent":t=6;break;case"jbtnTryOfficeThroughTellMeForWordSmartArt":t=7;break;case"jbtnTryOfficeThroughTellMeForWordWordArt":t=8;break;case"jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":t=9;break;case"jbtnTryOfficeThroughTellMeForWordEquation":t=10;break;case"jbtnTryOfficeThroughTellMeForPPTGroupShapes":t=16;break;case"jbtnTryOfficeThroughTellMeForPPTWordArt":t=17;break;case"jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":t=18;break;case"jbtnTryOfficeThroughTellMeForPPTInsertAudio":t=19;break;case"jbtnTryOfficeThroughTellMeForPPTInsertChart":t=20;break;case"TellMe.TryOfficeThroughTellMeForXLSSpellCheck":t=26;break;case"TellMe.TryOfficeThroughTellMeForXLSMacros":t=27;break;case"TellMe.TryOfficeThroughTellMeForXLSPivotTable":t=28;break;case"TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":t=29}return t?String.format("&pc={0:D}",t):""},e.GetLinkForPlatformAndApplication=function(t){if(W.y.get_isIPad())switch(t){case 1:return Oe.n.getFwLinkUrl(e.IpadExcelFwLinkId);case 2:return Oe.n.getFwLinkUrl(e.IpadOneNoteFwLinkId);case 3:return Oe.n.getFwLinkUrl(e.IpadPowerPointFwLinkId);case 5:return Oe.n.getFwLinkUrl(e.IpadWordFwLinkId)}else if(W.y.get_isAndroid())switch(t){case 1:return Oe.n.getFwLinkUrl(e.AndroidExcelFwLinkId);case 3:return Oe.n.getFwLinkUrl(e.AndroidPowerPointFwLinkId);case 5:return Oe.n.getFwLinkUrl(e.AndroidWordFwLinkId);case 2:return Oe.n.getFwLinkUrl(e.AndroidOneNoteFwLinkId)}else{if(2===t)return Oe.n.getFwLinkUrl(e.OneNoteDownloadFwLinkId);if(1===t)return Oe.n.getFwLinkForUpsellFeatures(30)}return Oe.n.getFwLinkUrl(e.OfficeLegacyTrialTargetFwLinkId)},e.OfficeTrialTargetFwLinkId="862405",e.OfficeLegacyTrialTargetFwLinkId="522402",e.IpadExcelFwLinkId="393806",e.IpadOneNoteFwLinkId="393810",e.IpadPowerPointFwLinkId="393809",e.IpadWordFwLinkId="393805",e.OneNoteDownloadFwLinkId="517778",e.AndroidExcelFwLinkId="521979",e.AndroidPowerPointFwLinkId="521980",e.AndroidWordFwLinkId="521978",e.AndroidOneNoteFwLinkId="522490",e}();(0,o.l)(eS,"9dfed991$OfficeTrialExperience",null,[JC.v]);var tS=function(){function e(){}return e.prototype.configure=function(e){e.register(eS).as(JC.v).singleInstance().usingFactory((function(){return new eS(L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.isOfficeTrialOfferEnabled,L.AFrameworkApplication.lcid)})),e.register(ZC).as(XC.u).singleInstance().usingFactory((function(){return new ZC(L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.isMacOfficeTrialOfferEnabled,L.AFrameworkApplication.lcid)}))},e}();(0,o.l)(tS,"47059277$OpenInClientConfiguration",null,[u.s]);var nS=n(7386),iS=n(2071),rS=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,CommonUIStrings.l_OICLaunchDialogTitle)},e.DialogHtmlFormat="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>",e}();(0,o.l)(rS,"b9244f44$OICLaunchDialogHtml",null,[]);var oS=function(){function e(){}return e.centerLabel=function(e){for(var t=0;t<e.children.length;t++){var n=e.children[t];n.style.position="relative",n.style.top=(n.parentNode.offsetHeight-n.offsetHeight)/2+"px"}},e.onKeyUpHandler=function(e){return(e.innerEvent.keyCode===Re.v.vK_Enter||e.innerEvent.keyCode===Re.v.vK_Space)&&(e.get_sourceElement().click(),!0)},e.createDialogButton32=function(t,n,i,r,o,a,l){var s=document.createElement("a");s.className="ProtocolLaunchingDialogButtonAnchor",s.className+=" OICDialog",s.id=t,s.setAttribute(vt.t.ariaRoleAttribute,vt.t.ariaButtonRole),s.style.padding="0",s.style.margin="0",r&&e.appendIcon(o,n,i,r,s);var u=document.createElement("span");return u.className="ProtocolLaunchingDialogButtonLabel",u.innerText=o,s.appendChild(u),s.tabIndex=0,a&&Xt.s.get_instance().registerHandler(me.d.click,s,a),l&&Me.KeyInputManager.get_instance().registerHandler(me.d.keyUp,s,l),s},e.appendIcon=function(e,t,n,i,r){var o=document.createElement("img");o.alt=e,o.className=Ct.ImageClusteringHelper.getImageClassWithCluster(n,i),o.src=t,o.setAttribute(vt.t.ariaRoleAttribute,vt.t.ariaPresentationRole);var a=document.createElement("span");a.className="ProtocolLaunchingDialogImg32Container",a.appendChild(o);var l=document.createElement("span");l.className="ProtocolLaunchingDialogIconContainer",l.appendChild(a),r.appendChild(l)},e}();(0,o.l)(oS,"85cc77f7$OICDialogUtils",null,[]);var aS=function(e){function t(n){var i=this;return i._operation=null,i._btnRichClient=null,i._btnReturn=null,i._disposed$4=!1,(i=e.call(this)||this)._operation=n,i.set_dialogHtml(rS.get_dialogHtml()),i.set_autoSize(!0),i.set_buttonsOption(5),i.set_dialogId(t.Id),i.showDialog("",o.i(i,i.OICLaunchDialogResultHandler,"OICLaunchDialogResultHandler")),i.setLabelledByForDialog(t.ProtocolLaunchingDialogTitleId),i.setDescribedByForDialog(t.ProtocolLaunchingDialogTitleId),4!==L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_editMode()&&(document.getElementById(t.ProtocolLaunchingDialogTitleId).innerText=CommonUIStrings.l_OICLaunchDialogTitleForView),i.setFocusOnElement(i._btnRichClient),S.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened"),document.getElementById("WACDialogTitlePanel").className+=" OICDialog",i}return(0,v.t)(t,e),t.prototype.onInnerHtmlSet=function(){this._btnRichClient=oS.createDialogButton32("BtnRichClient",this._operation.get_dlgImgClusterPath(),this._operation.get_imgClusterName(),this._operation.get_imgBtnGetRichClient(),CommonUIStrings.l_OICLaunchRichClient,o.i(this,this.OnRichClientButtonClick,"OnRichClientButtonClick"),oS.onKeyUpHandler),document.getElementById("OICLaunchRichClient").appendChild(this._btnRichClient),oS.centerLabel(this._btnRichClient),this._btnReturn=oS.createDialogButton32("BtnReturn",this._operation.get_dlgImgClusterPath(),this._operation.get_imgClusterName(),this._operation.get_imgBtnEdit(),CommonUIStrings.l_OICReturnToOnlineClient,o.i(this,this.OnReturnButtonClick,"OnReturnButtonClick"),oS.onKeyUpHandler),document.getElementById("OICReturnToApp").appendChild(this._btnReturn),oS.centerLabel(this._btnReturn)},t.prototype.OnReturnButtonClick=function(e){return this.hide(),this._operation.get_suppressRestartAfterOpenInClientTriggered()||this._operation.restartApplication(),!0},t.prototype.OnRichClientButtonClick=function(e){return S.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client"),this.hide(),L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.retryOpenInClient,2),!0},t.prototype.OICLaunchDialogResultHandler=function(e,t){this._operation.get_suppressRestartAfterOpenInClientTriggered()||this._operation.restartApplication()},t.prototype.dispose=function(){this._disposed$4||(this._btnRichClient&&(Xt.s.get_instance().unregisterHandler(me.d.click,this._btnRichClient,o.i(this,this.OnRichClientButtonClick,"OnRichClientButtonClick")),Me.KeyInputManager.get_instance().unregisterHandler(me.d.keyUp,this._btnRichClient,oS.onKeyUpHandler)),this._btnReturn&&(Xt.s.get_instance().unregisterHandler(me.d.click,this._btnReturn,o.i(this,this.OnReturnButtonClick,"OnReturnButtonClick")),Me.KeyInputManager.get_instance().unregisterHandler(me.d.keyUp,this._btnReturn,oS.onKeyUpHandler)),e.prototype.dispose.call(this),this._disposed$4=!0)},t.ProtocolLaunchingDialogTitleId="ProtocolLaunchingDialogTitle",t.Id="OICLaunchDialog",t}(Bi.o);(0,o.l)(aS,"46896e3d$OICLaunchDialog",Bi.o,[]);var lS=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,CommonUIStrings.l_OICDialogTitle)},e.DialogHtmlFormat="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>",e}();(0,o.l)(lS,"a3947b3$ProtocolLaunchingDialogV2Html",null,[]);var sS=n(9847),uS=function(e){function t(n){var i=this;return i._operation=null,i._btnEdit=null,i._btnGiveFeedback=null,i._disposed$4=!1,i._btnRetryOIC=null,(i=e.call(this)||this)._operation=n,i.set_dialogHtml(lS.get_dialogHtml()),i.set_autoSize(!0),i.set_buttonsOption(5),i.set_dialogId(t.Id),i._customCssClass="OICRetryDialog",L.AFrameworkApplication.get_theTaskManager().get_hasStopped()&&L.AFrameworkApplication.get_theTaskManager().restart(),i._operation.get_suppressRestartAfterOpenInClientTriggered()?L.AFrameworkApplication.get_theTaskManager().addTask(new ge.c(2,1,t.DismissOICDialogTimeInMs,(function(e){i.DismissProtocolLaunchingDialog()}))):L.AFrameworkApplication.get_theTaskManager().addTask(new ge.c(2,1,t.RetryButtonDelayTimeInMs,(function(e){i.switchToBackupMode()}),101)),i.showDialog("",o.i(i,i.ProtocolLaunchingDialogResultHandler,"ProtocolLaunchingDialogResultHandler")),i.setLabelledByForDialog(t.ProtocolLaunchingDialogTitleId),i.setDescribedByForDialog(t.IssuesId),i.FocusOnEditButton(),S.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched"),document.getElementById("WACDialogTitlePanel").className+=" OICDialog",i}return(0,v.t)(t,e),t.prototype.onInnerHtmlSet=function(){var e=document.getElementById("Issues");if(e){oS.appendIcon("",this._operation.get_dlgImgClusterPath(),this._operation.get_imgClusterName(),this._operation.get_imgBtnGetRichClient(),e);var t=document.createElement("span");t.className="WACDialogSectionTitle",t.innerText=5===this._operation.get_openDocumentMode()?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle,e.appendChild(t),oS.centerLabel(e),e.style.display="none"}if(L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_giveFeedbackOnOpenClient()){var n=CommonUIStrings.l_OICDialogSectionGiveFeedback;this._btnGiveFeedback=oS.createDialogButton32("GiveFeedback",this._operation.get_dlgImgClusterPath(),this._operation.get_imgClusterName(),"",n,o.i(this,this.OnGiveFeedbackClick,"OnGiveFeedbackClick"),o.i(this,this.OnGiveFeedbackKeyUp,"OnGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this._btnGiveFeedback),oS.centerLabel(this._btnGiveFeedback)}else document.getElementById("ButtonGiveFeedback").style.display="none";if(L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_editMode()&&!L.AFrameworkApplication.get_disableEditIfAndroid()){var i=null;if(i=2===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()?4===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_editMode()?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:this._operation.get_suppressRestartAfterOpenInClientTriggered()?CommonUIStrings.l_DialogOk:4===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_editMode()?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,this._btnEdit=oS.createDialogButton32("Edit",this._operation.get_dlgImgClusterPath(),this._operation.get_imgClusterName(),"",i,o.i(this,this.OnEditClick,"OnEditClick"),o.i(this,this.OnEditKeyUp,"OnEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this._btnEdit),oS.centerLabel(this._btnEdit),this._operation.get_suppressRestartAfterOpenInClientTriggered()){document.getElementById("Buttons").style.textAlign="right",document.getElementById("Edit").style.textAlign="center";var r=document.getElementById(this.myId("WACDialogButtonPanel"));r&&(r.style.display="none",this.set_buttonsOption(5))}}else document.getElementById("ButtonEdit").style.display="none";L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_editMode()||L.AFrameworkApplication.isOfficeTrialOfferEnabled||e&&(e.style.display="none")},t.prototype.FocusOnRetryButton=function(){return!!this._btnRetryOIC&&(this.setFocusOnElement(this._btnRetryOIC),!0)},t.prototype.FocusOnEditButton=function(){return!!this._btnEdit&&(this.setFocusOnElement(this._btnEdit),!0)},t.prototype.OnFinishedClick=function(e){return this._operation.closeApplication(),!0},t.prototype.OnEditKeyUp=function(e){return this.OnBtnKeyUp(e,0)},t.prototype.OnGiveFeedbackKeyUp=function(e){return this.OnBtnKeyUp(e,2)},t.prototype.OnRetryOICKeyUp=function(e){return this.OnBtnKeyUp(e,1)},t.prototype.OnBtnKeyUp=function(e,t){var n=!1;if(e.innerEvent.keyCode===Re.v.vK_Enter||e.innerEvent.keyCode===Re.v.vK_Space)e.get_sourceElement().click(),n=!0;else if(e.innerEvent.keyCode===Sys.UI.Key.down||e.innerEvent.keyCode===Sys.UI.Key.up)switch(t){case 1:n=this.FocusOnEditButton();break;case 0:n=this.FocusOnRetryButton()}return n},t.prototype.OnEditClick=function(e){return this.hide(),4===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_editMode()?this._operation.get_suppressRestartAfterOpenInClientTriggered()||(S.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this._operation.restartApplication()):(S.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this._operation.handleEditInBrowser()),!0},t.prototype.OnGiveFeedbackClick=function(e){return S.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog"),this._operation.handleGiveFeedback(),!0},t.prototype.OnGetRichClientClick=function(e){var t=Ge.w.get_instance().resolve(JC.v),n=Ge.w.get_instance().resolve(XC.u);return W.y.get_isMac()?n.launchMacOfficeTrialWindow(this._operation.application):t.launchOffer(this._operation.application),!0},t.prototype.OnLearnMoreClick=function(e){return sS.Redirect.showHelp("OICFailure"),!0},t.prototype.OnRetryOICClick=function(e){return S.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry"),document.getElementById("WACDialogPanel").style.display="none",L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.retryOpenInClient,2),!0},t.prototype.ProtocolLaunchingDialogResultHandler=function(e,t){this._operation.get_suppressRestartAfterOpenInClientTriggered()||this._operation.restartApplication()},t.prototype.switchToBackupMode=function(){var e=document.getElementById("ProtocolLaunchingDialogTitle");if(e){this._operation.get_suppressRestartAfterOpenInClientTriggered()?e.innerText="":e.innerText=CommonUIStrings.l_OICDialog2ndTitle;var t=document.getElementById("Issues");if(t&&(t.style.display="block"),this._operation.get_suppressRestartAfterOpenInClientTriggered()){var n=document.getElementById("ButtonRetryOIC");n&&(n.style.display="none")}else{var i=document.getElementById("ProtocolHandlerDialogRetryOIC");i&&!i.children.length&&(this._btnRetryOIC=oS.createDialogButton32("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,o.i(this,this.OnRetryOICClick,"OnRetryOICClick"),o.i(this,this.OnRetryOICKeyUp,"OnRetryOICKeyUp")),i.appendChild(this._btnRetryOIC),oS.centerLabel(this._btnRetryOIC),this._btnEdit||this.FocusOnRetryButton())}}},t.prototype.DismissProtocolLaunchingDialog=function(){document.getElementById("ProtocolLaunchingDialogTitle")&&(S.ULS.sendTraceTag(50857158,211,50,"OIC dialog auto hidden after client launched"),this.hide())},t.prototype.dispose=function(){this._disposed$4||(this._btnEdit&&(Xt.s.get_instance().unregisterHandler(me.d.click,this._btnEdit,o.i(this,this.OnEditClick,"OnEditClick")),Me.KeyInputManager.get_instance().unregisterHandler(me.d.keyUp,this._btnEdit,o.i(this,this.OnEditKeyUp,"OnEditKeyUp"))),this._btnGiveFeedback&&(Xt.s.get_instance().unregisterHandler(me.d.click,this._btnGiveFeedback,o.i(this,this.OnGiveFeedbackClick,"OnGiveFeedbackClick")),Me.KeyInputManager.get_instance().unregisterHandler(me.d.keyUp,this._btnGiveFeedback,o.i(this,this.OnGiveFeedbackKeyUp,"OnGiveFeedbackKeyUp"))),this._btnRetryOIC&&(Xt.s.get_instance().unregisterHandler(me.d.click,this._btnRetryOIC,o.i(this,this.OnRetryOICClick,"OnRetryOICClick")),Me.KeyInputManager.get_instance().unregisterHandler(me.d.keyUp,this._btnRetryOIC,o.i(this,this.OnRetryOICKeyUp,"OnRetryOICKeyUp"))),e.prototype.dispose.call(this),this._disposed$4=!0)},t.RetryButtonDelayTimeInMs=5e3,t.DismissOICDialogTimeInMs=5e3,t.ProtocolLaunchingDialogTitleId="ProtocolLaunchingDialogTitle",t.Id="ProtocolLaunchingDialog",t.IssuesId="Issues",t}(Bi.o);(0,o.l)(uS,"234dab8e$ProtocolLaunchingDialog",Bi.o,[]);var cS=function(){return function(){}}();(0,o.l)(cS,"c406d17f$EditDocumentInClientParams",null,[]);var dS=function(){function e(){}return e.editDocumentInClient=function(e,t,n,i,r,o,a,l){void 0===a&&(a=!1),void 0===l&&(l=!1);var s=new cS;s.DocumentUrl=e,s.Mode=t,s.Options=n,s.Application=i,s.SilentExternalHandler=a,s.EncodeUrl=l,MSOJS.ClientUtils.EditDocumentInClient(s,r,o)},e.get_isWLSIAInstalled=function(){try{if(new ActiveXObject(e.WLSIAProgId))return!0}catch(e){}return!1},e.get_officeVersionInstalledSupportsOIC=function(){return MSOJS.ClientUtils.OfficeVersionInstalled()>11},e.WLSIAProgId="IDBHO.IDBHOCtrl",e}();(0,o.l)(dS,"193728e0$ClientUtils",null,[]);var gS=function(){function e(e){this._clientUrl=null,this._downloadUrl=null,this._postmessengerlazy=null,this._forceClose=!1,this._officeTrialExperience=null,this._macOfficeOffer=null,this._mode=0,this.silentExternalHandler=!1,this.application=0,this.suppressClose=!1,this.suppressRestart=!1,this.useLaunchDialog=!1,this.useLaunchDialog=e&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OICLaunchDialogIsEnabled"),L.AFrameworkApplication.get_theActionManager().getActionMetadata(Fe.b.retryOpenInClient)||L.AFrameworkApplication.get_theActionManager().addAction(Fe.b.retryOpenInClient,Ue.m.frame,o.i(this,this.RetryOpenInClientAction,"RetryOpenInClientAction")),this.silentExternalHandler=!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SilentExternalHandler")}return e.prototype.get_openDocumentMode=function(){return this._mode},e.prototype.RetryOpenInClientAction=function(e,t,n,i,r){return t.get_contextId()!==Ue.m.frame?2:1===n?32:this.retryOpenInClient()},e.prototype.get_options=function(){var e=0;return L.AFrameworkApplication.get_requiresCheckout()&&(e|=1),L.AFrameworkApplication.openInClientEditOnly&&(e|=4),this.SupportsTopTargetNavigation()&&(e|=64),e},e.prototype.SupportsTopTargetNavigation=function(){return!(2===this.application&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsEmbeddedScenario"))},e.prototype.get_openInClientCommandString=function(){return null},e.prototype.get_dlgImgClusterPath=function(){return L.AFrameworkApplication.get_imageClusterPath()},e.prototype.get_imgClusterName=function(){return L.AFrameworkApplication.get_imageClusterName()},e.prototype.get_imgBtnFinished=function(){return"ImFinished_32x32x32"},e.prototype.get_imgBtnEdit=function(){return""},e.prototype.get_imgBtnGetRichClient=function(){return""},e.prototype.get_suppressProtocolHandlerDialog=function(){return!1},e.prototype.get_suppressRestartAfterOpenInClientTriggered=function(){return!1},e.prototype.get_theOfficeTrialExperience=function(){return this._officeTrialExperience||(this._officeTrialExperience=Ge.w.get_instance().resolve(JC.v))},e.prototype.get_theMacOfficeOffer=function(){return this._macOfficeOffer||(this._macOfficeOffer=Ge.w.get_instance().resolve(XC.u))},e.prototype.closeApplication=function(){this.suppressClose||this.executeCloseApplication()},e.prototype.restartApplication=function(){this.suppressRestart||this.executeRestartApplication()},e.prototype.readyForClientLaunch=function(e){return this.useLaunchDialog&&W.y.get_isIPad()?(new aS(this),32):this.completeClientLaunch(e)},e.prototype.completeClientLaunch=function(e){var t,n=this.LaunchClient(e,(0,g.m)((function(){return t}),(function(e){return t=e})));return S.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===n,t),n},e.prototype.begin=function(e,t,n,i,r,o){return this._clientUrl=e,this._downloadUrl=t,this._postmessengerlazy=o,this.application=n,this._mode=i,L.AFrameworkApplication.downloadCopyOnOpenInClient?(this.launchDownload(),32):L.AFrameworkApplication.limitedEdit&&!L.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?(L.AFrameworkApplication.showRequiresSignInDialog(),8):this.beforeClientLaunch(r)},e.prototype.retryOpenInClient=function(){return this.completeClientLaunch(this._forceClose)},e.prototype.SendOICPostMessage=function(){var e=new ul.f(he.a.openInClient);return e.Values["ui-language"]=L.AFrameworkApplication.lcid.toString(),e.Values[sl.a.currentSessionParamName]=L.AFrameworkApplication.userSessionId,this._postmessengerlazy.get_value().send(e)?32:8},e.prototype.SendTelemetryPostMessage=function(e){var t=new ul.f(he.a.wacActionComplete);t.Values["ui-language"]=L.AFrameworkApplication.lcid.toString(),t.Values[sl.a.currentSessionParamName]=L.AFrameworkApplication.userSessionId,t.Values[En.t.wacAction]=e,this._postmessengerlazy.get_value().send(t)},e.prototype.LaunchClient=function(t,n){return this._forceClose=t,this.SendTelemetryPostMessage(5===this._mode?e.openInBrowserAction:e.openInDesktopAction),5===this._mode?this.LaunchBrowser(n):this.LaunchDesktop(n)},e.prototype.LaunchBrowser=function(e){return e.val="",new uS(this),e.val+="HostEditUrl,",32},e.prototype.LaunchDesktop=function(e){if(e.val="",L.AFrameworkApplication.preferPostMessageOverCommandUrlForOpenInClient){e.val+="NewOrder,";var t=8;return this._postmessengerlazy&&this._postmessengerlazy.get_value()&&this._postmessengerlazy.get_value().isEnabled()&&L.AFrameworkApplication.useOpenInClientPostMessage&&(e.val+="Post,",t=this.SendOICPostMessage()),32===t?t:(S.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),L.AFrameworkApplication.docPropertiesProvider.get_openInClientCommandUrl()?(S.ULS.shipAssertTag(5566816,211,!!L.AFrameworkApplication.docPropertiesProvider.get_openInClientCommandUrl()),e.val+="HostUrl,",L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(!0,L.AFrameworkApplication.docPropertiesProvider.get_openInClientCommandUrl())):this._clientUrl?(S.ULS.sendTraceTag(18715405,211,50,"Try to open doc in rich client"),e.val+="DocUrl,",dS.editDocumentInClient(this._clientUrl,this._mode,this.get_options(),this.application,o.i(this,this.onEditInClientSuccess,"onEditInClientSuccess"),o.i(this,this.onEditInClientFailure,"onEditInClientFailure"),this.silentExternalHandler,L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OICEncodeUrlIsEnabled")),32):8)}if(e.val+="OldOrder,",!this._clientUrl&&L.AFrameworkApplication.docPropertiesProvider.get_openInClientCommandUrl()){t=void 0;return this._postmessengerlazy&&this._postmessengerlazy.get_value()&&this._postmessengerlazy.get_value().isEnabled()&&L.AFrameworkApplication.useOpenInClientPostMessage?(e.val+="Post,",t=this.SendOICPostMessage()):(S.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),t=8),32!==t?(S.ULS.shipAssertTag(22595484,211,!!L.AFrameworkApplication.docPropertiesProvider.get_openInClientCommandUrl()),e.val+="HostUrl,",L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(!0,L.AFrameworkApplication.docPropertiesProvider.get_openInClientCommandUrl())):t}return S.ULS.sendTraceTag(22595485,211,50,"Try to open doc in rich client"),e.val+="DocUrl,",dS.editDocumentInClient(this._clientUrl,this._mode,this.get_options(),this.application,o.i(this,this.onEditInClientSuccess,"onEditInClientSuccess"),o.i(this,this.onEditInClientFailure,"onEditInClientFailure"),this.silentExternalHandler,L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OICEncodeUrlIsEnabled")),32},e.prototype.reportControlUsed=function(t){L.AFrameworkApplication.theWsaClient.setDw(e.OpenInRichClientDatapointId,t)},e.prototype.onEditInClientSuccess=function(e){this.reportControlUsed(e),S.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed"),6===e&&MSOJS.ClientUtils.ShouldShowDialog()?this.get_suppressProtocolHandlerDialog()||new uS(this):this.suppressClose||this.closeApplication()},e.prototype.onEditInClientFailure=function(e,t){if(void 0===t&&(t=0),S.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0}, Application: {1}",e,t),5===e)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{var n=!!this._downloadUrl&&!this._forceClose,i=0;1===e&&(i=2),2===e&&(i=1,1===t&&(this.suppressClose=!0)),this.get_theOfficeTrialExperience().get_offerOfficeTrialInDialog()?(S.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",i),iS.p.get_instance().createOICErrorDialogWithTrial(this._forceClose?o.i(this,this.OICErrorDialogHandlerCloseForced,"OICErrorDialogHandlerCloseForced"):o.i(this,this.OICErrorDialogHandlerNoCloseForced,"OICErrorDialogHandlerNoCloseForced"),n?o.i(this,this.OnLaunchDownload,"OnLaunchDownload"):null,this.DirectInvokeHandler(!1)?o.i(this,this.IHaveOfficeButtonHandler,"IHaveOfficeButtonHandler"):null,null,i,t)):(S.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",i),iS.p.get_instance().createOICErrorDialog(this._forceClose?o.i(this,this.OICErrorDialogHandlerCloseForced,"OICErrorDialogHandlerCloseForced"):o.i(this,this.OICErrorDialogHandlerNoCloseForced,"OICErrorDialogHandlerNoCloseForced"),n?o.i(this,this.OnLaunchDownload,"OnLaunchDownload"):null,null,i))}},e.prototype.OICErrorDialogHandlerCloseForced=function(e){this.closeApplication()},e.prototype.OICErrorDialogHandlerNoCloseForced=function(e){this.restartApplication()},e.prototype.OnLaunchDownload=function(e){this.launchDownload()},e.prototype.IHaveOfficeButtonHandler=function(e){return this.DirectInvokeHandler(!0)},e.prototype.DirectInvokeHandler=function(e){var t=(W.y.get_isInternetExplorer10Up()||W.y.get_isInternetExplorerEdge())&&!!L.AFrameworkApplication.directInvokeDAVUrl;return t&&e&&(window.open(L.AFrameworkApplication.directInvokeDAVUrl,"_blank"),this.closeApplication()),t},e.OpenInRichClientDatapointId=8981,e.DelayCloseTimeInMs=2e3,e.openInDesktopAction="OpenInDesktop",e.openInBrowserAction="OpenInBrowser",e}();(0,o.l)(gS,"50059313$AOpenInClientOperation",null,[]);var pS=function(e){function t(t,n,i){void 0===i&&(i=!1);var r=e.call(this,i)||this;return r._imgBtnGetRichClient=null,r._imgBtnEdit=null,r._imgBtnGetRichClient=t,r._imgBtnEdit=n,r}return(0,v.t)(t,e),t.prototype.get_imgBtnEdit=function(){return this._imgBtnEdit},t.prototype.get_imgBtnGetRichClient=function(){return this._imgBtnGetRichClient},t.prototype.executeCloseApplication=function(){L.AFrameworkApplication.get_theActionManager().processActionWithData(Fe.b.close,2,Hi.z.OIC)},t.prototype.executeRestartApplication=function(){},t.prototype.beforeClientLaunch=function(e){return this.readyForClientLaunch(e)},t.prototype.launchDownload=function(){S.ULS.shipAssertTag(5566817,211,!!this._downloadUrl),L.AFrameworkApplication.isCloseable?L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(!0,this._downloadUrl):window.open(this._downloadUrl)},t.prototype.handleEditInBrowser=function(){L.AFrameworkApplication.get_activeFrame().get_applicationInstance().handleEditInBrowser()},t.prototype.handleGiveFeedback=function(){L.AFrameworkApplication.get_activeFrame().get_applicationInstance().handleGiveFeedback()},t}(gS);(0,o.l)(pS,"9ac85072$OpenInClientOperation",gS,[]);var hS=n(8374),_S=n(7693),mS=function(){function e(){}return e.$$cctor=function(){e._oicSurvey=new ct.z(Object)},e.waitOreoOICSurvey=function(){return e._oicSurvey.get_task().get_isCompleted()?e._oicSurvey.get_task():(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteOreoIsEnabled")||e._oicSurvey.get_task().get_isFaulted()||e._oicSurvey.SX(Error.invalidOperation("Oreo is disabled")),e._oicSurvey.get_task())},e.onSurveyDismissed=function(){e._oicSurvey.setResult(null)},e._oicSurvey=null,e}();(0,o.l)(mS,"5ed66eae$OreoOICSurvey",null,[]),mS.$$cctor();var fS=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r._embedMessageSender=null,r._embedMessageSender=i,r}return(0,v.t)(t,e),t.prototype.registerActions=function(){e.prototype.registerActions.call(this),this._actionManager.addAction(Oi.u.openInClient,Ue.m.frame,o.i(this,this.onEditInClient,"onEditInClient")),Ti.App.get_isOneNoteEmbedded()&&this._actionManager.addAction(nS.u.embedEditInBrowser,Ue.m.frame,o.i(this,this.OnEditInBrowserForEmbed,"OnEditInBrowserForEmbed"))},t.prototype.OnEditInBrowserForEmbed=function(e,t,n,i,r){if(t.get_contextId()!==Ue.m.frame)return 2;if(1===n)return 32;var o=Ti.App.buildPageUrl(yi.App.get_activeAppFrame().workspace.get_activePage());if(!o)return 8;try{return window.open(o,"_blank"),32}catch(e){return S.ULS.sendTraceTag(37232902,339,15,"Electron crash caused by window.open in Embed_Edit_Teams mode: {0}",e),32}},t.prototype.onEditInClient=function(e,t,n,i,r){if(t.get_contextId()!==Ue.m.frame)return 2;if(!yi.App.get_clientEditDocumentUrl()&&!L.AFrameworkApplication.docPropertiesProvider.get_openInClientCommandUrl()&&!L.AFrameworkApplication.useOpenInClientPostMessage)return 8;if(1===n)return 32;S.ULS.sendTraceTag(22298957,339,50,'Click "EDIT IN ONENOTE" button.');var o=!1;return null!=r&&(o=r),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteOICSurveyIsEnabled")&&"undefined"!=typeof oreo_slice2&&"undefined"!=typeof oreo_slice2.OreoOICSurvey?(this.ShowOICSurveyBeforeOpenInClient(o),32):this.StartOpeningOneNoteInClient(o)},t.prototype.ShowOICSurveyBeforeOpenInClient=function(e){var t=this;S.ULS.sendTraceTag(38638724,339,50,"loading ONO Oreo OIC Survey"),this._actionManager.processAction(nS.u.oneNoteShowOpenInClientSurvey,2),mS.waitOreoOICSurvey().CWo((function(n){t.StartOpeningOneNoteInClient(e)}),Qn.d.onlyOnRanToCompletion)},t.prototype.StartOpeningOneNoteInClient=function(e){var t=this;return new pS("OneNote_32x32x32","EditInOneNoteWebApp_32x32x32").begin(this.GetPageUrl(),L.AFrameworkApplication.downloadACopyUrl,2,2,e,new nt.q(se.i,(function(){return t.get_hostPostmessenger()})))},t.prototype.GetPageUrl=function(){var e=yi.App.get_clientEditDocumentUrl();e&&yi.App.get_activeAppFrame().workspace.get_activePage()&&((e=hS.j.getAnInstanceFromGraphNode(yi.App.get_activeAppFrame().workspace.get_activePage(),yi.App.get_clientEditDocumentUrl(),null).getClientUrl(yi.App.notebookMode)||yi.App.get_clientEditDocumentUrl()).startsWith(_S.u.protocolOnenote)&&(e=e.substr(_S.u.protocolOnenote.length)));return e},t}(YC);(0,o.l)(fS,"ab3422da$OneNoteAppFrameCommandUIActor",YC,[]);var yS=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"OneNote.CommandUIActors"},e.prototype.init=function(){this._container.resolve(YC).registerActions(),this._container.resolve(JC.v).registerActions(),this._container.resolve(XC.u).registerActions()},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e;var t=null;Ti.App.get_isOneNoteEmbedded()&&(t=new nt.q($C,(function(){return new $C(L.AFrameworkApplication.appSettingsManager.get_appSettings().OneNoteEmbedHostingApp,e.tryResolve(se.i))}))),e.register(YC).singleInstance().usingFactory((function(){return new fS(L.AFrameworkApplication.get_theActionManager(),e.resolveFuture(se.i),t)})),(new tS).configure(e)},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(yS,"5e4302e6$OneNoteBootstrapActorsPackage",null,[s.u,u.s]);var CS=(0,o.y)("22c9b5e9$IExternalContentEditor"),SS=n(8288),bS=n(5032),vS=n(60),TS=n(7151),AS=n(6059),IS=function(){function e(){}return e.prototype.insertExternalContent=function(e,t,n){var i=this,r=(0,y.e)(Wa.y,e);if(r&&(r.get_contextId()===ol.d.insertionPoint||r.get_contextId()===ol.d.textRange)&&(!n||r.get_contextId()===ol.d.textRange)){var o={"Content-Type":"application/json; charset=utf-8"},a=vS.b.constructExternalContentEmbedRequest(t,!0),l=bS.x.constructFromSingleRequest(a);L.AFrameworkApplication.theClientRequestManager.addRequest(yi.App.webServiceBase+"OneNote.ashx",2,l,o,!1,2,(function(e){var o=i.PrepareResponse(e);o&&i.InsertExternalContentCore(o,r,t,n)}),(function(e){}),a)}},e.prototype.insertIFrameNode=function(e,t,n){if(!e||!e.get_isConnected()||!pa.ImageReader.isImageNode(e))return null;var i=new TS.IFrameNode;return i.setValue(rs.o.iFrameMediaType,n),i.setValue(rs.o.iFrameOriginUrl,t),ha.g.createFromNode(e).addChild(i,2),i},e.prototype.InsertExternalContentCore=function(t,n,i,r){var o=!1,a=0,l=null,s=ai.l.create(),u=fa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection();r&&u.get_lastContext().get_node()===n.get_node()&&(o=!0,l=n.get_node(),a=u.get_lastContext().get_cpEnd()-n.get_cpEnd());var c=new Ma.GraphTransaction(15);if(c.setFromNode(n.get_node()),t.Title){if(r){var d=Ha.HyperlinkReader.getHyperlinksInRange(n,!1);if(d&&1!==d.length)return void c.dispose();e.get_HyperlinkEditor().removeHyperlink(d[0].paragraph,d[0].hyperlink)}n=this.ReplaceContextWithHyperlink(n,t.Title,i)}var g=this.CreateEmptyLineAndOutlineElementBelow(n),p=new Dl.DictionaryPropertySet;e.get_ImageEditor().preparePlaceholderForImageUpload(p,t.Width,t.Height);var h=AS.q.parseMediaType(t.MediaType),_=this.GetExternalContentAltText(h,t.Title);p.setValue(is.b.imageAltText,_);var m=e.get_ImageEditor().insertPictureBlock(g,p);this.insertIFrameNode(m.node,i,h),r?(o&&(u=Ua.SelectionFactory.createIpSelection(l,a+n.get_cpEnd())),fa.SelectionManager.get_instance().setSelection(u)):fa.SelectionManager.get_instance().setSelection(u),c.makeIncrementalAction(s,1),c.dispose(),this.DoServerRequestToDownloadThumbnailImageBlob(m.node,t.Thumbnail,s)},e.prototype.PrepareResponse=function(e){var t;if(!hp.j.tryDeserializeServerResponse(e.get_data().responseData,(0,g.m)((function(){return t}),(function(e){return t=e}))))return null;var n=t.Responses[0];return n.StatusCode?null:n},e.prototype.ReplaceContextWithHyperlink=function(t,n,i){var r=t.get_cpBegin()+n.length;e.get_CharacterPropertiesEditor().replaceTextRange(t,n);var o=Wa.y.createTextRange(t.get_node(),t.get_cpBegin(),r);return e.get_HyperlinkEditor().createHyperlink(o,i),o},e.prototype.CreateEmptyLineAndOutlineElementBelow=function(t){var n=ha.g.createFromNode(t.get_node());n.tryToRootAtOutlineAncestor(),_s.OutlineElementNavigator.returnToOutlineElement(n);var i=e.get_OutlineElementEditor().insertOutlineElementBelow(n);return e.get_OutlineElementEditor().createParagraph(i),_s.OutlineElementNavigator.returnToOutlineElement(i),i=e.get_OutlineElementEditor().insertOutlineElementBelow(i)},e.prototype.GetExternalContentAltText=function(e,t){switch(e){case 1:return""===t?String.format(OneNoteIntl.OneNoteStrings.L_ThumbnailAltText,OneNoteIntl.OneNoteStrings.L_ThumbnailAltTextVideo):String.format(OneNoteIntl.OneNoteStrings.L_ThumbnailAltTextTitled,OneNoteIntl.OneNoteStrings.L_ThumbnailAltTextVideo,t);case 2:return""===t?String.format(OneNoteIntl.OneNoteStrings.L_ThumbnailAltText,OneNoteIntl.OneNoteStrings.L_ThumbnailAltTextRich):String.format(OneNoteIntl.OneNoteStrings.L_ThumbnailAltTextTitled,OneNoteIntl.OneNoteStrings.L_ThumbnailAltTextRich,t);default:return String.format(OneNoteIntl.OneNoteStrings.L_ThumbnailAltText,"").trimStart()}},e.prototype.DoServerRequestToDownloadThumbnailImageBlob=function(t,n,i){var r=function(e){},o=function(e){};t.getParentGraphSpace().get_contentReplicator().forceOutbound((function(a){e.get_ImageEditor().addImageBlobFromExternalUrl(t,n,i,o,r)}),(function(e,t){}),null)},e.get_ImageEditor=function(){return e._imageEditor||(e._imageEditor=Ge.w.get_instance().resolve(SS.w))},e.get_OutlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=Ge.w.get_instance().resolve(ql.p))},e.get_HyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=Ge.w.get_instance().resolve(Ba.o))},e.get_CharacterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=Ge.w.get_instance().resolve(ba.x))},e._imageEditor=null,e._outlineElementEditor=null,e._hyperlinkEditor=null,e._characterPropertiesEditor=null,e}();(0,o.l)(IS,"4bee5e40$ExternalContentEditor",null,[CS]);var wS=function(){function e(){this._externalContentEditor=null}return e.prototype.get_ExternalContentEditor=function(){return this._externalContentEditor||(this._externalContentEditor=Ge.w.get_instance().resolve(CS))},e.prototype.postProcessHyperlink=function(e,t){this.get_ExternalContentEditor().insertExternalContent(e,t,!0)},e}();(0,o.l)(wS,"3985c9b1$PostHyperlinkAutoCorrectStrategy",null,[La]);var xS=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.ExternalContentEmbed"},e.prototype.configure=function(e){e.register(IS).as(CS).singleInstance().usingFactory((function(){return new IS})),e.register(wS).as(La).singleInstance().usingFactory((function(){return new wS}))},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteExternalContentIsEnabled")&&B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(xS,"13883dfb$ExternalContentPackage",null,[s.u,u.s]);var ES=n(8280),FS=n(9408),PS=n(142),DS=n(8490),RS=n(1200),MS=function(){function e(e,t,n,i,r,o,a,l){this._outlineElementEditor=null,this._characterPropertiesEditor=null,this._graphTransactionFactory=null,this._outlineEditor=null,this._paragraphEditor=null,this._selectionManager=null,this._externalSelectionManagerFuture=null,this._selectionFactory=null,this._changeIdEditor=null,this.insertedPictureResult=null,this._outlineEditor=e,this._outlineElementEditor=t,this._graphTransactionFactory=n,this._paragraphEditor=i,this._characterPropertiesEditor=r,this._selectionManager=o,this._externalSelectionManagerFuture=a,this._selectionFactory=l}return e.prototype.get_changeIdEditor=function(){return this._changeIdEditor||(this._changeIdEditor=Ge.w.get_instance().resolve(Jh.p))},e.prototype.get_PageReader=function(){return $s.PageReader.get_instance()},e.prototype.setImageAltTextHelper=function(e,t,n){var i=this._graphTransactionFactory.getTransaction(15);i.setFromNode(t.get_node()),this.setImageAltText(e,n),i.dispose()},e.prototype.setImageAltTextDescriptionHelper=function(e,t,n){var i=this._graphTransactionFactory.getTransaction(15);i.setFromNode(t.get_node()),this.setImageAltTextDescription(e,n),i.dispose()},e.prototype.setImageAltText=function(e,t){e.setValue(is.b.imageAltText,t)},e.prototype.setImageAltTextDescription=function(e,t){e.setValue(os.j.imageAltTextDescription,t)},e.prototype.setImageHyperlink=function(e,t){e.setValue(is.b.hyperlinkUrl,t)},e.prototype.setImageLockAspectRatio=function(e,t){e.setValue(os.j.imageLockAspectRatio,t)},e.prototype.setSizeHelper=function(e,t,n,i){var r=this._graphTransactionFactory.getTransaction(15);r.setFromNode(t.get_node()),this.setDimensionsProperties(e,t,n,i),r.dispose()},e.prototype.setDimensionsProperties=function(e,t,n,i){this.setImageWidth(e,n),this.setImageHeight(e,i),this.setLayoutSizeSetByUser(e,!0)},e.prototype.setImageWidth=function(e,t){e.setValue(is.b.layoutMaxWidth,t),e.setValue(Pl.k.imageAbsoluteWidth,-1)},e.prototype.setImageHeight=function(e,t){e.setValue(is.b.layoutMaxHeight,t),e.setValue(Pl.k.imageAbsoluteHeight,-1)},e.prototype.setJustification=function(e,t){e.setValue(os.j.horizontalRelativePosition,t),e.setValue(is.b.layoutAlignmentInParent,t),e.setValue(is.b.layoutAlignmentSelf,t)},e.prototype.setTextWrapType=function(e,t){e.setValue(os.j.textWrapType,t)},e.prototype.setBehindDoc=function(e,t){e.setValue(os.j.behindDoc,t)},e.prototype.setToInline=function(e){if(!pa.ImageReader.isInlineImageContext(e)&&e.get_isGraphNodeContext()){var t=e.get_node();if(pa.ImageReader.isAnchoredImageNode(t)){var n=this._graphTransactionFactory.getTransaction(15);n.setFromNode(e.get_node());var i=ha.g.createFromNode(t);i.tryToRootAtAncestorOfType(12);var r=i.get_parentNode(),o=r.get_properties().getProperty_Unchecked(os.j.runIds),a=t.get_properties().getValue(Number,os.j.runId),l=(t.getValueWithDefault(Number,os.j.wordId,ip.z.wordIdNil),r.get_characterProperties()),s=[os.j.horizontalRelativePosition,is.b.layoutAlignmentInParent,is.b.layoutAlignmentSelf,os.j.behindDoc,os.j.textWrapType,os.j.anchorImageChangeId];t.removeProperties.apply(t,s);var u=this.GetCpForRunId(a,o,l),c=Wa.y.createIpContext(r,u);this._paragraphEditor.convertAnchoredImageToInline(t,c);var d=this._selectionFactory.createTextRangeOrIpSelection(r,u,u+1);d&&this._selectionManager.setSelection(d),this.get_changeIdEditor().setChangeIdOnTextRange(r,u,u+1),n.dispose()}}},e.prototype.setToAnchored=function(e,t,n,i){if(void 0===n&&(n=0),void 0===i&&(i=!1),e.get_isGraphNodeContext()){var r=this._graphTransactionFactory.getTransaction(15),o=e,a=e.get_node();if(r.setFromNode(a),pa.ImageReader.isInlineImageContext(e)){var l=new PS.x;l.copyProperties(pa.ImageReader.getImagePropertiesFromContext(e));var s=o.get_cpBegin(),u=a.get_characterProperties(),c=this.FindImageBlobIndexInCharacterPropertiesArray(s,u),d=u.get_item(c).get_blob().get_runIndex(),g=a.get_properties().getProperty_Unchecked(os.j.runIds),p=(g=this.ReCalculateRunIds(g))[d],h=a.getValueWithDefault(Number,os.j.wordId,ip.z.wordIdNil);this._characterPropertiesEditor.replaceTextRange(e,""),l.get_properties().setValue(os.j.runId,p),l.get_properties().setValue(os.j.wordId,h);var _=ha.g.createFromNode(a);_.tryToRootAtAncestorOfType(12),_.addChild(l,6);var m=l.get_anchor().get_node().get_id();if(_.get_currentINode().get_properties().hasProperty(os.j.anchoredObjectNodes)){var f=_.get_currentINode().get_properties().getProperty_Unchecked(os.j.anchoredObjectNodes);Array.add(f,m),_.get_currentNode().get_properties().setValue(os.j.anchoredObjectNodes,Array.clone(f))}else _.get_currentNode().get_properties().setValue(os.j.anchoredObjectNodes,[m]);a=l}n&&this.setJustification(a.get_properties(),n),this.setBehindDoc(a.get_properties(),i),this.setTextWrapType(a.get_properties(),t),this.get_changeIdEditor().setChangeIdOnImageNode(a);var y=this._selectionFactory.createSelectionFromNode(a);y&&this._selectionManager.setSelection(y),r.dispose()}},e.prototype.scaleImageWidthAndHeight=function(e,t){if(t<=0)return!1;var n=np.j.pixelsToMu(t,0),i=pa.ImageReader.getImageWidthWithoutEffects(e),r=pa.ImageReader.getImageHeightWithoutEffects(e);return i>n&&(r*=n/i,this.setImageWidth(e,n),this.setImageHeight(e,r),S.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",t),!0)},e.prototype.ReCalculateRunIds=function(e){for(var t=0;t<e.length&&!e[t];)t++;if(t===e.length)for(var n=0;n<e.length;)e[n]=n+1,n++;else{for(var i=e[t],r=(n=t-1,i-1);n>=0;)e[n]=r,n--,r--;var o=0,a=i;for(n=t+1;n<e.length;){var l=e[n];l?l<a?(a=l+o,e[n]=a):a=l:(o+=2,a++,e[n]=a),n++}}return e},e.prototype.FindRunIndexInRunIdsForRunId=function(e,t){for(var n=0;n<t.length&&!(e<t[n]);)n++;return n},e.prototype.GetCpForRunId=function(e,t,n){var i=0,r=this.FindRunIndexInRunIdsForRunId(e,t),o=0;if(r===t.length)o=n.get_length()-1;else for(;o<n.get_length();){var a=n.get_item(o);if(a.get_formatting()&&a.get_formatting().runIndex===r)break;o++}o<n.get_length()?i=n.get_item(o).get_cp():S.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{Index:o,RunId:e,CharacterPropertiesArrayLength:n.get_length()});return i},e.prototype.FindImageBlobIndexInCharacterPropertiesArray=function(e,t){for(var n=0;n<t.get_length();){if(t.get_item(n).get_cp()===e)break;n++}return n===t.get_length()&&S.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",{Index:n,CharacterPropertiesArrayLength:t.get_length()}),n},e.prototype.setLayoutSizeSetByUser=function(e,t){e.setValue(is.b.isLayoutSizeSetByUser,t)},e.prototype.onFloatingImageChangeToNormal=function(e){},e.prototype.setNewFileDataObjectId=function(e){var t=new mt.h(ai.l.create(),1);e.setValue(k_.w.objectDataBlobId,t.toString()),e.setValue(rs.o.fileDataObject,t.guid)},e.prototype.preparePlaceholderForImageUpload=function(e,t,n,i){var r,o;void 0===i&&(i=!1),t&&n?(r=Math.max(t,RS.n.minImagePlaceholderSize),o=Math.max(n,RS.n.minImagePlaceholderSize)):(r=RS.n.defaultImagePlaceholderSize,o=RS.n.defaultImagePlaceholderSize),e.setValue(is.b.layoutMaxWidth,np.j.pixelsToMu(r,0)),e.setValue(is.b.layoutMaxHeight,np.j.pixelsToMu(o,1)),e.setValue(is.b.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading),e.setValue(rs.o.imageUploadState,1),e.setValue(os.j.isImageFromPaste,i)},e.prototype.insertPictureBlock=function(e,t){return null},e.prototype.insertPictureInline=function(e,t){return null},e.prototype.doInsertPicture=function(e,t,n){var i=null,r=this.doInsertPictureWithoutSelectionSet(e,t,n,(0,g.m)((function(){return i}),(function(e){return i=e})));return i&&e.view.get_selectionManager().setSelection(i),r},e.prototype.doInsertPictureWithoutSelectionSet=function(t,n,i,r){if(r.val=null,!this.canInsertPictureInContext(t))return null;var a=t.view,l=this._graphTransactionFactory.getTransaction(15,Oi.u.insertPicture);l.setFromNode(a.get_targetNode()),n||(n=new Dl.DictionaryPropertySet),n.setValue(Pl.k.dontPrompt,!0);var s=a.get_selectionManager().get_selectionContextForActionDispatch(),u=new hm.d;if(ga.SelectionEditor.isInsertionPointContext(s)){if(s.get_isGraphNodeContext()&&Ga.ParagraphReader.isParagraphNode(s.get_node())){Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()&&yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(s.get_node());var c=vc.FormattingReader.getFormattingObject(s);c.get_cache().get_isLink()&&(c=c.cloneUnderDifferentChp(null),e.get_FormattingEditor().removeLinkFormatting(c)),u.formatting=c.get_formattingId(),u.languageId=vc.FormattingReader.language(c),Gl.n.get_instance().get_item(71)&&(u.style=bs.StyleReader.getStyleFromParagraphNode(s.get_node()))}}else{if(2===L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.deleteForReplace,2))return l.dispose(),null;s=a.get_selectionManager().get_selectionContextForActionDispatch()}if(!s.get_isGraphNodeContext())return l.dispose(),null;if(!this.insertPictureInContext(t.get_nextContext(),n))return l.dispose(),this.insertedPictureResult=null,null;var d=this.insertedPictureResult;if(this.insertedPictureResult=null,1===d.location){var g=d.node,p=Gs.q.get_instance().getTraversableIteratorAtOutlineElement(g);if(_s.OutlineElementNavigator.moveToNextOutlineElement(p,!1,!1)||(fs.OutlineNavigator.returnToOutlineOrTableCell(p),this._outlineEditor.appendOutlineElement(p,!0,u)),_s.OutlineElementNavigator.moveToContent(p),us.TableReader.isTable(p)){if(o.r(r_.z,p)||o.r(DS.u,p)){var h=new ha.g;h.set(p.get_currentNode()),Pd.TableNavigator.moveToCellContent(h,0,0),p.set(h.get_currentNode())}else Pd.TableNavigator.moveToCellContent(p,0,0);Ss.OutlineElementReader.isOutlineElement(p)?_s.OutlineElementNavigator.moveToContent(p):p=Gs.q.get_instance().getTraversableIteratorAtOutlineElement(g)}Ga.ParagraphReader.canContainIpOrTextRange(p.get_currentNode())?r.val=this._selectionFactory.createIpSelection(p.get_currentNode(),0):r.val=this._selectionFactory.createSelectionFromNode(p.get_currentNode())}else if(!d.location){var _=d.blob.get_containingProperties().get_cp()+1;r.val=this._selectionFactory.createTextRangeOrIpSelection(d.node,_-1,_)}return l.makeIncrementalAction(i,1),l.dispose(),d},e.prototype.insertPictureInContext=function(e,t){return!1},e.prototype.canInsertPictureInContext=function(t){if(t.get_contextId()===ol.d.view&&t.view.get_isInteractiveView()&&t.view.get_selectionManager()&&(t=t.view.get_selectionManager().get_selectionContextForActionDispatch()),!t)return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.noSelection}),!1;if(Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().contextSetContainsLockedRange(t))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsLockedRange}),!1;if(this._externalSelectionManagerFuture&&this._externalSelectionManagerFuture.get_instance()&&this._externalSelectionManagerFuture.get_instance().isExternalSelectionContext(t))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.externalSelection}),!1;if(Gl.n.get_instance().get_item(51)&&this.get_PageReader().get_isCompatMode())return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.compatMode}),!1;if(t.get_isGraphNodeContext())return Qs.q.isContextInTitle(t)?(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsTitle}),!1):ys.OutlineReader.isOutlineContext(t)?(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsOutline}),!1):pa.ImageReader.isFloatingImageContext(t)?(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsFloatingImage}),!1):Bm.r.isFloatingInkContext(t)?(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsFloatingInk}),!1):!Vf.q.isFloatingIFrameContext(t)||(e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsFloatingIFrame}),!1);if(FS.u.isMultiRangeContext(t)){for(var n=t,i=0;i<n.get_length();++i){var r=n.getContext(i);if(!r.get_isGraphNodeContext())return!1;if(Qs.q.isContextInTitle(r))return e.get_ActivityManager().recordEvent(ah.f.noExecute,{Reason:lh.i.containsTitle}),!1}return!0}return!1},e.prototype.removePicture=function(e,t){var n=this._graphTransactionFactory.getTransaction(7);if(n.setFromNode(e),12===e.get_type()){var i=t.get_containingProperties().get_cp(),r=i+1===Ga.ParagraphReader.textLength(e),o=Wa.y.createContextFromCpResult(i,i+1,r,e);this._characterPropertiesEditor.replaceTextRange(o,"");var a=Wa.y.createIpContext(e,i);this._selectionManager.setSelection(Ua.SelectionFactory.createSelectionFromContext(a))}else this._outlineElementEditor.removeContainingOutlineElement(e);n.dispose()},e.get_FormattingEditor=function(){return e._formattingEditor||(e._formattingEditor=Ge.w.get_instance().resolve(Vs.z))},e.get_LockedRangeEditor=function(){return za.k.get_instance()},e.get_ActivityManager=function(){return xr.y.get_instance()},e._formattingEditor=null,e}();(0,o.l)(MS,"22ae4a1e$ImageEditor",null,[Za.w]);var kS=n(6530),NS=n(4984),LS=function(e){function t(){var t=e.call(this)||this;return t.ThumbnailUrl=null,t.AltText=null,t.DesiredRevisionIncrement=0,t.ContentNodes=null,t}return(0,v.t)(t,e),t.prototype.getClassId=function(){return 51},t.constructRequest=function(e,n,i,r,o,a,l,s,u,c,d,g,p,h,_){var m=(0,U.m)(new t,{ImageId:e,ObjectDataBlobId:null,lcid:n,CellId:i,FileId:r,BaseRevisionId:o,Knowledge:a,DesiredRevisionId:l,ClassId:u,access_token:c,w:p,h:h,ThumbnailUrl:d,AltText:g,DesiredRevisionIncrement:s});m.ContentNodes=new Array(0);for(var f=0,y=_;f<y.length;f++){var C=y[f];m.ContentNodes.push(NS.j.serialize(C))}return m},t}(kS.u);(0,o.l)(LS,"d7e57523$ExternalContentFetchThumbnailRequest",kS.u,[]);var BS=function(e){function t(t,n,i,r,o,a,l,s){return e.call(this,t,n,i,r,o,a,l,s)||this}return(0,v.t)(t,e),t.prototype.setJustification=function(e,t){e.setValue(is.b.layoutAlignmentInParent,t),e.setValue(is.b.layoutAlignmentSelf,t)},t.prototype.onFloatingImageChangeToNormal=function(e){e.removeProperties(is.b.offsetFromParentHoriz,is.b.offsetFromParentVert)},t.prototype.insertPictureBlock=function(e,t){var n=this._outlineElementEditor.createImage(e);return t&&n.copyProperties(t),new Yg(n,null,1)},t.prototype.insertPictureInContext=function(e,t){if(!this.canInsertPictureInContext(e))return!1;var n,i=e,r=this._graphTransactionFactory.getTransaction(7);return r.setFromNode(i.get_node()),pa.ImageReader.isImageContext(e)?((n=new ha.g).set(e.get_node()),n.tryToRootAtAncestorOfType(10),_s.OutlineElementNavigator.returnToOutlineElement(n),this._outlineElementEditor.insertOutlineElementAsSibling(n,!0,!1)):n=this._outlineElementEditor.insertOutlineElementAt(e),this.insertedPictureResult=this.insertPictureBlock(n,t),r.dispose(),!0},t.prototype.insertPictureFromUrl=function(e,t,n,i,r,o){var a=this,l=this.insertPictureBlock(e,t);return l.node.getParentGraphSpace().get_contentReplicator().forceOutbound((function(e){a.addImageBlobFromExternalUrl(l.node,n,i,r,o)}),(function(e,t){o&&o(t)}),null),l},t.prototype.addImageBlobFromExternalUrl=function(e,t,n,i,r){if(e&&e.get_isConnected()&&pa.ImageReader.isImageNode(e)){var o=e.getParentGraphSpace(),a=e.getValue(Array,is.b.contentNodes),l=LS.constructRequest(e.get_id().toString(),L.AFrameworkApplication.lcid.toString(),o.get_objectSpaceId().toString(),o.get_fileQuerySignature(),o.get_contentReplicator().get_lastReplicated().toString(),o.get_contentReplicator().get_knowledge(),n.toString(),1,e.get_runtimeClassId().toString(),L.AFrameworkApplication.get_accessToken(),t,e.getValue(String,is.b.imageAltText),np.j.muToPixels(e.getValue(Number,is.b.layoutMaxWidth),0),np.j.muToPixels(e.getValue(Number,is.b.layoutMaxHeight),1),a),s={"Content-Type":"application/json; charset=utf-8"},u=bS.x.constructFromSingleRequest(l),c=function(t){i&&i(e)},d=function(e,t){r&&r(t)};L.AFrameworkApplication.theClientRequestManager.addRequest(yi.App.webServiceBase+"OneNote.ashx",2,u,s,!1,2,(function(e){o.get_contentReplicator().forceInbound(c,d,null)}),(function(e){r&&r(27)}),l)}else r&&r(122)},t}(MS);(0,o.l)(BS,"497b4606$ImageEditor",MS,[SS.w,Za.w]);var OS=function(){function e(){}return e.configure=function(e){e.register(BS).as(SS.w).as(Za.w).singleInstance().usingFactory((function(){return new BS(e.resolve(zl.a),e.resolve(ql.p),e.resolve(cg.c),e.resolve(ns.g),e.resolve(ba.x),e.resolve(ES.l),e.resolveFuture(kg.i),e.resolve(Kd))}))},e}();(0,o.l)(OS,"3168673e$OneNoteImageEditorsComponentConfiguration",null,[]);var US=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.ImageEditors"},e.prototype.configure=function(e){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ImageEditorsDelayInitializationEnabled")&&OS.configure(e)},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(US,"2fab76af$OneNoteImageEditorsPackage",null,[s.u,u.s]);var HS=n(125),GS=(0,o.y)("91f37888$IInkThicknessUIBuilder"),WS=n(148),VS=function(){function e(e,t,n,i){this.xOffset=0,this.yOffset=0,this.pressureOffset=null,this.pressureMaxValue=null,this.xOffset=e,this.yOffset=t,this.pressureOffset=n,this.pressureMaxValue=i}return e.prototype.get_xOffset=function(){return this.xOffset},e.prototype.get_yOffset=function(){return this.yOffset},e.prototype.get_pressureOffset=function(){return this.pressureOffset},e.prototype.get_pressureMaxValue=function(){return this.pressureMaxValue},e}();(0,o.l)(VS,"e34345d2$PacketDimensionProperties",null,[]);var $S=n(2567),zS=function(){function e(e,t,n,i,r,o,a,l,s,u,c,d){this.packetDescriptions=null,this.isFormatValid=!1,this.dimensionAttributes=null,this.format=null,this.inkDrawingHeight=0,this.inkDrawingWidth=0,this.inkColor=0,this.inkPropertiesObjectId=null,this.penTip=0,this.transparency=0,this.rasterOperation=0,this.ignorePressure=!1,this.antiAliased=!1,this.fitToCurve=!1,this.customProperties=null,this.packetDescriptions=e,this.inkDrawingHeight=t,this.inkDrawingWidth=n,this.inkColor=i,this.inkPropertiesObjectId=r,this.penTip=o,this.transparency=a,this.rasterOperation=l,this.ignorePressure=s,this.antiAliased=u,this.fitToCurve=c,this.format=new C.c(String);for(var g=e.$$ge();g.$$mn();){var p=g.$$cu();this.get_format().add(p.get_format())}this.CalculatePacketDimensionProperties(),this.customProperties=d}return e.prototype.get_packetDescriptions=function(){return this.packetDescriptions},e.prototype.get_isFormatValid=function(){return this.isFormatValid},e.prototype.get_dimensionAttributes=function(){return this.dimensionAttributes},e.prototype.get_format=function(){return this.format},e.prototype.get_inkDrawingHeight=function(){return this.inkDrawingHeight},e.prototype.get_inkDrawingWidth=function(){return this.inkDrawingWidth},e.prototype.get_inkColor=function(){return this.inkColor},e.prototype.get_penTip=function(){return this.penTip},e.prototype.get_transparency=function(){return this.transparency},e.prototype.get_rasterOperation=function(){return this.rasterOperation},e.prototype.get_ignorePressure=function(){return this.ignorePressure},e.prototype.get_antiAliased=function(){return this.antiAliased},e.prototype.get_fitToCurve=function(){return this.fitToCurve},e.prototype.get_customProperties=function(){return this.customProperties},e.prototype.CalculatePacketDimensionProperties=function(){this.dimensionAttributes=e.calculatePacketDimensionProperties(this.get_packetDescriptions()),this.isFormatValid=!!this.get_dimensionAttributes()},e.calculatePacketDimensionProperties=function(e){for(var t=-1,n=-1,i=null,r=null,o=0;o<e.get_count();o++){var a=e.get_item(o);Rn.l.toLower(a.get_format())===$S.s.xLowerCaseCoordinateGuid&&(t=o),Rn.l.toLower(a.get_format())===$S.s.yLowerCaseCoordinateGuid&&(n=o),Rn.l.toLower(a.get_format())===$S.s.pressureLowerCaseCoordinateGuid&&(i=o,r=a.get_max())}if(-1===t||-1===n){var l=new Sys.StringBuilder;for(o=0;o<e.get_count();o++){a=e.get_item(o);l.append(a.toString()+",")}return S.ULS.sendTraceTag(17098841,339,10,"Found invalid format guids in inkProperties. {0}",l.toString()),null}return new VS(t,n,i,r)},e.defaultInkDrawingHeightValue=1,e.defaultInkDrawingWidthValue=53,e.defaultInkColorValue=0,e.defaultPenTipValue=0,e.defaultTransparencyValue=0,e.defaultRasterOpValue=13,e.defaultIgnorePressueValue=!1,e.defaultAntiAliasedValue=!0,e.defaultFitToCurveValue=!1,e}();(0,o.l)(zS,"45fef3a6$InkProperties",null,[]);var KS=function(){function e(){}return e.stringJoin=function(e,t){if(!t)return"";e||(e="");for(var n=new Sys.StringBuilder,i=0;i<t.length;i++)n.append(t[i]),i<t.length-1&&n.append(e);return n.toString()},e}();(0,o.l)(KS,"7aa88994$InkStringUtilities",null,[]);var qS=function(){function e(){}return e.setStrokePacketDescriptions=function(e,t){if(null!==e&&t){for(var n=new Sys.StringBuilder("["),i=0;i<t.get_count();i++)n.append(t.get_item(i).toString()),i!==t.get_count()-1&&n.append(",");n.append("]"),e.setValue(rs.o.inkPacketDescription,n.toString())}},e.setStrokeHeightFromStrokeProperties=function(e,t){null!==e&&(t===zS.defaultInkDrawingHeightValue?S.ULS.sendTraceTag(17098777,339,100,"Stroke height property will not be set because the default value {0} was specified",t):e.setValue(rs.o.inkDrawingAttrib_Height,t))},e.setStrokeWidthFromStrokeProperties=function(e,t){null!==e&&(t===zS.defaultInkDrawingWidthValue?S.ULS.sendTraceTag(17098780,339,100,"Stroke width property will not be set because the default value {0} was specified",t):e.setValue(rs.o.inkDrawingAttrib_Width,t))},e.setStrokeColorFromStrokeProperties=function(e,t){null!==e&&(t===zS.defaultInkColorValue?S.ULS.sendTraceTag(17098783,339,100,"Stroke color property will not be set because the default value {0} was specified",t):e.setValue(rs.o.inkDrawingAttrib_Color,t))},e.setPenTipFromStrokeProperties=function(e,t){null!==e&&(t===zS.defaultPenTipValue?S.ULS.sendTraceTag(17098786,339,100,"Stroke penTip property will not be set because the default value {0} was specified",t):e.setValue(rs.o.inkDrawingAttrib_PenTip,t))},e.setTransparencyFromStrokeProperties=function(e,t){null!==e&&(t===zS.defaultTransparencyValue?S.ULS.sendTraceTag(17098817,339,100,"Stroke transparency property will not be set because the default value {0} was specified",t):e.setValue(rs.o.inkDrawingAttrib_Transparency,t))},e.setRasterOperationFromStrokeProperties=function(e,t){null!==e&&(t===zS.defaultRasterOpValue?S.ULS.sendTraceTag(17098820,339,100,"Stroke rasterOperation property will not be set because the default value {0} was specified",t):e.setValue(rs.o.inkDrawingAttrib_RasterOperation,t))},e.setIgnorePressureFromStrokeProperties=function(e,t){null!==e&&(t===zS.defaultIgnorePressueValue?S.ULS.sendTraceTag(17098823,339,100,"Stroke ignorePressure property will not be set because the default value {0} was specified",t):e.setValue(rs.o.inkDrawingAttrib_IgnorePressure,t))},e.setAntiAliasedFromStrokeProperties=function(e,t){null!==e&&(t===zS.defaultAntiAliasedValue?S.ULS.sendTraceTag(17098826,339,100,"Stroke antiAliased property will not be set because the default value {0} was specified",t):e.setValue(rs.o.inkDrawingAttrib_AntiAliased,t))},e.setFitToCurveFromStrokeProperties=function(e,t){null!==e&&(t===zS.defaultFitToCurveValue?S.ULS.sendTraceTag(17098829,339,100,"Stroke fitToCurve property will not be set because the default value {0} was specified",t):e.setValue(rs.o.inkDrawingAttrib_FitToCurve,t))},e.setStrokePropertiesId=function(e,t){e&&t&&e.setValue(rs.o.inkStrokeProperties,t)},e.setRawStrokePacketData=function(e,t){e&&t&&e.setValue(rs.o.inkPacketDataCompressed,"["+KS.stringJoin(",",t)+"]")},e.setInk14StrokeIds=function(e,t){e&&e.setValue(rs.o.ink14Strokes,t)},e}();(0,o.l)(qS,"cd070750$InkGraphPropertiesEditUtilities",null,[]);var jS=function(){function e(e,t,n,i,r,o,a,l,s,u,c,d,g){this.data=null,this.isDataInAbsoluteCoordinates=!1,this.inkStrokeObjectId=null,this.lcid=0,this.strokeBias=0,this.isHighlighter=!1,this.inkProperties=null,this.customProperties=null,this.scaleX=0,this.scaleY=0,this.dx=0,this.dy=0,this.parentInkNodeId=null,this.inkStrokeObjectId=e,this.parentInkNodeId=t,this.lcid=i,this.strokeBias=r,this.isHighlighter=o,this.inkProperties=a,this.data=n,this.scaleX=l,this.scaleY=s,this.dx=u,this.dy=c,this.isDataInAbsoluteCoordinates=d,this.customProperties=g}return e.prototype.get_lcid=function(){return this.lcid},e.prototype.get_strokeBias=function(){return this.strokeBias},e.prototype.get_isHighlighter=function(){return this.isHighlighter},e.prototype.get_inkProperties=function(){return this.inkProperties},e.prototype.get_customProperties=function(){return this.customProperties},e.prototype.get_hasData=function(){return this.data.length>0},e.prototype.toString=function(){return String.format("Stroke, Bias: {0}, IsHighlighter: {1}, Lcid: {2}, HasPressure: {3}, IsDataInAbsoluteCoordinates:{4} Packet: [{5}]",this.get_strokeBias(),this.get_isHighlighter(),this.get_lcid(),this.get_inkProperties().get_packetDescriptions().get_count()>2,this.isDataInAbsoluteCoordinates,KS.stringJoin(",",this.data))},e.prototype.get_scaleX=function(){return this.scaleX},e.prototype.get_scaleY=function(){return this.scaleY},e.prototype.get_dx=function(){return this.dx},e.prototype.get_dy=function(){return this.dy},e.strokeBiasInvalidValue=42,e.inkMinTransparencyValue=0,e}();(0,o.l)(jS,"dcfe9273$InkStroke",null,[]);var QS=function(){function e(){}return e.createDrawingInkNodeWithRelativeCoordinates=function(t,n){var i=e.createAndRegisterInk14ObjectFromInkStroke(t,n),r=(0,y.e)(mm.k,WS.c.get_instance().createInstance(393236));return r&&(r.setValue(rs.o.ink14,i),r.setValue(is.b.scaleFactorX,n.get_scaleX()),r.setValue(is.b.scaleFactorY,n.get_scaleY()),r.setValue(is.b.offsetFromParentHoriz,n.get_dx()),r.setValue(is.b.offsetFromParentVert,n.get_dy())),r},e.createAndRegisterStroke14PropertiesObject=function(e,t){var n=(0,y.e)(xs.b,WS.c.get_instance().createInstance(1179720));qS.setStrokePacketDescriptions(n,t.get_packetDescriptions()),qS.setStrokeHeightFromStrokeProperties(n,t.get_inkDrawingHeight()),qS.setStrokeWidthFromStrokeProperties(n,t.get_inkDrawingWidth()),qS.setStrokeColorFromStrokeProperties(n,t.get_inkColor()),qS.setPenTipFromStrokeProperties(n,t.get_penTip()),qS.setTransparencyFromStrokeProperties(n,t.get_transparency()),qS.setRasterOperationFromStrokeProperties(n,t.get_rasterOperation()),qS.setIgnorePressureFromStrokeProperties(n,t.get_ignorePressure()),qS.setAntiAliasedFromStrokeProperties(n,t.get_antiAliased()),qS.setFitToCurveFromStrokeProperties(n,t.get_fitToCurve()),t.inkPropertiesObjectId!==mt.h.get_nil()?e.registerObject(n,t.inkPropertiesObjectId):(n=e.registerSharedObject(n),t.inkPropertiesObjectId=n.get_id()),S.ULS.sendTraceTag(17098837,339,100,"Registered a new Stroke14PropertiesObject with ObjectId {0}",t.inkPropertiesObjectId)},e.createAndRegisterInk14ObjectFromInkStroke=function(t,n){e.CreateAndRegisterStroke14Object(t,n);var i=(0,y.e)(xs.b,WS.c.get_instance().createInstance(131131));return qS.setInk14StrokeIds(i,[n.inkStrokeObjectId]),t.registerObject(i)},e.CreateAndRegisterStroke14Object=function(e,t){var n=(0,y.e)(xs.b,WS.c.get_instance().createInstance(131143));if(n){qS.setRawStrokePacketData(n,t.data),n.setValue(rs.o.inkExtendedProp_Lid,t.get_lcid());var i=t.get_strokeBias();-1===t.get_strokeBias()&&(i=jS.strokeBiasInvalidValue),n.setValue(rs.o.inkExtendedProp_StrokeBasis,i),qS.setStrokePropertiesId(n,t.get_inkProperties().inkPropertiesObjectId),t.inkStrokeObjectId!==mt.h.get_nil()?e.registerObject(n,t.inkStrokeObjectId):t.inkStrokeObjectId=e.registerObject(n),S.ULS.sendTraceTag(17098839,339,100,"Registered a new Stroke14Object with ObjectId {0}",t.inkStrokeObjectId)}},e}();(0,o.l)(QS,"d9a8153d$InkNodeEditUtilities",null,[]);var JS=function(){function e(){}return e.transformToRelativeCoordinates=function(t){t.isDataInAbsoluteCoordinates&&(t.data=e.translateAndReformatInkPacketsToRelativeValues(t.data,t.get_inkProperties().get_packetDescriptions()),t.isDataInAbsoluteCoordinates=!1)},e.translateAndReformatInkPacketsToRelativeValues=function(e,t){var n=new Array(e.length),i=t.get_count();if(e.length%t.get_count())return S.ULS.sendTraceTag(17098846,339,10,"Invalid packet description length!"),[];for(var r=e.length/i,o=0;o<i;o++){n[o*r]=e[o];for(var a=n[o*r],l=1;l<r;l++){var s=e[l*i+o];n[l+o*r]=s-a,a=s}}return n},e}();(0,o.l)(JS,"a593c1bf$InkStrokeTransform",null,[]);var XS=function(){function e(e,t,n,i,r){this.format=null,this.max=0,this.min=0,this.units=0,this.resolution=0,this.format=e,this.max=n,this.min=t,this.units=i,this.resolution=r}return e.prototype.get_format=function(){return this.format},e.prototype.get_max=function(){return this.max},e.prototype.get_min=function(){return this.min},e.prototype.get_units=function(){return this.units},e.prototype.get_resolution=function(){return this.resolution},e.prototype.toString=function(){return String.format('["{0}",{1},{2},{3},{4}]',this.get_format(),this.get_min().toString(),this.get_max().toString(),this.get_units().toString(),this.get_resolution())},e.prototype.logUnexpectedPacketDescriptionValues=function(){Rn.l.toLower(this.get_format())===$S.s.xLowerCaseCoordinateGuid||Rn.l.toLower(this.get_format())===$S.s.yLowerCaseCoordinateGuid?(this.get_resolution()!==e.expectedXAndYResolutionInHimetric&&S.ULS.sendTraceTag(17098848,339,10,"Unexpected resolution in {0} dimension: expected:{1} actual:{2}",this.get_format(),e.expectedXAndYResolutionInHimetric,this.get_resolution()),this.get_units()!==e.ExpectedXAndYUnits&&S.ULS.sendTraceTag(17098850,339,10,"Unexpected units in {0} dimension: expected:{1} actual:{2}",this.get_format(),e.ExpectedXAndYUnits,this.get_units())):this.get_format()===$S.s.pressureLowerCaseCoordinateGuid?this.get_max()!==e.expectedPressureMaxValue&&S.ULS.sendTraceTag(17098880,339,10,"Unexpected Max in pressure dimension: expected:{0} actual:{1}",e.expectedPressureMaxValue,this.get_max()):S.ULS.sendTraceTag(17098882,339,15,"Unexpected dimension: {0}",this.get_format())},e.get_xPacketDescription=function(){return new e($S.s.xLowerCaseCoordinateGuid,e.Int32MinValue,e.Int32MaxValue,2,1e3)},e.get_yPacketDescription=function(){return new e($S.s.yLowerCaseCoordinateGuid,e.Int32MinValue,e.Int32MaxValue,2,1e3)},e.get_pressurePacketDescription=function(){return new e($S.s.pressureLowerCaseCoordinateGuid,0,32767,0,0)},e.Int32MinValue=-2147483648,e.Int32MaxValue=2147483647,e.expectedXAndYResolutionInHimetric=1e3,e.ExpectedXAndYUnits=2,e.expectedPressureMaxValue=32767,e}();(0,o.l)(XS,"6b64f5e5$PacketDescription",null,[]);var YS=function(){function e(){}return e.prototype.createAndRegisterInkNode=function(t,n){S.ULS.sendTraceTag(17098773,339,50,"InkEditor: Creating a new ink stroke");var i=e.getPacketDescriptionFromInkStrokeParameters(n),r=n.properties.isHighlighter?9:0,o=new zS(i,n.properties.strokeDimensions.strokeHeight,n.properties.strokeDimensions.strokeWidth,n.properties.inkColor,mt.h.get_nil(),n.properties.penTip,n.properties.transparency,r,!1,!0,!0,null);QS.createAndRegisterStroke14PropertiesObject(t.get_containingObjectSpace(),o);var a=new jS(mt.h.get_nil(),mt.h.get_nil(),n.oneNoteCoordinates,0,2,!1,o,1,1,0,0,!0,null);JS.transformToRelativeCoordinates(a);var l=QS.createDrawingInkNodeWithRelativeCoordinates(t.get_containingObjectSpace(),a),s=new ha.g;return s.set(t),s.addChild(l,1),l},e.getPacketDescriptionFromInkStrokeParameters=function(e){if(e.properties.hasPressure){var t=void 0;return(t=new C.c(XS)).add(XS.get_xPacketDescription()),t.add(XS.get_yPacketDescription()),t.add(XS.get_pressurePacketDescription()),t}var n=void 0;return(n=new C.c(XS)).add(XS.get_xPacketDescription()),n.add(XS.get_yPacketDescription()),n},e}();(0,o.l)(YS,"d60b2992$InkEditor",null,[HS.y]);var ZS=n(9521),eb=n(9575),tb=n(5867),nb=function(){function e(){}return e.prototype.buildInkThicknessProps=function(){return this.GetInkThicknessDropdownProperties()},e.prototype.buildInkThicknessXml=function(){return this.GetInkThicknessDropDownXml()},e.prototype.GetInkThicknessDropDownXml=function(){var e=this.GetInkThicknessDropdownProperties();return e?Yu.s.getXmlFromMenuProps(e):""},e.prototype.GetInkThicknessDropdownProperties=function(){var e=(0,U.m)(new $o.b,{Id:"menuInkThicknessDropDown",MenuSectionList:[]});return Array.add(e.MenuSectionList,this.GetInkThicknessPositions()),e},e.prototype.GetInkThicknessPositions=function(){for(var t=(0,U.m)(new zo.x,{Id:"msInkThicknessPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),n=(0,U.m)(new Fu.b,{Type:2,Id:"galleryInkThicknessPosition",ExternalId:"InkThickness",ExternalGalleryId:"InkThicknessGallery",Width:e.NoOfPositionPerRow,ElementDimensions:"Size85by16",GalleryItems:new Array(0)}),i=eb.k.getUIThicknessOptionCount(),r=tb.u.getCurrentInkColorCss(),o=0;o<i;o++)Array.add(n.GalleryItems,this.GetGalleryButtonForInkThickness(o,r));return Array.add(t.ControlList,n),t},e.prototype.GetGalleryButtonForInkThickness=function(e,t){var n=eb.k.getUIOptionForIndex(e),i="",r="";n&&(i=3===Ti.App.oneNoteInputMode?n.highlighterDimensions.getMillimetersForCaption():n.penDimensions.getMillimetersForCaption(),r=n.getGalleryHeightPixels());var o=(0,U.m)(new ZS.n,{Id:String.format("{0}_{1}","ThicknessOption",e),Command:"737662428",QueryCommand:"2890613869",Alt:i});return L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()?(o.Style=this.GetCssStyleDictionaryForGalleryButton(r,t),o.LabelText=i):o.InnerHTML=Rn.l.xmlEncode(this.GetInnerHtmlForGalleryButton(r,t)),o},e.prototype.GetCssStyleDictionaryForGalleryButton=function(e,t){var n={};"#ffffff"===Rn.l.toLower(t)&&(t="#000000");var i,r=0;return Rn.l.parseNumberAndUnitsFromString(e,[7],L.AFrameworkApplication.get_numberFormat(),(0,g.m)((function(){return r}),(function(e){return r=e})),(0,g.m)((function(){return i}),(function(e){return i=e}))),r<1&&(e="1px"),n.height=e,n["background-color"]=t,n["font-size"]="0px",n.position="absolute",n.left="0",n},e.prototype.GetInnerHtmlForGalleryButton=function(e,t){"#ffffff"===Rn.l.toLower(t)&&(t="#000000");return String.format('<div class="InkThicknessOuterDiv"><div class="InkThicknessMiddleDiv"><div class="InkThicknessInnerDiv"><div class="InkThicknessDiv" style="height:{0}; background-color:{1}"></div></div></div></div>',e,t)},e.NoOfPositionPerRow=1,e}();(0,o.l)(nb,"4f799db8$InkThicknessUIBuilder",null,[GS]);var ib=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.InkEditors"},e.prototype.configure=function(e){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInkInputEnabled")&&(e.register(YS).as(HS.y).singleInstance().usingFactory((function(){return new YS})),e.register(nb).as(GS).singleInstance().usingFactory((function(){return new nb})))},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(ib,"7764f62f$OneNoteInkEditorsPackage",null,[s.u,u.s]);var rb=n(3501),ob=n(2818),ab=n(2158),lb=n(6147),sb=function(){function e(){}return e.Base62Chars="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",e.Base16Chars="0123456789abcdef",e.WacData="wd=",e.EndField="&",e.Seperator="-",e.GuidLength=32,e}();(0,o.l)(sb,"aa345c8c$HashedInternalLinkConstants",null,[]);var ub=function(){function e(){this.Url=null,this.IsRelativeLink=!1,this.IsInternalLink=!1,this.DecomposeSuccess=!1,this.Protocol=null,this.SectionGroup=null,this.SectionName=null,this.SectionId=null,this.PageName=null,this.PageId=null,this.BasePath=null,this.PreserveLink=!1,this.Url="",this.IsRelativeLink=!1,this.IsInternalLink=!1,this.DecomposeSuccess=!1,this.Protocol="",this.SectionGroup=null,this.SectionName="",this.SectionId="",this.PageName="",this.PageId="",this.BasePath="",this.PreserveLink=!1}return e.PageInSection=function(t,n){t.PageId=e.Base16Base62Converter(n[n.length-1],sb.Base62Chars,sb.Base16Chars),t.PageName=unescape(n[n.length-2])},e.SectionInNotebook=function(t,n){t.SectionId=e.Base16Base62Converter(n[n.length-1],sb.Base62Chars,sb.Base16Chars),t.SectionName=unescape(n[n.length-2])},e.PageInNotebook=function(t,n){t.PageId=e.Base16Base62Converter(n[n.length-1],sb.Base62Chars,sb.Base16Chars),t.SectionId=e.Base16Base62Converter(n[n.length-2],sb.Base62Chars,sb.Base16Chars),t.PageName=unescape(n[n.length-3]),t.SectionName=unescape(n[n.length-4])},e.SectionWithSgInNotebook=function(t,n){t.SectionId=e.Base16Base62Converter(n[n.length-1],sb.Base62Chars,sb.Base16Chars),t.SectionName=unescape(n[n.length-2]),t.SectionGroup=[];for(var i=0;n.length-3-i>=0;)Array.insert(t.SectionGroup,i,unescape(n[n.length-3-i])),i++;t.SectionGroup.reverse()},e.PageWithSgInNotebook=function(t,n){t.PageId=e.Base16Base62Converter(n[n.length-1],sb.Base62Chars,sb.Base16Chars),t.SectionId=e.Base16Base62Converter(n[n.length-2],sb.Base62Chars,sb.Base16Chars),t.PageName=unescape(n[n.length-3]),t.SectionName=unescape(n[n.length-4]),t.SectionGroup=[];for(var i=0;n.length-5-i>=0;)Array.insert(t.SectionGroup,i,unescape(n[n.length-5-i])),i++;t.SectionGroup.reverse()},e.Base16Base62Converter=function(e,t,n){var i=null;if(n===sb.Base62Chars)(i=e.split("-")).length;else if(n===sb.Base16Chars){i=[e.substring(0,6),e.substring(6,9),e.substring(9,12),e.substring(12,15),e.substring(15,24)]}for(var r=t.length,o=n.length,a=new Sys.StringBuilder,l=0;l<5;l++){for(var s=0,u=i[l].length,c=0;c<u;c++)s=s*r+t.indexOf(i[l].charAt(c));if(s<0)return"0";for(var d=s%o,g=n.charAt(d),p=Math.floor(s/o);p;)d=p%o,p=Math.floor(p/o),g=n.charAt(d)+g;n===sb.Base62Chars?(5!==g.length&&8!==g.length&&2!==g.length||(g="0"+g),a.append(g)):n===sb.Base16Chars&&(7!==g.length&&3!==g.length&&11!==g.length||(g="0"+g),a.append(g),4!==l&&a.append("-"))}return a.toString()},e}();(0,o.l)(ub,"b092c73$HyperlinkData",null,[]);var cb=function(){function e(){}return e.prototype.GetInternalUrl=function(t){for(var n=[];t&&t!==yi.App.theNotebookManager.get_mainGraphRoot()&&(yi.App.notebookMode||!lb.j.isSectionNode(t));)Array.add(n,t),t=t.getParentGraphSpace();for(var i=new Sys.StringBuilder,r=null,o=null,a=!0,l=n.length-1;l>-1;l--){a=!0;var s=n[l];if(ab.FolderReader.isSectionGroupNode(s)){var u=this.FormatForURL(Ha.HyperlinkReader.onenoteCharEscape(ab.FolderReader.getTitle(s)));i.append(u)}else if(lb.j.isSectionNode(s)){var c=lb.j.getFileName(s);c||(c=Box4Intl.Box4Strings.l_UntitledSection),c=this.FormatForURL(Ha.HyperlinkReader.onenoteCharEscape(c)),i.append(c);var d=new ha.g;d.set(s),d.tryToRootAtAncestorOfType(4),d.returnToAncestorOfType(4)&&d.get_currentNode().get_properties().hasProperty(k_.w.fileIdentityGuid)&&(r=d.get_currentNode().get_properties().getValue(String,k_.w.fileIdentityGuid))}else if(e.get_PageReader().isPageNode(s)){var g=Ha.HyperlinkReader.getFriendlyPageTitle(e.get_PageReader().getTitle(s));g=this.FormatForURL(Ha.HyperlinkReader.onenoteCharEscape(g)),i.append(g),o=e.get_PageReader().getNotebookManagementEntityId(s).toString()}else e.get_PageReader().isVersionHistoryNode(s)?i.append(e.get_PageReader().versionHistoryContext.toString()):e.get_PageReader().isVersionNode(s)?i.append(s.get_contextId().toString()):e.get_PageReader().isConflictPageNode(s)?i.append(s.get_objectSpaceId().toString()):a=!1;a&&i.append("-")}var p=this.EncodeIds(r,o);return i.append(p),i.toString()},e.prototype.buildTargetArgHash=function(t){for(var n=[];t&&t!==yi.App.theNotebookManager.get_mainGraphRoot()&&(yi.App.notebookMode||!lb.j.isSectionNode(t));)Array.add(n,t),t=t.getParentGraphSpace();for(var i=new Sys.StringBuilder,r=null,o=null,a=!0,l=n.length-1;l>-1;l--){a=!0;var s=n[l];if(ab.FolderReader.isSectionGroupNode(s)){var u=this.FormatForURL(ab.FolderReader.getTitle(s));i.append(u)}else if(lb.j.isSectionNode(s)){var c=lb.j.getFileName(s);c||(c=Box4Intl.Box4Strings.l_UntitledSection),c=this.FormatForURL(c),i.append(c);var d=new ha.g;d.set(s),d.tryToRootAtAncestorOfType(4),d.returnToAncestorOfType(4)&&d.get_currentNode().get_properties().hasProperty(k_.w.fileIdentityGuid)&&(r=d.get_currentNode().get_properties().getValue(String,k_.w.fileIdentityGuid))}else if(e.get_PageReader().isPageNode(s)){var g=Ha.HyperlinkReader.getFriendlyPageTitle(e.get_PageReader().getTitle(s));g=this.FormatForURL(g),i.append(g),o=e.get_PageReader().getNotebookManagementEntityId(s).toString()}else e.get_PageReader().isVersionHistoryNode(s)?i.append(e.get_PageReader().versionHistoryContext.toString()):e.get_PageReader().isVersionNode(s)?i.append(s.get_contextId().toString()):e.get_PageReader().isConflictPageNode(s)?i.append(s.get_objectSpaceId().toString()):a=!1;a&&i.append("-")}var p=this.EncodeIds(r,o);return i.append(p),i.toString()},e.prototype.FormatForURL=function(e){return e=(e=(e=(e=e.replace(new RegExp("\\.","g"),"..")).replace(new RegExp("\\-","g"),".-")).replace(new RegExp("\\_","g"),"._")).replace(new RegExp("\\s","g"),"_")},e.prototype.EncodeIds=function(e,t){return e||t?e?t?ub.Base16Base62Converter(e,sb.Base16Chars,sb.Base62Chars)+"-"+ub.Base16Base62Converter(t,sb.Base16Chars,sb.Base62Chars):ub.Base16Base62Converter(e,sb.Base16Chars,sb.Base62Chars):ub.Base16Base62Converter(t,sb.Base16Chars,sb.Base62Chars):null},e.prototype.buildTargetArgForPageUrl=function(e){return"target("+this.buildPageTargetStr(e)+")"},e.prototype.buildPageTargetStr=function(t){for(var n=[];t&&t!==yi.App.theNotebookManager.get_mainGraphRoot()&&(yi.App.notebookMode||!lb.j.isSectionNode(t));)Array.add(n,t),t=t.getParentGraphSpace();for(var i=new Sys.StringBuilder,r=!0,o=n.length-1;o>-1;o--){r=!0;var a=n[o];if(ab.FolderReader.isSectionGroupNode(a))i.append(Ha.HyperlinkReader.onenoteCharEscape(ab.FolderReader.getTitle(a)));else if(lb.j.isSectionNode(a)){var l=lb.j.getFileName(a);l||(l=Box4Intl.Box4Strings.l_UntitledSection),i.append(Ha.HyperlinkReader.onenoteCharEscape(l)),i.append(Ha.HyperlinkReader.onenoteFileExtension),i.append("|");var s=new ha.g;s.set(a),s.tryToRootAtAncestorOfType(4),s.returnToAncestorOfType(4)&&s.get_currentNode().get_properties().hasProperty(k_.w.fileIdentityGuid)&&i.append(s.get_currentNode().get_properties().getValue(String,k_.w.fileIdentityGuid))}else if(e.get_PageReader().isVersionHistoryNode(a))i.append(e.get_PageReader().versionHistoryContext.toString());else if(e.get_PageReader().isVersionNode(a))i.append(a.get_contextId().toString());else if(e.get_PageReader().isConflictPageNode(a))i.append(a.get_objectSpaceId().toString());else if(e.get_PageReader().isPageNode(a)){var u=Ha.HyperlinkReader.getFriendlyPageTitle(e.get_PageReader().getTitle(a));i.append(Ha.HyperlinkReader.onenoteCharEscape(u)),i.append("|"),i.append(e.get_PageReader().getNotebookManagementEntityId(a).toString())}else r=!1;r&&i.append("/")}return i.toString()},e.get_PageReader=function(){return $s.PageReader.get_instance()},e}();(0,o.l)(cb,"87390cb3$InternalLinkBuilder",null,[rb.s]);var db=n(4615),gb=n(3600),pb=n(7516),hb=n(6595),_b=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this._sectionEditor=null,this._embedMode=!1,this.SectionNodeIdx=0,this._messageSender=null,this.MethodToRunAfterLoad=null,this.MethodToRunAfterLoadFail=null,this.CallbackData=null,this._unescapedCharacters=[new gb.o(new RegExp("\\\\\\\\","g"),"%5c"),new gb.o(new RegExp("\\\\/","g"),"%2F"),new gb.o(new RegExp("\\\\\\|","g"),"%7c"),new gb.o(new RegExp("\\\\\\)","g"),"%29")],this._embedMode=e,this._embedMode&&(this._messageSender=new $C(n,t))}return e.prototype.get_SectionEditor=function(){return this._sectionEditor||(this._sectionEditor=Ge.w.get_instance().resolve(db.f))},e.prototype.get_PageReader=function(){return $s.PageReader.get_instance()},e.prototype.createInternalLinkManagerWithCallBack=function(t,n,i){var r=new e(!1);return r.MethodToRunAfterLoad=t,r.MethodToRunAfterLoadFail=n,r.CallbackData=i,r},e.prototype.ActivatePageInSection=function(e,t,n,i,r){if(!n&&!t){var o=lb.j.getFirstVisiblePageIfLoaded(e);return o?yi.App.get_activeAppFrame().workspace.set_activePage(o):yi.App.get_activeAppFrame().workspace.set_activeSection(e),void this.OnNavigationSucceeded(i,n)}var a=this.FindBestMatchingPageInSection(e,t,n);a?(yi.App.get_activeAppFrame().workspace.set_activePage(a),this.OnNavigationSucceeded(i,this.get_PageReader().getNotebookManagementEntityId(a).toString())):this.OnNavigationFailed(i,n,r)},e.prototype.FindBestMatchingPageInSection=function(e,t,n){t=t?Ha.HyperlinkReader.getFriendlyPageTitle(t).toLowerCase():"",n=n?n.toLowerCase():"";var i=null,r=null,o=new ha.g;if(o.set(e),!o.goToFirstChildByRole(49))return null;do{var a=o.get_currentNode();switch(this.MatchPage(a,t,n)){case 0:return a;case 1:i=a;break;case 2:r=a}}while(o.goToNextSiblingByRole(49));return i||(r||null)},e.prototype.MatchPage=function(e,t,n){var i,r=Ha.HyperlinkReader.getFriendlyPageTitle(this.get_PageReader().getTitle(e)).toLowerCase()===t;return i=this.get_PageReader().getNotebookManagementEntityId(e).toString().toLowerCase()===n,r&&i?0:r?1:i?2:3},e.prototype.SetVisiblePageAfterLoad=function(e){var t=e[this.SectionNodeIdx],n=yi.App.get_activeAppFrame().workspace.get_navigationPaneView(),i=t.getHtmlViewElement(n.get_viewId());i&&i.setIsLoading(!1),this.ActivatePageInSection(e[this.SectionNodeIdx],e[1],e[2],e[3],e[4])},e.prototype.FailedToNavigate=function(e,t){this.OnNavigationFailed(e[3],e[2],e[4])},e.prototype.SetVisiblePageAfterSectionGroupLoad=function(e){var t=e[5],n=e[6],i=e[this.SectionNodeIdx],r=e[1],a=e[2],l=e[3],s=e[4],u=yi.App.get_activeAppFrame().workspace.get_navigationPaneView(),c=i.getHtmlViewElement(u.get_viewId());if(c&&c.onSectionGroupContentLoaded(!0),t.length>n+1){var d=t[n+1],g=new ha.g;g.set(i);for(var p=g.goToLastChildByRole(49),h=!1;!h&&p;)ab.FolderReader.isSectionGroup(g)&&ab.FolderReader.getTitle(g.get_currentNode()).toLowerCase()===d.toLowerCase()?h=!0:p=g.goToPreviousSiblingByRole(49);if(!h)return void this.OnNavigationFailed(r,s,t);var _=p,m=yi.App.get_activeAppFrame().workspace.get_navigationPaneView(),f=_.getHtmlViewElement(m.get_viewId());f&&(f.setIsLoading(!0),f.setExpanded(!0)),ab.FolderReader.get_instance().loadIfNecessaryAndNavigate(p,o.i(this,this.SetVisiblePageAfterSectionGroupLoad,"SetVisiblePageAfterSectionGroupLoad"),null,[p,r,a,l,s,t,n+1])}else{if(yi.App.get_activeAppFrame().workspace.get_contentView().get_isPageView())yi.App.get_activeAppFrame().workspace.get_contentView().resume();this.activatePageInSectionGroup(e[this.SectionNodeIdx],e[1],e[2],e[3],e[4],e[5])}},e.prototype.activatePageInSectionGroup=function(e,t,n,i,r,a){var l=new ha.g;if(l.set(e),!t&&!n){var s=pb.FolderNavigator.getFirstVisiblePageIfLoaded(e);return s?(yi.App.get_activeAppFrame().workspace.set_activePage(s),void this.OnNavigationSucceeded(t,r)):void this.OnNavigationFailed(t,r,a)}var u=l.goToFirstChildByRole(49),c=null;if(t)for(t=Ha.HyperlinkReader.removeUndesirableHyperlinkChars(t).toLowerCase(),c=u;c&&(!lb.j.isSection(l)||Ha.HyperlinkReader.removeUndesirableHyperlinkChars(lb.j.getTitle(l.get_currentNode())).toLowerCase()!==t);)c=l.goToNextSiblingByRole(49);if(!c&&n&&u){n=n.toLowerCase(),l.set(u),l.tryToRootAtAncestorOfType(3);for(var d=l.returnToAncestorOfType(4);d&&(4!==l.get_currentNodeType()||d.get_properties().getValueWithDefault(String,k_.w.fileIdentityGuid,"").toLowerCase()!==n);)d=l.goToNextSibling();d&&(c=l.goToFirstChildByRole(48))}if(c){if(!c.get_isContentPresent()){var g=c;g.get_contentReplicator()||g.set_contentReplicator(WS.c.get_instance().createGraphSpaceReplicator(g,"InternalLink"));var p=yi.App.get_activeAppFrame().workspace.get_navigationPaneView(),h=g.getHtmlViewElement(p.get_viewId());return h&&(h.setIsLoading(!0),h.setExpanded(!0)),void this.get_SectionEditor().load(g,o.i(this,this.SetVisiblePageAfterLoad,"SetVisiblePageAfterLoad"),o.i(this,this.FailedToNavigate,"FailedToNavigate"),[g,i,r,t,a])}this.ActivatePageInSection(c,i,r,t,a)}else{if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInternalLinksSearchLoadedGraphIsEnabled")&&yi.App.notebookMode&&""!==n){var _=this.findSectionGroupContainingSection(n);if(_&&_!==e)return S.ULS.sendTraceTag(19010569,339,50,"InternalLinksManager found different sectionGroup containing section."),void this.activatePageInSectionGroup(_,t,n,i,r,null)}this.OnNavigationFailed(t,r,a)}},e.prototype.handleInternalLink=function(e){this.activatePage(e)},e.prototype.activatePage=function(e){try{e=unescape(decodeURI(e))}catch(t){e=unescape(e)}var t=this.DecomposeInternalLink(e),n=yi.App.get_activeAppFrame().workspace.get_activeSection(),i="";n&&(i=lb.j.getTitle(n).toLowerCase());var r=t.PageName,o=t.PageId,a=t.SectionName,l=t.SectionId;t.SectionGroup&&t.SectionGroup.length||""!==a||(a=i,t.SectionName=i);var s=this.GetRelativeFolderPath(t);if(yi.App.notebookMode||!(s&&s.length>=1||a!==i)){var u=null;if(n&&s){if(!this.NavigateThroughRelativeFolderPath(n,s,t,(0,g.m)((function(){return u}),(function(e){return u=e}))))return}else u||(u=n?n.getParentGraphSpace():yi.App.theNotebookManager.get_notebookNode());this.activatePageInSectionGroup(u,a,l,r,o,s)}else this.OnNavigationFailed(a,o,s,Box4Intl.Box4Strings.l_OpenCrossSectionLinkError)},e.prototype.GetRelativeFolderPath=function(e){var t=null;if(e.IsRelativeLink)t=e.SectionGroup;else{var n=yi.App.get_activeAppFrame().workspace.get_activeSection()?Rm.SectionNavigator.getContainingSectionGroups(yi.App.get_activeAppFrame().workspace.get_activeSection()):null;t=this.GetRelativeSectionGroupPath(e.SectionGroup,n)}return t},e.prototype.NavigateThroughRelativeFolderPath=function(e,t,n,i){for(var r=e.getParentGraphSpace(),a=null,l=0;l<t.length&&".."===t[l].toString();)a=(a=l?a:r).getParentGraphSpace(),l++;i.val=a;var s=new ha.g,u=null;if(l<t.length&&(u=t[l].toString()),u){i.val?s.set(i.val):s.set(yi.App.theNotebookManager.get_notebookNode()),i.val=s.goToLastChildByRole(49);for(var c=!1;!c&&i.val;)ab.FolderReader.isSectionGroup(s)&&ab.FolderReader.getTitle(s.get_currentNode()).toLowerCase()===u.toLowerCase()?c=!0:i.val=s.goToPreviousSiblingByRole(49);if(!c)return this.OnNavigationFailed(n.SectionName,n.PageId,t),!1;if(yi.App.get_activeAppFrame().workspace.get_contentView().get_isPageView())yi.App.get_activeAppFrame().workspace.get_contentView().suspend();var d=i.val,g=yi.App.get_activeAppFrame().workspace.get_navigationPaneView(),p=d.getHtmlViewElement(g.get_viewId());return p&&(p.setIsLoading(!0),p.setExpanded(!0)),ab.FolderReader.get_instance().loadIfNecessaryAndNavigate(i.val,o.i(this,this.SetVisiblePageAfterSectionGroupLoad,"SetVisiblePageAfterSectionGroupLoad"),null,[i.val,n.SectionName,n.SectionId,n.PageName,n.PageId,t,l,i.val]),!1}return!0},e.prototype.OnNavigationSucceeded=function(e,t){this._embedMode&&this._messageSender.sendNavigationResult(e,t,!0),this.MethodToRunAfterLoad&&this.MethodToRunAfterLoad(this.CallbackData)},e.prototype.OnNavigationFailed=function(e,t,n,i){if(void 0===i&&(i=null),this._embedMode)this._messageSender.sendNavigationResult(e,t,!1);else{this.MethodToRunAfterLoadFail?this.MethodToRunAfterLoadFail(this.CallbackData,14):this.ShowLinkOpenErrorDialog(i);var r=this.getUpLayersFromRelativeFolderPath(n),o=n?n.length-r:0;S.ULS.sendTraceTag(18661900,339,50,"Open internal link failed: {0} layers up and {1} layers down.",r,o)}},e.prototype.getUpLayersFromRelativeFolderPath=function(e){var t=0;if(e)for(var n=0;n<e.length;n++)".."===e[n].toString()&&t++;return t},e.prototype.GetRelativeSectionGroupPath=function(e,t){var n=null,i=t?t.length:0,r=e?e.length:0;if(i>0||r>0){for(var o=0;o<i&&o<r&&t[o].toString().toLowerCase()===e[o].toString().toLowerCase();o++);for(var a=o;a<i;a++)n||(n=[]),Array.add(n,"..");for(a=o;a<r;a++)n||(n=[]),Array.add(n,e[a].toString())}return n},e.prototype.tryConvertToRelativeLink=function(t,n,i,r,o){void 0===o&&(o=!1),n.val="",r.val="";try{t=unescape(decodeURI(t))}catch(e){t=unescape(t)}if(this.IsAbsoluteInternalLink(t)||this.IsWebNotebookInternalLink(t)){var a=this.DecomposeInternalLink(t);if(!a||!a.DecomposeSuccess)return!1;if(a.PreserveLink)return!1;if(a.IsRelativeLink)return!1;n.val=_S.u.protocolOnenote,o&&(n.val+=Ti.App.notebookName+"\\");var l=a.SectionGroup,s=Rm.SectionNavigator.getContainingSectionGroups(yi.App.get_activeAppFrame().workspace.get_activeSection()),u=o?l:this.GetRelativeSectionGroupPath(l,s);n.val+=u&&u.length?u.join("\\")+"\\":"",l&&i&&(r.val=l[l.length-1].toString());var c=a.SectionName,d=a.SectionId;if(u&&""===c&&""===d)return n.val+="#",n.val=e.AddBasePathToRelativeLink(n.val,a.BasePath),!0;if(""!==c){var g=yi.App.get_activeAppFrame().workspace.get_activeSection(),p=lb.j.getTitle(g);(u||p!==c||o)&&(n.val+=c+Ha.HyperlinkReader.onenoteFileExtension),i&&(r.val=c)}else i&&(r.val=Box4Intl.Box4Strings.l_UntitledSection);n.val+="#";var h=a.PageName,_=a.PageId;return""===h&&""===_?(""!==d&&(n.val+=String.format("{0}={{{1}}}",_S.u.onenoteSectionId,d)),n.val=e.AddBasePathToRelativeLink(n.val,a.BasePath),!0):(""!==h?(n.val+=Ha.HyperlinkReader.getFriendlyPageTitle(h),i&&(r.val=h)):i&&(r.val=Box4Intl.Box4Strings.l_UntitledPageText),""!==d&&(n.val+=String.format("&{0}={{{1}}}",_S.u.onenoteSectionId,d)),""!==_&&(n.val+=String.format("&{0}={{{1}}}",_S.u.onenotePageId,_)),n.val=e.AddBasePathToRelativeLink(n.val,a.BasePath),!0)}return!1},e.prototype.ShowLinkOpenErrorDialog=function(e){void 0===e&&(e=null);var t=new Vn.StandardDialog;t.set_buttonsOption(0),t.showWarning(CommonUIStrings.l_DefaultDialogTitle,e||Box4Intl.Box4Strings.l_LinkOpenError,null)},e.prototype.IsValidInternalLinkProtocol=function(t){return t.substr(0,_S.u.protocolOnenote.length).toLowerCase()===_S.u.protocolOnenote||t.substr(0,Ha.HyperlinkReader.protocolHttp.length).toLowerCase()===Ha.HyperlinkReader.protocolHttp||t.substr(0,e.ProtocolHttps.length).toLowerCase()===e.ProtocolHttps},e.prototype.isInternalLink=function(e){return!(!Gl.n.get_instance().get_item(12)||!e)&&(e=unescape(e),!!this.IsValidInternalLinkProtocol(e)&&(this.IsRelativeInternalLink(e)||this.IsAbsoluteInternalLink(e)||this.IsWebNotebookInternalLink(e)))},e.prototype.isClientUrl=function(e){if(!e)return!1;try{e=unescape(decodeURI(e))}catch(t){e=unescape(e)}e=e.toLowerCase();var t=this.GetClientNotebookLink(),n=this.GetClientNotebookWebLink();return!!(""!==n&&e.startsWith(n)||""!==t&&e.startsWith(t))},e.prototype.GetInternalLinkType=function(e){return Gl.n.get_instance().get_item(12)?(e=e.toLowerCase(),this.IsRelativeInternalLink(e)?1:this.IsWebNotebookInternalLink(e)?3:this.IsAbsoluteInternalLink(e)?2:0):0},e.prototype.IsWebNotebookInternalLink=function(e){if(!Gl.n.get_instance().get_item(12))return!1;e=e.toLowerCase();var t=this.GetWebNotebookViewLink(),n=this.GetWebNotebookEditLink(),i=this.GetClientNotebookWebLink();if(""!==t&&e.startsWith(t)||""!==n&&e.startsWith(n)||""!==i&&e.startsWith(i))return!0;var r=Oe.n.getParameterValue(e,_S.u.oneDriveResId);if(!r)return!1;var o=Oe.n.getHost(e),a=Oe.n.getHost(t),l=Oe.n.getParameterValue(t,_S.u.oneDriveResId);return o===a&&r===l},e.prototype.IsAbsoluteInternalLink=function(e){if(!Gl.n.get_instance().get_item(12))return!1;e=e.toLowerCase();var t=this.GetClientNotebookLink();return""!==t&&e.startsWith(t)},e.prototype.IsRelativeInternalLink=function(t){return!!Gl.n.get_instance().get_item(12)&&((t=t.toLowerCase()).startsWith(_S.u.protocolOnenote)&&!t.startsWith(_S.u.protocolOnenote+Ha.HyperlinkReader.protocolHttp)&&!t.startsWith(_S.u.protocolOnenote+e.ProtocolHttps))},e.prototype.GetClientNotebookLink=function(){return yi.App.get_clientEditDocumentUrl()?unescape(decodeURI(_S.u.protocolOnenote+yi.App.get_clientEditDocumentUrl())).toLowerCase():""},e.prototype.GetClientNotebookWebLink=function(){var t=this.GetClientNotebookLink();if(""===t)return"";var n=t.length-1;"/"===t.substr(n,1)&&n--;var i=t.lastIndexOf("/",n);n=i-1,i=t.lastIndexOf("/",n);var r=t.substr(i+1);return unescape(Oe.n.getAbsoluteUrl("OneNote.aspx?"+e.WebLinkIdField+"=/"+r)).toLowerCase()},e.prototype.GetWebNotebookViewLink=function(){return yi.App.hostUrl?unescape(decodeURI(Oe.n.getAbsoluteUrl(yi.App.hostUrl))).toLowerCase():""},e.prototype.GetWebNotebookEditLink=function(){return yi.App.hostEditUrl?unescape(decodeURI(Oe.n.getAbsoluteUrl(yi.App.hostEditUrl))).toLowerCase():""},e.prototype.DecomposeInternalLink=function(e){var t=this.GetInternalLinkType(e);if(!t)return null;var n=new ub;switch(n.Url=e,n.IsInternalLink=!0,n.IsRelativeLink=1===t,t){case 1:this.DecomposeRelativeLink(n);break;case 2:this.DecomposeOnenoteClientLink(n);break;case 3:this.DecomposeWebNotebookLink(n)}return n},e.prototype.DecomposeRelativeLink=function(e){e.DecomposeSuccess=!1;var t=e.Url;e.Protocol=_S.u.protocolOnenote;var n=_S.u.protocolOnenote.length,i=t.indexOf("#",n),r=t.substring(n,i),o=t.substr(i+1);(""===r||(r=r.replace("/","\\"),this.DecomposeSGAndSection(r,"\\",e)))&&(""===o||this.DecomposePageAndId(o,e))&&(e.DecomposeSuccess=!0)},e.prototype.DecomposeOnenoteClientLink=function(e){var t=e.Url;e.Protocol=_S.u.protocolOnenote;var n=this.GetClientNotebookLink(),i="",r="",o=n.length;n.endsWith(Ha.HyperlinkReader.onenoteFileExtension)&&(o=n.lastIndexOf("/")+1);"/"===t.substr(o,1)&&o++;var a=t.indexOf("#",o);a<0?i=t.substr(o):(i=t.substring(o,a),r=t.substr(a+1)),(""===i||this.DecomposeSGAndSection(i,"/",e))&&(""===r||this.DecomposePageAndId(r,e))&&(e.DecomposeSuccess=!0)},e.prototype.DecomposeWebNotebookLink=function(e){switch(e.PreserveLink=e.Url.indexOf(_S.u.oneNotePreserveLink,0)>=0,this.GetWdTargetType(e.Url)){case 1:e.DecomposeSuccess=this.DecomposeWdField(e.Url,e);break;case 2:e.DecomposeSuccess=this.DecomposeWdHashField(e.Url,e)}},e.prototype.GetWdTargetType=function(e){return-1===e.indexOf(_S.u.wacDataTarget)?2:1},e.prototype.DecomposeSGAndSection=function(e,t,n){if(n.SectionGroup=null,n.SectionName="",""===e)return!0;for(var i=0,r=(e=this.OnenoteCharUnescapeEncode(e)).indexOf(t);r>=0;){n.SectionGroup||(n.SectionGroup=[]);var o=e.substring(i,r);""!==o&&Array.add(n.SectionGroup,unescape(o)),i=r+1,r=e.indexOf(t,i)}return i<e.length&&(n.SectionName=unescape(e.substr(i))),""!==n.SectionName&&(r=n.SectionName.toLowerCase().lastIndexOf(Ha.HyperlinkReader.onenoteFileExtension),n.SectionName=n.SectionName.substring(0,r)),!0},e.prototype.DecomposePageAndId=function(t,n){if(""===t)return!0;for(var i=0,r=(t=this.OnenoteCharUnescapeEncode(t)).indexOf("&",i),o=!0,a=0;a<50;){var l="",s=(l=r>=0?t.substring(i,r):t.substr(i)).toLowerCase(),u=-1===s.indexOf("{",0)?1:2,c=-1===s.indexOf("}",0)?0:1;if(s.startsWith(_S.u.onenoteSectionId)?n.SectionId=l.substring(_S.u.onenoteSectionId.length+u,l.length-c):s.startsWith(_S.u.onenotePageId)?n.PageId=l.substring(_S.u.onenotePageId.length+u,l.length-c):s.startsWith(e.OnenoteBasePath)?n.BasePath=unescape(l.substring(e.OnenoteBasePath.length+1,l.length)):o&&(n.PageName=unescape(l)),o=!1,r<0)break;i=r+1,r=t.indexOf("&",i),a++}return!0},e.prototype.DecomposeWdField=function(e,t){if(""===e)return!0;var n=(e=this.OnenoteCharUnescapeEncode(e)).indexOf(_S.u.wacDataTarget,0);if(n<0)return!1;if(n+=_S.u.wacDataTarget.length,"("!==e.substr(n,1))return!1;n++,"/"===e.substr(n,1)&&n++;var i=e.indexOf(")",n);if(i<0)return!1;var r=e.substring(n,i);"/"===r.substr(r.length-1,1)&&(r=r.substr(0,r.length-1)),i=r.length-1,"/"===r.substr(i,1)&&i--;for(var o=r.lastIndexOf("/",i),a=0;a<50;){var l="";if(""!==(l=o<0?r.substring(0,i+1):r.substring(o+1,i+1))){var s=!1,u=!1,c=l,d="",g=l.indexOf("|");g>=0?(c=l.substring(0,g),d=l.substr(g+1),c.toLowerCase().indexOf(Ha.HyperlinkReader.onenoteFileExtension)>=0?s=!0:u=!0):c.toLowerCase().indexOf(Ha.HyperlinkReader.onenoteFileExtension)>=0&&(s=!0),u?(t.PageName=unescape(c),t.PageId=d):s?(g=c.toLowerCase().lastIndexOf(Ha.HyperlinkReader.onenoteFileExtension),t.SectionName=unescape(c.substring(0,g)),t.SectionId=d):(t.SectionGroup||(t.SectionGroup=[]),Array.insert(t.SectionGroup,0,unescape(c)))}if(o<=0)break;i=o-1,o=r.lastIndexOf("/",i),a++}return!0},e.prototype.DecomposeWdHashField=function(e,t){if(""===e)return!0;var n=(e=this.OnenoteCharUnescapeEncode(e)).indexOf(sb.WacData,0),i=e.indexOf(sb.EndField,n);if(n<0||i<0)return!1;n+=sb.WacData.length;var r=e.substring(n,i),o=[];o=(r=(r=(r=(r=(r=r.replace(new RegExp("\\.\\.","g"),".")).replace(new RegExp("\\.\\-","g"),Rn.l.calcHashCode(".-").toString())).replace(new RegExp("\\.\\_","g"),Rn.l.calcHashCode("._").toString())).replace(new RegExp("\\_","g")," ")).replace(new RegExp(Rn.l.calcHashCode("._").toString(),"g"),"_")).split(sb.Seperator);for(var a=0;a<o.length;a++)o[a]=o[a].replace(new RegExp(Rn.l.calcHashCode(".-").toString(),"g"),"-");switch(this.GetLinkLocation(o)){case 1:ub.PageInSection(t,o);break;case 2:ub.SectionInNotebook(t,o);break;case 3:ub.PageInNotebook(t,o);break;case 4:ub.SectionWithSgInNotebook(t,o);break;case 5:ub.PageWithSgInNotebook(t,o);break;default:return!1}return!0},e.prototype.GetLinkLocation=function(e){var t=new RegExp("[a-zA-Z0-9]{24}"),n=t.exec(e[e.length-1]),i=t.exec(e[e.length-2]);return yi.App.notebookMode?n&&i?e.length>=5?5:3:n?e.length>=3?4:2:6:1},e.prototype.OnenoteCharUnescapeEncode=function(e){return Rn.l.encodeString(unescape(e),this._unescapedCharacters)},e.prototype.findSectionGroupContainingSection=function(e,t){void 0===t&&(t=null);var n=new hb.m;if(t||(t=yi.App.theNotebookManager.get_mainGraphRoot()),n.set(t),!n.goToFirstChildByRole(49))return null;do{var i=n.get_currentNode();if(lb.j.isSectionNode(i)){var r=lb.j.getFileIdentityGuid(i);if(r&&r.toLowerCase()===e)return(0,y.e)(mm.k,i.getParentGraphSpace())}if(ab.FolderReader.isFolderNode(i)){var o=this.findSectionGroupContainingSection(e,i);if(o)return o}}while(n.goToNextSiblingByRole(49));return null},e.AddBasePathToRelativeLink=function(t,n){return t+="&end",""!==n&&(t+="&"+e.OnenoteBasePath+"="+Rn.l.urlKeyValueEncode(n)),t=t.replace(new RegExp(" ","g"),"%20")},e.OnenoteBasePath="base-path",e.OnenoteObjectId="object-id",e.OnenoteAltObjectId="altobject-id",e.WebLinkIdField="id",e.ProtocolHttps="https://",e}();(0,o.l)(_b,"650aea01$InternalLinkManager",null,[ob.b,Na.v]);var mb=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"OneNote.InternalLinks"},e.prototype.init=function(){},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e,e.register(cb).as(rb.s).singleInstance().usingFactory((function(){return new cb})),e.register(_b).as(ob.b).as(Na.v).singleInstance().usingFactory((function(){return new _b(Ti.App.get_isEmbedMessageEnabled(),L.AFrameworkApplication.hostPostmessenger,L.AFrameworkApplication.appSettingsManager.get_appSettings().OneNoteEmbedHostingApp)}))},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(mb,"2d27dacf$OneNoteInternalLinksPackage",null,[s.u,u.s]);var fb,yb=(0,o.y)("dd0f6c12$IHierarchicalListEditorFactory"),Cb=n(9811),Sb=function(){function e(e,t){this.listReader=null,this._outlineElementEditor=null,this._pendingListInfo=null,this.listReader=e,this._outlineElementEditor=t,this._pendingListInfo=null}return e.prototype.get_shouldRemoveDestinationListBeforeMerge=function(){return!1},e.prototype.delistTableIfNecessary=function(e,t,n){},e.prototype.renumberForOEPasteIfNecessary=function(e){},e.prototype.removeListsFromTablesIfNecessary=function(e){},e.prototype.reapplyListInfoWithoutPargraphStyleIfNecessary=function(e,t){return e},e.prototype.setListInfo=function(e){var t,n,i;if(t=gs.ListReader.get_externalPasteImprovementsEnabled(),n=e.get_propertySet().getValueWithDefault(Number,os.j.listID,0),i=e.get_propertySet().getValueWithDefault(Number,os.j.listLevel,-1),Gl.n.get_instance().get_item(85)||t&&n>0&&i>=0)this._pendingListInfo=e;else{var r=1,o=e.get_listStyle();t&&42!==o&&o>0&&(r=o),this._pendingListInfo=e_.j.createFromScratch(e.get_listType(),r,null,n,i,void 0,"")}},e.prototype.setPendingListInfo=function(e){e&&(this._pendingListInfo=e)},e.prototype.setLeftIndentOnTableIfNecessary=function(e,t,n){},e.prototype.setListBaseStyleIfNecessary=function(e){},e.prototype.duplicateListLevelIfNecessary=function(e,t){},e.prototype.createList=function(e){var t=xr.y.get_instance().startActivity(Oi.u.createList);Ss.OutlineElementReader.isOutlineElement(e)||xr.y.get_instance().recordEvent("PossiblyIncorrectListCreation",{Reason:lh.i.doesNotContainOe}),gs.ListReader.isListOutlineElement(e)&&xr.y.get_instance().recordEvent("PossiblyIncorrectListCreation",{Reason:lh.i.containsList});var n=this.createListNode();return e.addChild(n,4),e.goToChild(n),t.end(),n},e.prototype.createListNode=function(){return ds.u.get_instance().createInstance(393234)},e.prototype.removeList=function(e){var t=xr.y.get_instance().startActivity(Oi.u.removeList);Ss.OutlineElementReader.isOutlineElement(e)||xr.y.get_instance().recordEvent("PossiblyIncorrectListRemoval",{Reason:lh.i.doesNotContainOe}),gs.ListReader.isListOutlineElement(e)&&this.removeOEListElement(e),t.end()},e.prototype.removeOEListElement=function(e){this.listReader.moveToList(e),e.disconnectNodeAndReturnToParent()},e.prototype.applyBulletsNumbering=function(e,t,n,i){void 0===i&&(i=!1);var r=xr.y.get_instance().startActivity(Oi.u.applyBulletNumbering);if(!this.canChangeListType(t,n.val))return!1;this.setRestartAtIfNeeded(e,n.val,i);var o=e.hasProperty(Pl.k.multipleOeSelection),a=e.getValueWithDefault(Boolean,Pl.k.isChainedAction,!1),l=!1;1===n.val.get_listMultiLevelType()&&n.val.get_isStyleSelected()&&!n.val.get_listStyleId()&&(l=!0);var s=n.val.get_propertySet().getValueWithDefault(String,os.j.listLevelText,null);if(s&&s===Box4Intl.Box4Strings.L_ListStyleNone&&(1===n.val.get_listType()?l=n.val.get_isStyleSelected()&&!n.val.get_listStyleId():n.val.get_listType()||(l=!n.val.get_listStyle())),a)l&&(n.val.setListStyle(16,0),e.setValue(Pl.k.listSoftType,16),e.setValue(Pl.k.listSoftStyle,0));else{var u=this.listReader.getListInfo(t);if(this.shouldToggleOff(n.val,u,o,l,e)&&(r.get_properties().set_item("ToggledOff","true"),n.val.setListStyle(16,0),this.SetListStyleAndTypeToNone(e)),!this.performAutoCorrectNumbering(e,t,n.val,i))return r.end(),!1;!n.val.get_listType()&&e.hasProperty(Pl.k.listLastStartAt)&&(n.val.set_restartAt(e.getValue(Number,Pl.k.listLastStartAt)),e.removeProperty(Pl.k.listLastStartAt))}return o&&(r.get_properties().set_item("MultipleOESelection","true"),this.shouldSkipEmptyOE(t,n))?(r.end(),!1):(this.adjustAndSetLevel(t,n.val,e,i),e.setValue(Pl.k.isChainedAction,!0),r.end(),!0)},e.prototype.shouldToggleOff=function(e,t,n,i,r){if(i)return!0;if(t){var o=e.get_listType()===t.get_listType(),a=!e.get_listStyle()&&e.get_restartAt()===Zh.z.startAtNone,l=e.get_listStyle()===t.get_listStyle()&&e.get_restartAt()===t.get_restartAt();if(this.listReader.get_listSymbolsImprovementsEnabled()){var s=(!e.get_isStyleSelected()||this.sameListLevelText(t,e))&&!n;l=l&&s}return o&&(a||l)}return!1},e.prototype.SetListStyleAndTypeToNone=function(e){e.setValue(Pl.k.listSoftType,16),e.setValue(Pl.k.listSoftStyle,0)},e.prototype.sameListLevelText=function(e,t){return!0},e.prototype.setRestartAtIfNeeded=function(e,t,n){},e.prototype.performAutoCorrectNumbering=function(e,t,n,i){return!0},e.prototype.canChangeListType=function(e,t){return!0},e.prototype.shouldSkipEmptyOE=function(e,t){return 16!==t.val.get_listType()&&Ss.OutlineElementReader.isEmpty(e,!0)},e.prototype.clearListFromParagraph=function(e){var t=xr.y.get_instance().startActivity(Oi.u.clearListFromParagraph);Ga.ParagraphReader.isParagraphNode(e)||xr.y.get_instance().recordEvent("ClearingListFromNonParagraph",{Reason:lh.i.doesNotContainParagraph});var n=new ha.g;n.set(e),n.tryToRootAtOutlineAncestor(),n.returnToNodeOfType(12),_s.OutlineElementNavigator.returnToOutlineElement(n),this.applyListInfo(n,null),t.end()},e.prototype.applyListInfoFromStyle=function(e,t){},e.prototype.merge=function(t,n,i,r){void 0===r&&(r=null);var o=xr.y.get_instance().startActivity(Oi.u.listMerge);if(Ss.OutlineElementReader.isOutlineElement(n)||xr.y.get_instance().recordEvent("PossibleIncorrectMergeOfOEs",{Reason:"SrcIsNotOE"}),Ss.OutlineElementReader.isOutlineElement(t)||xr.y.get_instance().recordEvent("PossibleIncorrectMergeOfOEs",{Reason:"DestIsNotOE"}),gs.ListReader.isListOutlineElement(n)){o.get_properties().set_item("UseSourceListWithNonlistDestination",i.toString());var a;if(a=gs.ListReader.get_externalPasteImprovementsEnabled(),i&&this.get_shouldRemoveDestinationListBeforeMerge()&&gs.ListReader.isListOutlineElement(t)&&this.removeList(t),!gs.ListReader.isListOutlineElement(t)||i&&a){if(i){L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings");var l=this.getListInfoForCopyPaste(n);this.listReader.get_switchListByRangeSelectionImprovementIsEnabled()&&l.get_propertySet().setProperty_Unchecked(is.b.listRestart,Zh.z.startAtNone),1===l.get_listMultiLevelType()&&l.checkValidMultilevelDefInfo(!0),this.applyListInfo(t,l),o.get_properties().set_item("MoveListInfoFromSrcToDestOE","true")}L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings"),e.get_listSettings().isQoEListExternalPasteImprovementIsEnabled&&this.CarrySourceListMarkerFontFormattingIntoDestinationList(n,t),this.removeList(n)}else this.listReader.get_qoEListInternalCCPImprovementIsEnabled()&&this.processNeededSourceListFormatIntoDestination(n,t),e.get_listSettings().isQoEListExternalPasteImprovementIsEnabled&&this.CarrySourceListMarkerFontFormattingIntoDestinationList(n,t),this.removeList(n);o.get_properties().set_item("RemoveListFromSrcOE","true")}return o.end(),!0},e.prototype.processNeededSourceListFormatIntoDestination=function(e,t){},e.prototype.CarrySourceListMarkerFontFormattingIntoDestinationList=function(e,t){var n=Ga.ParagraphReader.getFirstParagraphUnderNode(e.get_currentNode()),i=this.listReader.getListNodeFromOE(t);this.setListFormatting(i,n,null)},e.prototype.getListInfoForCopyPaste=function(e){return this.listReader.getListInfo(e)},e.prototype.setListFormatting=function(t,n,i){if(t){var r=Wa.y.create(n),o=vc.FormattingReader.getFormattingObject(r);this.SetListPropertyValue(Number,t,is.b.fontColor,i,o),this.SetListPropertyValue(Number,t,is.b.fontSize,i,o),this.SetListPropertyValue(String,t,is.b.font,i,o),this.SetListPropertyValue(Number,t,os.j.themeFont,i,o),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings"),e.get_listSettings().isQoEListExternalPasteImprovementIsEnabled&&(this.SetListPropertyValue(Boolean,t,is.b.bold,i,o),this.SetListPropertyValue(Boolean,t,is.b.italic,i,o),this.SetListPropertyValue(Boolean,t,is.b.superscript,i,o),this.SetListPropertyValue(Boolean,t,is.b.subscript,i,o))}},e.prototype.setProperPendingListInfoAfterPaste=function(e){},e.prototype.SetListPropertyValue=function(e,t,n,i,r){if(i&&i.hasProperty(n))t.setValue(n,i.getValue(e,n));else{if(!r||!r.get_cache())return;var o=r.get_cache();o.hasProperty(n)&&t.setValue(n,o.getValue(e,n))}},e.prototype.ensureValidPropertySetFromAction=function(e,t){return t.hasProperty(Pl.k.listSoftType)||(e===Oi.u.toggleBulletsList?t.setValue(Pl.k.listSoftType,1):e===Oi.u.toggleNumberedList&&t.setValue(Pl.k.listSoftType,0)),t.hasProperty(Pl.k.listSoftStyle)||t.setValue(Pl.k.listSoftStyle,0),t},e.prototype.autocorrectNumberList=function(t,n,i,r,o,a,l){var s=xr.y.get_instance().startActivity(Oi.u.autocorrectNumberList),u=this.listReader.getListInfo(n),c=e_.j.createFromScratch(0,i);if(c.set_restartAt(r),c.set_autoTriggerString(a),u&&c.hasMatchingListFormat(u)&&c.get_restartAt()===u.get_lastStartAt())s.end();else{var d=new Ma.GraphTransaction(15);d.setFromIterator(n),l.numbering(c.get_listType(),c.get_listStyle(),c.get_restartAt())&&e.get_CharacterPropertiesEditor().replaceTextRange(o,""),d.dispose(),s.end()}},e.get_CharacterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=Ge.w.get_instance().resolve(ba.x))},e.get_listSettings=function(){return e._listSettings||(e._listSettings=Ge.w.get_instance().tryResolve(t_.r))},e._characterPropertiesEditor=null,e._listSettings=null,e}();(0,o.l)(Sb,"500dfd5e$ListEditor",null,[jl.v]),function(e){e[e.number=0]="number",e[e.bullet=1]="bullet",e[e.lim=13]="lim",e[e.nil=14]="nil",e[e.any=15]="any",e[e.noList=16]="noList",e[e.invalid=42]="invalid"}(fb||(fb={})),(0,o.h)("53fa5b64$ListType",fb);var bb=n(1418),vb=n(3950),Tb=n(5818),Ab=n(2547),Ib=function(e){function t(t,n,i){var r=e.call(this,t,i)||this;return r._indentationEditorLazy=null,r._indentationEditorLazy=n,r}return(0,v.t)(t,e),t.prototype.get_HierarchicalListReader=function(){return this.listReader},t.prototype.setListInfoAndIndentAfterPaste=function(e,t){this.applyListInfo(e,this._pendingListInfo),this._pendingListInfo=null},t.prototype.setListInfoAndInsertNewOE=function(e,t,n,i){if(Ss.OutlineElementReader.isEmpty(e,!1)&&(gs.ListReader.isListOutlineElement(e)&&this.applyListInfo(e,null,!1,!1,-1),vb.b.isOutlineElementWithNoteTags(e)))bb.n.removeAllNoteTags(n.get_iterator());else{var r=this._outlineElementEditor.insertOutlineElementBelow(e);this._outlineElementEditor.splitAtIp(e,r,n,!1,!1,!0),this.IsTodoList(e)&&this.ExtendTodoList(r)}},t.prototype.shouldAutocorrectList=function(e){return!0},t.prototype.shouldTransferListInfo=function(e,t){return e&&t},t.prototype.setListInfo=function(t){Gl.n.get_instance().get_item(85)||xr.y.get_instance().recordEvent("PossibleLossOfListProperties",{Reason:"ImportListStyleIsNull"}),t.get_listStyle()&&e.prototype.setListInfo.call(this,t)},t.prototype.adjustAndSetLevel=function(e,t,n,i){this._indentationEditorLazy.get_value()||xr.y.get_instance().recordEvent("PossibleIncorrectListIndentation",{Reason:"IOutlineElementIndentationEditorIsNull"}),this._indentationEditorLazy.get_value()&&this._indentationEditorLazy.get_value().canDemote(e,1)&&1===Ss.OutlineElementReader.getAbsoluteOutlineLevel(e)&&!this.DoesOutlineHaveListofTypeAtLevel1(e,t)&&16!==t.get_listType()&&n.setValue(Pl.k.autoDemoteLists,!0),this.applyListInfo(e,t)},t.prototype.transferListInfo=function(e,t,n,i){var r=e_.j.createFromScratch(15,0);r.setFrom(this.GetListInfoFromOutlineElementNode(n)),r.clearNumbering(),this.applyListInfo(e,r)},t.prototype.GetListInfoFromOutlineElementNode=function(e){if(!gs.ListReader.isListOutlineElementNode(e))return xr.y.get_instance().recordEvent("PossibleLossOfListProperties",{Reason:"NotListOutlineNode"}),null;var t=new ha.g;return t.set(e),this.listReader.moveToList(t),this.get_HierarchicalListReader().getListInfoFromListNode(t)},t.prototype.DoesOutlineHaveListofTypeAtLevel1=function(e,t){var n=new ha.g;n.setFrom(e),fs.OutlineNavigator.returnToOutlineOrTableCell(n),ys.OutlineReader.isOutlineNode(n.get_currentNode())||xr.y.get_instance().recordEvent("PossibleIncorrectListIndentation",{Reason:lh.i.doesNotContainOe});for(var i=!1,r=n.goToFirstChildByRole(1);r;r=n.goToNextSiblingByRoleOrReturnToParent(1))if(!Ss.OutlineElementReader.isOutlineGroup(n)&&1===Ss.OutlineElementReader.getAbsoluteOutlineLevel(n)&&this.HasMatchingListType(n,t.get_listType())){n.returnToParent(),i=!0;break}return i},t.prototype.applyListInfo=function(e,t,n,i,r){var o=this;void 0===n&&(n=!0),void 0===i&&(i=!1),void 0===r&&(r=-1);var a=xr.y.get_instance().startActivity(Oi.u.applyListInfoLegacy);a.get_properties().set_item("ListTypeToApply",t?fb[t.get_listType()]:"null"),ha.g.executeVoidReturnWithDebugAssertRestored(e,(function(){if(!Ss.OutlineElementReader.isOutlineElement(e))return xr.y.get_instance().recordEvent("PossibleListStateNotUpdated",{Reason:lh.i.doesNotContainOe}),void a.end();if(!t||16===t.get_listType())return o.removeList(e),a.get_properties().set_item("ListRemoved","true"),void a.end();gs.ListReader.isListOutlineElement(e)||(o.createList(e),a.get_properties().set_item("CreatedList","true"),e.returnToParent());var n=o.listReader.getListInfo(e);if(!n||t.get_listType()===n.get_listType()&&t.hasMatchingListFormat(n)&&(!t.get_isOrdered()||t.get_restartAt()===n.get_restartAt()))return a.get_properties().set_item("NoOp","true"),void a.end();n.setFrom(t),a.end()}))},t.prototype.setListFormatting=function(e,t,n){},t.prototype.HasMatchingListType=function(e,t){return Ss.OutlineElementReader.isOutlineElement(e)||xr.y.get_instance().recordEvent("PossibleIncorrectListIndentation",{Reason:lh.i.doesNotContainOe}),!!gs.ListReader.isListOutlineElement(e)&&this.listReader.getListInfo(e).get_listType()===t},t.prototype.IsTodoList=function(e){if(vb.b.isOutlineElementWithNoteTags(e)){var t=new ha.g;if(t.setFrom(e),_s.OutlineElementNavigator.moveToContent(t)&&t.goToFirstChildByRole(58)&&Ab.b.goToNoteTagByType(t,0))return!0}return!1},t.prototype.ExtendTodoList=function(e){var t=new ha.g;t.setFrom(e),_s.OutlineElementNavigator.moveToContent(t)&&Tb.n.get_instance().insertDefaultNoteTag(t,0)},t}(Sb);(0,o.l)(Ib,"5ba342af$HierarchicalListEditor",Sb,[]);var wb=function(e){function t(t,n,i){var r=e.call(this,t,i)||this;return r._indentationEditorLazy=null,r._indentationEditorLazy=n,r}return(0,v.t)(t,e),t.prototype.get_HierarchicalListReader=function(){return this.listReader},t.prototype.setListInfoAndIndentAfterPaste=function(e,t){this.applyListInfo(e,this._pendingListInfo),this._pendingListInfo=null},t.prototype.setListInfoAndInsertNewOE=function(e,t,n,i){if(Ss.OutlineElementReader.isEmpty(e,!1)&&(gs.ListReader.isListOutlineElement(e)&&this.applyListInfo(e,null,!1,!1,-1),vb.b.isOutlineElementWithNoteTags(e)))bb.n.removeAllNoteTags(n.get_iterator());else if(t){var r=this._outlineElementEditor.insertOutlineElementBelow(e);this._outlineElementEditor.splitAtIp(e,r,n,!1,!1,!0),this.IsTodoList(e)&&this.ExtendTodoList(r)}else this.PromoteSourceOutlineElement(e)},t.prototype.PromoteSourceOutlineElement=function(e){!gs.ListReader.isListOutlineElement(e)&&Ss.OutlineElementReader.isEmpty(e,!1)&&this._indentationEditorLazy.get_value()&&this._indentationEditorLazy.get_value().canPromote(e,-1)&&this._indentationEditorLazy.get_value().promote(e,-1,0)},t.prototype.shouldAutocorrectList=function(e){return!0},t.prototype.shouldTransferListInfo=function(e,t){return e&&t},t.prototype.setListInfo=function(t){Gl.n.get_instance().get_item(85)||xr.y.get_instance().recordEvent("PossibleLossOfListProperties",{Reason:"ImportListStyleIsNull"}),t.get_listStyle()&&e.prototype.setListInfo.call(this,t)},t.prototype.adjustAndSetLevel=function(e,t,n,i){S.ULS.sendTraceTag(17622208,324,50,"AdjustAndSetLevel is called in OneNote."),this._indentationEditorLazy.get_value()||xr.y.get_instance().recordEvent("PossibleIncorrectListIndentation",{Reason:"IOutlineElementIndentationEditorIsNull"}),this._indentationEditorLazy.get_value()&&this._indentationEditorLazy.get_value().canDemote(e,1)&&1===Ss.OutlineElementReader.getAbsoluteOutlineLevel(e)&&!this.DoesOutlineHaveListofTypeAtLevel1(e,t)&&16!==t.get_listType()&&n.setValue(Pl.k.autoDemoteLists,!0),this.ApplyListInfoOneNote(e,t,n)},t.prototype.transferListInfo=function(e,t,n,i){var r=e_.j.createFromScratch(15,0);r.setFrom(this.GetListInfoFromOutlineElementNode(n)),r.clearNumbering(),this.applyListInfo(e,r)},t.prototype.GetListInfoFromOutlineElementNode=function(e){if(!gs.ListReader.isListOutlineElementNode(e))return xr.y.get_instance().recordEvent("PossibleLossOfListProperties",{Reason:"NotListOutlineNode"}),null;var t=new ha.g;return t.set(e),this.listReader.moveToList(t),this.get_HierarchicalListReader().getListInfoFromListNode(t)},t.prototype.DoesOutlineHaveListofTypeAtLevel1=function(e,t){var n=new ha.g;n.setFrom(e),fs.OutlineNavigator.returnToOutlineOrTableCell(n),ys.OutlineReader.isOutlineNode(n.get_currentNode())||xr.y.get_instance().recordEvent("PossibleIncorrectListIndentation",{Reason:lh.i.doesNotContainOe});for(var i=!1,r=n.goToFirstChildByRole(1);r;r=n.goToNextSiblingByRoleOrReturnToParent(1))if(!Ss.OutlineElementReader.isOutlineGroup(n)&&1===Ss.OutlineElementReader.getAbsoluteOutlineLevel(n)&&this.HasMatchingListType(n,t.get_listType())){n.returnToParent(),i=!0;break}return i},t.prototype.applyListInfo=function(e,t,n,i,r){void 0===n&&(n=!0),void 0===i&&(i=!1),void 0===r&&(r=-1),this.ApplyListInfoOneNote(e,t)},t.prototype.ApplyListInfoOneNote=function(e,t,n){var i=this;void 0===n&&(n=null);var r=xr.y.get_instance().startActivity(Oi.u.applyListInfo);r.get_properties().set_item("ListTypeToApply",t?fb[t.get_listType()]:"null"),ha.g.executeVoidReturnWithDebugAssertRestored(e,(function(){if(!Ss.OutlineElementReader.isOutlineElement(e))return xr.y.get_instance().recordEvent("PossibleListStateNotUpdated",{Reason:lh.i.doesNotContainOe}),void r.end();if(!t||16===t.get_listType())return i.removeList(e),r.get_properties().set_item("ListRemoved","true"),void r.end();gs.ListReader.isListOutlineElement(e)||(i.createList(e),r.get_properties().set_item("CreatedList","true"),e.returnToParent());var o=i.listReader.getListInfo(e);if(!o||t.get_listType()===o.get_listType()&&t.hasMatchingListFormat(o)&&(!t.get_isOrdered()||t.get_restartAt()===o.get_restartAt()))return r.get_properties().set_item("NoOp","true"),void r.end();o.setFrom(t),i.SetListFormattingIterator(e,n),r.end()}))},t.prototype.HasMatchingListType=function(e,t){return Ss.OutlineElementReader.isOutlineElement(e)||xr.y.get_instance().recordEvent("PossibleIncorrectListIndentation",{Reason:lh.i.doesNotContainOe}),!!gs.ListReader.isListOutlineElement(e)&&this.listReader.getListInfo(e).get_listType()===t},t.prototype.performAutoCorrectNumbering=function(e,t,n,i){if(!n.get_listType()&&t.goToPreviousSibling()){var r=e.getValueWithDefault(Number,Pl.k.listLastStartAt,1);23===t.get_currentNodeType()&&1===r?(t.goToLastChildByRole(1),this.ContinueNumberingIfMatches(t,n,(0,g.m)((function(){return r}),(function(e){return r=e}))),t.returnToAncestorOfType(23)):e.hasProperty(Pl.k.listLastStartAt)||n.get_listStyle()&&this.ContinueNumberingIfMatches(t,n,(0,g.m)((function(){return r}),(function(e){return r=e}))),e.setValue(Pl.k.listLastStartAt,r),t.goToNextSibling()}return!0},t.prototype.ContinueNumberingIfMatches=function(e,t,n){if(e.hasChildrenOfRole(4)){var i=this.listReader.getListInfo(e);i.get_listType()===t.get_listType()&&i.get_listStyle()===t.get_listStyle()&&(n.val=i.get_lastStartAt()+1)}},t.prototype.setRestartAtIfNeeded=function(e,t,n){n||t.get_listType()||t.set_restartAt(e.getValueWithDefault(Number,is.b.listRestart,Zh.z.startAtNone))},t.prototype.IsTodoList=function(e){if(vb.b.isOutlineElementWithNoteTags(e)){var t=new ha.g;if(t.setFrom(e),_s.OutlineElementNavigator.moveToContent(t)&&t.goToFirstChildByRole(58)&&Ab.b.goToNoteTagByType(t,0))return!0}return!1},t.prototype.ExtendTodoList=function(e){var t=new ha.g;t.setFrom(e),_s.OutlineElementNavigator.moveToContent(t)&&Tb.n.get_instance().insertDefaultNoteTag(t,0)},t.prototype.SetListFormattingIterator=function(e,t){if(e&&gs.ListReader.isListOutlineElement(e)){var n=e.goToFirstChildByRole(4);e.returnToParent();var i=e.goToFirstChildByRole(2);i&&Ga.ParagraphReader.isParagraphNode(i)&&this.setListFormatting(n,i,t),_s.OutlineElementNavigator.returnToOutlineElement(e)}},t}(Sb);(0,o.l)(wb,"b4f155b6$HierarchicalListEditorCssVersion",Sb,[]);var xb=function(){function e(e,t,n){this._listReader=null,this._outlineElementIndentationEditor=null,this._outlineElementEditor=null,this.box4CssListSettingIsEnabled=!1,this.box4CssListSettingIsEnabled=gs.ListReader.get_isListMarkerEnabled(),this._listReader=e,this._outlineElementIndentationEditor=t,this._outlineElementEditor=n}return e.prototype.get_box4CssListSettingIsEnabled=function(){return this.box4CssListSettingIsEnabled},e.prototype.create=function(){return this.get_box4CssListSettingIsEnabled()?(S.ULS.sendTraceTag(17622209,324,50,"ListMarker improvements are enabled."),new wb(this._listReader,this._outlineElementIndentationEditor,this._outlineElementEditor)):new Ib(this._listReader,this._outlineElementIndentationEditor,this._outlineElementEditor)},e}();(0,o.l)(xb,"71d5095b$HierarchicalListEditorFactory",null,[yb]);var Eb=function(){function e(){}return e.configure=function(e){e.register(xb).as(yb).singleInstance().usingFactory((function(){return new xb(e.resolve(Ql.c),e.resolveLazy(Cb.p),e.resolve(ql.p))})),e.register(jl.v).singleInstance().usingFactory((function(){return e.resolve(yb).create()}))},e}();(0,o.l)(Eb,"e3fe551e$OneNoteListEditorsComponentConfiguration",null,[]);var Fb=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.ListEditors"},e.prototype.configure=function(e){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OutlineLevelEditorsDelayInitializationEnabled")&&Eb.configure(e)},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Fb,"2e75ab4f$OneNoteListEditorsPackage",null,[s.u,u.s]);var Pb=n(4788),Db=n(3002),Rb=function(){function e(e,t,n){this._internalLinkManager=null,this._navigationUtils=null,this._workspace=null,this._internalLinkManager=e,this._navigationUtils=t,this._workspace=n}return e.prototype.RegisterActions=function(e){var t=Ue.m.frame;e.addAction(nS.u.navigateToConflict,t,o.i(this,this.navigateToConflict,"navigateToConflict")),e.addAction(nS.u.navigateToVersion,t,o.i(this,this.navigateToVersion,"navigateToVersion")),e.addAction(nS.u.navigateToPage,t,o.i(this,this.navigateToPage,"navigateToPage")),e.addAction(nS.u.loadSectionWithoutNavigate,ol.d.view,o.i(this,this.loadSectionWithoutNavigate,"loadSectionWithoutNavigate")),e.addAction(nS.u.navigateToUrl,ol.d.view,o.i(this,this.navigateToUrl,"navigateToUrl")),e.addAction(nS.u.navigateToNotebook,ol.d.view,o.i(this,this.navigateToNotebook,"navigateToNotebook")),e.addAction(nS.u.navigateToNotebookList,ol.d.view,o.i(this,this.navigateToNotebookList,"navigateToNotebookList")),e.addAction(nS.u.navigateToSection,ol.d.view,o.i(this,this.navigateToSection,"navigateToSection")),e.addAction(nS.u.navigateToSectionGroup,ol.d.view,o.i(this,this.navigateToSectionGroup,"navigateToSectionGroup")),e.addAction(nS.u.toggleSectionGroupExpanded,ol.d.view,o.i(this,this.toggleSectionGroupExpanded,"toggleSectionGroupExpanded"))},e.prototype.navigateToConflict=function(e,t,n,i,r){var o=r,a=mt.h.createFromString(o.ParentId.toString()),l=this._workspace.get_activeSection().getChildGraphSpaceNodeForObjectSpace(a),s=mt.h.createFromString(o.ConflictId.toString()),u=l.getChildGraphSpaceNodeForObjectSpace(s);return this._workspace.set_activePage(u),32},e.prototype.navigateToVersion=function(t,n,i,r,o){var a=o,l=mt.h.createFromString(a.ParentId.toString()),s=this._workspace.get_activeSection().getChildGraphSpaceNodeForObjectSpace(l),u=mt.h.createFromString(a.ContextId.toString()),c=e.get_PageNavigator().getVersionHistoryNode(s).getChildGraphSpaceNodeForContext(u,!1);return this._workspace.set_activePage(c),32},e.prototype.navigateToPage=function(e,t,n,i,r){var o=r,a=mt.h.createFromString(o.PageId.toString());S.ULS.sendTraceTag(40960133,1600,50,"NavigationActor::NavigateToPage with pageCellId: {0}",a);var l=this._workspace.get_activeSection().getChildGraphSpaceNodeForObjectSpace(a);return this._workspace.set_activePage(l),32},e.prototype.navigateToSection=function(e,t,n,i,r){var o=r;S.ULS.sendTraceTag(40960134,1600,50,"NavigationActor::NavigateToSection with sectionId: {0}, parentFolder: {1}",o.SectionId.toString(),o.ParentId.toString());var a=""===o.ParentId.toString()?yi.App.theNotebookManager.get_defaultNotebookNode():this._navigationUtils.findSectionGroupWithFileId(o.ParentId.toString());return this._navigationUtils.switchSection(o.SectionId.toString(),a)?32:8},e.prototype.loadSectionWithoutNavigate=function(e,t,n,i,r){var o=r,a=""===o.ParentId.toString()?yi.App.theNotebookManager.get_defaultNotebookNode():this._navigationUtils.findSectionGroupWithFileId(o.ParentId.toString()),l=o.Callback;return this._navigationUtils.loadSectionWithCallback(o.SectionId.toString(),a,l)?32:8},e.prototype.navigateToUrl=function(e,t,n,i,r){var o=r;return this._internalLinkManager.handleInternalLink(o.Url.toString()),32},e.prototype.navigateToNotebook=function(e,t,n,i,r){var o=r;try{if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsEmbedMode")){var a={};a.Url=o.Url.toString(),Ge.w.get_instance().resolve(Db.q).sendMessage("App_SwitchNotebook",a)}}catch(e){return S.ULS.sendTraceTag(50733516,1600,50,"Exception swallowed in attempted navigation to another notebook through NotebookPane"),8}return 32},e.prototype.navigateToNotebookList=function(e,t,n,i,r){if(!Ti.App.oneNoteNotebooksUrl)return 8;try{L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteTwoPaneNavPaneIsEnabled")?window.open(Ti.App.oneNoteNotebooksUrl,"_blank"):window.open(Ti.App.oneNoteNotebooksUrl,"_top")}catch(e){return S.ULS.sendTraceTag(21616159,1600,50,"Exception swallowed in attempted navigation to NotebookList"),8}return 32},e.prototype.navigateToSectionGroup=function(e,t,n,i,r){var o=r.SectionGroupId.toString();return this._navigationUtils.toggleSectionGroupExpanded(o,!1)?32:8},e.prototype.toggleSectionGroupExpanded=function(e,t,n,i,r){var o=r,a=o.SectionGroupId.toString(),l=o.IsExpanded;return this._navigationUtils.toggleSectionGroupExpanded(a,l)?32:8},e.get_PageNavigator=function(){return Ii.PageNavigator.get_instance()},e.get_PageReader=function(){return $s.PageReader.get_instance()},e}();(0,o.l)(Rb,"fe872e4a$NavigationActor",null,[]);var Mb=function(){function e(e,t,n){this._internalLinkManager=null,this._workspace=null,this._messenger=null,this._isPoppingFromHistory=!1,this._internalLinkManager=e,this._workspace=t,this._messenger=n}return e.prototype.RegisterActions=function(t){t.addAction(nS.u.altLeftArrow,ol.d.view,o.i(this,this.altLeftArrow,"altLeftArrow")),t.addAction(nS.u.altRightArrow,ol.d.view,o.i(this,this.altRightArrow,"altRightArrow"));var n=St.FocusManager.instance().getScope(Pe.AFrame.mainAppFocusId);Pe.AFrame.bindWithDoNothingFallback(n,Me.KeyInputManager.hashKey(Re.v.vK_LeftArrow,1),nS.u.altLeftArrow),Pe.AFrame.bindWithDoNothingFallback(n,Me.KeyInputManager.hashKey(Re.v.vK_RightArrow,1),nS.u.altRightArrow),this._workspace.add_activePageChanged(o.i(this,this.PushPage,"PushPage")),this.PushPage(),this._messenger.addAllowedReceivingMessage(e.popState),this._messenger.registerCallback(e.popState,o.i(this,this.PopPage,"PopPage"))},e.prototype.PopPage=function(t){try{this._isPoppingFromHistory=!0,this._internalLinkManager.activatePage(t.Values[e.state])}catch(e){S.ULS.sendTraceTag(22291219,1600,15,"Exception encountered in PopPage: {0}",e)}finally{this._isPoppingFromHistory=!1}S.ULS.sendTraceTag(38400023,1600,50,"Navigated using browser history.")},e.prototype.PushPage=function(t,n){void 0===t&&(t=null),void 0===n&&(n=null);try{var i=window.history;if(!this._isPoppingFromHistory&&i.pushState&&this._workspace.get_activePage()&&!e.get_PageReader().isVersionNode(this._workspace.get_activePage())&&!e.get_PageReader().isConflictPageNode(this._workspace.get_activePage())){var r={},o=Ti.App.buildPageUrl(this._workspace.get_activePage());r[e.url]=o,r[e.state]=o,this._messenger.sendMessage(e.pushState,r)}}catch(e){S.ULS.sendTraceTag(22291220,1600,15,"Exception encountered in PushPage: {0}",e)}},e.prototype.altLeftArrow=function(e,t,n,i,r){return window.history.back(),32},e.prototype.altRightArrow=function(e,t,n,i,r){return window.history.forward(),32},e.get_PageReader=function(){return $s.PageReader.get_instance()},e.popState="App_PopState",e.pushState="App_PushState",e.url="Url",e.state="State",e}();(0,o.l)(Mb,"5e4bf408$NavigationHistoryActor",null,[]);var kb=n(2589),Nb=n(6697),Lb=function(e){function t(n,i,r,o,a){var l=e.call(this,n,i,r,a)||this;return l._parentNavigationView=null,l._appSettingsManager=null,l._isPinned=!1,l._userSetPinnedState=!1,l._cookieSupportEnabled=!1,l._appSettingsManager=o,l._cookieSupportEnabled=!!l._appSettingsManager&&l._appSettingsManager.getBooleanAppSetting(t.CookieSaveBRSName),l}return(0,v.t)(t,e),t.prototype.get_clientWidth=function(){return this.buttonElement.clientWidth},t.prototype.get_cookieValue=function(){return this._cookieSupportEnabled?re.z.getBool(t.PinStateCookieName,!1):t.DefaultPinnedState},t.prototype.get_isPinned=function(){return this._isPinned},t.prototype.get_isCookieSet=function(){return this._cookieSupportEnabled&&""!==re.z.get(t.PinStateCookieName)},t.prototype.get_userSetPinnedState=function(){return this.get_isCookieSet()||this._userSetPinnedState},t.prototype.get_parentNavigationView=function(){return this._parentNavigationView},t.prototype.set_parentNavigationView=function(e){return this._parentNavigationView=e,e},t.prototype.changePinnedState=function(e){this.changePinnedStateWithoutNavPaneUpdate(e),this._parentNavigationView&&(this._isPinned||this._parentNavigationView.tryCollapseView(!1))},t.prototype.changePinnedStateWithoutNavPaneUpdate=function(e){this._isPinned=e,this.SetButtonImageAndText()},t.prototype.saveCookie=function(){this._cookieSupportEnabled&&(re.z.setWithExpiration(t.PinStateCookieName,this._isPinned?"true":"false",re.z.maxComplianceAllowedRetentionInDays)||S.ULS.sendTraceTag(6824534,1600,50,"Failed to set cookie for navigation pin to {0}",this._isPinned))},t.prototype.addToContainer=function(e){this._isPinned=t.DefaultPinnedState,this.addImageButtonToContainer(e,t.ButtonClassName,t.ButtonImageClassName,this.createImageElement(20,20,this.GetPinImage()),t.ButtonId,this.GetAccessibilityString(),this.GetPinTitle()),this.set_isEnabled(!0),this.get_isCookieSet()&&(S.ULS.sendTraceTag(6885953,1600,50,"Cookie for nav pin is set on boot. Value is ",this.get_cookieValue().toString()),this._isPinned=this.get_cookieValue(),this.saveCookie()),this.changePinnedState(this._isPinned)},t.prototype.GetPinImage=function(){return this._isPinned?"PushpinPushed_20x20x32":"PushpinNormal_20x20x32"},t.prototype.GetPinTitle=function(){return this._isPinned?OneNoteIntl.OneNoteStrings.L_Navigation_UnpinPane:OneNoteIntl.OneNoteStrings.L_Navigation_PinPane},t.prototype.GetAccessibilityString=function(){return this.GetPinTitle()},t.prototype.SetButtonImageAndText=function(){var e=this.buttonElement.querySelector("span"),t=this.createImageElement(20,20,this.GetPinImage());t.className=e.className,this.buttonElement.replaceChild(t,e),this.buttonElement.title=this.GetPinTitle(),this.buttonElement.setAttribute("title",this.GetPinTitle()),this.buttonElement.setAttribute(vt.t.ariaLabelAttribute,this.GetAccessibilityString())},t.prototype.executeButtonAction=function(e){S.ULS.sendTraceTag(6611290,1600,50,"OneNote navigation pin button clicked: {0}",this._isPinned),this._userSetPinnedState=!0,this.changePinnedState(!this._isPinned),this.SetButtonImageAndText(),this.saveCookie()},t.get_domButtonId=function(){return t.ButtonId},t.ButtonId="NavigationViewPinButton",t.ButtonClassName="NavigationViewPinButton",t.ButtonImageClassName="NavigationViewPinButtonImage",t.PinStateCookieName="WacOneNotePinNav",t.CookieSaveBRSName="OneNoteNavViewPinSaveToCookieIsEnabled",t.DefaultPinnedState=!1,t}(Nb.e);(0,o.l)(Lb,"2d76ba6d$NavigationViewPinButton",Nb.e,[Pb.s,Sys.IDisposable]);var Bb=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"OneNote.Navigation"},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register(Lb).as(Pb.s).singleInstance().usingFactory((function(){return new Lb(L.AFrameworkApplication.get_activeFrame().workspace,Xt.s.get_instance(),Me.KeyInputManager.get_instance(),L.AFrameworkApplication.appSettingsManager,Ct.ImageClusteringHelper.createClusteredImage)})),this._container.register(kb.v).singleInstance().usingFactory((function(){return new kb.v(L.AFrameworkApplication.get_activeFrame().workspace,$s.PageReader.get_instance(),t._container.resolve(db.f),ab.FolderReader.get_instance(),L.AFrameworkApplication.get_theActionManager())})),this._container.register(Rb).singleInstance().usingFactory((function(){return new Rb(t._container.resolve(ob.b),t._container.resolve(kb.v),L.AFrameworkApplication.get_activeFrame().workspace)})),this._container.register(Mb).singleInstance().usingFactory((function(){return new Mb(t._container.resolve(ob.b),L.AFrameworkApplication.get_activeFrame().workspace,t._container.resolve(Db.q))}))},e.prototype.init=function(){this._container.resolve(Lb),this._container.resolve(Rb).RegisterActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteNavigationHistoryIsEnabled")&&this._container.resolve(Mb).RegisterActions(L.AFrameworkApplication.get_theActionManager())},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Bb,"46b544ef$OneNoteNavigationPackage",null,[s.u,u.s]);var Ob=n(6053),Ub=n(5681),Hb=n(9228),Gb=n(779),Wb=n(1459),Vb=n(5409),$b=n(6425),zb=(0,o.y)("e0e91825$IPageSeriesEditor"),Kb=n(1620),qb=n(1461),jb=(0,o.y)("3ab9ddb4$INotebookEditor"),Qb=n(4566),Jb=n(222),Xb=n(5106),Yb=function(){return function(){this.callbackdata=null,this.destGraphSpaceNode=null,this.sectionGroupGraphSpaceNode=null,this.sectionGroupCreationSucceededCallback=null,this.sectionGroupCreationFailedCallback=null,this.sectionGroupId=null}}();(0,o.l)(Yb,"751dcf9a$SectionGroupCreationCallbackData",null,[]);var Zb=n(5799),ev=function(){function e(e,t,n,i,r){this._workspaceResolver=null,this._recycleBinHelper=null,this._folderEditorHelper=null,this.SectionGroupCreationRetry=2,this._folderContentEditor=null,this._graphTransactionFactory=null,this.RecycleBinSectionGroupCreationInterval=15e3,this._folderContentEditor=e,this._graphTransactionFactory=t,this._workspaceResolver=n,this._recycleBinHelper=i,this._folderEditorHelper=r}return e.prototype.ActivateNextAvailablePage=function(e){var t=new ha.g;if(t.set(e.getParentGraphSpace()),t.goToChild(e),t.goToNextSiblingByRole(49)){if(!lb.j.isSection(t)||Jb.c.isRecycleBinNode(t.get_currentNode()))return;var n=lb.j.getFirstVisiblePageIfLoaded(t.get_currentNode());if(n||t.get_currentNode().get_isContentPresent())(n=pb.FolderNavigator.getNextPageInNewSection(e))&&this._workspaceResolver().set_activePage(n);else{var i=t.get_currentNode();i.get_contentReplicator()||i.attachContentReplicator("FolderView_ActiveAvailablePage"),i.get_contentReplicator().forceInbound(o.i(this,this.SetNextVisiblePageAfterLoad,"SetNextVisiblePageAfterLoad"),null,i)}}},e.prototype.ActivatePreviousAvailablePage=function(e){var t=new ha.g;for(t.set(e.getParentGraphSpace()),t.goToChild(e);t.goToPreviousSiblingByRole(49);){if(!lb.j.isSection(t)||Jb.c.isRecycleBinNode(t.get_currentNode()))return;var n=lb.j.getLastVisiblePageIfLoaded(t.get_currentNode());if(n||t.get_currentNode().get_isContentPresent())(n=pb.FolderNavigator.getPreviousPageInNewSection(e))&&this._workspaceResolver().set_activePage(n);else{var i=t.get_currentNode();i.get_contentReplicator()||i.attachContentReplicator("FolderView_ActivePreviousAvailablePage"),i.get_contentReplicator().forceInbound(o.i(this,this.SetLastVisiblePageAfterLoad,"SetLastVisiblePageAfterLoad"),null,i)}return}},e.prototype.SetNextVisiblePageAfterLoad=function(e){var t=e,n=lb.j.getFirstVisiblePageIfLoaded(t);n?this._workspaceResolver().set_activePage(n):(n=pb.FolderNavigator.getNextPageInNewSection(t))&&this._workspaceResolver().set_activePage(n)},e.prototype.SetLastVisiblePageAfterLoad=function(e){var t=e,n=lb.j.getLastVisiblePageIfLoaded(t);n?this._workspaceResolver().set_activePage(n):(n=pb.FolderNavigator.getPreviousPageInNewSection(t))&&this._workspaceResolver().set_activePage(n)},e.prototype.getNextPage=function(e,t){var n=null;return e?((n=this.get_PageNavigator().getNextVisiblePage(e,!0))||this.ActivateNextAvailablePage(t),n):n=pb.FolderNavigator.getNextPageInNewSection(t)},e.prototype.getPreviousPage=function(e,t){var n=null;return e?((n=this.get_PageNavigator().getPrevVisiblePage(e,!0))||this.ActivatePreviousAvailablePage(t),n):n=pb.FolderNavigator.getPreviousPageInNewSection(t)},e.prototype.createSectionGroup=function(e,t,n,i,r){var a=new Yb;return a.callbackdata=r,a.sectionGroupCreationSucceededCallback=t,a.sectionGroupCreationFailedCallback=n,this.createSectionGroupAndSection(e,o.i(this,this.SectionGroupCreationReplicationSucceededCallback,"SectionGroupCreationReplicationSucceededCallback"),o.i(this,this.SectionGroupCreationReplicationFailedCallback,"SectionGroupCreationReplicationFailedCallback"),i,null,a,0)},e.prototype.createSectionGroupAndSection=function(e,t,n,i,r,a,l){var s=this;void 0===l&&(l=0);var u=Ti.App.extractIdForApiCall(e.get_fileId(),!0);if(""===u)return!1;n||(n=o.i(this,this.NoOpReplicationFailedCallback,"NoOpReplicationFailedCallback"));var c=this._folderEditorHelper.getGraphSpaceNodeType(e);if(!c)return!1;var d=yi.App.webServiceBase+String.format("OneNoteS2SHandler.ashx?action=sectiongroup&destgraphspacenodeid={0}&sectiongroupname={1}&{2}&destgraphspacetype={3}",Rn.l.urlKeyValueEncode(u),Rn.l.urlKeyValueEncode(i),L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion,Rn.l.urlKeyValueEncode(c));r&&(d+=String.format("&sectionname={0}",r));var g={"Content-Type":"application/json; charset=utf-8"};if(Ti.App.isSharePointNotebook(u)){var p=Ti.App.extractSiteUrl(e.get_fileId());if(""===p)return S.ULS.sendTraceTag(19730785,339,15,"Site URL is empty."),!1;g.OrgIdSiteUrl=p}return l++,S.ULS.sendTraceTag(19957524,339,50,"Api call issued to create a section group."),L.AFrameworkApplication.theClientRequestManager.addRequest(d,2,null,g,!1,2,(function(i){s.OnSectionGroupCreationSucceed(i,e,t,n,a)}),(function(o){s.OnSectionGroupCreationFail(o,e,t,n,i,r,a,l)}),null,void 0,void 0,void 0,Ti.App.get_oneNoteS2SRequestTimeoutMs()),!0},e.prototype.SectionGroupCreationReplicationSucceededCallback=function(e){var t=(0,y.e)(Yb,e);S.ULS.sendTraceTag(19957525,339,50,"Api call succeeded to create a section group."),t.sectionGroupCreationSucceededCallback(t.callbackdata,t.sectionGroupGraphSpaceNode)},e.prototype.SectionGroupCreationReplicationFailedCallback=function(e,t){var n=(0,y.e)(Yb,e);S.ULS.sendTraceTag(19957526,339,10,"Api call failed to create a section group, error code {0}.",t),n.sectionGroupCreationFailedCallback(n.callbackdata,t)},e.prototype.NoOpReplicationFailedCallback=function(e,t){},e.prototype.OnSectionGroupCreationSucceed=function(e,t,n,i,r){var a=null,l=(0,y.e)(Yb,r);if(e&&l){try{var s=x.x.deserialize(e.get_data().responseData);if(s){if(!(a=s.id)){if(o.r(Zb.y,r))(0,y.e)(Zb.y,r).lastFailure="OnSectionGroupCreationSucceed: response has no section group id";return void i(r,-1)}l.sectionGroupId=a}}catch(e){if(o.r(Zb.y,r))(0,y.e)(Zb.y,r).lastFailure=String.format("OnSectionGroupCreationSuccess: exception thrown when parsing section group API success : {0}",e.message);return void i(r,-1)}this.ReplicateNewlyCreatedSectionGroup(t,n,i,r)}else{var u=(0,y.e)(Zb.y,r);u&&(u.attempt=0,u.sectionGroupCreationFailedCallback=i,u.sectionGroupCreationSucceededCallback=n,this.ReplicateNewlyCreatedSectionGroup(t,n,o.i(this,this.OnNewlyCreatedSectionGroupReplicatedFailed,"OnNewlyCreatedSectionGroupReplicatedFailed"),u))}},e.prototype.ReplicateNewlyCreatedSectionGroup=function(e,t,n,i){var r=this,o=e.get_contentReplicator();o.set_knowledge(null),o.forceInbound((function(o){r.OnNewlyCreatedSectionGroupReplicatedSucceed(e,t,n,i)}),n,i)},e.prototype.OnNewlyCreatedSectionGroupReplicatedFailed=function(e,t){var n=(0,y.e)(Zb.y,e);if(n)if(n.attempt<this.SectionGroupCreationRetry){var i=n.sectionGroupCreationSucceededCallback;n.attempt=n.attempt+1;var r=n.notebook;this.ReplicateNewlyCreatedSectionGroup(r,i,o.i(this,this.OnNewlyCreatedSectionGroupReplicatedFailed,"OnNewlyCreatedSectionGroupReplicatedFailed"),e)}else{(0,n.sectionGroupCreationFailedCallback)(e,t)}},e.prototype.OnSectionGroupCreationFail=function(e,t,n,i,r,a,l,s){var u=this;if(S.ULS.sendTraceTag(19710980,339,100,"OnSectionGroupCreationFail: Http Status{0}"+e.get_data().httpStatus),e.get_data().httpStatus===Y.k.conflict_409)if(r===this._recycleBinHelper.getRecycleBinSectionListName()){var c=new ge.c(4,1,this.RecycleBinSectionGroupCreationInterval,(function(e){u.OnSectionGroupCreationSucceed(null,t,n,i,l)}),47);L.AFrameworkApplication.get_theTaskManager().addTask(c)}else{if(o.r(Zb.y,l))(0,y.e)(Zb.y,l).lastFailure="OnSectionGroupCreationFail: we have a conflict but the new section group name doesn't match recycle bin";i(l,this._folderEditorHelper.convertToOperationResult(e))}else if((e.get_data().httpStatus===Y.k.preconditionFailed_412||r===this._recycleBinHelper.getRecycleBinSectionListName())&&s<=1&&Xb.o.canRetryRequest(e))this.createSectionGroupAndSection(t,n,i,r,a,l,s);else{if(o.r(Zb.y,l))(0,y.e)(Zb.y,l).lastFailure="OnSectionGroupCreationFail: unknown reason";i(l,this._folderEditorHelper.convertToOperationResult(e))}},e.prototype.OnNewlyCreatedSectionGroupReplicatedSucceed=function(e,t,n,i){var r=(0,y.e)(Yb,i);if(r){var a=r.sectionGroupId,l=this._folderEditorHelper.getSectionGroupGraphSpaceNode(e,a);if(!l){if(o.r(Zb.y,i))(0,y.e)(Zb.y,i).lastFailure=String.format("OnNewlyCreatedSectionGroupReplicatedSucceed: Can't find a graphspace node with the specified graph space node id {0}",a);return void n(i,-1)}r.sectionGroupGraphSpaceNode=l,t(i)}else{var s=this._recycleBinHelper.getRecycleBinGraphSpaceNode(e);if(!s){if(o.r(Zb.y,i))(0,y.e)(Zb.y,i).lastFailure=String.format("OnNewlyCreatedSectionGroupReplicatedSucceed: Can't find the recyclebin section group graph space node");return void n(i,-1)}this._recycleBinHelper.loadRecycleBinSectionGroup(s,t,n,i)}},e.prototype.get_PageNavigator=function(){return Ii.PageNavigator.get_instance()},e.prototype.moveSection=function(e,t){var n=this._graphTransactionFactory.getTransaction(7);n.setFromNode(e);var i=new ha.g;i.set(e),i.tryToRootAtAncestorOfType(4),i.returnToAncestorOfType(4);var r=i.get_currentNode(),o=null;t&&(i.set(t),i.tryToRootAtAncestorOfType(4),i.returnToAncestorOfType(4),o=i.get_currentNode()),i.set(e),i.tryToRootAtAncestorOfType(1),i.returnToAncestorOfType(1);var a=i.get_currentNode();i.goToChild(e),i.disconnectNodeAndReturnToParent(),i.insertChild(e,t,49),i.returnToAncestorOfType(1),i.goToFirstChildByRole(50),i.goToChild(r);var l=new ha.g;l.set(a),xi.r.moveToContentIfLoaded(l);var s=l.get_currentNode();l.insertChild(r,o,1),i.disconnectNodeAndReturnToParent();var u=ha.g.createFromNode(s);this._folderContentEditor.updateFileIdentityGuids(u);var c=new ha.g;if(c.set(r),c.tryToRootAtAncestorOfType(3)){c.returnToAncestorOfType(3);for(var d=1,g=c.goToFirstChild();g&&4===g.get_type();g=c.goToNextSiblingOrReturnToParent())g.get_properties().setValue(is.b.sectionOrder,d),d++}n.dispose()},e.prototype.sectionNameInUse=function(e,t){if(!e||""===e)return!1;var n=new ha.g;n.set(t);for(var i=n.goToFirstChildByRole(49);i;i=n.goToNextSiblingByRole(49)){if(!lb.j.isSection(n))return!1;if(Rn.l.toLower(lb.j.getTitle(i))===Rn.l.toLower(e))return!0}return!1},e}();(0,o.l)(ev,"92a3018b$FolderEditor",null,[Hb.x]);var tv=n(8362),nv=function(){function e(){}return e.prototype.getGraphSpaceNodeType=function(e){return Jb.c.isNotebookNode(e)?"notebooks":ab.FolderReader.isSectionGroupNode(e)?"sectiongroups":null},e.prototype.convertToOperationResult=function(e){switch(e.get_data().httpStatus){case Y.k.preconditionFailed_412:return 28;case Y.k.conflict_409:return 131;case Y.k.internalServerError_500:case Y.k.badGateway_502:return-1}if(!e.get_data().responseData)return-1;var t=0;try{var n=x.x.deserialize(e.get_data().responseData);n&&n.error.code&&(t=Number.parseInvariant(n.error.code))}catch(e){return-1}var i=-1;switch(t){case 10007:i=46}return S.ULS.sendTraceTag(19710983,339,100,String.format("ConvertToOperationResult: ErrorCode:{0} OperationResult:{1}",t,i)),i},e.prototype.getSectionGroupGraphSpaceNode=function(e,t){var n=this.RemoveHostPrefix(t);return Ti.App.isSharePointNotebook(t)&&(n=n.split("-").join("")),n=Rn.l.urlKeyValueEncode(n),this.getGraphSpaceNode(e,(function(e){return e.get_fileId().toUpperCase().indexOf(n)>0}))},e.prototype.RemoveHostPrefix=function(e){return(e=e.toUpperCase()).substr(2)},e.prototype.getGraphSpaceNode=function(e,t){var n=new hb.m;n.set(e);for(var i=n.goToFirstChild();i;){var r=(0,y.e)(tv.e,i);if(r&&t(r))return r;i=n.goToNextSibling()}return null},e}();(0,o.l)(nv,"1cba030d$FolderEditorHelper",null,[Ub.q]);var iv=function(){function e(e,t,n){this._folderContentEditor=null,this._recycleBinHelper=null,this._folderEditor=null,this._folderContentEditor=e,this._recycleBinHelper=t,this._folderEditor=n}return e.prototype.ensureDeletedPagesExists=function(e,t,n,i){i.notebook=e;var r=this._recycleBinHelper.getRecycleBinGraphSpaceNode(e);r?r.get_isContentPresent()?(i.recycleBinDeletedPagesNode=this._recycleBinHelper.getDeletedPagesNode(r),t(i)):this._recycleBinHelper.loadRecycleBinSectionGroup(r,t,n,i):this.createRecycleBinAndDeletedPages(e,t,n,i)||(i.lastFailure="EnsureDeletedPagesExists: An API to create the recycle bin or the deleted pages section was not successful",n(i,-1))},e.prototype.getRecycleBinGraphSpaceNode=function(e){return this._recycleBinHelper.getRecycleBinGraphSpaceNode(e)},e.prototype.createRecycleBinAndDeletedPages=function(e,t,n,i){return this._folderEditor.createSectionGroupAndSection(e,t,n,this._recycleBinHelper.getRecycleBinSectionListName(),this._recycleBinHelper.getDeletedPagesSectionName(),i,0)},e}();(0,o.l)(iv,"46fa0344$NotebookEditor",null,[jb]);var rv=function(){function e(){}return e.prototype.removeIsSignedProperty=function(e){},e.prototype.removeIsMarkedAsFinalProperty=function(e){},e.prototype.forceDeletePage=function(e){},e.prototype.onPageDeleteFailure=function(e,t){},e.prototype.setHasPageVersions=function(e,t){},e.prototype.setTitle=function(e,t){},e}();(0,o.l)(rv,"2b9255d6$PageEditor",null,[Qb.f]);var ov=n(8606),av=n(63),lv=function(){function e(e,t,n,i,r){this._page=null,this._newSection=null,this._insertAfter=null,this._insertAtEnd=!1,this._pageEditor=null,this._setActivePageToCopyPage=!1,this._pageEditor=e,this._page=t,this._newSection=n,this._insertAfter=i,this._insertAtEnd=r,this._setActivePageToCopyPage=!1}return e.prototype.Execute=function(t){e.get_pageReader().hasBeenDeleted(this._page)||(this._newSection.getHtmlViewElement(yi.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId()).setIsLoading(!1),this._newSection.get_isContentPresent()&&this._pageEditor.copy(this._page,this._newSection,this._insertAfter,this._insertAtEnd,this._setActivePageToCopyPage),this.ShowCopySuccessNotification(this._page,this._newSection))},e.prototype.ShowCopySuccessNotification=function(t,n){var i=e.get_pageReader().getTitle(t),r=lb.j.getTitle(n),o=String.format(OneNoteIntl.OneNoteStrings.L_CopyPageSucceedToastMessage,i,r),a=yi.App.get_activeAppFrame().get_notificationBar().createEntry(o,!1);yi.App.get_activeAppFrame().get_notificationBar().addEntry(a)},e.get_pageReader=function(){return $s.PageReader.get_instance()},e}();(0,o.l)(lv,"71b0e39b$DeferredPageCopy",null,[]);var sv=function(){function e(e,t,n){this._pageNode=null,this._level=0,this._pageEditor=null,this._pageEditor=e,this._pageNode=t,this._level=n}return e.prototype.Execute=function(e){var t=this._pageNode,n=this._level;t.get_isContentPresent()&&this._pageEditor.setLevel(t,n)},e.get_PageReader=function(){return $s.PageReader.get_instance()},e}();(0,o.l)(sv,"2bd180c2$DeferredPageIndent",null,[]);var uv=function(){function e(e,t,n,i,r,o,a){void 0===a&&(a=!0),this._page=null,this._newSection=null,this._insertAfter=null,this._insertAtEnd=!1,this._pageEditor=null,this._setActivePageToCopyPage=!1,this._workspace=null,this._pageEditor=e,this._workspace=t,this._page=n,this._newSection=i,this._insertAfter=r,this._insertAtEnd=o,this._setActivePageToCopyPage=a}return e.prototype.Execute=function(t){e.get_pageReader().hasBeenDeleted(this._page)||(this._newSection.getHtmlViewElement(yi.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId()).setIsLoading(!1),this._newSection.get_isContentPresent()&&(this._pageEditor.move(this._page,this._newSection,this._insertAfter,this._insertAtEnd,this._setActivePageToCopyPage),this._workspace.onGraphSpaceShutdown(this._page)))},e.get_pageReader=function(){return $s.PageReader.get_instance()},e}();(0,o.l)(uv,"8a9b3a0f$DeferredPageMove",null,[]);var cv=function(e){function t(t,n,i,r,o,a){var l=e.call(this,t,n,i,r,o,a)||this;return l._setActivePageToCopyPage=!1,l}return(0,v.t)(t,e),t.prototype.Execute=function(t){e.prototype.Execute.call(this,t);var n=uv.get_pageReader().getTitle(this._page),i=lb.j.getTitle(this._newSection),r=String.format(OneNoteIntl.OneNoteStrings.L_RestorePageSucceedToastMessage,n,i);this._workspace.onGraphSpaceShutdown(this._page),this._pageEditor.ShowDeleteRestorePageToast(r)},t}(uv);(0,o.l)(cv,"52e76136$DeferredPageRestore",uv,[]);var dv=function(e){function t(t,n,i,r,o,a,l){var s=e.call(this)||this;return s._firstMoveToNewSection=!0,s._sectionContentEditorLazy=null,s._notebookEditorLazy=null,s._sectionEditorLazy=null,s._versionHistoryEditor=null,s._workspaceResolver=null,s._recycleBinHelperLazy=null,s._businessBarControllerFuture=null,s._deleteRestorePageMessage=null,s._undoManager=null,s._deleteRestorePageNotificationTask=null,s._deleteRestorePageNotificationPending=!1,s._pageSeriesEditorLazy=null,s._graphSpaceEditor=null,s._graphTransactionFactory=null,s._pageSeriesEditorLazy=t,s._graphSpaceEditor=n,s._graphTransactionFactory=i,s._notebookEditorLazy=r,s._sectionContentEditorLazy=o,s._sectionEditorLazy=a,s._workspaceResolver=function(){return yi.App.get_activeAppFrame()?yi.App.get_activeAppFrame().workspace:null},s._recycleBinHelperLazy=l,s}return(0,v.t)(t,e),t.prototype.get_BusinessBarControllerFuture=function(){return this._businessBarControllerFuture||(this._businessBarControllerFuture=Ge.w.get_instance().resolveFuture(Li.d))},t.prototype.get_NotebookEditor=function(){return this._notebookEditorLazy.get_value()},t.prototype.get_SectionContentEditor=function(){return this._sectionContentEditorLazy.get_value()},t.prototype.get_SectionEditor=function(){return this._sectionEditorLazy.get_value()},t.prototype.get_UndoManager=function(){return this._undoManager||(this._undoManager=Ge.w.get_instance().resolve(wa.n))},t.prototype.get_FirstMoveToNewSection=function(){return this._firstMoveToNewSection},t.prototype.set_FirstMoveToNewSection=function(e){return this._firstMoveToNewSection=e,e},t.prototype.get_WorkspaceResolver=function(){return this._workspaceResolver},t.prototype.set_WorkspaceResolver=function(e){return this._workspaceResolver=e,e},t.prototype.get_VersionHistoryEditor=function(){return this._versionHistoryEditor||(this._versionHistoryEditor=Ge.w.get_instance().resolve(qb.e))},t.prototype.get_RecycleBinHelper=function(){return this._recycleBinHelperLazy.get_value()},t.prototype.get_OneNotePageReader=function(){return av.x.get_instance()},t.prototype.move=function(e,t,n,i,r){void 0===r&&(r=!0),Dr.t.mark(6257);var o=this.get_PageNavigator().getContainingSection(e);1===o.get_accessRights()&&1===t.get_accessRights()&&(o!==t?this.MovePageOutOfSection(e,t,n,i,r):this.MoveWithinSection(e,n))},t.prototype.restorePage=function(e,t){var n=this;L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IOneNoteRecycleBinSettings"),S.ULS.sendTraceTag(19957527,339,50,"Restore page from recyclebin start.");var i=this.get_PageReader().getTitle(e),r=lb.j.getTitle(t);if(t.get_isContentPresent()){this.move(e,t,null,!0,!1);var o=String.format(OneNoteIntl.OneNoteStrings.L_RestorePageSucceedToastMessage,i,r);this._workspaceResolver().onGraphSpaceShutdown(e),this.ShowDeleteRestorePageToast(o)}else{var a=this.createDeferredPageRestoreCallback(e,t,!0),l=String.format(OneNoteIntl.OneNoteStrings.L_RestorePageFailureToastMessage,i,r);this.get_SectionEditor().load(t,a,(function(e,t){S.ULS.sendTraceTag(38105925,339,15,l),n.ShowDeleteRestorePageToast(l)}),null)}},t.prototype.MoveWithinSection=function(e,t){Dr.t.mark(6257);var n=this.get_PageNavigator().getContainingSection(e);if(e.get_isContentPresent()){var i=this.get_PageSeriesEditor().getPageSeriesOfPage(e),r=this._graphTransactionFactory.getTransaction(7);r.setFromNode(n),e.ensureContentGraphConnection(),this.UpdateLevelsInSeriesBeforePageRemoval(e);var o=new ha.g;o.set(e),o.tryToRootAtAncestorOfType(1),o.returnToAncestorOfType(1),o.goToChild(e);var a=new ha.g;a.set(i),a.tryToRootAtAncestorOfType(5),this.PutPageInCurrentSection(e,t,a,o),n.ensureContentGraphConnection(),Dr.t.mark(6258),r.dispose()}else this.LoadPageBeforeMove(e,n,t,!1)},t.prototype.PutPageInCurrentSection=function(e,t,n,i){var r=this.get_PageNavigator().getContainingSection(e),o=this.GetNewLevelForPage(r,t),a=this.get_PageSeriesEditor().getPageSeriesOfPage(e),l=new ha.g;l.set(r);var s=this.get_PageSeriesEditor().getPageSeriesOfPage(t);l.insertChild(e,t,49),Rm.SectionNavigator.moveToSectionContentIfLoaded(l);var u=this.get_PageReader().getLevel(e);if(o===$s.PageReader.minPageLevel&&o===u)l.insertChild(a,s,1),n.disconnectNodeAndReturnToParent();else if(u===$s.PageReader.minPageLevel&&u!==o)s&&this.get_PageSeriesEditor().moveCachedMetadataReference(a,s,e),1===n.getChildCount()?n.disconnectNodeAndReturnToParent():(S.ULS.shipAssertTag(6373588,324,!1),n.goToChild(e),n.disconnectNodeAndReturnToParent()),l.goToChild(s),l.insertChild(e,t,45);else if(u!==$s.PageReader.minPageLevel&&o===$s.PageReader.minPageLevel){var c=void 0;(c=s?ha.g.createFromNode(s):ha.g.createFromNode(a)).tryToRootAtAncestorOfType(5),c.returnToParent();var d=this.get_SectionContentEditor().insertPageSeries(c,s);this.get_PageSeriesEditor().moveCachedMetadataReference(a,d,e),n.goToChild(e),n.disconnectNodeAndReturnToParent(),c.addChild(e,45)}else{if(n.goToChild(e),n.disconnectNodeAndReturnToParent(),a===s)n.insertChild(e,t,45);else ha.g.createFromNode(s).insertChild(e,t,45),this.get_PageSeriesEditor().moveCachedMetadataReference(a,s,e)}i.disconnectNodeAndReturnToParent(),o!==u&&this.setLevel(e,o)},t.prototype.MovePageOutOfSection=function(e,t,n,i,r){if(void 0===r&&(r=!0),!t.get_relativePath())if(!this._firstMoveToNewSection||this.get_RecycleBinHelper()&&(this.get_RecycleBinHelper().isDeletedPagesSectionNode(t)||this.get_RecycleBinHelper().isPageInRecycleBin(e)))if(e.get_isContentPresent())if(t.get_isContentPresent()){var o=this._graphTransactionFactory.getTransaction(7);o.setFromNode(t);var a=t.createChildGraphSpace(1,"MovePageOutOfSection");if(i?this.PutPageAtEndOfNewSection(t,e,a):this.PutPageInNewSection(t,e,a,n),r){var l=this._workspaceResolver();l.get_activePage()===e&&l.set_activePage(a)}if(e.get_contentReplicator().set_blockingPageCopy(a),this.get_RecycleBinHelper()&&(this.get_RecycleBinHelper().isDeletedPagesSectionNode(t)?this.get_PageReader().getMetadataForWrite(a).removeProperties(is.b.isDeletedGraphSpaceContent):this.forceDeletePage(e)),this.SetHasConflictPages(a,!1),this.setHasPageVersions(a,!1),o.dispose(),this.get_RecycleBinHelper()&&this.get_RecycleBinHelper().isDeletedPagesSectionNode(t))e.get_contentReplicator().set_waitingForRecycleBin(!1),e.getParentGraphSpace().get_contentReplicator().set_waitingForRecycleBin(!1);t.ensureContentGraphConnection(),this.get_RecycleBinHelper()&&this.get_RecycleBinHelper().logRecycleBinSuccess(e,t),Dr.t.mark(6258)}else this.LoadNewSectionBeforeMove(e,t,n,i);else this.LoadPageBeforeMove(e,t,n,i);else this.ShowMovePageToOtherSectionDialog(e,t,n,i)},t.prototype.PutPageAtEndOfNewSection=function(e,t,n){var i=new ha.g;i.set(e),i.addChild(n,49),xi.r.moveToContentIfLoaded(i),this.get_SectionContentEditor().createPageSeries(i),i.addChild(n,45),this._graphSpaceEditor.copyContent(t,n),n.updateCachedMetadata(),this.setNotebookManagementEntityId(n)},t.prototype.PutPageInNewSection=function(e,t,n,i){var r=new ha.g;r.set(e);var o=this.GetNewLevelForPage(e,i);r.insertChild(n,i,49),Rm.SectionNavigator.moveToSectionContentIfLoaded(r),this._graphSpaceEditor.copyContent(t,n);var a=this.get_PageSeriesEditor().getPageSeriesOfPage(t),l=this.get_PageSeriesEditor().getPageSeriesOfPage(i);if(o===$s.PageReader.minPageLevel){var s=this.get_SectionContentEditor().insertPageSeries(r,l);r.addChild(n,45),this.get_PageSeriesEditor().moveCachedMetadataReference(a,s,n,t)}else r.goToChild(l),r.insertChild(n,i,45),this.get_PageSeriesEditor().moveCachedMetadataReference(a,l,n,t);n.updateCachedMetadata(),o!==this.get_PageReader().getLevel(t)&&this.setLevel(n,o)},t.prototype.ShowMovePageToOtherSectionDialog=function(e,t,n,i){var r=this;if(!Ni.h.get_currentDialog()||!Ni.h.get_currentDialog().get_isShowing()){var o=new Vn.StandardDialog;o.set_buttonsOption(4),o.setDefaultButton(2),o.showWarning(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_MovePageToNewSectionConfirmation,(function(o,a){1===o&&(r._firstMoveToNewSection=!1,r.move(e,t,n,i))}))}},t.prototype.LoadPageBeforeMove=function(e,t,n,i){var r=this;e.get_contentReplicator()||e.attachContentReplicator("LoadPageBeforeMove"),e.get_contentReplicator().forceInbound((function(o){r.move(e,t,n,i)}),null,null)},t.prototype.LoadNewSectionBeforeMove=function(e,t,n,i){var r=this;t.get_contentReplicator()||t.attachContentReplicator("LoadNewSectionBeforeMove"),t.get_contentReplicator().forceInbound((function(o){r.move(e,t,n,i)}),null,null)},t.prototype.copy=function(e,t,n,i,r){void 0===r&&(r=!0),Dr.t.mark(6257),1===this.get_PageNavigator().getContainingSection(e).get_accessRights()&&1===t.get_accessRights()&&this.copyPageToSection(e,t,n,i,r)},t.prototype.copyPageToSection=function(e,t,n,i,r){if(!t.get_relativePath())if(e.get_isContentPresent())if(t.get_isContentPresent()){var o=this._graphTransactionFactory.getTransaction(7);o.setFromNode(t);var a=t.createChildGraphSpace(1,"CopyPageToSection");if(i?this.PutPageAtEndOfNewSection(t,e,a):this.PutPageInNewSection(t,e,a,n),r){var l=this._workspaceResolver();l.get_activePage()===e&&l.set_activePage(a)}e.get_contentReplicator().set_blockingPageCopy(a),this.SetHasConflictPages(a,!1),this.setHasPageVersions(a,!1),o.dispose(),t.ensureContentGraphConnection(),Dr.t.mark(6258)}else this.LoadNewSectionBeforeCopy(e,t,n,i);else this.LoadPageBeforeCopy(e,t,n,i)},t.prototype.LoadPageBeforeCopy=function(e,t,n,i){var r=this;e.get_contentReplicator()||e.attachContentReplicator("LoadPageBeforeCopy"),e.get_contentReplicator().forceInbound((function(o){r.copy(e,t,n,i)}),null,null)},t.prototype.LoadNewSectionBeforeCopy=function(e,t,n,i){var r=this;t.get_contentReplicator()||t.attachContentReplicator("LoadNewSectionBeforeCopy"),t.get_contentReplicator().forceInbound((function(o){r.copy(e,t,n,i)}),null,null)},t.prototype.showDeletePageDialog=function(e){var t=this,n=new Vn.StandardDialog;n.set_buttonsOption(7),n.setDefaultButton(0);var i,r=CommonUIStrings.l_DefaultDialogTitle;i=e.get_isPasswordProtectedUnlockable()?OneNoteIntl.OneNoteStrings.L_DeletePagePermanentlyConfirmation:this.get_PageReader().hasConflictPages(e)?Box4Intl.Box4Strings.l_DeletePageWithConflictsConfirmation:this.get_PageReader().hasLockOnPageNode(e)?OneNoteIntl.OneNoteStrings.L_EduDeleteLockedPagePermanentlyConfirmation:Box4Intl.Box4Strings.l_DeletePageConfirmation,n.showWarning(r,i,(function(n,i){1===n&&t.deletePage(e,!0)}))},t.prototype.showDeleteMultiplePagesDialog=function(e){var t=this,n=new Vn.StandardDialog;n.set_buttonsOption(4),n.setDefaultButton(2),n.showWarning(CommonUIStrings.l_DefaultDialogTitle,OneNoteIntl.OneNoteStrings.L_DeletePagesPermanentlyConfirmation,(function(n,i){if(1===n)for(var r=e.$$lge();r.$$mn();){var o=r.$$cu();t.deletePage(o,!0)}}))},t.prototype.deletePage=function(e,t){Dr.t.mark(6253);var n=e;L.AFrameworkApplication.get_theActionManager().processAction(nS.u.pageDeleted,2);var i=this._workspaceResolver();if(n.get_anchor()&&i){var r=this._graphTransactionFactory.getTransaction(7);if(r.setFromNode(e),this.get_PageReader().isConflictPageNode(n))i.onGraphSpaceShutdown(n),this.DeleteConflictPage(n);else if(this.get_PageReader().isVersionNode(n))i.onGraphSpaceShutdown(n),this.DeleteVersion(n);else if(!yi.App.theNotebookManager.get_isRecycleBinEnabled()||Jb.c.isNodeInRecycleBin(n)||t)this.forceDeletePage(n),i.onGraphSpaceShutdown(n);else{L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IOneNoteRecycleBinSettings"),S.ULS.sendTraceTag(19957528,339,50,"Move page to recyclebin start.");var o=this.get_PageReader().getTitle(n),a=String.format(OneNoteIntl.OneNoteStrings.L_DeletePageSucceedToastMessage,o);this.ShowDeleteRestorePageToast(a),i.onGraphSpaceShutdown(n),this.DeleteOriginalPageAndMovePageToRecycleBin(n)}r.dispose(),Dr.t.mark(6254)}L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.cancelFindAndSearch,2)},t.prototype.DeleteOriginalPageAndMovePageToRecycleBin=function(e){var t=this;if(!e.get_isContentPresent())return e.get_contentReplicator()||e.attachContentReplicator("DeleteOriginalPageAndMoveToRecycleBin_Page"),void e.get_contentReplicator().forceInbound((function(n){var i=t._graphTransactionFactory.getTransaction(3);i.setFromNode(e),t.DeleteOriginalPageAndMovePageToRecycleBin(e),i.dispose()}),null,null);e.get_contentReplicator().set_waitingForRecycleBin(!0);var n=e.getParentGraphSpace();n.get_contentReplicator()||n.attachContentReplicator("DeleteOriginalPageAndMoveToRecycleBin_Section"),n.get_contentReplicator().set_waitingForRecycleBin(!0),this.forceDeletePage(e);var i=(0,U.m)(new Zb.y,{pageToDelete:e});S.ULS.sendTraceTag(41161989,339,50,"Starting the process of recycle bin"),this.get_NotebookEditor().ensureDeletedPagesExists(yi.App.theNotebookManager.get_defaultNotebookNode(),o.i(this,this.movePageToRecycleBin,"movePageToRecycleBin"),o.i(this.get_RecycleBinHelper(),this.get_RecycleBinHelper().logRecycleBinFailure,"logRecycleBinFailure"),i)},t.prototype.movePageToRecycleBin=function(e){S.ULS.sendTraceTag(41161990,339,50,"Moving the page into the recycle bin");var t=(0,y.e)(Zb.y,e);if(!t)return t=(0,U.m)(new Zb.y,{lastFailure:"MovePageToRecycleBin: No valid callbackData when moving page to recycle bin"}),void this.get_RecycleBinHelper().logRecycleBinFailure(t,14);var n=t.recycleBinDeletedPagesNode;if(!n)return t.lastFailure="MovePageToRecycleBin: No deleted pages section found to move the page to",void this.get_RecycleBinHelper().logRecycleBinFailure(t,14);Dr.t.mark(6257);var i=t.pageToDelete;this.MovePageOutOfSection(i,n,null,!0,!1)},t.prototype.ShowDeleteRestorePageToast=function(e){this._deleteRestorePageMessage&&(yi.App.get_activeAppFrame().get_notificationBar().removeEntry(this._deleteRestorePageMessage),this._deleteRestorePageMessage=null),this._deleteRestorePageNotificationPending&&L.AFrameworkApplication.get_theTaskManager().deleteTask(this._deleteRestorePageNotificationTask),this._deleteRestorePageMessage=yi.App.get_activeAppFrame().get_notificationBar().createEntry(e,!0),this._deleteRestorePageMessage.set_image(5),this._deleteRestorePageMessage.set_imagePath("EmptyTrash_16x16x32"),this._deleteRestorePageNotificationTask=new ge.c(4,1,t.DeletePageToastTimeInterval,o.i(this,this.RemoveDeletePageToast,"RemoveDeletePageToast"),47),L.AFrameworkApplication.get_theTaskManager().addTask(this._deleteRestorePageNotificationTask),this._deleteRestorePageNotificationPending=!0,yi.App.get_activeAppFrame().get_notificationBar().addEntry(this._deleteRestorePageMessage)},t.prototype.RemoveDeletePageToast=function(e){yi.App.get_activeAppFrame().get_notificationBar().removeEntry(this._deleteRestorePageMessage),this._deleteRestorePageNotificationPending=!1,this._deleteRestorePageNotificationTask=null},t.prototype.DeleteConflictPage=function(e){this.get_PageNavigator().getContainingPage(e);var t=new ha.g;t.set(this.get_PageNavigator().getContainingPage(e)),t.goToChild(e);var n=new ha.g;n.set(e),n.tryToRootAtAncestorOfType(5),n.disconnectNodeAndReturnToParent(),t.disconnectNodeAndReturnToParent();var i=t.get_currentNode();this.get_PageReader().hasConflictPages(i)||this.SetHasConflictPages(i,!1),this.get_BusinessBarControllerFuture().execute((function(e){e.checkCurrentPageStatusBusinessBars()}))},t.prototype.DeleteVersion=function(e){var t=this.get_PageNavigator().getContainingVersionHistoryGraphSpace(e),n=this._graphTransactionFactory.getTransaction(4);n.setFromNode(t);var i=new ha.g;i.set(t),i.goToChild(e);var r=new ha.g;if(r.set(e),r.tryToRootAtAncestorOfType(28),r.disconnectNodeAndReturnToParent(),r.disconnectNodeAndReturnToParent(),i.disconnectNodeAndReturnToParent(),!this.get_VersionHistoryEditor().getVersionCount(t)){var o=this.get_PageNavigator().getContainingPage(t);this.setHasPageVersions(o,!1)}n.dispose()},t.prototype.forceDeletePage=function(e){var t=this._graphTransactionFactory.getTransaction(4);t.setFromNode(e),e.setValue(is.b.isDeletedGraphSpaceContent,!0),this.UpdateLevelsInSeriesBeforePageRemoval(e),e.get_isContentPresent()?e.get_deleteOnNavigateAway()?this.ForceDeleteBrokenPage(e):this.ForceDeleteLoadedPage(e):-1===e.inboundReplicationStatus?this.get_OneNotePageReader().loadWithCallbacks(e,o.i(this,this.PageDeleteAfterSuccessfulLoad,"PageDeleteAfterSuccessfulLoad"),o.i(this,this.PageDeleteAfterFailedLoad,"PageDeleteAfterFailedLoad"),e):this.ForceDeleteBrokenPage(e),t.dispose()},t.prototype.ForceDeleteLoadedPage=function(e){var t=this._graphTransactionFactory.getTransaction(3);t.setFromNode(e);var n=this.get_PageReader().getMetadataForWrite(e);n?n.setValue(is.b.isDeletedGraphSpaceContent,!0):S.ULS.sendTraceTag(38347616,339,10,"In ForceDeleteLoadedPage, no pageMetaData for pageNode\nNodeType: "+e.get_type()),e.get_anchor().invalidateViewChannel(this._workspaceResolver().get_navigationPaneView().get_viewId(),4),t.dispose(),this.get_UndoManager().clearUndoHistory(e,!1)},t.prototype.ForceDeleteBrokenPage=function(e){var t=ha.g.createFromNode(e);if(t.tryToRootAtAncestorOfType(5)){var n=this._graphTransactionFactory.getTransaction(7);n.setFromIterator(t),t.returnToNodeOfType(6)&&(1===t.getChildCountByRole(45)?t.disconnectNodeAndReturnToParent():(t.goToChild(e),t.disconnectNodeAndReturnToParent()),n.dispose())}},t.prototype.PageDeleteAfterSuccessfulLoad=function(e){this.ForceDeleteLoadedPage(e)},t.prototype.PageDeleteAfterFailedLoad=function(e,t){this.ForceDeleteBrokenPage(e)},t.prototype.onPageDeleteFailure=function(e,t){t.get_contentReplicator().set_blockingPageCopy(null);var n=this._graphTransactionFactory.getTransaction(7);if(n.setFromNode(t),t.removeProperty(is.b.isDeletedGraphSpaceContent),t.get_isContentPresent()){var i=this.get_PageReader().getMetadataForWrite(t);i&&i.removeProperty(is.b.isDeletedGraphSpaceContent)}t.get_anchor().invalidateViewChannel(this._workspaceResolver().get_navigationPaneView().get_viewId(),4),n.dispose(),this.get_UndoManager().clearUndoHistory(t,!1),this.get_PageReader().isPageNode(t)?this.ShowPageDeleteFailureDialog(e,t):S.ULS.sendTraceTag(37291908,339,10,"A page delete failure occurred on a node that wasn't a page node? \nNodeType: "+t.get_type()+"\nIsSectionNode: "+lb.j.isSectionNode(t))},t.prototype.ShowPageDeleteFailureDialog=function(e,t){if(!Ni.h.get_currentDialog()){var n,i,r=new Vn.StandardDialog;r.set_buttonsOption(0),40===e?(n=String.format(Box4Intl.Box4Strings.l_DeletePageConflictDialogText,this.get_PageReader().getTitle(t)),i=il.o.deletePageConflict):(n=String.format(Box4Intl.Box4Strings.l_DeletePageUnknownErrorDialogText,this.get_PageReader().getTitle(t)),i=il.o.deletePageUnknown),r.showError(i,CommonUIStrings.l_DefaultDialogTitle,n,null)}},t.prototype.UpdateLevelsInSeriesBeforePageRemoval=function(e){if(this.get_PageReader().getLevel(e)===$s.PageReader.minPageLevel){var t=Rm.SectionNavigator.getNextSiblingPage(e);t&&this.setLevel(t,$s.PageReader.minPageLevel)}},t.prototype.GetNewLevelForPage=function(e,t){var n,i=new ha.g;return i.set(e),t?(t.ensureContentGraphConnection(),i.goToChild(t),i.goToNextSiblingByRole(49),this.get_PageReader().isPage(i)?n=this.get_PageReader().getLevel(i.get_currentNode()):(n=$s.PageReader.minPageLevel,S.ULS.shipAssertTag(6373635,324,!1)),i.returnToParent()):n=$s.PageReader.minPageLevel,n},t.prototype.SetHasConflictPages=function(e,t){var n=this._graphTransactionFactory.getTransaction(4);n.setFromNode(e.getParentGraphSpace());var i=this._graphTransactionFactory.getTransaction(4);i.setFromNode(e),this.get_PageReader().getMetadataForWrite(e).set_hasConflictPages(t),i.dispose(),n.dispose()},t.prototype.get_IsReadingMode=function(){return 1===yi.App.get_activeAppFrame().get_mode()},t.prototype.setVersionsVisibility=function(e,t){e.get_properties().setValue(Pl.k.versionsVisible,t);var n=new ha.g;n.set(e),n.invalidateViewChannel(this._workspaceResolver().get_navigationPaneView().get_viewId(),8);var i=this.get_PageNavigator().getVersionHistoryNode(e);if(i){var r=this._workspaceResolver();t?r.get_navigationPaneView().tryExpandView():r.get_navigationPaneView().tryCollapseView(!1),i.set_isContentBeingViewed(t)}},t.prototype.setConflictPagesVisibility=function(e,t){var n=this._workspaceResolver();t?n.get_navigationPaneView().tryExpandView():n.get_navigationPaneView().tryCollapseView(!1),e.get_properties().setValue(Pl.k.conflictPagesVisible,t);var i=new ha.g;i.set(e),i.invalidateViewChannel(n.get_navigationPaneView().get_viewId(),8),e.set_isContentBeingViewed(t||n.get_activePage()===e)},t.prototype.increaseIndent=function(e,t){if(this.get_IsReadingMode())return 8;if(this.get_PageReader().isConflictPageNode(e)||this.get_PageReader().isVersionNode(e))return 8;var n=this.get_PageReader().getLevel(e);if(n>=$s.PageReader.maxPageLevel)return 8;var i=new ha.g;i.set(e.getParentGraphSpace()),i.goToChild(e);for(var r=!1;i.goToPreviousSiblingByRole(49);)if(this.get_PageReader().isVisiblePage(i.get_currentNode())){r=!0;break}if(!r)return 8;if(2===t){var o=this._graphTransactionFactory.getTransaction(7);o.setFromIterator(i),this.setLevel(e,n+1),o.dispose()}return 32},t.prototype.decreaseIndent=function(e,t){if(this.get_IsReadingMode())return 8;if(this.get_PageReader().isConflictPageNode(e)||this.get_PageReader().isVersionNode(e))return 8;var n=this.get_PageReader().getLevel(e);if(n<=$s.PageReader.minPageLevel)return 8;if(2===t){var i=this._graphTransactionFactory.getTransaction(7);i.setFromNode(e),this.setLevel(e,n-1),i.dispose()}return 32},t.prototype.moveGivenPage=function(e,t){var n=this.get_PageNavigator().getContainingSection(e),i=new ha.g;if(i.set(n),i.hasChild(e))if(t){var r=this.get_PageNavigator().getNextVisiblePage(e,!1);if(r&&i.hasChild(r))this.move(e,n,r,!1);else if(i.set(n.getParentGraphSpace()),i.goToChild(n),i.goToNextSiblingByRole(49)&&lb.j.isSection(i)&&!Jb.c.isRecycleBinNode(i.get_currentNode())){var o=i.get_currentNode();this.move(e,o,null,!1)}}else{var a=this.get_PageNavigator().getPrevVisiblePage(e,!1);if(a&&i.hasChild(a)){i.set(n),i.goToChild(a);var l=i.goToPreviousSiblingByRole(49);this.move(e,n,l,!1)}else i.set(n.getParentGraphSpace()),i.goToChild(n),i.goToPreviousSiblingByRole(49)&&this.move(e,i.get_currentNode(),null,!0)}},t.prototype.createDeferredPageMoveCallback=function(e,t,n,i,r){return void 0===r&&(r=!0),o.i(new uv(this,this._workspaceResolver(),e,t,n,i,r),new uv(this,this._workspaceResolver(),e,t,n,i,r).Execute,"Execute")},t.prototype.createDeferredPageRestoreCallback=function(e,t,n){return o.i(new cv(this,this._workspaceResolver(),e,t,null,n),new cv(this,this._workspaceResolver(),e,t,null,n).Execute,"Execute")},t.prototype.createDeferredPageCopyCallback=function(e,t,n,i){return o.i(new lv(this,e,t,n,i),new lv(this,e,t,n,i).Execute,"Execute")},t.prototype.get_PageReader=function(){return $s.PageReader.get_instance()},t.prototype.get_PageNavigator=function(){return Ii.PageNavigator.get_instance()},t.prototype.get_PageSeriesEditor=function(){return this._pageSeriesEditorLazy.get_value()},t.prototype.initializeGraphSpaceVersion=function(e){var t=this.get_PageNavigator().getContainingSection(e),n=xi.r.readSchemaRevision(t,is.b.schemaRevisionInOrderToRead),i=ov.y.getSchemaRevisionFromVersion(ov.y.getVersionFromSchemaRevision(n));this._graphSpaceEditor.writeSchemaRevision(e,is.b.schemaRevisionInOrderToRead,i);var r=xi.r.readSchemaRevision(t,rs.o.schemaRevisionInOrderToWrite);16777215===r&&(r=n);var o=ov.y.getSchemaRevisionFromVersion(ov.y.getVersionFromSchemaRevision(r));this._graphSpaceEditor.writeSchemaRevision(e,rs.o.schemaRevisionInOrderToWrite,o)},t.prototype.setHasPageVersions=function(e,t){var n=this._graphTransactionFactory.getTransaction(4);n.setFromNode(e.getParentGraphSpace());var i=this._graphTransactionFactory.getTransaction(4);i.setFromNode(e),this.get_PageReader().getMetadataForWrite(e).set_hasPageVersions(t),i.dispose(),n.dispose()},t.prototype.setNotebookManagementEntityId=function(e){this.get_PageReader().getMetadataForWrite(e).set_notebookManagementEntityId(ai.l.create())},t.prototype.setCreationDate=function(e){this.get_PageReader().getMetadataForWrite(e).set_creationDate(new Date)},t.prototype.setTitle=function(e,t){var n=this._graphTransactionFactory.getTransaction(4);n.setFromNode(e.getParentGraphSpace());var i=this._graphTransactionFactory.getTransaction(4);i.setFromNode(e),this.get_PageReader().getMetadataForWrite(e).set_title(t),i.dispose(),n.dispose()},t.prototype.setLevel=function(e,t){var n=this._graphTransactionFactory.getTransaction(7);if(n.setFromNode(e),!e.get_isContentPresent()){var i=new sv(this,e,t);return this.get_OneNotePageReader().load(e,o.i(i,i.Execute,"Execute"),null),void n.dispose()}var r=ha.g.createFromNode(e);if(r.tryToRootAtAncestorOfType(6),this.get_PageReader().getMetadataForRead(e).get_pageLevel()!==$s.PageReader.minPageLevel||t!==$s.PageReader.minPageLevel+1||r.goToPreviousSibling()){if(this.get_PageReader().getMetadataForRead(e).get_pageLevel()===$s.PageReader.minPageLevel+1&&t===$s.PageReader.minPageLevel&&r.goToPreviousSibling()){(a=ha.g.createFromNode(e)).tryToRootAtAncestorOfType(5),a.returnToParent();l=a.get_currentNode();this.get_PageSeriesEditor().splitPageSeries(l,e)}}else{var a;(a=ha.g.createFromNode(e)).tryToRootAtAncestorOfType(5),a.returnToParent();var l=a.get_currentNode();if(!a.goToPreviousSibling())return void n.dispose();var s=a.get_currentNode();this.get_PageSeriesEditor().mergePageSeries(l,s)}this.get_PageReader().getMetadataForWrite(e).set_pageLevel(t),n.dispose()},t.DeletePageToastTimeInterval=5e3,t}(rv);(0,o.l)(dv,"ebf1a3ce$PageEditor",rv,[Kb.f,Qb.f]);var gv=function(){function e(){}return e.prototype.createSection=function(e,t,n){return void 0===n&&(n=!0),null},e}();(0,o.l)(gv,"7f48f7ce$FolderContentEditor",null,[Ob.s]);var pv=n(1332),hv=function(e){function t(t,n,i,r,o){var a=e.call(this)||this;return a._sectionContentEditor=null,a._sectionEditor=null,a._graphTransactionFactory=null,a._graphNodeFactory=null,a._workspaceResolver=null,a._sectionEditor=t,a._sectionContentEditor=n,a._graphTransactionFactory=i,a._graphNodeFactory=r,a._workspaceResolver=o,a}return(0,v.t)(t,e),t.prototype.createSection=function(e,t,n){if(void 0===n&&(n=!0),!ab.FolderReader.isFolderContent(e))return null;var i=new ha.g;i.set(e.get_currentNode().getParentGraphSpace());var r=i.goToLastChildByRole(49);if(r)for(;!lb.j.isSectionNode(r)&&r;)r=i.goToPreviousSiblingByRole(49);return i.returnToAncestorOfType(1),this.createSectionAfter(i,r,t,n)},t.prototype.createSectionAfter=function(e,t,n,i,r){if(void 0===i&&(i=!0),void 0===r&&(r=null),!ab.FolderReader.isFolder(e))return null;Dr.t.mark(6251),pb.FolderNavigator.moveToFolderContentIfLoaded(e);var o=e.get_currentNode(),a=this._graphTransactionFactory.getTransaction(7);a.setFromIterator(e);var l=new ha.g;l.set(e.get_currentNode());var s=this.insertSection(l,t,n);this._sectionEditor.setTitleForNewSection(l.get_currentNode(),n),this._sectionEditor.setFileIdentityGuid(l.get_currentNode()),this._sectionEditor.setSectionColor(l.get_currentNode());var u=ha.g.createFromNode(o);if(this.updateFileIdentityGuids(u),Rm.SectionNavigator.moveToSectionContentIfLoaded(l),s.set_accessRights(1),i){var c=this._workspaceResolver(),d=this._sectionContentEditor.createPage(l,null,null,r);c&&c.set_activePage(d)}return a.dispose(),Dr.t.mark(6252),s},t.prototype.insertSection=function(e,t,n){if(!ab.FolderReader.isFolderContent(e)||t&&!lb.j.isSectionNode(t))return null;if(!e.tryToRootAtAncestorOfType(1))return null;var i=null;t&&((i=new ha.g).set(t),i.tryToRootAtAncestorOfType(4),i.returnToAncestorOfType(4));var r=this._graphNodeFactory.create(393221);e.insertChildUsingId(r,t?i.get_currentNode():null,1,new mt.h(ai.l.create(),1)),e.goToChild(r);var o=e.get_currentNode().getParentGraphSpace(),a=o.createChildFileGraphSpace(n,"InsertSection"),l=new ha.g;l.set(o),l.insertChild(a,t,49),e.addChild(a,48),e.goToChild(a);var s=new pv.b;return s.setProperty_Unchecked(is.b.topologyCreationTimeStamp,new Date),s.setProperty_Unchecked(is.b.notebookManagementEntityGuid,ai.l.create()),e.addChild(s,50),this._sectionEditor.initializeGraphSpaceVersion(a),a.get_contentReplicator()&&a.get_contentReplicator().forceOutbound(null,null,a),a},t.prototype.updateFileIdentityGuids=function(e){for(var t=e.get_currentNode(),n=null,i=e.goToFirstChild();i;){if(4===e.get_currentNodeType()){var r=i.get_properties().getValueWithDefault(String,k_.w.fileIdentityGuid,"");""!==r&&(n=n?n+","+r:r)}i=e.goToNextSibling()}n&&t.get_properties().setValue(k_.w.sectionFileIdentityGuids,n),e.returnToParent()},t}(gv);(0,o.l)(hv,"1265e5d6$FolderContentEditor",gv,[Gb.s,Ob.s]);var _v=function(){function e(e){void 0===e&&(e=null),this._imageEditor=null,this._imageEditor=e}return e.prototype.writeSchemaRevision=function(e,t,n){var i=e.get_contentMetadata();16777215===n?i.removeProperty(t):i.setValue(t,n)},e.prototype.copyContent=function(e,t){for(var n=t.get_contentObjectSpace().startBuildingRevision(),i=e.get_contentObjectSpace().get_currentRevision(),r=i.listAllObjects(),o=0;o<r.length;o++)this.CopyObjectSpaceObject(e,t,r[o],n);for(var a=1;a<=4;a++)if(3!==a){var l=i.getRootObjectId(a);l&&!l.equals(mt.h.get_nil())&&n.setRootObjectId(l,a)}var s=t.get_contentObjectSpace().finishBuildingRevision();t.loadContent(s)},e.prototype.CopyObjectSpaceObject=function(e,t,n,i){var r=n.clone();r.set_id(n.get_id()),(pa.ImageReader.isPictureContainer(r)||524342===r.get_runtimeClassId())&&((e.get_encryptionSessionString()||t.get_encryptionSessionString())&&this._imageEditor.get_value().setNewFileDataObjectId(r),t.isOneNoteEnsureFreshNeeded=!0,t.isOneNotePageVersionCreatePending=!0),393271===(n=r).get_runtimeClassId()&&n.removeProperties(rs.o.graphSpaceVersionHistoryContextNodes,is.b.graphSpaceElementNodes),65599!==n.get_runtimeClassId()&&i.addToRevision(n)},e}();(0,o.l)(_v,"48a24041$GraphSpaceEditor",null,[Vb.e]);var mv=n(5565),fv=function(){function e(e,t,n,i){this._pageEditor=null,this._sectionContentEditorLazy=null,this._versionHistoryEditor=null,this._transactionFactory=null,this._pageEditor=e,this._sectionContentEditorLazy=t,this._versionHistoryEditor=n,this._transactionFactory=i}return e.prototype.get_PageReader=function(){return $s.PageReader.get_instance()},e.prototype.get_SectionContentEditor=function(){return this._sectionContentEditorLazy.get_value()},e.prototype.createPageAfterSubpage=function(e){if(!e)return null;Dr.t.mark(6249);var t=ha.g.createFromNode(e);if(!t.tryToRootAtAncestorOfType(6))return Dr.t.mark(6250),null;var n,i=ha.g.createFromNode(e);if(i.tryToRootAtAncestorOfType(6),!i.goToPreviousSibling()&&!i.goToNextSibling())return Dr.t.mark(6250),null;n=t.goToNextSibling()?this.get_PageReader().getLevel(t.get_currentNode()):this.get_PageReader().getLevel(e),t.returnToParent();var r=t.get_currentNode().getParentGraphSpace(),o=r.createChildGraphSpace(1,"CreatePageAfterSubpage"),a=new ha.g;return a.set(r),a.insertChild(o,e,49),t.insertChild(o,e,45),t.goToChild(o),this.createPageContent(t,void 0,void 0,n),L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.cancelFindAndSearch,2),Dr.t.mark(6250),o},e.prototype.createPage=function(e,t,n,i){if(void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),Dr.t.mark(6249),!lb.j.isPageSeries(e))return null;var r=this._transactionFactory.getTransaction(4);r.setFromIterator(e);var o=this.FindGraphSpaceNodeToInsertPageAfter(e.get_currentNode()),a=e.get_currentNode().getParentGraphSpace(),l=a.createChildGraphSpace(1,"CreatePage"),s=new ha.g;return s.set(a),s.insertChild(l,o,49),e.addChild(l,45),e.goToChild(l),this.createPageContent(e,t,n,$s.PageReader.defaultPageLevel,i),L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.cancelFindAndSearch,2),r.dispose(),Dr.t.mark(6250),l},e.prototype.createPageContent=function(e,t,n,i,r){if(void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),i||(i=$s.PageReader.defaultPageLevel),this.get_PageReader().isPage(e)){var o=e.get_currentNode(),a=ps.i.get_instance().createInstance(393271);e.addChild(a,50),e.goToChild(a),this.InitializePageContent(e,t,n),e.returnToNode(o),this._pageEditor.setNotebookManagementEntityId(o),this._pageEditor.setCreationDate(o),this._pageEditor.setLevel(o,i),r&&""!==r&&this._pageEditor.setTitle(o,r),this._pageEditor.initializeGraphSpaceVersion(o),this._versionHistoryEditor.createVersionHistoryGraph(e),e.returnToNode(o)}},e.prototype.InitializePageContent=function(t,n,i){var r=ps.i.get_instance().createInstance(393227);e.get_pageContentEditor().setRtl(r,L.AFrameworkApplication.get_isRtl()),e.get_pageContentEditor().setLayoutResolveChildCollisions(r),e.get_pageContentEditor().setMarginOrigin(r),t.addChild(r,2),t.goToChild(r),e.get_pageContentEditor().createTitle(t,n,i),t.returnToAncestorOfType(7)},e.prototype.FindGraphSpaceNodeToInsertPageAfter=function(e){var t=new ha.g;t.set(e);var n=t.goToLastChild();return n||(t.tryToRootAtAncestorOfType(5),t.goToPreviousSibling()&&t.goToLastChild()?t.get_currentNode():null)},e.prototype.moveCachedMetadataReference=function(e,t,n,i){void 0===i&&(i=null),i||(i=n);var r=Array.clone(e.getValueWithDefault(Array,rs.o.cachedMetaDataObjects,[])),o=Array.clone(t.getValueWithDefault(Array,rs.o.cachedMetaDataObjects,[])),a=Array.indexOf(r,i.get_cachedMetadataId());a>-1&&(Array.removeAt(r,a),Array.add(o,n.get_cachedMetadataId())),r.length>0?e.setValue(rs.o.cachedMetaDataObjects,r):e.get_properties().removeProperty(rs.o.cachedMetaDataObjects),t.setValue(rs.o.cachedMetaDataObjects,o)},e.prototype.mergePageSeries=function(e,t){var n=this._transactionFactory.getTransaction(4);n.setFromNode(t);var i=ha.g.createFromNode(e),r=Array.clone(t.getValueWithDefault(Array,rs.o.cachedMetaDataObjects,[])),o=Array.clone(e.getValueWithDefault(Array,rs.o.cachedMetaDataObjects,[]));r=r.concat(o),t.setValue(rs.o.cachedMetaDataObjects,r),i.set(e);for(var a=i.goToFirstChildByRole(45),l=ha.g.createFromNode(t);a;){var s=i.goToNextSiblingByRole(45),u=ha.g.createFromNode(a);u.tryToRootAtAncestorOfType(6)&&(u.disconnectNodeAndReturnToParent(),l.addChild(a,45),u.tryToRootAtAncestorOfType(5)&&(u.hasChildren()||u.disconnectNodeAndReturnToParent())),a=s}n.dispose()},e.prototype.splitPageSeries=function(e,t){var n=ha.g.createFromNode(e);if(n.tryToRootAtAncestorOfType(5)){var i=this._transactionFactory.getTransaction(4);i.setFromIterator(n),n.returnToParent();var r,o=this.get_SectionContentEditor().insertPageSeries(n,e),a=t,l=ha.g.createFromNode(t);l.tryToRootAtAncestor(e);for(var s=Array.clone(e.getValueWithDefault(Array,rs.o.cachedMetaDataObjects,[])),u=[];a;){r=l.goToNextSiblingByRole(45);var c=ha.g.createFromNode(a);c.tryToRootAtAncestor(e),c.disconnectNodeAndReturnToParent(),n.addChild(a,45);var d=Array.indexOf(s,a.get_cachedMetadataId());d>-1&&(Array.removeAt(s,d),Array.add(u,a.get_cachedMetadataId())),a=r}e.setValue(rs.o.cachedMetaDataObjects,s),o.setValue(rs.o.cachedMetaDataObjects,u),i.dispose()}},e.prototype.getPageSeriesOfPage=function(e){return e?((t=new ha.g).set(e),t.tryToRootAtAncestorOfType(6),t.returnToAncestorOfType(6),t.get_currentNode()):null;var t},e.get_pageContentEditor=function(){return e._pageContentEditor||(e._pageContentEditor=Ge.w.get_instance().resolve(mv.m))},e.set_pageContentEditor=function(t){return e._pageContentEditor=t,t},e._pageContentEditor=null,e}();(0,o.l)(fv,"b5a31001$PageSeriesEditor",null,[zb]);var yv=function(){function e(e,t,n){this._sectionNavPaneViewElementGetter=null,this._sectionContentEditor=null,this._graphTransactionFactory=null,this.Iterator=null,this.Iterator=e,this._sectionContentEditor=t,this._graphTransactionFactory=n,this._sectionNavPaneViewElementGetter=function(t){return e.get_currentNode().getHtmlViewElement(yi.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId())}}return e.prototype.set_SectionNavPaneViewElementGetter=function(e){return this._sectionNavPaneViewElementGetter=e,e},e.prototype.Execute=function(e){var t=e.Iterator;this._sectionNavPaneViewElementGetter(t).setIsLoading(!1),xi.r.moveToContentIfLoaded(t);var n=this._graphTransactionFactory.getTransaction(7);n.setFromIterator(t),this._sectionContentEditor.createPage(t),n.dispose()},e}();(0,o.l)(yv,"8d07179d$DeferredCreatePage",null,[]);var Cv=function(){function e(e,t,n,i){this._pageSeriesEditor=null,this._sectionEditorLazy=null,this._graphNodeFactory=null,this._graphTransactionFactory=null,this._sectionNavPaneViewElementGetter=null,this._sectionEditorLazy=e,this._pageSeriesEditor=t,this._graphNodeFactory=n,this._graphTransactionFactory=i,this._sectionNavPaneViewElementGetter=function(e){return e.get_currentNode().getHtmlViewElement(yi.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId())}}return e.prototype.get_SectionEditor=function(){return this._sectionEditorLazy.get_value()},e.prototype.set_SectionNavPaneViewElementGetter=function(e){return this._sectionNavPaneViewElementGetter=e,e},e.prototype.createPageSeries=function(e){if(!lb.j.isSectionContent(e))return null;var t=this._graphNodeFactory.create(393224);return this.InitializePageSeries(t),e.addChild(t,1),e.goToChild(t),t},e.prototype.insertPageSeries=function(e,t){if(!lb.j.isSectionContent(e))return null;var n=this._graphTransactionFactory.getTransaction(4);n.setFromIterator(e);var i=this._graphNodeFactory.create(393224);return this.InitializePageSeries(i),e.insertChild(i,t,1),e.goToChild(i),n.dispose(),i},e.prototype.InitializePageSeries=function(e){e.setValue(is.b.notebookManagementEntityGuid,ai.l.create()),e.setValue(is.b.topologyCreationTimeStamp,new Date)},e.prototype.createPage=function(e,t,n,i){if(void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),!lb.j.isSectionContent(e)){var r=new yv(e,this,this._graphTransactionFactory),a=this._sectionNavPaneViewElementGetter(e);return a.setIsLoading(!0),this.get_SectionEditor().load(e.get_currentNode(),o.i(r,r.Execute,"Execute"),o.i(a,a.onSectionContentLoadFail,"onSectionContentLoadFail"),r),null}return e.tryToRootAtAncestorOfType(1)?(this.createPageSeries(e),this._pageSeriesEditor.createPage(e,t,n,i)):null},e.prototype.insertPage=function(e,t){if(!lb.j.isSectionContent(e))return null;if(!e.tryToRootAtAncestorOfType(1))return null;var n=null;if(t){var i=new ha.g;i.set(t),i.tryToRootAtAncestorOfType(6),n=i.returnToAncestorOfType(6)}return this.insertPageSeries(e,n),this._pageSeriesEditor.createPage(e)},e}();(0,o.l)(Cv,"a50b669$SectionContentEditor",null,[$b.x]);var Sv=function(){function e(e,t,n,i,r){this._folderEditorLazy=null,this._folderContentEditor=null,this._graphSpaceEditor=null,this._graphTransactionFactory=null,this._workspaceResolver=null,this._folderEditorLazy=e,this._folderContentEditor=t,this._graphSpaceEditor=n,this._graphTransactionFactory=i,this._workspaceResolver=r}return e.prototype.get_FolderEditor=function(){return this._folderEditorLazy.get_value()},e.prototype.get_FolderContentEditor=function(){return this._folderContentEditor.get_value()},e.prototype.initializeGraphSpaceVersion=function(e){this._graphSpaceEditor.writeSchemaRevision(e,is.b.schemaRevisionInOrderToRead,40),this._graphSpaceEditor.writeSchemaRevision(e,rs.o.schemaRevisionInOrderToWrite,40)},e.prototype.setTitleForRenameSection=function(e,t){e.getContentGraph().get_properties().setValue(rs.o.preferredSectionName,t),this.getMetadataForWrite(e).set_preferredSectionName(t+(t.endsWith(".one")?"":".one"))},e.prototype.setTitleForNewSection=function(e,t){e.getContentGraph().get_properties().setValue(is.b.sectionName,t),this.getMetadataForWrite(e).set_newFileName(t+(t.endsWith(".one")?"":".one"))},e.prototype.setFileIdForSection=function(e){var t=ha.g.createFromNode(e);t.tryToRootAtAncestorOfType(4),t.returnToAncestorOfType(4);e.getContentGraph();this.getMetadataForWrite(e).set_fileId(t.get_currentNode().getValue(String,Pl.k.targetFileId))},e.prototype.setNotebookPagesSectionNode=function(e,t){var n=e.getContentGraph();n&&n.get_properties().setValue(rs.o.isNotebookPagesSection,t)},e.prototype.showDeleteSectionDialog=function(e){var t=this,n=new Vn.StandardDialog;n.set_buttonsOption(7),n.setDefaultButton(0),n.showWarning(OneNoteIntl.OneNoteStrings.L_DeleteSectionConfirmationTitle,OneNoteIntl.OneNoteStrings.L_DeleteSectionConfirmationDescription,(function(n,i){1===n&&t.deleteSection(e)}))},e.prototype.deleteSection=function(e){Dr.t.mark(6255);var t=new ha.g;t.set(e),t.tryToRootAtAncestorOfType(1),t.returnToAncestorOfType(1),t.goToChild(e);var n=new ha.g;n.set(e),n.tryToRootAtAncestorOfType(3);var i=this._graphTransactionFactory.getTransaction(7);i.setFromIterator(t);var r=this.GetWorkspaceActionForDeleteSection(e);n.disconnectNodeAndReturnToParent();var o=n.get_currentNode().getValue(String,Pl.k.targetFileId),a=n.get_currentNode().getValueWithDefault(String,k_.w.fileIdentityGuid,"");n.disconnectNodeAndReturnToParent();var l,s,u=ha.g.createFromNode(n.get_currentNode()),c=u.get_currentNode().getGraphSpace();this.get_FolderContentEditor().updateFileIdentityGuids(u),l=n.get_currentNode().get_properties().hasProperty(k_.w.deletedElements)&&n.get_currentNode().get_properties().getValue(String,k_.w.deletedElements).length?(l=n.get_currentNode().get_properties().getValue(String,k_.w.deletedElements))+","+o:o,s=n.get_currentNode().get_properties().hasProperty(k_.w.deletedFileIdentityGuids)&&n.get_currentNode().get_properties().getValue(String,k_.w.deletedFileIdentityGuids).length?(s=n.get_currentNode().get_properties().getValue(String,k_.w.deletedFileIdentityGuids))+","+a:a,n.get_currentNode().get_properties().setValue(k_.w.deletedElements,l),n.get_currentNode().get_properties().setValue(k_.w.deletedFileIdentityGuids,s),r&&r(),c.get_contentReplicator()&&c.get_contentReplicator().forceOutbound(null,null,null),t.disconnectNodeAndReturnToParent(),i.dispose(),Dr.t.mark(6256)},e.prototype.GetWorkspaceActionForDeleteSection=function(e){var t=this._workspaceResolver(),n=t.get_activeSection();if(n!==e)return null;var i=pb.FolderNavigator.getNextPageInNewSection(n)||pb.FolderNavigator.getPreviousPageInNewSection(n);if(i)return function(){t.set_activePage(i)};var r=Rm.SectionNavigator.getNextSection(n)||Rm.SectionNavigator.getPreviousSection(n);if(r)return function(){t.set_activeSection(r)};var o=t.get_activeFolder();return function(){t.set_activeFolder(o)}},e.prototype.moveGivenSection=function(e,t){var n=new ha.g;n.set(e.getParentGraphSpace()),n.goToChild(e),t?lb.j.isSectionNode(n.goToNextSiblingByRole(49))&&this.get_FolderEditor().moveSection(e,n.get_currentNode()):n.goToPreviousSiblingByRole(49)&&this.get_FolderEditor().moveSection(e,n.goToPreviousSiblingByRole(49))},e.prototype.load=function(e,t,n,i){e.get_contentReplicator()||e.attachContentReplicator("LoadSection"),e.get_contentReplicator().forceInbound(t,n,i)},e.prototype.setFileIdentityGuid=function(e){var t=null,n=new ha.g;return n.set(e),n.tryToRootAtAncestorOfType(4),n.returnToAncestorOfType(4)&&(t=n.get_currentNode().get_id().guid.toString(),this.getMetadataForWrite(e).set_fileIdentityGuid(t),n.get_currentNode().get_properties().setValue(k_.w.fileIdentityGuid,t)),t},e.prototype.setSectionColor=function(e,t){void 0===t&&(t=0);var n=!!t,i=new ha.g;i.set(e),i.tryToRootAtAncestorOfType(4),i.returnToAncestorOfType(4)&&(n||(t=as.s.randomBetween(1,17)),this.getMetadataForWrite(e).set_sectionColor(ff.o.notebookColorToBGRValue[t]))},e.prototype.persistSectionColor=function(e){if(e&&lb.j.isSectionNode(e)&&yi.App.notebookMode){var t=ff.o.notebookBGRValueToColor[lb.j.getSectionColor(e).toString()],n=this._graphTransactionFactory.getTransaction(7);n.setFromNode(e),this.setSectionColor(e,t),n.dispose()}},e.prototype.getMetadataForWrite=function(e){return e.get_contentMetadata()},e}();(0,o.l)(Sv,"974b91e0$SectionEditor",null,[db.f]);var bv=function(){function e(){}return e.configure=function(e){e.register(Ub.q).singleInstance().usingFactory((function(){return new nv})),e.register(ev).as(Hb.x).singleInstance().usingFactory((function(){return new ev(e.resolve(Gb.s),e.resolve(cg.c),(function(){return yi.App.get_activeAppFrame().workspace}),e.resolve(Wb.v),e.resolve(Ub.q))})),e.register(_v).as(Vb.e).singleInstance().usingFactory((function(){return new _v(e.resolveLazy(Za.w))})),e.register(hv).as(Gb.s).as(Ob.s).singleInstance().usingFactory((function(){return new hv(e.resolve(db.f),e.resolve($b.x),e.resolve(cg.c),e.resolve(bg.u),(function(){return yi.App.get_activeAppFrame()?yi.App.get_activeAppFrame().workspace:null}))})),e.register(Sv).as(db.f).singleInstance().usingFactory((function(){return new Sv(e.resolveLazy(Hb.x),e.resolveLazy(Gb.s),e.resolve(Vb.e),e.resolve(cg.c),(function(){return yi.App.get_activeAppFrame().workspace}))})),e.register(Cv).as($b.x).singleInstance().usingFactory((function(){return new Cv(e.resolveLazy(db.f),e.resolve(zb),e.resolve(bg.u),e.resolve(cg.c))})),e.register(fv).as(zb).singleInstance().usingFactory((function(){return new fv(e.resolve(Kb.f),e.resolveLazy($b.x),e.resolve(qb.e),e.resolve(cg.c))})),e.register(iv).as(jb).singleInstance().usingFactory((function(){return new iv(e.resolve(Gb.s),e.resolve(Wb.v),e.resolve(Hb.x))})),e.register(dv).as(Kb.f).as(Qb.f).singleInstance().usingFactory((function(){return new dv(e.resolveLazy(zb),e.resolve(Vb.e),e.resolve(cg.c),e.resolveLazy(jb),e.resolveLazy($b.x),e.resolveLazy(db.f),e.resolveLazy(Wb.v))}))},e}();(0,o.l)(bv,"fd5a49be$OneNoteNotebookLevelEditorsComponentConfiguration",null,[]);var vv=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.NotebookLevelEditors"},e.prototype.configure=function(e){bv.configure(e)},e.prototype.init=function(){Ge.w.get_instance().resolve(Ob.s)},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(vv,"10d01f2f$OneNoteNotebookLevelEditorsPackage",null,[s.u,u.s]);var Tv=(0,o.y)("dd3b27df$ITitleEditor"),Av=n(9762),Iv=function(){function e(){}return e.prototype.extendGraphNode=function(e){},e}();(0,o.l)(Iv,"7cc1ce58$CreateParagraphStrategy",null,[Jl]);var wv=function(){function e(t,n){this._listEditor=null,this._insertionPointFormatting=null,this._trackChangeManager=null,this._trackChangeEditor=null,this._listEditor=n,e._listReader=t}return e.prototype.get_ListEditor=function(){return this._listEditor.get_value()},e.prototype.get_InsertionPointFormatting=function(){return this._insertionPointFormatting||(this._insertionPointFormatting=Ge.w.get_instance().tryResolve(Fg.c))},e.prototype.get_TrackChangeManager=function(){return this._trackChangeManager||(this._trackChangeManager=Ge.w.get_instance().resolve(xa.b).get_instance())},e.prototype.get_TrackChangeEditor=function(){return this._trackChangeEditor||(this._trackChangeEditor=Ge.w.get_instance().resolve(es.x).get_instance())},e.prototype.getStyleFromIp=function(e){var t=e,n=t.get_node(),i=this.get_InsertionPointFormatting()?this.get_InsertionPointFormatting().getCharacterStyleObjectId():null,r=null;if(i&&!i.equals(mt.h.get_nil())){var o=n.get_containingObjectSpace();if(!o)return null;var a=o.getObject(i);if(!a)return null;if((r=a)&&1!==bs.StyleReader.getStyleTargetType(r))return null}else{var l=vc.FormattingReader.getFormattingObject(t);r=vc.FormattingReader.getCharacterStyleContainer(l)}return r},e.prototype.setStyleOnParagraphNode=function(t,n,i,r){if(void 0===r&&(r=!1),Ga.ParagraphReader.isParagraphNode(n))if(t)if(bs.StyleReader.isValidStyleContainer(t))if(2===bs.StyleReader.getStyleTargetType(t)){var o=n,a=bs.StyleReader.getStyleSetFromParagraphNode(o);if(a){var l=bs.StyleReader.getStyleId(t);if(l){if(a.getStyleById(l)){var s=null,u=this.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&!r?o.getCurrentFormatProperties():null;i||(s=this.get_ListEditor().reapplyListInfoWithoutPargraphStyleIfNecessary(s,o),e.get_paragraphEditor().clearParagraphFormatting(o,!0)),this.updateStyleSetFromParagraphNode(o,a),Gl.n.get_instance().get_item(61)||(t=a.getStyleById(bs.StyleReader.getStyleId(t))),o.get_properties().setValue(rs.o.paragraphStyle,t.get_id()),o.styleCache=t;for(var c=0;c<o.get_characterProperties().get_length();c++)o.get_characterProperties().get_item(c).get_formatting()&&o.get_characterProperties().get_item(c).get_formatting().invalidateCache();e.get_LstReader().doesStyleImplyList(t)&&(s||((s=new ha.g).set(o),s.tryToRootAtOutlineAncestor(),_s.OutlineElementNavigator.returnToOutlineElement(s)),gs.ListReader.isListOutlineElement(s)||(o.removeProperties(os.j.paraIndentLeft,os.j.paraIndentLeftChars,os.j.paraIndentFirstLine,os.j.paraIndentFirstLineChars,os.j.paraTabCountInTheBeginning,os.j.paraCustomTabStops),this.applyListInfoFromStyle(s,t))),this.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&!r&&u&&this.get_TrackChangeEditor().setParagraphFormatChange(o,u,this.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled())}}else S.ULS.shipAssertTag(7467993,324,!1)}else S.ULS.shipAssertTag(7467992,324,!1)}else S.ULS.shipAssertTag(7467991,324,!1);else S.ULS.shipAssertTag(7467990,324,!1);else S.ULS.shipAssertTag(7467989,324,!1);else S.ULS.shipAssertTag(7467988,324,!1)},e.prototype.applyListInfoFromStyle=function(e,t){},e.prototype.setStyleOnParagraphNodeByName=function(e,t){if(t){S.ULS.shipAssertTag(7467995,324,t.get_isConnected(),"paragraphNode not connected");var n=bs.StyleReader.getStyleSetFromParagraphNode(t);if(n){var i=n.getStyleByName(e);if(!i||!bs.StyleReader.isValidStyleContainer(i))return S.ULS.shipAssertTag(7467997,324,!!i),void S.ULS.shipAssertTag(7467998,324,bs.StyleReader.isValidStyleContainer(i));this.setStyleOnParagraphNode(i,t,!1)}else S.ULS.shipAssertTag(7467996,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else S.ULS.shipAssertTag(7467994,324,!1)},e.prototype.clearStyleOnParagraphNode=function(e,t){var n;void 0===t&&(t=!1),n=Qs.q.isNodeInTitle(e)?Qs.q.isNodeInTitleDateTime(e)?bs.StyleReader.getStyleSetFromParagraphNode(e).getStyleById(bs.StyleReader.styleIdDateTime):bs.StyleReader.getStyleSetFromParagraphNode(e).getStyleById(bs.StyleReader.styleIdTitle):bs.StyleReader.getStyleSetFromParagraphNode(e).getStyleById(Gl.n.get_instance().get_item(61)?bs.StyleReader.get_wordStyleIdNormal():bs.StyleReader.styleIdNormal),this.setStyleOnParagraphNode(n,e,t)},e.prototype.setStyleOnIp=function(e,t){var n=bs.StyleReader.getStyleSetFromParagraphNode(t);n&&n.getStyleById(bs.StyleReader.getStyleId(e))&&(this.updateStyleSetFromParagraphNode(t,n),this.get_InsertionPointFormatting()&&(this.get_InsertionPointFormatting().resetFormatting(),this.get_InsertionPointFormatting().setCharacterStyle(e,t)))},e.prototype.updateStyleSetFromParagraphNode=function(t,n){var i=e.get_PageNavigator().navigateToPageContentNode(t);return!!i&&n.setStyleSetOnPageContentNode(i,!1)},e.get_paragraphEditor=function(){return e._paragraphEditor||(e._paragraphEditor=Ge.w.get_instance().resolve(ns.g))},e.set_paragraphEditor=function(t){return e._paragraphEditor=t,t},e.get_LstReader=function(){return e._listReader||(e._listReader=Ge.w.get_instance().resolve(Ql.c))},e.get_PageNavigator=function(){return Ii.PageNavigator.get_instance()},e._paragraphEditor=null,e._listReader=null,e}();(0,o.l)(wv,"1519f99f$StyleEditor",null,[ts.e]);var xv=function(){return function(){this.depthFromOld=0,this.depthFromNew=0,this.depthFromOld=0,this.depthFromNew=0}}();(0,o.l)(xv,"48da88a0$AboveOutlineElementData",null,[]);var Ev=function(){return function(e){this.depthAboveOldParent=0,this.depthAboveNewParent=0,this.nodeToInsertAfter=null,this.nodeToInsertAfter=e,this.depthAboveOldParent=0,this.depthAboveNewParent=0}}();(0,o.l)(Ev,"9cac714f$DemoteParentData",null,[]);var Fv=function(){return function(e){this.levelDifferenceNewParent=0,this.nodeToInsertAfter=null,this.levelDifferenceNewParent=0,this.nodeToInsertAfter=e}}();(0,o.l)(Fv,"442f663$PromoteParentData",null,[]);var Pv=function(){function e(e,t){this._listReader=null,this._oulineElementEditor=null,this._listReader=e,this._oulineElementEditor=t}return e.prototype.get_OutlineElementEditor=function(){return this._oulineElementEditor.get_value()},e.prototype.canPromote=function(e,t){if(!Ss.OutlineElementReader.isOutlineElement(e))return!1;if(Ss.OutlineElementReader.getAbsoluteOutlineLevel(e)+t<ms.k.first)return!1;if(Qs.q.isInTitle(e))return!1;if(Ss.OutlineElementReader.requiresStrictOutlineStructure(e)&&e.hasChildrenOfRole(1))return!1;var n=new ha.g;return n.setFrom(e),this.GetPromoteParent(n,t,new Fv(null))},e.prototype.promote=function(e,t,n){for(t=this.EnsureValidPromoteDemoteAction(e,t);t++<0;)this.PromoteOutlineElement(e,n)},e.prototype.canDemote=function(e,t){if(!Ss.OutlineElementReader.isOutlineElement(e))return!1;var n=Ss.OutlineElementReader.getAbsoluteOutlineLevel(e);if(n+t>ms.k.last)return!1;var i,r=Ss.OutlineElementReader.getIndentInfoFromOutlineElement(e.get_currentNode()),o=ha.g.createFromNode(e.get_currentNode());o.tryToRootAtAncestorOfType(10);fs.OutlineNavigator.returnToOutlineOrTableCell(o);var a=ys.OutlineReader.getOutlineWidthInMu(o.get_currentNode(),(0,g.m)((function(){return i}),(function(e){return i=e})));if(i&&r.getDxIndentInMu(ms.k.body,n+t)>=a-.5)return!1;if(e.tryToRootAtAncestorOfType(10),Qs.q.isInTitle(e))return!1;if(Ss.OutlineElementReader.requiresStrictOutlineStructure(e)){if(1!==t)return!1;var l=new ha.g;if(l.setFrom(e),_s.OutlineElementNavigator.returnToOutlineElement(l),l.isFirstSiblingByRole(1))return!1}return!0},e.prototype.demote=function(e,t,n){for(t=this.EnsureValidPromoteDemoteAction(e,t);t-- >0;)this.DemoteOutlineElement(e,n)},e.prototype.EnsureValidPromoteDemoteAction=function(e,t){var n=Ss.OutlineElementReader.getAbsoluteOutlineLevel(e),i=n+t;return i<ms.k.first?t=(i=ms.k.first)-n:i>ms.k.last&&(t=(i=ms.k.last)-n),t},e.prototype.GetPromoteParent=function(e,t,n){for(e.isFirstSiblingByRole(1)?n.nodeToInsertAfter=null:(n.nodeToInsertAfter=e.goToPreviousSiblingByRole(1),e.goToNextSiblingByRole(1)),e.returnToParent();e.get_currentNode();){var i=Ss.OutlineElementReader.getChildLevel(e.get_currentNode());if((t+=i)>0&&(!Ss.OutlineElementReader.isOutlineGroup(e)||i===t))return n.levelDifferenceNewParent=t,!0;if(ys.OutlineReader.isOutlineOrTableCellNode(e.get_currentNode()))return!1;n.nodeToInsertAfter=e.get_currentNode(),e.returnToParent()}return!1},e.prototype.PromoteOutlineElement=function(e,t){if(Ss.OutlineElementReader.isOutlineElement(e)){this.ReparentBelow(e,-1,1,!!(1&t));var n=new i_(e),i=new ha.g;i.setFrom(e);var r=new Fv(null);if(this.GetPromoteParent(i,-1,r)){var o=new Cs(r.nodeToInsertAfter);this.get_OutlineElementEditor().getValidParent(i,r.levelDifferenceNewParent,e.get_currentNode(),o)&&(n.restore(e),this.MoveElementNode(e,i,o.nodeToInsertAfter,t))}}},e.prototype.PromoteAllOutlineElements=function(e,t,n){if(!(t>=0)){var i=Ss.OutlineElementReader.getChildLevel(e.get_currentNode());if(i>-t)e.get_currentNode().setValue(is.b.outlineElementChildLevel,Math.min(ms.k.nil,i+t));else{var r=new ha.g;r.setFrom(e),r.goToLastChildByRole(1);var o=!1;do{var a=new ha.g;a.setFrom(r),r.isFirstSiblingByRole(1)&&(r.returnToParent(),r.get_currentNode()===e.get_currentNode()?o=!0:r.isFirstSiblingByRole(1)&&(r.returnToParent(),o=!0)),o||(r.goToPreviousSiblingByRole(1),Ss.OutlineElementReader.isOutlineGroup(r)&&r.goToLastChildByRole(1));var l=new i_(r);this.promote(a,t,1|n),l.restore(r)}while(!o)}}},e.prototype.GetDemoteParent=function(e,t,n){if(!Ss.OutlineElementReader.isOutlineElement(e))return!1;var i=new xv;if(!this.GetAboveOutlineElement(e,t,i))return!1;var r=e.get_currentNode();if(n.depthAboveOldParent=t,i.depthFromNew)if(i.depthFromNew<0)n.depthAboveNewParent=-i.depthFromNew,n.nodeToInsertAfter=null;else{var o=new Fv(n.nodeToInsertAfter);if(!this.GetPromoteParent(e,-i.depthFromNew,o))return!1;n.depthAboveNewParent=o.levelDifferenceNewParent,n.nodeToInsertAfter=o.nodeToInsertAfter,Ss.OutlineElementReader.isOutlineGroup(e)?(n.nodeToInsertAfter=e.get_currentNode(),e.returnToParent(),n.depthAboveNewParent+=Ss.OutlineElementReader.getChildLevel(e.get_currentNode())):e.hasChild(r)&&(n.nodeToInsertAfter=r)}else{var a=e.returnToParent(),l=Ss.OutlineElementReader.getChildLevel(a);n.depthAboveNewParent=l,n.nodeToInsertAfter=r}return!0},e.prototype.DemoteOutlineElement=function(e,t){var n=new i_(e),i=new ha.g;i.setFrom(e);var r=new Ev(null);if(this.GetDemoteParent(i,1,r)){var o=new Cs(r.nodeToInsertAfter);if(this.get_OutlineElementEditor().getValidParent(i,r.depthAboveNewParent,e.get_currentNode(),o)){n.restore(e);var a=gs.ListReader.isListOutlineElement(e);this.MoveElementNode(e,i,o.nodeToInsertAfter,t),1&t||!e.hasChildrenOfRole(1)||this.PromoteAllOutlineElements(e,-1,a?0:2)}}},e.prototype.MoveElementNode=function(e,t,n,i){if(ys.OutlineReader.isOutlineOrTableCellNode(e.get_currentNode())||Ss.OutlineElementReader.isOutlineElement(e)||Ss.OutlineElementReader.isOutlineGroup(e)){var r=new ha.g;if(r.setFrom(e),r.returnToParent(),gs.ListReader.isListOutlineElement(e)&&!(2&i)){var o=this._listReader.getListInfo(e);o.setListStyle(o.get_listType(),0),o.clearNumbering()}var a=e.get_currentNode();if(ws.z.moveNode(e,t,n,1),t.goToChild(a),this.get_OutlineElementEditor().postOutlineElementMove(r),e.set(a),e.tryToRootAtOutlineAncestor(),t.setFrom(e),t.returnToParent(),yi.App.get_activeAppFrame()){var l=yi.App.get_activeAppFrame().workspace.get_contentView();l.get_isInteractiveView()&&l.endEditing(!0,14)}}},e.prototype.GetAboveOutlineElement=function(e,t,n){var i=0,r=!1;if(1!==e.get_role()){for(;1!==e.get_role()&&!e.get_isAtOrigin();)e.returnToParent();if(!ys.OutlineReader.isOutline(e)&&!Ss.OutlineElementReader.isOutlineElement(e))return!1}else{for(var o=!1;!o&&e.isFirstSiblingByRole(1);)if(e.returnToParent(),Ss.OutlineElementReader.isOutlineGroup(e)){if(i)return!1;i=Ss.OutlineElementReader.getChildLevel(e.get_currentNode())}else o=!0;o||(r=!!e.goToPreviousSiblingByRole(1))}if(r){for(n.depthFromOld=-i;e.getChildCountByRole(1)>0;)n.depthFromOld+=Ss.OutlineElementReader.getChildLevel(e.get_currentNode()),e.goToLastChildByRole(1);return n.depthFromNew=n.depthFromOld-t,!0}var a=Ss.OutlineElementReader.getChildLevel(e.get_currentNode())+i;return n.depthFromNew=-(t+a),n.depthFromOld=-a,!0},e.prototype.ReparentBelow=function(e,t,n,i){try{var r=new ha.g;r.setFrom(e);var o=null;if(r.hasChildrenOfRole(n)){if(!i)(l=Ss.OutlineElementReader.getChildLevel(r.get_currentNode()))!==ms.k.nil&&r.get_currentNode().setValue(is.b.outlineElementChildLevel,Math.min(ms.k.nil,l-t));o=r.goToLastChildByRole(n),r.returnToParent()}var a=null;for(r.get_role()===n?a=r.goToNextSiblingByRoleOrReturnToParent(n):(r.returnToParent(),r.hasChildrenOfRole(n)&&(a=r.goToFirstChildByRole(n)));;){if(!a)do{var l;if(t+=l=Ss.OutlineElementReader.getChildLevel(r.get_currentNode()),r.get_isAtOrigin()||(a=r.goToNextSiblingByRoleOrReturnToParent(n)),t>=0)return}while(!a);var s=new ha.g;s.setFrom(e);var u=new ha.g;u.setFrom(r);var c=new ha.g;c.setFrom(u),c.returnToParent(),a=r.goToNextSiblingByRoleOrReturnToParent(n);var d=new i_(u),g=new Cs(o);this.get_OutlineElementEditor().getValidParent(s,-t,null,g),d.restore(u),ws.z.moveNode(u,s,g.nodeToInsertAfter,u.get_role()),o=u.get_currentNode()}}finally{}},e}();(0,o.l)(Pv,"897520f$OutlineElementIndentationEditor",null,[Cb.p]);var Dv=function(){function e(t){this._lastCreatedOutlineNode=null,e._outlineEditor=t}return e.prototype.createOutline=function(t){if(!e.get_pageReader().isPageContent(t))return null;t.goToFirstChildByRole(1)&&(t.get_currentNode().invalidateViewElements(8,!0),t.returnToParent());var n=e._outlineEditor.createOutlineNode();return e.get_pageReader().isRtl(t.get_currentNode())?n.setValue(is.b.layoutAlignmentSelf,11):n.setValue(is.b.layoutAlignmentSelf,9),t.addChild(n,1),t.goToChild(n),n},e.prototype.setLastCreatedOutlineNode=function(e){if(Gl.n.get_instance().get_item(17)){if(this._lastCreatedOutlineNode&&e!==this._lastCreatedOutlineNode){var t=new ge.c(2,1,0,o.i(this,this.checkAndDeleteEphemeralOutline,"checkAndDeleteEphemeralOutline"),120);t.customData=this._lastCreatedOutlineNode,L.AFrameworkApplication.get_theTaskManager().addTask(t)}this._lastCreatedOutlineNode=e}},e.prototype.DeleteOutline=function(e,t){this._lastCreatedOutlineNode===e.get_currentNode()&&(this._lastCreatedOutlineNode=null);var n=new Ma.GraphTransaction(t);n.setFromIterator(e),e.disconnectNodeAndReturnToParent(),n.dispose()},e.prototype.cleanEphemeralOutline=function(){if(Gl.n.get_instance().get_item(17)&&this._lastCreatedOutlineNode&&this._lastCreatedOutlineNode.get_anchor()){var e=ha.g.createFromNode(this._lastCreatedOutlineNode);e.tryToRootAtPageContent()&&ys.OutlineReader.isEphemeral(e)&&this.DeleteOutline(e,7),this._lastCreatedOutlineNode=null}},e.prototype.checkAndDeleteEphemeralOutline=function(e){var t=e.customData;if(t.get_anchor()){Dr.t.mark(4763);var n=ha.g.createFromNode(t);if(n.tryToRootAtAncestorOfType(8)&&n.returnToAncestorOfType(8)&&n.tryGoToChild(t)===t){if(ys.OutlineReader.isEmpty(n)){for(var i=!1,r=0;r<fa.SelectionManager.get_instance().get_selectionCollection().get_length();r++)for(var o=fa.SelectionManager.get_instance().get_selectionCollection().get_item(r),a=0;a<o.get_length();a++){if(o.get_item(a).get_node()===t){i=!0;break}}i||this.DeleteOutline(n,7)}Dr.t.mark(4764)}}},e.get_pageReader=function(){return $s.PageReader.get_instance()},e.titleOutlineMinimumWidth=2.25,e._outlineEditor=null,e}();(0,o.l)(Dv,"8e3bab92$PageContentEditor",null,[jh.m]);var Rv=n(7632),Mv=n(3475),kv=n(7854),Nv=function(e){function t(t){return e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.setRtl=function(e,t){e.get_properties().setValue(is.b.editRootRTL,t)},t.prototype.setPageColor=function(e,t){t===ff.o.nil?e.get_properties().removeProperty(is.b.pageColor):e.get_properties().setValue(is.b.pageColor,t)},t.prototype.setLayoutResolveChildCollisions=function(e){Gl.n.get_instance().get_item(25)&&e.get_properties().setValue(is.b.layoutResolveChildCollisions,!0)},t.prototype.setTitle=function(e,n){if(Dv.get_pageReader().isPageContent(e)){var i,r=new ha.g;r.setFrom(e),Mv.z.findAndMoveToTitleNode(r)||this.createTitle(r,null,L.AFrameworkApplication.requestedLcid),r.goToFirstChildByRole(1),r.hasChildrenOfRole(1)?(r.goToFirstChild(),i=_s.OutlineElementNavigator.moveToContent(r)):i=this.CreateEmptyTitle(r);var o=Ga.ParagraphReader.textLength(i),a=Wa.y.createTextRange(i,0,o);t.get_CharacterPropertiesEditor().replaceTextRange(a,n)}},t.prototype.CreateEmptyTitle=function(e){var n=Dv._outlineEditor.appendOutlineElement(e,!0);n.setValue(is.b.cannotBeSelected,!0),n.setValue(is.b.cannotBeRemoved,!0),t.get_titleEditor().setIsTitleText(e.get_currentNode(),!0);var i=_s.OutlineElementNavigator.moveToContent(e);return t.get_FormattingEditor().setLanguageOnParagraph(vc.FormattingReader.getFormattingObject(Wa.y.createIpContext(i,0)),L.AFrameworkApplication.requestedLcid),t.get_StyleEditor().setStyleOnParagraphNode(bs.StyleReader.getStyleSetFromParagraphNode(e.get_currentNode()).getStyleByName(Box4Intl.Box4Strings.L_StyleTitle),e.get_currentNode(),!1),t.get_titleEditor().setIsTitleText(e.get_currentNode(),!0),i},t.prototype.createTitle=function(e,n,i){if(void 0===n&&(n=null),void 0===i&&(i=null),!Dv.get_pageReader().isPageContent(e))return null;var r,o,a;this.ExtractTitleDateTimeLcid(n,i,(0,g.m)((function(){return r}),(function(e){return r=e})),(0,g.m)((function(){return o}),(function(e){return o=e})),(0,g.m)((function(){return a}),(function(e){return a=e})));var l=new kv.f;e.addChild(l,5),e.goToChild(l),l.setValue(is.b.offsetFromParentHoriz,0),l.setValue(is.b.offsetFromParentVert,0),l.setValue(is.b.layoutAlignmentInParent,589836),l.setValue(is.b.layoutAlignmentSelf,0);var s=t.get_titleEditor().createOutline(e,!1);s.setValue(is.b.cannotBeSelected,!0),s.setValue(is.b.cannotBeRemoved,!0),s.setValue(is.b.descendantsCannotBeMoved,!0),s.setValue(is.b.enforceOutlineStructure,!0),s.setValue(is.b.layoutTightAlignment,!0),s.setValue(is.b.layoutMinimumOutlineWidth,Vu.r.inchesToMu(Dv.titleOutlineMinimumWidth)),t.get_titleEditor().setIsTitleText(e.get_currentNode(),!0);var u=Dv._outlineEditor.appendOutlineElement(e,!0);u.setValue(is.b.cannotBeSelected,!0),u.setValue(is.b.cannotBeRemoved,!0),t.get_titleEditor().setIsTitleText(e.get_currentNode(),!0);var c=_s.OutlineElementNavigator.moveToContent(e);t.get_FormattingEditor().setLanguageOnParagraph(vc.FormattingReader.getFormattingObject(Wa.y.createIpContext(c,0)),L.AFrameworkApplication.requestedLcid),t.get_StyleEditor().setStyleOnParagraphNode(bs.StyleReader.getStyleSetFromParagraphNode(e.get_currentNode()).getStyleByName(Box4Intl.Box4Strings.L_StyleTitle),e.get_currentNode(),!1),t.get_titleEditor().setIsTitleText(e.get_currentNode(),!0);var d=new hm.d;d.languageId=a,e.returnToNodeOfType(9),(s=t.get_titleEditor().createOutline(e,!0)).setValue(is.b.cannotBeSelected,!0),s.setValue(is.b.isReadOnly,!0),s.setValue(is.b.deletable,!0),s.setValue(is.b.layoutTightLayout,!0),t.get_titleEditor().setIsTitleDate(e.get_currentNode(),!0),(u=Dv._outlineEditor.appendOutlineElement(e,!0,d)).setValue(is.b.cannotBeSelected,!0),e.get_currentNode().setValue(is.b.deletable,!0),c=_s.OutlineElementNavigator.moveToContent(e);var p=Wa.y.createIpContext(c,0);return t.get_FormattingEditor().setLanguageOnParagraph(vc.FormattingReader.getFormattingObject(p),a),t.get_titleEditor().setIsTitleDate(e.get_currentNode(),!0),e.get_currentNode().setValue(is.b.isReadOnly,!0),e.get_currentNode().setValue(is.b.isBoilerText,!0),e.get_currentNode().setValue(is.b.deletable,!0),e.get_currentNode().setValue(is.b.layoutTightLayout,!0),t.get_CharacterPropertiesEditor().replaceTextRange(p,r),t.get_StyleEditor().setStyleOnParagraphNode(bs.StyleReader.getStyleSetFromParagraphNode(e.get_currentNode()).getStyleByName(Box4Intl.Box4Strings.L_StyleDateTime),e.get_currentNode(),!1),e.returnToNodeOfType(10),(u=Dv._outlineEditor.appendOutlineElement(e,!0,d)).setValue(is.b.cannotBeSelected,!0),e.get_currentNode().setValue(is.b.deletable,!0),c=_s.OutlineElementNavigator.moveToContent(e),p=Wa.y.createIpContext(c,0),t.get_FormattingEditor().setLanguageOnParagraph(vc.FormattingReader.getFormattingObject(p),a),t.get_titleEditor().setIsTitleTime(e.get_currentNode(),!0),e.get_currentNode().setValue(is.b.isReadOnly,!0),e.get_currentNode().setValue(is.b.isBoilerText,!0),e.get_currentNode().setValue(is.b.deletable,!0),e.get_currentNode().setValue(is.b.layoutTightLayout,!0),t.get_CharacterPropertiesEditor().replaceTextRange(p,o),t.get_StyleEditor().setStyleOnParagraphNode(bs.StyleReader.getStyleSetFromParagraphNode(e.get_currentNode()).getStyleByName(Box4Intl.Box4Strings.L_StyleDateTime),e.get_currentNode(),!1),e.returnToNode(l),l},t.prototype.ExtractTitleDateTimeLcid=function(e,t,n,i,r){n.val="",i.val="",r.val=Ft.i.get_invariantCulture().get_LCID();var o=Ft.i.getCultureInfo(Rv.b.get_dataCulture().name);o&&(r.val=o.get_LCID()),e=e||new Date,n.val=Rv.b.formatDate(e,"D",Rv.b.get_dataCulture()),i.val=Rv.b.formatDate(e,"t",Rv.b.get_dataCulture())},t.prototype.setMarginOrigin=function(e){var t=Dv.get_pageReader().isRtl(e)?-$s.PageReader.pageMarginX:$s.PageReader.pageMarginX;e.setValue(is.b.pageMarginOriginX,t),e.setValue(is.b.pageMarginOriginY,$s.PageReader.pageMarginY)},t.get_FormattingEditor=function(){return t._formattingEditor||(t._formattingEditor=Ge.w.get_instance().resolve(Vs.z))},t.set_FormattingEditor=function(e){return t._formattingEditor=e,e},t.get_StyleEditor=function(){return t._styleEditor||(t._styleEditor=Ge.w.get_instance().resolve(ts.e))},t.set_StyleEditor=function(e){return t._styleEditor=e,e},t.get_CharacterPropertiesEditor=function(){return t._characterPropertiesEditor||(t._characterPropertiesEditor=Ge.w.get_instance().resolve(ba.x))},t.set_CharacterPropertiesEditor=function(e){return t._characterPropertiesEditor=e,e},t.get_titleEditor=function(){return t._titleEditor||(t._titleEditor=Ge.w.get_instance().resolve(Tv))},t.set_titleEditor=function(e){return t._titleEditor=e,e},t.En_Us_Language=1033,t._formattingEditor=null,t._styleEditor=null,t._characterPropertiesEditor=null,t._titleEditor=null,t}(Dv);(0,o.l)(Nv,"38e9658a$PageContentEditor",Dv,[mv.m,jh.m]);var Lv=function(){function e(){}return e.prototype.createOutline=function(t,n){if(!Qs.q.isTitle(t))return null;var i=e.get_outlineEditor().createOutlineNode(n);return i.setValue(is.b.layoutAlignmentSelf,12),t.addChild(i,1),t.goToChild(i),i},e.prototype.setIsTitleTime=function(e,t){e.get_properties().setValue(is.b.isTitleTime,t)},e.prototype.setIsTitleDate=function(e,t){e.get_properties().setValue(is.b.isTitleDate,t)},e.prototype.setIsTitleText=function(e,t){e.get_properties().setValue(is.b.isTitleText,t)},e.prototype.setTitleText=function(t,n){if(n&&""!==n){var i=t.get_currentNode();Mv.z.findAndMoveToTitleNode(t);var r=Mv.z.findAndMoveToTextParagraphNode(t),o=Wa.y.createIpContext(r,0);e.get_characterPropertiesEditor().replaceTextRange(o,n),t.returnToNode(i)}},e.get_outlineEditor=function(){return e._outlineEditor||(e._outlineEditor=Ge.w.get_instance().resolve(zl.a))},e.set_outlineEditor=function(t){return e._outlineEditor=t,t},e.get_characterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=Ge.w.get_instance().resolve(ba.x))},e.set_characterPropertiesEditor=function(t){return e._characterPropertiesEditor=t,t},e._outlineEditor=null,e._characterPropertiesEditor=null,e}();(0,o.l)(Lv,"b7d6db0$TitleEditor",null,[Tv]);var Bv=function(){function e(){}return e.configure=function(e){e.register(Av.q).as(Kl.z).singleInstance(),e.register(Nv).as(mv.m).as(jh.m).singleInstance().usingFactory((function(){return new Nv(e.resolve(zl.a))})),e.register(Pv).as(Cb.p).singleInstance().usingFactory((function(){return new Pv(e.resolve(Ql.c),e.resolveLazy(ql.p))})),e.register(Lv).as(Tv).singleInstance().usingFactory((function(){return new Lv})),e.register(wv).as(ts.e).singleInstance().usingFactory((function(){return new wv(e.resolve(Ql.c),e.resolveLazy(jl.v))})),e.register(Iv).as(Jl).singleInstance()},e}();(0,o.l)(Bv,"c661fa1e$OneNoteOutlineLevelEditorsComponentConfiguration",null,[]);var Ov=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.OutlineLevelEditors"},e.prototype.configure=function(e){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OutlineLevelEditorsDelayInitializationEnabled")&&Bv.configure(e)},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Ov,"22ee70f$OneNoteOutlineLevelEditorsPackage",null,[s.u,u.s]);var Uv=(0,o.y)("214965b1$IOfflineSyncStatusHandler"),Hv=n(408),Gv=(0,o.y)("e96b38bb$ISyncStatusWrapper"),Wv=(0,o.y)("4cad6855$IPageSyncStatusPublisher"),Vv=n(6179),$v=n(9610),zv=function(){function e(e,t){this._workspace=null,this._timerId=0,this.$$pf_IsOffline=!1,this.$$pf_IsOfflineMoreThanAMinute=!1,e.subscribe(this),this._workspace=t}return e.prototype.get_isOffline=function(){return this.$$pf_IsOffline},e.prototype.set_isOffline=function(e){return this.$$pf_IsOffline=e,e},e.prototype.get_isOfflineMoreThanAMinute=function(){return this.$$pf_IsOfflineMoreThanAMinute},e.prototype.set_isOfflineMoreThanAMinute=function(e){return this.$$pf_IsOfflineMoreThanAMinute=e,e},e.prototype.get_SyncStatusPublisher=function(){return Ge.w.get_instance().resolve(Wv)},e.prototype.get_SyncStatusWrapper=function(){return Ge.w.get_instance().resolve(Gv)},e.prototype.serverConnectivityChanged=function(e){var t=this.get_isOffline();this.set_isOffline(!e),!t&&this.get_isOffline()?(yi.App.get_activeAppFrame().logUnsavedChanges("NetworkDisconnected"),this._timerId=window.setTimeout(o.i(this,this.OfflineAfterTimer,"OfflineAfterTimer"),6e4),this._workspace.get_activePage()&&this.get_SyncStatusPublisher().publishOfflineStatus(this._workspace.get_activePage().currentSyncState,!1)):t&&!this.get_isOffline()&&this._timerId&&(window.clearTimeout(this._timerId),this._workspace.get_activePage()&&(this.get_SyncStatusWrapper().updateSyncStatusFromOffline(this._workspace.get_activePage().get_contentReplicator()),this.get_SyncStatusPublisher().publishSyncStatus(this.get_SyncStatusWrapper().getCurrentSyncState(this._workspace.get_activePage().get_contentReplicator()))),S.ULS.sendTraceTag(50922010,339,15,"OfflineSyncStatusHandler: Server Connectivity Status changed from offline to online")),this.set_isOfflineMoreThanAMinute(!1)},e.prototype.OfflineAfterTimer=function(){this.get_isOffline()&&(this.set_isOfflineMoreThanAMinute(!0),this._workspace.get_activePage()&&this.get_SyncStatusPublisher().publishOfflineStatus(this._workspace.get_activePage().currentSyncState,!0),S.ULS.sendTraceTag(50922011,339,15,"OfflineSyncStatusHandler: In Offline State more than a minute"))},e}();(0,o.l)(zv,"1643898$OfflineSyncStatusHandler",null,[Uv,$v.s]);var Kv=function(){return function(e,t,n,i){void 0===i&&(i=-1),this.status=0,this.resultCode=0,this.lastSuccessfulTime=null,this.uploadingFileCount=0,this.hasUnsavedChanges=!1,this.hasReadAccess=!1,this.status=e,this.resultCode=t,this.lastSuccessfulTime=n,this.uploadingFileCount=i}}();(0,o.l)(Kv,"cf058660$SyncState",null,[]);var qv=n(8291),jv=function(){function e(e,t,n){var i=this;this._syncStatusWrapper=null,this._syncStatusPublisher=null,this._workspace=null,this._editNotificationEventSource=null,this.offlineHandler=null,e.add_onOutboundReplicationStart(o.i(this,this.onOutboundStart,"onOutboundStart")),e.add_onSuccessfulOutboundEvent(o.i(this,this.onSuccessfulOutbound,"onSuccessfulOutbound")),e.add_onFailedOutboundEvent(o.i(this,this.onFailedOutbound,"onFailedOutbound")),e.add_onSuccessfulInboundEvent(o.i(this,this.onSuccessfulInbound,"onSuccessfulInbound")),e.add_onFirstSuccessfulInboundEvent(o.i(this,this.onSuccessfulInbound,"onSuccessfulInbound")),e.add_onFailedInboundEvent(o.i(this,this.onFailedInbound,"onFailedInbound")),t.add_onUploadStarted(o.i(this,this.onFileUploadStart,"onFileUploadStart")),t.add_onUploadCompleted(o.i(this,this.onFileUploadCompleted,"onFileUploadCompleted")),n.add_beforePageSwitch(o.i(this,this.beforeActivePageChanged,"beforeActivePageChanged")),this._workspace=n,this.offlineHandler=Ge.w.get_instance().resolve(Uv),this._editNotificationEventSource=Ge.w.get_instance().resolveFuture(ce.n),this._editNotificationEventSource&&this._editNotificationEventSource.execute((function(e){e.add_onEditHappened(o.i(i,i.onEditHappenedHandler,"onEditHappenedHandler"))})),this.PublishInitialSyncStatusUpdate()}return e.prototype.get_SyncStatusWrapper=function(){return this._syncStatusWrapper||(this._syncStatusWrapper=Ge.w.get_instance().resolve(Gv))},e.prototype.get_SyncStatusPublisher=function(){return this._syncStatusPublisher||(this._syncStatusPublisher=Ge.w.get_instance().resolve(Wv))},e.prototype.onOutboundStart=function(e,t){this.UpdateToSyncingState(t.get_graphSpaceReplicator())},e.prototype.onSuccessfulOutbound=function(e,t){var n=this.get_SyncStatusWrapper().getCurrentSyncState(t.get_graphSpaceReplicator()),i=n?n.status:1,r=n?n.resultCode:-1;this.ShouldUpdateSyncSuccessful(t.get_graphSpaceReplicator())&&(this.get_SyncStatusWrapper().updateSyncState(t.get_graphSpaceReplicator(),2,0),this.ShouldPublishSyncStatus(t.get_graphSpaceReplicator().get_node(),i,r,2)&&this.get_SyncStatusPublisher().publishSyncStatus(this.get_SyncStatusWrapper().getCurrentSyncState(t.get_graphSpaceReplicator())))},e.prototype.onFailedOutbound=function(e,t){if(!t.get_isFilteredError()){var n=t.get_graphSpaceReplicator(),i=Ii.PageNavigator.get_instance().getContainingPageFromVersionOrVersionHistory(t.get_graphSpaceReplicator().get_node());i&&(n=i.get_contentReplicator());var r=this.get_SyncStatusWrapper().getCurrentSyncState(n);this.UpdateAndPublishFailureStatus(n.get_node(),r,t.get_operationResult(),i?"Version Outbound":"Outbound")}},e.prototype.onSuccessfulInbound=function(e,t){var n=this.get_SyncStatusWrapper().getCurrentSyncState(t.get_graphSpaceReplicator()),i=n?n.status:1,r=n?n.resultCode:-1;this.ShouldUpdateSyncSuccessful(t.get_graphSpaceReplicator())&&!this.PropagatedSectionBlockingFailure(t.get_graphSpaceReplicator().get_node(),n)&&(this.get_SyncStatusWrapper().updateSyncState(t.get_graphSpaceReplicator(),2,0),this.ShouldPublishSyncStatus(t.get_graphSpaceReplicator().get_node(),i,r,2)&&this.get_SyncStatusPublisher().publishSyncStatus(this.get_SyncStatusWrapper().getCurrentSyncState(t.get_graphSpaceReplicator())))},e.prototype.onFailedInbound=function(e,t){if(!t.get_isFilteredError()){var n=this.get_SyncStatusWrapper().getCurrentSyncState(t.get_graphSpaceReplicator());this.UpdateAndPublishFailureStatus(t.get_graphSpaceReplicator().get_node(),n,t.get_operationResult(),"Inbound")}},e.prototype.beforeActivePageChanged=function(e,t){var n=(0,y.e)(qv.q,t);if(this.ShouldHideSyncStatus(n.newPageNode))this.get_SyncStatusPublisher().hideSyncStatus();else{var i,r=!1;if(n.newPageNode.currentSyncState&&n.newPageNode.get_contentReplicator())this.PropagatedSectionBlockingFailure(n.newPageNode,n.newPageNode.currentSyncState),this.offlineHandler.get_isOffline()&&4!==n.newPageNode.currentSyncState.status?(this.get_SyncStatusWrapper().updateSyncState(n.newPageNode.get_contentReplicator(),4),r=!0):this.offlineHandler.get_isOffline()||4!==n.newPageNode.currentSyncState.status||(this.get_SyncStatusWrapper().updateSyncStatusFromOffline(n.newPageNode.get_contentReplicator()),r=!0),i=this.get_SyncStatusWrapper().getCurrentSyncState(n.newPageNode.get_contentReplicator());else{var o=this.offlineHandler.get_isOffline()?4:this.get_SyncStatusWrapper().convertOperationResultToSyncStatus(n.newPageNode.inboundReplicationStatus);r=!0,n.newPageNode.get_contentReplicator()&&-1!==n.newPageNode.inboundReplicationStatus?(this.get_SyncStatusWrapper().updateSyncState(n.newPageNode.get_contentReplicator(),o,n.newPageNode.inboundReplicationStatus),i=this.get_SyncStatusWrapper().getCurrentSyncState(n.newPageNode.get_contentReplicator())):i=new Kv(o,n.newPageNode.inboundReplicationStatus,null)}this.get_SyncStatusPublisher().publishSyncStatus(i,r)}},e.prototype.onFileUploadStart=function(e,t){var n=t.get_parentGraphSpaceNode().get_contentReplicator(),i=this.get_SyncStatusWrapper().getCurrentSyncState(n),r=i?i.status:1,o=i?i.resultCode:-1,a=this.offlineHandler.get_isOffline()?4:1;this.get_SyncStatusWrapper().updateSyncState(n,a,-1,i.uploadingFileCount+1),this.ShouldPublishSyncStatus(n.get_node(),r,o,a)&&this.get_SyncStatusPublisher().publishSyncStatus(this.get_SyncStatusWrapper().getCurrentSyncState(n))},e.prototype.onFileUploadCompleted=function(e,t){if(t.get_parentGraphSpaceNode()){var n=t.get_parentGraphSpaceNode().get_contentReplicator(),i=this.get_SyncStatusWrapper().getCurrentSyncState(n),r=i?i.status:1,o=i?i.resultCode:-1,a=r,l=i.uploadingFileCount,s=o;l-1||t.get_uploadResult()||n.hasChangesToOutbound()?t.get_uploadResult()&&(a=this.offlineHandler.get_isOffline()?4:3,s=t.get_uploadResult(),S.ULS.sendTraceTag(50922014,339,15,"PageSyncStatusHandler: File Upload failure: {0}",s)):(a=2,s=0),this.get_SyncStatusWrapper().updateSyncState(n,a,s,l-1),this.ShouldPublishSyncStatus(n.get_node(),r,o,a,s)&&this.get_SyncStatusPublisher().publishSyncStatus(this.get_SyncStatusWrapper().getCurrentSyncState(n))}},e.prototype.onEditHappenedHandler=function(e,t){this._workspace.get_activePage()&&this._workspace.get_activePage().get_contentReplicator()&&this.UpdateToSyncingState(this._workspace.get_activePage().get_contentReplicator())},e.prototype.updateToIntermediateState=function(e){this.get_SyncStatusWrapper().updateSyncState(e,1),this.get_SyncStatusPublisher().publishSyncStatus(this.get_SyncStatusWrapper().getCurrentSyncState(e))},e.prototype.UpdateToSyncingState=function(e){var t=this.get_SyncStatusWrapper().getCurrentSyncState(e),n=t?t.status:2,i=t?t.resultCode:-1,r=!!t&&t.hasUnsavedChanges;this.offlineHandler.get_isOffline()&&4!==n?this.get_SyncStatusWrapper().updateSyncState(e,4):t&&this.get_SyncStatusWrapper().updateHasUnsavedChanges(e),this.ShouldPublishSyncStatus(e.get_node(),n,i,1)?(this.get_SyncStatusWrapper().updateSyncState(e,1),this.get_SyncStatusPublisher().publishSyncStatus(this.get_SyncStatusWrapper().getCurrentSyncState(e))):this.ShouldPublishUnsavedChanges(e.get_node(),n,r)&&this.get_SyncStatusPublisher().publishSyncStatus(this.get_SyncStatusWrapper().getCurrentSyncState(e))},e.prototype.PublishInitialSyncStatusUpdate=function(){var e=this._workspace.get_activePage();if(e&&e.get_contentReplicator()){var t=this.get_SyncStatusWrapper().convertOperationResultToSyncStatus(e.inboundReplicationStatus);this.get_SyncStatusWrapper().updateSyncState(e.get_contentReplicator(),t,e.inboundReplicationStatus),this.get_SyncStatusPublisher().publishSyncStatus(this.get_SyncStatusWrapper().getCurrentSyncState(e.get_contentReplicator()))}},e.prototype.ShouldPublishSyncStatus=function(e,t,n,i,r){if(void 0===r&&(r=-1),this._workspace.get_activePage()===e&&!this.ShouldHideSyncStatus(e))if(t!==i){if(4===i&&!this.offlineHandler.get_isOfflineMoreThanAMinute())return!1;if(1!==i||3!==t&&4!==t&&!this.offlineHandler.get_isOffline())return!0}else if(3===i&&n!==r&&-1!==r)return!0;return!1},e.prototype.ShouldUpdateSyncSuccessful=function(e){var t=this.get_SyncStatusWrapper().getCurrentSyncState(e),n=t?t.uploadingFileCount:0;return!e.hasChangesToOutbound()&&n<=0},e.prototype.ShouldPublishUnsavedChanges=function(e,t,n){return!(this._workspace.get_activePage()!==e||n||!this.offlineHandler.get_isOfflineMoreThanAMinute()&&3!==t)},e.prototype.ShouldHideSyncStatus=function(e){var t=Ge.w.get_instance().tryResolve(Wb.v);return!e||$s.PageReader.get_instance().isVersionNode(e)||$s.PageReader.get_instance().isConflictPageNode(e)||Ti.App.oneNoteRecycleBinIsEnabled&&!!t&&t.isPageInRecycleBin(e)||this._workspace.get_contentView().get_isFishbowlView()&&(e.inboundReplicationStatus>0||!e.get_isContentPresent())},e.prototype.PropagatedSectionBlockingFailure=function(e,t){if(!$s.PageReader.get_instance().isPageNode(e))return!1;var n=Rm.SectionNavigator.getSection(e);if(n){var i=lb.j.isBlockingSaveFailure(n.get_outboundReplicationStatus()),r=!lb.j.hasWriteAccess(n.get_accessRights());if(i||r){var o=i?n.get_outboundReplicationStatus():7;return this.UpdateAndPublishFailureStatus(e,t,o,"Section Blocking"),!0}}return!1},e.prototype.UpdateAndPublishFailureStatus=function(e,t,n,i){var r=t?t.status:1,o=t?t.resultCode:-1,a=this.offlineHandler.get_isOffline()?4:3;this.get_SyncStatusWrapper().updateSyncState(e.get_contentReplicator(),a,n),this.ShouldPublishSyncStatus(e,r,o,a,n)&&(S.ULS.sendTraceTag(50922012,339,15,"PageSyncStatusHandler: {0} failure: {1}",i,n),this.get_SyncStatusPublisher().publishSyncStatus(this.get_SyncStatusWrapper().getCurrentSyncState(e.get_contentReplicator())))},e}();(0,o.l)(jv,"72d3c3ca$PageSyncStatusHandler",null,[]);var Qv=function(){function e(e){this._workspace=null,this._workspace=e}return e.prototype.registerActions=function(e){e.addAction(nS.u.tryAgainPageSync,ol.d.view,o.i(this,this.RetryPageSync,"RetryPageSync"))},e.prototype.RetryPageSync=function(e,t,n,i,r){var o=this._workspace.get_activePage();return 2===n&&o&&o.get_contentReplicator()?(S.ULS.sendTraceTag(50885588,305,50,"Clicked on Try Again for Page Sync: "+o.get_objectSpaceId().toString()),o.get_contentReplicator().replicateAtMaxSpeed(),Ge.w.get_instance().resolve(jv).updateToIntermediateState(o.get_contentReplicator()),32):1===n?32:2},e}();(0,o.l)(Qv,"781abc79$PageSyncStatusActor",null,[]);var Jv=function(){return function(e,t,n,i){void 0===n&&(n=null),void 0===i&&(i=null),this.syncStatus=null,this.autoShowCallout=!1,this.errorButtonText=null,this.errorButtonSecondaryText=null,this.syncStatus=e,this.autoShowCallout=t,this.errorButtonText=n,this.errorButtonSecondaryText=i}}();(0,o.l)(Jv,"a5b2d9a8$SyncControlStatusModel",null,[]);var Xv=function(){return function(e,t,n,i){void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),this.syncDescription=null,this.lastSyncTime=null,this.linkText=null,this.linkUrl=null,this.lastSyncTime=e,this.syncDescription=t,this.linkText=n,this.linkUrl=i}}();(0,o.l)(Xv,"d8ce92fc$SyncStatusCalloutBody",null,[]);var Yv=function(){return function(e,t){this.commandId=null,this.buttonText=null,this.commandId=e,this.buttonText=t}}();(0,o.l)(Yv,"d37aed9a$SyncStatusCalloutButton",null,[]);var Zv=function(){return function(e,t,n){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),this.title=null,this.body=null,this.actionButton=null,this.title=e,this.body=t,this.actionButton=n}}();(0,o.l)(Zv,"9b547925$SyncStatusCalloutContent",null,[]);var eT,tT=function(){return function(e,t){this.controlStatus=null,this.calloutContent=null,this.controlStatus=e,this.calloutContent=t}}();(0,o.l)(tT,"e34f09af$SyncStatusModel",null,[]),function(e){e[e.InProgress=1]="InProgress",e[e.Success=2]="Success",e[e.Failure=3]="Failure",e[e.Offline=4]="Offline"}(eT||(eT={})),(0,o.h)("88af1703$SyncStatus",eT);var nT=function(){function e(){this._offlineHandler=null,this.lastSyncingPublishedTime=Date.now()}return e.prototype.get_OfflineHandler=function(){return this._offlineHandler||(this._offlineHandler=Ge.w.get_instance().resolve(Uv))},e.prototype.publishSyncStatus=function(e,t){if(void 0===t&&(t=!0),e){var n=(3===e.status||4===e.status)&&t,i=null,r=null,o=null,a=null,l=null,s=null,u=null;switch(e.status){case 1:o=OneNoteIntl.OneNoteStrings.L_SyncInProgressCalloutTitle,this.lastSyncingPublishedTime=Date.now();break;case 2:o=OneNoteIntl.OneNoteStrings.L_SyncSuccessfulCalloutTitle,a=new Xv(OneNoteIntl.OneNoteStrings.L_SyncSuccessfulCalloutContent);break;case 3:i=this.GetSyncStatusTextFromOperationResult(e.resultCode),e.hasUnsavedChanges&&(r=i,i=OneNoteIntl.OneNoteStrings.L_SyncErrorUnsavedChanges);var c=e.lastSuccessfulTime?String.format(OneNoteIntl.OneNoteStrings.L_SyncLastSuccessfulTime,e.lastSuccessfulTime.toLocaleTimeString()):"";(u=this.GetLinkToAddInCalloutDescription(e.resultCode))&&(s=OneNoteIntl.OneNoteStrings.L_SyncErrorLearnMore),a=new Xv(c,this.GetSyncStatusDescriptionFromSyncStatus(e),s,u),l=this.GetFailureActionCalloutButton(e.resultCode);break;case 4:return void this.publishOfflineStatus(e,this.get_OfflineHandler().get_isOfflineMoreThanAMinute(),n)}var d=new Zv(o,a,l),g=new Jv(eT[e.status],n,i,r),p=new tT(g,d);this.publishSyncStatusModelToSLR(p,1!==e.status)}},e.prototype.publishOfflineStatus=function(e,t,n){void 0===n&&(n=!0),e||(e=new Kv(4,-1,null));var i=t?3:1,r=e.lastSuccessfulTime?String.format(OneNoteIntl.OneNoteStrings.L_SyncLastSuccessfulTime,e.lastSuccessfulTime.toLocaleTimeString()):"",o=null,a=null,l=null,s=null;t?(o=e.hasUnsavedChanges?OneNoteIntl.OneNoteStrings.L_SyncOfflineUnsavedChangesCalloutContent:OneNoteIntl.OneNoteStrings.L_SyncOfflineAfterMinCalloutContent,a=new Yv(nS.u.getNameFromId(nS.u.tryAgainPageSync),OneNoteIntl.OneNoteStrings.L_SyncTryAgain),e.hasUnsavedChanges?(s=OneNoteIntl.OneNoteStrings.L_SyncOfflineButtonText,l=OneNoteIntl.OneNoteStrings.L_SyncErrorUnsavedChanges,S.ULS.sendTraceTag(50922015,339,15,"PageSyncStatusPublisher: Publishing Offline status with unsaved changes")):l=OneNoteIntl.OneNoteStrings.L_SyncOfflineButtonText):(o=OneNoteIntl.OneNoteStrings.L_SyncOfflineWithInMinCalloutContent,this.lastSyncingPublishedTime=Date.now());var u=new Zv(null,new Xv(r,o),a),c=new Jv(eT[i],n,l,s),d=new tT(c,u);this.publishSyncStatusModelToSLR(d,t)},e.prototype.hideSyncStatus=function(){appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("SyncStatus",!0))},e.prototype.publishSyncStatusModelToSLR=function(t,n){void 0===n&&(n=!1),this.ShowSyncStatus();var i=Date.now()-this.lastSyncingPublishedTime;n&&i<e.MinSpinTimeMs?window.setTimeout((function(){appChrome.api.dispatch(appChrome.actions.updateSyncStatus(t))}),e.MinSpinTimeMs-i):appChrome.api.dispatch(appChrome.actions.updateSyncStatus(t))},e.prototype.ShowSyncStatus=function(){appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("SyncStatus",!1))},e.prototype.GetSyncStatusTextFromOperationResult=function(e){switch(e){case 7:return OneNoteIntl.OneNoteStrings.L_SyncErrorPermissionsButtonText;case 22:return OneNoteIntl.OneNoteStrings.L_SyncErrorOutOfStorageButtonText;default:return OneNoteIntl.OneNoteStrings.L_SyncErrorInternalButtonText}},e.prototype.GetSyncStatusDescriptionFromSyncStatus=function(e){switch(e.resultCode){case 7:return String.format(e.hasReadAccess?OneNoteIntl.OneNoteStrings.L_SyncErrorPermissionsReadOnlyCalloutContent:OneNoteIntl.OneNoteStrings.L_SyncErrorPermissionsCalloutContent,L.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName"));case 22:return OneNoteIntl.OneNoteStrings.L_SyncErrorOutOfStorageCalloutContent;default:return e.hasUnsavedChanges?OneNoteIntl.OneNoteStrings.L_SyncErrorUnsavedChangesCalloutContent:OneNoteIntl.OneNoteStrings.L_SyncErrorInternalCalloutContent}},e.prototype.GetLinkToAddInCalloutDescription=function(t){switch(t){case 22:return e.OutOfStorageLearnMoreLink;default:return null}},e.prototype.GetFailureActionCalloutButton=function(e){return 22===e||7===e?null:new Yv(nS.u.getNameFromId(nS.u.tryAgainPageSync),OneNoteIntl.OneNoteStrings.L_SyncTryAgain)},e.OutOfStorageLearnMoreLink="https://support.office.com/article/ec43ed03-eb3c-4a10-8d9d-e9e5433c9ed2",e.MinSpinTimeMs=500,e}();(0,o.l)(nT,"eb5643bc$PageSyncStatusPublisher",null,[Wv]);var iT=function(){function e(){}return e.prototype.getCurrentSyncState=function(e){return e?e.get_node().currentSyncState:null},e.prototype.updateSyncStatusFromOffline=function(e){if(e&&e.get_node().currentSyncState&&4===e.get_node().currentSyncState.status){var t=e.get_node().inboundReplicationStatus;e.get_node().currentSyncState.hasUnsavedChanges&&(t=e.get_node().get_outboundReplicationStatus()?e.get_node().get_outboundReplicationStatus():-1);var n=this.convertOperationResultToSyncStatus(t);this.updateSyncState(e,n,t)}},e.prototype.updateCurrentUploadingFileCount=function(e,t){e&&e.get_node().currentSyncState?e.get_node().currentSyncState.uploadingFileCount=t:S.ULS.sendTraceTag(42342225,305,15,"Couldn't update File upload count as the current sync state is not initialized")},e.prototype.updateHasUnsavedChanges=function(e){e&&e.get_node().currentSyncState?e.get_node().currentSyncState.hasUnsavedChanges=e.hasChangesToOutbound():S.ULS.sendTraceTag(42796877,305,15,"Couldn't update HasUnsavedChanges as the current sync state is not initialized")},e.prototype.updateSyncState=function(e,t,n,i){if(void 0===n&&(n=-1),void 0===i&&(i=-1),e){if(e.get_node().currentSyncState?(e.get_node().currentSyncState.status=t,e.get_node().currentSyncState.resultCode=n):e.get_node().currentSyncState=new Kv(t,n,null),-1!==i&&(e.get_node().currentSyncState.uploadingFileCount=i),2===t)e.get_node().currentSyncState.lastSuccessfulTime=new Date(Date.now());else if(3===t&&7===n){var r=Rm.SectionNavigator.getSection(e.get_node());e.get_node().currentSyncState.hasReadAccess=!!r&&2===r.get_accessRights()}this.updateHasUnsavedChanges(e)}},e.prototype.convertOperationResultToSyncStatus=function(e){switch(e){case-1:return 1;case 0:return 2;default:return 3}},e}();(0,o.l)(iT,"a3598b52$SyncStatusWrapper",null,[Gv]);var rT=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"OneNote.SyncStatus"},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register(Uv).singleInstance().usingFactory((function(){return new zv(t._container.resolve(Hv.q),L.AFrameworkApplication.get_activeFrame().workspace)})),this._container.register(Gv).singleInstance().usingFactory((function(){return new iT})),this._container.register(Wv).singleInstance().usingFactory((function(){return new nT})),this._container.register(jv).singleInstance().usingFactory((function(){return new jv(Vv.y.get_instance(),op.q.get_instance(),L.AFrameworkApplication.get_activeFrame().workspace)})),this._container.register(Qv).singleInstance().usingFactory((function(){return new Qv(L.AFrameworkApplication.get_activeFrame().workspace)}))},e.prototype.init=function(){var e=this;Ti.App.get_instance().get_isSyncUxFeatureEnabled()&&(ar.r.get_instance().executeWhen(7,(function(){e._container.resolve(jv)})),this._container.resolve(Qv).registerActions(L.AFrameworkApplication.get_theActionManager()))},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(rT,"2832516f$OneNoteSyncStatusPackage",null,[s.u,u.s]);var oT=(0,o.y)("698e7397$IAudioFileUploader"),aT=n(5973),lT=n(8873),sT=n(398),uT=n(8507),cT=n(8279),dT=n(9976),gT=n(2645),pT=function(e){function t(t,n,i,r){var o=this;return o._desiredRevisionId=null,o._node=null,o._uploadParameters=null,o._insertFileEditor=null,o._undoManager=null,o.$$pf_UploadState=0,(o=e.call(this,null,n,i)||this).useFilePicker=!1,o._insertFileEditor=t,o._undoManager=r,o}return(0,v.t)(t,e),t.prototype.get_uploadState=function(){return this.$$pf_UploadState},t.prototype.set_uploadState=function(e){return this.$$pf_UploadState=e,e},t.prototype.get_Filename=function(){return this.get_appSettingsManager().get_appSettings()[t.FileNameSettingName]},t.prototype.get_placeholder=function(){return this._node},t.prototype.createPlaceholder=function(e){this.set_uploadState(1),this.set_context(e),S.ULS.sendTraceTag(9177241,339,50,"InsertAudio:Start"),this.uploadFrame=new gT.w(document.body,o.i(this,this.onUploadFrameInitialized,"onUploadFrameInitialized"),o.i(this,this.uploadResponseReceived,"uploadResponseReceived"),this.get_appSettingsManager(),!1,null)},t.prototype.finalizeUpload=function(e,t){this._desiredRevisionId=ai.l.create(),this._node=this._insertFileEditor.insertPlaceholders(this.get_context(),null,this._desiredRevisionId,this.get_Filename()).fileNode,this._node?this.replicatePlaceholder(e):this.reset()},t.prototype.OnPlaceholderNodeSaved=function(e){if(uT.i.isPlaceholderValid(this._node)){S.ULS.sendTraceTag(9213712,339,50,"InsertAudio:PlaceholderSaved"),this._uploadParameters={};var t=ha.g.createFromNode(this._node);t.tryToRootAtPageContent(),t.returnToAncestorOfType(8);var n=t.get_currentINode().get_id().toString();this._uploadParameters[dp.h.isImage]="0",this._uploadParameters[dp.h.pageId]=n,uT.i.populateUploadFrame(this.uploadFrame,this._node,this._desiredRevisionId,this._uploadParameters)?(S.ULS.sendTraceTag(9177244,339,50,"InsertAudio:UploadSetup"),this.set_uploadState(2)):this.reset()}else this.reset()},t.prototype.upload=function(e){S.ULS.sendTraceTag(9213713,339,50,"InsertAudio:UploadStart"),this.set_uploadState(3);var t=this.get_appSettingsManager().getIntAppSetting("OneNoteInsertFileMaxSize",0),n=e.size,i=n/1024;if(S.ULS.sendTraceTag(9213714,339,50,"InsertAudio:Size:{0}",n),i>t)return cT.h.showRecordingFailedUploadError(),S.ULS.sendTraceTag(9177246,339,50,"InsertAudio:FileTooBig"),void this.reset();var r=new sT.w(this.get_Filename(),e);this.uploadFrame.submitFormWithBlob(r),this._node?op.q.get_instance().uploadStarted(this._node.getParentGraphSpace()):S.ULS.sendTraceTag(42468441,339,15,"Upload Started with Node null")},t.prototype.validateFilename=function(e,t){return!0},t.prototype.uploadResponseReceived=function(e){var t=this,n=e;if(S.ULS.sendTraceTag(9177247,339,50,"InsertAudio:UploadResult:{0}",n.StatusCode),uT.i.isPlaceholderValid(this._node))if(n&&!n.StatusCode){if(!this._node.getGraphSpace()||!this._node.getGraphSpace().get_contentReplicator())return S.ULS.shipAssertTag(9177248,339,!1),void this.ProcessFailure(null,14);this._node.getGraphSpace().get_contentReplicator().postProcessFDOUpload((function(e){t.reset()}),(function(e,n){t.reset()}),null),op.q.get_instance().uploadCompleted(this._node.getParentGraphSpace(),0)}else{var i=n?n.StatusCode:14;this.ProcessFailure(null,i)}else this.reset()},t.prototype.replicatePlaceholder=function(e){this._node.getParentGraphSpace().get_contentReplicator().forceOutbound(o.i(this,this.OnPlaceholderNodeSaved,"OnPlaceholderNodeSaved"),o.i(this,this.ProcessFailure,"ProcessFailure"),e)},t.prototype.ProcessFailure=function(e,t){this.retryReplication(e)?S.ULS.sendTraceTag(16798872,339,50,"InsertAudio:OutboundRetry:Retry={0}:Error={1}",this.get_retryCount(),t.toLocaleString()):(S.ULS.sendTraceTag(9213715,339,10,"InsertAudio:Failure:Retries={0}:Error={1}",this.get_retryCount(),t.toLocaleString()),this._node&&this._node.getGraphSpace()&&(dT.r.setUploading(this._node,!1),this._undoManager.clearUndoHistory(this._node.getGraphSpace(),!1),op.q.get_instance().uploadCompleted(this._node.getParentGraphSpace(),t)),this.reset())},t.prototype.reset=function(){this._node&&dT.r.setUploading(this._node,!1),this._desiredRevisionId=null,this._node=null,this._uploadParameters=null,this.resetRetries(),this.set_uploadState(0),S.ULS.sendTraceTag(9213716,339,50,"InsertAudio:UploadReset")},t.FileNameSettingName="OneNoteAudioRecordingFilename",t.LogCategory="OneNoteInsertFile",t}(lT.p);(0,o.l)(pT,"cf7fcc1e$AudioFileUploader",lT.p,[oT]);var hT=n(4579),_T=n(2918),mT=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,v.t)(t,e),t.prototype.createPlaceholders=function(e,t){if(!this.canInsertFileInContext(e))return null;var n=new _T.b,i=e,r=new Ma.GraphTransaction(7);r.setFromNode(i.get_node());var o=this.createIteratorAtNodeOfInsertion(e);return n.imageContainingOutlineNode=o.get_parentNode(),n.fileNode=this.insertFileBlock(o,t),this.createSiblingOutlineElement(o),n.imageContainingOutlineElementNode=o.get_currentNode(),n.imageNode=this.insertImageBlock(o),r.dispose(),n},t.prototype.nodeToPlaceSelectionAfter=function(e){return e.imageNode},t}(dT.r);(0,o.l)(mT,"3b953f53$InsertPrintoutEditor",dT.r,[]);var fT=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.EmbeddedFiles"},e.prototype.configure=function(e){e.register(hT.c).singleInstance().usingFactory((function(){return new hT.c})),e.register(dT.r).singleInstance().usingFactory((function(){return new dT.r(e.resolve(zl.a),e.resolve(ql.p))})),e.register(mT).singleInstance().usingFactory((function(){return new mT(e.resolve(zl.a),e.resolve(ql.p))})),e.register(oT).singleInstance().usingFactory((function(){return new pT(e.resolve(dT.r),Ce.y.get_instance(),L.AFrameworkApplication.appSettingsManager,e.resolve(wa.n))})),e.register(cT.h).singleInstance().usingFactory((function(){return new cT.h(e.resolve(oT))})),yi.App.theNotebookManager.get_theGraph().getSpecificEventHandlers(32).add_onDisconnected(aT.s.fileDisconnected)},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInsertFileIsEnabled")&&B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(fT,"b3d5abaf$OneNoteEmbeddedFilesPackage",null,[s.u,u.s]);var yT=n(6475),CT=function(){function e(){}return e.UintToColorName=function(e){return""},e.AsEnumerable=function(e,t){for(var n=new C.c(e),i=0;i<t.get_count();i++)n.add(t.get_item(i));return n},e.muToPixel=function(t){return Vu.r.muToInches(t)*e.DefaultPixelsPerInch},e.GetDefaultMargin=function(e){return e.containsKey("font-size")?kp.getSizeInPoints(e.get_item("font-size")):Cc.Font.get_defaultSize()/2},e.MuToPoints=function(e){return Vu.r.muToPoints(e)},e.DefaultPixelsPerInch=96,e}();(0,o.l)(CT,"9fff64c4$HtmlUtils",null,[]);var ST=function(){function e(){}return e.isNullOrEmpty=function(e){return!e||""===e},e.stringJoin=function(e,t){if(!t)return"";e||(e="");for(var n=new Sys.StringBuilder,i=0;i<t.length;i++)n.append(t[i].toString()),i<t.length-1&&n.append(e);return n.toString()},e.contains=function(e,t){for(var n=0;n<t.length;n++){if(t[n]===e)return!0}return!1},e.htmlAttributeEncode=function(e){return Rn.l.htmlAttributeEncode(e)},e.htmlEncode=function(e){return Rn.l.htmlEncode(e)},e}();(0,o.l)(ST,"6cbf3b86$PageHtmlRecallStringUtilities",null,[]);var bT=(0,o.y)("17a800a9$IHtmlViewElement"),vT=(0,o.y)("f96cbdd4$IViewElement"),TT=function(){return function(){this.x=0,this.y=0,this.width=0,this.height=0}}();(0,o.l)(TT,"81eea72f$Bounds",null,[]);var AT=function(){return function(){this.x=0,this.y=0}}();(0,o.l)(AT,"21a5930f$ViewPoint",null,[]);var IT=function(){return function(){}}();(0,o.l)(IT,"b5056050$ViewSizeConstraints",null,[]);var wT=function(){function e(e,t){this._htmlView=null,this._graphNode=null,this.$$pf_HtmlElement=null,e&&t&&(this._htmlView=e,this._graphNode=t)}return e.prototype.AddCommonAttributes=function(){if(this._graphNode.hasProperty(is.b.offsetFromParentHoriz)){this.get_htmlElement().get_styles().set_item("position","absolute");var e=this._graphNode.getValue(Number,is.b.offsetFromParentHoriz);e>=0&&(e=0),this.get_htmlElement().get_styles().set_item("left",CT.muToPixel(e)+"px")}if(this._graphNode.hasProperty(is.b.offsetFromParentVert)){this.get_htmlElement().get_styles().set_item("position","absolute");var t=this._graphNode.getValue(Number,is.b.offsetFromParentVert);t>=0&&(t=0),this.get_htmlElement().get_styles().set_item("top",CT.muToPixel(t)+"px")}},e.prototype.AddToHtmlDocument=function(e){e.AddChild(this.get_htmlElement())},e.prototype.get_includeIds=function(){return this._htmlView.get_includeIds()},e.prototype.addId=function(t,n){if(t&&n){for(var i=0,r=e.NoIdTags;i<r.length;i++){if(r[i]===t.tagName)return}if(this.get_includeIds()){if(!n.get_id()||!t.tagName)return S.ULS.shipAssertTag(20248345,339,!!n.get_id(),"Node have a null id."),void S.ULS.shipAssertTag(20248346,339,!ST.isNullOrEmpty(t.tagName),"Tag is not set in the element.");t.get_attributes().set_item(e.HtmlGeneratedId,String.format("{0}:{1}",t.tagName,n.get_id()))}}},e.prototype.GetContainingList=function(e,t,n){if(!e||!e.get_currentNode())return null;if(!this._htmlView.get_listContainers().containsKey(e.get_currentNode().get_id().toString())){var i=this._htmlView.createElement(t.get_isOrdered()?"ol":"ul");this.addId(i,e.get_currentINode()),this._htmlView.get_listContainers().add(e.get_currentNode().get_id().toString(),i);var r=new ha.g;r.setFrom(e);var o=r.returnToParent(),a=void 0;o&&this._htmlView.get_listContainers().containsKey(o.get_id().toString())?(a=this._htmlView.get_listContainers().get_item(o.get_id().toString())).get_children().get_count()&&"li"===a.get_children().get_item(a.get_children().get_count()-1).tagName&&(a=a.get_children().get_item(a.get_children().get_count()-1)):a=n,a.AddChild(i)}return this._htmlView.get_listContainers().get_item(e.get_currentNode().get_id().toString())},e.prototype.get_isHtmlViewElement=function(){return!0},e.prototype.get_sourceNode=function(){return this._graphNode},e.prototype.get_viewInstance=function(){return this._htmlView},e.prototype.get_viewId=function(){return this.get_viewInstance().get_viewId()},e.prototype.onConnect=function(){},e.prototype.onDisconnect=function(){},e.prototype.get_htmlElement=function(){return this.$$pf_HtmlElement},e.prototype.set_htmlElement=function(e){return this.$$pf_HtmlElement=e,e},e.prototype.get_htmlViewInstance=function(){return this._htmlView},e.prototype.get_isStructural=function(){return!1},e.prototype.get_bounds=function(){return new TT},e.prototype.locate=function(){return new AT},e.prototype.get_sizeConstraints=function(){return new IT},e.prototype.get_usesSizeCalculations=function(){return!1},e.prototype.get_isMeasuredElement=function(){return!1},e.enUsCultureLcid=1033,e.HtmlGeneratedId="id",e.NoIdTags=["span","sub","sup","a","br"],e}();(0,o.l)(wT,"ee4830e8$ViewElementBase",null,[bT,vT]);var xT=function(){function e(){}return e.DefaultLanguageFontAndLocalesInitialize=function(){var e=new aa.e(String,String);return e.set_item("Unicode","Arial Unicode MS"),e.set_item("ar-DZ","Arial"),e.set_item("ar-BH","Arial"),e.set_item("ar-EG","Arial"),e.set_item("ar-IQ","Arial"),e.set_item("ar-JO","Arial"),e.set_item("ar-KW","Arial"),e.set_item("ar-LB","Arial"),e.set_item("ar-LY","Arial"),e.set_item("ar-MA","Arial"),e.set_item("ar-OM","Arial"),e.set_item("ar-QA","Arial"),e.set_item("ar-SA","Arial"),e.set_item("ar-SY","Arial"),e.set_item("ar-TN","Arial"),e.set_item("ar-AE","Arial"),e.set_item("ar-YE","Arial"),e.set_item("he-IL","Arial"),e.set_item("vi-VN","Verdana"),e.set_item("th-TH","Thai"),e.set_item("ja-JP","Yu Gothic"),e.set_item("zh-CN","Microsoft YaHei"),e.set_item("zh-SG","Microsoft YaHei"),e.set_item("ko-KR","Malgun Gothic"),e.set_item("zh-HK","PMingLiU"),e.set_item("zh-MO","PMingLiU"),e.set_item("zh-TW","PMingLiU"),e.set_item("hy-AM","Sylfaen"),e.set_item("ka-GE","Sylfaen"),e.set_item("syr-SY","Estrangelo Edessa"),e.set_item("dv-MV","MV Boli"),e.set_item("hi-IN","Mangal"),e.set_item("mr-IN","Mangal"),e.set_item("bn-BD","Vrinda"),e.set_item("bn-IN","Vrinda"),e.set_item("pa-IN","Raavi"),e.set_item("gu-IN","Shruthi"),e.set_item("or-IN","Kalinga"),e.set_item("ta-IN","Latha"),e.set_item("te-IN","Gautami"),e.set_item("kn-IN","Tunga"),e.set_item("ml-IN","Kartika"),e.set_item("lo-LA","DokChampa"),e.set_item("en-US",Cc.Font.get_defaultFontName()),e},e.get_DefaultLanguageFontAndLocales=function(){return e.DefaultLanguageFontAndLocalesLazy.get_value()},e.ModifyElementForAdditionalHtmlOptimizations=function(t){"body"===t.tagName?e.BodyHtmlOptimizations(t):"p"!==t.tagName||!t.get_parent()||"li"!==t.get_parent().tagName&&"td"!==t.get_parent().tagName||1!==t.get_parent().get_children().get_count()?"li"!==t.tagName&&"td"!==t.tagName||1!==t.get_children().get_count()||"p"!==t.get_children().get_item(0).tagName||e.TdAndLiHtmlOptimizations(t):(t.tagName="span",t.get_attributes().remove(wT.HtmlGeneratedId))},e.BodyHtmlOptimizations=function(t){var n=e.get_DefaultLanguageFontAndLocales().get_item("en-US");t.get_styles().set_item("font-family",n),t.get_styles().set_item("font-size",Cc.Font.get_defaultSize()/2+"pt");var i=t.get_parent();if(i&&"html"===i.tagName){var r=i.get_attributes().get_item("lang");if(r&&e.get_DefaultLanguageFontAndLocales().containsKey(r)){var o=e.get_DefaultLanguageFontAndLocales().get_item(r);t.get_styles().set_item("font-family",o),S.ULS.sendTraceTag(20248388,339,50,"Set default body font {0} for locale: {1}",o,r)}else S.ULS.sendTraceTag(20248390,339,50,"Setting fallback body font {0} for locale: {1}",n,r)}},e.TdAndLiHtmlOptimizations=function(e){var t=e.get_children().get_item(0),n=CT.GetDefaultMargin(t.get_styles());t.get_styles().containsKey("margin-top")?"0pt"===t.get_styles().get_item("margin-top")&&t.get_styles().remove("margin-top"):t.get_styles().set_item("margin-top",String.format("{0}pt",n)),t.get_styles().containsKey("margin-bottom")?"0pt"===t.get_styles().get_item("margin-bottom")&&t.get_styles().remove("margin-bottom"):t.get_styles().set_item("margin-bottom",String.format("{0}pt",n));for(var i=0,r=t.get_styles().get_keys().toArray();i<r.length;i++){var o=r[i],a=t.get_styles().get_item(o);e.get_styles().set_item(o,a)}},e.GetEffectiveAttributes=function(t,n){for(var i=new aa.e(String,String),r=function(r){var o,a=n.get_item(r);e.IsAttributeInheritable(r)&&!t.tryGetValue(r,(0,g.m)((function(){return o}),(function(e){return o=e})))&&i.add(r,a)},o=0,a=n.get_keys().toArray();o<a.length;o++){r(a[o])}for(var l=0,s=t.get_keys().toArray();l<s.length;l++){var u=s[l],c=t.get_item(u);i.add(u,c)}return i},e.GetPrintableAttributes=function(t,n){for(var i=new aa.e(String,String),r=function(r){var o,a=t.get_item(r);e.IsAttributeInheritable(r)&&n.tryGetValue(r,(0,g.m)((function(){return o}),(function(e){return o=e})))&&o===a||i.add(r,a)},o=0,a=t.get_keys().toArray();o<a.length;o++){r(a[o])}return i},e.IsAttributeInheritable=function(e){return"lang"===e},e.GetEffectiveStyles=function(t,n){for(var i=new aa.e(String,String),r=function(r){var o,a=n.get_item(r);e.IsStyleInheritable(r)&&!t.tryGetValue(r,(0,g.m)((function(){return o}),(function(e){return o=e})))&&i.add(r,a)},o=0,a=n.get_keys().toArray();o<a.length;o++){r(a[o])}for(var l=0,s=t.get_keys().toArray();l<s.length;l++){var u=s[l],c=t.get_item(u);i.add(u,c)}return i},e.GetPrintableStyles=function(t,n){for(var i=new aa.e(String,String),r=function(r){var o,a=t.get_item(r);e.IsAttributeInheritable(r)&&n.tryGetValue(r,(0,g.m)((function(){return o}),(function(e){return o=e})))&&o===a||i.add(r,a)},o=0,a=t.get_keys().toArray();o<a.length;o++){r(a[o])}return i},e.RemoveRedundantTextAlign=function(e,t){},e.IsStyleInheritable=function(e){switch(e){case"list-style-type":case"border":return!1;default:return!0}},e.SetDivId=function(t){var n=null,i=null;e.FindFirstAndLastIds(t,(0,g.m)((function(){return n}),(function(e){return n=e})),(0,g.m)((function(){return i}),(function(e){return i=e}))),n&&i&&t.get_attributes().set_item(wT.HtmlGeneratedId,String.format("{0}:{1}:{2}",t.tagName,n,i))},e.FindFirstAndLastIds=function(t,n,i){for(var r=t.get_children().$$lge();r.$$mn();){var o=r.$$cu();"div"!==Rn.l.toLower(o.tagName)&&o.get_attributes().containsKey(wT.HtmlGeneratedId)&&(n.val?i.val=e.GetNodeIdFromId(o.get_attributes().get_item(wT.HtmlGeneratedId)):n.val=i.val=e.GetNodeIdFromId(o.get_attributes().get_item(wT.HtmlGeneratedId))),e.FindFirstAndLastIds(o,n,i)}},e.GetNodeIdFromId=function(e){if(ST.isNullOrEmpty(e))return null;var t=e.indexOf(":");return t>=0&&e.length>t+1?e.substr(t+1):null},e.DefaultLanguageFontAndLocalesLazy=new nt.q(aa.e.$$(String,String),e.DefaultLanguageFontAndLocalesInitialize),e}();(0,o.l)(xT,"7f648478$HtmlOptimizer",null,[]);var ET,FT=n(8484);!function(e){e[e.indentAtStartAndNewLineAtEnd=0]="indentAtStartAndNewLineAtEnd",e[e.indentAndNewlineAtStartAndEnd=1]="indentAndNewlineAtStartAndEnd",e[e.noIndentNoNewlineAtStartAndEnd=2]="noIndentNoNewlineAtStartAndEnd"}(ET||(ET={})),(0,o.h)("4ade7c65$HtmlTagIndentType",ET);var PT=function(){function e(){}return e.HtmlTagIndentTypesInitialize=function(){var e=new FT.d(String,ET,J.b.get_ordinalIgnoreCase());return e.set_item("html",1),e.set_item("head",1),e.set_item("body",1),e.set_item("div",1),e.set_item("table",1),e.set_item("tr",1),e.set_item("ul",1),e.set_item("ol",1),e.set_item("a",2),e.set_item("sup",2),e.set_item("sub",2),e.set_item("span",2),e.set_item("td",0),e.set_item("li",0),e.set_item("p",0),e.set_item("img",0),e.set_item("iframe",0),e.set_item("title",0),e.set_item("meta",0),e.set_item("script",0),e.set_item("object",0),e.set_item("cite",0),e.set_item("h1",0),e.set_item("h2",0),e.set_item("h3",0),e.set_item("h4",0),e.set_item("h5",0),e.set_item("h6",0),e.set_item("br",0),e.set_item("math",1),e.set_item("maction",1),e.set_item("maligngroup",1),e.set_item("malignmark",1),e.set_item("menclose",1),e.set_item("merror",1),e.set_item("mfenced",1),e.set_item("mfrac",1),e.set_item("mglyph",1),e.set_item("mi",0),e.set_item("mlabeledtr",1),e.set_item("mlongdiv",1),e.set_item("mmultiscripts",1),e.set_item("mn",0),e.set_item("mo",0),e.set_item("mover",1),e.set_item("mpadded",1),e.set_item("mphantom",1),e.set_item("mroot",1),e.set_item("mrow",1),e.set_item("ms",0),e.set_item("mscarries",1),e.set_item("mscarry",1),e.set_item("msgroup",1),e.set_item("msline",1),e.set_item("mspace",0),e.set_item("msqrt",1),e.set_item("msrow",1),e.set_item("mstack",1),e.set_item("mstyle",1),e.set_item("msub",1),e.set_item("msup",1),e.set_item("msubsup",1),e.set_item("mtable",1),e.set_item("mtd",1),e.set_item("mtext",0),e.set_item("mtr",1),e.set_item("munder",1),e.set_item("munderover",1),e},e.get_HtmlTagIndentTypes=function(){return e.HtmlTagIndentTypesLazy.get_value()},e.getStartTagIndent=function(t,n,i){if(!t)return null;e.validateTagIndentType(t);var r=new Sys.StringBuilder("");if(!(!!t.get_parent()&&1===e.get_HtmlTagIndentTypes().get_item(t.get_parent().tagName)||e._prevElementTerminatedInNewLine||2!==e.get_HtmlTagIndentTypes().get_item(t.tagName)&&e.get_HtmlTagIndentTypes().get_item(t.tagName)))return"";if(!e._prevElementTerminatedInNewLine&&2===e.get_HtmlTagIndentTypes().get_item(t.tagName))return"";t.indent=n;for(var o=0;o<n;o++)r.append("\t");return!i||!e._prevElementTerminatedInNewLine||1!==e.get_HtmlTagIndentTypes().get_item(t.tagName)&&e.get_HtmlTagIndentTypes().get_item(t.tagName)||(t.indent=t.indent+1,r.append("\t")),r.toString()},e.getEndTagIndent=function(t){if(!t)return null;if(e.validateTagIndentType(t),!ST.isNullOrEmpty(t.value))return"";var n=new Sys.StringBuilder("");if(e._prevElementTerminatedInNewLine||1===e.get_HtmlTagIndentTypes().get_item(t.tagName)){for(var i=0;i<t.indent;i++)n.append("\t");return n.toString()}return""},e.getStartTagNewLine=function(t,n,i){if(!n)return null;if(e.validateTagIndentType(n),i&&1===e.get_HtmlTagIndentTypes().get_item(n.tagName))return e._prevElementTerminatedInNewLine=!0,"\n";if(i)return"";var r=t?2===e.get_HtmlTagIndentTypes().get_item(n.tagName)?"":"\n":1===e.get_HtmlTagIndentTypes().get_item(n.tagName)?"\n":"";return e._prevElementTerminatedInNewLine=!ST.isNullOrEmpty(r),r},e.getEndTagNewLine=function(t){if(!t)return null;e.validateTagIndentType(t);var n="";return 1===e.get_HtmlTagIndentTypes().get_item(t.tagName)?n="\n":2===e.get_HtmlTagIndentTypes().get_item(t.tagName)?n="":e.get_HtmlTagIndentTypes().get_item(t.tagName)||(n="\n"),e._prevElementTerminatedInNewLine=!ST.isNullOrEmpty(n),n},e.areChildrenInline=function(t,n){return!!t&&(e.validateTagIndentType(t),!!n||2===e.get_HtmlTagIndentTypes().get_item(t.tagName))},e.getChildIndent=function(t,n,i){return t?(e.validateTagIndentType(t),n?i:1===e.get_HtmlTagIndentTypes().get_item(t.tagName)?++i:i):0},e.validateTagIndentType=function(t){if(t)if(e.get_HtmlTagIndentTypes().containsKey(t.tagName));else String.format("Tag Indent Type not defined for tag {0}.",t.tagName)},e._prevElementTerminatedInNewLine=!1,e.HtmlTagIndentTypesLazy=new nt.q(FT.d.$$(String,ET),e.HtmlTagIndentTypesInitialize),e}();(0,o.l)(PT,"751835ac$HtmlOutputFormatter",null,[]);var DT=function(){function e(){}return e.toHtml=function(t,n){if(void 0===n&&(n=!1),!t)return null;var i=new Sys.StringBuilder;return e.WriteDomElementToStringSimplified(t.documentElement,i,n),i.toString()},e.WriteDomElementToStringSimplified=function(t,n,i){void 0===i&&(i=!1),e.WriteDomElementToString(t,n,i,new aa.e(String,String),new aa.e(String,String),0)},e.PrintableAttributeFunc=function(e,t){return"src"===e||"data-fullres-src"===e||"data"===e?String.format('{0}="{1}"',e,t):String.format('{0}="{1}"',e,ST.htmlAttributeEncode(t))},e.WriteDomElementToString=function(t,n,i,r,o,a,l){void 0===l&&(l=!1),xT.ModifyElementForAdditionalHtmlOptimizations(t),i&&"div"===Rn.l.toLower(t.tagName)&&!t.get_attributes().containsKey(wT.HtmlGeneratedId)&&xT.SetDivId(t);for(var s=xT.GetEffectiveAttributes(t.get_attributes(),r),u=xT.GetPrintableAttributes(t.get_attributes(),r),c=new C.c(String),d=0,g=u.get_keys().toArray();d<g.length;d++){var p=g[d],h=u.get_item(p),_=e.PrintableAttributeFunc(p,h);c.add(_)}xT.RemoveRedundantTextAlign(t,s);for(var m=xT.GetEffectiveStyles(t.get_styles(),o),f=xT.GetPrintableStyles(t.get_styles(),o),y=new C.c(String),S=0,b=f.get_keys().toArray();S<b.length;S++){var v=b[S],T=f.get_item(v);y.add(v+":"+T)}var A=t.get_hasSemanticValue()||c.get_count()>0||y.get_count()>0,I=t.canSelfEnd&&(!t.value||""===t.value)&&!t.get_children().get_count(),w=String.format("<{0}{1}{2}{3}>",t.tagName,c.get_count()>0?" "+ST.stringJoin(" ",c.toArray()):"",y.get_count()>0?" "+String.format('style="{0}"',ST.htmlAttributeEncode(ST.stringJoin(";",y.toArray()))):"",I?" /":""),x=String.format("</{0}>",t.tagName);A&&n.append(PT.getStartTagIndent(t,a,l)+w+PT.getStartTagNewLine(I,t,l)),n.append(ST.htmlEncode(t.value));for(var E=t.get_children().$$lge();E.$$mn();){var F=E.$$cu(),P=a;A&&(P=PT.getChildIndent(t,l,a)),F.get_isComment()?e.WriteCommentToString(F,n,P):e.WriteDomElementToString(F,n,i,s,m,P,PT.areChildrenInline(F,l))}!A||I||t.get_isComment()||n.append(PT.getEndTagIndent(t)+x+PT.getEndTagNewLine(t))},e.WriteCommentToString=function(e,t,n){if(e.get_isComment()){for(var i=0;i<n;i++)t.append("\t");var r=String.format("\x3c!-- {0} --\x3e\n",ST.htmlEncode(e.comment));t.append(r)}},e}();(0,o.l)(DT,"d692f6ed$DomDocumentExtensions",null,[]);var RT=(0,o.y)("14572852$ISplitImage"),MT=(0,o.y)("dddb27be$IPrintoutFile"),kT=(0,o.y)("cff53557$IHtmlView"),NT=(0,o.y)("b19c7e2a$IView"),LT=function(){function e(){}return e.lcidToCultureName=function(e){var t=Ft.i.getCultureInfo(e);return t?t.get_name():null},e}();(0,o.l)(LT,"c592e655$CultureUtils",null,[]);var BT=(0,o.y)("362f608$IViewElementCreator"),OT=function(e){function t(t,n){var i=e.call(this,t,n.get_currentINode())||this;return i.set_htmlElement(i._htmlView.createElement("object")),393269!==i._graphNode.get_runtimeClassId()?(S.ULS.sendTraceTag(20248353,339,10,"Expects EmbeddedFileNode. Actual input node type was {0}",Object.getType(i._graphNode).toString()),i):(i.AddCommonAttributes(),i)}return(0,v.t)(t,e),t}(wT);(0,o.l)(OT,"4730a395$EmbeddedFileViewElement",wT,[]);var UT=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r.set_htmlElement(r._htmlView.createCommentElement(i)),S.ULS.sendTraceTag(20248386,339,15,"PCR Skipped NodeType={0}",n.get_type()),r}return(0,v.t)(t,e),t}(wT);(0,o.l)(UT,"fd6ce005$ErrorViewElement",wT,[]);var HT=function(e){function t(t,n){var i=e.call(this,t,n.get_currentINode())||this;if(i.set_htmlElement(i._htmlView.createElement("iframe")),393304!==i._graphNode.get_runtimeClassId())return S.ULS.sendTraceTag(20248394,339,10,"Expects IFrameNode. Actual input node type was {0}",Object.getType(i._graphNode).toString()),i;i.AddCommonAttributes();var r=n.get_parentNode();if(r&&i.AddNonSrcAttributes(r),!i._graphNode.hasProperty(rs.o.iFrameOriginUrl))return S.ULS.sendTraceTag(20248396,339,10,"The IFrame node doesn't have valid origin url"),i;var o=i._graphNode.getValue(String,rs.o.iFrameOriginUrl);return i.get_htmlElement().get_attributes().add("data-original-src",o),i._htmlView.get_toAddToHtmlElementDict().set_item(i.get_htmlElement().get_elementId(),o),i}return(0,v.t)(t,e),t.prototype.AddNonSrcAttributes=function(e){var t=np.j.getDpi(0);if(e.hasProperty(is.b.layoutMaxWidth)){var n=e.getValue(Number,is.b.layoutMaxWidth);try{var i=Vu.r.muToInches(Math.round(n*t));i>0?this.get_htmlElement().get_attributes().add("width",i.toString()):S.ULS.sendTraceTag(20248398,339,15,"Iframe image width in inches '{0}' was less than equal to 0. Ignoring.",i)}catch(e){S.ULS.sendTraceTag(20248400,339,15,"Conversion of iframe image width '{0}' * PixelsPerInch '{1}' to an int resulted in an overflow exception. Ignoring.",n,t)}}if(e.hasProperty(is.b.layoutMaxHeight)){var r=e.getValue(Number,is.b.layoutMaxHeight);try{var o=Vu.r.muToInches(Math.round(r*t));o>0?this.get_htmlElement().get_attributes().add("height",o.toString()):S.ULS.sendTraceTag(20248402,339,15,"Iframe height in inches '{0}' was less than equal to 0. Ignoring.",o)}catch(e){S.ULS.sendTraceTag(20248404,339,15,"Conversion of Iframe height '{0}' * PixelsPerInch '{1}' to an int resulted in an overflow exception. Ignoring.",r,t)}}},t.get_ImageEditor=function(){return t._imageEditor||(t._imageEditor=Ge.w.get_instance().resolve(SS.w))},t._imageEditor=null,t}(wT);(0,o.l)(HT,"d0ab6e29$IframeViewElement",wT,[]);var GT=function(){function e(){}return e.NoteTagSymbolGenericNameToRoundtrippableNameInitialize=function(){var e=new aa.e(String,String);return e.set_item("blue-check-box","to-do"),e.set_item("yellow-star-check-box","important"),e.set_item("question","question"),e.set_item("none","remember-for-later"),e.set_item("marker","highlight"),e.set_item("contact-outlook","contact"),e.set_item("home","address"),e.set_item("telephone","phone-number"),e.set_item("link-globe","web-site-to-visit"),e.set_item("light-bulb","idea"),e.set_item("padlock","password"),e.set_item("high-priority","critical"),e.set_item("red-square-(project-a)","project-a"),e.set_item("yellow-square-(project-b)","project-b"),e.set_item("movie-clip","movie-to-see"),e.set_item("book-(open)","book-to-read"),e.set_item("music-note","music-to-listen-to"),e.set_item("comment","remember-for-blog"),e.set_item("to-do-blue-person","discuss-with-person-a"),e.set_item("to-do-yellow-person","discuss-with-manager"),e.set_item("email","send-in-email"),e.set_item("blue-arrow-check-box","schedule-meeting"),e.set_item("blue-check-box-1","to-do-priority-1"),e.set_item("yellow-check-box-2","to-do-priority-2"),e.set_item("yellow-exclamation-check-box","client-request"),e},e.get_NoteTagSymbolGenericNameToRoundtrippableName=function(){return e.NoteTagSymbolGenericNameToRoundtrippableNameLazy.get_value()},e.NoteTagsDictionaryInitialize=function(){var e=new aa.e(String,String);return e.set_item("0","none"),e.set_item("1","green-check-box"),e.set_item("2","yellow-check-box"),e.set_item("3","blue-check-box"),e.set_item("4","green-star-check-box"),e.set_item("5","yellow-star-check-box"),e.set_item("6","blue-star-check-box"),e.set_item("7","green-exclamation-check-box"),e.set_item("8","yellow-exclamation-check-box"),e.set_item("9","blue-exclamation-check-box"),e.set_item("10","green-arrow-check-box"),e.set_item("11","yellow-arrow-check-box"),e.set_item("12","blue-arrow-check-box"),e.set_item("13","yellow-star-check-box"),e.set_item("14","follow-up-flag"),e.set_item("15","question"),e.set_item("16","blue-right-arrow"),e.set_item("17","high-priority"),e.set_item("18","telephone"),e.set_item("19","calendar"),e.set_item("20","clock"),e.set_item("21","light-bulb"),e.set_item("22","pushpin"),e.set_item("23","home"),e.set_item("24","comment"),e.set_item("25","smiley"),e.set_item("26","award-ribbon"),e.set_item("27","key"),e.set_item("28","blue-check-box-1"),e.set_item("29","blue-circle-1"),e.set_item("30","blue-check-box-2"),e.set_item("31","blue-circle-2"),e.set_item("32","blue-check-box-3"),e.set_item("33","blue-circle-3"),e.set_item("34","blue-8-point-star"),e.set_item("35","blue-check-mark"),e.set_item("36","blue-circle"),e.set_item("37","blue-down-arrow"),e.set_item("38","blue-left-arrow"),e.set_item("39","blue-solid-target"),e.set_item("40","blue-star-check-box"),e.set_item("41","blue-sun"),e.set_item("42","blue-target"),e.set_item("43","blue-triangle"),e.set_item("44","blue-umbrella"),e.set_item("45","blue-up-arrow"),e.set_item("46","blue-x-with-dots"),e.set_item("47","blue-x"),e.set_item("48","green-check-box-1"),e.set_item("49","green-circle-1"),e.set_item("50","green-check-box-2"),e.set_item("51","green-circle-2"),e.set_item("52","green-check-box-3"),e.set_item("53","green-circle-3"),e.set_item("54","green-8-point-star"),e.set_item("55","green-check-mark"),e.set_item("56","green-circle"),e.set_item("57","green-down-arrow"),e.set_item("58","green-left-arrow"),e.set_item("59","green-right-arrow"),e.set_item("60","green-solid-target"),e.set_item("61","green-star-check-box"),e.set_item("62","green-sun"),e.set_item("63","green-target"),e.set_item("64","green-triangle"),e.set_item("65","green-umbrella"),e.set_item("66","green-up-arrow"),e.set_item("67","green-x-with-dots"),e.set_item("68","green-x"),e.set_item("69","yellow-check-box-1"),e.set_item("70","yellow-circle-1"),e.set_item("71","yellow-check-box-2"),e.set_item("72","yellow-circle-2"),e.set_item("73","yellow-check-box-3"),e.set_item("74","yellow-circle-3"),e.set_item("75","yellow-8-point-star"),e.set_item("76","yellow-check-mark"),e.set_item("77","yellow-circle"),e.set_item("78","yellow-down-arrow"),e.set_item("79","yellow-left-arrow"),e.set_item("80","yellow-right-arrow"),e.set_item("81","yellow-solid-target"),e.set_item("82","yellow-sun"),e.set_item("83","yellow-target"),e.set_item("84","yellow-triangle"),e.set_item("85","yellow-umbrella"),e.set_item("86","yellow-up-arrow"),e.set_item("87","yellow-x-with-dots"),e.set_item("88","yellow-x"),e.set_item("94","to-do-blue-person"),e.set_item("95","to-do-yellow-person"),e.set_item("96","to-do-green-person"),e.set_item("97","to-do-blue-flag"),e.set_item("98","to-do-yellow-flag"),e.set_item("99","to-do-green-flag"),e.set_item("100","red-square-(project-a)"),e.set_item("101","yellow-square-(project-b)"),e.set_item("102","blue-square-(project-c)"),e.set_item("103","green-square"),e.set_item("104","orange-square"),e.set_item("105","pink-square"),e.set_item("106","email"),e.set_item("107","envelope-closed"),e.set_item("108","envelope-opened"),e.set_item("109","mobile-phone"),e.set_item("110","telephone-with-clock"),e.set_item("111","question-balloon"),e.set_item("112","paperclip"),e.set_item("113","frowning"),e.set_item("114","im-contact"),e.set_item("115","person"),e.set_item("116","two-people"),e.set_item("117","reminder-bell"),e.set_item("118","contact-outlook"),e.set_item("119","flowers-bouquet"),e.set_item("120","date"),e.set_item("121","music-note"),e.set_item("122","movie-clip"),e.set_item("123","quote-mark"),e.set_item("124","globe"),e.set_item("125","link-globe"),e.set_item("126","laptop"),e.set_item("127","plane"),e.set_item("128","car"),e.set_item("129","binoculars"),e.set_item("130","presentation"),e.set_item("131","padlock"),e.set_item("132","book-(open)"),e.set_item("133","notebook-icon"),e.set_item("134","paper-(blank-with-lines)"),e.set_item("135","research-icon"),e.set_item("136","marker"),e.set_item("137","dollar-sign"),e.set_item("138","coins-with-window-behind-it"),e.set_item("139","schedule-task"),e.set_item("140","lighting-bolt"),e.set_item("141","cloud"),e.set_item("142","heart"),e.set_item("143","flower"),e},e.get_NoteTagsDictionary=function(){return e.NoteTagsDictionaryLazy.get_value()},e.AddNoteTagAttribute=function(t,n){if(t)if(n&&n.get_containingGraph()&&n.get_anchor()){var i=ha.g.createFromNode(n);if(Qs.q.isTitle(i)&&Mv.z.findAndMoveToTextParagraphNode(i),vb.b.hasNoteTags(i))if(bb.n.goToNoteTagContainer(i)){for(var r=new C.c(String),o=bb.n.goToFirstNoteTag(i),a=function(){var t=e.RetrieveNoteTagInfo(o);if(!ST.isNullOrEmpty(t)){var n,a=-1!==t.indexOf(":")?t.substr(0,t.indexOf(":")):t;if(e.get_NoteTagSymbolGenericNameToRoundtrippableName().tryGetValue(a,(0,g.m)((function(){return n}),(function(e){return n=e})))){var l=-1!==t.indexOf(":")?t.substr(t.indexOf(":")+1,t.length-(t.indexOf(":")+1)):"";ST.isNullOrEmpty(l)||(n+=":"+l),r.add(n)}}o=bb.n.goToNextNoteTag(i)};o;)a();var l=ST.stringJoin(",",r.toArray());ST.isNullOrEmpty(l)||t.get_attributes().set_item("data-tag",l)}}else S.ULS.sendTraceTag(20248453,339,15,"node is null or not in a good state");else S.ULS.sendTraceTag(20248451,339,15,"htmlElement is null")},e.RetrieveNoteTagInfo=function(t){var n=Ab.b.getNoteTagShape(t),i=null;if(e.get_NoteTagsDictionary().tryGetValue(n.toString(),(0,g.m)((function(){return i}),(function(e){return i=e})))){if(!ST.isNullOrEmpty(i)){var r;if(r=t.getValueWithDefault(Number,rs.o.noteTag_Status,0)){for(var o=vb.b.get_preDefinedNoteTagStatus().getEnumerator();o.$$mn();){var a=o.$$cu();a.get_value()===r&&(i=a.get_key())}Ab.b.isNoteTagMarkable(t)&&!ST.isNullOrEmpty(null)?i+=":null":S.ULS.sendTraceTag(20248455,339,50,"{0} is not predefined NoteTag status",r)}}}else S.ULS.sendTraceTag(20248457,339,50,"{0} is not a predefined NoteTag Shape and therefore is not supported",n);return i},e.NoteTagSymbolGenericNameToRoundtrippableNameLazy=new nt.q(aa.e.$$(String,String),e.NoteTagSymbolGenericNameToRoundtrippableNameInitialize),e.NoteTagsDictionaryLazy=new nt.q(aa.e.$$(String,String),e.NoteTagsDictionaryInitialize),e}();(0,o.l)(GT,"56eb017b$NoteTagUtils",null,[]);var WT=function(e){function t(t,n,i){var r,o,a,l,s=e.call(this,t,n.get_currentINode())||this;return s._splitImageHelper=null,s.set_htmlElement(s._htmlView.createElement("img")),s._splitImageHelper=i,s.AddCommonAttributes(),393233!==s._graphNode.get_runtimeClassId()?(S.ULS.sendTraceTag(20248406,339,10,"Expects ImageNode. Actual input node type was {0}",Object.getType(s._graphNode).toString()),s):(s.addId(s.get_htmlElement(),s._graphNode),s.AddNonSrcAttributes(),s.GetSrcAttributes(rs.o.webPictureContainer14,(0,g.m)((function(){return r}),(function(e){return r=e})),(0,g.m)((function(){return o}),(function(e){return o=e}))),s.GetSrcAttributes(is.b.pictureContainer,(0,g.m)((function(){return a}),(function(e){return a=e})),(0,g.m)((function(){return l}),(function(e){return l=e}))),s.AddSrcAttributes(r,o,a,l),s.AddSplitImageAttributes(),GT.AddNoteTagAttribute(s.get_htmlElement(),s._graphNode),s)}return(0,v.t)(t,e),t.prototype.AddToHtmlDocument=function(t){if(this._graphNode.hasProperty(is.b.hyperlinkUrl)){var n=this._htmlView.createElement("a");n.get_attributes().set_item("href",this._graphNode.getValue(String,is.b.hyperlinkUrl)),t.AddChild(n),t=n}e.prototype.AddToHtmlDocument.call(this,t)},t.prototype.AddNonSrcAttributes=function(){if(this._graphNode.hasProperty(is.b.imageAltText)){var e=this._graphNode.getValue(String,is.b.imageAltText);e&&""!==e&&this.get_htmlElement().get_attributes().add("alt",e)}var t=np.j.getDpi(0);if(this._graphNode.hasProperty(is.b.layoutMaxWidth)){var n=this._graphNode.getValue(Number,is.b.layoutMaxWidth);try{var i=Vu.r.muToInches(Math.round(n*t));i>0?this.get_htmlElement().get_attributes().add("width",i.toString()):S.ULS.sendTraceTag(20248408,339,15,"Image width in inches '{0}' was less than equal to 0. Ignoring.",i)}catch(e){S.ULS.sendTraceTag(20248410,339,15,"Conversion of image width '{0}' * PixelsPerInch '{1}' to an int resulted in an overflow exception. Ignoring.",n,t)}}if(this._graphNode.hasProperty(is.b.layoutMaxHeight)){var r=this._graphNode.getValue(Number,is.b.layoutMaxHeight);try{var o=Vu.r.muToInches(Math.round(r*t));o>0?this.get_htmlElement().get_attributes().add("height",o.toString()):S.ULS.sendTraceTag(20248412,339,15,"Image height in inches '{0}' was less than equal to 0. Ignoring.",o)}catch(e){S.ULS.sendTraceTag(20248414,339,15,"Conversion of image height '{0}' * PixelsPerInch '{1}' to an int resulted in an overflow exception. Ignoring.",r,t)}}},t.prototype.AddSrcAttributes=function(e,t,n,i){var r=null,o=null;e||n?(e&&e!==mt.h.get_nil()?(o=this._htmlView.constructUrl(e,t),this.get_htmlElement().get_attributes().add("src",o),this.get_htmlElement().get_attributes().add("data-src-type",t)):(r=this._htmlView.constructUrl(n,i),this.get_htmlElement().get_attributes().add("src",r),this.get_htmlElement().get_attributes().add("data-src-type",i),o=r),n!==mt.h.get_nil()&&n?(""!==r&&r||(r=this._htmlView.constructUrl(n,i)),this.get_htmlElement().get_attributes().add("data-fullres-src",r),this.get_htmlElement().get_attributes().add("data-fullres-src-type",i)):(S.ULS.sendTraceTag(20248418,339,50,"highResImageId is null."),r=o,this.get_htmlElement().get_attributes().add("data-fullres-src",o),this.get_htmlElement().get_attributes().add("data-fullres-src-type",t))):S.ULS.sendTraceTag(20248416,339,15,"There is no image blob.")},t.prototype.GetSrcAttributes=function(e,t,n){t.val=null,n.val=null},t.prototype.IsPrintOutImage=function(){return this._graphNode.getValueWithDefault(Boolean,is.b.isPrintoutPage,!1)},t.prototype.AddSplitImageAttributes=function(){this.isSplitPiece()&&(this.get_htmlElement().get_attributes().add("data-index",this._splitImageHelper.get_pageOrder().toString()),this.AddDataRenderOriginalSrcAttribute()),this.IsPrintOutImage()&&this.get_htmlElement().get_attributes().add("data-options","printout")},t.prototype.AddDataRenderOriginalSrcAttribute=function(){this._splitImageHelper.get_dataRenderOriginalSrc()&&this.get_htmlElement().get_attributes().add("data-render-original-src",this._splitImageHelper.get_dataRenderOriginalSrc())},t.prototype.isSplitPiece=function(){return this._splitImageHelper.isSplitImage()},t.prototype.get_srcGuid=function(){return this._splitImageHelper.get_srcGuid()},t}(wT);(0,o.l)(WT,"ce853f9a$ImageViewElement",wT,[RT]);var VT=function(){function e(){}return e.get_ListReaderInstance=function(){return e._listReader||(e._listReader=Ge.w.get_instance().resolve(Ql.c))},e.GetListInfoForBareContentInsideAList=function(t,n){if(!t||!t.get_containingGraph())return null;var i=new ha.g;return i.set(t),i.tryToRootAtPageContent(),i.returnToParent()&&Ss.OutlineElementReader.isOutlineElement(i)&&1===i.getChildCount()&&i.returnToParent()?(n.setFrom(i),e.GetListInfoForListContainer(i)):null},e.GetListInfoForListContainer=function(t){var n=new ha.g;n.setFrom(t);for(var i=n.goToFirstChildByRole(1);i;i=n.goToNextSiblingByRole(1))if(gs.ListReader.isListOutlineElement(n)){n.goToFirstChildByRole(4);var r=n.get_currentNode();return e.get_ListReaderInstance().getListInfoNode(r)}return null},e.RemoveContentThatBelongsToAList=function(t){var n=t.get_children().get_item(t.get_children().get_count()-1);return ST.contains(n.tagName,e.AllowedListItems)?t.get_children().remove(n):S.ULS.sendTraceTag(20248449,339,100,"Unexpected number list paragraph schema: {0}",n.tagName),n},e._listReader=null,e.AllowedListItems=["table","img","p","div"],e}();(0,o.l)(VT,"ae07059b$ListUtils",null,[]);var $T=function(e){function t(n,i){var r=e.call(this,n,i.get_currentNode())||this;r._listInfo=null,r.set_htmlElement(r._htmlView.createElement("li")),r.addId(r.get_htmlElement(),i.get_currentINode()),i.get_currentINode().hasProperty(is.b.listRestart)&&r.get_htmlElement().get_attributes().add("value",i.get_currentINode().getValue(Number,is.b.listRestart).toString()),r._listInfo=t.get_ListReaderInstance().getListInfoNode(r.get_sourceNode());var o=t.ListStyleType(r._listInfo);return ST.isNullOrEmpty(o)||r.get_htmlElement().get_styles().add("list-style-type",o),r}return(0,v.t)(t,e),t.prototype.AddToHtmlDocument=function(e){var t=VT.RemoveContentThatBelongsToAList(e),n=this.MoveListParent();this.GetContainingList(n,this._listInfo,e).AddChild(this.get_htmlElement()),this.get_htmlElement().AddChild(t)},t.prototype.MoveListParent=function(){var e=new ha.g;return e.set(this._graphNode),e.tryToRootAtPageContent(),e.returnToParent(),e.returnToParent(),e},t.get_ListReaderInstance=function(){return t._listReader||(t._listReader=Ge.w.get_instance().resolve(Ql.c))},t.ListStyleType=function(e){var t=null;if(e.get_isOrdered())switch(e.get_listStyle()){case 0:t="none";break;case 1:break;case 2:t="lower-alpha";break;case 3:t="lower-roman";break;case 4:t="upper-alpha";break;case 5:t="upper-roman"}else switch(e.get_listStyle()){case 0:t="none";break;case 1:break;case 2:t="circle";break;case 3:t="square"}return t},t._listReader=null,t}(wT);(0,o.l)($T,"abe292fc$NumberListViewElement",wT,[]);var zT=function(e){function t(t,n){var i=e.call(this,t,n.get_currentNode())||this;return i.set_htmlElement(i._htmlView.createElement("div")),i.addId(i.get_htmlElement(),n.get_currentINode()),i.AddCommonAttributes(),i.get_htmlElement().get_styles().add("width",CT.muToPixel(n.get_currentINode().getValueWithDefault(Number,is.b.layoutMaxWidth,0))+"px"),i}return(0,v.t)(t,e),t}(wT);(0,o.l)(zT,"c41a0e5d$OutlineViewElement",wT,[]);var KT=function(e){function t(t,n){var i=e.call(this,t,n.get_currentNode())||this;return i.set_htmlElement(i._htmlView.createElement("body")),i.get_htmlElement().get_attributes().add("data-absolute-enabled","true"),i}return(0,v.t)(t,e),t}(wT);(0,o.l)(KT,"2e573ae7$PageContentViewElement",wT,[]);var qT,jT=function(){function e(){}return e.paragraphObjectSpecialCharacter="\ufffc",e}();(0,o.l)(jT,"b2854260$ParagraphViewConstants",null,[]);var QT=function(e){function t(t,n){var i=e.call(this,t,n.get_currentNode())||this,r=i.get_sourceNode(),o=Ga.ParagraphReader.text(r);if(ST.isNullOrEmpty(o)||o===jT.paragraphObjectSpecialCharacter&&!(r.get_characterProperties().get_length()>0&&r.get_characterProperties().get_item(0).get_blob()&&11===r.get_characterProperties().get_item(0).get_blob().get_blobType()))i.set_htmlElement(i._htmlView.createElement("br"));else if(r.get_characterProperties()&&r.get_characterProperties().get_length()){i.set_htmlElement(i.GetParagraphElement(r));for(var a,l=function(e,t){if(r.get_characterProperties().get_item(e).get_isEndOfParagraph())return a=t,"continue";if(r.get_characterProperties().get_item(e).get_blob()&&11===r.get_characterProperties().get_item(e).get_blob().get_blobType()){var n=r.get_characterProperties().get_item(e).get_blob().get_renderedMathElement(),i=W.y.get_isFirefox()?n.getElementsByTagName("math"):n.getElementsByTagName("script");if(i&&i.length>0&&("math/mml"===i[0].getAttribute("type")||W.y.get_isFirefox())){var l=W.y.get_isFirefox()?i[0].parentNode.innerHTML:i[0].innerText,u=s._htmlView.createCommentElement("[if mathML]>"+l+"<![endif]");s.get_htmlElement().AddChildAndSetParent(0,u)}}else{for(var c=s.GetChildElement(r.get_characterProperties().get_item(e),o,(0,g.m)((function(){return t}),(function(e){return t=e})));c&&c.value&&c.value.endsWith(jT.paragraphObjectSpecialCharacter);)c.value=c.value.replace(jT.paragraphObjectSpecialCharacter,"");s.get_htmlElement().AddChildAndSetParent(0,c)}a=t},s=this,u=r.get_characterProperties().get_length()-1,c=o.length;u>=0;u--)l(u,c),c=a}else i.set_htmlElement(i.GetParagraphElement(r)),i.get_htmlElement().value=o;return i.AddCommonAttributes(),i}return(0,v.t)(t,e),t.prototype.GetParagraphElement=function(e){if(!e)return null;var n,i=bs.StyleReader.getStyleFromParagraphNode(e);if(i){var r=bs.StyleReader.getStyleId(i);t.ParagraphTags.contains(r)?n=this._htmlView.createElement(r):(n=this._htmlView.createElement("p"),S.ULS.sendTraceTag(20248467,339,50,"Unsupported tag returned. Defaulting to p: {0}",r)),t.AddStylesFromPropertySet(n.get_styles(),i)}else n=this._htmlView.createElement("p");this.addId(n,e);var o=CT.GetDefaultMargin(n.get_styles()),a=Ga.ParagraphReader.fetchProperty(Number,e,rs.o.paragraphSpaceBefore,0),l=CT.MuToPoints(a);l!==o&&n.get_styles().set_item("margin-top",String.format("{0}pt",l));var s=Ga.ParagraphReader.fetchProperty(Number,e,rs.o.paragraphSpaceAfter,0),u=CT.MuToPoints(s);if(u!==o&&n.get_styles().set_item("margin-bottom",String.format("{0}pt",u)),e.hasProperty(is.b.layoutAlignmentInParent))switch(e.getValueWithDefault(Number,is.b.layoutAlignmentInParent,0)){case 1:n.get_styles().set_item("text-align","left");break;case 2:n.get_styles().set_item("text-align","center");break;case 3:n.get_styles().set_item("text-align","right")}if(e.hasProperty(is.b.richTextLanguageId)){var c=e.getValue(Number,is.b.richTextLanguageId),d=LT.lcidToCultureName(c);d?n.get_attributes().set_item("lang",d):S.ULS.sendTraceTag(20248469,339,50,"Invalid language id: {0}",c)}return GT.AddNoteTagAttribute(n,e),n},t.prototype.GetChildElementForNoFormatting=function(e,t){if(t===jT.paragraphObjectSpecialCharacter)return this._htmlView.createElement("br");var n=this._htmlView.createElement("span");return n.value=t,n},t.prototype.GetChildElement=function(e,n,i){if(!e)return null;if(!n)return null;var r=t.GetCurrentSubstring(e,n,i);if(t.HasNoFormatting(e))return this.GetChildElementForNoFormatting(e,r);var o=this._htmlView.createElement("span"),a=o;if(e.get_formatting().get_formattingContainer().getValueWithDefault(Boolean,is.b.superscript,!1)&&(a.AddChild(this._htmlView.createElement("sup")),a=a.get_children().get_count()>0?a.get_children().get_item(0):null),e.get_formatting().get_formattingContainer().getValueWithDefault(Boolean,is.b.subscript,!1)&&(a.AddChild(this._htmlView.createElement("sub")),a=a.get_children().get_count()>0?a.get_children().get_item(0):null),e.get_hyperlink()&&(a.AddChild(this._htmlView.createElement("a")),(a=a.get_children().get_count()>0?a.get_children().get_item(0):null).get_attributes().set_item("href",e.get_hyperlink().get_url())),e.get_formatting().get_formattingContainer().hasProperty(is.b.languageID)){var l=e.get_formatting().get_formattingContainer().getValue(Number,is.b.languageID),s=LT.lcidToCultureName(l);s?a.get_attributes().set_item("lang",s):S.ULS.sendTraceTag(20248471,339,50,"Invalid language id: {0}",l)}return a.value=r,t.AddStylesFromPropertySet(a.get_styles(),e.get_formatting().get_formattingContainer()),o},t.create=function(e,n){return new t(e,n)},t.HasNoFormatting=function(e){return!e.get_formatting()||!e.get_formatting().get_formattingContainer()},t.GetCurrentSubstring=function(e,t,n){var i=t.substr(e.get_cp(),n.val-e.get_cp());return n.val=e.get_cp(),i},t.AddStylesFromPropertySet=function(e,t){if(e&&t){if(t.hasProperty(is.b.font)&&e.set_item("font-family",t.getValueWithDefault(String,is.b.font,null)),t.hasProperty(is.b.fontSize)&&e.set_item("font-size",t.getValueWithDefault(Number,is.b.fontSize,0)/2+"pt"),t.hasProperty(is.b.fontColor)){var n=CT.UintToColorName(t.getValueWithDefault(Number,is.b.fontColor,0));ST.isNullOrEmpty(n)||e.set_item("color",n)}if(t.hasProperty(is.b.highlight)){var i=CT.UintToColorName(t.getValueWithDefault(Number,is.b.highlight,0));ST.isNullOrEmpty(i)||e.set_item("background-color",i)}t.getValueWithDefault(Boolean,is.b.bold,!1)&&e.set_item("font-weight","bold"),t.getValueWithDefault(Boolean,is.b.italic,!1)&&e.set_item("font-style","italic"),t.getValueWithDefault(Boolean,is.b.underline,!1)&&e.set_item("text-decoration","underline"),t.getValueWithDefault(Boolean,is.b.strikethrough,!1)&&e.set_item("text-decoration","line-through")}},t.ParagraphTags=((qT=new C.c(String)).add("p"),qT.add("cite"),qT.add("h1"),qT.add("h2"),qT.add("h3"),qT.add("h4"),qT.add("h5"),qT.add("h6"),qT.add("br"),qT),t}(wT);(0,o.l)(QT,"4415f633$ParagraphViewElement",wT,[]);var JT=(0,o.y)("6fe45532$ISplitImageNode"),XT=n(2760),YT=n(4939),ZT=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.$$cctor=function(){t.ensureLoaded()},t.DefineProperty=function(e,t,n){return XT.a.defineProperty(20,e,t,n)},t.ensureLoaded=function(){},t.appId=t.DefineProperty(0,YT.y.string,0),t.deniedFileExt=t.DefineProperty(1,YT.y.bool,0),t.fileMimeType=t.DefineProperty(2,YT.y.string,0),t.imageSourceGuid=t.DefineProperty(3,YT.y.string,0),t.imageFragmentDisplayIndex=t.DefineProperty(4,YT.y.uInt_32,0),t.hierarchyOfIdentifiers=t.DefineProperty(5,YT.y.string,512),t.ownerTagName=t.DefineProperty(6,YT.y.string,512),t.dataRenderOriginalSrc=t.DefineProperty(7,YT.y.string,0),t.dataGroupId=t.DefineProperty(8,YT.y.string,0),t.classifierLabel=t.DefineProperty(9,YT.y.string,0),t.ocrVersion=t.DefineProperty(10,YT.y.uInt_32,0),t.classifierVersion=t.DefineProperty(11,YT.y.uInt_32,0),t.userClassifierLabels=t.DefineProperty(12,YT.y.arrayOfStrings,0),t.machineClassifierLabels=t.DefineProperty(13,YT.y.arrayOfStrings,0),t.machineSentinelClassifierLabels=t.DefineProperty(14,YT.y.arrayOfStrings,0),t.handwritingRecoVersion=t.DefineProperty(15,YT.y.string,0),t.machineModifiedRevisionId=t.DefineProperty(16,YT.y.extendedGuid,0),t.imageClassificationVersion=t.DefineProperty(17,YT.y.uInt_32,0),t}(XT.a);(0,o.l)(ZT,"8eba5f18$OneNoteServiceProperties1",XT.a,[]),ZT.$$cctor();var eA=function(){function e(e){if(this.type=0,this._srcGuid=null,this._pageOrder=0,this._dataRenderOriginalSrc=null,393233===e.get_runtimeClassId())if(this.type=0,e.hasProperty(ZT.imageSourceGuid)&&e.hasProperty(ZT.imageFragmentDisplayIndex)){var t=e.getValue(String,ZT.imageSourceGuid);ST.isNullOrEmpty(t)?S.ULS.sendTraceTag(20248513,339,15,"GraphNode has the OneNoteServiceProperties1.ImageSourceGuid property but it's value is null or whitespace. Setting SplitType to None"):(this.type=1,this.set_srcGuid(ai.l.createFromString(t)),this.set_pageOrder(e.getValue(Number,ZT.imageFragmentDisplayIndex)),e.hasProperty(ZT.dataRenderOriginalSrc)&&this.set_dataRenderOriginalSrc(e.getValueWithDefault(String,ZT.dataRenderOriginalSrc,null)))}else e.hasProperty(is.b.sourceDocumentGuid)&&e.hasProperty(is.b.originalPageNumber)&&(this.type=2,this.set_srcGuid(e.getValue(ai.l,is.b.sourceDocumentGuid)),this.set_pageOrder(e.getValue(Number,is.b.originalPageNumber)),e.hasProperty(ZT.dataRenderOriginalSrc)&&this.set_dataRenderOriginalSrc(e.getValueWithDefault(String,ZT.dataRenderOriginalSrc,null)))}return e.prototype.get_srcGuid=function(){return this.isSplitImage()?this._srcGuid:null},e.prototype.set_srcGuid=function(e){return this._srcGuid=e,e},e.prototype.get_pageOrder=function(){return this.isSplitImage()?this._pageOrder:0},e.prototype.set_pageOrder=function(e){return this._pageOrder=e,e},e.prototype.get_dataRenderOriginalSrc=function(){return this.isSplitImage()?this._dataRenderOriginalSrc:null},e.prototype.set_dataRenderOriginalSrc=function(e){return this._dataRenderOriginalSrc=e,e},e.prototype.isSplitImage=function(){return!!this.type},e}();(0,o.l)(eA,"c3c0e53b$SplitImageNode",null,[JT]);var tA=function(e){function t(n,i){var r=e.call(this,n,i.get_currentNode())||this;if(r._graphIterator=null,r.set_htmlElement(r._htmlView.createElement("td")),r.addId(r.get_htmlElement(),i.get_currentINode()),r.get_sourceNode().hasProperty(is.b.cellShadingColor)){var o=r.get_sourceNode().getValueWithDefault(Number,is.b.cellShadingColor,0);r.get_htmlElement().get_styles().add("background-color",CT.UintToColorName(o))}r._graphIterator=new ha.g,r._graphIterator.setFrom(i);var a,l=Fd.s.getColumnIndex(r._graphIterator);t.GetColumnWidth(r._graphIterator,l,(0,g.m)((function(){return a}),(function(e){return a=e})))&&r.get_htmlElement().get_styles().add("width",a.toString());var s=t.DoesTableHaveBorder(r.get_sourceNode());return r.get_htmlElement().get_styles().add("border",s?"1px solid":"0px"),r}return(0,v.t)(t,e),t.GetColumnWidth=function(e,t,n){n.val=0;var i=Pd.TableNavigator.getContainingTable(e);return!(Fd.s.getColumnWidthMu(i,t)<0)&&(n.val=CT.muToPixel(Fd.s.getColumnWidthMu(i,t)),!0)},t.DoesTableHaveBorder=function(e){var t=new ha.g;return t.set(e),t.tryToRootAtAncestorOfType(14),Pd.TableNavigator.getContainingTable(t).getValueWithDefault(Boolean,is.b.tableBordersVisible,!0)},t}(wT);(0,o.l)(tA,"e3a98f05$TableCellViewElement",wT,[]);var nA=function(e){function t(t,n){var i=e.call(this,t,n.get_currentNode())||this;return i.set_htmlElement(i._htmlView.createElement("tr")),i.addId(i.get_htmlElement(),n.get_currentINode()),i}return(0,v.t)(t,e),t}(wT);(0,o.l)(nA,"a7699209$TableRowViewElement",wT,[]);var iA=function(e){function t(t,n){var i=e.call(this,t,n.get_currentNode())||this;i.set_htmlElement(i._htmlView.createElement("table")),i.addId(i.get_htmlElement(),n.get_currentINode());var r=i.get_sourceNode().getValueWithDefault(Boolean,is.b.tableBordersVisible,!0);return i.get_htmlElement().get_styles().add("border",r?"1px solid":"0px"),r&&i.get_htmlElement().get_styles().add("border-collapse","collapse"),i}return(0,v.t)(t,e),t}(wT);(0,o.l)(iA,"5aaadb83$TableViewElement",wT,[]);var rA=function(e){function t(n,i){var r=e.call(this,n,i.get_currentNode())||this;r._titleElement=null;var o=i;try{r.set_htmlElement(r._htmlView.createElement("head")),r._titleElement=r._htmlView.createElement("title"),r._titleElement.canSelfEnd=!1,r.get_htmlElement().AddChild(r._titleElement);var a=r._htmlView.createElement("meta");a.get_attributes().add("http-equiv","Content-Type"),a.get_attributes().add("content","text/html; charset=utf-8"),r.get_htmlElement().AddChild(a),Mv.z.findAndMoveToTextParagraphNode(o)&&(r._titleElement.value=Ga.ParagraphReader.text(o.get_currentNode())),o.returnToNodeOfType(9);var l=Mv.z.findAndMoveToDateParagraphNode(o);if(!l||12!==l.get_type()||!Qs.q.isTitleDate(l))return S.ULS.sendTraceTag(20248517,339,50,"Did not find date under title node."),r;var s=Ga.ParagraphReader.text(l);o.returnToNodeOfType(9);var u=Mv.z.findAndMoveToTimeParagraphNode(o);if(!u||12!==u.get_type()||!Qs.q.isTitleTime(u))return S.ULS.sendTraceTag(20248519,339,50,"Did not find time under title node."),r;var c=Ga.ParagraphReader.text(u);if(ST.isNullOrEmpty(s)||ST.isNullOrEmpty(c))return S.ULS.sendTraceTag(20248521,339,50,"Either date or time is empty."),r;o.returnToNodeOfType(9),GT.AddNoteTagAttribute(r._titleElement,o.get_currentINode())}finally{t.SkipToEndOfTitle(o)}return r}return(0,v.t)(t,e),t.prototype.AddToHtmlDocument=function(e){for(;e.get_parent();)e=e.get_parent();e.AddChildAndSetParent(0,this.get_htmlElement())},t.SkipToEndOfTitle=function(e){for(;e.goToLastChild(););},t}(wT);(0,o.l)(rA,"262acdd$TitleViewElement",wT,[]);var oA=function(){function e(){}return e.prototype.createViewElementForGraphNode=function(e,t){if(!e)return null;if(!t)return null;var n;switch(S.ULS.sendTraceTag(20248349,339,50,"Creating ViewElement of type = {0}",t.get_currentNode().get_type()),t.get_currentNode().get_type()){case 32:n=new OT(e,t);break;case 1:n=null;break;case 19:n=new WT(e,t,new eA(t.get_currentINode()));break;case 59:this.isVideoMediaType(t.get_currentNode()),n=new HT(e,t);break;case 22:n=new $T(e,t);break;case 10:n=new zT(e,t);break;case 11:n=null;break;case 8:n=new KT(e,t);break;case 7:n=null;break;case 12:n=QT.create(e,t);break;case 14:n=new iA(e,t);break;case 16:n=new tA(e,t);break;case 15:n=new nA(e,t);break;case 9:n=new rA(e,t);break;default:S.ULS.sendTraceTag(20248351,339,15,"Unhandled node type during ViewElement creation: {0}",t.get_currentNode().get_type());var i=String.format("{0} is not supported",t.get_currentNode().get_runtimeClassId());n=new UT(e,t.get_currentNode(),i)}return n},e.prototype.isVideoMediaType=function(e){return!e.hasProperty(rs.o.iFrameMediaType)||1===e.getValue(Number,rs.o.iFrameMediaType)},e}();(0,o.l)(oA,"5ba30a4a$DefaultViewElementCreator",null,[BT]);var aA=function(){function e(t){this.elementId=null,this.tagName=null,this.className=null,this.parent=null,this.children=null,this.attributes=null,this.styles=null,this.value=null,this.comment=null,this.canSelfEnd=!1,this.indent=0,this.isComment=!1,this.elementId=t,this.children=new C.c(e),this.attributes=new aa.e(String,String),this.styles=new aa.e(String,String),this.canSelfEnd=!0}return e.prototype.get_elementId=function(){return this.elementId},e.prototype.get_parent=function(){return this.parent},e.prototype.get_children=function(){return this.children},e.prototype.get_attributes=function(){return this.attributes},e.prototype.get_styles=function(){return this.styles},e.prototype.get_isComment=function(){return this.isComment},e.prototype.get_hasSemanticValue=function(){return"span"!==this.tagName&&"div"!==this.tagName},e.prototype.AddChild=function(e){this.AddChildAndSetParent(this.get_children().get_count(),e)},e.prototype.AddChildAndSetParent=function(e,t){S.ULS.shipAssertTag(20248343,339,this!==t,"Attempting to add PCRDOMElement {0} as a child of itself",this.tagName),this.get_children().insert(e,t),t.parent=this},e.prototype.ContainsChild=function(e){return this.get_children().contains(e)},e.prototype.SetParent=function(e){this.get_parent()&&this.get_parent().get_children().remove(this),e?e.AddChild(this):this.parent=null},e.prototype.InsertParent=function(e){if(this.get_parent()){var t=this.get_parent().get_children().indexOf(this);-1!==t&&(this.get_parent().get_children().remove(this),this.get_parent().ContainsChild(e)||this.get_parent()===e||this.get_parent().AddChildAndSetParent(t,e))}e.AddChild(this)},e.createCommentDomElement=function(t){return(0,U.m)(new e(mt.h.create().toString()),{isComment:!0,comment:t,tagName:""})},e}();(0,o.l)(aA,"a4f6ac77$PCRDOMElement",null,[]);var lA=function(){function e(){}return e.resolve=function(t,n,i){try{e.getParentIds(t,n,i)}catch(e){S.ULS.sendTraceTag(20248392,339,10,"data-id attributes are not set successfully. {0}",e)}},e.getParentIds=function(t,n,i){var r=n.containsKey(t.get_elementId())?n.get_item(t.get_elementId()):new Xg(Dp),o=e.GetInfoOfTag(r,t.tagName);o&&r.removeAt(r.get_count()-1);for(var a=null,l=0,s=t.get_children().toArray();l<s.length;l++){var u=s[l],c=e.getParentIds(u,n,i);e.AddDivs(c,t,a,u,i);var d=e.GetInfoOfTag(c,t.tagName);if(d&&c.removeAt(c.get_count()-1),r=e.MergeParentIds(r,c),d){if(!o&&d.get_htmlIdentifier()&&""!==d.get_htmlIdentifier())o=d;else if(o.get_htmlIdentifier()&&""!==o.get_htmlIdentifier()&&d.get_htmlIdentifier()&&""!==d.get_htmlIdentifier()&&o.get_htmlIdentifier()!==d.get_htmlIdentifier())return null;a=u}else a=u}return o&&o.get_htmlIdentifier()!==e.unIdentified&&t.get_attributes().add("data-id",o.get_htmlIdentifier()),r},e.AddDivs=function(e,t,n,i,r){if(e){var o=new FT.d(String,aA,0);if(n)for(var a=n.get_parent();a&&a!==t&&"div"===Rn.l.toLower(a.tagName);)a.get_attributes().containsKey("data-id")&&!o.containsKey(a.get_attributes().get_item("data-id"))&&o.set_item(a.get_attributes().get_item("data-id"),a),a=a.get_parent();for(var l=!1,s=i;e.get_count()>0;){var u=e.get_item(e.get_count()-1);if("div"!==Rn.l.toLower(u.get_htmlElementType()))break;if(l)e.remove(u);else{if(o.containsKey(u.get_htmlIdentifier()))s.SetParent(o.get_item(u.get_htmlIdentifier())),l=!0;else if(u.get_htmlIdentifier()&&""!==u.get_htmlIdentifier()){var c=r("div");c.get_attributes().add("data-id",u.get_htmlIdentifier()),s.InsertParent(c)}s=s.get_parent(),e.remove(u)}}}},e.MergeParentIds=function(e,t){if(!e)return t;if(!t)return e;for(var n=new Xg(Dp),i=e.get_count()-1,r=t.get_count()-1;i>=0&&r>=0;i--,r--){if(e.get_item(i).get_htmlElementType()!==t.get_item(r).get_htmlElementType()||e.get_item(i).get_htmlIdentifier()!==t.get_item(r).get_htmlIdentifier())return n;n.insert(0,e.get_item(i))}if(i>r)for(;i>=0;)n.insert(0,e.get_item(i)),i--;else for(;r>=0;)n.insert(0,t.get_item(r)),r--;return n},e.GetInfoOfTag=function(e,t){if(!e||!e.get_count())return null;var n=e.get_item(e.get_count()-1);return n&&(Rn.l.toLower(n.get_htmlElementType())===t||"img"===t&&"IFRAME"===n.get_htmlElementType())?n:null},e.unIdentified="_none",e}();(0,o.l)(lA,"ad7f7e92$IdHierarchyResolver",null,[]);var sA=function(){return function(){this.documentElement=null}}();(0,o.l)(sA,"c86228a6$PCRDOMDocument",null,[]);var uA=n(6955),cA=function(e){function t(t,n,i){var r=e.call(this)||this;return r._traversalFinished=!1,r._renderRoleOrder=null,r._traversalCount=0,r._pcrUseSafeGoToFirstChildByRole=!1,r._pcrUseSafeGoToNextSiblingByRole=!1,r._pcrUseSafeGoToFirstSiblingByRole=!1,r._traversalCount=0,r.init(t,n),r._renderRoleOrder=i,r._pcrUseSafeGoToFirstChildByRole=!0,r._pcrUseSafeGoToNextSiblingByRole=!0,r._pcrUseSafeGoToFirstSiblingByRole=!0,r}return(0,v.t)(t,e),t.prototype.moveNext=function(){try{if(this._traversalCount=0,!this._traversalStarted)return this._traversalStarted=!0,!0;if(this._traversalFinished)return!1;if(!this.goToFirstChildInRenderOrder()){if(this._iterator.get_currentNode()===this._scope)return this._traversalFinished=!0,!1;for(var e=this._iterator.get_currentNode();!this.goToNextSiblingInRenderOrder();){if(this._traversalCount++,this._iterator.returnToParent(),e===this._iterator.get_currentNode())return S.ULS.sendTraceTag(20248477,339,10,"RenderOrderTraverser - traversal to parent did not move. quit traversing."),!1;if(this._iterator.get_currentNode()===this._scope)return this._traversalFinished=!0,!1;e=this._iterator.get_currentNode()}}return!0}finally{S.ULS.sendTraceTag(20248479,339,50,"RenderOrderTraverser:MoveNext ends with traverse count = {0}.",this._traversalCount)}},t.prototype.reset=function(){e.prototype.reset.call(this),this._traversalFinished=!1},t.prototype.goToFirstChildInRenderOrder=function(){for(var e=0;e<this._renderRoleOrder.length;e++){this._traversalCount++;var t=null;if(t=this._pcrUseSafeGoToFirstChildByRole?this.SafeGoToFirstChildByRole(this._iterator,this._renderRoleOrder[e]):this._iterator.goToFirstChildByRole(this._renderRoleOrder[e]))return t}return null},t.prototype.goToNextSiblingInRenderOrder=function(){var e=null;if(e=this._pcrUseSafeGoToNextSiblingByRole?this.SafeGoToNextSiblingByRole(this._iterator,this._iterator.get_role()):this._iterator.goToNextSiblingByRole(this._iterator.get_role()))return e;var t=Array.indexOf(this._renderRoleOrder,this._iterator.get_role());for(t++;t<this._renderRoleOrder.length;){if(this._traversalCount++,e=this._pcrUseSafeGoToFirstSiblingByRole?this.SafeGoToFirstSiblingByRole(this._iterator,this._renderRoleOrder[t]):this._iterator.goToFirstSiblingByRole(this._renderRoleOrder[t]))return e;t++}return null},t.prototype.SafeGoToNextSiblingByRole=function(e,t){if(!e)return null;if(!e.get_isValid())return S.ULS.sendTraceTag(20248481,339,10,"iterator is not valid."),null;var n=new ha.g;n.setFrom(e);for(var i=e.goToNextSibling();i;i=e.goToNextSibling())if(0,e.get_role()===t)return i;return e.setFrom(n),null},t.prototype.SafeGoToFirstChildByRole=function(e,t){if(!e)return null;if(!e.get_isValid())return S.ULS.sendTraceTag(20248483,339,10,"iterator is not valid."),null;var n=new ha.g;n.setFrom(e);for(var i=e.goToFirstChild();i;i=e.goToNextSibling())if(0,e.get_role()===t)return i;return e.setFrom(n),null},t.prototype.SafeGoToFirstSiblingByRole=function(e,t){if(!e)return null;var n=new ha.g;n.setFrom(e),e.returnToParent();var i=this.SafeGoToFirstChildByRole(e,t);return i||(e.setFrom(n),null)},t.createTraverser=function(e,n){var i=new ha.g;return i.set(e),new t(i,e,n)},t}(uA.u);(0,o.l)(cA,"5e8ae328$RenderOrderTraverser",uA.u,[]);var dA=function(){function e(){this.printoutFileBySrcGuid=null,this.splitImagesBySrcGuid=null,this.printoutFileBySrcGuid=new FT.d(ai.l,MT,0),this.splitImagesBySrcGuid=new FT.d(ai.l,C.c.$$(RT),0)}return e.prototype.get_printoutFileBySrcGuid=function(){return this.printoutFileBySrcGuid},e.prototype.get_splitImagesBySrcGuid=function(){return this.splitImagesBySrcGuid},e.prototype.addImage=function(e){if(e.isSplitPiece())if(this.get_splitImagesBySrcGuid().containsKey(e.get_srcGuid()))this.get_splitImagesBySrcGuid().get_item(e.get_srcGuid()).add(e);else{var t=void 0;this.get_splitImagesBySrcGuid().set_item(e.get_srcGuid(),((t=new C.c(RT)).add(e),t))}},e.prototype.addFile=function(e){e.isPrintout()&&(this.get_printoutFileBySrcGuid().containsKey(e.get_srcGuid())&&S.ULS.sendTraceTag(20248515,339,10,"file with same source guid exist."),this.get_printoutFileBySrcGuid().set_item(e.get_srcGuid(),e))},e.prototype.build=function(){},e}();(0,o.l)(dA,"1c766af7$SplitImageViewBuilder",null,[]);var gA=function(){function e(e,t,n,i,r){void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===r&&(r=!1),this.$$pf_OwnerDocument=null,this.saveGraphNodePathInfo=!1,this.includeIds=!1,this.preAuthenticated=!1,this.toAddToPublicCacheDict=null,this.toAddToHtmlElementDict=null,this.listContainers=null,this.graphDomTree=null,this.graphNodePath=null,this.elementToGraphNode=null,this.domElementToHierarchy=null,this.splitImageViewBuilder=null,this._viewElementCreator=null,this._uriBuilder=null,this.saveGraphNodePathInfo=n,this.includeIds=i,this.set_ownerDocument(new sA),this.graphDomTree=new FT.d(String,wT,J.b.get_ordinalIgnoreCase()),this.graphNodePath=new FT.d(String,ha.g,J.b.get_ordinalIgnoreCase()),this.elementToGraphNode=new FT.d(String,mm.k,J.b.get_ordinalIgnoreCase()),this.domElementToHierarchy=new FT.d(String,Xg.$$(Dp),J.b.get_ordinalIgnoreCase()),this.splitImageViewBuilder=new dA,this.listContainers=new FT.d(String,aA,J.b.get_ordinalIgnoreCase()),this.toAddToPublicCacheDict=new aa.e(String,String),this.toAddToHtmlElementDict=new aa.e(String,String),this._viewElementCreator=e,this._uriBuilder=t}return e.prototype.get_viewId=function(){return 0},e.prototype.get_container=function(){return null},e.prototype.get_contentContainer=function(){return this.get_container()},e.prototype.get_ownerDocument=function(){return this.$$pf_OwnerDocument},e.prototype.set_ownerDocument=function(e){return this.$$pf_OwnerDocument=e,e},e.prototype.get_saveGraphNodePathInfo=function(){return this.saveGraphNodePathInfo},e.prototype.get_includeIds=function(){return this.includeIds},e.prototype.get_preAuthenticated=function(){return this.preAuthenticated},e.prototype.get_toAddToPublicCacheDict=function(){return this.toAddToPublicCacheDict},e.prototype.get_toAddToHtmlElementDict=function(){return this.toAddToHtmlElementDict},e.prototype.get_listContainers=function(){return this.listContainers},e.prototype.get_graphDomTree=function(){return this.graphDomTree},e.prototype.get_graphNodePath=function(){return this.graphNodePath},e.prototype.get_elementToGraphNode=function(){return this.elementToGraphNode},e.prototype.get_domElementToHierarchy=function(){return this.domElementToHierarchy},e.prototype.createElement=function(e){return e?(0,U.m)(new aA(mt.h.create().toString()),{tagName:e}):null},e.prototype.createCommentElement=function(e){return aA.createCommentDomElement(e)},e.prototype.bindToContainer=function(e){},e.prototype.bindToRoot=function(t,n){void 0===n&&(n=!1);var i=L.AFrameworkApplication.requestedLcid,r=LT.lcidToCultureName(i),a=cA.createTraverser(t,e._roleOrder);if(n){var l=this._viewElementCreator.createViewElementForGraphNode(this,a.get_iterator());return r&&l.get_htmlElement().get_attributes().set_item("lang",r),void(this.get_ownerDocument().documentElement=l.get_htmlElement())}for(this.get_ownerDocument().documentElement=this.createElement("html"),r?this.get_ownerDocument().documentElement.get_attributes().set_item("lang",r):S.ULS.sendTraceTag(20248459,339,15,"Lang={0} is invalid.",i);a.moveNext();){var s=a.get_currentNode(),u=null;try{var c=e.GetIdFromNode(s);if(!this.get_graphDomTree().containsKey(c)){u=a.get_iterator().get_parentNode();var d=a.get_iterator().getChildCount();if(19===s.get_type()&&1===d){var g=a.get_iterator().goToFirstChild();59===g.get_type()&&this._viewElementCreator.isVideoMediaType(g)?s=g:a.get_iterator().goToNextSiblingOrReturnToParent()}var p=this._viewElementCreator.createViewElementForGraphNode(this,a.get_iterator());if(p)this.AddViewElementToHtmlDocument(s,u,p,a.get_iterator()),this.AddSplitImage(p);else{var h=e.GetIdFromNode(u),_=u?this.get_graphDomTree().get_item(h):null;this.get_graphDomTree().add(c,_)}}if(n)break}catch(e){S.ULS.sendTraceTag(20248461,339,15,"NodeType={0}, ParentNodeType={1}, Exception={2}",s.get_type(),u?u.get_type():-1,e);var m=String.format("Processing {0} failed",s.get_runtimeClassId()),f=new UT(this,s,m);this.AddViewElementToHtmlDocument(s,u,f,a.get_iterator())}}this.splitImageViewBuilder.build(),this.ShouldIncludeMathJax()&&this.AddMathJaxScriptElement(),e.ShouldIncludePageMetadata()&&this.AddPageMetadata(t),lA.resolve(this.get_ownerDocument().documentElement,this.get_domElementToHierarchy(),o.i(this,this.createElement,"createElement"))},e.prototype.getGraphNodePath=function(e){return this.get_graphNodePath().containsKey(e)?this.get_graphNodePath().get_item(e):null},e.prototype.ShouldIncludeMathJax=function(){return!1},e.prototype.AddMathJaxScriptElement=function(){var e=this.GetHeadElement();if(e){var t=this.createElement("script");t.get_attributes().set_item("type","text/javascript"),t.get_attributes().set_item("src",""),t.canSelfEnd=!1,e.AddChild(t)}else S.ULS.sendTraceTag(20248463,339,15,"Could not add MathJax script, no head element found.")},e.prototype.GetHeadElement=function(){for(var e=null,t=this.get_ownerDocument().documentElement.get_children().$$lge();t.$$mn();){var n=t.$$cu();"head"===Rn.l.toLower(n.tagName)&&(e=n)}return e},e.prototype.AddSplitImage=function(e){var t=(0,y.e)(RT,e);t&&t.isSplitPiece()&&this.splitImageViewBuilder.addImage(t);var n=(0,y.e)(MT,e);n&&n.isPrintout()&&this.splitImageViewBuilder.addFile(n)},e.prototype.AddPageMetadata=function(e){if(e){this.GetHeadElement();$s.PageReader.get_instance().isPageNode(e)||S.ULS.sendTraceTag(20248465,339,15,"Could not add PageMetadata, Page node was not given.")}},e.prototype.getHtmlElementForGraphNode=function(e){return this.get_graphDomTree().containsKey(e)&&this.get_graphDomTree().get_item(e)?this.get_graphDomTree().get_item(e).get_htmlElement():null},e.prototype.getOwnerGraphNode=function(e){return this.get_elementToGraphNode().containsKey(e.get_elementId())?this.get_elementToGraphNode().get_item(e.get_elementId()):null},e.prototype.AddViewElementToHtmlDocument=function(t,n,i,r){var o=e.GetIdFromNode(n),a=n?this.get_graphDomTree().get_item(o):null,l=a?a.get_htmlElement():this.get_ownerDocument().documentElement;i.AddToHtmlDocument(l);var s=new ha.g,u=VT.GetListInfoForBareContentInsideAList(t,s);if(u){var c=VT.RemoveContentThatBelongsToAList(l);i.GetContainingList(s,u,l).AddChild(c)}var d=e.GetIdFromNode(t);if(this.get_graphDomTree().add(d,i),this.get_saveGraphNodePathInfo()){var g=new ha.g;g.setFrom(r),this.get_graphNodePath().containsKey(d)||this.get_graphNodePath().add(d,g),this.get_elementToGraphNode().containsKey(i.get_htmlElement().get_elementId())||this.get_elementToGraphNode().add(i.get_htmlElement().get_elementId(),t)}},e.prototype.constructUrl=function(e,t){return this._uriBuilder?this._uriBuilder.buildResourceUri(e,t):""},e.buildPageHtmlViewWithDefaultDependencies=function(){return new e(new oA,null)},e.ShouldIncludePageMetadata=function(){return!0},e.GetIdFromNode=function(e){return(0,y.e)(wi.n,e)?"GraphSpaceNode":e?e.get_id().toString():"NullNode"},e._roleOrder=[50,2,4,5,1],e}();(0,o.l)(gA,"6b3c802d$PageHtmlView",null,[kT,NT]);var pA=function(){function e(){}return e.prototype.generateHtmlFromNode=function(e){var t=gA.buildPageHtmlViewWithDefaultDependencies();return t.bindToRoot(e),DT.toHtml(t.get_ownerDocument())},e.prototype.generateHtmlFromSingleNode=function(e){var t=gA.buildPageHtmlViewWithDefaultDependencies();t.bindToRoot(e,!0);var n,i,r=DT.toHtml(t.get_ownerDocument());do{n=r.length,i=(r=r.replace("![endif] --\x3e\r\n","![endif] --\x3e").replace("![endif] --\x3e\n","![endif] --\x3e").replace("![endif] --\x3e\r","![endif] --\x3e")).length}while(n!==i);var o=r.length;return o>0&&"\n"===r.charAt(o-1)?r.substr(0,o-1):r},e}();(0,o.l)(pA,"f6657027$PageHtmlGenerator",null,[yT.p]);var hA=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.PageHtmlRecall"},e.prototype.configure=function(e){e.register(pA).as(yT.p).singleInstance().usingFactory((function(){return new pA}))},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(hA,"e5c00eaf$OneNotePageHtmlRecallPackage",null,[s.u,u.s]);var _A=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,v.t)(t,e),t.prototype.clearColumnWidth=function(e,t){var n=us.TableReader.getColumnCount(e);Cm.clearColumnWidth_TableLockedColumnsProperty(e,t,n)},t.prototype.setTableAltTextDescription=function(e,t){t&&e.setValue(is.b.imageAltText,t)},t.prototype.setTableAltTextTitle=function(e,t){t&&e.setValue(rs.o.imageTitle,t)},t}(Cm);(0,o.l)(_A,"f856f666$TableEditor",Cm,[]);var mA=function(){function e(){}return e.configure=function(e){e.register(_A).as(au.z).singleInstance().usingFactory((function(){return new _A(e.resolve(zl.a),e.resolve(ql.p))}))},e}();(0,o.l)(mA,"2f81433e$OneNoteTableEditorsComponentConfiguration",null,[]);var fA=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.TableEditors"},e.prototype.configure=function(e){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TableEditorsDelayInitializationEnabled")&&mA.configure(e)},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(fA,"de2404af$OneNoteTableEditorsPackage",null,[s.u,u.s]);var yA=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.TextLevelEditors"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(yA,"880612f$OneNoteTextLevelEditorsPackage",null,[s.u,u.s]);window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_InsightsMenu",Width:"320"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]};var CA=(0,o.y)("81a002e$IInsightsSelection"),SA=n(3889),bA=(0,o.y)("b4221ddd$IInsightsManager"),vA=function(){function e(){}return e.panePosition=1,e.taskPaneID="InsightsTaskPane",e.taskPaneResourceID="InsightsTaskPaneData",e.iFrameElementID="InsightsContentFrame",e.width=320,e.messageApplicationPropertiesRequest="ApplicationPropertiesRequest",e.messageSelectionRequest="SelectionRequest",e.messagePageRendered="PageRendered",e.messageApplicationProperties="ApplicationProperties",e.messageSelection="Selection",e.messageNewInsightsRequest="NewInsightsRequest",e.messageTelemetry="Telemetry",e.messageTakeFocus="TakeFocus",e.messageLostFocus="LostFocus",e.messageKeyboard="Keyboard",e.messageLegalAgreed="LegalAgreed",e.wordWacAppName="WordWac",e.oneNoteWacAppName="OneNoteWAC",e.parentalControlYes="yes",e.telemetryFieldAppCorrelationId="appCorrelationId",e.telemetryFieldClientCorrelationId="clientCorrelationId",e.telemetryFieldMessage="message",e.legalAgreedStorageKey="Microsoft::Office::Insights::LegalAgreed",e}();(0,o.l)(vA,"fde3feca$InsightsConstants",null,[]);var TA=function(){function e(e,t,n,i){this._insightsManager=null,this._actionManager=null,this._focusManager=null,this._f6Manager=null,this._insightsManager=e,this._actionManager=t||L.AFrameworkApplication.get_theActionManager(),this._f6Manager=n,this._focusManager=i,this.InitializeFocusScopesAndF6Management()}return e.prototype.registerActions=function(){this._actionManager.addActionWithFlags(Fe.b.insights,Ue.m.frame,o.i(this,this.ShowInsights,"ShowInsights"),64),this._actionManager.addActionWithFlags(Fe.b.insightsForTellMe,Ue.m.frame,o.i(this,this.ShowInsightsForTellMe,"ShowInsightsForTellMe"),64),this._actionManager.addActionWithFlags(Fe.b.definitions,Ue.m.frame,o.i(this,this.ShowDefinitions,"ShowDefinitions"),64),this._actionManager.addActionWithFlags(Fe.b.definitionsForTellMe,Ue.m.frame,o.i(this,this.ShowDefinitionsForTellMe,"ShowDefinitionsForTellMe"),64)},e.prototype.ShowInsights=function(t,n,i,r,o){if(1===i)return this._insightsManager.get_value().isInsightsAvailableForSelection()?32:8;var a=e.GetAppCorrelationId(),l=this._insightsManager.get_value().getInsightsSelection();return this.ExecuteShowInsights(o,l,a,0)},e.prototype.ShowDefinitions=function(t,n,i,r,o){if(1===i)return this._insightsManager.get_value().isInsightsAvailableForSelection()?32:8;var a=e.GetAppCorrelationId(),l=this._insightsManager.get_value().getInsightsSelection();return this.ExecuteShowInsights(o,l,a,1)},e.prototype.ShowInsightsForTellMe=function(e,t,n,i,r){return 1===n?32:this.ExecuteShowInsightsForTellMe(r,0)},e.prototype.ShowDefinitionsForTellMe=function(e,t,n,i,r){return 1===n?32:this.ExecuteShowInsightsForTellMe(r,1)},e.prototype.ExecuteShowInsightsForTellMe=function(t,n){var i,r=e.GetAppCorrelationId(),o=t.CommandValueId;try{i=x.x.deserialize(o)}catch(t){return S.ULS.sendTraceTag(6295941,1303,15,e.FormatTraceMessage(String.format("Insights parameters [{0}] is not in proper format.",o),r)),8}return this.ExecuteShowInsights(t,i,r,n)},e.prototype.ExecuteShowInsights=function(t,n,i,r){var o=t?t.SourceControlId:"shortcut";return S.ULS.sendTraceTag(6403776,1303,50,e.FormatTraceMessage("Show insights",i,{controlId:o})),this._insightsManager.get_value().showInsightsPane(n,i,r),32},e.prototype.InitializeFocusScopesAndF6Management=function(){var e=this._focusManager.getScope(vA.taskPaneID);e.parent=Pe.AFrame.mainAppFocusId,e.addSetFocus(o.i(this,this.SendIFrameTakeFocusMessage,"SendIFrameTakeFocusMessage")),this._f6Manager.addF6KeyBindings(vA.taskPaneID)},e.prototype.SendIFrameTakeFocusMessage=function(e,t){document.activeElement.blur(),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactTaskPaneInfrastructureEnabled()||(this._insightsManager.get_value().setFocusOnPane(),this._insightsManager.get_value().sendInsightsIFrameTakeFocusMessage())},e.prototype.dispose=function(){this._insightsManager.get_value()&&this._insightsManager.get_value().dispose()},e.FormatTraceMessage=function(e,t,n){void 0===n&&(n=null);var i={appCorrelationId:t,message:e};if(n)for(var r in n){var o={key:r,value:n[r]};i[o.key]=o.value}return x.x.serialize(i)},e.GetAppCorrelationId=function(){return ai.l.create().toString()},e}();(0,o.l)(TA,"79dabdac$InsightsActor",null,[Sys.IDisposable]);var AA=n(8255),IA=function(){function e(){this._container=null,this._actor=null}return e.prototype.get_name=function(){return"Common.App.Insights"},e.prototype.configure=function(e){this._container=e,e.register(TA).singleInstance().usingFactory((function(){return new TA(e.resolveLazy(bA),L.AFrameworkApplication.get_theActionManager(),AA.F6Manager.get_instance(),St.FocusManager.instance())}))},e.prototype.init=function(){L.AFrameworkApplication.insightsIsEnabled&&(this._actor=this._container.tryResolve(TA),this._actor.registerActions())},e.prototype.dispose=function(){this._actor&&this._actor.dispose()},e}();(0,o.l)(IA,"c7ee6ddd$InsightsPackage",null,[s.u,u.s]);var wA=function(){function e(){this._insightsPane=null}return e.prototype.showInsightsPane=function(e,t,n){this._insightsPane||(this._insightsPane=this.createInsightsPane()),this._insightsPane.showPane(e,t,n)},e.prototype.sendInsightsIFrameTakeFocusMessage=function(){this._insightsPane&&this._insightsPane.sendIFrameTakeFocusMessage()},e.prototype.setFocusOnPane=function(){this._insightsPane&&this._insightsPane.setFocusOnIFrame()},e.prototype.dispose=function(){this._insightsPane&&(this._insightsPane.dispose(),this._insightsPane=null)},e}();(0,o.l)(wA,"d176014$InsightsManager",null,[bA,Sys.IDisposable]);var xA=(0,o.y)("5ef123f4$IInsightsPane"),EA=function(){return function(e){this.messageType=null,this.messageType=e}}();(0,o.l)(EA,"fe58e50c$InsightsMessage",null,[]);var FA=function(e){function t(n,i,r){var a=this;return o.m(a,t.$$(n)),a.messageContent=o.c(o.f(a,"Common.App.Insights.InsightsMessageWithContent$1").T),(a=e.call(this,i)||this).messageContent=r,a}return(0,v.t)(t,e),t.$$=function(e){return o.o("Common.App.Insights.InsightsMessageWithContent$1",t,[{T:e}],EA,[],{})},t}(EA),PA=function(){return function(){}}();(0,o.l)(PA,"854a62c5$InsightsMessageContentAppProperties",null,[]);var DA=function(e){function t(t){return e.call(this,PA,vA.messageApplicationProperties,t)||this}return(0,v.t)(t,e),t}(FA);(0,o.l)(DA,"4659988c$InsightsMessageAppProperties",FA.$$(PA),[]);var RA=function(){return function(){this.neighborhood=null,this.mentionStart=0,this.mentionLength=0}}();(0,o.l)(RA,"83f996bd$InsightsParameters",null,[]);var MA=function(e){function t(t){return e.call(this,RA,vA.messageSelection,t)||this}return(0,v.t)(t,e),t}(FA);(0,o.l)(MA,"481b56c$InsightsMessageSelection",FA.$$(RA),[]);var kA=function(e){function t(){return e.call(this,vA.messageTakeFocus)||this}return(0,v.t)(t,e),t}(EA);(0,o.l)(kA,"72babf1b$InsightsMessageTakeFocus",EA,[]);var NA=function(){function e(){}return e.getSmartLookupPaneSrcUrl=function(){switch(e.GetEndpointForAudience()){case"INT":return"https://uci.officeapps.live-int.com/OfficeInsights/Agave/Web/main_native_wac.cshtml?isBrowserPane";case"EDOG":return"https://uci.edog.officeapps.live.com/OfficeInsights/Agave/Web/main_native_wac.cshtml?isBrowserPane";case"PROD":default:return"https://uci.officeapps.live.com/OfficeInsights/Agave/Web/main_native_wac.cshtml?isBrowserPane"}},e.GetEndpointForAudience=function(){switch((0,y.e)(String,L.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case"Dogfood":if(L.AFrameworkApplication.appSettingsManager){var e=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName");e=Rn.l.toLower(e);var t=L.AFrameworkApplication.appSettingsManager.containsAppSetting("SmartLookupINTEnabledForSKITeam")?L.AFrameworkApplication.appSettingsManager.getListAppSetting("SmartLookupINTEnabledForSKITeam"):new Array(0);return Array.indexOf(t,e)>=0?L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmartLookupEnableEdogSourceLocationOverride")?"EDOG":"INT":"EDOG"}return"EDOG";case"Microsoft":case"Production":default:return"PROD"}},e}();(0,o.l)(NA,"e24a4330$InsightsUtils",null,[]);var LA=function(){function e(e,t,n,i){this._taskPane=null,this._insightsPaneHandler=null,this._innerIFrame=null,this._insightsParameters=null,this._appCorrelationId=null,this._clientCorrelationId=null,this._paneIsRendered=!1,this._f6Manager=null,this._focusManager=null,this._ariaNotifier=null,this._defaultInsightsPane=0,this._iFrameSrcInsights=null,this._insightsPaneHandler=e,this.BuildTaskPane(),this.RegisterIFrameEvents(),this._f6Manager=t,this._focusManager=n,this._ariaNotifier=i,this._defaultInsightsPane=0,this._iFrameSrcInsights=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmartLookupEnableNativePane")?NA.getSmartLookupPaneSrcUrl():L.AFrameworkApplication.insightsUrl}return e.prototype.BuildTaskPane=function(){var e=this;this._taskPane=this._insightsPaneHandler.createTaskPaneInstance(),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactTaskPaneInfrastructureEnabled()&&this._taskPane.registerOnTaskPaneShown((function(t){t===e._taskPane&&(e.setFocusOnIFrame(),e.sendIFrameTakeFocusMessage())}));var t=this._taskPane.get_stretchedGroup().get_bodyElement();this.InitializeIFrame(t),this._taskPane.pollForStateAndUpdate()},e.prototype.InitializeIFrame=function(e){e.style.overflow="hidden";var t=fr.n.createElement("iframe");Sys.UI.DomElement.addCssClass(t,"InsightsPaneIFrame"),t.setAttribute("Unselectable","off"),this._innerIFrame=t,e.appendChild(this._innerIFrame),this._innerIFrame.id=vA.iFrameElementID},e.prototype.RegisterIFrameEvents=function(){wo.n.addHandler(this._innerIFrame,"load",o.i(this,this.OnIFrameLoad,"OnIFrameLoad")),wo.n.addHandler(this._innerIFrame,"error",o.i(this,this.OnIFrameError,"OnIFrameError")),$addHandler(window,"message",o.i(this,this.OnIFrameMessage,"OnIFrameMessage"))},e.prototype.UnregisterIFrameEvents=function(){wo.n.removeHandler(this._innerIFrame,"load",o.i(this,this.OnIFrameLoad,"OnIFrameLoad")),wo.n.removeHandler(this._innerIFrame,"error",o.i(this,this.OnIFrameError,"OnIFrameError")),$removeHandler(window,"message",o.i(this,this.OnIFrameMessage,"OnIFrameMessage"))},e.prototype.dispose=function(){this._innerIFrame&&(this.UnregisterIFrameEvents(),this._innerIFrame.parentNode.removeChild(this._innerIFrame),this._innerIFrame=null),this._taskPane&&(this._insightsPaneHandler.disposeTaskPane(this._taskPane),this._taskPane=null)},e.prototype.showPane=function(t,n,i){this._appCorrelationId=n,this._clientCorrelationId=null,this._defaultInsightsPane=i,this._paneIsRendered=!1,S.ULS.sendTraceTag(6295947,1303,50,this.FormatTraceMessage("Start to show Insights")),this._insightsParameters=t,this._iFrameSrcInsights&&this._iFrameSrcInsights.length?this._innerIFrame.src=this._iFrameSrcInsights:(this._innerIFrame.src=e.NullIFrameSrc,S.ULS.sendTraceTag(6295948,1303,15,this.FormatTraceMessage("The Insights URL config setting is null or empty"))),this._ariaNotifier.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0),this._taskPane.get_isTaskPaneVisible()||(this._insightsPaneHandler.showTaskPane(this._taskPane),this._taskPane.registerOnTaskPaneHidden(o.i(this,this.OnInsightsTaskPaneHidden,"OnInsightsTaskPaneHidden"))),this._taskPane.pollForStateAndUpdate()},e.prototype.sendIFrameTakeFocusMessage=function(){this._innerIFrame.src===this._iFrameSrcInsights&&this._paneIsRendered&&(this._focusManager.setScope(vA.taskPaneID),this.PostMessageToIFrame(new kA))},e.prototype.setFocusOnIFrame=function(){this._innerIFrame&&St.FocusManager.tryFocus(this._innerIFrame.contentWindow)},e.prototype.DeallocateSpaceForPaneContents=function(){this._innerIFrame.src=e.NullIFrameSrc,this._taskPane.refreshInternal()},e.prototype.hidePane=function(){this._insightsPaneHandler.hideTaskPane(this._taskPane),this.DeallocateSpaceForPaneContents()},e.prototype.OnInsightsTaskPaneHidden=function(e){e===this._taskPane&&this.hidePane()},e.prototype.OnIFrameLoad=function(e){S.ULS.sendTraceTag(6295951,1303,50,this.FormatTraceMessage("The iframe is successfully loaded in Insights task pane"))},e.prototype.OnIFrameError=function(e){S.ULS.sendTraceTag(6295952,1303,15,this.FormatTraceMessage("The iframe failed to load in Insights task pane"))},e.prototype.OnIFrameMessage=function(e){var t=e.rawEvent;if(t.source===this._innerIFrame.contentWindow){var n;try{n=x.x.deserialize(t.data)}catch(e){return void S.ULS.sendTraceTag(6295953,1303,15,this.FormatTraceMessage("Message data [{0}] failed to deserialize.",t.data))}if(_r.n.isNullOrUndefined(n.messageType))S.ULS.sendTraceTag(6295954,1303,15,this.FormatTraceMessage("Message data [{0}] is in wrong format.",t.data));else switch(n.messageType){case vA.messageApplicationPropertiesRequest:this.PostMessageToIFrame(new DA(this.GetInsightsApplicationProperties()));break;case vA.messageSelectionRequest:this.PostMessageToIFrame(new MA(this._insightsParameters));break;case vA.messagePageRendered:this._paneIsRendered=!0,this.setFocusOnIFrame(),this.sendIFrameTakeFocusMessage(),S.ULS.sendTraceTag(6295955,1303,50,this.FormatTraceMessage("Insights pane rendering is completed"));break;case vA.messageTelemetry:var i=n.messageContent;this._clientCorrelationId=i.clientCorrelationId,this._appCorrelationId!==i.appCorrelationId&&S.ULS.sendTraceTag(6403778,1303,15,this.FormatTraceMessage("App correlation ID on client {0} does not match one on server {1}",this._appCorrelationId,i.appCorrelationId));break;case vA.messageLostFocus:n.messageContent?(W.y.get_isFirefox()&&document.activeElement.blur(),this._f6Manager.handleF6Shift(0,null,2,null,null),S.ULS.sendTraceTag(6604741,1303,50,this.FormatTraceMessage("Insights UX lost focus through Ctrl + Shift + F6"))):(this._f6Manager.handleF6(0,null,2,null,null),S.ULS.sendTraceTag(6604742,1303,50,this.FormatTraceMessage("Insights UX lost focus through Ctrl + F6")));break;case vA.messageKeyboard:(i=n.messageContent).keyCode===Re.v.vK_Esc&&this.hidePane();break;case vA.messageLegalAgreed:try{this._paneIsRendered=!1,localStorage.setItem(vA.legalAgreedStorageKey,"true")}catch(e){S.ULS.sendTraceTag(17961859,1303,10,this.FormatTraceMessage("Failed to SetItem in LocalStorage for LegalAgreed"))}}}},e.prototype.GetInsightsApplicationProperties=function(){var e={anid:"00000000-0000-0000-0000-000000000000"};e.appCorrelationId=this._appCorrelationId,3===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()?e.applicationName=vA.wordWacAppName:4===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()&&(e.applicationName=vA.oneNoteWacAppName),e.applicationVersion=L.AFrameworkApplication.buildVersion;var t=Ft.i.getCultureInfo(L.AFrameworkApplication.lcid),n=t?t.get_name():null;return e.market=this.GetCountryOrRegionCode(n),e.uiLanguage=n,e.sessionId=L.AFrameworkApplication.userSessionId,e.parentalControl=vA.parentalControlYes,e.clientType="user",e.legalAgreed=this.GetLegalAgreed(),e.defaultDefineTab=1===this._defaultInsightsPane?"true":null,e},e.prototype.GetCountryOrRegionCode=function(e){var t=e.split("-");return t[t.length-1]},e.prototype.FormatTraceMessage=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i={};return this._appCorrelationId&&(i[vA.telemetryFieldAppCorrelationId]=this._appCorrelationId),this._clientCorrelationId&&(i[vA.telemetryFieldClientCorrelationId]=this._clientCorrelationId),i[vA.telemetryFieldMessage]=String.format.apply(null,[e].concat(t)),x.x.serialize(i)},e.prototype.GetLegalAgreed=function(){try{var e=localStorage.getItem(vA.legalAgreedStorageKey);return!!e&&"true"===e}catch(e){return S.ULS.sendTraceTag(17961860,1303,10,this.FormatTraceMessage("Failed to GetItem in LocalStorage for LegalAgreed")),!1}},e.prototype.PostMessageToIFrame=function(e){var t=x.x.serialize(e);this._innerIFrame.contentWindow.postMessage(t,Oe.n.getOrigin(this._iFrameSrcInsights))},e.NullIFrameSrc="about:blank",e}();(0,o.l)(LA,"13c4729d$InsightsPane",null,[xA,Sys.IDisposable]);var BA=(0,o.y)("63200f2c$IInsightsPaneHandler"),OA=n(1399),UA=function(){function e(){}return e.prototype.createTaskPaneInstance=function(){var e=new it.CuiHelper(Wy.f.box4ImageBase,Box4Intl.Box4Strings);return OA.a.get_instance().createTaskPaneFromResource(vA.taskPaneID,vA.panePosition,vA.width,vA.taskPaneResourceID,e)},e.prototype.showTaskPane=function(e){OA.a.get_instance().showTaskPane(e)},e.prototype.hideTaskPane=function(e){OA.a.get_instance().hideTaskPane(e)},e.prototype.disposeTaskPane=function(e){OA.a.get_instance().disposeTaskPane(vA.taskPaneID,e)},e}();(0,o.l)(UA,"4c48595a$Box4InsightsPaneHandler",null,[BA]);var HA=function(e){function t(t){var n=e.call(this)||this;return n._selection=null,n._selection=t,n}return(0,v.t)(t,e),t.prototype.createInsightsPane=function(){return new LA(new UA,AA.F6Manager.get_instance(),St.FocusManager.instance(),Ge.w.get_instance().resolve(na.u))},t.prototype.getInsightsSelection=function(){return this._selection.getSelectedText()},t.prototype.isInsightsAvailableForSelection=function(){return this._selection.isCurrentSelectionValidForInsights()},t}(wA);(0,o.l)(HA,"9797946b$Box4InsightsManager",wA,[]);var GA=function(){function e(e){void 0===e&&(e=2e3),this._maxLength=0,this._maxLength=e}return e.prototype.isCurrentSelectionValidForInsights=function(){var t=e.GetCurrentSelection();return this.isValidForInsights(t)},e.prototype.isValidForInsights=function(e){return this.GetSelectedTextFromSelection(e).mentionLength>0},e.prototype.getSelectedText=function(){var t=e.GetCurrentSelection();return this.GetSelectedTextFromSelection(t)},e.prototype.GetSelectedTextFromSelection=function(e){if(e&&e.get_containsSingleContext()&&ga.SelectionEditor.isInsertionPointContext(e.get_firstContext())&&ga.SelectionEditor.isSelectionExpandableToWord(e.get_firstContext())&&(S.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),e=ga.SelectionEditor.expandSelectionToWordBoundary(e.get_firstContext(),!1)),!e)return(0,U.m)(new RA,{neighborhood:"",mentionStart:0,mentionLength:0});for(var t=new Sys.StringBuilder,n=0,i=0,r=[],o=e.get_length(),a=0;a<o;a++){var l=e.get_item(a);if(Ga.ParagraphReader.isParagraphNode(l.get_node())&&!Array.contains(r,l.get_node().get_uniqueKey())){r.push(l.get_node().get_uniqueKey());var s=Ga.ParagraphReader.text(l.get_node()),u=a===o-1;a||-1===l.get_cpBegin()||(n=l.get_cpBegin()),i+=u&&-1!==l.get_cpEnd()?l.get_cpEnd():s.length,t.append(s),u||(t.append(" "),i++)}}for(var c=cs.AParagraphNode.removeObjectSymbols(t.toString()," ");n<i&&Rn.l.isWhitespace(c.charCodeAt(n));)n++;for(;i>n&&Rn.l.isWhitespace(c.charCodeAt(i-1));)i--;return this.AdjustSelectionToMaxLength(c,n,i)},e.prototype.AdjustSelectionToMaxLength=function(e,t,n){if(e.length>this._maxLength){var i=n-t;if(i>this._maxLength)e=e.substr(t,this._maxLength),n=this._maxLength,t=0;else{var r=this._maxLength-i,o=Math.max(t-Math.floor(r/2),0),a=Math.min(n+Math.floor(r/2),e.length);a=Math.min(o+this._maxLength,e.length),t-=o=Math.max(a-this._maxLength,0),n-=o,e=e.substring(o,a)}}return(0,U.m)(new RA,{neighborhood:e,mentionStart:t,mentionLength:n-t})},e.GetCurrentSelection=function(){var e=yi.App.get_activeAppFrame().workspace.get_contentView();if(!e)return S.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;var t=e.get_selectionManager();return t&&t.get_selectionCollection()&&t.get_selectionCollection().get_length()?t.get_selectionCollection().get_currentSelection():(S.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)},e}();(0,o.l)(GA,"4aab3658$Box4InsightsSelection",null,[SA.g,CA]);var WA=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.get_name=function(){return"Box4.Insights"},t.prototype.configure=function(t){e.prototype.configure.call(this,t),t.register(GA).as(CA).as(SA.g).singleInstance().usingFactory((function(){return new GA})),t.register(HA).as(bA).singleInstance().usingFactory((function(){return new HA(t.resolve(CA))}))},t}(IA);(0,o.l)(WA,"bb510bc2$Box4InsightsPackage",IA,[]);var VA=function(){function e(){}return e.main=function(){B.o.get_instance().registerPackage(new WA)},e}();(0,o.l)(VA,"f97cce58$Program",null,[]);window.OneNoteJewelRibbonData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Jewel",attrs:{Alt:"STR@L_JewelText",Id:"jewelOneNote",LabelText:"STR@L_JewelText",TextDirection:"STR@L_RibbonOptionTextDirection",Keytip:"STR@l_JewelTextKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewel"},children:[{name:"MenuSection",attrs:{Id:"msJewel",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlJewels"},children:[{name:"Button",attrs:{Alt:"STR@L_CloseMenu",Id:"jbtnBackArrow",Image32by32:"IMGMAP@one@CloseFileMenuOneNote_32x32x32",Command:"0x2F9A3D80"}},{name:"FlyoutAnchor",attrs:{Id:"faInfo",LabelText:"STR@L_Info",Command:"0x2F9A3D80",Keytip:"STR@l_InfoKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelInfo"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Info"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnjOpenInClient",LabelText:"STR@L_EditInOneNote",Description:"STR@L_OpenInRichClientDescription",Image48by48:"IMGMAP@one@OneNote_48x48x32",Command:"0xD5DF198A",Keytip:"STR@l_EditInOneNoteKeytip"}},{name:"Button",attrs:{Id:"btnjCopyToCloud",LabelText:"STR@L_CopyNotebook",Description:"STR@L_CopyToCloudDescription",Image48by48:"IMGMAP@one@Copy_48x48x32",Command:"0x1DD19043",Keytip:"STR@l_CopyNotebookKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faPrint",LabelText:"STR@L_Print",Command:"0x2F9A3D80",Keytip:"STR@l_PrintKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelPrint"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Print"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnPrint",LabelText:"STR@L_Print",Description:"STR@L_PrintDescription",Image48by48:"IMGMAP@one@Print_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faShare",LabelText:"STR@L_Share",Command:"0x2F9A3D80",Keytip:"STR@l_ShareKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelShare"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Share"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnFileSharing",LabelText:"STR@L_ShareWithPeople",Description:"STR@L_ShareWithPeopleDescription",Image48by48:"IMGMAP@one@ShareDoc_48x48x32",Command:"0x3A7DFAA4",Keytip:"STR@l_ShareWithPeopleKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faAbout",LabelText:"STR@L_About",Command:"0x2F9A3D80",Keytip:"STR@l_AboutKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelAbout"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_About"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnjTryOffice",LabelText:"STR@L_TryOffice",Description:"STR@L_TryOfficeDescription",Image48by48:"IMGMAP@one@TryOffice_48x48x32",Command:"0x69B75DF3",Keytip:"STR@l_TryOfficeKeytip"}},{name:"Button",attrs:{Id:"btnjTryMacOffice",LabelText:"STR@L_TryMacOffice",Description:"STR@L_TryMacOfficeDescription",Image48by48:"IMGMAP@one@TryOffice_48x48x32",Command:"0xE8879142",Keytip:"STR@l_TryMacOfficeKeytip"}},{name:"Button",attrs:{Id:"jbtnTermsOfUse",LabelText:"STR@L_TermsOfUse",Description:"STR@L_TermsOfUseDescription",Image48by48:"IMGMAP@one@Info_48x48x32",Command:"0x8C0EBBB3",Keytip:"STR@l_TermsOfUseKeytip"}},{name:"Button",attrs:{Id:"jbtnThirdPartyNotices",LabelText:"STR@l_ThirdPartyNotices",Description:"STR@l_ThirdPartyNoticesDescription",Image48by48:"IMGMAP@one@Info_48x48x32",Command:"0x8458E357",Keytip:"STR@l_ThirdPartyNoticesKeytip"}},{name:"Button",attrs:{Id:"jbtnPrivacy",LabelText:"STR@L_Privacy",Description:"STR@L_PrivacyDescription",Image48by48:"IMGMAP@one@ProtectForm_48x48x32",Command:"0x48091446",Keytip:"STR@l_PrivacyKeytip"}},{name:"Button",attrs:{Id:"jbtnTrustCenter",LabelText:"STR@l_TrustCenter",Description:"STR@l_TrustCenterDescription",Image48by48:"IMGMAP@one@ProtectForm_48x48x32",Command:"0x9A00EB4E",Keytip:"STR@l_TrustCenterKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"AboutInformationMenuSectionDiagnostics",ShowMenuSectionSeparator:"false",DisplayMode:"MenuDiagnostics"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblDiagnostics",LabelText:"STR@L_Diagnostics",Description:"STR@L_DiagnosticsDescription",LabelCss:"padding-bottom: 12px; padding-top: 0px;"}},{name:"TextBox",attrs:{Id:"lblDiagnosticsSessionId",LabelText:"STR@L_DiagnosticsSessionId",QueryCommand:"0xA67B8E1D",ControlCss:"padding-top: 0px; padding-bottom: 0px;"}},{name:"TextBox",attrs:{Id:"lblDiagnosticsBuildVersion",LabelText:"STR@L_DiagnosticsBuild",QueryCommand:"0xE6F12176",ControlCss:"padding-top: 0px;"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faHelp",LabelText:"STR@L_Help",Command:"0x2F9A3D80",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelHelp"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Help"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnHelp",LabelText:"STR@L_HelpButtonTitle",Description:"STR@L_HelpButtonDescription",Image48by48:"IMGMAP@one@OfficeAssistant_48x48x32",Command:"0x56B04A51",Keytip:"STR@l_HelpButtonTitleKeytip"}},{name:"Button",attrs:{Id:"jbtnGiveFeedback",LabelText:"STR@L_GiveFeedback",Description:"STR@L_GiveFeedbackDescription",Image48by48:"IMGMAP@one@GiveFeedback_48x48x32",Command:"0x2FD6BDE0",Keytip:"STR@l_GiveFeedbackKeytip"}},{name:"Button",attrs:{Id:"jbtnReportAbuse",LabelText:"STR@L_ReportAbuse",Description:"STR@L_ReportAbuseDescription",Image48by48:"IMGMAP@one@ReportAbuse_48x48x32",Command:"0xC0F351AE",Keytip:"STR@l_ReportAbuseKeytip"}}]}]}]}]}]}]},{name:"MenuSection",attrs:{Id:"msJewelSecondary",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlJewelSecondary"},children:[{name:"Button",attrs:{Id:"btnjClose",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Keytip:"STR@l_ExitKeytip"}}]}]}]}]}]},window.OneNoteRibbonData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Jewel",attrs:{Alt:"STR@L_JewelText",Id:"jewelOneNote",LabelText:"STR@L_JewelText",TextDirection:"STR@L_RibbonOptionTextDirection",Keytip:"STR@l_JewelTextKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewel"},children:[{name:"MenuSection",attrs:{Id:"msJewel",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlJewels"},children:[{name:"Button",attrs:{Alt:"STR@L_CloseMenu",Id:"jbtnBackArrow",Image32by32:"IMGMAP@one@CloseFileMenuOneNote_32x32x32",Command:"0x2F9A3D80"}},{name:"FlyoutAnchor",attrs:{Id:"faInfo",LabelText:"STR@L_Info",Command:"0x2F9A3D80",Keytip:"STR@l_InfoKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelInfo"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Info"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnjOpenInClient",LabelText:"STR@L_EditInOneNote",Description:"STR@L_OpenInRichClientDescription",Image48by48:"IMGMAP@one@OneNote_48x48x32",Command:"0xD5DF198A",Keytip:"STR@l_EditInOneNoteKeytip"}},{name:"Button",attrs:{Id:"btnjCopyToCloud",LabelText:"STR@L_CopyNotebook",Description:"STR@L_CopyToCloudDescription",Image48by48:"IMGMAP@one@Copy_48x48x32",Command:"0x1DD19043",Keytip:"STR@l_CopyNotebookKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faPrint",LabelText:"STR@L_Print",Command:"0x2F9A3D80",Keytip:"STR@l_PrintKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelPrint"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Print"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnPrint",LabelText:"STR@L_Print",Description:"STR@L_PrintDescription",Image48by48:"IMGMAP@one@Print_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faShare",LabelText:"STR@L_Share",Command:"0x2F9A3D80",Keytip:"STR@l_ShareKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelShare"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Share"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnFileSharing",LabelText:"STR@L_ShareWithPeople",Description:"STR@L_ShareWithPeopleDescription",Image48by48:"IMGMAP@one@ShareDoc_48x48x32",Command:"0x3A7DFAA4",Keytip:"STR@l_ShareWithPeopleKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faAbout",LabelText:"STR@L_About",Command:"0x2F9A3D80",Keytip:"STR@l_AboutKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelAbout"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_About"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnjTryOffice",LabelText:"STR@L_TryOffice",Description:"STR@L_TryOfficeDescription",Image48by48:"IMGMAP@one@TryOffice_48x48x32",Command:"0x69B75DF3",Keytip:"STR@l_TryOfficeKeytip"}},{name:"Button",attrs:{Id:"btnjTryMacOffice",LabelText:"STR@L_TryMacOffice",Description:"STR@L_TryMacOfficeDescription",Image48by48:"IMGMAP@one@TryOffice_48x48x32",Command:"0xE8879142",Keytip:"STR@l_TryMacOfficeKeytip"}},{name:"Button",attrs:{Id:"jbtnTermsOfUse",LabelText:"STR@L_TermsOfUse",Description:"STR@L_TermsOfUseDescription",Image48by48:"IMGMAP@one@Info_48x48x32",Command:"0x8C0EBBB3",Keytip:"STR@l_TermsOfUseKeytip"}},{name:"Button",attrs:{Id:"jbtnThirdPartyNotices",LabelText:"STR@l_ThirdPartyNotices",Description:"STR@l_ThirdPartyNoticesDescription",Image48by48:"IMGMAP@one@Info_48x48x32",Command:"0x8458E357",Keytip:"STR@l_ThirdPartyNoticesKeytip"}},{name:"Button",attrs:{Id:"jbtnPrivacy",LabelText:"STR@L_Privacy",Description:"STR@L_PrivacyDescription",Image48by48:"IMGMAP@one@ProtectForm_48x48x32",Command:"0x48091446",Keytip:"STR@l_PrivacyKeytip"}},{name:"Button",attrs:{Id:"jbtnTrustCenter",LabelText:"STR@l_TrustCenter",Description:"STR@l_TrustCenterDescription",Image48by48:"IMGMAP@one@ProtectForm_48x48x32",Command:"0x9A00EB4E",Keytip:"STR@l_TrustCenterKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"AboutInformationMenuSectionDiagnostics",ShowMenuSectionSeparator:"false",DisplayMode:"MenuDiagnostics"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblDiagnostics",LabelText:"STR@L_Diagnostics",Description:"STR@L_DiagnosticsDescription",LabelCss:"padding-bottom: 12px; padding-top: 0px;"}},{name:"TextBox",attrs:{Id:"lblDiagnosticsSessionId",LabelText:"STR@L_DiagnosticsSessionId",QueryCommand:"0xA67B8E1D",ControlCss:"padding-top: 0px; padding-bottom: 0px;"}},{name:"TextBox",attrs:{Id:"lblDiagnosticsBuildVersion",LabelText:"STR@L_DiagnosticsBuild",QueryCommand:"0xE6F12176",ControlCss:"padding-top: 0px;"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faHelp",LabelText:"STR@L_Help",Command:"0x2F9A3D80",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelHelp"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Help"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnHelp",LabelText:"STR@L_HelpButtonTitle",Description:"STR@L_HelpButtonDescription",Image48by48:"IMGMAP@one@OfficeAssistant_48x48x32",Command:"0x56B04A51",Keytip:"STR@l_HelpButtonTitleKeytip"}},{name:"Button",attrs:{Id:"jbtnGiveFeedback",LabelText:"STR@L_GiveFeedback",Description:"STR@L_GiveFeedbackDescription",Image48by48:"IMGMAP@one@GiveFeedback_48x48x32",Command:"0x2FD6BDE0",Keytip:"STR@l_GiveFeedbackKeytip"}},{name:"Button",attrs:{Id:"jbtnReportAbuse",LabelText:"STR@L_ReportAbuse",Description:"STR@L_ReportAbuseDescription",Image48by48:"IMGMAP@one@ReportAbuse_48x48x32",Command:"0xC0F351AE",Keytip:"STR@l_ReportAbuseKeytip"}}]}]}]}]}]}]},{name:"MenuSection",attrs:{Id:"msJewelSecondary",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlJewelSecondary"},children:[{name:"Button",attrs:{Id:"btnjClose",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Keytip:"STR@l_ExitKeytip"}}]}]}]}]},{name:"Ribbon",attrs:{Id:"OneNote",TeamId:"WAC",CommandStateChanged:"0x4DFA6613",CommandToggleRibbonState:"0xA463BFB3",ImageCheckMark:"IMGMAP@one@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@one@CheckboxUnchecked_16x16x32",ImageDownArrow:"IMGMAP@one@SplitButtonArrow_5x3x32",ImageSideArrow:"IMGMAP@one@SubmenuFlyoutArrow_13x13x32",ImageUpArrow:"IMGMAP@one@RibbonUpArrow_5x3x32",ImagePinButton:"IMGMAP@one@PushpinNormal_16x16x32",ImageUnpinButton:"IMGMAP@one@UpChevron_16x16x32",PinButtonCommand:"0xA463BFB3",PinButtonTooltip:"STR@L_PinRibbonTooltip",UnpinButtonTooltip:"STR@L_UnpinRibbonTooltip",TextDirection:"STR@L_RibbonOptionTextDirection",LabelText:"STR@L_RibbonLabel"},children:[{name:"Tabs",attrs:{Id:"tabs"},children:[{name:"Tab",attrs:{Id:"tabHome",Description:"",Title:"STR@L_TabHome",Keytip:"STR@l_TabHomeKeytip"},children:[{name:"Scaling",attrs:{},children:[{name:"MaxSize",attrs:{Id:"grpUndoRedo.Scaling.MaxSize",GroupId:"grpUndoRedo",Size:"Small"}},{name:"MaxSize",attrs:{Id:"grpClipboard.Scaling.MaxSize",Sequence:"10",GroupId:"grpClipboard",Size:"LargeMedium"}},{name:"MaxSize",attrs:{Id:"grpClipboardWithFormatPainter.Scaling.MaxSize",Sequence:"10",GroupId:"grpClipboardWithFormatPainter",Size:"LargeMedium"}},{name:"MaxSize",attrs:{Id:"grpBasicText.Scaling.MaxSize",Sequence:"20",GroupId:"grpBasicText",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpStyles.Scaling.MaxSize",Sequence:"30",GroupId:"grpStyles",Size:"5style"}},{name:"MaxSize",attrs:{Id:"grpNoteTags.Scaling.MaxSize",Sequence:"40",GroupId:"grpNoteTags",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpSpelling.Scaling.MaxSize",Sequence:"50",GroupId:"grpSpelling",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpFeedback.Scaling.MaxSize",Sequence:"60",GroupId:"grpFeedback",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpDictation.Scaling.MaxSize",Sequence:"110",GroupId:"grpDictation",Size:"Large"}},{name:"Scale",attrs:{Id:"grpClipboard.Scaling.LargeSmall",Sequence:"70",GroupId:"grpClipboard",Size:"LargeSmall"}},{name:"Scale",attrs:{Id:"grpClipboardWithFormatPainter.Scaling.LargeSmall",Sequence:"70",GroupId:"grpClipboardWithFormatPainter",Size:"LargeSmall"}},{name:"Scale",attrs:{Id:"grpStyles.Scaling.4style",Sequence:"80",GroupId:"grpStyles",Size:"4style"}},{name:"Scale",attrs:{Id:"grpStyles.Scaling.3style",Sequence:"90",GroupId:"grpStyles",Size:"3style"}},{name:"Scale",attrs:{Id:"grpStyles.Scaling.MoreOnly",Sequence:"100",GroupId:"grpStyles",Size:"MoreOnly"}}]},{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"grpUndoRedo",Title:"STR@L_GroupUndoRedo",Template:"tmpUndoRedo"},children:[{name:"Controls",attrs:{Id:"ctrlUndoRedo"},children:[{name:"Button",attrs:{Id:"btnUndo",Command:"0xA66C4568",Image16by16:"IMGMAP@one@Undo_16x16x32",LabelText:"STR@L_Undo",TemplateAlias:"undo",Keytip:"STR@l_UndoKeytip"}},{name:"Button",attrs:{Id:"btnRedo",Command:"0xF957BFBE",Image16by16:"IMGMAP@one@Redo_16x16x32",LabelText:"STR@L_Redo",TemplateAlias:"redo",Keytip:"STR@l_RedoKeytip"}}]}]},{name:"Group",attrs:{Id:"grpClipboard",Description:"",Title:"STR@L_GroupClipboard",Template:"tmpClipboard"},children:[{name:"Controls",attrs:{id:"ctrlClipboard"},children:[{name:"Button",attrs:{Id:"fseaPaste",Command:"0x0E249AB3",IsDefinitive:"true",Image16by16:"IMGMAP@one@Paste_16x16x32",Image32by32:"IMGMAP@one@Paste_32x32x32",LabelText:"STR@L_Paste",TemplateAlias:"paste",Keytip:"STR@l_PasteKeytip"}},{name:"Button",attrs:{Id:"fseaCopy",Command:"0xC9ADDC35",IsDefinitive:"true",Image16by16:"IMGMAP@one@Copy_16x16x32",LabelText:"STR@L_Copy",TemplateAlias:"copy",Keytip:"STR@l_CopyKeytip"}},{name:"Button",attrs:{Id:"fseaCut",Command:"0x89A31DE2",IsDefinitive:"true",Image16by16:"IMGMAP@one@Cut_16x16x32",LabelText:"STR@L_Cut",TemplateAlias:"cut",Keytip:"STR@l_CutKeytip"}}]}]},{name:"Group",attrs:{Id:"grpClipboardWithFormatPainter",Description:"",Title:"STR@L_GroupClipboard",Template:"tmpClipboardWithFormatPainter"},children:[{name:"Controls",attrs:{id:"ctrlClipboard"},children:[{name:"Button",attrs:{Id:"fseaPaste",Command:"0x0E249AB3",IsDefinitive:"true",Image16by16:"IMGMAP@one@Paste_16x16x32",Image32by32:"IMGMAP@one@Paste_32x32x32",LabelText:"STR@L_Paste",TemplateAlias:"paste",Keytip:"STR@l_PasteKeytip"}},{name:"Button",attrs:{Id:"fseaCopy",Command:"0xC9ADDC35",IsDefinitive:"true",Image16by16:"IMGMAP@one@Copy_16x16x32",LabelText:"STR@L_Copy",TemplateAlias:"copy",Keytip:"STR@l_CopyKeytip"}},{name:"Button",attrs:{Id:"fseaCut",Command:"0x89A31DE2",IsDefinitive:"true",Image16by16:"IMGMAP@one@Cut_16x16x32",LabelText:"STR@L_Cut",TemplateAlias:"cut",Keytip:"STR@l_CutKeytip"}},{name:"ToggleButton",attrs:{Id:"fseaFormatPainter",Command:"0x9289CA5F",IsDefinitive:"true",QueryCommand:"0x97A875DC",Image16by16:"IMGMAP@one@FormatPainter_16x16x32",Image32by32:"IMGMAP@one@FormatPainter_32x32x32",LabelText:"STR@L_FormatPainter",TemplateAlias:"formatPainter",Keytip:"STR@l_FormatPainterKeytip"}}]}]},{name:"Group",attrs:{Id:"grpBasicText",Description:"",Title:"STR@L_GroupBasicText",Template:"tmpBasicText"},children:[{name:"Controls",attrs:{},children:[{name:"ComboBox",attrs:{Alt:"STR@L_FontName",Id:"fontName",Command:"0xCC7BD8E3",QueryCommand:"0x48F327A5",Width:"100px",TemplateAlias:"font",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0x0AB30E9C",AllowFreeForm:"true",Keytip:"STR@l_FontNameKeytip"}},{name:"ComboBox",attrs:{Alt:"STR@L_FontSize",Id:"fontSize",Command:"0xBFBF8D1A",QueryCommand:"0xE43EEA4E",Width:"30px",TemplateAlias:"fontSize",PopulateDynamically:"true",PopulateOnlyOnce:"true",PopulateQueryCommand:"0x580E32AF",AllowFreeForm:"true",Keytip:"STR@l_FontSizeKeytip"}},{name:"SplitButton",attrs:{Id:"sbBullets",Command:"0xD3C129A1",QueryCommand:"0xE41E1F87",IsToggleSplit:"true",LabelText:"STR@L_MenuBullets",Image16by16:"IMGMAP@one@Bullets_16x16x32",TemplateAlias:"bullets",Keytip:"STR@l_MenuBulletsKeytip"},children:[{name:"Menu",attrs:{Id:"menuBullets"},children:[{name:"MenuSection",attrs:{Id:"msAllBulletStyles",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ctrlBulletStyles"},children:[{name:"ToggleButton",attrs:{Id:"buttonBulletStyle1",MenuItemId:"buttonBulletStyle1",Command:"0xD3C129A1",QueryCommand:"0xDAF74829",Image16by16:"IMGMAP@one@SolidBullet_16x16x32",LabelText:"STR@L_BulletStyle1",Keytip:"STR@l_BulletStyle1Keytip"}},{name:"ToggleButton",attrs:{Id:"buttonBulletStyle2",MenuItemId:"buttonBulletStyle2",Command:"0xD3C129A1",QueryCommand:"0xC2EDA5FA",Image16by16:"IMGMAP@one@HollowBullet_16x16x32",LabelText:"STR@L_BulletStyle2",Keytip:"STR@l_BulletStyle2Keytip"}},{name:"ToggleButton",attrs:{Id:"buttonBulletStyle3",MenuItemId:"buttonBulletStyle3",Command:"0xD3C129A1",QueryCommand:"0x2046315F",Image16by16:"IMGMAP@one@SquareBullet_16x16x32",LabelText:"STR@L_BulletStyle3",Keytip:"STR@l_BulletStyle3Keytip"}}]}]}]}]},{name:"SplitButton",attrs:{Id:"sbNumbering",Command:"0x83E875AA",QueryCommand:"0xCFEC4235",IsToggleSplit:"true",LabelText:"STR@L_MenuNumbering",Image16by16:"IMGMAP@one@Numbering_16x16x32",TemplateAlias:"numbering",Keytip:"STR@l_MenuNumberingKeytip"},children:[{name:"Menu",attrs:{Id:"menuNumbering"},children:[{name:"MenuSection",attrs:{Id:"msAllNumberStyles",DisplayMode:"Menu"},children:[{name:"Controls",attrs:{Id:"ctrlNumberStyles"},children:[{name:"ToggleButton",attrs:{Id:"buttonNumberStyle1",MenuItemId:"buttonNumberStyle1",Command:"0x83E875AA",QueryCommand:"0x028F909B",LabelText:"STR@L_NumberStyle1"}},{name:"ToggleButton",attrs:{Id:"buttonNumberStyle2",MenuItemId:"buttonNumberStyle2",Command:"0x83E875AA",QueryCommand:"0xEA85EE6C",LabelText:"STR@L_NumberStyle2"}},{name:"ToggleButton",attrs:{Id:"buttonNumberStyle3",MenuItemId:"buttonNumberStyle3",Command:"0x83E875AA",QueryCommand:"0x47DE79D1",LabelText:"STR@L_NumberStyle3"}},{name:"ToggleButton",attrs:{Id:"buttonNumberStyle4",MenuItemId:"buttonNumberStyle4",Command:"0x83E875AA",QueryCommand:"0x1A9932CA",LabelText:"STR@L_NumberStyle4"}},{name:"ToggleButton",attrs:{Id:"buttonNumberStyle5",MenuItemId:"buttonNumberStyle5",Command:"0x83E875AA",QueryCommand:"0x77F1BE2F",LabelText:"STR@L_NumberStyle5"}}]}]}]}]},{name:"Button",attrs:{Id:"fseaClearFormatting",Command:"0x8A46CCCC",Image16by16:"IMGMAP@one@ClearFormatting_16x16x32",LabelText:"STR@L_ClearFormatting",TemplateAlias:"clearformat",Keytip:"STR@l_ClearFormattingKeytip"}},{name:"ToggleButton",attrs:{Id:"fsbcBold",Alt:"STR@L_Bold",Command:"0xF6F32311",QueryCommand:"0x575E8BDF",Image16by16:"IMGMAP@one@Bold_16x16x32",TemplateAlias:"bold",Keytip:"STR@l_BoldKeytip"}},{name:"ToggleButton",attrs:{Id:"fsbcItalic",Alt:"STR@L_Italic",Command:"0xD4C1657E",QueryCommand:"0xFC350CA2",Image16by16:"IMGMAP@one@Italic_16x16x32",TemplateAlias:"italic",Keytip:"STR@l_ItalicKeytip"}},{name:"ToggleButton",attrs:{Id:"fsbcUnderline",Alt:"STR@L_Underline",Command:"0x6F0FAAC6",QueryCommand:"0x89383C62",Image16by16:"IMGMAP@one@Underline_16x16x32",TemplateAlias:"underline",Keytip:"STR@l_UnderlineKeytip"}},{name:"ToggleButton",attrs:{Id:"fsbcStrikethrough",Alt:"STR@L_Strikethrough",Command:"0xF87F5805",QueryCommand:"0xA3731E4F",Image16by16:"IMGMAP@one@Strikethrough2Server_16x16x32",LabelText:"STR@L_Strikethrough",TemplateAlias:"strikethrough",Keytip:"STR@l_StrikethroughKeytip"}},{name:"SplitButton",attrs:{Id:"sbSubscript",Alt:"STR@L_Subscript",Command:"0x56BFC40F",LabelText:"STR@L_Subscript",QueryCommand:"0x702E26CB",IsToggleSplit:"true",Image16by16:"IMGMAP@one@Subscript_16x16x32",TemplateAlias:"subscript",Keytip:"STR@l_SubscriptKeytip"},children:[{name:"Menu",attrs:{Id:"menuSubscript"},children:[{name:"MenuSection",attrs:{Id:"msSubscript",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msSubscript.Controls"},children:[{name:"ToggleButton",attrs:{Id:"fsbcSubscript",Command:"0x56BFC40F",QueryCommand:"0xEC0CB24D",Image16by16:"IMGMAP@one@Subscript_16x16x32",LabelText:"STR@L_Subscript",Keytip:"STR@l_SubscriptKeytip"}},{name:"ToggleButton",attrs:{Id:"fsbcSuperscript",Command:"0x0010E69E",QueryCommand:"0x294CD86A",Image16by16:"IMGMAP@one@Superscript_16x16x32",LabelText:"STR@L_Superscript",Keytip:"STR@l_SuperscriptKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"fontColor",Command:"0x568463EB",Image16by16:"IMGMAP@one@FontColorServer_16x16x32",LabelText:"STR@L_MenuFontColor",TemplateAlias:"fontColor",Keytip:"STR@l_MenuFontColorKeytip"},children:[{name:"Menu",attrs:{Id:"menuFontColor"},children:[{name:"MenuSection",attrs:{Id:"fontColor",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"Font.Color.Menu.Controls"},children:[{name:"Button",attrs:{Command:"0xD0232D5B",LabelText:"STR@L_Automatic",Id:"automatic",Image16by16:"IMGMAP@one@Automatic_16x16x32",Keytip:"STR@l_AutomaticKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"Colors"},children:[{name:"Controls",attrs:{Id:"Font.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"fontColor",Command:"0x7577CA82",McuLayout:"true",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"FFFFFF",DisplayColor:"#FFFFFF",Alt:"STR@L_FontColorWhite"}},{name:"Color",attrs:{Color:"000000",DisplayColor:"#000000",Alt:"STR@L_FontColorBlack"}},{name:"Color",attrs:{Color:"E1ECEE",DisplayColor:"#EEECE1",Alt:"STR@L_FontColorTan"}},{name:"Color",attrs:{Color:"7D491F",DisplayColor:"#1F497D",Alt:"STR@L_FontColorDarkBlue"}},{name:"Color",attrs:{Color:"BD814F",DisplayColor:"#4F81BD",Alt:"STR@L_FontColorBlue"}},{name:"Color",attrs:{Color:"4D50C0",DisplayColor:"#C0504D",Alt:"STR@L_FontColorRed"}},{name:"Color",attrs:{Color:"59BB9B",DisplayColor:"#9BBB59",Alt:"STR@L_FontColorOliveGreen"}},{name:"Color",attrs:{Color:"A26480",DisplayColor:"#8064A2",Alt:"STR@L_FontColorPurple"}},{name:"Color",attrs:{Color:"C6AC4B",DisplayColor:"#4BACC6",Alt:"STR@L_FontColorAqua"}},{name:"Color",attrs:{Color:"4696F7",DisplayColor:"#F79646",Alt:"STR@L_FontColorOrange"}},{name:"Color",attrs:{Color:"F2F2F2",DisplayColor:"#F2F2F2",Alt:"STR@L_FontColorWhiteDarker5pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorBlackLighter50pct"}},{name:"Color",attrs:{Color:"C3D9DD",DisplayColor:"#DDD9C3",Alt:"STR@L_FontColorTanDarker10pct"}},{name:"Color",attrs:{Color:"F0D9C6",DisplayColor:"#C6D9F0",Alt:"STR@L_FontColorDarkBlueLighter80pct"}},{name:"Color",attrs:{Color:"F1E5DB",DisplayColor:"#DBE5F1",Alt:"STR@L_FontColorBlueLighter80pct"}},{name:"Color",attrs:{Color:"DBDCF2",DisplayColor:"#F2DCDB",Alt:"STR@L_FontColorRedLighter80pct"}},{name:"Color",attrs:{Color:"DDF1EB",DisplayColor:"#EBF1DD",Alt:"STR@L_FontColorOliveGreenLighter80pct"}},{name:"Color",attrs:{Color:"ECE0E5",DisplayColor:"#E5E0EC",Alt:"STR@L_FontColorPurpleLighter80pct"}},{name:"Color",attrs:{Color:"F3EEDB",DisplayColor:"#DBEEF3",Alt:"STR@L_FontColorAquaLighter80pct"}},{name:"Color",attrs:{Color:"DAEAFD",DisplayColor:"#FDEADA",Alt:"STR@L_FontColorOrangeLighter80pct"}},{name:"Color",attrs:{Color:"D8D8D8",DisplayColor:"#D8D8D8",Alt:"STR@L_FontColorWhiteDarker15pct"}},{name:"Color",attrs:{Color:"595959",DisplayColor:"#595959",Alt:"STR@L_FontColorBlackLighter35pct"}},{name:"Color",attrs:{Color:"97BDC4",DisplayColor:"#C4BD97",Alt:"STR@L_FontColorTanDarker25pct"}},{name:"Color",attrs:{Color:"E2B38D",DisplayColor:"#8DB3E2",Alt:"STR@L_FontColorDarkBlueLighter60pct"}},{name:"Color",attrs:{Color:"E4CCB8",DisplayColor:"#B8CCE4",Alt:"STR@L_FontColorBlueLighter60pct"}},{name:"Color",attrs:{Color:"B7B9E5",DisplayColor:"#E5B9B7",Alt:"STR@L_FontColorRedLighter60pct"}},{name:"Color",attrs:{Color:"BCE3D7",DisplayColor:"#D7E3BC",Alt:"STR@L_FontColorOliveGreenLighter60pct"}},{name:"Color",attrs:{Color:"D9C1CC",DisplayColor:"#CCC1D9",Alt:"STR@L_FontColorPurpleLighter60pct"}},{name:"Color",attrs:{Color:"E8DDB7",DisplayColor:"#B7DDE8",Alt:"STR@L_FontColorAquaLighter60pct"}},{name:"Color",attrs:{Color:"B5D5FB",DisplayColor:"#FBD5B5",Alt:"STR@L_FontColorOrangeLighter60pct"}},{name:"Color",attrs:{Color:"BFBFBF",DisplayColor:"#BFBFBF",Alt:"STR@L_FontColorWhiteDarker25pct"}},{name:"Color",attrs:{Color:"3F3F3F",DisplayColor:"#3F3F3F",Alt:"STR@L_FontColorBlackLighter25pct"}},{name:"Color",attrs:{Color:"538993",DisplayColor:"#938953",Alt:"STR@L_FontColorTanDarker50pct"}},{name:"Color",attrs:{Color:"D48D54",DisplayColor:"#548DD4",Alt:"STR@L_FontColorDarkBlueLighter40pct"}},{name:"Color",attrs:{Color:"D7B395",DisplayColor:"#95B3D7",Alt:"STR@L_FontColorBlueLighter40pct"}},{name:"Color",attrs:{Color:"9496D9",DisplayColor:"#D99694",Alt:"STR@L_FontColorRedLighter40pct"}},{name:"Color",attrs:{Color:"9BD6C3",DisplayColor:"#C3D69B",Alt:"STR@L_FontColorOliveGreenLighter40pct"}},{name:"Color",attrs:{Color:"C7A2B2",DisplayColor:"#B2A2C7",Alt:"STR@L_FontColorPurpleLighter40pct"}},{name:"Color",attrs:{Color:"DCCD92",DisplayColor:"#92CDDC",Alt:"STR@L_FontColorAquaLighter40pct"}},{name:"Color",attrs:{Color:"8FC0FA",DisplayColor:"#FAC08F",Alt:"STR@L_FontColorOrangeLighter40pct"}},{name:"Color",attrs:{Color:"A5A5A5",DisplayColor:"#A5A5A5",Alt:"STR@L_FontColorWhiteDarker35pct"}},{name:"Color",attrs:{Color:"262626",DisplayColor:"#262626",Alt:"STR@L_FontColorBlackLighter15pct"}},{name:"Color",attrs:{Color:"294449",DisplayColor:"#494429",Alt:"STR@L_FontColorTanDarker75pct"}},{name:"Color",attrs:{Color:"5D3617",DisplayColor:"#17365D",Alt:"STR@L_FontColorDarkBlueDarker25pct"}},{name:"Color",attrs:{Color:"926036",DisplayColor:"#366092",Alt:"STR@L_FontColorBlueDarker25pct"}},{name:"Color",attrs:{Color:"343795",DisplayColor:"#953734",Alt:"STR@L_FontColorRedDarker25pct"}},{name:"Color",attrs:{Color:"3C9276",DisplayColor:"#76923C",Alt:"STR@L_FontColorOliveGreenDarker25pct"}},{name:"Color",attrs:{Color:"7A495F",DisplayColor:"#5F497A",Alt:"STR@L_FontColorPurpleDarker25pct"}},{name:"Color",attrs:{Color:"9B8431",DisplayColor:"#31849B",Alt:"STR@L_FontColorAquaDarker25pct"}},{name:"Color",attrs:{Color:"096CE3",DisplayColor:"#E36C09",Alt:"STR@L_FontColorOrangeDarker25pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorWhiteDarker50pct"}},{name:"Color",attrs:{Color:"0C0C0C",DisplayColor:"#0C0C0C",Alt:"STR@L_FontColorBlackLighter5pct"}},{name:"Color",attrs:{Color:"101B1D",DisplayColor:"#1D1B10",Alt:"STR@L_FontColorTanDarker90pct"}},{name:"Color",attrs:{Color:"3E240F",DisplayColor:"#0F243E",Alt:"STR@L_FontColorDarkBlueDarker50pct"}},{name:"Color",attrs:{Color:"614024",DisplayColor:"#244061",Alt:"STR@L_FontColorBlueDarker50pct"}},{name:"Color",attrs:{Color:"232463",DisplayColor:"#632423",Alt:"STR@L_FontColorRedDarker50pct"}},{name:"Color",attrs:{Color:"28614F",DisplayColor:"#4F6128",Alt:"STR@L_FontColorOliveGreenDarker50pct"}},{name:"Color",attrs:{Color:"51313F",DisplayColor:"#3F3151",Alt:"STR@L_FontColorPurpleDarker50pct"}},{name:"Color",attrs:{Color:"675820",DisplayColor:"#205867",Alt:"STR@L_FontColorAquaDarker50pct"}},{name:"Color",attrs:{Color:"064898",DisplayColor:"#984806",Alt:"STR@L_FontColorOrangeDarker50pct"}}]}]}]}]},{name:"MenuSection",attrs:{Id:"fontColor",Title:"STR@L_MenuStandardColors"},children:[{name:"Controls",attrs:{Id:"Font.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"fontColor",Command:"0x7577CA82",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"0000C0",Alt:"STR@L_FontColorDarkRed",DisplayColor:"#C00000"}},{name:"Color",attrs:{Color:"0000FF",Alt:"STR@L_FontColorRed",DisplayColor:"#FF0000"}},{name:"Color",attrs:{Color:"00C0FF",Alt:"STR@L_FontColorOrange",DisplayColor:"#FFC000"}},{name:"Color",attrs:{Color:"00FFFF",Alt:"STR@L_FontColorYellow",DisplayColor:"#FFFF00"}},{name:"Color",attrs:{Color:"50D092",Alt:"STR@L_FontColorLightGreen",DisplayColor:"#92D050"}},{name:"Color",attrs:{Color:"50B000",Alt:"STR@L_FontColorDarkGreen",DisplayColor:"#00B050"}},{name:"Color",attrs:{Color:"F0B000",Alt:"STR@L_FontColorLightBlue",DisplayColor:"#00B0F0"}},{name:"Color",attrs:{Color:"C07000",Alt:"STR@L_FontColorBlue",DisplayColor:"#0070C0"}},{name:"Color",attrs:{Color:"602000",Alt:"STR@L_FontColorDarkBlue",DisplayColor:"#002060"}},{name:"Color",attrs:{Color:"A03070",Alt:"STR@L_FontColorPurple",DisplayColor:"#7030A0"}}]}]}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"fontBackgroundColor",Command:"0x568463EB",Image16by16:"IMGMAP@one@HighlightWithColor_16x16x32",LabelText:"STR@L_MenuHighlightColor",TemplateAlias:"fontBackgroundColor",Keytip:"STR@l_MenuHighlightColorKeytip"},children:[{name:"Menu",attrs:{Id:"menuFontBackgroundColor"},children:[{name:"MenuSection",attrs:{Id:"fontBackgroundColor"},children:[{name:"Controls",attrs:{Id:"Background.Font.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"fontBackgroundColor",Command:"0x6A55FB2A",Width:"5"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"00FFFF",Alt:"STR@L_FontColorYellow",DisplayColor:"#FFFF00"}},{name:"Color",attrs:{Color:"00FF00",Alt:"STR@L_FontColorGreen",DisplayColor:"#00FF00"}},{name:"Color",attrs:{Color:"FFFF00",Alt:"STR@L_FontColorCyan",DisplayColor:"#00FFFF"}},{name:"Color",attrs:{Color:"FF00FF",Alt:"STR@L_FontColorMagenta",DisplayColor:"#FF00FF"}},{name:"Color",attrs:{Color:"FF0000",Alt:"STR@L_FontColorBlue",DisplayColor:"#0000FF"}},{name:"Color",attrs:{Color:"0000FF",Alt:"STR@L_FontColorRed",DisplayColor:"#FF0000"}},{name:"Color",attrs:{Color:"800000",Alt:"STR@L_FontColorDarkBlue",DisplayColor:"#000080"}},{name:"Color",attrs:{Color:"808000",Alt:"STR@L_FontColorDarkCyan",DisplayColor:"#008080"}},{name:"Color",attrs:{Color:"008000",Alt:"STR@L_FontColorDarkGreenHighlight",DisplayColor:"#008000"}},{name:"Color",attrs:{Color:"800080",Alt:"STR@L_FontColorDarkMagenta",DisplayColor:"#800080"}},{name:"Color",attrs:{Color:"000080",Alt:"STR@L_FontColorDarkRed",DisplayColor:"#800000"}},{name:"Color",attrs:{Color:"008080",Alt:"STR@L_FontColorDarkYellow",DisplayColor:"#808000"}},{name:"Color",attrs:{Color:"808080",Alt:"STR@L_FontColorGrey",DisplayColor:"#808080"}},{name:"Color",attrs:{Color:"C0C0C0",Alt:"STR@L_FontColorLightGrey",DisplayColor:"#C0C0C0"}},{name:"Color",attrs:{Color:"000000",Alt:"STR@L_FontColorBlack",DisplayColor:"#000000"}}]}]}]}]},{name:"MenuSection",attrs:{Id:"noFontBackgroundColor",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"No.Background.Font.Color.Menu.Controls"},children:[{name:"Button",attrs:{Command:"0x2184F4E5",Id:"none",LabelText:"STR@L_NoHighlight",Image16by16:"IMGMAP@one@NoHighlight_16x16x32",Keytip:"STR@l_NoHighlightKeytip"}}]}]}]}]},{name:"Button",attrs:{Id:"fseaOutdent",Command:"0xC93B4FD0",QueryCommand:"0x5F5719F6",Image16by16:"IMGMAP@one@Outdent_16x16x32",LabelText:"STR@L_DecreaseIndent",TemplateAlias:"outdent",Keytip:"STR@l_DecreaseIndentKeytip"}},{name:"Button",attrs:{Id:"fseaIndent",Command:"0xF2CCFEC4",QueryCommand:"0x9EFAB6C2",Image16by16:"IMGMAP@one@Indent_16x16x32",LabelText:"STR@L_IncreaseIndent",TemplateAlias:"indent",Keytip:"STR@l_IncreaseIndentKeytip"}},{name:"FlyoutAnchor",attrs:{Id:"faAlignment",Command:"0x568463EB",LabelText:"STR@L_MenuAlignment",Image16by16:"IMGMAP@one@LeftJustify_16x16x32",TemplateAlias:"alignment",Keytip:"STR@l_MenuAlignmentKeytip"},children:[{name:"Menu",attrs:{Id:"menuAlignment"},children:[{name:"MenuSection",attrs:{Id:"msAlignment",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msAlignment.Controls"},children:[{name:"ToggleButton",attrs:{Id:"LeftJustify",Command:"0x9757E6E5",QueryCommand:"0xE25D77A3",Image16by16:"IMGMAP@one@LeftJustify_16x16x32",LabelText:"STR@L_AlignTextLeft",Keytip:"STR@l_AlignTextLeftKeytip"}},{name:"ToggleButton",attrs:{Id:"CenterJustify",Command:"0xFF58B829",QueryCommand:"0xC27E85BB",Image16by16:"IMGMAP@one@Centered_16x16x32",LabelText:"STR@L_JustifyCenter",Keytip:"STR@l_JustifyCenterKeytip"}},{name:"ToggleButton",attrs:{Id:"RightJustify",Command:"0x17730524",QueryCommand:"0x776E8734",Image16by16:"IMGMAP@one@RightJustify_16x16x32",LabelText:"STR@L_AlignTextRight",Keytip:"STR@l_AlignTextRightKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"msAlignmentLTR",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msAlignmentLTR.Controls"},children:[{name:"ToggleButton",attrs:{Id:"TextDirLTR",Command:"0x374EAE00",QueryCommand:"0x44D4414A",Image16by16:"IMGMAP@one@Ltr_16x16x32",LabelText:"STR@L_TextDirLTR",Keytip:"STR@l_TextDirLTRKeytip"}},{name:"ToggleButton",attrs:{Id:"TextDirRTL",Command:"0x9CE9DEE0",QueryCommand:"0x44D43E8A",Image16by16:"IMGMAP@one@Rtl_16x16x32",LabelText:"STR@L_TextDirRTL",Keytip:"STR@l_TextDirRTLKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"msParagraphSpacing",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msParagraphSpacing.Controls"},children:[{name:"FlyoutAnchor",attrs:{Id:"flyLineSpacing",Image16by16:"IMGMAP@one@LineSpacing_16x16x32",LabelText:"STR@L_ParagraphSpacing",Command:"0x84728D66",PopulateDynamically:"true",PopulateOnlyOnce:"true",PopulateQueryCommand:"0xA7F94AB4",TemplateAlias:"lineSpacing",Keytip:"STR@l_LineSpacingKeytip"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpStyles",Description:"",Title:"STR@L_GroupStyles",Template:"tmpStyles"},children:[{name:"Controls",attrs:{},children:[{name:"GalleryButton",attrs:{Id:"buttonStyle0",Command:"0x3E088D63",QueryCommand:"0xBA30CCB1",InnerHTML:"",ElementDimensions:"Size64by48",TemplateAlias:"style0"}},{name:"GalleryButton",attrs:{Id:"buttonStyle1",Command:"0x3E088D63",QueryCommand:"0xBA30CCB1",InnerHTML:"",ElementDimensions:"Size64by48",TemplateAlias:"style1"}},{name:"GalleryButton",attrs:{Id:"buttonStyle2",Command:"0x3E088D63",QueryCommand:"0xBA30CCB1",InnerHTML:"",ElementDimensions:"Size64by48",TemplateAlias:"style2"}},{name:"GalleryButton",attrs:{Id:"buttonStyle3",Command:"0x3E088D63",QueryCommand:"0xBA30CCB1",InnerHTML:"",ElementDimensions:"Size64by48",TemplateAlias:"style3"}},{name:"GalleryButton",attrs:{Id:"buttonStyle4",Command:"0x3E088D63",QueryCommand:"0xBA30CCB1",InnerHTML:"",ElementDimensions:"Size64by48",TemplateAlias:"style4"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_MenuMoreStyles",Id:"fsfaMoreStyles",Command:"0x3E088D63",LabelText:"STR@L_MenuMoreStyles",Image32by32:"IMGMAP@one@UxGalWordQuickFormats_32x32x32",TemplateAlias:"morestyles",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0x289E9560",Keytip:"STR@l_MenuMoreStylesKeytip"}}]}]},{name:"Group",attrs:{Id:"grpNoteTags",Description:"",Title:"STR@L_GroupTags",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpNoteTags.Controls"},children:[{name:"FlyoutAnchor",attrs:{Id:"flyNoteTags",Alt:"STR@L_NoteTags",Image32by32:"IMGMAP@one@NoteTagsServer_32x32x32",LabelText:"STR@L_NoteTags",Command:"0x6C71CE19",TemplateAlias:"button1",Keytip:"STR@l_NoteTagsKeytip"},children:[{name:"Menu",attrs:{Id:"menuNoteTags"},children:[{name:"MenuSection",attrs:{Id:"msNoteTagCommands",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ctrlNoteTagCommands"},children:[{name:"Button",attrs:{Id:"buttonNoteTagRemoveAll",Command:"0x5C016681",Image16by16:"IMGMAP@one@JotActionItemRemoveAll_16x16x32",LabelText:"STR@L_NoteTagRemove",Keytip:"STR@l_NoteTagRemoveKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"msNoteTagInsert",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ctrlNoteTagInsert"},children:[{name:"Button",attrs:{Id:"NT0",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@3_16_M_16x16x32",LabelText:"STR@l_NoteTag_0"}},{name:"Button",attrs:{Id:"NT1",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@13_16_N_16x16x32",LabelText:"STR@l_NoteTag_1"}},{name:"Button",attrs:{Id:"NT2",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@15_16_N_16x16x32",LabelText:"STR@l_NoteTag_2"}},{name:"Button",attrs:{Id:"NT3",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@NoteTagNoShape_16x16x32",LabelText:"STR@l_NoteTag_3"}},{name:"Button",attrs:{Id:"NT4",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@NoteTagNoShape_16x16x32",LabelText:"STR@l_NoteTag_4"}},{name:"Button",attrs:{Id:"NT5",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@136_16_N_16x16x32",LabelText:"STR@l_NoteTag_5"}},{name:"Button",attrs:{Id:"NT6",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@118_16_N_16x16x32",LabelText:"STR@l_NoteTag_6"}},{name:"Button",attrs:{Id:"NT7",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@23_16_N_16x16x32",LabelText:"STR@l_NoteTag_7"}},{name:"Button",attrs:{Id:"NT8",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@18_16_N_16x16x32",LabelText:"STR@l_NoteTag_8"}},{name:"Button",attrs:{Id:"NT9",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@125_16_N_16x16x32",LabelText:"STR@l_NoteTag_9"}},{name:"Button",attrs:{Id:"NT10",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@21_16_N_16x16x32",LabelText:"STR@l_NoteTag_10"}},{name:"Button",attrs:{Id:"NT11",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@131_16_N_16x16x32",LabelText:"STR@l_NoteTag_11"}},{name:"Button",attrs:{Id:"NT12",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@17_16_N_16x16x32",LabelText:"STR@l_NoteTag_12"}},{name:"Button",attrs:{Id:"NT13",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@100_16_N_16x16x32",LabelText:"STR@l_NoteTag_13"}},{name:"Button",attrs:{Id:"NT14",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@101_16_N_16x16x32",LabelText:"STR@l_NoteTag_14"}},{name:"Button",attrs:{Id:"NT15",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@122_16_N_16x16x32",LabelText:"STR@l_NoteTag_15"}},{name:"Button",attrs:{Id:"NT16",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@132_16_N_16x16x32",LabelText:"STR@l_NoteTag_16"}},{name:"Button",attrs:{Id:"NT17",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@121_16_N_16x16x32",LabelText:"STR@l_NoteTag_17"}},{name:"Button",attrs:{Id:"NT18",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@125_16_N_16x16x32",LabelText:"STR@l_NoteTag_18"}},{name:"Button",attrs:{Id:"NT19",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@24_16_N_16x16x32",LabelText:"STR@l_NoteTag_19"}},{name:"Button",attrs:{Id:"NT20",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@94_16_M_16x16x32",LabelText:"STR@l_NoteTag_20"}},{name:"Button",attrs:{Id:"NT21",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@94_16_M_16x16x32",LabelText:"STR@l_NoteTag_21"}},{name:"Button",attrs:{Id:"NT22",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@95_16_M_16x16x32",LabelText:"STR@l_NoteTag_22"}},{name:"Button",attrs:{Id:"NT23",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@106_16_N_16x16x32",LabelText:"STR@l_NoteTag_23"}},{name:"Button",attrs:{Id:"NT24",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@12_16_M_16x16x32",LabelText:"STR@l_NoteTag_24"}},{name:"Button",attrs:{Id:"NT25",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@12_16_M_16x16x32",LabelText:"STR@l_NoteTag_25"}},{name:"Button",attrs:{Id:"NT26",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@28_16_M_16x16x32",LabelText:"STR@l_NoteTag_26"}},{name:"Button",attrs:{Id:"NT27",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@71_16_M_16x16x32",LabelText:"STR@l_NoteTag_27"}},{name:"Button",attrs:{Id:"NT28",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@8_16_M_16x16x32",LabelText:"STR@l_NoteTag_28"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpSpelling",Description:"",Title:"STR@L_GroupSpelling",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpSpelling.Controls"},children:[{name:"SplitButton",attrs:{Id:"sbSpelling",Alt:"STR@L_NextSpellingError",LabelText:"STR@L_NextSpellingError",Command:"0x9DBB85E9",Image32by32:"IMGMAP@one@Spelling_32x32x32",TemplateAlias:"button1",Keytip:"STR@l_NextSpellingErrorKeytip"},children:[{name:"Menu",attrs:{Id:"menuSpelling"},children:[{name:"MenuSection",attrs:{Id:"msSpelling",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msSpelling.Controls"},children:[{name:"Button",attrs:{Id:"fseaNextSpellingError",Command:"0x9DBB85E9",Image16by16:"IMGMAP@one@Spelling_16x16x32",LabelText:"STR@L_NextSpellingError",Keytip:"STR@l_NextSpellingErrorKeytip"}},{name:"ToggleButton",attrs:{Alt:"STR@L_HideSpellingErrors",Id:"btnToggleHideSpellingErrors",Command:"0x0D738E90",QueryCommand:"0xC4216F96",LabelText:"STR@L_HideSpellingErrors",Image16by16:"IMGMAP@one@HideProofingErrors_16x16x32",TemplateAlias:"button1",Keytip:"STR@l_HideSpellingErrorsKeytip"}},{name:"Button",attrs:{Id:"fseaOpenLanguageDialog",Command:"0x1E6A53BC",Image16by16:"IMGMAP@one@Language_16x16x32",LabelText:"STR@L_SetLanguageMenu",Keytip:"STR@l_SetLanguageMenuKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"msAutoCorrectOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msAutoCorrectOptions.Controls"},children:[{name:"Button",attrs:{Id:"fseaOpenAutoCorrectOptionsDialog",Command:"0x34812765",Image16by16:"IMGMAP@one@AutoCorrect_16x16x32",LabelText:"STR@L_AutoCorrectOptionsMenu",Keytip:"STR@l_AutoCorrectOptionsKeytip"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpDictation",Description:"",Title:"STR@L_Dictation",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{id:"ctrlDictation"},children:[{name:"SplitButton",attrs:{Id:"btnStartDictation",Command:"0x5320AC21",QueryCommand:"0x9017ACFD",IsToggleSplit:"true",LabelText:"STR@L_DictationRibbonLabel",Image32by32:"IMGMAP@one@Insertaudio_32x32x32",Image16by16:"IMGMAP@one@Insertaudio_16x16x32",TemplateAlias:"button1",PopulateDynamically:"true",PopulateOnlyOnce:"true",PopulateQueryCommand:"0x5C29F6D4",Keytip:"STR@L_DictationKeytip"}}]}]}]}]},{name:"Tab",attrs:{Id:"tabInsert",Title:"STR@L_TabInsert",Keytip:"STR@l_TabInsertKeytip"}},{name:"Tab",attrs:{Id:"tabDraw",Title:"STR@L_TabDraw",Keytip:"STR@l_TabDrawKeytip"}},{name:"Tab",attrs:{Id:"tabView",Title:"STR@L_TabView",Keytip:"STR@l_TabViewKeytip"}},{name:"Tab",attrs:{Id:"tabHelp",Title:"STR@L_Help",Keytip:"STR@l_TabHelpKeytip"}}]},{name:"ContextualTabs",attrs:{Id:"ContextualTabs"},children:[{name:"ContextualGroup",attrs:{Color:"Orange",ContextualGroupId:"cgidAudioToolsGroup",Id:"ContextualTabs.Audio",Command:"0x7A85A4BA",Title:"STR@L_AudioTabTitle"},children:[{name:"Tab",attrs:{Id:"ContextualTabs.Audio.Tools",Title:"STR@L_TabAudio",CssClass:"ONAudioToolsTab",Keytip:"STR@l_TabAudioKeytip"}}]},{name:"ContextualGroup",attrs:{Color:"Magenta",ContextualGroupId:"cgidPictureToolsGroup",Id:"cgrpPictureToolsGroup",Command:"0xD2057E46",Title:"STR@L_TabPictureTools"},children:[{name:"Tab",attrs:{Id:"ctabPictureTools",Title:"STR@L_TabFormatPicture",Keytip:"STR@l_TabFormatPictureKeytip"}}]},{name:"ContextualGroup",attrs:{Color:"Yellow",ContextualGroupId:"cgidTableGroup",Id:"ContextualTabs.Tables",Command:"0x712E133C",Title:"STR@L_TabTableTools"},children:[{name:"Tab",attrs:{Id:"ContextualTabs.Tables.Layout",Title:"STR@L_TabLayout",Keytip:"STR@l_TabLayoutKeytip"}}]}]}]},{name:"Templates",attrs:{},children:[{name:"RibbonTemplates",attrs:{Id:"OneNote.Templates"},children:[{name:"GroupTemplate",attrs:{Id:"tmpAllLarge"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button4",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button5",DisplayMode:"Large"}}]}]}]}]},{name:"GroupTemplate",attrs:{Id:"tmpUndoRedo"},children:[{name:"Layout",attrs:{Title:"Small"},children:[{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"undo",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"redo",DisplayMode:"Small"}}]}]}]}]},{name:"GroupTemplate",attrs:{Id:"tmpClipboard"},children:[{name:"Layout",attrs:{Title:"LargeMedium"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"paste",DisplayMode:"Large"}}]}]},{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"cut",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"copy",DisplayMode:"Medium"}}]}]}]},{name:"Layout",attrs:{Title:"LargeSmall"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"paste",DisplayMode:"Large"}}]}]},{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"cut",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"copy",DisplayMode:"Small"}}]}]}]}]},{name:"GroupTemplate",attrs:{Id:"tmpClipboardWithFormatPainter"},children:[{name:"Layout",attrs:{Title:"LargeMedium"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"paste",DisplayMode:"Large"}}]}]},{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"cut",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"copy",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"formatPainter",DisplayMode:"Medium"}}]}]}]},{name:"Layout",attrs:{Title:"LargeSmall"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"paste",DisplayMode:"Large"}}]}]},{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"cut",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"copy",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"formatPainter",DisplayMode:"Small"}}]}]}]}]},{name:"GroupTemplate",attrs:{Id:"tmpBasicText"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"font",DisplayMode:"Medium"}},{name:"ControlRef",attrs:{TemplateAlias:"fontSize",DisplayMode:"Medium"}},{name:"ControlRef",attrs:{TemplateAlias:"bullets",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"numbering",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"clearformat",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"bold",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"italic",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"underline",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"strikethrough",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"subscript",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"fontBackgroundColor",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"fontColor",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"outdent",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"indent",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"alignment",DisplayMode:"Small"}}]}]}]}]},{name:"GroupTemplate",attrs:{Id:"tmpStyles"},children:[{name:"Layout",attrs:{Title:"5style"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"style0",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style3",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style4",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"morestyles",DisplayMode:"Thin"}}]}]}]},{name:"Layout",attrs:{Title:"4style"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"style0",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style3",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"morestyles",DisplayMode:"Thin"}}]}]}]},{name:"Layout",attrs:{Title:"3style"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"style0",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"morestyles",DisplayMode:"Thin"}}]}]}]},{name:"Layout",attrs:{Title:"MoreOnly"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"morestyles",DisplayMode:"Large"}}]}]}]}]},{name:"GroupTemplate",attrs:{Id:"Ribbon.Templates.AddInCommandsControlGroup"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"addinControl2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"addinControl3",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"addinControl4",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"addinControl5",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"addinControl6",DisplayMode:"Large"}}]}]}]},{name:"Layout",attrs:{Title:"Medium"},children:[{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl1",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl3",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl5",DisplayMode:"Medium"}}]}]},{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl2",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl4",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl6",DisplayMode:"Medium"}}]}]}]},{name:"Layout",attrs:{Title:"Small"},children:[{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl1",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl3",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl5",DisplayMode:"Small"}}]}]},{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl2",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl4",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl6",DisplayMode:"Small"}}]}]}]},{name:"Layout",attrs:{Title:"MediumTwoRow"},children:[{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl1",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl3",DisplayMode:"Medium"}}]}]},{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl2",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl4",DisplayMode:"Medium"}}]}]}]},{name:"Layout",attrs:{Title:"SmallTwoRow"},children:[{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl1",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl3",DisplayMode:"Small"}}]}]},{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl2",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl4",DisplayMode:"Small"}}]}]}]}]}]}]}]},window.OneNoteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"OneNoteFloatie",ImageDownArrow:"IMGMAP@one@SplitButtonArrow_5x3x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"TouchGroup",attrs:{Id:"ClipboardGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"floatiefseaPaste",Command:"0x0E249AB3",IsDefinitive:"true",Image24by24:"IMGMAP@one@Paste_24x24x32",LabelText:"STR@L_Paste",DisplayMode:"FloatieLarge"}},{name:"Button",attrs:{Id:"floatiefseaCut",Command:"0x89A31DE2",IsDefinitive:"true",Image24by24:"IMGMAP@one@Cut_24x24x32",LabelText:"STR@L_Cut",DisplayMode:"FloatieLarge"}},{name:"Button",attrs:{Id:"floatiefseaCopy",Command:"0xC9ADDC35",IsDefinitive:"true",Image24by24:"IMGMAP@one@Copy_24x24x32",LabelText:"STR@L_Copy",DisplayMode:"FloatieLarge"}},{name:"Button",attrs:{Id:"floatiefseaDelete",Command:"0xAC189AA4",IsDefinitive:"true",Image24by24:"IMGMAP@one@Delete_24x24x32",LabelText:"STR@L_Delete",DisplayMode:"FloatieLarge"}}]}]}]}]},{name:"Group",attrs:{Id:"TextFormattingGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"ComboBox",attrs:{Alt:"STR@L_FontName",Id:"floatiefontName",Command:"0xCC7BD8E3",QueryCommand:"0x48F327A5",Width:"90px",DisplayMode:"Medium",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0x0AB30E9C",AllowFreeForm:"true"}},{name:"ComboBox",attrs:{Alt:"STR@L_FontSize",Id:"floatiefontSize",Command:"0xBFBF8D1A",QueryCommand:"0xE43EEA4E",Width:"23px",DisplayMode:"Medium",PopulateDynamically:"true",PopulateOnlyOnce:"true",PopulateQueryCommand:"0x580E32AF",AllowFreeForm:"true"}},{name:"ToggleButton",attrs:{Id:"floatiefseaFormatPainter",Command:"0x9289CA5F",QueryCommand:"0x97A875DC",Image16by16:"IMGMAP@one@FormatPainter_16x16x32",LabelText:"STR@L_FormatPainter",DisplayMode:"Small"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_GroupStyles",Id:"floatiefsfaMoreStyles",Command:"0x3E088D63",Image16by16:"IMGMAP@one@UxGalWordQuickFormats_16x16x32",DisplayMode:"Small",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0x289E9560"}},{name:"Button",attrs:{Id:"NT0",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@3_16_M_16x16x32",LabelText:"STR@l_NoteTag_0",DisplayMode:"Small"}},{name:"FlyoutAnchor",attrs:{Id:"floatieflyNoteTags",Alt:"STR@L_NoteTags",Image16by16:"IMGMAP@one@JotNoteTags_16x16x32",LabelText:"STR@L_NoteTags",DisplayMode:"Small",Command:"0x6C71CE19"},children:[{name:"Menu",attrs:{Id:"menuNoteTags"},children:[{name:"MenuSection",attrs:{Id:"floatiemsNoteTagCommands",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ctrlNoteTagCommands"},children:[{name:"Button",attrs:{Id:"floatiebuttonNoteTagRemoveAll",Command:"0x5C016681",Image16by16:"IMGMAP@one@JotActionItemRemoveAll_16x16x32",LabelText:"STR@L_NoteTagRemove"}}]}]},{name:"MenuSection",attrs:{Id:"floatiemsNoteTagInsert",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ctrlNoteTagInsert"},children:[{name:"Button",attrs:{Id:"NT0",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@3_16_M_16x16x32",LabelText:"STR@l_NoteTag_0"}},{name:"Button",attrs:{Id:"NT1",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@13_16_N_16x16x32",LabelText:"STR@l_NoteTag_1"}},{name:"Button",attrs:{Id:"NT2",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@15_16_N_16x16x32",LabelText:"STR@l_NoteTag_2"}},{name:"Button",attrs:{Id:"NT3",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@NoteTagNoShape_16x16x32",LabelText:"STR@l_NoteTag_3"}},{name:"Button",attrs:{Id:"NT4",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@NoteTagNoShape_16x16x32",LabelText:"STR@l_NoteTag_4"}},{name:"Button",attrs:{Id:"NT5",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@136_16_N_16x16x32",LabelText:"STR@l_NoteTag_5"}},{name:"Button",attrs:{Id:"NT6",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@118_16_N_16x16x32",LabelText:"STR@l_NoteTag_6"}},{name:"Button",attrs:{Id:"NT7",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@23_16_N_16x16x32",LabelText:"STR@l_NoteTag_7"}},{name:"Button",attrs:{Id:"NT8",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@18_16_N_16x16x32",LabelText:"STR@l_NoteTag_8"}},{name:"Button",attrs:{Id:"NT9",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@125_16_N_16x16x32",LabelText:"STR@l_NoteTag_9"}},{name:"Button",attrs:{Id:"NT10",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@21_16_N_16x16x32",LabelText:"STR@l_NoteTag_10"}},{name:"Button",attrs:{Id:"NT11",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@131_16_N_16x16x32",LabelText:"STR@l_NoteTag_11"}},{name:"Button",attrs:{Id:"NT12",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@17_16_N_16x16x32",LabelText:"STR@l_NoteTag_12"}},{name:"Button",attrs:{Id:"NT13",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@100_16_N_16x16x32",LabelText:"STR@l_NoteTag_13"}},{name:"Button",attrs:{Id:"NT14",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@101_16_N_16x16x32",LabelText:"STR@l_NoteTag_14"}},{name:"Button",attrs:{Id:"NT15",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@122_16_N_16x16x32",LabelText:"STR@l_NoteTag_15"}},{name:"Button",attrs:{Id:"NT16",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@132_16_N_16x16x32",LabelText:"STR@l_NoteTag_16"}},{name:"Button",attrs:{Id:"NT17",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@121_16_N_16x16x32",LabelText:"STR@l_NoteTag_17"}},{name:"Button",attrs:{Id:"NT18",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@125_16_N_16x16x32",LabelText:"STR@l_NoteTag_18"}},{name:"Button",attrs:{Id:"NT19",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@24_16_N_16x16x32",LabelText:"STR@l_NoteTag_19"}},{name:"Button",attrs:{Id:"NT20",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@94_16_M_16x16x32",LabelText:"STR@l_NoteTag_20"}},{name:"Button",attrs:{Id:"NT21",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@94_16_M_16x16x32",LabelText:"STR@l_NoteTag_21"}},{name:"Button",attrs:{Id:"NT22",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@95_16_M_16x16x32",LabelText:"STR@l_NoteTag_22"}},{name:"Button",attrs:{Id:"NT23",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@106_16_N_16x16x32",LabelText:"STR@l_NoteTag_23"}},{name:"Button",attrs:{Id:"NT24",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@12_16_M_16x16x32",LabelText:"STR@l_NoteTag_24"}},{name:"Button",attrs:{Id:"NT25",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@12_16_M_16x16x32",LabelText:"STR@l_NoteTag_25"}},{name:"Button",attrs:{Id:"NT26",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@28_16_M_16x16x32",LabelText:"STR@l_NoteTag_26"}},{name:"Button",attrs:{Id:"NT27",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@71_16_M_16x16x32",LabelText:"STR@l_NoteTag_27"}},{name:"Button",attrs:{Id:"NT28",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@8_16_M_16x16x32",LabelText:"STR@l_NoteTag_28"}}]}]}]}]}]}]},{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"ToggleButton",attrs:{Id:"floatiefsbcBold",Alt:"STR@L_Bold",Command:"0xF6F32311",QueryCommand:"0x575E8BDF",Image16by16:"IMGMAP@one@Bold_16x16x32",DisplayMode:"Small"}},{name:"ToggleButton",attrs:{Id:"floatiefsbcItalic",Alt:"STR@L_Italic",Command:"0xD4C1657E",QueryCommand:"0xFC350CA2",Image16by16:"IMGMAP@one@Italic_16x16x32",DisplayMode:"Small"}},{name:"ToggleButton",attrs:{Id:"floatiefsbcUnderline",Alt:"STR@L_Underline",Command:"0x6F0FAAC6",QueryCommand:"0x89383C62",Image16by16:"IMGMAP@one@Underline_16x16x32",DisplayMode:"Small"}},{name:"FlyoutAnchor",attrs:{Id:"floatiefontBackgroundColor",Command:"0x568463EB",Image16by16:"IMGMAP@one@HighlightWithColor_16x16x32",LabelText:"STR@L_MenuHighlightColor",DisplayMode:"Small"},children:[{name:"Menu",attrs:{Id:"menuFontBackgroundColor"},children:[{name:"MenuSection",attrs:{Id:"fontBackgroundColor"},children:[{name:"Controls",attrs:{Id:"Background.Font.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"fontBackgroundColorTable",Command:"0x6A55FB2A",Width:"5"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"00FFFF",Alt:"STR@L_FontColorYellow",DisplayColor:"#FFFF00"}},{name:"Color",attrs:{Color:"00FF00",Alt:"STR@L_FontColorGreen",DisplayColor:"#00FF00"}},{name:"Color",attrs:{Color:"FFFF00",Alt:"STR@L_FontColorCyan",DisplayColor:"#00FFFF"}},{name:"Color",attrs:{Color:"FF00FF",Alt:"STR@L_FontColorMagenta",DisplayColor:"#FF00FF"}},{name:"Color",attrs:{Color:"FF0000",Alt:"STR@L_FontColorBlue",DisplayColor:"#0000FF"}},{name:"Color",attrs:{Color:"0000FF",Alt:"STR@L_FontColorRed",DisplayColor:"#FF0000"}},{name:"Color",attrs:{Color:"800000",Alt:"STR@L_FontColorDarkBlue",DisplayColor:"#000080"}},{name:"Color",attrs:{Color:"808000",Alt:"STR@L_FontColorDarkCyan",DisplayColor:"#008080"}},{name:"Color",attrs:{Color:"008000",Alt:"STR@L_FontColorDarkGreen",DisplayColor:"#008000"}},{name:"Color",attrs:{Color:"800080",Alt:"STR@L_FontColorDarkMagenta",DisplayColor:"#800080"}},{name:"Color",attrs:{Color:"000080",Alt:"STR@L_FontColorDarkRed",DisplayColor:"#800000"}},{name:"Color",attrs:{Color:"008080",Alt:"STR@L_FontColorDarkYellow",DisplayColor:"#808000"}},{name:"Color",attrs:{Color:"808080",Alt:"STR@L_FontColorGrey",DisplayColor:"#808080"}},{name:"Color",attrs:{Color:"C0C0C0",Alt:"STR@L_FontColorLightGrey",DisplayColor:"#C0C0C0"}},{name:"Color",attrs:{Color:"000000",Alt:"STR@L_FontColorBlack",DisplayColor:"#000000"}}]}]}]}]},{name:"MenuSection",attrs:{Id:"noFontBackgroundColor",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"No.Background.Font.Color.Menu.Controls"},children:[{name:"Button",attrs:{Command:"0x2184F4E5",Id:"none",LabelText:"STR@L_NoHighlight",Image16by16:"IMGMAP@one@NoHighlight_16x16x32"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"floatiefontColor",Command:"0x568463EB",Image16by16:"IMGMAP@one@FontColorServer_16x16x32",LabelText:"STR@L_MenuFontColor",DisplayMode:"Small"},children:[{name:"Menu",attrs:{Id:"menuFontColor"},children:[{name:"MenuSection",attrs:{Id:"fontColor",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"Font.Color.Menu.Controls"},children:[{name:"Button",attrs:{Command:"0xD0232D5B",LabelText:"STR@L_Automatic",Id:"automatic",Image16by16:"IMGMAP@one@Automatic_16x16x32"}}]}]},{name:"MenuSection",attrs:{Id:"fontColor"},children:[{name:"Controls",attrs:{Id:"Font.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"fontColorTable",Command:"0x7577CA82",McuLayout:"true",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"FFFFFF",DisplayColor:"#FFFFFF",Alt:"STR@L_FontColorWhite"}},{name:"Color",attrs:{Color:"000000",DisplayColor:"#000000",Alt:"STR@L_FontColorBlack"}},{name:"Color",attrs:{Color:"E1ECEE",DisplayColor:"#EEECE1",Alt:"STR@L_FontColorTan"}},{name:"Color",attrs:{Color:"7D491F",DisplayColor:"#1F497D",Alt:"STR@L_FontColorDarkBlue"}},{name:"Color",attrs:{Color:"BD814F",DisplayColor:"#4F81BD",Alt:"STR@L_FontColorBlue"}},{name:"Color",attrs:{Color:"4D50C0",DisplayColor:"#C0504D",Alt:"STR@L_FontColorRed"}},{name:"Color",attrs:{Color:"59BB9B",DisplayColor:"#9BBB59",Alt:"STR@L_FontColorOliveGreen"}},{name:"Color",attrs:{Color:"A26480",DisplayColor:"#8064A2",Alt:"STR@L_FontColorPurple"}},{name:"Color",attrs:{Color:"C6AC4B",DisplayColor:"#4BACC6",Alt:"STR@L_FontColorAqua"}},{name:"Color",attrs:{Color:"4696F7",DisplayColor:"#F79646",Alt:"STR@L_FontColorOrange"}},{name:"Color",attrs:{Color:"F2F2F2",DisplayColor:"#F2F2F2",Alt:"STR@L_FontColorWhiteDarker5pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorBlackLighter50pct"}},{name:"Color",attrs:{Color:"C3D9DD",DisplayColor:"#DDD9C3",Alt:"STR@L_FontColorTanDarker10pct"}},{name:"Color",attrs:{Color:"F0D9C6",DisplayColor:"#C6D9F0",Alt:"STR@L_FontColorDarkBlueLighter80pct"}},{name:"Color",attrs:{Color:"F1E5DB",DisplayColor:"#DBE5F1",Alt:"STR@L_FontColorBlueLighter80pct"}},{name:"Color",attrs:{Color:"DBDCF2",DisplayColor:"#F2DCDB",Alt:"STR@L_FontColorRedLighter80pct"}},{name:"Color",attrs:{Color:"DDF1EB",DisplayColor:"#EBF1DD",Alt:"STR@L_FontColorOliveGreenLighter80pct"}},{name:"Color",attrs:{Color:"ECE0E5",DisplayColor:"#E5E0EC",Alt:"STR@L_FontColorPurpleLighter80pct"}},{name:"Color",attrs:{Color:"F3EEDB",DisplayColor:"#DBEEF3",Alt:"STR@L_FontColorAquaLighter80pct"}},{name:"Color",attrs:{Color:"DAEAFD",DisplayColor:"#FDEADA",Alt:"STR@L_FontColorOrangeLighter80pct"}},{name:"Color",attrs:{Color:"D8D8D8",DisplayColor:"#D8D8D8",Alt:"STR@L_FontColorWhiteDarker15pct"}},{name:"Color",attrs:{Color:"595959",DisplayColor:"#595959",Alt:"STR@L_FontColorBlackLighter35pct"}},{name:"Color",attrs:{Color:"97BDC4",DisplayColor:"#C4BD97",Alt:"STR@L_FontColorTanDarker25pct"}},{name:"Color",attrs:{Color:"E2B38D",DisplayColor:"#8DB3E2",Alt:"STR@L_FontColorDarkBlueLighter60pct"}},{name:"Color",attrs:{Color:"E4CCB8",DisplayColor:"#B8CCE4",Alt:"STR@L_FontColorBlueLighter60pct"}},{name:"Color",attrs:{Color:"B7B9E5",DisplayColor:"#E5B9B7",Alt:"STR@L_FontColorRedLighter60pct"}},{name:"Color",attrs:{Color:"BCE3D7",DisplayColor:"#D7E3BC",Alt:"STR@L_FontColorOliveGreenLighter60pct"}},{name:"Color",attrs:{Color:"D9C1CC",DisplayColor:"#CCC1D9",Alt:"STR@L_FontColorPurpleLighter60pct"}},{name:"Color",attrs:{Color:"E8DDB7",DisplayColor:"#B7DDE8",Alt:"STR@L_FontColorAquaLighter60pct"}},{name:"Color",attrs:{Color:"B5D5FB",DisplayColor:"#FBD5B5",Alt:"STR@L_FontColorOrangeLighter60pct"}},{name:"Color",attrs:{Color:"BFBFBF",DisplayColor:"#BFBFBF",Alt:"STR@L_FontColorWhiteDarker25pct"}},{name:"Color",attrs:{Color:"3F3F3F",DisplayColor:"#3F3F3F",Alt:"STR@L_FontColorBlackLighter25pct"}},{name:"Color",attrs:{Color:"538993",DisplayColor:"#938953",Alt:"STR@L_FontColorTanDarker50pct"}},{name:"Color",attrs:{Color:"D48D54",DisplayColor:"#548DD4",Alt:"STR@L_FontColorDarkBlueLighter40pct"}},{name:"Color",attrs:{Color:"D7B395",DisplayColor:"#95B3D7",Alt:"STR@L_FontColorBlueLighter40pct"}},{name:"Color",attrs:{Color:"9496D9",DisplayColor:"#D99694",Alt:"STR@L_FontColorRedLighter40pct"}},{name:"Color",attrs:{Color:"9BD6C3",DisplayColor:"#C3D69B",Alt:"STR@L_FontColorOliveGreenLighter40pct"}},{name:"Color",attrs:{Color:"C7A2B2",DisplayColor:"#B2A2C7",Alt:"STR@L_FontColorPurpleLighter40pct"}},{name:"Color",attrs:{Color:"DCCD92",DisplayColor:"#92CDDC",Alt:"STR@L_FontColorAquaLighter40pct"}},{name:"Color",attrs:{Color:"8FC0FA",DisplayColor:"#FAC08F",Alt:"STR@L_FontColorOrangeLighter40pct"}},{name:"Color",attrs:{Color:"A5A5A5",DisplayColor:"#A5A5A5",Alt:"STR@L_FontColorWhiteDarker35pct"}},{name:"Color",attrs:{Color:"262626",DisplayColor:"#262626",Alt:"STR@L_FontColorBlackLighter15pct"}},{name:"Color",attrs:{Color:"294449",DisplayColor:"#494429",Alt:"STR@L_FontColorTanDarker75pct"}},{name:"Color",attrs:{Color:"5D3617",DisplayColor:"#17365D",Alt:"STR@L_FontColorDarkBlueDarker25pct"}},{name:"Color",attrs:{Color:"926036",DisplayColor:"#366092",Alt:"STR@L_FontColorBlueDarker25pct"}},{name:"Color",attrs:{Color:"343795",DisplayColor:"#953734",Alt:"STR@L_FontColorRedDarker25pct"}},{name:"Color",attrs:{Color:"3C9276",DisplayColor:"#76923C",Alt:"STR@L_FontColorOliveGreenDarker25pct"}},{name:"Color",attrs:{Color:"7A495F",DisplayColor:"#5F497A",Alt:"STR@L_FontColorPurpleDarker25pct"}},{name:"Color",attrs:{Color:"9B8431",DisplayColor:"#31849B",Alt:"STR@L_FontColorAquaDarker25pct"}},{name:"Color",attrs:{Color:"096CE3",DisplayColor:"#E36C09",Alt:"STR@L_FontColorOrangeDarker25pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorWhiteDarker50pct"}},{name:"Color",attrs:{Color:"0C0C0C",DisplayColor:"#0C0C0C",Alt:"STR@L_FontColorBlackLighter5pct"}},{name:"Color",attrs:{Color:"101B1D",DisplayColor:"#1D1B10",Alt:"STR@L_FontColorTanDarker90pct"}},{name:"Color",attrs:{Color:"3E240F",DisplayColor:"#0F243E",Alt:"STR@L_FontColorDarkBlueDarker50pct"}},{name:"Color",attrs:{Color:"614024",DisplayColor:"#244061",Alt:"STR@L_FontColorBlueDarker50pct"}},{name:"Color",attrs:{Color:"232463",DisplayColor:"#632423",Alt:"STR@L_FontColorRedDarker50pct"}},{name:"Color",attrs:{Color:"28614F",DisplayColor:"#4F6128",Alt:"STR@L_FontColorOliveGreenDarker50pct"}},{name:"Color",attrs:{Color:"51313F",DisplayColor:"#3F3151",Alt:"STR@L_FontColorPurpleDarker50pct"}},{name:"Color",attrs:{Color:"675820",DisplayColor:"#205867",Alt:"STR@L_FontColorAquaDarker50pct"}},{name:"Color",attrs:{Color:"064898",DisplayColor:"#984806",Alt:"STR@L_FontColorOrangeDarker50pct"}}]}]}]}]},{name:"MenuSection",attrs:{Id:"fontStandardColor",Title:"STR@L_MenuStandardColors"},children:[{name:"Controls",attrs:{Id:"Font.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"fontStandardColorTable",Command:"0x7577CA82",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"0000C0",Alt:"STR@L_FontColorDarkRed",DisplayColor:"#C00000"}},{name:"Color",attrs:{Color:"0000FF",Alt:"STR@L_FontColorRed",DisplayColor:"#FF0000"}},{name:"Color",attrs:{Color:"00C0FF",Alt:"STR@L_FontColorOrange",DisplayColor:"#FFC000"}},{name:"Color",attrs:{Color:"00FFFF",Alt:"STR@L_FontColorYellow",DisplayColor:"#FFFF00"}},{name:"Color",attrs:{Color:"50D092",Alt:"STR@L_FontColorLightGreen",DisplayColor:"#92D050"}},{name:"Color",attrs:{Color:"50B000",Alt:"STR@L_FontColorDarkGreen",DisplayColor:"#00B050"}},{name:"Color",attrs:{Color:"F0B000",Alt:"STR@L_FontColorLightBlue",DisplayColor:"#00B0F0"}},{name:"Color",attrs:{Color:"C07000",Alt:"STR@L_FontColorBlue",DisplayColor:"#0070C0"}},{name:"Color",attrs:{Color:"602000",Alt:"STR@L_FontColorDarkBlue",DisplayColor:"#002060"}},{name:"Color",attrs:{Color:"A03070",Alt:"STR@L_FontColorPurple",DisplayColor:"#7030A0"}}]}]}]}]}]}]},{name:"SplitButton",attrs:{Id:"floatiesbBullets",Command:"0xD3C129A1",QueryCommand:"0xE41E1F87",IsToggleSplit:"true",LabelText:"STR@L_MenuBullets",Image16by16:"IMGMAP@one@Bullets_16x16x32",DisplayMode:"Small"},children:[{name:"Menu",attrs:{Id:"floatiemenuBullets"},children:[{name:"MenuSection",attrs:{Id:"floatiemsAllBulletStyles",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ctrlBulletStyles"},children:[{name:"ToggleButton",attrs:{Id:"floatiebuttonBulletStyle1",MenuItemId:"buttonBulletStyle1",Command:"0xD3C129A1",QueryCommand:"0xDAF74829",Image16by16:"IMGMAP@one@SolidBullet_16x16x32",LabelText:"STR@L_BulletStyle1"}},{name:"ToggleButton",attrs:{Id:"floatiebuttonBulletStyle2",MenuItemId:"buttonBulletStyle2",Command:"0xD3C129A1",QueryCommand:"0xC2EDA5FA",Image16by16:"IMGMAP@one@HollowBullet_16x16x32",LabelText:"STR@L_BulletStyle2"}},{name:"ToggleButton",attrs:{Id:"floatiebuttonBulletStyle3",MenuItemId:"buttonBulletStyle3",Command:"0xD3C129A1",QueryCommand:"0x2046315F",Image16by16:"IMGMAP@one@SquareBullet_16x16x32",LabelText:"STR@L_BulletStyle3"}}]}]}]}]},{name:"SplitButton",attrs:{Id:"floatiesbNumbering",Command:"0x83E875AA",QueryCommand:"0xCFEC4235",IsToggleSplit:"true",LabelText:"STR@L_MenuNumbering",Image16by16:"IMGMAP@one@Numbering_16x16x32",DisplayMode:"Small"},children:[{name:"Menu",attrs:{Id:"floatiemenuNumbering"},children:[{name:"MenuSection",attrs:{Id:"msAllNumberStyles",DisplayMode:"Menu"},children:[{name:"Controls",attrs:{Id:"floatiectrlNumberStyles"},children:[{name:"ToggleButton",attrs:{Id:"floatiebuttonNumberStyle1",MenuItemId:"buttonNumberStyle1",Command:"0x83E875AA",QueryCommand:"0x028F909B",LabelText:"STR@L_NumberStyle1"}},{name:"ToggleButton",attrs:{Id:"floatiebuttonNumberStyle2",MenuItemId:"buttonNumberStyle2",Command:"0x83E875AA",QueryCommand:"0xEA85EE6C",LabelText:"STR@L_NumberStyle2"}},{name:"ToggleButton",attrs:{Id:"floatiebuttonNumberStyle3",MenuItemId:"buttonNumberStyle3",Command:"0x83E875AA",QueryCommand:"0x47DE79D1",LabelText:"STR@L_NumberStyle3"}},{name:"ToggleButton",attrs:{Id:"floatiebuttonNumberStyle4",MenuItemId:"buttonNumberStyle4",Command:"0x83E875AA",QueryCommand:"0x1A9932CA",LabelText:"STR@L_NumberStyle4"}},{name:"ToggleButton",attrs:{Id:"floatiebuttonNumberStyle5",MenuItemId:"buttonNumberStyle5",Command:"0x83E875AA",QueryCommand:"0x77F1BE2F",LabelText:"STR@L_NumberStyle5"}}]}]}]}]},{name:"Button",attrs:{Id:"floatiefseaOutdent",Command:"0xC93B4FD0",QueryCommand:"0x5F5719F6",Image16by16:"IMGMAP@one@Outdent_16x16x32",LabelText:"STR@L_DecreaseIndent",DisplayMode:"Small"}},{name:"Button",attrs:{Id:"floatiefseaIndent",Command:"0xF2CCFEC4",QueryCommand:"0x9EFAB6C2",Image16by16:"IMGMAP@one@Indent_16x16x32",LabelText:"STR@L_IncreaseIndent",DisplayMode:"Small"}}]}]}]}]},{name:"Group",attrs:{Id:"PictureToolsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"floatiebtnImageGrow",DisplayMode:"FloatieLarge",Command:"0x464C6D12",Image24by24:"IMGMAP@one@IncreaseSize_24x24x32",LabelText:"STR@L_Grow"}},{name:"Button",attrs:{Id:"floatiebtnImageShrink",DisplayMode:"FloatieLarge",Command:"0xF571A3C0",Image24by24:"IMGMAP@one@DecreaseSize_24x24x32",LabelText:"STR@L_Shrink"}},{name:"Button",attrs:{Id:"floatiebtnImageCropDialog",DisplayMode:"FloatieLarge",Command:"0xEF945B15",Image24by24:"IMGMAP@one@Crop_24x24x32",LabelText:"STR@L_Crop"}}]}]}]}]},{name:"Group",attrs:{Id:"TableToolsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"floatieshadingColor",Command:"0x4DAC4430",Image24by24:"IMGMAP@one@FillColorSplitDropdown_24x24x32",LabelText:"STR@L_MenuShadingColor",DisplayMode:"FloatieLarge"},children:[{name:"Menu",attrs:{Id:"menuCellShadingColor"},children:[{name:"MenuSection",attrs:{Id:"cellShadingColor",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"CellShading.Color.Menu.Controls"},children:[{name:"Button",attrs:{Command:"0xC33DA1AE",LabelText:"STR@L_BtnClearShading",Id:"clear",Image16by16:"IMGMAP@one@NoHighlight_16x16x32"}}]}]},{name:"MenuSection",attrs:{Id:"cellShadingColor"},children:[{name:"Controls",attrs:{Id:"CellShading.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"cellShadingColorTable",Command:"0xA4D47B93",McuLayout:"true",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"FFFFFF",DisplayColor:"#FFFFFF",Alt:"STR@L_FontColorWhite"}},{name:"Color",attrs:{Color:"000000",DisplayColor:"#000000",Alt:"STR@L_FontColorBlack"}},{name:"Color",attrs:{Color:"E1ECEE",DisplayColor:"#EEECE1",Alt:"STR@L_FontColorTan"}},{name:"Color",attrs:{Color:"7D491F",DisplayColor:"#1F497D",Alt:"STR@L_FontColorDarkBlue"}},{name:"Color",attrs:{Color:"BD814F",DisplayColor:"#4F81BD",Alt:"STR@L_FontColorBlue"}},{name:"Color",attrs:{Color:"4D50C0",DisplayColor:"#C0504D",Alt:"STR@L_FontColorRed"}},{name:"Color",attrs:{Color:"59BB9B",DisplayColor:"#9BBB59",Alt:"STR@L_FontColorOliveGreen"}},{name:"Color",attrs:{Color:"A26480",DisplayColor:"#8064A2",Alt:"STR@L_FontColorPurple"}},{name:"Color",attrs:{Color:"C6AC4B",DisplayColor:"#4BACC6",Alt:"STR@L_FontColorAqua"}},{name:"Color",attrs:{Color:"4696F7",DisplayColor:"#F79646",Alt:"STR@L_FontColorOrange"}},{name:"Color",attrs:{Color:"F2F2F2",DisplayColor:"#F2F2F2",Alt:"STR@L_FontColorWhiteDarker5pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorBlackLighter50pct"}},{name:"Color",attrs:{Color:"C3D9DD",DisplayColor:"#DDD9C3",Alt:"STR@L_FontColorTanDarker10pct"}},{name:"Color",attrs:{Color:"F0D9C6",DisplayColor:"#C6D9F0",Alt:"STR@L_FontColorDarkBlueLighter80pct"}},{name:"Color",attrs:{Color:"F1E5DB",DisplayColor:"#DBE5F1",Alt:"STR@L_FontColorBlueLighter80pct"}},{name:"Color",attrs:{Color:"DBDCF2",DisplayColor:"#F2DCDB",Alt:"STR@L_FontColorRedLighter80pct"}},{name:"Color",attrs:{Color:"DDF1EB",DisplayColor:"#EBF1DD",Alt:"STR@L_FontColorOliveGreenLighter80pct"}},{name:"Color",attrs:{Color:"ECE0E5",DisplayColor:"#E5E0EC",Alt:"STR@L_FontColorPurpleLighter80pct"}},{name:"Color",attrs:{Color:"F3EEDB",DisplayColor:"#DBEEF3",Alt:"STR@L_FontColorAquaLighter80pct"}},{name:"Color",attrs:{Color:"DAEAFD",DisplayColor:"#FDEADA",Alt:"STR@L_FontColorOrangeLighter80pct"}},{name:"Color",attrs:{Color:"D8D8D8",DisplayColor:"#D8D8D8",Alt:"STR@L_FontColorWhiteDarker15pct"}},{name:"Color",attrs:{Color:"595959",DisplayColor:"#595959",Alt:"STR@L_FontColorBlackLighter35pct"}},{name:"Color",attrs:{Color:"97BDC4",DisplayColor:"#C4BD97",Alt:"STR@L_FontColorTanDarker25pct"}},{name:"Color",attrs:{Color:"E2B38D",DisplayColor:"#8DB3E2",Alt:"STR@L_FontColorDarkBlueLighter60pct"}},{name:"Color",attrs:{Color:"E4CCB8",DisplayColor:"#B8CCE4",Alt:"STR@L_FontColorBlueLighter60pct"}},{name:"Color",attrs:{Color:"B7B9E5",DisplayColor:"#E5B9B7",Alt:"STR@L_FontColorRedLighter60pct"}},{name:"Color",attrs:{Color:"BCE3D7",DisplayColor:"#D7E3BC",Alt:"STR@L_FontColorOliveGreenLighter60pct"}},{name:"Color",attrs:{Color:"D9C1CC",DisplayColor:"#CCC1D9",Alt:"STR@L_FontColorPurpleLighter60pct"}},{name:"Color",attrs:{Color:"E8DDB7",DisplayColor:"#B7DDE8",Alt:"STR@L_FontColorAquaLighter60pct"}},{name:"Color",attrs:{Color:"B5D5FB",DisplayColor:"#FBD5B5",Alt:"STR@L_FontColorOrangeLighter60pct"}},{name:"Color",attrs:{Color:"BFBFBF",DisplayColor:"#BFBFBF",Alt:"STR@L_FontColorWhiteDarker25pct"}},{name:"Color",attrs:{Color:"3F3F3F",DisplayColor:"#3F3F3F",Alt:"STR@L_FontColorBlackLighter25pct"}},{name:"Color",attrs:{Color:"538993",DisplayColor:"#938953",Alt:"STR@L_FontColorTanDarker50pct"}},{name:"Color",attrs:{Color:"D48D54",DisplayColor:"#548DD4",Alt:"STR@L_FontColorDarkBlueLighter40pct"}},{name:"Color",attrs:{Color:"D7B395",DisplayColor:"#95B3D7",Alt:"STR@L_FontColorBlueLighter40pct"}},{name:"Color",attrs:{Color:"9496D9",DisplayColor:"#D99694",Alt:"STR@L_FontColorRedLighter40pct"}},{name:"Color",attrs:{Color:"9BD6C3",DisplayColor:"#C3D69B",Alt:"STR@L_FontColorOliveGreenLighter40pct"}},{name:"Color",attrs:{Color:"C7A2B2",DisplayColor:"#B2A2C7",Alt:"STR@L_FontColorPurpleLighter40pct"}},{name:"Color",attrs:{Color:"DCCD92",DisplayColor:"#92CDDC",Alt:"STR@L_FontColorAquaLighter40pct"}},{name:"Color",attrs:{Color:"8FC0FA",DisplayColor:"#FAC08F",Alt:"STR@L_FontColorOrangeLighter40pct"}},{name:"Color",attrs:{Color:"A5A5A5",DisplayColor:"#A5A5A5",Alt:"STR@L_FontColorWhiteDarker35pct"}},{name:"Color",attrs:{Color:"262626",DisplayColor:"#262626",Alt:"STR@L_FontColorBlackLighter15pct"}},{name:"Color",attrs:{Color:"294449",DisplayColor:"#494429",Alt:"STR@L_FontColorTanDarker75pct"}},{name:"Color",attrs:{Color:"5D3617",DisplayColor:"#17365D",Alt:"STR@L_FontColorDarkBlueDarker25pct"}},{name:"Color",attrs:{Color:"926036",DisplayColor:"#366092",Alt:"STR@L_FontColorBlueDarker25pct"}},{name:"Color",attrs:{Color:"343795",DisplayColor:"#953734",Alt:"STR@L_FontColorRedDarker25pct"}},{name:"Color",attrs:{Color:"3C9276",DisplayColor:"#76923C",Alt:"STR@L_FontColorOliveGreenDarker25pct"}},{name:"Color",attrs:{Color:"7A495F",DisplayColor:"#5F497A",Alt:"STR@L_FontColorPurpleDarker25pct"}},{name:"Color",attrs:{Color:"9B8431",DisplayColor:"#31849B",Alt:"STR@L_FontColorAquaDarker25pct"}},{name:"Color",attrs:{Color:"096CE3",DisplayColor:"#E36C09",Alt:"STR@L_FontColorOrangeDarker25pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorWhiteDarker50pct"}},{name:"Color",attrs:{Color:"0C0C0C",DisplayColor:"#0C0C0C",Alt:"STR@L_FontColorBlackLighter5pct"}},{name:"Color",attrs:{Color:"101B1D",DisplayColor:"#1D1B10",Alt:"STR@L_FontColorTanDarker90pct"}},{name:"Color",attrs:{Color:"3E240F",DisplayColor:"#0F243E",Alt:"STR@L_FontColorDarkBlueDarker50pct"}},{name:"Color",attrs:{Color:"614024",DisplayColor:"#244061",Alt:"STR@L_FontColorBlueDarker50pct"}},{name:"Color",attrs:{Color:"232463",DisplayColor:"#632423",Alt:"STR@L_FontColorRedDarker50pct"}},{name:"Color",attrs:{Color:"28614F",DisplayColor:"#4F6128",Alt:"STR@L_FontColorOliveGreenDarker50pct"}},{name:"Color",attrs:{Color:"51313F",DisplayColor:"#3F3151",Alt:"STR@L_FontColorPurpleDarker50pct"}},{name:"Color",attrs:{Color:"675820",DisplayColor:"#205867",Alt:"STR@L_FontColorAquaDarker50pct"}},{name:"Color",attrs:{Color:"064898",DisplayColor:"#984806",Alt:"STR@L_FontColorOrangeDarker50pct"}}]}]}]}]},{name:"MenuSection",attrs:{Id:"cellShadingStandardColor",Title:"STR@L_MenuStandardColors"},children:[{name:"Controls",attrs:{Id:"CellShading.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"cellShadingStandardColorTable",Command:"0xA4D47B93",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"0000C0",Alt:"STR@L_FontColorDarkRed",DisplayColor:"#C00000"}},{name:"Color",attrs:{Color:"0000FF",Alt:"STR@L_FontColorRed",DisplayColor:"#FF0000"}},{name:"Color",attrs:{Color:"00C0FF",Alt:"STR@L_FontColorOrange",DisplayColor:"#FFC000"}},{name:"Color",attrs:{Color:"00FFFF",Alt:"STR@L_FontColorYellow",DisplayColor:"#FFFF00"}},{name:"Color",attrs:{Color:"50D092",Alt:"STR@L_FontColorLightGreen",DisplayColor:"#92D050"}},{name:"Color",attrs:{Color:"50B000",Alt:"STR@L_FontColorDarkGreen",DisplayColor:"#00B050"}},{name:"Color",attrs:{Color:"F0B000",Alt:"STR@L_FontColorLightBlue",DisplayColor:"#00B0F0"}},{name:"Color",attrs:{Color:"C07000",Alt:"STR@L_FontColorBlue",DisplayColor:"#0070C0"}},{name:"Color",attrs:{Color:"602000",Alt:"STR@L_FontColorDarkBlue",DisplayColor:"#002060"}},{name:"Color",attrs:{Color:"A03070",Alt:"STR@L_FontColorPurple",DisplayColor:"#7030A0"}}]}]}]}]}]}]},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_GroupInsert",Id:"floatieidTableInsert",Command:"0x2F9A3D80",Image24by24:"IMGMAP@one@InsertRowsBelow_24x24x32",LabelText:"STR@L_GroupInsert",DisplayMode:"FloatieLarge"},children:[{name:"Menu",attrs:{Id:"floatiemenuTableInsert"},children:[{name:"MenuSection",attrs:{Id:"floatiemsTableInsert",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"floatiebtnInsertRowAbove",Command:"0x8138CF12",IsDefinitive:"true",Image16by16:"IMGMAP@one@InsertRowsAbove_16x16x32",LabelText:"STR@L_InsertAbove"}},{name:"Button",attrs:{Id:"floatiebtnInsertRowBelow",Image16by16:"IMGMAP@one@InsertRowsBelow_16x16x32",Command:"0xDD172B5E",IsDefinitive:"true",LabelText:"STR@L_InsertBelow"}},{name:"Button",attrs:{Id:"floatiebtnInsertColumnLeft",Command:"0x3C041B80",IsDefinitive:"true",Image16by16:"IMGMAP@one@InsertColumnsLeft_16x16x32",LabelText:"STR@L_InsertLeft"}},{name:"Button",attrs:{Id:"floatiebtnInsertColumnRight",Command:"0x6773C219",IsDefinitive:"true",Image16by16:"IMGMAP@one@InsertColumnsRight_16x16x32",LabelText:"STR@L_InsertRight"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_Delete",Id:"floatieidTableDelete",Command:"0x2F9A3D80",Image24by24:"IMGMAP@one@TableDeleteMenu_24x24x32",LabelText:"STR@L_Delete",DisplayMode:"FloatieLarge"},children:[{name:"Menu",attrs:{Id:"floatiemenuTableDelete"},children:[{name:"MenuSection",attrs:{Id:"floatiemsTableDelete",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"floatiebtnTableDelete",Command:"0x6C7624AB",IsDefinitive:"true",Image16by16:"IMGMAP@one@TableDeleteMenu_16x16x32",LabelText:"STR@L_DeleteTable"}},{name:"Button",attrs:{Id:"floatiebtnRowDelete",Command:"0x518E0B87",IsDefinitive:"true",Image16by16:"IMGMAP@one@DeleteRows_16x16x32",LabelText:"STR@L_DeleteRow"}},{name:"Button",attrs:{Id:"floatiebtnColumnDelete",Command:"0xB1CE5D9F",IsDefinitive:"true",Image16by16:"IMGMAP@one@DeleteColumns_16x16x32",LabelText:"STR@L_DeleteColumn"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_Select",Id:"floatieidTableSelect",Command:"0x2F9A3D80",Image24by24:"IMGMAP@one@SelectTable_24x24x32",LabelText:"STR@L_Select",DisplayMode:"FloatieLarge"},children:[{name:"Menu",attrs:{Id:"floatiemenuTableSelect"},children:[{name:"MenuSection",attrs:{Id:"floatiemsTableSelect",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.SelectMenu.Controls"},children:[{name:"Button",attrs:{Id:"floatiebtnSelectTable",Command:"0x8980B8D6",IsDefinitive:"true",Image16by16:"IMGMAP@one@SelectTable_16x16x32",LabelText:"STR@L_SelectTable"}},{name:"Button",attrs:{Id:"floatiebtnSelectColumn",Command:"0x8B95D5D4",IsDefinitive:"true",Image16by16:"IMGMAP@one@SelectColumn_16x16x32",LabelText:"STR@L_SelectColumn"}},{name:"Button",attrs:{Id:"floatiebtnSelectRow",Command:"0xD117E3D2",IsDefinitive:"true",Image16by16:"IMGMAP@one@SelectRow_16x16x32",LabelText:"STR@L_SelectRow"}},{name:"Button",attrs:{Id:"floatiebtnSelectCell",Command:"0x06A11EAE",IsDefinitive:"true",Image16by16:"IMGMAP@one@SelectCell_16x16x32",LabelText:"STR@L_SelectCell"}}]}]}]}]}]}]}]}]},{name:"TouchGroup",attrs:{Id:"ContextMenuGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ContextMenuDropdownFloatie",Command:"0x2F9A3D80",FloatieContextMenuDropDown:"True",HideDefaultArrow:"True",Image24by24:"IMGMAP@one@DownArrow_24x24x32",DisplayMode:"FloatieLarge",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0x9134611D"}}]}]}]}]}]}]}]},window.MathRecognizerAlternatesFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"MathEducationFloatie",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{}}]}]},window.InsertTabData={name:"CommandUI",attrs:{},children:[{name:"Tab",attrs:{Id:"tabInsert",Description:"",Title:"STR@L_TabInsert",Keytip:"STR@l_TabInsertKeytip"},children:[{name:"Scaling",attrs:{Id:"Insert.Scaling"},children:[{name:"MaxSize",attrs:{Id:"grpInsertNotebook.Scaling.MaxSize",Sequence:"10",GroupId:"grpNotebook",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpInsertTables.Scaling.MaxSize",Sequence:"20",GroupId:"grpInsertTables",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpIllustrations.Scaling.MaxSize",Sequence:"30",GroupId:"grpIllustrations",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpFiles.Scaling.MaxSize",Sequence:"40",GroupId:"grpFiles",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpInsertApps.Scaling.MaxSize",Sequence:"50",GroupId:"grpInsertApps",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpInsertLinks.Scaling.MaxSize",Sequence:"60",GroupId:"grpInsertLinks",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpRecording.Scaling.MaxSize",Sequence:"70",GroupId:"grpRecording",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpInsertSymbols.Scaling.MaxSize",Sequence:"80",GroupId:"grpInsertSymbols",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpInsertEmojis.Scaling.MaxSize",Sequence:"90",GroupId:"grpInsertEmojis",Size:"Large"}}]},{name:"Groups",attrs:{Id:"Insert.Groups"},children:[{name:"Group",attrs:{Id:"grpNotebook",Description:"",Title:"STR@L_GroupNotebook",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpNotebook.Controls"},children:[{name:"Button",attrs:{Id:"fseaNew",Command:"0x1F15EF8B",IsDefinitive:"true",Image16by16:"IMGMAP@one@JotNewPageAtSectionEnd_16x16x32",Image32by32:"IMGMAP@box42@New_32x32x32",LabelText:"STR@L_NewPage",TemplateAlias:"button1",Keytip:"STR@l_NewPageKeytip"}},{name:"Button",attrs:{Id:"fseaNewSection",Command:"0xA20EA835",Image16by16:"IMGMAP@one@JotInsertSection_16x16x32",Image32by32:"IMGMAP@box42@JotInsertSection_32x32x32",LabelText:"STR@L_NewSection",TemplateAlias:"button2",Keytip:"STR@l_NewSectionKeytip"}}]}]},{name:"Group",attrs:{Id:"grpInsertTables",Description:"",Title:"STR@L_GroupTables",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"InsertTable.Controls"},children:[{name:"FlyoutAnchor",attrs:{Id:"flyInsertTable",Alt:"STR@L_Table",Image32by32:"IMGMAP@box42@Table_32x32x32",Image16by16:"IMGMAP@box42@AddTablePlaceholder_16x16x32",LabelText:"STR@L_Table",Command:"0x01B68595",TemplateAlias:"button1",Keytip:"STR@l_TableKeytip"},children:[{name:"Menu",attrs:{Id:"menuInsertTable"},children:[{name:"MenuSection",attrs:{Id:"msInserTable",Title:"STR@L_MenuInsertTable"},children:[{name:"Controls",attrs:{Id:"Insert.Table.Menu.Controls"},children:[{name:"InsertTable",attrs:{Id:"insertTable",Alt:"STR@L_MenuInsertTableGrid",Command:"0x3A21CA91",IsDefinitive:"true",MenuSectionInitialTitle:"STR@L_MenuInsertTable",MenuSectionTitle:"STR@L_MenuInsertTableGrid"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpIllustrations",Description:"",Title:"STR@L_GroupMedia",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"fseaInsertPicture",Command:"0x9F2ED567",Image32by32:"IMGMAP@box42@InsertPicture_32x32x32",LabelText:"STR@L_Picture",TemplateAlias:"button1",Keytip:"STR@l_PictureKeytip"}},{name:"Button",attrs:{Id:"fseaInsertCameraPicture",Command:"0xAEFC9682",Image32by32:"IMGMAP@box42@Camera_32x32x32",LabelText:"STR@L_Camera",TemplateAlias:"button2",Keytip:"STR@l_CameraKeytip"}},{name:"Button",attrs:{Id:"fseaInsertClipart",Command:"0x91888286",Image32by32:"IMGMAP@box42@ClipArt_32x32x32",LabelText:"STR@L_ClipArt",TemplateAlias:"button3",Keytip:"STR@l_ClipArtKeytip"}},{name:"Button",attrs:{Id:"fseaInsertOnlinePicture",Command:"0x647E1FB6",Image32by32:"IMGMAP@box42@ClipArt_32x32x32",LabelText:"STR@L_OnlinePicture",TemplateAlias:"button4",Keytip:"STR@l_OneNoteOnlinePictureKeytip"}},{name:"Button",attrs:{Id:"fseaInsertOnlinePictureFromHost",Command:"0x2AEC2180",QueryCommand:"0xD7527DDC",Image32by32:"IMGMAP@box42@InsertFromHost_32x32x32",LabelText:"STR@L_OnlinePictureFromHost",TemplateAlias:"button4",Keytip:"STR@l_OnlinePictureFromHostKeytip"}},{name:"FlyoutAnchor",attrs:{Id:"flyOnlinePicture",Alt:"STR@L_OnlinePicture",Image32by32:"IMGMAP@box42@ClipArt_32x32x32",LabelText:"STR@L_OnlinePicture",Command:"0x568463EB",TemplateAlias:"button4",Keytip:"STR@l_OneNoteOnlinePictureKeytip"},children:[{name:"Menu",attrs:{Id:"menuOnlinePicture"},children:[{name:"MenuSection",attrs:{Id:"msAllOnlinePicture",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlOnlinePicture"},children:[{name:"Button",attrs:{Id:"fseaFlyInsertOnlinePictureFromSearch",Command:"0x647E1FB6",Image32by32:"IMGMAP@box42@SourceIcon_Bing_32x32x32",MenuItemId:"buttonOnlinePicture",LabelText:"STR@L_OnlinePictureFromBing",Keytip:"STR@l_OnlinePictureFromBingKeytip"}},{name:"Button",attrs:{Id:"fseaFlyInsertOnlinePictureFromHost",Command:"0x2AEC2180",QueryCommand:"0xD7527DDC",Image32by32:"IMGMAP@box42@InsertFromHost_32x32x32",MenuItemId:"buttonOnlinePictureFromHost",LabelText:"STR@L_OnlinePictureFromHost",Keytip:"STR@l_OnlinePictureFromHostKeytip"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpFiles",Description:"",Title:"STR@L_GroupFiles",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpFiles.Controls"},children:[{name:"Button",attrs:{Id:"fseaInsertPrintout",Command:"0x8E58173A",Image32by32:"IMGMAP@one@InsertFileAsPrintout_32x32x32",LabelText:"STR@L_FilePrintout",TemplateAlias:"button1",Keytip:"STR@l_FilePrintoutKeytip"}},{name:"Button",attrs:{Id:"fseaInsertFile",Command:"0xF0EEBC31",Image32by32:"IMGMAP@one@Attachment_32x32x32",LabelText:"STR@L_FileAttachment",TemplateAlias:"button2",Keytip:"STR@l_FileAttachmentKeytip"}}]}]},{name:"Group",attrs:{Id:"grpInsertApps",Title:"STR@L_GroupApps",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"0",Command:"0x73F24D27",Image32by32:"IMGMAP@box43@AppForOfficeLogo_32x32x32",LabelText:"STR@L_ButtonOfficeAddins",TemplateAlias:"button1",Keytip:"STR@l_OneNoteButtonOfficeAddinsKeytip"}}]}]},{name:"Group",attrs:{Id:"grpInsertLinks",Description:"",Title:"STR@L_GroupLinks",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"ctrlInsert"},children:[{name:"Button",attrs:{Id:"fseaInsertHyperlink",Command:"0xA19EE2D9",Image32by32:"IMGMAP@box42@WebInsertHyperlink_32x32x32",Image16by16:"IMGMAP@one@WebInsertHyperlink_16x16x32",LabelText:"STR@L_Hyperlink",TemplateAlias:"button1",Keytip:"STR@l_OneNoteHyperlinkKeytip"}}]}]},{name:"Group",attrs:{Id:"grpRecording",Description:"",Title:"STR@L_GroupRecording",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Audio.Tools.Recording.Controls"},children:[{name:"Button",attrs:{Id:"btnRecordAudio",Command:"0xFAD3C65F",Image32by32:"IMGMAP@one@JotAudioStartRecording_32x32x32",LabelText:"STR@L_RecordAudio",TemplateAlias:"button1",Keytip:"STR@l_RecordAudioKeytip"}}]}]},{name:"Group",attrs:{Id:"grpInsertSymbols",Description:"",Title:"STR@L_SymbolPlural",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"InsertSymbols.Controls"},children:[{name:"FlyoutAnchor",attrs:{Id:"flyInsertSymbols",QueryCommand:"0x4B3AE448",Command:"0xCEF0A7DA",LabelText:"STR@L_SymbolSingle",Image32by32:"IMGMAP@box42@Symbol_32x32x32",TemplateAlias:"button1",PopulateDynamically:"true",PopulateOnlyOnce:"true",PopulateQueryCommand:"0x4AE49BE0",Keytip:"STR@l_SymbolSingleKeytip"}}]}]},{name:"Group",attrs:{Id:"grpInsertEmojis",Description:"",Title:"STR@L_EmojiPlural",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"InsertSymbols.Controls"},children:[{name:"FlyoutAnchor",attrs:{Id:"flyInsertEmojis",QueryCommand:"0x02227030",Command:"0xB2763270",LabelText:"STR@L_EmojiSingle",Image32by32:"IMGMAP@box42@SendASmile_32x32x32",TemplateAlias:"button1",PopulateDynamically:"true",PopulateOnlyOnce:"true",PopulateQueryCommand:"0x4309CEC2",Keytip:"STR@l_EmojiSingleKeytip"}}]}]}]}]}]},window.DrawTabData={name:"CommandUI",attrs:{},children:[{name:"Tab",attrs:{Id:"tabDraw",Description:"",Title:"STR@L_TabDraw",Keytip:"STR@l_TabDrawKeytip"},children:[{name:"Scaling",attrs:{Id:"Draw.Scaling"},children:[{name:"MaxSize",attrs:{Id:"grpUndoRedo.Scaling.MaxSize",Sequence:"10",GroupId:"grpUndoRedo",Size:"Small"}},{name:"MaxSize",attrs:{Id:"grpTools.Scaling.MaxSize",Sequence:"20",GroupId:"grpTools",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpColor.Scaling.MaxSize",Sequence:"30",GroupId:"grpColor",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpStyle.Scaling.MaxSize",Sequence:"40",GroupId:"grpStyle",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpMath.Scaling.MaxSize",Sequence:"50",GroupId:"grpMath",Size:"Large"}}]},{name:"Groups",attrs:{Id:"Draw.Groups"},children:[{name:"Group",attrs:{Id:"grpUndoRedo",Title:"STR@L_GroupUndoRedo",Template:"tmpUndoRedo"},children:[{name:"Controls",attrs:{Id:"ctrlUndoRedo"},children:[{name:"Button",attrs:{Id:"btnUndo",Command:"0xA66C4568",Image16by16:"IMGMAP@one@Undo_16x16x32",LabelText:"STR@L_Undo",TemplateAlias:"undo",Keytip:"STR@l_UndoKeytip"}},{name:"Button",attrs:{Id:"btnRedo",Command:"0xF957BFBE",Image16by16:"IMGMAP@one@Redo_16x16x32",LabelText:"STR@L_Redo",TemplateAlias:"redo",Keytip:"STR@l_RedoKeytip"}}]}]},{name:"Group",attrs:{Id:"grpTools",Description:"",Title:"STR@L_GroupTools",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpTools.Controls"},children:[{name:"ToggleButton",attrs:{Id:"fseaExitInkingOrEraserMode",Alt:"STR@L_Type",Command:"0x744A45EC",Image32by32:"IMGMAP@one@JotPenSelect_32x32x32",LabelText:"STR@L_Type",QueryCommand:"0x672FDBC9",TogglesWhenExecuted:"false",TemplateAlias:"button1"}},{name:"ToggleButton",attrs:{Id:"fseaEnterMarqueeSelectMode",Alt:"STR@L_MarqueeSelect",Command:"0xCB8AD0E1",Image32by32:"IMGMAP@one@MarqueeSelect_32x32x32",LabelText:"STR@L_MarqueeSelect",QueryCommand:"0x9D14BE67",TogglesWhenExecuted:"false",TemplateAlias:"button2"}},{name:"ToggleButton",attrs:{Id:"fseaEnterEraserMode",Alt:"STR@L_Eraser",Command:"0x9272B25D",Image32by32:"IMGMAP@one@JotEraserStyle2_32x32x32",LabelText:"STR@L_Eraser",QueryCommand:"0xE3DE21AF",TogglesWhenExecuted:"false",TemplateAlias:"button3"}},{name:"ToggleButton",attrs:{Id:"fseaEnterInkingPenMode",Alt:"STR@L_Pen",Command:"0xFB0534D8",Image32by32:"IMGMAP@one@136_16_N_32x32x32",LabelText:"STR@L_Pen",QueryCommand:"0x3E2989A6",TogglesWhenExecuted:"false",TemplateAlias:"button4"}},{name:"ToggleButton",attrs:{Id:"fseaEnterInkingHighlighterMode",Alt:"STR@L_Highlighter",Command:"0x1DE51B1C",Image32by32:"IMGMAP@one@HighlightWithColor_32x32x32",LabelText:"STR@L_Highlighter",QueryCommand:"0x6177E3C2",TogglesWhenExecuted:"false",TemplateAlias:"button5"}}]}]},{name:"Group",attrs:{Id:"grpColor",Description:"",Title:"STR@L_GroupColor",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpColor.Controls"},children:[{name:"ToggleButton",attrs:{Id:"fseaInkShorthandColor_0",Alt:"STR@L_InkColor_Black",Command:"0x5414C929",Image32by32:"IMGMAP@one@InkColorCircle_Black_32x32x32",LabelText:"STR@L_InkColor_Black",QueryCommand:"0x04C600D0",TogglesWhenExecuted:"false",TemplateAlias:"button1"}},{name:"ToggleButton",attrs:{Id:"fseaInkShorthandColor_1",Alt:"STR@L_InkColor_Blue",Command:"0x5414C929",Image32by32:"IMGMAP@one@InkColorCircle_Blue_32x32x32",LabelText:"STR@L_InkColor_Blue",QueryCommand:"0x04C600D0",TogglesWhenExecuted:"false",TemplateAlias:"button2"}},{name:"ToggleButton",attrs:{Id:"fseaInkShorthandColor_2",Alt:"STR@L_InkColor_DarkGreen",Command:"0x5414C929",Image32by32:"IMGMAP@one@InkColorCircle_Green_32x32x32",LabelText:"STR@L_InkColor_DarkGreen",QueryCommand:"0x04C600D0",TogglesWhenExecuted:"false",TemplateAlias:"button3"}},{name:"ToggleButton",attrs:{Id:"fseaInkShorthandColor_3",Alt:"STR@L_InkColor_Red",Command:"0x5414C929",Image32by32:"IMGMAP@one@InkColorCircle_Red_32x32x32",LabelText:"STR@L_InkColor_Red",QueryCommand:"0x04C600D0",TogglesWhenExecuted:"false",TemplateAlias:"button4"}},{name:"FlyoutAnchor",attrs:{Id:"flyInkColor",Alt:"STR@L_InkColor",Image32by32:"IMGMAP@one@Color_32x32x32",LabelText:"STR@L_InkColor",Command:"0x568463EB",TemplateAlias:"button5"},children:[{name:"Menu",attrs:{Id:"menuInkColor"},children:[{name:"MenuSection",attrs:{Id:"inkColor"},children:[{name:"Controls",attrs:{Id:"Ink.Color.Controls"},children:[{name:"ColorPicker",attrs:{Id:"inkColor",Command:"0x8B75738B",Width:"4"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"C62938",Alt:"STR@L_InkColor_Red",DisplayColor:"#C62938"}},{name:"Color",attrs:{Color:"FA931E",Alt:"STR@L_InkColor_Orange",DisplayColor:"#FA931E"}},{name:"Color",attrs:{Color:"FFCE1F",Alt:"STR@L_InkColor_Gold",DisplayColor:"#FFCE1F"}},{name:"Color",attrs:{Color:"FAF320",Alt:"STR@L_InkColor_Yellow",DisplayColor:"#FAF320"}},{name:"Color",attrs:{Color:"A4E617",Alt:"STR@L_InkColor_Green",DisplayColor:"#A4E617"}},{name:"Color",attrs:{Color:"167D1D",Alt:"STR@L_InkColor_DarkGreen",DisplayColor:"#167D1D"}},{name:"Color",attrs:{Color:"86FF56",Alt:"STR@L_InkColor_LightGreen",DisplayColor:"#86FF56"}},{name:"Color",attrs:{Color:"3DB8FF",Alt:"STR@L_InkColor_SkyBlue",DisplayColor:"#3DB8FF"}},{name:"Color",attrs:{Color:"1353BA",Alt:"STR@L_InkColor_Blue",DisplayColor:"#1353BA"}},{name:"Color",attrs:{Color:"8252D1",Alt:"STR@L_InkColor_Purple",DisplayColor:"#8252D1"}},{name:"Color",attrs:{Color:"FF73A6",Alt:"STR@L_InkColor_Pink",DisplayColor:"#FF73A6"}},{name:"Color",attrs:{Color:"904C15",Alt:"STR@L_InkColor_Brown",DisplayColor:"#904C15"}},{name:"Color",attrs:{Color:"404040",Alt:"STR@L_InkColor_Black",DisplayColor:"#404040"}},{name:"Color",attrs:{Color:"808080",Alt:"STR@L_InkColor_DarkGray",DisplayColor:"#808080"}},{name:"Color",attrs:{Color:"BFBFBF",Alt:"STR@L_InkColor_LightGray",DisplayColor:"#BFBFBF"}},{name:"Color",attrs:{Color:"FFFFFF",Alt:"STR@L_InkColor_White",DisplayColor:"#FFFFFF"}}]}]}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpStyle",Description:"",Title:"STR@L_GroupStyle",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpStyle.Controls"},children:[{name:"FlyoutAnchor",attrs:{Id:"flyChangeInkThickness",Alt:"STR@L_InkThickness",QueryCommand:"0x1AB6AD34",Command:"0xDC0605B1",LabelText:"STR@L_InkThickness",Image32by32:"IMGMAP@one@GalLineWidth_32x32x32",TemplateAlias:"button2",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0x73ABB39F"}}]}]},{name:"Group",attrs:{Id:"grpMath",Title:"STR@L_Math",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"ctrlMath"},children:[{name:"Button",attrs:{Id:"btnMath",Command:"0x65DFA73B",QueryCommand:"0x902360C5",Image32by32:"IMGMAP@one@Math_32x32x32",LabelText:"STR@L_Math",TemplateAlias:"button1",Keytip:"STR@l_EnterMathEducationModeKeytip"}},{name:"SplitButton",attrs:{Id:"sbMath",Alt:"STR@L_Math",LabelText:"STR@L_Math",Command:"0x65DFA73B",QueryCommand:"0xDF9CEBD4",Image32by32:"IMGMAP@one@Math_32x32x32",TemplateAlias:"button2",Visible:"false",Keytip:"STR@l_EnterMathEducationModeKeytip"},children:[{name:"Menu",attrs:{Id:"menuMath"},children:[{name:"MenuSection",attrs:{Id:"msMath",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msMath.Controls"},children:[{name:"Button",attrs:{Id:"fseaMathButton",Command:"0x65DFA73B",LabelText:"STR@L_Math",Keytip:"STR@l_EnterMathEducationModeKeytip"}},{name:"Button",attrs:{Id:"fseaOpenLanguageDialog",Command:"0x42CF620A",LabelText:"STR@L_MathSwitchTurnOnOff",Keytip:"STR@l_EnterMathEducationSwitchKeytip"}}]}]}]}]}]}]}]}]}]},window.HelpTabData={name:"CommandUI",attrs:{},children:[{name:"Tab",attrs:{Id:"tabHelp",Title:"STR@L_Help",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Scaling",attrs:{},children:[{name:"MaxSize",attrs:{Id:"grpHelp.Scaling.MaxSize",Sequence:"0",GroupId:"grpHelp",Size:"Large"}}]},{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"grpHelp",Description:"",Title:"STR@L_GroupHelp",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Alt:"STR@L_Help",Id:"jbtnHelp",Command:"0xADF0D73B",LabelText:"STR@L_Help",Image32by32:"IMGMAP@one@OfficeAssistant_32x32x32",TemplateAlias:"button1",Keytip:"STR@l_HelpButtonTitleKeytip"}},{name:"Button",attrs:{Alt:"STR@L_ContactSupport",Id:"btnContactSupport",Command:"0xADF0D73B",LabelText:"STR@L_ContactSupport",Image32by32:"IMGMAP@one@PSSHelp_32x32x32",TemplateAlias:"button2",Keytip:"STR@l_ContactSupportKeytip"}},{name:"Button",attrs:{Alt:"STR@L_GiveFeedbackShort",Id:"jbtnGiveFeedback",Command:"0x2FD6BDE0",LabelText:"STR@L_GiveFeedbackShort",Image32by32:"IMGMAP@box42@SendASmile_32x32x32",TemplateAlias:"button3",Keytip:"STR@l_GiveFeedbackKeytip"}},{name:"Button",attrs:{Alt:"STR@L_WhatsNew",Id:"btnWhatsNew",Command:"0xADF0D73B",LabelText:"STR@L_WhatsNew",Image32by32:"IMGMAP@one@WhatsNewRecentUpdates_32x32x32",TemplateAlias:"button4",Keytip:"STR@l_WhatsNewKeytip"}}]}]}]}]}]},window.AudioToolsTabData={name:"CommandUI",attrs:{},children:[{name:"Tab",attrs:{Id:"ContextualTabs.Audio.Tools",Description:"",Title:"STR@L_TabAudio",Keytip:"STR@l_TabAudioKeytip"},children:[{name:"Scaling",attrs:{Id:"ContextualTabs.Audio.Tools.Scaling"},children:[{name:"MaxSize",attrs:{Sequence:"10",GroupId:"ContextualTabs.Audio.Tools.Recording",Size:"Large"}},{name:"MaxSize",attrs:{Sequence:"20",GroupId:"ContextualTabs.Audio.Tools.Playback",Size:"Large"}}]},{name:"Groups",attrs:{Id:"ContextualTabs.Audio.Tools.Groups"},children:[{name:"Group",attrs:{Id:"ContextualTabs.Audio.Tools.Recording",Description:"",Title:"STR@L_GroupRecording",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Audio.Tools.Recording.Controls"},children:[{name:"Button",attrs:{Id:"btnRecordAudio",Command:"0xFAD3C65F",Image32by32:"IMGMAP@one@JotAudioStartRecording_32x32x32",LabelText:"STR@L_Record",TemplateAlias:"button1",Keytip:"STR@l_RecordKeytip"}},{name:"Button",attrs:{Id:"btnStopAudioRecording",Command:"0x91C5A363",Image32by32:"IMGMAP@one@StopRecording_32x32x32",LabelText:"STR@L_Stop",TemplateAlias:"button2",Keytip:"STR@l_StopKeytip"}}]}]},{name:"Group",attrs:{Id:"ContextualTabs.Audio.Tools.Playback",Description:"",Title:"STR@L_GroupPlayback",Template:"tmpFourButtonSlider"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Audio.Tools.Playback.Controls"},children:[{name:"Button",attrs:{Id:"btnMediaPlay",Command:"0x29887428",Image32by32:"IMGMAP@one@AnimFxMediaPlay_32x32x32",LabelText:"STR@L_Play",TemplateAlias:"button1",Keytip:"STR@l_PlayKeytip"}},{name:"Button",attrs:{Id:"btnMediaPause",Command:"0x2E81B624",Image32by32:"IMGMAP@one@Pause_32x32x32",LabelText:"STR@L_Pause",TemplateAlias:"button2",Keytip:"STR@l_PauseKeytip"}},{name:"Slider",attrs:{Id:"sldrAudioRibbonSeekBar",LabelId:"sldrAudioRibbonTimeSpan",Command:"0x4783C8FE",QueryCommand:"0x2D4DCB76",LabelText:"0:00",Value:"0",TemplateAlias:"slider1"}},{name:"Button",attrs:{Id:"btnMediaSkipBack",Command:"0x4E9BD6BB",Image32by32:"IMGMAP@one@Skip15SecondsBack_32x32x32",LabelText:"STR@L_Back15Seconds",TemplateAlias:"button3",Keytip:"STR@l_Back15SecondsKeytip"}},{name:"Button",attrs:{Id:"btnMediaSkipForward",Command:"0x0174938B",Image32by32:"IMGMAP@one@Skip15SecondsForward_32x32x32",LabelText:"STR@L_Forward15Seconds",TemplateAlias:"button4",Keytip:"STR@l_Forward15SecondsKeytip"}}]}]}]}]},{name:"Templates",attrs:{},children:[{name:"RibbonTemplates",attrs:{},children:[{name:"GroupTemplate",attrs:{Id:"tmpFourButtonSlider"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"slider1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button4",DisplayMode:"Large"}}]}]}]}]}]}]}]},window.PictureToolsTabData={name:"CommandUI",attrs:{},children:[{name:"Tab",attrs:{Id:"ctabPictureTools",Description:"",Title:"STR@L_TabFormatPicture",Keytip:"STR@l_TabFormatPictureKeytip"},children:[{name:"Scaling",attrs:{},children:[{name:"MaxSize",attrs:{Id:"grpImageSize.Scaling.MaxSize",Sequence:"10",GroupId:"grpImageSize",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpImageSize.Scaling.MaxSize",Sequence:"20",GroupId:"grpImageManipulation",Size:"Large"}}]},{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"grpImageSize",Description:"",Title:"STR@L_GroupImageSize",Template:"tmpONImageSize"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnImageGrow",Command:"0x464C6D12",Image16by16:"IMGMAP@box42@IncreaseSize_16x16x32",LabelText:"STR@L_Grow",TemplateAlias:"grow",Keytip:"STR@l_GrowKeytip"}},{name:"Button",attrs:{Id:"btnImageShrink",Command:"0xF571A3C0",Image16by16:"IMGMAP@box42@DecreaseSize_16x16x32",LabelText:"STR@L_Shrink",TemplateAlias:"shrink",Keytip:"STR@l_ShrinkKeytip"}},{name:"Label",attrs:{Id:"lblScale",LabelText:"STR@L_PictureScaleLabel",TemplateAlias:"scaleLabel"}},{name:"Spinner",attrs:{Id:"spnSize",Alt:"STR@L_PictureScaleTooltip",Command:"0x50D14FC5",QueryCommand:"0x3276C7D7",TemplateAlias:"spinner",Keytip:"STR@l_PictureScaleTooltipKeytip"},children:[{name:"Unit",attrs:{UnitType:"percent",MinimumValue:".1",MaximumValue:"128000",Step:"1"}}]},{name:"ToggleButton",attrs:{Id:"toggleBtnLockAspectRatio",Command:"0xC8D54EAD",UseCheckMark:"true",QueryCommand:"0xFA6A61DB",UseUncheckedImage:"true",LabelText:"STR@L_LockAspectRatio",TemplateAlias:"toggleButtonLockAspectRatio",Keytip:"STR@l_LockAspectRatioKeytip"}},{name:"Label",attrs:{Id:"lblAbsoluteHeight",Image16by16:"IMGMAP@box42@SizeToControlHeight_16x16x32",LabelText:"STR@L_PictureHeightLabel",TemplateAlias:"labelAbsoluteHeight"}},{name:"Label",attrs:{Id:"lblAbsoluteWidth",Image16by16:"IMGMAP@box42@SizeToControlWidth_16x16x32",LabelText:"STR@L_PictureWidthLabel",TemplateAlias:"labelAbsoluteWidth"}},{name:"Label",attrs:{Id:"lblDummyLabelForProperAlignmentOfImageSize",LabelText:"",TemplateAlias:"labelDummy"}},{name:"Spinner",attrs:{Id:"spnAbsoluteHeight",Alt:"STR@L_PictureHeightTooltip",Command:"0xA7600729",QueryCommand:"0x8204A835",TemplateAlias:"spinnerAbsoluteHeight",Keytip:"STR@l_PictureHeightTooltipKeytip"},children:[{name:"Unit",attrs:{UnitType:"inch",MinimumValue:"0.01",MaximumValue:"13.33",Step:"0.1"}},{name:"Unit",attrs:{UnitType:"centimeter",MinimumValue:"0.03",MaximumValue:"33.85",Step:"1"}},{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"1",MaximumValue:"1280",Step:"1"}}]},{name:"Spinner",attrs:{Id:"spnAbsoluteWidth",Alt:"STR@L_PictureWidthTooltip",Command:"0xB94B8FBA",QueryCommand:"0x74DFCD5E",TemplateAlias:"spinnerAbsoluteWidth",Keytip:"STR@l_PictureWidthTooltipKeytip"},children:[{name:"Unit",attrs:{UnitType:"inch",MinimumValue:"0.01",MaximumValue:"20",Step:"0.1"}},{name:"Unit",attrs:{UnitType:"centimeter",MinimumValue:"0.03",MaximumValue:"50.8",Step:"1"}},{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]},{name:"Button",attrs:{Id:"btnImageCropDialog",Command:"0xEF945B15",Image32by32:"IMGMAP@box42@Crop_32x32x32",LabelText:"STR@L_Crop",TemplateAlias:"crop",Keytip:"STR@l_CropKeytip"}}]}]}]}]},{name:"Templates",attrs:{},children:[{name:"RibbonTemplates",attrs:{},children:[{name:"GroupTemplate",attrs:{Id:"tmpONImageSize"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"grow",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"shrink",DisplayMode:"Medium"}}]}]},{name:"Section",attrs:{Type:"Divider"}},{name:"Section",attrs:{Type:"OneRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"scaleLabel",DisplayMode:"Medium"}},{name:"ControlRef",attrs:{TemplateAlias:"spinner",DisplayMode:"Medium"}}]}]},{name:"Section",attrs:{Type:"Divider"}},{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"toggleButtonLockAspectRatio",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"labelAbsoluteHeight",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"labelAbsoluteWidth",DisplayMode:"Medium"}}]}]},{name:"Section",attrs:{Type:"Divider"}},{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"labelDummy",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"spinnerAbsoluteHeight",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"spinnerAbsoluteWidth",DisplayMode:"Medium"}}]}]},{name:"Section",attrs:{Type:"Divider"}},{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"crop",DisplayMode:"Large"}}]}]}]}]}]}]}]},window.TableLayoutTabData={name:"CommandUI",attrs:{},children:[{name:"Tab",attrs:{Id:"ContextualTabs.Tables.Layout",Description:"",Title:"STR@L_TabLayout",Keytip:"STR@l_TabLayoutKeytip"},children:[{name:"Scaling",attrs:{Id:"ContextualTabs.Tables.Layout.Scaling"},children:[{name:"MaxSize",attrs:{Sequence:"0",GroupId:"ContextualTabs.Tables.Layout.Select",Size:"Large"}},{name:"MaxSize",attrs:{Sequence:"0",GroupId:"ContextualTabs.Tables.Layout.Delete",Size:"Large"}},{name:"MaxSize",attrs:{Sequence:"0",GroupId:"ContextualTabs.Tables.Layout.Insert",Size:"Large"}},{name:"MaxSize",attrs:{Sequence:"0",GroupId:"ContextualTabs.Tables.Layout.Borders",Size:"Large"}},{name:"MaxSize",attrs:{Sequence:"0",GroupId:"ContextualTabs.Tables.Layout.Alignment",Size:"Large"}},{name:"MaxSize",attrs:{Sequence:"0",GroupId:"ContextualTabs.Tables.Layout.Shading",Size:"Large"}},{name:"Scale",attrs:{Sequence:"10",GroupId:"ContextualTabs.Tables.Layout.Select",Size:"Medium"}},{name:"Scale",attrs:{Sequence:"15",GroupId:"ContextualTabs.Tables.Layout.Alignment",Size:"Medium"}},{name:"Scale",attrs:{Sequence:"20",GroupId:"ContextualTabs.Tables.Layout.Delete",Size:"Medium"}},{name:"Scale",attrs:{Sequence:"30",GroupId:"ContextualTabs.Tables.Layout.Insert",Size:"Medium"}},{name:"Scale",attrs:{Sequence:"40",GroupId:"ContextualTabs.Tables.Layout.Select",Size:"Small"}},{name:"Scale",attrs:{Sequence:"50",GroupId:"ContextualTabs.Tables.Layout.Insert",Size:"Small"}},{name:"Scale",attrs:{Sequence:"55",GroupId:"ContextualTabs.Tables.Layout.Alignment",Size:"Small"}},{name:"Scale",attrs:{Sequence:"60",GroupId:"ContextualTabs.Tables.Layout.Select",Size:"Collapsed"}},{name:"Scale",attrs:{Sequence:"70",GroupId:"ContextualTabs.Tables.Layout.Delete",Size:"Collapsed"}}]},{name:"Groups",attrs:{Id:"ContextualTabs.Tables.Layout.Groups"},children:[{name:"Group",attrs:{Id:"ContextualTabs.Tables.Layout.Select",Description:"",Title:"STR@L_GroupSelect",Template:"tmpFourButton"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.Select.Controls"},children:[{name:"Button",attrs:{Id:"btnSelectTable",Command:"0x8980B8D6",Image32by32:"IMGMAP@box42@TableSelectTable_32x32x32",Image16by16:"IMGMAP@one@SelectTable_16x16x32",LabelText:"STR@L_SelectTable",TemplateAlias:"button1",Keytip:"STR@l_OneNoteSelectTableKeytip"}},{name:"Button",attrs:{Id:"btnSelectColumn",Command:"0x8B95D5D4",Image32by32:"IMGMAP@box42@TableSelectColumn_32x32x32",Image16by16:"IMGMAP@one@SelectColumn_16x16x32",LabelText:"STR@L_SelectColumn",TemplateAlias:"button2",Keytip:"STR@l_OneNoteSelectColumnKeytip"}},{name:"Button",attrs:{Id:"btnSelectRow",Command:"0xD117E3D2",Image32by32:"IMGMAP@box42@TableSelectRow_32x32x32",Image16by16:"IMGMAP@one@SelectRow_16x16x32",LabelText:"STR@L_SelectRow",TemplateAlias:"button3",Keytip:"STR@l_OneNoteSelectRowKeytip"}},{name:"Button",attrs:{Id:"btnSelectCell",Command:"0x06A11EAE",Image32by32:"IMGMAP@box42@TableSelectCell_32x32x32",Image16by16:"IMGMAP@one@SelectCell_16x16x32",LabelText:"STR@L_SelectCell",TemplateAlias:"button4",Keytip:"STR@l_OneNoteSelectCellKeytip"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_Select",Command:"0x2F9A3D80",Id:"idTableSelect",Image32by32:"IMGMAP@box42@TableSelectTable_32x32x32",LabelText:"STR@L_Select",TemplateAlias:"flyout",Keytip:"STR@l_SelectKeytip"},children:[{name:"Menu",attrs:{Id:"menuTableSelect"},children:[{name:"MenuSection",attrs:{Id:"msTableSelect",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.SelectMenu.Controls"},children:[{name:"Button",attrs:{Id:"btnSelectTable",Command:"0x8980B8D6",Image32by32:"IMGMAP@box42@TableSelectTable_32x32x32",Image16by16:"IMGMAP@one@SelectTable_16x16x32",LabelText:"STR@L_SelectTable",Keytip:"STR@l_OneNoteSelectTableKeytip"}},{name:"Button",attrs:{Id:"btnSelectColumn",Command:"0x8B95D5D4",Image32by32:"IMGMAP@box42@TableSelectColumn_32x32x32",Image16by16:"IMGMAP@one@SelectColumn_16x16x32",LabelText:"STR@L_SelectColumn",Keytip:"STR@l_OneNoteSelectColumnKeytip"}},{name:"Button",attrs:{Id:"btnSelectRow",Command:"0xD117E3D2",Image32by32:"IMGMAP@box42@TableSelectRow_32x32x32",Image16by16:"IMGMAP@one@SelectRow_16x16x32",LabelText:"STR@L_SelectRow",Keytip:"STR@l_OneNoteSelectRowKeytip"}},{name:"Button",attrs:{Id:"btnSelectCell",Command:"0x06A11EAE",Image32by32:"IMGMAP@box42@TableSelectCell_32x32x32",Image16by16:"IMGMAP@one@SelectCell_16x16x32",LabelText:"STR@L_SelectCell",Keytip:"STR@l_OneNoteSelectCellKeytip"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"ContextualTabs.Tables.Layout.Delete",Description:"",Title:"STR@L_GroupDelete",Template:"tmpThreeButton"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.Delete.Controls"},children:[{name:"Button",attrs:{Id:"btnTableDelete",Command:"0x6C7624AB",Image32by32:"IMGMAP@box42@TableDeleteMenu_32x32x32",Image16by16:"IMGMAP@one@TableDeleteMenu_16x16x32",LabelText:"STR@L_DeleteTable",TemplateAlias:"button1",Keytip:"STR@l_OneNoteDeleteTableKeytip"}},{name:"Button",attrs:{Id:"btnColumnDelete",Command:"0xB1CE5D9F",Image32by32:"IMGMAP@box42@TableDeleteColumn_32x32x32",Image16by16:"IMGMAP@one@DeleteColumns_16x16x32",LabelText:"STR@L_DeleteColumn",TemplateAlias:"button2",Keytip:"STR@l_OneNoteDeleteColumnKeytip"}},{name:"Button",attrs:{Id:"btnRowDelete",Command:"0x518E0B87",Image32by32:"IMGMAP@box42@TableDeleteRow_32x32x32",Image16by16:"IMGMAP@one@DeleteRows_16x16x32",LabelText:"STR@L_DeleteRow",TemplateAlias:"button3",Keytip:"STR@l_OneNoteDeleteRowKeytip"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_Delete",Command:"0x2F9A3D80",Id:"idTableDelete",Image32by32:"IMGMAP@box42@TableDeleteMenu_32x32x32",LabelText:"STR@L_Delete",TemplateAlias:"flyout",Keytip:"STR@l_DeleteKeytip"},children:[{name:"Menu",attrs:{Id:"menuTableDelete"},children:[{name:"MenuSection",attrs:{Id:"msTableDelete",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.DeleteMenu.Controls"},children:[{name:"Button",attrs:{Id:"btnTableDelete",Command:"0x6C7624AB",Image32by32:"IMGMAP@box42@TableDeleteMenu_32x32x32",Image16by16:"IMGMAP@one@TableDeleteMenu_16x16x32",LabelText:"STR@L_DeleteTable",Keytip:"STR@l_DeleteTableKeytip"}},{name:"Button",attrs:{Id:"btnColumnDelete",Command:"0xB1CE5D9F",Image32by32:"IMGMAP@box42@TableDeleteColumn_32x32x32",Image16by16:"IMGMAP@one@DeleteColumns_16x16x32",LabelText:"STR@L_DeleteColumn",Keytip:"STR@l_DeleteColumnKeytip"}},{name:"Button",attrs:{Id:"btnRowDelete",Command:"0x518E0B87",Image32by32:"IMGMAP@box42@TableDeleteRow_32x32x32",Image16by16:"IMGMAP@one@DeleteRows_16x16x32",LabelText:"STR@L_DeleteRow",Keytip:"STR@l_DeleteRowKeytip"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"ContextualTabs.Tables.Layout.Insert",Description:"",Title:"STR@L_GroupInsert",Template:"tmpFourButton"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.Insert.Controls"},children:[{name:"Button",attrs:{Id:"btnInsertRowAbove",Command:"0x8138CF12",Image32by32:"IMGMAP@box42@InsertRowsAbove_32x32x32",Image16by16:"IMGMAP@one@InsertRowsAbove_16x16x32",LabelText:"STR@L_InsertAbove",TemplateAlias:"button1",Keytip:"STR@l_OneNoteInsertAboveKeytip"}},{name:"Button",attrs:{Id:"btnInsertRowBelow",Command:"0xDD172B5E",Image32by32:"IMGMAP@box42@InsertRowsBelow_32x32x32",Image16by16:"IMGMAP@one@InsertRowsBelow_16x16x32",LabelText:"STR@L_InsertBelow",TemplateAlias:"button2",Keytip:"STR@l_OneNoteInsertBelowKeytip"}},{name:"Button",attrs:{Id:"btnInsertColumnLeft",Command:"0x3C041B80",Image32by32:"IMGMAP@box42@InsertColumnsLeft_32x32x32",Image16by16:"IMGMAP@one@InsertColumnsLeft_16x16x32",LabelText:"STR@L_InsertLeft",TemplateAlias:"button3",Keytip:"STR@l_InsertLeftKeytip"}},{name:"Button",attrs:{Id:"btnInsertColumnRight",Command:"0x6773C219",Image32by32:"IMGMAP@box42@InsertColumnsRight_32x32x32",Image16by16:"IMGMAP@one@InsertColumnsRight_16x16x32",LabelText:"STR@L_InsertRight",TemplateAlias:"button4",Keytip:"STR@l_OneNoteInsertRightKeytip"}}]}]},{name:"Group",attrs:{Id:"ContextualTabs.Tables.Layout.Borders",Description:"",Title:"STR@L_GroupBorders",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.Borders.Controls"},children:[{name:"ToggleButton",attrs:{Id:"btnHideBorders",Command:"0x6C020651",QueryCommand:"0x0B155E1B",Image32by32:"IMGMAP@box42@TableHideBorders_32x32x32",LabelText:"STR@L_HideBorders",Alt:"STR@L_HideBorders",TemplateAlias:"button1",Keytip:"STR@l_HideBordersKeytip"}}]}]},{name:"Group",attrs:{Id:"ContextualTabs.Tables.Layout.Alignment",Description:"",Title:"STR@L_GroupAlignment",Template:"tmpThreeButton"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.Alignment.Controls"},children:[{name:"ToggleButton",attrs:{Id:"LeftJustify",Command:"0x6F4BD314",QueryCommand:"0xE25D77A3",Image16by16:"IMGMAP@one@LeftJustify_16x16x32",Image32by32:"IMGMAP@box42@LeftJustify_32x32x32",LabelText:"STR@L_AlignLeft",TemplateAlias:"button1",Keytip:"STR@l_AlignLeftKeytip"}},{name:"ToggleButton",attrs:{Id:"CenterJustify",Command:"0xC6A376F8",QueryCommand:"0xC27E85BB",Image16by16:"IMGMAP@one@Centered_16x16x32",Image32by32:"IMGMAP@box42@Centered_32x32x32",LabelText:"STR@L_JustifyCenter",TemplateAlias:"button2",Keytip:"STR@l_JustifyCenterKeytip"}},{name:"ToggleButton",attrs:{Id:"RightJustify",Command:"0xD59F0217",QueryCommand:"0x776E8734",Image16by16:"IMGMAP@one@RightJustify_16x16x32",Image32by32:"IMGMAP@box42@RightJustify_32x32x32",LabelText:"STR@L_AlignRight",TemplateAlias:"button3",Keytip:"STR@l_AlignRightKeytip"}}]}]},{name:"Group",attrs:{Id:"ContextualTabs.Tables.Layout.Shading",Description:"",Title:"STR@L_GroupShading",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"cellShadingColor",Command:"0x4DAC4430",Image32by32:"IMGMAP@one@FillColorSplitDropdown_32x32x32",LabelText:"STR@L_MenuShadingColor",DisplayMode:"Large",TemplateAlias:"button1",Keytip:"STR@l_OneNoteMenuShadingColorKeytip"},children:[{name:"Menu",attrs:{Id:"menuCellShadingColor"},children:[{name:"MenuSection",attrs:{Id:"cellShadingColor",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"CellShading.Color.Menu.Controls"},children:[{name:"Button",attrs:{Command:"0xC33DA1AE",LabelText:"STR@L_BtnClearShading",Id:"clear",Image16by16:"IMGMAP@one@NoHighlight_16x16x32"}}]}]},{name:"MenuSection",attrs:{Id:"cellShadingColor"},children:[{name:"Controls",attrs:{Id:"CellShading.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"cellShadingColorTable",Command:"0xA4D47B93",McuLayout:"true",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"FFFFFF",DisplayColor:"#FFFFFF",Alt:"STR@L_FontColorWhite"}},{name:"Color",attrs:{Color:"000000",DisplayColor:"#000000",Alt:"STR@L_FontColorBlack"}},{name:"Color",attrs:{Color:"E1ECEE",DisplayColor:"#EEECE1",Alt:"STR@L_FontColorTan"}},{name:"Color",attrs:{Color:"7D491F",DisplayColor:"#1F497D",Alt:"STR@L_FontColorDarkBlue"}},{name:"Color",attrs:{Color:"BD814F",DisplayColor:"#4F81BD",Alt:"STR@L_FontColorBlue"}},{name:"Color",attrs:{Color:"4D50C0",DisplayColor:"#C0504D",Alt:"STR@L_FontColorRed"}},{name:"Color",attrs:{Color:"59BB9B",DisplayColor:"#9BBB59",Alt:"STR@L_FontColorOliveGreen"}},{name:"Color",attrs:{Color:"A26480",DisplayColor:"#8064A2",Alt:"STR@L_FontColorPurple"}},{name:"Color",attrs:{Color:"C6AC4B",DisplayColor:"#4BACC6",Alt:"STR@L_FontColorAqua"}},{name:"Color",attrs:{Color:"4696F7",DisplayColor:"#F79646",Alt:"STR@L_FontColorOrange"}},{name:"Color",attrs:{Color:"F2F2F2",DisplayColor:"#F2F2F2",Alt:"STR@L_FontColorWhiteDarker5pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorBlackLighter50pct"}},{name:"Color",attrs:{Color:"C3D9DD",DisplayColor:"#DDD9C3",Alt:"STR@L_FontColorTanDarker10pct"}},{name:"Color",attrs:{Color:"F0D9C6",DisplayColor:"#C6D9F0",Alt:"STR@L_FontColorDarkBlueLighter80pct"}},{name:"Color",attrs:{Color:"F1E5DB",DisplayColor:"#DBE5F1",Alt:"STR@L_FontColorBlueLighter80pct"}},{name:"Color",attrs:{Color:"DBDCF2",DisplayColor:"#F2DCDB",Alt:"STR@L_FontColorRedLighter80pct"}},{name:"Color",attrs:{Color:"DDF1EB",DisplayColor:"#EBF1DD",Alt:"STR@L_FontColorOliveGreenLighter80pct"}},{name:"Color",attrs:{Color:"ECE0E5",DisplayColor:"#E5E0EC",Alt:"STR@L_FontColorPurpleLighter80pct"}},{name:"Color",attrs:{Color:"F3EEDB",DisplayColor:"#DBEEF3",Alt:"STR@L_FontColorAquaLighter80pct"}},{name:"Color",attrs:{Color:"DAEAFD",DisplayColor:"#FDEADA",Alt:"STR@L_FontColorOrangeLighter80pct"}},{name:"Color",attrs:{Color:"D8D8D8",DisplayColor:"#D8D8D8",Alt:"STR@L_FontColorWhiteDarker15pct"}},{name:"Color",attrs:{Color:"595959",DisplayColor:"#595959",Alt:"STR@L_FontColorBlackLighter35pct"}},{name:"Color",attrs:{Color:"97BDC4",DisplayColor:"#C4BD97",Alt:"STR@L_FontColorTanDarker25pct"}},{name:"Color",attrs:{Color:"E2B38D",DisplayColor:"#8DB3E2",Alt:"STR@L_FontColorDarkBlueLighter60pct"}},{name:"Color",attrs:{Color:"E4CCB8",DisplayColor:"#B8CCE4",Alt:"STR@L_FontColorBlueLighter60pct"}},{name:"Color",attrs:{Color:"B7B9E5",DisplayColor:"#E5B9B7",Alt:"STR@L_FontColorRedLighter60pct"}},{name:"Color",attrs:{Color:"BCE3D7",DisplayColor:"#D7E3BC",Alt:"STR@L_FontColorOliveGreenLighter60pct"}},{name:"Color",attrs:{Color:"D9C1CC",DisplayColor:"#CCC1D9",Alt:"STR@L_FontColorPurpleLighter60pct"}},{name:"Color",attrs:{Color:"E8DDB7",DisplayColor:"#B7DDE8",Alt:"STR@L_FontColorAquaLighter60pct"}},{name:"Color",attrs:{Color:"B5D5FB",DisplayColor:"#FBD5B5",Alt:"STR@L_FontColorOrangeLighter60pct"}},{name:"Color",attrs:{Color:"BFBFBF",DisplayColor:"#BFBFBF",Alt:"STR@L_FontColorWhiteDarker25pct"}},{name:"Color",attrs:{Color:"3F3F3F",DisplayColor:"#3F3F3F",Alt:"STR@L_FontColorBlackLighter25pct"}},{name:"Color",attrs:{Color:"538993",DisplayColor:"#938953",Alt:"STR@L_FontColorTanDarker50pct"}},{name:"Color",attrs:{Color:"D48D54",DisplayColor:"#548DD4",Alt:"STR@L_FontColorDarkBlueLighter40pct"}},{name:"Color",attrs:{Color:"D7B395",DisplayColor:"#95B3D7",Alt:"STR@L_FontColorBlueLighter40pct"}},{name:"Color",attrs:{Color:"9496D9",DisplayColor:"#D99694",Alt:"STR@L_FontColorRedLighter40pct"}},{name:"Color",attrs:{Color:"9BD6C3",DisplayColor:"#C3D69B",Alt:"STR@L_FontColorOliveGreenLighter40pct"}},{name:"Color",attrs:{Color:"C7A2B2",DisplayColor:"#B2A2C7",Alt:"STR@L_FontColorPurpleLighter40pct"}},{name:"Color",attrs:{Color:"DCCD92",DisplayColor:"#92CDDC",Alt:"STR@L_FontColorAquaLighter40pct"}},{name:"Color",attrs:{Color:"8FC0FA",DisplayColor:"#FAC08F",Alt:"STR@L_FontColorOrangeLighter40pct"}},{name:"Color",attrs:{Color:"A5A5A5",DisplayColor:"#A5A5A5",Alt:"STR@L_FontColorWhiteDarker35pct"}},{name:"Color",attrs:{Color:"262626",DisplayColor:"#262626",Alt:"STR@L_FontColorBlackLighter15pct"}},{name:"Color",attrs:{Color:"294449",DisplayColor:"#494429",Alt:"STR@L_FontColorTanDarker75pct"}},{name:"Color",attrs:{Color:"5D3617",DisplayColor:"#17365D",Alt:"STR@L_FontColorDarkBlueDarker25pct"}},{name:"Color",attrs:{Color:"926036",DisplayColor:"#366092",Alt:"STR@L_FontColorBlueDarker25pct"}},{name:"Color",attrs:{Color:"343795",DisplayColor:"#953734",Alt:"STR@L_FontColorRedDarker25pct"}},{name:"Color",attrs:{Color:"3C9276",DisplayColor:"#76923C",Alt:"STR@L_FontColorOliveGreenDarker25pct"}},{name:"Color",attrs:{Color:"7A495F",DisplayColor:"#5F497A",Alt:"STR@L_FontColorPurpleDarker25pct"}},{name:"Color",attrs:{Color:"9B8431",DisplayColor:"#31849B",Alt:"STR@L_FontColorAquaDarker25pct"}},{name:"Color",attrs:{Color:"096CE3",DisplayColor:"#E36C09",Alt:"STR@L_FontColorOrangeDarker25pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorWhiteDarker50pct"}},{name:"Color",attrs:{Color:"0C0C0C",DisplayColor:"#0C0C0C",Alt:"STR@L_FontColorBlackLighter5pct"}},{name:"Color",attrs:{Color:"101B1D",DisplayColor:"#1D1B10",Alt:"STR@L_FontColorTanDarker90pct"}},{name:"Color",attrs:{Color:"3E240F",DisplayColor:"#0F243E",Alt:"STR@L_FontColorDarkBlueDarker50pct"}},{name:"Color",attrs:{Color:"614024",DisplayColor:"#244061",Alt:"STR@L_FontColorBlueDarker50pct"}},{name:"Color",attrs:{Color:"232463",DisplayColor:"#632423",Alt:"STR@L_FontColorRedDarker50pct"}},{name:"Color",attrs:{Color:"28614F",DisplayColor:"#4F6128",Alt:"STR@L_FontColorOliveGreenDarker50pct"}},{name:"Color",attrs:{Color:"51313F",DisplayColor:"#3F3151",Alt:"STR@L_FontColorPurpleDarker50pct"}},{name:"Color",attrs:{Color:"675820",DisplayColor:"#205867",Alt:"STR@L_FontColorAquaDarker50pct"}},{name:"Color",attrs:{Color:"064898",DisplayColor:"#984806",Alt:"STR@L_FontColorOrangeDarker50pct"}}]}]}]}]},{name:"MenuSection",attrs:{Id:"cellShadingStandardColor",Title:"STR@L_MenuStandardColors"},children:[{name:"Controls",attrs:{Id:"CellShading.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"cellShadingStandardColorTable",Command:"0xA4D47B93",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"0000C0",Alt:"STR@L_FontColorDarkRed",DisplayColor:"#C00000"}},{name:"Color",attrs:{Color:"0000FF",Alt:"STR@L_FontColorRed",DisplayColor:"#FF0000"}},{name:"Color",attrs:{Color:"00C0FF",Alt:"STR@L_FontColorOrange",DisplayColor:"#FFC000"}},{name:"Color",attrs:{Color:"00FFFF",Alt:"STR@L_FontColorYellow",DisplayColor:"#FFFF00"}},{name:"Color",attrs:{Color:"50D092",Alt:"STR@L_FontColorLightGreen",DisplayColor:"#92D050"}},{name:"Color",attrs:{Color:"50B000",Alt:"STR@L_FontColorDarkGreen",DisplayColor:"#00B050"}},{name:"Color",attrs:{Color:"F0B000",Alt:"STR@L_FontColorLightBlue",DisplayColor:"#00B0F0"}},{name:"Color",attrs:{Color:"C07000",Alt:"STR@L_FontColorBlue",DisplayColor:"#0070C0"}},{name:"Color",attrs:{Color:"602000",Alt:"STR@L_FontColorDarkBlue",DisplayColor:"#002060"}},{name:"Color",attrs:{Color:"A03070",Alt:"STR@L_FontColorPurple",DisplayColor:"#7030A0"}}]}]}]}]}]}]}]}]}]}]},{name:"Templates",attrs:{},children:[{name:"RibbonTemplates",attrs:{},children:[{name:"GroupTemplate",attrs:{Id:"tmpThreeButton"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Large"}}]}]}]},{name:"Layout",attrs:{Title:"Medium"},children:[{name:"Section",attrs:{Type:"ThreeRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Medium"}}]}]}]},{name:"Layout",attrs:{Title:"Small"},children:[{name:"Section",attrs:{Type:"ThreeRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Small"}}]}]}]},{name:"Layout",attrs:{Title:"Collapsed"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"flyout",DisplayMode:"Large"}}]}]}]}]},{name:"GroupTemplate",attrs:{Id:"tmpFourButton"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button4",DisplayMode:"Large"}}]}]}]},{name:"Layout",attrs:{Title:"Medium"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Large"}}]}]},{name:"Section",attrs:{Type:"ThreeRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button4",DisplayMode:"Medium"}}]}]}]},{name:"Layout",attrs:{Title:"Small"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Large"}}]}]},{name:"Section",attrs:{Type:"ThreeRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button4",DisplayMode:"Small"}}]}]}]},{name:"Layout",attrs:{Title:"Collapsed"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"flyout",DisplayMode:"Large"}}]}]}]}]}]}]}]},window.ViewTabData={name:"CommandUI",attrs:{},children:[{name:"Tab",attrs:{Id:"tabView",Description:"",Title:"STR@L_TabView",Keytip:"STR@l_TabViewKeytip"},children:[{name:"Scaling",attrs:{},children:[{name:"MaxSize",attrs:{Id:"grpViews.Scaling.MaxSize",Sequence:"10",GroupId:"grpViews",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpPageSetup.Scaling.MaxSize",Sequence:"20",GroupId:"grpPageSetup",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpAuthors.Scaling.MaxSize",Sequence:"30",GroupId:"grpAuthors",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpVersions.Scaling.MaxSize",Sequence:"40",GroupId:"grpVersions",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpAccChecker.Scaling.MaxSize",Sequence:"50",GroupId:"grpAccChecker",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpNavigation.Scaling.MaxSize",Sequence:"60",GroupId:"grpNavigation",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpRibbon.Scaling.MaxSize",Sequence:"0",GroupId:"grpRibbon",Size:"Large"}}]},{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"grpViews",Description:"",Title:"STR@L_GroupNotebookViews",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"ToggleButton",attrs:{Alt:"STR@L_EditView",Id:"btnEditOnWeb",Command:"0x13A057F4",QueryCommand:"0x0CC7A13D",TogglesWhenExecuted:"false",LabelText:"STR@L_EditView",Image32by32:"IMGMAP@box43@Edit_32x32x32",TemplateAlias:"button1",Keytip:"STR@l_EditViewKeytip"}},{name:"Button",attrs:{Alt:"STR@L_ReadView",Id:"btnReadingMode",Command:"0xE56FA2A1",IsDefinitive:"true",LabelText:"STR@L_ReadView",Image32by32:"IMGMAP@box43@ReadingMode_32x32x32",TemplateAlias:"button2",Keytip:"STR@l_ReadViewKeytip"}},{name:"Button",attrs:{Alt:"STR@L_ImmersiveView",Id:"btnImmersiveMode",Command:"0x72BE69D3",LabelText:"STR@L_ImmersiveView",Image32by32:"IMGMAP@box43@AudioReader_32x32x32",TemplateAlias:"button3",Keytip:"STR@l_ImmersiveReaderKeytip"}}]}]},{name:"Group",attrs:{Id:"grpPageSetup",Description:"",Title:"STR@L_GroupPageSetup",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"flyPageColor",Alt:"STR@L_PageColor",Command:"0x568463EB",Image32by32:"IMGMAP@one@WebSetBackground_32x32x32",LabelText:"STR@L_PageColor",Keytip:"STR@l_PageColorKeytip",TemplateAlias:"button1"},children:[{name:"Menu",attrs:{Id:"menuPageColor"},children:[{name:"MenuSection",attrs:{Id:"msPageColor"},children:[{name:"Controls",attrs:{Id:"Background.Page.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"pageColor",Command:"0xFF101154",Width:"4"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"ECF3FA",Alt:"STR@L_PageColor_Blue",DisplayColor:"#ECF3FA"}},{name:"Color",attrs:{Color:"EEF8F6",Alt:"STR@L_PageColor_Teal",DisplayColor:"#EEF8F6"}},{name:"Color",attrs:{Color:"F1F9F3",Alt:"STR@L_PageColor_Green",DisplayColor:"#F1F9F3"}},{name:"Color",attrs:{Color:"FCEEEE",Alt:"STR@L_PageColor_Red",DisplayColor:"#FCEEEE"}},{name:"Color",attrs:{Color:"EEF1F9",Alt:"STR@L_PageColor_BlueMist",DisplayColor:"#EEF1F9"}},{name:"Color",attrs:{Color:"F0F8FA",Alt:"STR@L_PageColor_Cyan",DisplayColor:"#F0F8FA"}},{name:"Color",attrs:{Color:"F2F9ED",Alt:"STR@L_PageColor_Apple",DisplayColor:"#F2F9ED"}},{name:"Color",attrs:{Color:"FDF5F5",Alt:"STR@L_PageColor_RedChalk",DisplayColor:"#FDF5F5"}},{name:"Color",attrs:{Color:"F2F1F9",Alt:"STR@L_PageColor_PurpleMist",DisplayColor:"#F2F1F9"}},{name:"Color",attrs:{Color:"F5F7F9",Alt:"STR@L_PageColor_Silver",DisplayColor:"#F5F7F9"}},{name:"Color",attrs:{Color:"F5F9EB",Alt:"STR@L_PageColor_LemonLime",DisplayColor:"#F5F9EB"}},{name:"Color",attrs:{Color:"F6EDE6",Alt:"STR@L_PageColor_Tan",DisplayColor:"#F6EDE6"}},{name:"Color",attrs:{Color:"F9F1F8",Alt:"STR@L_PageColor_Purple",DisplayColor:"#F9F1F8"}},{name:"Color",attrs:{Color:"FDEFF7",Alt:"STR@L_PageColor_Magenta",DisplayColor:"#FDEFF7"}},{name:"Color",attrs:{Color:"FEF8E6",Alt:"STR@L_PageColor_Yellow",DisplayColor:"#FEF8E6"}},{name:"Color",attrs:{Color:"FCF3EA",Alt:"STR@L_PageColor_Orange",DisplayColor:"#FCF3EA"}}]}]}]}]},{name:"MenuSection",attrs:{Id:"msNoPageColor",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"No.Background.Page.Color.Menu.Controls"},children:[{name:"Button",attrs:{Command:"0xE87089DF",LabelText:"STR@L_NoPageColor",Image16by16:"IMGMAP@one@NoHighlight_16x16x32",Keytip:"STR@l_NoPageColorKeytip"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpAuthors",Description:"",Title:"STR@L_GroupAuthors",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"ToggleButton",attrs:{Id:"fsbcShowAuthorInfo",Alt:"STR@L_ShowAuthors",Command:"0x8C3942AB",QueryCommand:"0x53A2D8A7",IsDefinitive:"true",Image32by32:"IMGMAP@box43@ShowAuthors_32x32x32",LabelText:"STR@L_ShowAuthors",TemplateAlias:"button1",Keytip:"STR@l_ShowAuthorsKeytip"}}]}]},{name:"Group",attrs:{Id:"grpVersions",Description:"",Title:"STR@L_GroupVersions",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"ToggleButton",attrs:{Id:"fsbcShowVersions",Alt:"STR@L_ShowVersions",Command:"0xCCB576ED",QueryCommand:"0x3D948D71",IsDefinitive:"true",Image32by32:"IMGMAP@box43@Versions_32x32x32",LabelText:"STR@L_BrowseVersions",TemplateAlias:"button1",Keytip:"STR@l_BrowseVersionsKeytip"}},{name:"ToggleButton",attrs:{Id:"fsbcToggleRecycleBin",Command:"0x6CFC25BC",QueryCommand:"0x4E06403C",IsDefinitive:"true",Image32by32:"IMGMAP@one@EmptyTrash_32x32x32",LabelText:"STR@L_DeletedNotes",TemplateAlias:"button2",Keytip:"STR@l_DeletedNotesKeytip"}}]}]},{name:"Group",attrs:{Id:"grpAccChecker",Description:"",Title:"STR@L_Accessibility",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"ToggleButton",attrs:{Alt:"STR@L_OpenAccessibilityCheckerPane",Id:"btnOpenAccCheckerPane",Command:"0x96C65FEE",QueryCommand:"0x742EBF5E",TogglesWhenExecuted:"true",LabelText:"STR@L_OpenAccessibilityCheckerPane",Image32by32:"IMGMAP@one@AccessibilityChecker_32x32x32",TemplateAlias:"button1",Keytip:"STR@l_OpenAccessibilityCheckerPaneKeytip"}}]}]},{name:"Group",attrs:{Id:"grpNavigation",Description:"",Title:"STR@L_GroupNavigation",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpSpelling.Controls"},children:[{name:"FlyoutAnchor",attrs:{Id:"fseaNavigationOptions",Alt:"STR@L_NavigationOptions",Command:"0x568463EB",Image32by32:"IMGMAP@one@FramesetTOC_32x32x32",LabelText:"STR@L_NavigationOptions",TemplateAlias:"button1"},children:[{name:"Menu",attrs:{Id:"menuNavigation"},children:[{name:"MenuSection",attrs:{Id:"msNavigation",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msNavigation.Controls"},children:[{name:"ToggleButton",attrs:{Alt:"STR@L_ShowSectionsAndPages",Id:"btnShowSectionsAndPages",Command:"0xADEEADB9",QueryCommand:"0x67E7548B",LabelText:"STR@L_ShowSectionsAndPages",TemplateAlias:"button1"}},{name:"ToggleButton",attrs:{Alt:"STR@L_ShowOnlyPages",Id:"btnShowOnlyPages",Command:"0x383C677C",QueryCommand:"0xD2030858",LabelText:"STR@L_ShowOnlyPages",TemplateAlias:"button1"}},{name:"ToggleButton",attrs:{Alt:"STR@L_HideAll",Id:"btnHideAll",Command:"0xDFC30183",QueryCommand:"0xB95455A9",LabelText:"STR@L_HideAll",TemplateAlias:"button1"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpRibbon",Title:"STR@l_RibbonGroup",Template:"tmpRibbonGroup"},children:[{name:"Controls",attrs:{},children:[{name:"ToggleButton",attrs:{Id:"toggleBtnSimpleRibbon",Command:"0x4FFEF2CD",QueryCommand:"0x5B8DF0D7",IsChecked:"false",UseCheckMark:"true",UseUncheckedImage:"true",LabelText:"STR@l_ToggleRibbonText",Alt:"STR@l_ToggleRibbonText",TemplateAlias:"toggleButtonSimpleRibbon",Keytip:"STR@l_SingleLineRibbonKeyTip"}}]}]}]}]},{name:"Templates",attrs:{},children:[{name:"RibbonTemplates",attrs:{},children:[{name:"GroupTemplate",attrs:{Id:"tmpRibbonGroup"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"toggleButtonSimpleRibbon",DisplayMode:"Medium"}}]}]}]}]}]}]}]};var $A=n(1492),zA=n(7085),KA=n(20),qA=n(9472),jA=n(35),QA=n(9120),JA=n(9629),XA=n(4317),YA=n(3842),ZA=n(2948),eI=(0,o.y)("5ec2bb75$IDialogViewFactory"),tI=(0,o.y)("48d892d7$IBox4DialogFactory"),nI=function(e){function t(n,i){var r=this;return r._languageStrategy=null,r._languageListHelper=null,r._currentLcid=0,r._languageList=null,r.dialogHtmlFormat="<div class='WACDialogRow' id='IntroBlock'> <label id='IntroLabel' class='WACDialogLabel' for='LanguageList' >{0}</label> </div> <div class='LanguagesListDiv' id='LanguageListDiv'> <select class='UIFont WACDialogList' id='LanguageList' size='11'> </select> <label id='SpellingLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogCheckBoxDiv' id='DoNotCheckSpellingBlock'> <input type='checkbox' id='DoNotCheckSpelling' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='DoNotCheckSpelling' >{2}</label> </div>",(r=e.call(this)||this)._languageStrategy=n,r._languageListHelper=i,r.set_dialogId(t.Id),r}return(0,v.t)(t,e),t.prototype.showLanguageDialog=function(){var e;this.set_dialogHtml(this.generateDialogHtml()),this._currentLcid=this._languageStrategy.getSelectedContextLanguage((0,g.m)((function(){return e}),(function(t){return e=t})));var n={LanguageList:10,DoNotCheckSpelling:!e};this.initializeAndShow(Box4Intl.Box4Strings.l_Language,o.i(this,this.SetLanguageHandler,"SetLanguageHandler"),n),this._languageList=document.getElementById(t.LanguageListId),this._languageListHelper.populateList(this._languageList,this._currentLcid)},t.prototype.generateDialogHtml=function(){return Bi.o.formatHtml(this.dialogHtmlFormat,Box4Intl.Box4Strings.l_MarkSelectedText,Box4Intl.Box4Strings.l_SpellingWillUseLanguage,Box4Intl.Box4Strings.l_DoNotCheckSpelling)},t.prototype.SetLanguageHandler=function(e,n){if(Gl.n.get_instance().get_item(70)){var i=xr.y.get_instance().startActivity(Oi.u.setLanguageFromDialog);if(1!==e)return i.get_properties().set_item("canceled","true"),void i.end();var r=n[t.LanguageListId],o=n[t.DoNotCheckSpellingCheckboxId];if(r>=0){var a=parseInt(this._languageList.value);this._languageStrategy.setSelectedContextLanguage(a,o),i.get_properties().set_item("PreviousLCID",this._currentLcid.toString()),i.get_properties().set_item("ChangedLCID",a.toString()),i.get_properties().set_item("NoProof",o.toString()),this._languageListHelper.setLanguageAsMostRecentlyUsed(a,this._currentLcid)}yi.App.get_activeAppFrame().updateCommandUI(!0),i.end()}},t.DoNotCheckSpellingCheckboxId="DoNotCheckSpelling",t.LanguageListId="LanguageList",t.Id="LanguageDialog",t}(Bi.o);(0,o.l)(nI,"c500a4b$LanguageDialog",Bi.o,[Mg]);var iI=function(){function e(e,t,n,i){this._businessBar=null,this._businessBarEntryFactory=null,this._actionManager=null,this._appSettingsManager=null,this._corruptPageEntry=null,this._dictationSilenceEntry=null,this._oldBrowserBusinessBarEntry=null,this._fileAccessBusinessBarEntry=null,this._unsupportedObjEntry=null,this._unsupportedObjSquelched=!1,this._businessBar=e,this._businessBarEntryFactory=t,this._actionManager=n,this._appSettingsManager=i}return e.prototype.performInitChecks=function(){this.checkCorruptPageBusinessBar(),this.checkCurrentPageStatusBusinessBars(),this.checkDocumentStatusBusinessBars(),this.checkFileAccessBusinessBar(),this.checkUnsupportedBrowserBusinessBar()},e.prototype.checkCurrentPageStatusBusinessBars=function(){},e.prototype.checkDocumentStatusBusinessBars=function(){},e.prototype.checkSessionExpirationBusinessBar=function(e,t){},e.prototype.checkCorruptPageBusinessBar=function(){var e=this,t=yi.App.get_activeAppFrame().workspace.get_activePage();t&&this.updateTextEntryHelper((0,g.m)((function(){return e._corruptPageEntry}),(function(t){return e._corruptPageEntry=t})),1,2===yi.App.get_activeAppFrame().get_mode()&&t.get_isCorrupt(),Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent)},e.prototype.get_IE9SoftBlockIsEnabled=function(){return!!this._appSettingsManager&&this._appSettingsManager.getBooleanAppSetting("IE9SoftBlockIsEnabled")},e.prototype.get_IE10SoftBlockIsEnabled=function(){return!!this._appSettingsManager&&this._appSettingsManager.getBooleanAppSetting("IE10SoftBlockIsEnabled")},e.prototype.get_IsUnsupportedBrowserBusinessBar=function(){return!!yi.App.unsupportedBrowserBusinessBarIsEnabled&&(this.get_IE10SoftBlockIsEnabled()?W.y.get_isInternetExplorerNonEdge()&&!W.y.get_isInternetExplorer11Up():this.get_IE9SoftBlockIsEnabled()?W.y.get_isInternetExplorerNonEdge()&&!W.y.get_isInternetExplorer10Up():W.y.get_isInternetExplorerNonEdge()&&!W.y.get_isInternetExplorer9Up())},e.prototype.checkUnsupportedBrowserBusinessBar=function(){this.get_IsUnsupportedBrowserBusinessBar()&&!this._oldBrowserBusinessBarEntry&&(this._oldBrowserBusinessBarEntry=this._businessBarEntryFactory.create("",CommonUIStrings.l_UnsupportedBrowser,null),this._oldBrowserBusinessBarEntry.set_id(15),this._oldBrowserBusinessBarEntry.set_closeable(!0),sS.Redirect.isHelpAvailable()&&this._oldBrowserBusinessBarEntry.addButton(Box4Intl.Box4Strings.L_LearnMore,Yc.u.unsupportedBrowserHandler,""),this._businessBar.addEntry(this._oldBrowserBusinessBarEntry,!1))},e.prototype.checkFileAccessBusinessBar=function(){var e=this,t=null,n=yi.App.get_activeAppFrame().workspace.get_activeSection();if(n){var i=n.get_outboundReplicationStatus();lb.j.isBlockingSaveFailure(i)?22===i?t=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===i||20===i?t=W.y.get_isIPad()?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===i?t=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===i?t=W.y.get_isIPad()?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===i&&(t=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):2!==yi.App.get_activeAppFrame().get_mode()||lb.j.hasWriteAccess(n.get_accessRights())||yi.App.get_isReviewer()||(t=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.updateTextEntryHelper((0,g.m)((function(){return e._fileAccessBusinessBarEntry}),(function(t){return e._fileAccessBusinessBarEntry=t})),5,!!t,t)},e.prototype.setUnsupportedObjectBusinessBar=function(e){var t=this;!!this._unsupportedObjEntry===e||this._unsupportedObjSquelched||(e?(this._unsupportedObjEntry=this._businessBarEntryFactory.create("",Box4Intl.Box4Strings.l_BusinessBarUnsupportedObjectsOnPage,null),this._unsupportedObjEntry.set_id(13),this._unsupportedObjEntry.set_closeable(!0),this._unsupportedObjEntry.set_closeHandler((function(){t._unsupportedObjSquelched=!0,t._unsupportedObjEntry=null})),this._businessBar.addEntry(this._unsupportedObjEntry)):(this._businessBar.removeEntry(this._unsupportedObjEntry),this._unsupportedObjEntry=null))},e.prototype.showDocChatFailedBusinessBar=function(){var e=this._businessBarEntryFactory.create(null,CommonUIStrings.l_ChatIsNotAvailable,null);e.set_closeable(!0),e.set_id(17),this._businessBar.addEntry(e)},e.prototype.showGdprPrivacyNoticeWithCloseCallback=function(e,t,n,i){var r=this._businessBarEntryFactory.create(null,e,null);r.set_closeable(!0),r.set_id(23),r.set_image(3),r.addLinkWithHandler(t,(function(){bt.g.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+n)})),i&&r.set_closeHandler(i),this._businessBar.addEntry(r,!0)},e.prototype.showGdprPrivacyNotice=function(e,t,n){this.showGdprPrivacyNoticeWithCloseCallback(e,t,n,null)},e.prototype.showDatacenterDecommissionWarning=function(e){var t=this._businessBarEntryFactory.create(null,e,null);t.set_closeable(!0),t.set_id(24),t.set_image(1),this._businessBar.addEntry(t,!0)},e.prototype.showIRMPolicyDescription=function(e){var t=this._businessBarEntryFactory.create(null,e,null);t.set_closeable(!0),t.set_id(20),this._businessBar.addEntry(t)},e.prototype.showDictationSilenceWarning=function(e,t){this._dictationSilenceEntry||(this._dictationSilenceEntry=this._businessBarEntryFactory.create(e,t,null),this._dictationSilenceEntry.set_closeable(!0),this._dictationSilenceEntry.set_id(27),this._businessBar.addEntry(this._dictationSilenceEntry))},e.prototype.hideDictationSilenceWarning=function(){var e=this;this._dictationSilenceEntry&&this.updateTextEntryHelper((0,g.m)((function(){return e._dictationSilenceEntry}),(function(t){return e._dictationSilenceEntry=t})),27,!1,"")},e.prototype.updateTextEntryHelper=function(e,t,n,i,r,o,a,l,s){void 0===r&&(r=!1),void 0===o&&(o=""),void 0===a&&(a=null),void 0===l&&(l=null),void 0===s&&(s=null),n?e.val?e.val.set_message(i):(e.val=this._businessBarEntryFactory.create(o,i,null),e.val.set_id(t),e.val.set_closeable(r),a&&e.val.addButton(a.text,a.invokeHandler,a.screenReaderText),l&&e.val.addLinkWithHandler(l.text,l.invokeHandler),s&&e.val.set_closeHandler(s),this._businessBar.addEntry(e.val,!1)):e.val&&(this._businessBar.removeEntry(e.val),e.val=null)},e.prototype.addBusinessBarEntry=function(e,t){this._businessBar.addEntry(e,t)},e}();(0,o.l)(iI,"5caed58e$BusinessBarController",null,[KA.d]);var rI=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o._kickoutWithDataLossEntry=null,o}return(0,v.t)(t,e),t.prototype.getKickoutBusinessBar=function(e,t,n,i,r,o){var a=this;if(void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===o&&(o=2),this._kickoutWithDataLossEntry)return null;this._kickoutWithDataLossEntry=this._businessBarEntryFactory.create(t,n||"",null),this._kickoutWithDataLossEntry.set_id(6),this._kickoutWithDataLossEntry.set_image(o),e&&this._kickoutWithDataLossEntry.set_errorCode(e),this._kickoutWithDataLossEntry.set_closeable(!1);var l=L.AFrameworkApplication.showFeedbackButton&&this._appSettingsManager.getBooleanAppSetting("ShowFeedbackButtonOnKickoutBusinessBar");return i?(this._kickoutWithDataLossEntry.addButton(i,r,""),l&&this._kickoutWithDataLossEntry.addSecondButton(WoncaIntl.WoncaStrings.L_GiveFeedback,(function(t){a.GiveFeedbackButtonHandler(t,e)}),"")):l&&this._kickoutWithDataLossEntry.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,(function(t){a.GiveFeedbackButtonHandler(t,e)}),""),this._businessBar.addEntry(this._kickoutWithDataLossEntry),this._kickoutWithDataLossEntry},t.prototype.GiveFeedbackButtonHandler=function(e,t){S.ULS.sendTraceTag(36471966,338,15,"Feedback given after kickout: {0}",{ErrorCode:t}),this._actionManager.processActionWithData(Fe.b.giveFeedback,2,{ErrorCode:t})},t.get_pageReader=function(){return $s.PageReader.get_instance()},t}(iI);(0,o.l)(rI,"c52f9776$BusinessBarController",iI,[zA.d,KA.d]);var oI=function(){function e(){}return e.get_ConflictPageBusinessBarContextMenu=function(){return e._conflictPageBusinessBarContextMenu||(e._conflictPageBusinessBarContextMenu=Ge.w.get_instance().tryResolve(ZA.b))},e.onInvokeConflictPageBusinessBar=function(t,n){var i=null;return i=1===n.get_inputSource()?t.get_getPointForContextMenu():n.get_clientPoint(),e.get_ConflictPageBusinessBarContextMenu()&&e.get_ConflictPageBusinessBarContextMenu().showAt(i,n.get_inputSource()),!0},e.onInvokeHasConflictsBusinessBar=function(e,t){var n=L.AFrameworkApplication.get_theActionManager();return n.set_commandLocation(10),n.set_invocationMethod(t.get_inputSource()),n.processAction(Oi.u.toggleConflictPagesVisibility,2),!0},e._conflictPageBusinessBarContextMenu=null,e}();(0,o.l)(oI,"f83db59$ConflictPageBusinessBar",null,[]);var aI=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o._canvasSizeExceededBusinessBarEntry=null,o._quotaExceededBusinessBarEntry=null,o._currentPageStatusEntry=null,o._currentSessionExpirationEntry=null,o}return(0,v.t)(t,e),t.prototype.setCanvasSizeExceededBusinessBar=function(e){e?this._canvasSizeExceededBusinessBarEntry||(this._canvasSizeExceededBusinessBarEntry=this._businessBarEntryFactory.create(Box4Intl.Box4Strings.l_CanvasSizeExceededTitle,Box4Intl.Box4Strings.l_CanvasSizeExceededMessage,null),this._canvasSizeExceededBusinessBarEntry.set_id(0),this._canvasSizeExceededBusinessBarEntry.set_closeable(!1),this._canvasSizeExceededBusinessBarEntry.set_image(2),this._businessBar.addEntry(this._canvasSizeExceededBusinessBarEntry,!1)):this._canvasSizeExceededBusinessBarEntry&&(this._businessBar.removeEntry(this._canvasSizeExceededBusinessBarEntry),this._canvasSizeExceededBusinessBarEntry=null)},t.prototype.checkFileAccessBusinessBar=function(){var t=this,n=yi.App.get_activeAppFrame().workspace.get_activeSection();if(n){var i=n.get_outboundReplicationStatus();if(lb.j.isBlockingSaveFailure(i)){if((22===i||7===i)&&Ti.App.get_instance().get_isSyncUxFeatureEnabled())return;if(22===i)return void this.UpdateQuotaExceededEntryHelper((0,g.m)((function(){return t._quotaExceededBusinessBarEntry}),(function(e){return t._quotaExceededBusinessBarEntry=e})),5,!0);this.UpdateQuotaExceededEntryHelper((0,g.m)((function(){return t._quotaExceededBusinessBarEntry}),(function(e){return t._quotaExceededBusinessBarEntry=e})),5,!1)}}e.prototype.checkFileAccessBusinessBar.call(this)},t.prototype.checkCurrentPageStatusBusinessBars=function(){var e=yi.App.get_activeAppFrame().workspace.get_activePage();e&&(rI.get_pageReader().isConflictPageNode(e)?this.UpdateCurrentPageStatusEntryHelper(W.y.get_isIPad()?Box4Intl.Box4Strings.l_BusinessBarConflictPageInfoNoCopy:Box4Intl.Box4Strings.l_BusinessBarConflictPageInfo,MC.t.conflictBusinessBarID,oI.onInvokeConflictPageBusinessBar,!0):rI.get_pageReader().isVersionNode(e)?this.UpdateCurrentPageStatusEntryHelper(String.format(W.y.get_isIPad()?Box4Intl.Box4Strings.l_BusinessBarVersionInfoNoCopy:Box4Intl.Box4Strings.l_BusinessBarVersionInfo,rI.get_pageReader().getVersionNumber(e)+1),MC.t.versionsBusinessBarID,o.i(t.get_VersionBusinessBarContextMenu(),t.get_VersionBusinessBarContextMenu().onInvokeVersionHistoryBusinessBar,"onInvokeVersionHistoryBusinessBar"),!0):2===yi.App.get_activeAppFrame().get_mode()&&(rI.get_pageReader().isFromThePast(e)||lb.j.isFromThePast(t.get_PageNavigator().getContainingSection(e)))?this.UpdateCurrentPageStatusEntryHelper(Box4Intl.Box4Strings.l_BusinessBarReadonlyOldContent):2===yi.App.get_activeAppFrame().get_mode()&&(rI.get_pageReader().isFromTheFuture(e)||lb.j.isFromTheFuture(t.get_PageNavigator().getContainingSection(e)))?this.UpdateCurrentPageStatusEntryHelper(Box4Intl.Box4Strings.l_BusinessBarReadonlyFutureContent):rI.get_pageReader().hasConflictPages(e)?this.UpdateCurrentPageStatusEntryHelper(rI.get_pageReader().areConflictPagesVisible(e)?Box4Intl.Box4Strings.l_BusinessBarMergeConflictPresentAndVisible:Box4Intl.Box4Strings.l_BusinessBarMergeConflictPresent,MC.t.conflictBusinessBarID,oI.onInvokeHasConflictsBusinessBar):L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteClassNotebookPageLockIsEnabled")&&Ti.App.get_isCurrentUserNotebookGuest()&&rI.get_pageReader().isLockedPageNode(e)?this.UpdateCurrentPageStatusEntryHelper(Box4Intl.Box4Strings.l_BusinessBarReadonlyPageLocked):this._currentPageStatusEntry&&(this._businessBar.removeEntry(this._currentPageStatusEntry),this._currentPageStatusEntry=null))},t.prototype.checkSessionExpirationBusinessBar=function(e,t){var n=this;(Mi.c.get_instance().checkAndTriggerSessionHasExpired()||t)&&this.ShowSessionExpirationEntry(OneNoteIntl.OneNoteStrings.l_SessionExpiredBusinessBarText,CommonUIStrings.l_SessionExpirationRefreshButton,(function(t){yi.App.get_activeAppFrame().set_mode(e),n.RefreshPage(t)}))},t.prototype.RefreshPage=function(e){yi.App.get_activeAppFrame().refreshDocument(null)},t.prototype.ShowSessionExpirationEntry=function(e,t,n){this._currentSessionExpirationEntry||(this._currentSessionExpirationEntry=this._businessBarEntryFactory.create("",e,null),this._currentSessionExpirationEntry.set_id(7),this._currentSessionExpirationEntry.addButton(t,n,""),this._businessBar.addEntry(this._currentSessionExpirationEntry,!1))},t.prototype.UpdateCurrentPageStatusEntryHelper=function(e,t,n,i){void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=!1),this._currentPageStatusEntry?this._currentPageStatusEntry.set_message(e):(this._currentPageStatusEntry=this._businessBarEntryFactory.create("",e,n),this._currentPageStatusEntry.set_id(2),t&&this._currentPageStatusEntry.set_containerID(t),this._businessBar.addEntry(this._currentPageStatusEntry)),this._currentPageStatusEntry.set_invokeHandler(n),this._currentPageStatusEntry.set_invokeActionIsContextMenu(i)},t.prototype.UpdateQuotaExceededEntryHelper=function(e,t,n){n?e.val?e.val.set_message(L.AFrameworkApplication.get_isSkyDrive()?OneNoteIntl.OneNoteStrings.L_QuotaExceededInOneDrive:OneNoteIntl.OneNoteStrings.L_QuotaExceededInSPO):(e.val=this._businessBarEntryFactory.create("",L.AFrameworkApplication.get_isSkyDrive()?OneNoteIntl.OneNoteStrings.L_QuotaExceededInOneDrive:OneNoteIntl.OneNoteStrings.L_QuotaExceededInSPO,null),e.val.set_id(t),e.val.set_closeable(!1),this._businessBar.addEntry(e.val,!1)):e.val&&(this._businessBar.removeEntry(e.val),e.val=null)},t.get_VersionBusinessBarContextMenu=function(){return t._versionBusinessBarContextMenu||(t._versionBusinessBarContextMenu=Ge.w.get_instance().resolve(YA.x))},t.get_PageNavigator=function(){return Ii.PageNavigator.get_instance()},t._versionBusinessBarContextMenu=null,t}(rI);(0,o.l)(aI,"57ebc196$BusinessBarController",rI,[Li.d,zA.d,KA.d]);var lI=n(7192),sI=function(){function e(){}return e.get_pageClicked=function(){return e._pageClicked},e.set_pageClicked=function(t){return e._pageClicked=t,t&&e.set_versionClicked(null),t},e.get_versionClicked=function(){return e._versionClicked},e.set_versionClicked=function(t){return e._versionClicked=t,t&&e.set_pageClicked(null),t},e._pageClicked=null,e._versionClicked=null,e.sectionClicked=null,e.conflictPageClicked=null,e}();(0,o.l)(sI,"c5361751$ContextMenuData",null,[]);var uI=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.CreateContextMenu=function(){var e={PopulateDynamically:"true",PopulateOnlyOnce:"false"};e.PopulateQueryCommand=""+Oi.u.populateConflictPageBusinessBarContextMenu,e.Command=""+Fe.b.alwaysEnabled,lI.r.createContextMenuControl(e,t.MenuId,"NavPaneNotebookContextMenu","Navigation pane notebook context menu","Menu16"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(Oi.u.populateConflictPageBusinessBarContextMenu,ol.d.application,t.PopulateContextMenu,96)},t.prototype.show=function(e,n){t._inited||(this.CreateContextMenu(),t._inited=!0),sI.conflictPageClicked=n,lI.r.showContextMenu(t.MenuId,e)},t.prototype.showAt=function(e,n){t._inited||(this.CreateContextMenu(),t._inited=!0),sI.conflictPageClicked=yi.App.get_activeAppFrame().workspace.get_activePage(),lI.r.showContextMenuAt(t.MenuId,e,n)},t.get_PageReader=function(){return $s.PageReader.get_instance()},t.PopulateContextMenu=function(e,n,i,r,o){if(1===i)return 32;var a=o,l=new Sys.StringBuilder;return l.append(String.format('<Menu Id="{0}">',t.MenuId)),l.append('<MenuSection Id="msConflictPageActions" DisplayMode="Menu16"><Controls>'),l.append(lI.r.generateButtonXml("fseaToggleConflictPagesVisibility",Oi.u.toggleConflictPagesVisibility,null,Box4Intl.Box4Strings.l_HideConflictPages)),l.append(lI.r.generateButtonXml("fseaDeleteConflictPage",Oi.u.deleteConflictPage,"Delete_16x16x32",Box4Intl.Box4Strings.l_DeletePage)),l.append("</Controls></MenuSection></Menu>"),a.PopulationXML=l.toString(),32},t.MenuId="mnuConflictPage",t._inited=!1,t}(lI.r);(0,o.l)(uI,"e9bf9f73$ConflictPageBusinessBarContextMenu",lI.r,[ZA.b]);var cI=n(5888),dI=function(e){function t(){var t=e.call(this)||this;return t.$$pf_NoteTagClicked=null,t}return(0,v.t)(t,e),t.prototype.get_noteTagClicked=function(){return this.$$pf_NoteTagClicked},t.prototype.set_noteTagClicked=function(e){return this.$$pf_NoteTagClicked=e,e},t.prototype.CreateMenus=function(){this.CreateContextMenu(!0),this.CreateContextMenu(!1)},t.prototype.CreateContextMenu=function(e){var n={PopulateDynamically:"true",PopulateOnlyOnce:"false"};n.PopulateQueryCommand=""+(e?nS.u.populateNoteTagMarkContextMenu:nS.u.populateNoteTagClearContextMenu),n.Command=""+Fe.b.alwaysEnabled,lI.r.createContextMenuControl(n,e?t.MenuIdMark:t.MenuIdClear,Rn.l.xmlEncode(OneNoteIntl.OneNoteStrings.L_NoteTags),Rn.l.xmlEncode(OneNoteIntl.OneNoteStrings.L_NoteTags),"Menu16"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(e?nS.u.populateNoteTagMarkContextMenu:nS.u.populateNoteTagClearContextMenu,ol.d.application,e?t.PopulateContextMenuMark:t.PopulateContextMenuClear,100)},t.prototype.show=function(e,n){t._inited||(this.CreateMenus(),t._inited=!0),this.set_noteTagClicked(n),Ab.b.isNoteTagMarkable(n)&&Ab.b.isNoteTagMarked(n)?lI.r.showContextMenu(t.MenuIdClear,e):lI.r.showContextMenu(t.MenuIdMark,e)},t.PopulateContextMenuClear=function(e,n,i,r,o){return 1===i?32:(o.PopulationXML=t.CreateMenuXml(!1),32)},t.PopulateContextMenuMark=function(e,n,i,r,o){return 1===i?32:(o.PopulationXML=t.CreateMenuXml(!0),32)},t.CreateMenuXml=function(e){var n=new Sys.StringBuilder;return n.append(String.format('<Menu Id="{0}" Title="{1}" Description="{2}">',t.MenuIdMark,OneNoteIntl.OneNoteStrings.L_NoteTags,OneNoteIntl.OneNoteStrings.L_NoteTags)),n.append('<MenuSection Id="msNoteTagCommands" DisplayMode="Menu16"><Controls>'),n.append(lI.r.generateButtonXml("fseaNoteTagMark",nS.u.noteTagMark,"1_16_M_16x16x32",e?OneNoteIntl.OneNoteStrings.L_NoteTagMark:OneNoteIntl.OneNoteStrings.L_NoteTagClear)),n.append(lI.r.generateButtonXml("fseaNoteTagRemove",nS.u.noteTagRemove,"JotActionItemRemoveAll_16x16x32",OneNoteIntl.OneNoteStrings.L_NoteTagRemove)),n.append("</Controls></MenuSection></Menu>"),n.toString()},t.MenuIdMark="mnuNoteTagMark",t.MenuIdClear="mnuNoteTagClear",t._inited=!1,t}(lI.r);(0,o.l)(dI,"a4190063$NoteTagContextMenu",lI.r,[qA.v]);var gI=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.CreateContextMenu=function(){var e={PopulateDynamically:"true",PopulateOnlyOnce:"false"};e.PopulateQueryCommand=""+Oi.u.populateNotebookNavPaneContextMenu,e.Command=""+Fe.b.alwaysEnabled,lI.r.createContextMenuControl(e,t.MenuId,"","","Menu16"),L.AFrameworkApplication.get_theActionManager().addAction(Oi.u.populateNotebookNavPaneContextMenu,ol.d.application,t.PopulateContextMenu)},t.prototype.show=function(e){t._inited||(this.CreateContextMenu(),t._inited=!0),lI.r.showContextMenu(t.MenuId,e)},t.PopulateContextMenu=function(e,n,i,r,o){if(1===i)return 32;var a=o,l=new Sys.StringBuilder;return l.append(String.format('<Menu Id="{0}">',t.MenuId)),l.append('<MenuSection Id="msNotebook" DisplayMode="Menu16"><Controls>'),l.append(lI.r.generateButtonXml("fseaNotebookNewPage",Oi.u.newPage,"JotNewPageAtSectionEnd_16x16x32",OneNoteIntl.OneNoteStrings.L_NewPage)),l.append(lI.r.generateButtonXml("fseaNotebookNewSection",Oi.u.newSection,"JotInsertSection_16x16x32",OneNoteIntl.OneNoteStrings.L_NewSection)),l.append("</Controls></MenuSection></Menu>"),a.PopulationXML=l.toString(),32},t.MenuId="mnuNavPaneNotebook",t._inited=!1,t}(lI.r);(0,o.l)(gI,"7ae0f95b$NotebookNavPaneContextMenu",lI.r,[jA.f]);var pI=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.CreateContextMenu=function(){var e={PopulateDynamically:"true",PopulateOnlyOnce:"false"};e.PopulateQueryCommand=""+Oi.u.populateOutlineContextMenu,e.Command=""+Fe.b.alwaysEnabled,lI.r.createContextMenuControl(e,t.MenuId,"","","Menu16"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(Oi.u.populateOutlineContextMenu,ol.d.application,t.PopulateContextMenu,100)},t.prototype.show=function(e,n){t._inited||(this.CreateContextMenu(),t._inited=!0),lI.r.showContextMenuAt(t.MenuId,e,n)},t.PopulateContextMenu=function(e,n,i,r,o){if(1===i)return 32;var a=o,l=a.inputMethod,s=a.actionData,u=new Sys.StringBuilder;return u.append(String.format('<Menu Id="{0}">',t.MenuId)),u.append('<MenuSection Id="msOutlineClipboard" DisplayMode="Menu16"><Controls>'),u.append(lI.r.generateButtonXml("fseaCut",Oi.u.cut,"Cut_16x16x32",Box4Intl.Box4Strings.L_Cut)),u.append(lI.r.generateButtonXml("fseaCopy",Oi.u.copy,"Copy_16x16x32",Box4Intl.Box4Strings.L_Copy)),u.append(lI.r.generateButtonXml("fseaPaste",Oi.u.paste,"Paste_16x16x32",Box4Intl.Box4Strings.L_Paste)),3===l&&u.append(lI.r.generateButtonXml("fseaDelete",Oi.u.deleteKey,"Delete_16x16x32",Box4Intl.Box4Strings.L_Delete)),u.append("\r\n\t\t\t\t\t\t</Controls>\r\n\t\t\t\t\t</MenuSection>"),3===l||yi.App.get_activeAppFrame().workspace.get_contentView().get_isSingleOutlineLayout()||t.CreateMoveResizeSection(u),u.append("</Menu>"),s.PopulationXML=u.toString(),32},t.CreateMoveResizeSection=function(e){e.append('<MenuSection Id="msOutline" DisplayMode="Menu16">\r\n\t\t\t\t\t\t<Controls>'),e.append(lI.r.generateButtonXml("fseaMoveOutline",Oi.u.moveOutline,null,Box4Intl.Box4Strings.l_OutlineMove)),e.append(lI.r.generateButtonXml("fseaResizeOutline",Oi.u.resizeOutline,null,Box4Intl.Box4Strings.l_OutlineResize)),e.append("\r\n\t\t\t\t\t\t</Controls>\r\n\t\t\t\t\t</MenuSection>")},t.MenuId="mnuOutline",t._inited=!1,t}(lI.r);(0,o.l)(pI,"629b9081$OutlineContextMenu",lI.r,[]);var hI=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.show=function(e,n){t.ShowHelper(n),lI.r.showContextMenu(t.MenuId,e)},t.prototype.showAt=function(e,n,i){t.ShowHelper(n),lI.r.showContextMenuAt(t.MenuId,e,i)},t.get_PageReader=function(){return $s.PageReader.get_instance()},t.CreateContextMenu=function(){var e={PopulateDynamically:"true",PopulateOnlyOnce:"false"};e.PopulateQueryCommand=""+Oi.u.populatePageNavPaneContextMenu,e.Command=""+Fe.b.alwaysEnabled,lI.r.createContextMenuControl(e,t.MenuId,"","","Menu16"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(Oi.u.populatePageNavPaneContextMenu,ol.d.application,t.PopulateContextMenu,96)},t.PopulateContextMenu=function(e,n,i,r,o){if(1===i)return 32;var a=o;return t._floating?t.PopulateFloatingContextMenu(a):t.PopulatePageContextMenu(a),32},t.PopulatePageContextMenu=function(e){var n,i;L.AFrameworkApplication.get_isRtl()?(n="CustomFieldGraphicalIndicatorLeftArrow_16x16x32",i="CustomFieldGraphicalIndicatorRightArrow_16x16x32"):(n="CustomFieldGraphicalIndicatorRightArrow_16x16x32",i="CustomFieldGraphicalIndicatorLeftArrow_16x16x32");var r=Box4Intl.Box4Strings.L_ShowVersionsContextMenu;t.get_PageReader().areVersionsVisible(sI.get_pageClicked())&&(r=Box4Intl.Box4Strings.l_HideVersions);var o=new Sys.StringBuilder;o.append(String.format('<Menu Id="{0}">',t.MenuId)),o.append('<MenuSection Id="msDelete" DisplayMode="Menu16"><Controls>'),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteCopyPastePageIsEnabled")&&(o.append(lI.r.generateButtonXml("fseaCopyPage",nS.u.copyPage,"Copy_16x16x32",Box4Intl.Box4Strings.L_Copy)),o.append(lI.r.generateButtonXml("fseaPastePage",nS.u.pastePage,"Paste_16x16x32",Box4Intl.Box4Strings.L_Paste))),o.append(lI.r.generateButtonXml("fseaDeletePage",Oi.u.deletePage,"Delete_16x16x32",OneNoteIntl.OneNoteStrings.L_DeletePage)),o.append('"\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>\r\n\t\t\t\t<MenuSection Id="msMoveCopyPage" DisplayMode="Menu16">\r\n\t\t\t\t\t<Controls>'),o.append(lI.r.generateButtonXml("fseaMoveCopyPage",nS.u.showMoveOrCopyPageDialog,"JotMovePages_16x16x32",OneNoteIntl.OneNoteStrings.L_MoveOrCopyContextualMenuItem)),o.append('"\r\n\t\t\t\t\t\t</Controls>\r\n\t\t\t\t\t</MenuSection>\r\n\t\t\t\t\t<MenuSection Id="msNewPage" DisplayMode="Menu16">\r\n\t\t\t\t\t\t<Controls>'),o.append(lI.r.generateButtonXml("fseaNewPageAfterThisPage",Oi.u.newPageAfterThisPage,"JotNewPageAtSectionEnd_16x16x32",OneNoteIntl.OneNoteStrings.L_NewPage)),o.append('"\r\n\t\t\t\t\t\t</Controls>\r\n\t\t\t\t\t</MenuSection>\r\n\t\t\t\t\t<MenuSection Id="msIndent" DisplayMode="Menu16">\r\n\t\t\t\t\t\t<Controls>'),o.append(lI.r.generateButtonXml("fseaIncreaseIndent",Oi.u.increaseIndent,n,OneNoteIntl.OneNoteStrings.L_MakeSubpage)),o.append(lI.r.generateButtonXml("fseaDecreaseIndent",Oi.u.decreaseIndent,i,OneNoteIntl.OneNoteStrings.L_PromoteSubpage)),o.append('"\r\n\t\t\t\t\t\t</Controls>\r\n\t\t\t\t\t</MenuSection>\r\n\t\t\t\t\t<MenuSection Id="msVersions" DisplayMode="Menu16">\r\n\t\t\t\t\t\t<Controls>'),o.append(lI.r.generateButtonXml("fseaToggleVersionsVisibility",Oi.u.toggleVersionsVisibility,"Versions_16x16x32",r)),yi.App.hostUrl&&""!==yi.App.hostUrl&&(o.append('"\r\n\t\t\t\t\t\t\t</Controls>\r\n\t\t\t\t\t\t</MenuSection>\r\n\t\t\t\t\t\t<MenuSection Id="msVersions" DisplayMode="Menu16">\r\n\t\t\t\t\t\t\t<Controls>'),o.append(lI.r.generateButtonXml("fseaGetPageUrl",Oi.u.getPageUrl,"WebInsertHyperlink_16x16x32",Box4Intl.Box4Strings.l_GetPageUrlOptionText))),o.append("</Controls></MenuSection></Menu>"),e.PopulationXML=o.toString()},t.PopulateFloatingContextMenu=function(e){var n=new Sys.StringBuilder;n.append(String.format('<Menu Id="{0}">',t.MenuId)),n.append('<MenuSection Id="msFloating" DisplayMode="Menu16"><Controls>'),n.append(lI.r.generateButtonXml("fseaNewPage",Oi.u.newPage,"JotNewPageAtSectionEnd_16x16x32",OneNoteIntl.OneNoteStrings.L_NewPage)),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteCopyPastePageIsEnabled")&&n.append(lI.r.generateButtonXml("fseaPastePageInSection",nS.u.pastePageInSection,"Paste_16x16x32",Box4Intl.Box4Strings.L_Paste)),n.append("</Controls></MenuSection></Menu>"),e.PopulationXML=n.toString()},t.ShowHelper=function(e){t._inited||(t.CreateContextMenu(),t._inited=!0),!e||lb.j.isSection(ha.g.createFromNode(e))?(sI.sectionClicked=e,t._floating=!0):(sI.set_pageClicked(e),sI.sectionClicked=Rm.SectionNavigator.getSection(sI.get_pageClicked()),t._floating=!1)},t.MenuId="mnuNavPanePage",t._inited=!1,t._floating=!1,t}(lI.r);(0,o.l)(hI,"15ff6a91$PageNavPaneContextMenu",lI.r,[QA.w]);var _I=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.show=function(e,n){t.EnsureContextMenuIsCreated(n),lI.r.showContextMenu(t.MenuId,e),sI.set_pageClicked(n)},t.CreateContextMenu=function(){var e={PopulateDynamically:"true",PopulateOnlyOnce:"false"};e.PopulateQueryCommand=""+nS.u.populateRecycleBinPageNavPaneContextMenu,e.Command=""+Fe.b.alwaysEnabled,lI.r.createContextMenuControl(e,t.MenuId,"","","Menu16"),L.AFrameworkApplication.get_theActionManager().addAction(nS.u.populateRecycleBinPageNavPaneContextMenu,ol.d.application,t.PopulateContextMenu)},t.PopulateContextMenu=function(e,n,i,r,o){if(1===i)return 32;var a=o;return t.PopulatePageContextMenu(a),32},t.PopulatePageContextMenu=function(e){var n=new Sys.StringBuilder;n.append(String.format('<Menu Id="{0}">',t.MenuId)),n.append('<MenuSection Id="msDelete" DisplayMode="Menu16"><Controls>'),n.append(lI.r.generateButtonXml("fseaRestorePage",nS.u.showRestorePageDialog,"JotMovePages_16x16x32",OneNoteIntl.OneNoteStrings.L_RestorePage)),n.append(lI.r.generateButtonXml("fseaDeletePage",nS.u.permanentlyDeletePage,"Delete_16x16x32",OneNoteIntl.OneNoteStrings.L_PermanentlyDeletePage)),n.append("</Controls></MenuSection></Menu>"),e.PopulationXML=n.toString()},t.EnsureContextMenuIsCreated=function(e){t._inited||(t.CreateContextMenu(),t._inited=!0)},t.MenuId="mnuRecycleBinPageNavPanePage",t._inited=!1,t}(lI.r);(0,o.l)(_I,"bdd2ce13$RecycleBinPageNavPaneContextMenu",lI.r,[XA.d]);var mI=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.CreateContextMenu=function(){var e={PopulateDynamically:"true",PopulateOnlyOnce:"false"};e.PopulateQueryCommand=""+Oi.u.populateSectionNavPaneContextMenu,e.Command=""+Fe.b.alwaysEnabled,lI.r.createContextMenuControl(e,t.MenuId,"","","Menu16"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(Oi.u.populateSectionNavPaneContextMenu,ol.d.application,2===yi.App.get_activeAppFrame().get_mode()?t.PopulateEditModeContextMenu:t.PopulateReadingModeContextMenu,96)},t.prototype.ShowHelper=function(e){sI.sectionClicked=e,t._inited||(this.CreateContextMenu(),t._inited=!0)},t.prototype.show=function(e,n){this.ShowHelper(n),lI.r.showContextMenu(t.MenuId,e)},t.prototype.showAt=function(e,n,i){this.ShowHelper(n),lI.r.showContextMenuAt(t.MenuId,e,i)},t.PopulateEditModeContextMenu=function(e,n,i,r,o){if(1===i)return 32;var a=o,l=new Sys.StringBuilder;return l.append(String.format('<Menu Id="{0}">',t.MenuId)),l.append('<MenuSection Id="msModify" DisplayMode="Menu16"><Controls>'),l.append(lI.r.generateButtonXml("fseaRenameSection",Oi.u.renameSection,null,OneNoteIntl.OneNoteStrings.L_RenameSection)),l.append(lI.r.generateButtonXml("fseaDeleteSection",Oi.u.deleteSection,"Delete_16x16x32",OneNoteIntl.OneNoteStrings.L_DeleteSection)),sI.sectionClicked.get_isPasswordProtectedUnlockable()&&sI.sectionClicked.get_encryptionSessionString()&&l.append(lI.r.generateButtonXml("fseaLockSection",Oi.u.lockSection,null,Box4Intl.Box4Strings.l_LockSection)),t.GenerateSectionColorMenu(l),l.append('"\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>\r\n\t\t\t\t<MenuSection Id="msNew" DisplayMode="Menu16">\r\n\t\t\t\t\t<Controls>'),l.append(lI.r.generateButtonXml("fseaNewPageInSection",Oi.u.newPageInSection,"JotNewPageAtSectionEnd_16x16x32",OneNoteIntl.OneNoteStrings.L_NewPage)),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteCopyPastePageIsEnabled")&&l.append(lI.r.generateButtonXml("fseaPastePageInSection",nS.u.pastePageInSection,"Paste_16x16x32",Box4Intl.Box4Strings.L_Paste)),l.append(lI.r.generateButtonXml("fseaNewSectionAfterSection",Oi.u.newSectionAfterSection,"JotInsertSection_16x16x32",OneNoteIntl.OneNoteStrings.L_NewSection)),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteCopySectionLinkIsEnabled")&&l.append(lI.r.generateButtonXml("fseaGetSectionUrlSection",nS.u.getSectionUrl,"WebInsertHyperlink_16x16x32",OneNoteIntl.OneNoteStrings.L_GetSectionUrlOptionText)),l.append("</Controls></MenuSection></Menu>"),a.PopulationXML=l.toString(),32},t.PopulateReadingModeContextMenu=function(e,n,i,r,o){if(1===i)return 32;var a=o,l=new Sys.StringBuilder;return l.append(String.format('<Menu Id="{0}">',t.MenuId)),l.append('<MenuSection Id="msModify" DisplayMode="Menu16"><Controls>'),sI.sectionClicked.get_isPasswordProtectedUnlockable()&&sI.sectionClicked.get_encryptionSessionString()&&l.append(lI.r.generateButtonXml("fseaLockSection",Oi.u.lockSection,null,Box4Intl.Box4Strings.l_LockSection)),l.append('"\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>\r\n\t\t\t</Menu>'),a.PopulationXML=l.toString(),32},t.GenerateSectionColorMenu=function(e){e.append('<FlyoutAnchor\r\n\t\t\t\t\tId="fsfaSectionColor"\r\n\t\t\t\t\tCommand="'),e.append("2373580415"),e.append('"\r\n\t\t\t\t\tLabelText="'),e.append(Rn.l.xmlEncode(Box4Intl.Box4Strings.l_SectionColor)),e.append('">\r\n\t\t\t\t\t<Menu Id="menuSectionColor">\r\n\t\t\t\t\t\t<MenuSection Id="msSectionColor" DisplayMode="Menu16">\r\n\t\t\t\t\t\t\t<Controls>');for(var n=1;n<=17;n++)if(17!==n){var i=ff.o.nameForNotebookColor(n);e.append(Yu.s.buildToggleButtonXml("fseaSectionColor"+n.toString(),n.toString(),"2858610352","2329507668",i,i,t.IconForNotebookColor(n)))}e.append('\t\t\t</Controls>\r\n\t\t\t\t\t\t</MenuSection>\r\n\t\t\t\t\t\t<MenuSection Id="msSectionColorNone" DisplayMode="Menu16">\r\n\t\t\t\t\t\t\t<Controls>'),e.append(Yu.s.buildToggleButtonXml("fseaSectionColorNone","0","2858610352","2329507668",Box4Intl.Box4Strings.l_NotebookColorNone)),e.append("\r\n\t\t\t\t\t\t\t</Controls>\r\n\t\t\t\t\t\t</MenuSection>\r\n\t\t\t\t\t</Menu>\r\n\t\t\t\t</FlyoutAnchor>")},t.IconForNotebookColor=function(e){switch(e){case 1:return"JotNotebookColor4_16x16x32";case 4:return"JotNotebookColor7_16x16x32";case 12:return"JotNotebookColor12_16x16x32";case 13:return"JotNotebookColor13_16x16x32";case 9:return"JotNotebookColor9_16x16x32";case 8:return"JotNotebookColor1_16x16x32";case 2:return"JotNotebookColor2_16x16x32";case 3:return"JotNotebookColor3_16x16x32";case 16:return"JotNotebookColor16_16x16x32";case 5:return"JotNotebookColor5_16x16x32";case 11:return"JotNotebookColor11_16x16x32";case 6:return"JotNotebookColor8_16x16x32";case 10:return"JotNotebookColor10_16x16x32";case 15:return"JotNotebookColor15_16x16x32";case 7:return"JotNotebookColor6_16x16x32";case 14:return"JotNotebookColor14_16x16x32";default:return""}},t.MenuId="mnuNavPaneSection",t._inited=!1,t}(lI.r);(0,o.l)(mI,"354bf3cb$SectionNavPaneContextMenu",lI.r,[JA.c]);var fI=function(){function e(){}return e.prototype.showContextMenuForSelection=function(t,n){this.get_CanShowContextMenu()&&this.showContextMenuForType(t,n,e.get_menuTypeForCurrentSelection(),e.get_currentSelection())},e.prototype.showContextMenuForType=function(t,n,i,r){switch(i){case 1:case 6:case 2:case 3:case 4:e.get_EditSurfaceContextMenu().show(r,t,n)}},e.prototype.menuForSelectionHasAssociatedFloatie=function(){switch(e.get_menuTypeForCurrentSelection()){case 5:case 1:return!0;default:return!1}},e.prototype.currentSelectionType=function(){return e.get_menuTypeForCurrentSelection()},e.prototype.get_CanShowContextMenu=function(){return 1!==yi.App.get_activeAppFrame().get_state()},e.get_EditSurfaceContextMenu=function(){return e._editSurfaceContextMenu||(e._editSurfaceContextMenu=Ge.w.get_instance().resolve(Uc.n))},e.GetMenuTypeForSelection=function(e){if(!e)return 0;if(2!==yi.App.get_activeAppFrame().get_mode())return 4;if(!(Gl.n.get_instance().get_item(17)&&1===e.get_length()&&ys.OutlineReader.isOutlineContext(e.get_firstContext())&&yi.App.get_activeAppFrame().workspace.get_contentView()&&yi.App.get_activeAppFrame().workspace.get_contentView().get_isPageView())){var t=e.get_firstContext().get_node();return(n=ha.g.createFromNode(t)).tryToRootAtPageContent(),Bm.r.isInkNode(n.get_currentNode())?2:L.AFrameworkApplication.userNameUnknown||!N_.EmbeddedFileReader.isEmbeddedFileNode(t)||N_.EmbeddedFileReader.isInvalid(t)?Vf.q.isIFrameContext(e.get_firstContext())||Vf.q.isFloatingIFrameContext(e.get_firstContext())?6:1:3}var n;return(n=ha.g.createFromNode(e.get_firstContext().get_node())).tryToRootAtPageContent(),Qs.q.isInTitle(n)?0:5},e.get_currentSelection=function(){return fa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection()},e.get_menuTypeForCurrentSelection=function(){return e.GetMenuTypeForSelection(e.get_currentSelection())},e._editSurfaceContextMenu=null,e}();(0,o.l)(fI,"e7b068b8$SelectionContextMenuProvider",null,[Bc.f]);var yI=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.showContextMenuForType=function(n,i,r,o){5===r?t.get_OutlineContextMenu().show(n,i):e.prototype.showContextMenuForType.call(this,n,i,r,o)},t.get_OutlineContextMenu=function(){return t._outlineContextMenu||(t._outlineContextMenu=Ge.w.get_instance().resolve(pI))},t._outlineContextMenu=null,t}(fI);(0,o.l)(yI,"f4b32320$SelectionContextMenuProvider",fI,[]);var CI=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.CreateContextMenu=function(){var e={PopulateDynamically:"true",PopulateOnlyOnce:"false"};e.PopulateQueryCommand=""+Oi.u.populateVersionBusinessBarContextMenu,e.Command=""+Fe.b.alwaysEnabled,lI.r.createContextMenuControl(e,t.MenuId,"","","Menu16"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(Oi.u.populateVersionBusinessBarContextMenu,ol.d.application,t.PopulateContextMenu,96)},t.prototype.show=function(e,n){t._inited||(this.CreateContextMenu(),t._inited=!0),sI.set_versionClicked(n),lI.r.showContextMenu(t.MenuId,e)},t.prototype.ShowAt=function(e,n){t._inited||(this.CreateContextMenu(),t._inited=!0),sI.set_versionClicked(yi.App.get_activeAppFrame().workspace.get_activePage()),lI.r.showContextMenuAt(t.MenuId,e,n)},t.prototype.onInvokeVersionHistoryBusinessBar=function(e,t){var n=null;return n=1===t.get_inputSource()?e.get_getPointForContextMenu():t.get_clientPoint(),this.ShowAt(n,t.get_inputSource()),!0},t.get_PageReader=function(){return $s.PageReader.get_instance()},t.PopulateContextMenu=function(e,n,i,r,o){if(1===i)return 32;var a=o,l=new Sys.StringBuilder;return l.append(String.format('<Menu Id="{0}">',t.MenuId)),l.append('<MenuSection Id="msVersionActions" DisplayMode="Menu16"><Controls>'),l.append(lI.r.generateButtonXml("fseaToggleVersionsVisibilityBusinessBar",Oi.u.toggleVersionsVisibility,"Versions_16x16x32",Box4Intl.Box4Strings.l_HideVersions)),l.append(lI.r.generateButtonXml("fseaRestoreVersion",Oi.u.restoreVersion,null,Box4Intl.Box4Strings.l_RestoreVersion)),l.append(lI.r.generateButtonXml("fseaDeleteVersion",Oi.u.deleteVersion,"Delete_16x16x32",Box4Intl.Box4Strings.l_DeletePage)),l.append("</Controls></MenuSection></Menu>"),a.PopulationXML=l.toString(),32},t.MenuId="mnuVersion",t._inited=!1,t}(lI.r);(0,o.l)(CI,"ebde83ac$VersionBusinessBarContextMenu",lI.r,[YA.x]);var SI=function(){return function(){this.preExecCommand=null,this.postExecCommand=null,this.applyQueryResult=null,this.applySpinnerQueryResult=null}}();(0,o.l)(SI,"b1229e4b$GeneralCuiUserHooks",null,[]);var bI=n(1868),vI=function(e){function t(t){var n=e.call(this)||this;return n.hasMultipleIndentTypes=!1,n.layoutAlignmentInParent=t.layoutAlignmentInParent,n.isRtl=t.isRtl,n.indentInfo=t.indentInfo,n.spacing=t.spacing,n.listInfo=t.listInfo,n.listType=t.listType,n}return(0,v.t)(t,e),t}(wc.n);(0,o.l)(vI,"a4858a45$CumulativeParagraphFormattingData",wc.n,[]);var TI=n(4102),AI=function(){return function(){this.unit=0,this.value=0}}();(0,o.l)(AI,"79b19dd9$ParagraphSpacingCommandData",null,[]);var II=function(e){function t(n){void 0===n&&(n=null);var i=e.call(this)||this;return t.appSettingsManager=n,i}return(0,v.t)(t,e),t.prototype.initialize=function(){e.prototype.initialize.call(this),this.executeFunctions.set_item(Oi.u.applyStyle,o.i(this,this.ApplyStyleExecuteBridge,"ApplyStyleExecuteBridge")),this.executeFunctions.set_item(Oi.u.toggleBulletsList,t.BulletsExecuteBridge),this.executeFunctions.set_item(Oi.u.setCellShadingColor,t.fontColorExecuteBridge),this.executeFunctions.set_item(Oi.u.defineNewBulletFont,Ec.fontExecuteBridge),this.executeFunctions.set_item(Oi.u.setFontBackgroundColor,t.fontColorExecuteBridge),this.executeFunctions.set_item(Oi.u.setFontColor,t.fontColorExecuteBridge),this.executeFunctions.set_item(Oi.u.imageResize,t.ImageResizeExecuteBridge),this.executeFunctions.set_item(Oi.u.setImageAbsoluteHeight,t.ImageAbsoluteHeightExecuteBridge),this.executeFunctions.set_item(Oi.u.setImageAbsoluteWidth,t.ImageAbsoluteWidthExecuteBridge),this.executeFunctions.set_item(Oi.u.setImageAltTextTitle,t.ImageAltTextTitleExecuteBridge),this.executeFunctions.set_item(Oi.u.setImageAltTextDescription,t.ImageAltTextDescriptionExecuteBridge),this.executeFunctions.set_item(Oi.u.imageLockAspectRatio,t.ImageLockAspectRatioExecuteBridge),this.executeFunctions.set_item(Oi.u.indentBefore,t.ParaIndentExecuteBridge),this.executeFunctions.set_item(Oi.u.indentBeforePageLayoutTab,t.ParaIndentExecuteBridge),this.executeFunctions.set_item(Oi.u.indentAfter,t.ParaIndentExecuteBridge),this.executeFunctions.set_item(Oi.u.insertTable,t.InsertTableExecuteBridge),this.executeFunctions.set_item(Oi.u.setLineSpacing,t.LineSpacingExecuteBridge),this.executeFunctions.set_item(Oi.u.toggleNumberedList,t.NumberingExecuteBridge),this.executeFunctions.set_item(Oi.u.multilevelList,t.MultilevelExecuteBridge),this.executeFunctions.set_item(Oi.u.setOrientation,t.OrientationExecuteBridge),this.executeFunctions.set_item(Oi.u.populateEditSurfaceMenu,Ec.inputMethodExecuteBridge),this.executeFunctions.set_item(Oi.u.setPictureStyle,t.SetPictureStyleExecuteBridge),this.executeFunctions.set_item(Oi.u.setSpacingAfterLine,t.ParaSpacingExecuteBridge),this.executeFunctions.set_item(Oi.u.setSpacingBeforeLine,t.ParaSpacingExecuteBridge),this.executeFunctions.set_item(Oi.u.insertPictureDialog,Ec.executeBridgeWithNoData),this.executeFunctions.set_item(Oi.u.insertCameraPicture,Ec.executeBridgeWithNoData),this.executeFunctions.set_item(Oi.u.insertClipartDialog,Ec.executeBridgeWithNoData),this.executeFunctions.set_item(Oi.u.cut,t.asyncActionExecuteBridge),this.executeFunctions.set_item(Oi.u.copy,t.asyncActionExecuteBridge),this.executeFunctions.set_item(Oi.u.paste,t.asyncActionExecuteBridge),this.executeFunctions.set_item(Oi.u.pasteTextOnly,t.asyncActionExecuteBridge),this.executeFunctions.set_item(Oi.u.reformatPastedContent,t.asyncActionExecuteBridge),this.executeFunctions.set_item(Oi.u.reformatPastedContentToPlainText,t.asyncActionExecuteBridge),this.executeFunctions.set_item(Oi.u.clearFormatting,t.FormattingExecuteBridge),this.executeFunctions.set_item(Oi.u.queryAlwaysPressed,Ec.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(Oi.u.queryAuthorInfoVisibility,Ec.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(Oi.u.queryBordersHidden,Ec.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(Oi.u.queryShowNoSelection,Ec.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(Oi.u.queryStyle,Ec.queryTextRangeStyleDataExecuteBridge),this.executeFunctions.set_item(Oi.u.queryTableTabGroup,Ec.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(Oi.u.queryVersionsVisibility,Ec.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(Oi.u.queryImageLockAspectRatio,Ec.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(Oi.u.queryImageResize,t.GenericSpinnerQueryExecuteBridge),this.executeFunctions.set_item(Oi.u.queryImageAbsoluteHeight,t.GenericSpinnerQueryExecuteBridge),this.executeFunctions.set_item(Oi.u.queryImageAbsoluteWidth,t.GenericSpinnerQueryExecuteBridge),this.executeFunctions.set_item(Oi.u.queryImageAngle,t.GenericSpinnerQueryExecuteBridge),this.executeFunctions.set_item(Oi.u.queryImageAltTextTitle,t.GenericTextBoxQueryExecuteBridge),this.executeFunctions.set_item(Oi.u.queryImageAltTextDescription,t.GenericTextBoxQueryExecuteBridge),this.executeFunctions.set_item(Oi.u.imageRotate,o.i(this,this.ImageRotateExecuteBridge,"ImageRotateExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryTextDirLTR,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryTextDirRTL,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryLineSpacing,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryBullets,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryBulletsStyle1,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryBulletsStyle2,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryBulletsStyle3,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryListMarkerBullets,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryListMarkerNumbering,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryListMarkerMultilevel,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryNumbering,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryNumberingStyle1,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryNumberingStyle2,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryNumberingStyle3,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryNumberingStyle4,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryNumberingStyle5,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryMultilevel,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryPromote,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryDemote,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryLabelIndentBefore,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryLabelIndentAfter,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryIndentBefore,o.i(this,this.QueryParaFormattingSpinnersExecuteBridge,"QueryParaFormattingSpinnersExecuteBridge")),this.executeFunctions.set_item(Oi.u.queryIndentAfter,o.i(this,this.QueryParaFormattingSpinnersExecuteBridge,"QueryParaFormattingSpinnersExecuteBridge")),this.executeFunctions.set_item(Oi.u.querySpacingBefore,o.i(this,this.QueryParaFormattingSpinnersExecuteBridge,"QueryParaFormattingSpinnersExecuteBridge")),this.executeFunctions.set_item(Oi.u.querySpacingAfter,o.i(this,this.QueryParaFormattingSpinnersExecuteBridge,"QueryParaFormattingSpinnersExecuteBridge")),this.enabledFunctions.set_item(Oi.u.populateMenuMoreStyles,Ec.dictionaryPropertySetEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryTextDirLTR,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryTextDirRTL,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryBullets,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryBulletsStyle1,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryBulletsStyle2,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryBulletsStyle3,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryListMarkerBullets,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryListMarkerNumbering,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryListMarkerMultilevel,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryNumbering,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryNumberingStyle1,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryNumberingStyle2,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryNumberingStyle3,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryNumberingStyle4,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryNumberingStyle5,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryMultilevel,Ec.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryMarginsNormal,t.RemapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryMarginsNarrow,t.RemapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryMarginsModerate,t.RemapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryMarginsWide,t.RemapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryMarginsOffice2003,t.RemapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryMarginsCustom,t.RemapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryPageSizeLetter,t.RemapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryPageSizeLegal,t.RemapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryPageSizeExecutive,t.RemapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryPageSizeA4,t.RemapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryPageSizeA5,t.RemapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(Oi.u.queryPageSizeCustom,t.RemapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(Oi.u.populateDefineNewBulletFontDropdown,Ec.dictionaryPropertySetEnabledBridge)},t.prototype.getCuiUserHooks=function(){var e=new SI;return e.applyQueryResult=t.applyQueryResult,e.applySpinnerQueryResult=t.applySpinnerQueryResult,e.preExecCommand=null,e.postExecCommand=null,e},t.prototype.ApplyStyleExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=Ef.StylePreviewGenerator.getStyleIdFromControlId(t.SourceControlId,bs.StyleReader.getStyleSetFromActivePage()),Gl.n.get_instance().get_item(61)&&!bs.StyleReader.hasQuickStyles()&&(i.earlyReturnBool=!1,yi.App.get_activeAppFrame().updateCommandUI()),i},t.prototype.QueryParaFormattingSpinnersExecuteBridge=function(e,t,n){var i=new bc;return i.haveCachedValue=this._hasCachedParagraphFormatting,this._hasCachedParagraphFormatting=!0,i.actionToRun=Oi.u.queryParagraphFormatting,this._paragraphFormattingProperties=new vI(this._paragraphFormattingProperties),i.actionData=this._paragraphFormattingProperties,i.isQuerySpinnerCommand=!0,i},t.prototype.ImageRotateExecuteBridge=function(e,t,n){var i=0,r=0;if(t.MenuItemId)switch(t.MenuItemId){case"buttonRotateRight90":i=1,r=90;break;case"buttonRotateLeft90":i=2,r=270;break;case"buttonFlipVertical":i=3;break;case"buttonFlipHorizontal":i=4}else i=0,r=t[So.Number];var o=new bc;return o.actionData=new Dl.DictionaryPropertySet,o.actionData.setValue(Pl.k.imageRotateActionType,i),o.actionData.setValue(Pl.k.imageRotateAngle,r),o},t.get_ListReader=function(){return Ge.w.get_instance().resolve(Ql.c)},t.get_IsHighlightStyleWhenDifferentFromSelectionEnabled=function(){return null==t._isHighlightStyleWhenDifferentFromSelectionEnabled&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordHighlightStyleWhenDifferentFromSelectionSettings"),L.AFrameworkApplication.appSettingsManager?t._isHighlightStyleWhenDifferentFromSelectionEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HighlightStyleWhenDifferentFromSelectionIsEnabled"):t._isHighlightStyleWhenDifferentFromSelectionEnabled=!1),t._isHighlightStyleWhenDifferentFromSelectionEnabled},t.applyQueryResult=function(e,n){var i=(0,y.e)(ph.d,e.actionData),r=(0,y.e)(Ic,e.actionData),o=(0,y.e)(wc.n,e.actionData),a=(0,y.e)(Tc,e.actionData),l=!0;switch(e.originalActionId){default:l=Ec.applyQueryResult(e,n);break;case Oi.u.queryAuthorInfoVisibility:n[gr.e.On]=i.getValueWithDefault(Boolean,Pl.k.showAuthorInfo,!1);break;case Oi.u.queryVersionsVisibility:n[gr.e.On]=i.getValueWithDefault(Boolean,Pl.k.versionsVisible,!1);break;case Oi.u.queryBordersHidden:n[gr.e.On]=i.getValueWithDefault(Boolean,is.b.tableBordersVisible,!1);break;case Oi.u.queryFont:n[jr.g.IsFreeForm]=!0,void 0!==r.fontName&&null!==r.fontName?n[jr.g.Value]=vc.FormattingReader.getDisplayFontNameWithTheme(r.fontName,r.themeFontIndex):n[jr.g.Value]="";break;case Oi.u.queryBullets:n[To.z.On]=t.GetListToggleState(o.listInfo,1),n[To.z.Image16by16Class]=o.isRtl?Ct.ImageClusteringHelper.getImageClass("BulletsRTL_16x16x32"):Ct.ImageClusteringHelper.getImageClass("Bullets_16x16x32");break;case Oi.u.queryBulletsStyle1:n[gr.e.On]=t.GetListStyleToggleState(o.listInfo,1,1);break;case Oi.u.queryBulletsStyle2:n[gr.e.On]=t.GetListStyleToggleState(o.listInfo,1,2);break;case Oi.u.queryBulletsStyle3:n[gr.e.On]=t.GetListStyleToggleState(o.listInfo,1,3);break;case Oi.u.queryNumbering:n[To.z.On]=t.GetListToggleState(o.listInfo,0),n[To.z.Image16by16Class]=o.isRtl?Ct.ImageClusteringHelper.getImageClass("NumberingRTL_16x16x32"):Ct.ImageClusteringHelper.getImageClass("Numbering_16x16x32");break;case Oi.u.queryNumberingStyle1:n[gr.e.On]=t.GetListStyleToggleState(o.listInfo,0,1);break;case Oi.u.queryNumberingStyle2:n[gr.e.On]=t.GetListStyleToggleState(o.listInfo,0,2);break;case Oi.u.queryNumberingStyle3:n[gr.e.On]=t.GetListStyleToggleState(o.listInfo,0,3);break;case Oi.u.queryNumberingStyle4:n[gr.e.On]=t.GetListStyleToggleState(o.listInfo,0,4);break;case Oi.u.queryNumberingStyle5:n[gr.e.On]=t.GetListStyleToggleState(o.listInfo,0,5);break;case Oi.u.queryMultilevel:n[Zr.g.Image16by16Class]=o.isRtl?Ct.ImageClusteringHelper.getImageClass("OutlineNumberingRTL_16x16x32"):Ct.ImageClusteringHelper.getImageClass("OutlineNumbering_16x16x32");break;case Oi.u.queryPromote:n[dr.f.Image16by16Class]=o.isRtl?Ct.ImageClusteringHelper.getImageClass("OutdentRTL_16x16x32"):Ct.ImageClusteringHelper.getImageClass("Outdent_16x16x32");break;case Oi.u.queryDemote:n[dr.f.Image16by16Class]=o.isRtl?Ct.ImageClusteringHelper.getImageClass("IndentRTL_16x16x32"):Ct.ImageClusteringHelper.getImageClass("Indent_16x16x32");break;case Oi.u.queryLineSpacing:n[gr.e.On]=t.ShouldHighlightLineSpacing(n.MenuItemId,o);break;case Oi.u.queryTextDirLTR:n[gr.e.On]=!o.isRtl,t.RegisterHomeTabUpdateActionsForTextDirectionChange(o.isRtl,n);break;case Oi.u.queryTextDirRTL:n[gr.e.On]=o.isRtl;break;case Oi.u.queryStyle:t.ApplyQueryResultFontStyle(a,n);break;case Oi.u.queryShowNoSelection:n[to.u.On]=!1;break;case Oi.u.queryLabelIndentBefore:n[so.i.Value]=o.isRtl?WoncaIntl.WoncaStrings.L_LabelIndentBeforeRtl:WoncaIntl.WoncaStrings.L_LabelIndentBeforeLtr,n[so.i.Image16by16Class]=o.isRtl?Ct.ImageClusteringHelper.getImageClass("IndentRTL_16x16x32"):Ct.ImageClusteringHelper.getImageClass("Indent_16x16x32");break;case Oi.u.queryLabelIndentAfter:n[so.i.Value]=o.isRtl?WoncaIntl.WoncaStrings.L_LabelIndentAfterRtl:WoncaIntl.WoncaStrings.L_LabelIndentAfterLtr,n[so.i.Image16by16Class]=o.isRtl?Ct.ImageClusteringHelper.getImageClassWithCluster("we_pl","SpinnerIndentAfter_16x16x32"):Ct.ImageClusteringHelper.getImageClassWithCluster("we_pl","SpinnerIndentRight_16x16x32");break;case Oi.u.queryListMarkerMultilevel:n[to.u.On]=!1,n[to.u.IsRtl]=o.isRtl?2:1;break;case Oi.u.queryListMarkerBullets:t.PerformQueryListMarkerBullets(n,o);break;case Oi.u.queryListMarkerNumbering:t.PerformListMarkerQueryNumbering(n,o);break;case Oi.u.queryImageLockAspectRatio:var s=i.getValueWithDefault(Boolean,Pl.k.imageLockAspectRatio,!0);n[gr.e.On]=s;break;case Oi.u.queryImageAltTextTitle:var u=i.getValueWithDefault(String,Pl.k.imageAltTextTitle,"");n[xo.Text]=u;break;case Oi.u.queryImageAltTextDescription:var c=i.getValueWithDefault(String,Pl.k.imageAltTextDescription,"");n[xo.Text]=c}return l},t.AddReduxActionsToDictionary=function(e,t){t&&t.length>0&&(e[mr.b.reduxActions]=t)},t.RegisterHomeTabUpdateActionsForTextDirectionChange=function(e,n){if(Ln.AppChromeUtils.isSimplifiedReactRibbonUxEnabled()&&Ln.AppChromeUtils.apiExtensionExists("getHomeTabIconActionsForTextDirectionChange")){var i=appChrome.getHomeTabIconActionsForTextDirectionChange(e);t.AddReduxActionsToDictionary(n,i)}},t.RegisterLayoutTabUpdateActionsForTextDirectionChange=function(e,n){if(Ln.AppChromeUtils.isSimplifiedReactRibbonUxEnabled()&&Ln.AppChromeUtils.apiExtensionExists("getLayoutTabIconActionsForTextDirectionChange")){var i=appChrome.getLayoutTabIconActionsForTextDirectionChange(e);t.AddReduxActionsToDictionary(n,i)}},t.ApplyQueryResultFontStyle=function(e,n){if(e&&bs.StyleReader.isValidStyleContainer(e.styleProperties)){var i=e.styleProperties,r=n.SourceControlId,o=Ef.StylePreviewGenerator.styleButtonPrefix.length,a=parseInt(r.substr(o));n[to.u.InnerHTML]=Ef.StylePreviewGenerator.styleGalleryButtonInnerHtml(a);var l=Ef.StylePreviewGenerator.styleGalleryButtonText(a),s=bs.StyleReader.getStyleId(i),u=Ef.StylePreviewGenerator.getStyleIdFromControlId(r,bs.StyleReader.getStyleSetFromActivePage()),c=s===u||i.getValueWithDefault(String,os.j.linkedStyle,null)===u;if(n[to.u.On]=c,S.ULS.sendTraceTag(51220765,324,50,"Flag to match styles is : {0}",c),t.get_IsHighlightStyleWhenDifferentFromSelectionEnabled()&&c?n[to.u.InnerHTML]=Ef.StylePreviewGenerator.styleGalleryButtonInnerHtml(a,e.isHighlightedStyleDiffFromSelection):n[to.u.InnerHTML]=Ef.StylePreviewGenerator.styleGalleryButtonInnerHtml(a),n[to.u.Alt]=l,L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()){var d=(0,U.m)(new ZS.n,{Id:r,ExternalId:r,Command:"1040747875",QueryCommand:"3123760305",LabelText:l,Style:Ef.StylePreviewGenerator.getCssStyleDictionaryForGalleryButton(a,!0),PreviewStyleLabel:Box4Intl.Box4Strings.L_StylePreviewSampleText});n[to.u.GalleryButtonProps]=d}}else n[to.u.InnerHTML]="",n[to.u.Alt]="",n[to.u.On]=!1,n[to.u.GalleryButtonProps]=null},t.PerformQueryListMarkerBullets=function(e,t){if(t){var n=null,i=null,r=!t.listInfo,o=r?null:t.listInfo.get_propertySet();if(o&&(r=!o.hasProperty(os.j.listLevelText),1!==t.listInfo.get_listType()))e[to.u.On]=!1;else{r||(n=o.getValueWithDefault(String,os.j.listLevelText,null),i=o.getValueWithDefault(String,is.b.font,null));var a,l=e.SourceControlId,s="BulletStyleBulletsLibrary_",u=Ge.w.get_instance().tryResolve(iC),c=s.length,d=parseInt(l.substr(Math.min(l.length-1,c)));if(-1!==l.indexOf(s)){if(r)return void(e[to.u.On]=!d);a=u.get_listMarkersDictionary().get_value()}else{if(r)return void(e[to.u.On]=!1);c=(s="BulletStyleDocumentBullets_").length,d=parseInt(l.substr(c)),a=u.get_listMarkersInDocumentDictionary()}var g=M_.p.getKeys(a),p=g.length;if(p>0&&d>=g.length&&(d-=parseInt(g[0])),d<p){var h=a[g[d]];if(h){var _=h.get_levelText(),m=h.get_font();if(n&&i&&_&&m&&n===_&&i===m)return void(e[to.u.On]=!0)}}e[to.u.On]=!1}}else e[to.u.On]=!1},t.PerformListMarkerQueryNumbering=function(e,n){if(n){var i,r=!1,o=!1,a=t.PropertySetForNumbering(n,(0,g.m)((function(){return r}),(function(e){return r=e})),(0,g.m)((function(){return o}),(function(e){return o=e}))),l=e.SourceControlId,s="NumberingStyleNumberingLibrary_",u=Ge.w.get_instance().tryResolve(cC),c=s.length,d=parseInt(l.substr(Math.min(l.length-1,c))),p=null,h=null;if(-1!==l.indexOf(s)){if(r)return void(d?t.SetGalleryButtonLookAndRtl(e,!1,n):e[to.u.On]=!0);if(p=a.getValueWithDefault(String,os.j.listLevelText,null),a.getValueWithDefault(String,is.b.font,null),h=n.listInfo.get_listStyle()+"",o)return d&&(e[to.u.IsRtl]=n.isRtl?2:1),void(e[to.u.On]=!1);i=u.get_listMarkersDictionary().get_value()}else{if(r||o)return void t.SetGalleryButtonLookAndRtl(e,!1,n);p=a.getValueWithDefault(String,os.j.listLevelText,null),a.getValueWithDefault(String,is.b.font,null),h=n.listInfo.get_listStyle()+"",c=(s="NumberingStyleDocumentNumbering_").length,d=parseInt(l.substr(c)),i=u.get_listMarkersInDocumentDictionary()}var _=M_.p.getKeys(i),m=_.length;if(m>0&&d>=m&&(d-=parseInt(_[0])),d<m){var f=i[_[d]];if(f){var y=f.get_levelText(),C=f.get_listStyle()+"";if(p&&y&&(p=nC.generalizeLevelText(p))===(y=nC.generalizeLevelText(y))&&h&&C&&h===C)return void t.SetGalleryButtonLookAndRtl(e,!0,n)}}t.SetGalleryButtonLookAndRtl(e,!1,n)}else e[to.u.On]=!1},t.PropertySetForNumbering=function(e,t,n){t.val=!e.listInfo;var i=t.val?null:e.listInfo.get_propertySet();return i&&(t.val=!i.hasProperty(os.j.listLevelText),e.listInfo.get_listType()&&(n.val=!0)),i},t.SetGalleryButtonLookAndRtl=function(e,t,n){e[to.u.On]=t,e[to.u.IsRtl]=n.isRtl?2:1},t.applySpinnerQueryResult=function(e,n){var i=e.originalActionId,r=e.actionData,o=!0;switch(i){case Oi.u.queryImageResize:var a=e.actionData.getValueWithDefault(Number,Pl.k.imageScale,-1);n[So.Number]=a,n[So.UnitType]=6;break;case Oi.u.queryImageAbsoluteHeight:var l=yi.App.get_localeMeasurementUnits(),s=e.actionData.getValueWithDefault(Number,Pl.k.imageAbsoluteHeight,0),u=Vu.r.muToInches(s)*Vu.r.twipsPerInch,c=Vu.r.valueFromTwipsAndUnits(u,l);n[So.Number]=c,n[So.UnitType]=l;break;case Oi.u.queryImageAbsoluteWidth:l=yi.App.get_localeMeasurementUnits();var d=e.actionData.getValueWithDefault(Number,Pl.k.imageAbsoluteWidth,0),g=(u=Vu.r.muToInches(d)*Vu.r.twipsPerInch,Vu.r.valueFromTwipsAndUnits(u,l));n[So.Number]=g,n[So.UnitType]=l;break;case Oi.u.queryIndentBefore:case Oi.u.queryIndentAfter:var p=r.indentInfo;l=yi.App.get_localeMeasurementUnits();if(p){t.RegisterLayoutTabUpdateActionsForTextDirectionChange(r.isRtl,n);var h=i===Oi.u.queryIndentBefore?p.indentLeftValue:p.indentRightValue,_=i===Oi.u.queryIndentBefore?p.indentLeftMax:p.indentRightMax;if(2!==l&&(_=Vu.r.valueFromTwipsAndUnits(_,l)),n[So.MaxValue]=_,h!==Number.MAX_VALUE){var m=i===Oi.u.queryIndentBefore?p.indentLeftUnit:p.indentRightUnit;if(i===Oi.u.queryIndentBefore&&2===p.specialIndentType)if(2===m)h-=np.j.twipsToChars(p.specialIndentValueTwips);else h-=p.specialIndentValueTwips;h?2===m?l=2:h=Vu.r.valueFromTwipsAndUnits(h,l):yi.App.get_isEastAsian()&&(l=2),n[So.Number]=h}else n[So.Text]="",n[So.Number]=Number.NaN,yi.App.get_isEastAsian()&&(l=2);n[So.UnitType]=l;var f=void 0,y=void 0;L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactMultilineRibbonEnabled()&&Ln.AppChromeUtils.selectorExists("getRibbonMode")&&"Multiline"===appChrome.selectors.getRibbonMode()?(f=i===Oi.u.queryIndentBefore?WoncaIntl.WoncaStrings.L_LabelIndentBeforeLtr:WoncaIntl.WoncaStrings.L_LabelIndentAfterLtr,y=i===Oi.u.queryIndentBefore?WoncaIntl.WoncaStrings.L_LabelIndentBeforeRtl:WoncaIntl.WoncaStrings.L_LabelIndentAfterRtl):(f=i===Oi.u.queryIndentBefore?WoncaIntl.WoncaStrings.L_SpinnerIndentBeforeLtr:WoncaIntl.WoncaStrings.L_SpinnerIndentAfterLtr,y=i===Oi.u.queryIndentBefore?WoncaIntl.WoncaStrings.L_SpinnerIndentBeforeRtl:WoncaIntl.WoncaStrings.L_SpinnerIndentAfterRtl);var C=r.isRtl?y:f;n[So.Alt]=C}break;case Oi.u.querySpacingBefore:case Oi.u.querySpacingAfter:var S=r.spacing;if(S){var b=i===Oi.u.querySpacingBefore?S.beforeSpacing.value:S.afterSpacing.value;if(-1!==b){var v=i===Oi.u.querySpacingBefore?S.beforeSpacing.unit:S.afterSpacing.unit;if(1===v)n[So.Text]=Box4Intl.Box4Strings.L_SpinnerAuto,n[So.Number]=Number.NaN,n[So.UnitType]=5;else{l=2===v?4:5;n[So.Number]=b,n[So.UnitType]=l}}else n[So.Text]="",n[So.Number]=Number.NaN,n[So.UnitType]=yi.App.get_isEastAsian()?4:5}break;case Oi.u.queryImageAngle:var T=e.actionData.getValueWithDefault(Number,Pl.k.imageRotateAngle,0);n[So.Number]=T,n[So.UnitType]=9;break;default:o=!1}return o},t.asyncActionExecuteBridge=function(e,n,i){var r=new bc,o=!!t.appSettingsManager&&(W.y.get_isFirefox()&&t.appSettingsManager.getBooleanAppSetting("UseSyncCopyCutCommandOnFirefoxIsEnabled")||W.y.get_isInternetExplorerEdge()&&t.appSettingsManager.getBooleanAppSetting("UseSyncCopyCutCommandOnEdgeIsEnabled")),a=e===Oi.u.cut||e===Oi.u.copy;return r.executeAsync=!(o&&a),r},t.UpdateMultilevelListActionProperties=function(e,n,i){var r=t.GetListStyleIdFromControlId(i);e.setValue(Pl.k.listStyleId,r),bI.h.setListMultiLevelTypeToListDef(1,e)},t.MultilevelExecuteBridge=function(e,n,i){var r=new bc;r.actionData=new Dl.DictionaryPropertySet;var o=n.MenuItemId||n.SourceControlId;return t.UpdateMultilevelListActionProperties(r.actionData,Oi.u.multilevelList,o),r},t.BulletsExecuteBridge=function(e,n,i){var r=new bc;r.actionData=new Dl.DictionaryPropertySet;var o=n.MenuItemId||n.SourceControlId;return L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&(o=n.CommandValueId||n.SourceControlId),t.UpdateListActionProperties(r.actionData,Oi.u.toggleBulletsList,o),r},t.UpdateListActionProperties=function(e,n,i){t.get_ListReader().get_listSymbolsImprovementsEnabled()?t.UpdateListActionPropertiesFromControlId(e,n,i):t.UpdateListActionStyleAndTypeFromControlId(e,n,i)},t.UpdateListActionPropertiesFromControlId=function(e,n,i){var r=14;n===Oi.u.toggleBulletsList?r=1:n===Oi.u.toggleNumberedList&&(r=0);var o=t.GetListStyleIdFromControlId(i);e.setValue(Pl.k.listStyleId,o),e.setValue(Pl.k.listSoftType,r),bI.h.setListMultiLevelTypeToListDef(2,e)},t.GetListStyleIdFromControlId=function(e){if(!e)return-1;var t=e.split("_");return 2===t.length?parseInt(t[1]):-2},t.UpdateListActionStyleAndTypeFromControlId=function(e,t,n){var i=14,r=0;if(t===Oi.u.toggleBulletsList)switch(n){case"buttonBulletStyle1":i=1,r=1;break;case"buttonBulletStyle2":i=1,r=2;break;case"buttonBulletStyle3":i=1,r=3;break;default:i=1,r=0}else if(t===Oi.u.toggleNumberedList)switch(n){case"buttonNumberStyleDefault":i=0,r=0;break;case"buttonNumberStyle1":i=0,r=1;break;case"buttonNumberStyle2":i=0,r=2;break;case"buttonNumberStyle3":i=0,r=3;break;case"buttonNumberStyle4":i=0,r=4;break;case"buttonNumberStyle5":i=0,r=5;break;default:i=0,r=0}e.setValue(Pl.k.listSoftType,i),e.setValue(Pl.k.listSoftStyle,r)},t.fontColorExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=t.Color,i.executeAsync=!0,i},t.FormattingExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=new xc.b(2),i},t.GenericSpinnerQueryExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=new Dl.DictionaryPropertySet,i.isQuerySpinnerCommand=!0,i},t.GenericTextBoxQueryExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=new Dl.DictionaryPropertySet,i.isQueryCommand=!0,i},t.ImageResizeExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=new Dl.DictionaryPropertySet,i.actionData.setValue(Pl.k.imageScale,t[So.Number]),i},t.ImageAbsoluteHeightExecuteBridge=function(e,t,n){var i=new bc;i.actionData=new Dl.DictionaryPropertySet;var r=t[So.Number],o=0;switch(t[So.UnitType]){case 7:var a=np.j.pixelsToInches(r,1);o=Vu.r.inchesToMu(a);break;case 3:o=Vu.r.inchesToMu(r);break;case 1:o=Vu.r.centimetersToMu(r)}return i.actionData.setValue(Pl.k.imageAbsoluteHeight,o),i},t.ImageAbsoluteWidthExecuteBridge=function(e,t,n){var i=new bc;i.actionData=new Dl.DictionaryPropertySet;var r=t[So.Number],o=0;switch(t[So.UnitType]){case 7:var a=np.j.pixelsToInches(r,0);o=Vu.r.inchesToMu(a);break;case 3:o=Vu.r.inchesToMu(r);break;case 1:o=Vu.r.centimetersToMu(r)}return i.actionData.setValue(Pl.k.imageAbsoluteWidth,o),i},t.ImageAltTextTitleExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=new Dl.DictionaryPropertySet,i.actionData.setValue(Pl.k.imageAltTextTitle,t[xo.Text]),i},t.ImageAltTextDescriptionExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=new Dl.DictionaryPropertySet,i.actionData.setValue(Pl.k.imageAltTextDescription,t[xo.Text]),i},t.ImageLockAspectRatioExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=new Dl.DictionaryPropertySet,i.actionData.setValue(Pl.k.imageLockAspectRatio,t[gr.e.On]),i},t.InsertTableExecuteBridge=function(e,t,n){var i=new bc,r=new Ac.v;return r.rows=t[ro.Rows],r.columns=t[ro.Columns],i.actionData=r,i},t.LineSpacingExecuteBridge=function(e,n,i){var r=new bc,o=n.MenuItemId;return r.actionData=t.GetLineSpacingMenuValue(o),r},t.NumberingExecuteBridge=function(e,n,i){var r=new bc;r.actionData=new Dl.DictionaryPropertySet;var o=n.MenuItemId||n.SourceControlId;return t.UpdateListActionProperties(r.actionData,Oi.u.toggleNumberedList,o),r},t.OrientationExecuteBridge=function(e,t,n){var i=!1;switch(t.MenuItemId){case"buttonOrientationPortrait":i=!1;break;case"buttonOrientationLandscape":i=!0}var r=new bc;return r.actionData=i,r},t.ParaIndentExecuteBridge=function(e,t,n){var i=new bc,r=t[So.Number],o=t[So.UnitType],a=new TI.b;return 2===o?(a.value=r,a.unit=2):(a.value=Vu.r.twipsFromValueAndUnits(r,o),a.unit=1),i.actionData=a,i},t.ParaSpacingExecuteBridge=function(e,t,n){var i=new bc,r=t[So.Text],o=t[So.Number],a=t[So.UnitType],l=new AI;return r===Box4Intl.Box4Strings.L_SpinnerAuto?(l.value=0,l.unit=1):(l.value=o,l.unit=4===a?2:4),i.actionData=l,i},t.SetPictureStyleExecuteBridge=function(e,n,i){var r=new bc,o=n.SourceControlId;return r.actionData=L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&mc.locationIsRibbon(i.CommandLocation)?t.GetPictureStyleNumberId(o):o,r},t.GetPictureStyleNumberId=function(e){switch(e){case"PictureStyleSimpleFrameWhite":return"15505";case"PictureStyleBeveledMatte":return"15506";case"PictureStyleMetalFrame":return"15507";case"PictureStyleDropShadow":return"15508";case"PictureStyleReflectedRounded":return"15509";case"PictureStyleSoftEdge":return"15510";case"PictureStyleDoubleFrame":return"15511";case"PictureStyleThickMatte":return"15512";case"PictureStyleSimpleFrameBlack":return"15513";case"PictureStyleBeveledOval":return"15514";case"PictureStyleCompoundFrame":return"15515";case"PictureStyleModerateFrameBlack":return"15516";case"PictureStyleCenterShadow":return"15517";case"PictureStyleRoundedDiagonalCorner":return"15518";case"PictureStyleSnipDiagonalCorner":return"15519";case"PictureStyleModerateFrameWhite":return"15520";case"PictureStyleRotatedWhite":return"15521";case"PictureStylePerspectiveShadow":return"15522";case"PictureStyleRelaxedPerspective":return"15523";case"PictureStyleSoftEdgeOval":return"15524";case"PictureStyleBevelRectangle":return"15525";case"PictureStyleBevelPerspective":return"15526";case"PictureStyleReflectedPerspective":return"15527";case"PictureStyleBevelPerspectiveLeft":return"15528";case"PictureStyleReflectedBevelBlack":return"15529";case"PictureStyleReflectedBevelWhite":return"15530";case"PictureStyleMetalRounded":return"15531";case"PictureStyleMetalOval":return"15532"}return null},t.RemapToQuerySectionPropertiesEnabledBridge=function(e){var t=new Sc;return t.actionToRun=Oi.u.querySectionProperties,t},t.GetListToggleState=function(e,t){return!(null==e)&&e.get_listType()===t},t.GetListStyleToggleState=function(e,t,n){return!(null==e)&&e.get_listType()===t&&e.get_listStyle()===n},t.GetLineSpacingMenuValue=function(e){return parseFloat(e)},t.ShouldHighlightLineSpacing=function(e,n){if(!n.spacing)return!1;if(2!==n.spacing.lineSpacing.unit)return!1;var i=t.GetLineSpacingMenuValue(e);return as.s.isEqualish(n.spacing.lineSpacing.value,i)},t.appSettingsManager=null,t._isHighlightStyleWhenDifferentFromSelectionEnabled=null,t}(Ec);(0,o.l)(II,"25962183$CuiActionBridge",Ec,[]);var wI=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.initialize=function(){e.prototype.initialize.call(this),this.executeFunctions.set_item(nS.u.insertNoteTag,t.NoteTagInsertExecuteBridge),this.executeFunctions.set_item(Oi.u.changeSectionColor,t.ChangeSectionColorExecute),this.executeFunctions.set_item(Oi.u.populateOutlineContextMenu,Ec.inputMethodExecuteBridge),this.executeFunctions.set_item(nS.u.queryEditOnWebVisibility,Ec.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(nS.u.queryOpenInOneNoteVisibility,Ec.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(nS.u.queryMathMode,Ec.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(nS.u.queryMathSwitch,Ec.queryDictionaryPropertySetExecuteBridge)},t.prototype.getCuiUserHooks=function(){var e=new SI;return e.applyQueryResult=t.applyQueryResult,e.applySpinnerQueryResult=II.applySpinnerQueryResult,e.preExecCommand=null,e.postExecCommand=null,e},t.applyQueryResult=function(e,t){var n=!0;switch(e.originalActionId){default:n=II.applyQueryResult(e,t);break;case nS.u.queryEditOnWebVisibility:!Ti.App.get_isOneNoteEmbedded()&&yi.App.get_activeAppFrame().workspace.get_isFileAccessStatusKnown()&&(t[Zr.g.Visible]=yi.App.get_activeAppFrame().workspace.get_isEditingPermissible());break;case nS.u.queryOpenInOneNoteVisibility:if(!Ti.App.get_isOneNoteEmbedded()){var i=!1;L.AFrameworkApplication.limitedEdit?i=!1:yi.App.get_activeAppFrame().workspace.get_isFileAccessStatusKnown()&&(i=!yi.App.get_activeAppFrame().workspace.get_isEditingPermissible()),t[dr.f.Visible]=i}break;case nS.u.queryMathMode:var r=!1;(Ti.App.get_instance().educationUserInfo.retrieved&&(Ti.App.get_instance().educationUserInfo.isO365Subscriber||Ti.App.get_instance().educationUserInfo.isEducation)||L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteMathEducationDogfood"))&&(r=!0),Ti.App.get_instance().educationUserInfo.retrieved&&Ti.App.get_instance().educationUserInfo.isTeacher&&Ti.App.get_instance().notebookType&&Ti.App.get_instance().notebookType.retrieved&&Ti.App.get_instance().notebookType.isEduNotebook&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteMathEducationSwitchEnabled")&&(r=!1),t[dr.f.Visible]=r;break;case nS.u.queryMathSwitch:var o=!1;(Ti.App.get_instance().educationUserInfo.retrieved&&Ti.App.get_instance().educationUserInfo.isTeacher&&Ti.App.get_instance().notebookType&&Ti.App.get_instance().notebookType.retrieved&&Ti.App.get_instance().notebookType.isEduNotebook&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteMathEducationSwitchEnabled")||L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteMathEducationSwitchOverride"))&&(o=!0),t[To.z.Visible]=o}return n},t.NoteTagInsertExecuteBridge=function(e,t,n){var i=new bc;return i.actionData=new Dl.DictionaryPropertySet,i.actionData.setValue(Pl.k.controlId,t.SourceControlId),i},t.ChangeSectionColorExecute=function(e,t,n){var i=new bc;return i.actionData=t.MenuItemId,i},t}(II);(0,o.l)(wI,"448486a3$CuiActionBridge",II,[]);var xI=n(5897),EI=(0,o.y)("ca07c759$IDialogViewElement"),FI=n(9226),PI=n(6504),DI=function(e){function t(t,n,i,r,o){var a=this;return a._clickHandlerCallback=null,a=e.call(this,t,n,i,r,o)||this}return(0,v.t)(t,e),t.prototype.onClick=function(e){var t=this;if(this._isLoading)return!0;var n=(0,y.e)(wi.n,this.get_source());if(!n)return!1;if(this.get_isExpanded())this.set_isExpanded(!1),this.SetChildrenVisibility(!1);else if(n.get_isContentPresent()){this.set_isExpanded(!0),this._sectionListUl.childNodes.length?this.SetChildrenVisibility(!0):this._clickHandlerCallback&&this._clickHandlerCallback(this.get_sourceNode(),this._sectionListUl)}else{this.setIsLoading(!0);var i=WS.c.get_instance().createGraphSpaceRootReplicator(n,"DialogSectionGroupLoad");i.forceInbound((function(e){t.set_isExpanded(!0),t.setIsLoading(!1),t._clickHandlerCallback&&t._clickHandlerCallback(t.get_sourceNode(),t._sectionListUl)}),null,null),i.set_shouldUpdateWorkspaceActivePageAfterReplication(!1)}return!0},t.prototype.attachClickEventHandler=function(e){this._clickHandlerCallback=e},t.prototype.SetChildrenVisibility=function(e){for(var t=0;t<this._sectionListUl.childNodes.length;t++)this._sectionListUl.childNodes[t].style.display=e?"":"none"},t.prototype.addNavTab=function(e){var n=this.get_htmlViewInstance().createElement("div");n.className="NavSectionGroupTab",n.style.width=t.NavSectionGroupTabWidth+"px",e.appendChild(n);var i=this.get_htmlViewInstance().createElement("div");i.className="NavSectionGroupChevronTab",Sys.UI.DomElement.addCssClass(i,"SectionPickerDialogGroupChevronTab"),n.appendChild(i);var r=document.createElement("div");r.className="DialogNavTab",r.style.width=t.DialogNavTabWidth+"px",n.appendChild(r),this.AddIconDiv(r,"DialogSectionGroupSkewLeft",t.BackIconLeft,t.BackIconMarginTop,!1),this.AddIconDiv(r,"DialogSectionGroupSkewRight",t.BackIconRight,t.BackIconMarginTop,!1),this.AddIconDiv(r,"DialogSectionGroupSkewLeft",t.FrontIconLeft,t.FrontIconMarginTop,!0),this.AddIconDiv(r,"DialogSectionGroupSkewRight",t.FrontIconRight,t.FrontIconMarginTop,!0)},t.prototype.AddIconDiv=function(e,n,i,r,o){var a=document.createElement("div");a.className=n,a.style.left=i+"px",a.style.marginTop=r+"px",a.className+=" "+t.SectionGroupIconColor,o&&(a.style.borderTop=t.SolidWhiteBorder,"DialogSkewLeft"===n?a.style.borderRight=t.SolidWhiteBorder:a.style.borderLeft=t.SolidWhiteBorder),e.appendChild(a)},t.createDialogGroupNavInstance=function(e,n){return t.createAnInstanceWithResolvedDependencies(e,n)},t.createAnInstanceWithResolvedDependencies=function(e,n){return new t(e,n,Xt.s.get_instance(),Me.KeyInputManager.get_instance(),(function(){return Ge.w.get_instance().tryResolve(xI.q)}))},t.SolidWhiteBorder="1px solid white",t.SectionGroupIconColor="DialogSectionColorUnknown",t.NavSectionGroupTabWidth=49,t.DialogNavTabWidth=25,t.BackIconMarginTop=10,t.BackIconLeft=9,t.BackIconRight=4,t.FrontIconMarginTop=14,t.FrontIconLeft=11,t.FrontIconRight=6,t}(PI.MultiColumnSectionGroupNavViewElement);(0,o.l)(DI,"da7641bd$DialogSectionGroupNavViewElement",PI.MultiColumnSectionGroupNavViewElement,[EI,jm.e,FI.b,Sys.IDisposable]);var RI=n(8646),MI=function(e){function t(t,n,i,r,o){var a=this;return a._clickHandlerCallback=null,a=e.call(this,t,n,i,r,o)||this}return(0,v.t)(t,e),t.prototype.get_sectionColorCssClass=function(){return null},t.prototype.addNavTab=function(){var e=document.createElement("div");e.className="DialogNavTab",this.AddIconDiv(e,"DialogSectionSkewLeft"),this.AddIconDiv(e,"DialogSectionSkewRight"),this.sectionHeader.appendChild(e)},t.prototype.AddIconDiv=function(e,n){var i=document.createElement("div");i.className=n,i.className+=" "+t.CssDialogColorPrefix+ff.o.sectionBGRValueToCssClass(this.currentSectionColor),e.appendChild(i)},t.prototype.attachClickEventHandler=function(e){this._clickHandlerCallback=e},t.prototype.onHeaderClick=function(e){return this._clickHandlerCallback&&this._clickHandlerCallback(this.get_sourceNode(),this.get_sectionHeaderContent()),!0},t.prototype.contextMenuHandler=function(e){return!0},t.createDialogSectionNavInstance=function(e,n,i){return t.createAnInstanceWithResolvedDependencies(e,n,i)},t.createAnInstanceWithResolvedDependencies=function(e,n,i){return new t(e,n,i,(function(){return Ge.w.get_instance().tryResolve(xI.q)}),(function(){return Ge.w.get_instance().resolve(wa.n)}))},t.CssDialogColorPrefix="Dialog",t}(RI.q);(0,o.l)(MI,"a6b4de42$DialogSectionNavViewElement",RI.q,[EI,jm.e,FI.b,Sys.IDisposable]);var kI=n(1155),NI=(0,o.y)("6dc065ac$IIndentationCommands"),LI=(0,o.y)("ecd1444d$IJustificationCommands"),BI=function(){return function(){this.ParaSpacingBeforeHandled=!1,this.ParaSpacingAfterHandled=!1,this.ParaIndentLeftHandled=!1,this.ParaIndentRightHandled=!1,this.SpecialParaIndentHandled=!1}}();(0,o.l)(BI,"ed9f6bd6$Box4PropertySetChangedState",null,[]);var OI=function(){function e(){}return e.get_IndentationCommands=function(){return e._indentationCommands||(e._indentationCommands=Ge.w.get_instance().tryResolve(NI))},e.get_JustificationCommands=function(){return e._justificationCommands||(e._justificationCommands=Ge.w.get_instance().tryResolve(LI))},e.get_SpacingCommands=function(){return e._spacingCommands||(e._spacingCommands=Ge.w.get_instance().tryResolve(Qc))},e.justificationChangedHandler=function(t,n,i,r){if(e.get_JustificationCommands()&&i){var o=i;if(null!==n&&11===o){if(10===n||9===n)return}e.get_JustificationCommands().setJustification(o)}},e.lineSpacingChangedHandler=function(t,n,i,r){e.get_SpacingCommands()&&i&&e.get_SpacingCommands().setLineSpacing(i)},e.paraSpacingBeforeChangedHandler=function(t,n,i,r){if(e.get_SpacingCommands()&&null!=i){var o=e.GetBox4PropertySetChangedState(r);if(!o.ParaSpacingBeforeHandled){if(!r.finalPropertySet.hasProperty(Pl.k.paraSpacingBeforeUnit)||!r.finalPropertySet.hasProperty(Pl.k.paraSpacingBeforeValue))return;var a=r.finalPropertySet.getValue(Number,Pl.k.paraSpacingBeforeValue),l=r.finalPropertySet.getValue(Number,Pl.k.paraSpacingBeforeUnit);o.ParaSpacingBeforeHandled=!0,e.get_SpacingCommands().setParagraphSpacing(1,a,l)}}},e.paraSpacingAfterChangedHandler=function(t,n,i,r){if(e.get_SpacingCommands()&&null!=i){var o=e.GetBox4PropertySetChangedState(r);if(!o.ParaSpacingAfterHandled){if(!r.finalPropertySet.hasProperty(Pl.k.paraSpacingAfterUnit)||!r.finalPropertySet.hasProperty(Pl.k.paraSpacingAfterValue))return;var a=r.finalPropertySet.getValue(Number,Pl.k.paraSpacingAfterValue),l=r.finalPropertySet.getValue(Number,Pl.k.paraSpacingAfterUnit);o.ParaSpacingBeforeHandled=!0,e.get_SpacingCommands().setParagraphSpacing(0,a,l)}}},e.paraIndentLeftChangedHandler=function(t,n,i,r){if(e.get_IndentationCommands()&&null!=i){var o=e.GetBox4PropertySetChangedState(r);if(!o.ParaIndentLeftHandled){if(!r.finalPropertySet.hasProperty(Pl.k.paraIndentLeftUnit)||!r.finalPropertySet.hasProperty(Pl.k.paraIndentLeftValue))return;var a=r.finalPropertySet.getValue(Number,Pl.k.paraIndentLeftValue),l=r.finalPropertySet.getValue(Number,Pl.k.paraIndentLeftUnit);o.ParaIndentLeftHandled=!0,e.get_IndentationCommands().setParagraphIndent(1,a,l)}}},e.paraIndentRightChangedHandler=function(t,n,i,r){if(e.get_IndentationCommands()&&null!=i){var o=e.GetBox4PropertySetChangedState(r);if(!o.ParaIndentRightHandled){if(!r.finalPropertySet.hasProperty(Pl.k.paraIndentRightUnit)||!r.finalPropertySet.hasProperty(Pl.k.paraIndentRightValue))return;var a=r.finalPropertySet.getValue(Number,Pl.k.paraIndentRightValue),l=r.finalPropertySet.getValue(Number,Pl.k.paraIndentRightUnit);o.ParaIndentRightHandled=!0,e.get_IndentationCommands().setParagraphIndent(0,a,l)}}},e.specialIndentChangeHandler=function(t,n,i,r){if(e.get_IndentationCommands()&&null!=i){var o=e.GetBox4PropertySetChangedState(r);if(!o.SpecialParaIndentHandled){if(!r.finalPropertySet.hasProperty(Pl.k.specialIndentByUnit)||!r.finalPropertySet.hasProperty(Pl.k.specialIndentByValue))return;var a=0;r.finalPropertySet.hasProperty(Pl.k.specialIndent)&&(a=r.finalPropertySet.getValue(Number,Pl.k.specialIndent));var l=r.finalPropertySet.getValue(Number,Pl.k.specialIndentByValue),s=r.finalPropertySet.getValue(Number,Pl.k.specialIndentByUnit);o.SpecialParaIndentHandled=!0,e.get_IndentationCommands().setSpecialIndent(a,l,s)}}},e.GetBox4PropertySetChangedState=function(e){return e.customData||(e.customData=new BI),e.customData},e._indentationCommands=null,e._justificationCommands=null,e._spacingCommands=null,e}();(0,o.l)(OI,"d4ab84c7$ParagraphLevelPropertyChangedHandlers",null,[]);var UI=function(){function e(e){this._propertyChangedHandlers=null,this._propertyChangedHandlers=e}return e.prototype.ProcessChangedProperty=function(e,t,n,i){var r=this._propertyChangedHandlers[e.id.toString()];r&&r(e,t,n,i)},e}();(0,o.l)(UI,"5e1d3cad$PropertyChangedProcessor",null,[]);var HI=n(7726),GI=function(){return function(e){this.finalPropertySet=null,this.customData=null,this.finalPropertySet=e}}();(0,o.l)(GI,"ae197e2e$PropertySetChangedState",null,[]);var WI=function(){function e(){}return e.processChangedPropertySet=function(e,t,n){if(e&&t){var i=new GI(t),r=function(e,t,r){n.ProcessChangedProperty(e,t,r,i)},o=new HI.l(t,e);o.addedCallback=r,o.changedCallback=r,o.removedCallback=r,o.processChanges()}},e}();(0,o.l)(WI,"9a77980a$PropertySetChangedManager",null,[]);var VI=n(5055),$I=function(){function e(){}return e.processUpdate=function(e,t,n){var i=VI.z.get_instance().get_firstNodeForCurrentSelection();if(i){var r=new Ma.GraphTransaction(15);r.setFromNode(i),WI.processChangedPropertySet(e,t,new UI(n)),r.dispose()}},e}();(0,o.l)($I,"cd2e91cd$PropertySetDialogResultHandler",null,[]);var zI=function(e){function t(n,i,r,o,a,l){var s=this;return s._initialDialogProperties=null,s._liveDialogProperties=null,s._isTouch=!1,s._standaloneRoot=null,s._forceDropDownMultiple=!1,s._disposed=!1,(s=e.call(this)||this).set_dialogId(t.Id),t.spacingCommands=r,s._standaloneRoot=l,s._initialDialogProperties=n.clone(),s._liveDialogProperties=n.clone(),s._isTouch=i,i&&(s._customCssClass=kI.o.touchModeCssClass),s.set_autoSize(!0),s}return(0,v.t)(t,e),t.prototype.onInnerHtmlSet=function(){t.BuildParaSpacingSpinner(t.spinnerSpacingBeforeContainerId,t.spinnerSpacingBeforeControlId,Oi.u.openSpacingBeforeDialog,Oi.u.querySpacingBeforeDialog,Oi.u.spinSpacingBeforeDialog,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,this._standaloneRoot),t.BuildParaSpacingSpinner(t.spinnerSpacingAfterContainerId,t.spinnerSpacingAfterControlId,Oi.u.openSpacingAfterDialog,Oi.u.querySpacingAfterDialog,Oi.u.spinSpacingAfterDialog,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,this._standaloneRoot),t.BuildLineSpacingAtSpinner(t.spinnerLineSpacingAtContainerId,t.spinnerLineSpacingAtControlId,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,this._standaloneRoot),t.BuildLineSpacingDropDown(t.lineSpacingContainerId,t.lineSpacingControlId,this._standaloneRoot)},t.prototype.initializeCuiControls=function(){for(var e=0;e<t.spacingSpinnerCommandIds.length;e++)Fc.attachCommandHandlers(t.spacingSpinnerCommandIds[e],o.i(this,this.setAdvancedControlValue,"setAdvancedControlValue"),o.i(this,this.getAdvancedControlValue,"getAdvancedControlValue"));Fc.attachCommandHandlers(Oi.u.openLineSpacingDialog,o.i(this,this.setDropDownValue,"setDropDownValue"),o.i(this,this.provideDropDownValue,"provideDropDownValue")),Fc.attachCommandHandlers(Oi.u.queryLineSpacingDialog,o.i(this,this.setDropDownValue,"setDropDownValue"),o.i(this,this.provideDropDownValue,"provideDropDownValue")),this._standaloneRoot.pollForStateAndUpdate()},t.prototype.dispose=function(){if(!this._disposed){for(var n=0;n<t.spacingSpinnerCommandIds.length;n++)Fc.detachCommandHandlers(t.spacingSpinnerCommandIds[n]);Fc.detachCommandHandlers(Oi.u.openLineSpacingDialog),Fc.detachCommandHandlers(Oi.u.queryLineSpacingDialog),this._standaloneRoot.removeControl(t.spinnerSpacingBeforeControlId),this._standaloneRoot.removeControl(t.spinnerSpacingAfterControlId),this._standaloneRoot.removeControl(t.spinnerLineSpacingAtControlId),this._standaloneRoot.removeControl(t.lineSpacingControlId),e.prototype.dispose.call(this),this._disposed=!0}},t.prototype.getAdvancedControlValue=function(e,n){switch(e){case Oi.u.querySpacingBeforeDialog:case Oi.u.querySpacingAfterDialog:var i=e===Oi.u.querySpacingBeforeDialog?Pl.k.paraSpacingBeforeValue:Pl.k.paraSpacingAfterValue,r=e===Oi.u.querySpacingBeforeDialog?Pl.k.paraSpacingBeforeUnit:Pl.k.paraSpacingAfterUnit;if(this._liveDialogProperties.hasProperty(i)&&this._liveDialogProperties.hasProperty(r)){var o=this._liveDialogProperties.getValue(Number,r);if(1===o)n[So.Text]=Box4Intl.Box4Strings.L_SpinnerAuto,n[So.Number]=Number.NaN,n[So.UnitType]=5;else{var a=this._liveDialogProperties.getValue(Number,i),l=2===o?4:5;n[So.Number]=a,n[So.UnitType]=l}}else n[So.Text]="",n[So.Number]=Number.NaN,n[So.UnitType]=yi.App.get_isEastAsian()?4:5;break;case Oi.u.queryLineSpacingAtDialog:var s=!1;if(this._liveDialogProperties.hasProperty(Pl.k.lineSpacingValue)&&this._liveDialogProperties.hasProperty(Pl.k.lineSpacingUnit)&&2===this._liveDialogProperties.getValue(Number,Pl.k.lineSpacingUnit)&&(this.IsLineSpacingMultiple()||this._forceDropDownMultiple)){var u=t.get_LineSpacingHelper().getLineSpacing(this._liveDialogProperties);u>=t.minLineSpacingAtValue&&(n[So.Number]=u,s=!0)}s||(n[So.Text]="",n[So.Number]=Number.NaN),n[So.UnitType]=0}},t.prototype.setAdvancedControlValue=function(e,n){var i=n[So.Text],r=n[So.Number],o=n[So.UnitType];switch(e){case Oi.u.openSpacingBeforeDialog:case Oi.u.openSpacingAfterDialog:var a=void 0,l=void 0;i===Box4Intl.Box4Strings.L_SpinnerAuto?(a=0,l=1):(a=r,l=4===o?2:4);var s=e===Oi.u.openSpacingBeforeDialog?Pl.k.paraSpacingBeforeValue:Pl.k.paraSpacingAfterValue,u=e===Oi.u.openSpacingBeforeDialog?Pl.k.paraSpacingBeforeUnit:Pl.k.paraSpacingAfterUnit;this._liveDialogProperties.setValue(s,a),this._liveDialogProperties.setValue(u,l);break;case Oi.u.spinSpacingBeforeDialog:case Oi.u.spinSpacingAfterDialog:s=e===Oi.u.spinSpacingBeforeDialog?Pl.k.paraSpacingBeforeValue:Pl.k.paraSpacingAfterValue,u=e===Oi.u.spinSpacingBeforeDialog?Pl.k.paraSpacingBeforeUnit:Pl.k.paraSpacingAfterUnit;var c=n.Increment;""===i||c&&i===Box4Intl.Box4Strings.L_SpinnerAuto?(this._liveDialogProperties.setValue(s,0),this._liveDialogProperties.setValue(u,4)):r||c||(this._liveDialogProperties.setValue(s,0),this._liveDialogProperties.setValue(u,1));break;case Oi.u.openLineSpacingAtDialog:this.SetLineSpacingAtValue(r);break;case Oi.u.spinLineSpacingAtDialog:""===i&&this.SetLineSpacingAtValue(t.minLineSpacingAtValue)}this._standaloneRoot.pollForStateAndUpdate()},t.prototype.SetLineSpacingAtValue=function(e){this._liveDialogProperties.setValue(Pl.k.lineSpacingUnit,2),this._liveDialogProperties.setValue(Pl.k.lineSpacingValue,t.get_LineSpacingHelper().getLineSpacingValueInPropertyUnit(this._liveDialogProperties,e)),this._forceDropDownMultiple=!0,this._standaloneRoot.pollForControlState(t.lineSpacingControlId)},t.prototype.provideDropDownValue=function(e,t){switch(e){case Oi.u.queryLineSpacingDialog:this.ProvideLineSpacingDropDownValue(t)}},t.prototype.ProvideLineSpacingDropDownValue=function(e){var n=0,i=!1;(this._liveDialogProperties.hasProperty(Pl.k.lineSpacingValue)&&this._liveDialogProperties.hasProperty(Pl.k.lineSpacingUnit)||(i=!0),i)||(2!==this._liveDialogProperties.getValue(Number,Pl.k.lineSpacingUnit)&&(i=!0),(n=t.get_LineSpacingHelper().getLineSpacing(this._liveDialogProperties))<t.minLineSpacingAtValue&&(i=!0));if(!i){var r=t.lineSpacingMultipleMenuItemId;this._forceDropDownMultiple||this.IsLineSpacingMultiple()||(as.s.isEqualish(n,1)?r="1.00":as.s.isEqualish(n,1.5)?r="1.50":as.s.isEqualish(n,2)&&(r="2.00")),e[Kr.v.SelectedItemId]=r}},t.prototype.setDropDownValue=function(e,t){switch(e){case Oi.u.openLineSpacingDialog:this.SetDialogPropertiesFromLineSpacingDropDown(t)}},t.prototype.SetDialogPropertiesFromLineSpacingDropDown=function(e){var n=e.MenuItemId;if(n===t.lineSpacingMultipleMenuItemId)this._liveDialogProperties.setValue(Pl.k.lineSpacingUnit,2),this._liveDialogProperties.setValue(Pl.k.lineSpacingValue,t.get_LineSpacingHelper().getLineSpacingValueInPropertyUnit(this._liveDialogProperties,3));else{var i=parseFloat(n);this._liveDialogProperties.setValue(Pl.k.lineSpacingUnit,2),this._liveDialogProperties.setValue(Pl.k.lineSpacingValue,t.get_LineSpacingHelper().getLineSpacingValueInPropertyUnit(this._liveDialogProperties,i))}this._forceDropDownMultiple=!1,this._standaloneRoot.pollForControlState(t.lineSpacingControlId),this._standaloneRoot.pollForControlState(t.spinnerLineSpacingAtControlId)},t.prototype.paragraphDialogResultHandler=function(e,n){1===e&&$I.processUpdate(this._initialDialogProperties,this._liveDialogProperties,t.getPropertyChangedHandlers()),this.dispose()},t.prototype.paragraphDialogCreator=function(e,t){Ge.w.get_instance().resolve(tI).createParagraphDialog(this._initialDialogProperties,null,this._isTouch)},t.prototype.IsLineSpacingMultiple=function(){if(!this._liveDialogProperties.hasProperty(Pl.k.lineSpacingValue)||!this._liveDialogProperties.hasProperty(Pl.k.lineSpacingUnit))return!1;if(2!==this._liveDialogProperties.getValue(Number,Pl.k.lineSpacingUnit))return!1;var e=t.get_LineSpacingHelper().getLineSpacing(this._liveDialogProperties);return!as.s.isEqualish(e,1)&&!as.s.isEqualish(e,1.5)&&!as.s.isEqualish(e,2)},t.get_LineSpacingHelper=function(){return t._lineSpacingHelper||(t._lineSpacingHelper=Ge.w.get_instance().resolve(kf.r))},t.getPropertyChangedHandlers=function(){return t._propertyChangedHandlers||(t._propertyChangedHandlers=t.CreatePropertyChangedHandlers())},t.CreatePropertyChangedHandlers=function(){var e={};return e[Pl.k.lineSpacingValue.id.toString()]=OI.lineSpacingChangedHandler,e[Pl.k.paraSpacingAfterValue.id.toString()]=OI.paraSpacingAfterChangedHandler,e[Pl.k.paraSpacingAfterUnit.id.toString()]=OI.paraSpacingAfterChangedHandler,e[Pl.k.paraSpacingBeforeValue.id.toString()]=OI.paraSpacingBeforeChangedHandler,e[Pl.k.paraSpacingBeforeUnit.id.toString()]=OI.paraSpacingBeforeChangedHandler,e},t.BuildParaSpacingSpinner=function(e,n,i,r,o,a,l){var s=t.BuildParaSpacingSpinnerXml(n,i,r,o,a);t.attachCuiControl(s,e,n,l)},t.BuildLineSpacingAtSpinner=function(e,n,i,r){var o=t.BuildLineSpacingAtSpinnerXml(n,i);t.attachCuiControl(o,e,n,r)},t.BuildLineSpacingDropDown=function(e,n,i){var r=t.BuildLineSpacingDropDownXml(n);t.attachCuiControl(r,e,n,i)},t.attachCuiControl=function(e,t,n,i){var r=document.getElementById(t);i.addControl(n,e);var o=i.getDOMElementForControlDisplayMode(n,"Medium");r.appendChild(o)},t.BuildParaSpacingSpinnerXml=function(e,n,i,r,o){return Yu.s.buildSpinnerXml(e,n,i,o,[t.BuildSpacingUnitPtXml(),t.BuildSpacingUnitLineXml()],[Box4Intl.Box4Strings.L_SpinnerAuto],r,t.spinnerWidthPx)},t.BuildLineSpacingAtSpinnerXml=function(e,n){return Yu.s.buildSpinnerXml(e,Oi.u.openLineSpacingAtDialog,Oi.u.queryLineSpacingAtDialog,n,[t.BuildLineSpacingAtUnitXml()],null,Oi.u.spinLineSpacingAtDialog,t.spinnerWidthPx)},t.BuildLineSpacingAtUnitXml=function(){return Yu.s.buildUnitXml("none","1","132",".5")},t.BuildSpacingUnitPtXml=function(){return Yu.s.buildUnitXml("point","0","1584","1")},t.BuildSpacingUnitLineXml=function(){return Yu.s.buildUnitXml("line","0","327","1")},t.BuildLineSpacingDropDownXml=function(e){var n=Yu.s.buildDropdownItemXml("DdlLineSpacing_Single","1.00","4294634675",Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle),i=Yu.s.buildDropdownItemXml("DdlLineSpacing_1.5","1.50","4294634675",Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf),r=Yu.s.buildDropdownItemXml("DdlLineSpacing_Double","2.00","4294634675",Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble),o=Yu.s.buildDropdownItemXml("DdlLineSpacing_Multiple",t.lineSpacingMultipleMenuItemId,"4294634675",Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple);return Yu.s.buildSimpleDropDownXml(e,Oi.u.openLineSpacingDialog,Oi.u.queryLineSpacingDialog,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,t.lineSpacingDropDownWidthPx,[n,i,r,o])},t.Id="ParagraphDialog",t.lineSpacingDropDownWidthPx=150,t.spinnerWidthPx=70,t.minLineSpacingAtValue=1,t.spinnerSpacingBeforeControlId="DialogSpacingBeforeSpinner",t.spinnerSpacingAfterControlId="DialogSpacingAfterSpinner",t.spinnerLineSpacingAtControlId="DialogLineSpacingAtSpinner",t.spinnerSpacingBeforeContainerId="ParagraphDialogSpacingBeforeSpinnerContainer",t.spinnerSpacingAfterContainerId="ParagraphDialogSpacingAfterSpinnerContainer",t.spinnerLineSpacingAtContainerId="ParagraphDialogLineSpacingAtSpinnerContainer",t.lineSpacingContainerId="ParagraphDialogLineSpacingContainer",t.lineSpacingControlId="ParagraphDialogLineSpacingSelect",t.lineSpacingMultipleMenuItemId="multiple",t.spacingSpinnerCommandIds=[Oi.u.openSpacingBeforeDialog,Oi.u.openSpacingAfterDialog,Oi.u.openLineSpacingAtDialog,Oi.u.querySpacingBeforeDialog,Oi.u.querySpacingAfterDialog,Oi.u.queryLineSpacingAtDialog,Oi.u.spinLineSpacingAtDialog,Oi.u.spinSpacingAfterDialog,Oi.u.spinSpacingBeforeDialog],t.spacingCommands=null,t._lineSpacingHelper=null,t._propertyChangedHandlers=null,t}(Bi.o);(0,o.l)(zI,"54930bf7$ParagraphDialog",Bi.o,[]);var KI=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt)},e.DialogHtmlFormat="<div class='WACDialogGroupBox' id='SpacingLabelBox'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr> <td> <label id='ParagraphDialogSpacingBefore' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingBeforeSpinnerContainer' >{0}</label> </td> <td> <div id='ParagraphDialogSpacingBeforeSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingBefore' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpacingAfter' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingAfterSpinnerContainer' >{1}</label> </td> <td> <div id='ParagraphDialogSpacingAfterSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingAfter' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacing' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingContainer' >{2}</label> </td> <td> <div id='ParagraphDialogLineSpacingContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacing' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacingAt' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingAtSpinnerContainer' >{3}</label> </td> <td> <div id='ParagraphDialogLineSpacingAtSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacingAt' role='presentation'></div> </td> </tr> </table> </div>",e}();(0,o.l)(KI,"1d6c4d60$ParagraphDialogHtml",null,[]);var qI=function(e){function t(t,n,i,r,a,l){var s=e.call(this,t,n,i,r,a,l)||this;s.set_dialogHtml(KI.get_dialogHtml()),s.initializeAndShow(Box4Intl.Box4Strings.L_ParagraphSpacing,o.i(s,s.paragraphDialogResultHandler,"paragraphDialogResultHandler"),null),s.initializeCuiControls();var u=document.getElementById(zI.spinnerSpacingBeforeControlId);return s.setFocusOnElement(u),s}return(0,v.t)(t,e),t}(zI);(0,o.l)(qI,"61a37b2f$ParagraphDialog",zI,[]);var jI=n(2625),QI=n(2976),JI=function(){function e(){}return e.dialogHtml=function(t){return Bi.o.formatHtml(e.DialogHtmlFormat,t)},e.DialogHtmlFormat="<div class='WACDialogRow' id='IntroBlock'> <label id='IntroLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACMultiColumnNavigationPanel' id='NavigationPanel'> <div class='NavHierarchy' id='NavigationSection'> <ul id='NavigationList' class='WACDialogUList'> </ul> </div> </div>",e}();(0,o.l)(JI,"aec475d4$SectionPickerDialogHtml",null,[]);var XI=n(6602),YI=n(7610),ZI=function(e){function t(){return e.call(this,new YI.n,gy.g.get_htmlViewRootFactory_DoNotUse(),yi.App.get_theViewManager())||this}return(0,v.t)(t,e),t}(gy.g);(0,o.l)(ZI,"811f7416$SectionPickerHtmlView",gy.g,[]);var ew=function(e){function t(){var t=this;return t._viewFactory=null,t._recycleBinHelper=null,t._destinationGraphNode=null,t._currentSelectedElement=null,t._sectionPickerHtmlView=null,(t=e.call(this)||this)._viewFactory=Ge.w.get_instance().resolve(eI),t._recycleBinHelper=Ge.w.get_instance().resolve(Wb.v),t.setButtonsOption(),t.BuildDialogHtmlView(),t.BuildDialogViewElements(yi.App.theNotebookManager.get_defaultNotebookNode(),t._sectionPickerHtmlView.get_container()),t}return(0,v.t)(t,e),t.prototype.get_destinationGraphNode=function(){return this._destinationGraphNode},t.prototype.setButtonsOption=function(){},t.prototype.getDialogTitle=function(){return""},t.prototype.getIntroLabel=function(){return"Section Picker"},t.prototype.BuildDialogHtmlView=function(){this.set_dialogHtml(JI.dialogHtml(this.getIntroLabel()));this.initializeAndShow(this.getDialogTitle(),o.i(this,this.sectionPickerDialogHandler,"sectionPickerDialogHandler"),{})},t.prototype.onInnerHtmlSet=function(){var e=document.getElementById("WACDialogBodyPanel");e&&(e.style.height=t.DialogBodyHeight+"px");var n=document.getElementById("NavigationSection");n&&(n.setAttribute("role","presentation"),Sys.UI.DomElement.addCssClass(n,"SectionPickerDialogNavHierarchy"));var i=document.getElementById("NavigationList");i&&(i.setAttribute("Class","SectionPickerDialogList"),i.setAttribute("role","tree"),n.appendChild(i),this._sectionPickerHtmlView=new ZI,this._sectionPickerHtmlView.bindToContainer(i))},t.prototype.BuildDialogViewElements=function(e,t){var n=new hb.m;n.set(e);for(var i=n.goToFirstChild(),r=null,a=new C.c(DI);i;)if(this._recycleBinHelper.isRecycleBinSectionListNode(i))i=n.goToNextSibling();else{if(lb.j.isSectionNode(i)){if((r=this._viewFactory.createDialogSectionViewElement(this._sectionPickerHtmlView,i,null)).attachClickEventHandler(o.i(this,this.OnSectionClick,"OnSectionClick")),!this._destinationGraphNode){this._destinationGraphNode=i;var l=(0,y.e)(jI.m,r);this._currentSelectedElement=l.get_htmlElement()}this.ConnectAndUpdateViewElement(r,t)}else if(ab.FolderReader.isFolderNode(i)){(r=this._viewFactory.createDialogSectionGroupViewElement(this._sectionPickerHtmlView,i)).attachClickEventHandler(o.i(this,this.OnSectionListClick,"OnSectionListClick"));var s=new XI.u(this._sectionPickerHtmlView.get_viewId());s.set(i),r.updateHtmlElementTopology(s),a.add(r)}i=n.goToNextSibling()}this._currentSelectedElement&&(this.SetHighlight(this._currentSelectedElement,!0),this.SetAriaSelectedOnSectionClick(this._currentSelectedElement,!0)),a.Sc(o.i(this,this.CompareSectionGroupByName,"CompareSectionGroupByName"));for(var u=a.$$lge();u.$$mn();){var c=u.$$cu();this.ConnectAndUpdateViewElement(c,t)}},t.prototype.ConnectAndUpdateViewElement=function(e,t){if(e){var n=(0,y.e)(QI.w,e.get_sourceNode());n&&n.connectViewElement(this._sectionPickerHtmlView.get_viewId(),e),e.updateHtmlElementContent(null),t.appendChild(e.get_htmlElement())}},t.prototype.CompareSectionGroupByName=function(e,t){return Rn.l.localeCompare(e.getSectionGroupTitle(),t.getSectionGroupTitle())},t.prototype.DisconnectViewElements=function(){var e=yi.App.theNotebookManager.get_defaultNotebookNode(),t=new hb.m;t.set(e);for(var n=t.goToFirstChild();n;){if(lb.j.isSectionNode(n)||ab.FolderReader.isFolderNode(n)){var i=(0,y.e)(QI.w,n);if(i){var r=i.getHtmlViewElement(this._sectionPickerHtmlView.get_viewId());r&&r.dispose(),i.disconnectViewElement(this._sectionPickerHtmlView.get_viewId())}}n=t.goToNextSibling()}},t.prototype.OnSectionClick=function(e,t){e!==this._destinationGraphNode&&(this.SetHighlight(this._currentSelectedElement,!1),this.SetAriaSelectedOnSectionClick(this._currentSelectedElement,!1),this._currentSelectedElement=t,this.SetHighlight(this._currentSelectedElement,!0),this.SetAriaSelectedOnSectionClick(this._currentSelectedElement,!0)),this._destinationGraphNode=e},t.prototype.OnSectionListClick=function(e,t){var n=(0,y.e)(tv.e,e);n&&this.BuildDialogViewElements(n,t)},t.prototype.sectionPickerDialogHandler=function(e,t){this.DisconnectViewElements()},t.prototype.SetHighlight=function(e,t){e.style.background=t?"rgb(238,238,238)":""},t.prototype.SetAriaSelectedOnSectionClick=function(e,t){var n=e.querySelector("div.NavSectionName");if(n){n.setAttribute(vt.t.ariaLabelAttribute,t?"Selected: Section":"Not Selected: Section");var i=n.querySelector("a[tabindex='0']");i&&i.setAttribute(vt.t.ariaSelectedAttribute,t?vt.t.ariaTrueValue:vt.t.ariaFalseValue)}},t.DialogBodyHeight=290,t}(Bi.o);(0,o.l)(ew,"afbcb12e$SectionPickerDialog",Bi.o,[]);var tw=function(e){function t(t){var n=this;return n._sourceGraphNode=null,(n=e.call(this)||this)._sourceGraphNode=t,n}return(0,v.t)(t,e),t.prototype.get_sourceGraphNode=function(){return this._sourceGraphNode},t.prototype.getDialogTitle=function(){return OneNoteIntl.OneNoteStrings.L_RestorePage},t.prototype.getIntroLabel=function(){return OneNoteIntl.OneNoteStrings.L_RestoreDialogTitle},t.prototype.sectionPickerDialogHandler=function(t,n){if(e.prototype.sectionPickerDialogHandler.call(this,t,n),1===t){var i={};i.source=this.get_sourceGraphNode(),i.destination=this.get_destinationGraphNode(),L.AFrameworkApplication.get_theActionManager().processActionWithData(nS.u.restorePage,2,i)}},t}(ew);(0,o.l)(tw,"8d85d87a$RestorePageDialog",ew,[]);var nw=function(){function e(){}return e.prototype.createDialogSectionGroupViewElement=function(e,t){return DI.createDialogGroupNavInstance(e,t)},e.prototype.createDialogSectionViewElement=function(e,t,n){return MI.createDialogSectionNavInstance(e,t,n)},e.prototype.createRestorePageDialog=function(e){return new tw(e)},e.prototype.createParagraphDialog=function(e,t,n){S.ULS.sendTraceTag(40186080,339,50,"ParagraphSpacing:CreateParagraphDialog");var i=Ge.w.get_instance();return new qI(e,n,i.resolve(Qc),i.resolveLazy(Yh.d),L.AFrameworkApplication.appSettingsManager,i.resolve(nu.r).get_sharedStandaloneRoot())},e}();(0,o.l)(nw,"a3db05d8$DialogViewFactory",null,[eI,tI]);var iw=function(){return function(e,t,n,i){this._generalCuiUserFuture=null,this._actionManager=null,this._focusManager=null,this._theStandaloneRoot=null,this._generalCuiUserFuture=e,this._actionManager=t,this._focusManager=n,this._theStandaloneRoot=i}}();(0,o.l)(iw,"ed3016$WoncaRibbonUserFactory",null,[IC.x]);var rw=function(){return function(e,t,n){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),this.trimmedIds=null,this.trimmedGallerySections=null,this.trimmedTabs=null,this.trimmedIds=e||{},this.trimmedGallerySections=t||[],this.trimmedTabs=n||{}}}();(0,o.l)(rw,"8d1e4559$RibbonTrimmingProperties",null,[]);var ow=n(3115),aw=function(){return function(e,t,n){this.dataSource=null,this.trimmedIds=null,this.jewelId=null,this.dataSource=e,this.trimmedIds=t,this.jewelId=n}}();(0,o.l)(aw,"c6f78555$ReactRibbonJewelProperties",null,[]);var lw=n(6879),sw=(0,o.y)("4917400f$IRibbonUser"),uw=n(3288),cw=n(457),dw=n(2750),gw=n(9437),pw=n(2862),hw=n(5427),_w=function(){function e(){}return e.then=function(e,t){var n=new ct.z(Boolean);return e.CWo((function(i){if(e.get_isFaulted())n.trySetException(e.get_exception());else if(e.get_isCanceled())n.trySetCanceled();else try{var r=t();r?r.CWo((function(e){r.get_isFaulted()?n.trySetException(r.get_exception()):r.get_isCanceled()?n.trySetCanceled():n.trySetResult(!0)}),Qn.d.executeSynchronously):n.trySetCanceled()}catch(e){n.trySetException(e)}}),Qn.d.executeSynchronously),n.get_task()},e}();(0,o.l)(_w,"bb52ace7$TaskUtils",null,[]);var mw=n(2160),fw=n(5694),yw=n(9030),Cw=n(8379),Sw=n(1194),bw=function(){function e(e,t){this._elmModalDiv=null,this._modalContainer=null,this._focusManager=null,this._onMouseWheel=null,this._registeredHandlers=!1,this._menuStack=0,this._modalContainer=e,this._focusManager=t,this._onMouseWheel=o.i(this,this.OnModalMouseWheel,"OnModalMouseWheel")}return e.prototype.onMenuOpen=function(){var e=this;this._menuStack>0?this._menuStack++:(this._menuStack++,L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DelayMenuFocusActionsUntilNextFrameIsEnabled")?window.requestAnimationFrame((function(t){window.setTimeout(o.i(e,e.PushTransientFocusScope,"PushTransientFocusScope"),0)})):this.PushTransientFocusScope(),this.ShowModal())},e.prototype.PushTransientFocusScope=function(){this._focusManager&&this._focusManager.pushScope(Pe.AFrame.reactTransientUIFocusId,!0)},e.prototype.ShowModal=function(){this._elmModalDiv||(this._elmModalDiv=this.CreateElement("div"),this._elmModalDiv.setAttribute("id","ReactModalDiv"),this._elmModalDiv.style.position="absolute",this._elmModalDiv.style.top="0px",this._elmModalDiv.style.bottom="0px",this._elmModalDiv.style.left="0px",this._elmModalDiv.style.right="0px",this._elmModalDiv.style.backgroundColor="white",this._elmModalDiv.style.opacity="0.0",this._modalContainer.appendChild(this._elmModalDiv)),this._elmModalDiv.style.display="block",this._elmModalDiv.style.visibility="visible",this._elmModalDiv.style.zIndex=String(e.ModalDivZIndexOn),this._registeredHandlers||(window.addEventListener("wheel",this._onMouseWheel,!0),lr.z.get_instance().registerHandler(me.d.pointerDown,this._elmModalDiv,o.i(this,this.OnModalPointerDown,"OnModalPointerDown")),this._registeredHandlers=!0)},e.prototype.onMenuClose=function(){this._menuStack--,this._menuStack>0||(this._menuStack<0?this._menuStack=0:this.HideModalAndPopScope())},e.prototype.onCloseAllMenus=function(){this._menuStack=0,this.DismissContextMenu(),this.HideModalAndPopScope()},e.prototype.CreateElement=function(e){var t=document.createElement(e);return t.setAttribute("unselectable","on"),t},e.prototype.HideModalAndPopScope=function(){this._focusManager&&this._focusManager.get_currentScope()&&this._focusManager.get_currentScope().name===Pe.AFrame.reactTransientUIFocusId&&!L.AFrameworkApplication.get_theTaskManager().get_isYielding()&&this._focusManager.popScope(Pe.AFrame.reactTransientUIFocusId,!1),this._elmModalDiv&&(this._elmModalDiv.style.zIndex=String(e.ModalDivZIndexOff),this._elmModalDiv.style.visibility="hidden",this._elmModalDiv.style.display="none"),this._registeredHandlers&&(window.removeEventListener("wheel",this._onMouseWheel,!0),lr.z.get_instance().unregisterHandler(me.d.pointerDown,this._elmModalDiv,o.i(this,this.OnModalPointerDown,"OnModalPointerDown")),this._registeredHandlers=!1)},e.prototype.OnModalPointerDown=function(e){return this.DismissContextualUI(),this.onCloseAllMenus(),this._focusManager.setScope(Pe.AFrame.documentFocusID),!0},e.prototype.OnModalMouseWheel=function(e){e.stopPropagation()},e.prototype.DismissContextualUI=function(){var e=Ge.w.get_instance().tryResolve(iu);e&&e.dismissContextualUI()},e.prototype.DismissContextMenu=function(){var e=Ge.w.get_instance().tryResolve(iu);e&&e.dismissContextMenu()},e.ModalDivZIndexOn=1e3,e.ModalDivZIndexOff=-1,e}();(0,o.l)(bw,"36aa38e2$ReactModalDiv",null,[]);var vw=function(){function e(e,t,n,i,r,o,a,l,s){this._ribbonRoot=null,this._rootCommandHandler=null,this._externalUICommandDefinitionMapping=null,this._focusManager=null,this._modalDiv=null,this._ribbonSQMInformation=null,this._fileMenuSQMInformation=null,this._actionManager=null,this._reactRibbonRootPoller=null,this._lastPollTimes=null,this._appSettingsManager=null,this._ribbonRoot=e,this._reactRibbonRootPoller=t,this._rootCommandHandler=(0,y.e)(Su,e),this._externalUICommandDefinitionMapping=n,this._focusManager=i,r&&(this._modalDiv=new bw(r,i)),this._ribbonSQMInformation=o,this._fileMenuSQMInformation=a,this._actionManager=l,this._lastPollTimes={},this._appSettingsManager=s}return e.prototype.get_SelectorsAreReady=function(){return!!window.appChrome&&!!appChrome.selectors},e.prototype.executeCommand=function(e,t){if((!Ce.y.get_instance().get_isYielding()||(S.ULS.sendTraceTag(38293640,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",e,t.modelType,P.j.toJSON(t.payload)),!this._appSettingsManager.getBooleanAppSetting("WordEditorReactExecuteYieldReturnIsEnabled")))&&t){var n=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(e),i=t.modelType;n?this.ExecuteCommandWithCommandMetadata(e,n,i,t):this.ExecuteCommandWithNoCommandMetadata(e,i,t),this.ManageAppFocus(e,t)}},e.prototype.ExecuteCommandWithNoCommandMetadata=function(e,t,n){switch(t){case"GalleryModel":case"PreviewGalleryModel":this.ExecuteGalleryButtonCommand(n,e);break;default:return}},e.prototype.UpdateParametersForButton=function(e,t,n,i,r){var o=r;if(n.payload)switch(n.payload.type){case"CoauthorMenuPayload":e.MenuItemId=n.payload.coauthorId;break;case"ButtonPayload":e.MenuItemId=t.menuItemId,e.CommandValueId=n.payload.commandValueId,this.CloseAllMenus();break;case"ButtonPreviewPayload":e.MenuItemId=t.menuItemId,e.CommandValueId=n.payload.commandValueId,o=t.commandPreviewId;break;case"ButtonRevertPreviewPayload":e.MenuItemId=t.menuItemId,e.CommandValueId=n.payload.commandValueId,o=t.commandRevertId;break;default:e.MenuItemId=t.menuItemId}else e.MenuItemId=t.menuItemId;return e.SourceControlId=i,o},e.prototype.UpdateParametersForTellMe=function(e,t,n){if(t.payload)switch(t.payload.type){case"MenuOpenPayload":e=this._externalUICommandDefinitionMapping.getCommandByExternalUxId("TellMeLogMenuOpen").get_commandId();break;case"MenuClosePayload":e=this._externalUICommandDefinitionMapping.getCommandByExternalUxId("TellMeLogMenuClose").get_commandId();break;case"TellMeMenuItemExecuted":n.CommandId=t.payload.executedControl,n.ControlId=t.payload.executedControl,n.CloseAllMenus=!0,this.CloseAllMenus();break;case"TellMeSearchResultChangePayload":n.Value=t.payload.searchText;break;case"SmartLookupPayload":n.CommandValueId=t.payload.selectionContextJson}return e},e.prototype.ExecuteCommandWithCommandMetadata=function(e,t,n,i){var r=this;this.PopulateControlMenuOnExecute(i,n);var a=t.get_commandId(),l={};switch(n){case"SplitButtonModel":if(this.HandleMenuOpenClosePayload(i.payload,o.i(this,this.UpdateSplitButtonMenuState,"UpdateSplitButtonMenuState")))return;l.MenuItemId=t.menuItemId,this.SetToggledParameter(i,l);break;case"StatefulSplitButtonModel":if(this.HandleMenuOpenClosePayload(i.payload,o.i(this,this.UpdateStatefulSplitButtonMenuState,"UpdateStatefulSplitButtonMenuState")))return;var s=i.payload.statefulData,u=i.payload.statefulMode;if("color"===u)l.Color=s;else if("icon"===u){var c=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(s);c&&(l.MenuItemId=c.menuItemId)}break;case"FileMenu":l.MenuItemId=t.menuItemId,l.SourceControlId=e,i.payload&&"FileMenuPageSwitchPayload"===i.payload.type&&this.HandleFileMenuPageSwitch(a,i.payload,e);break;case"TellMe":a=this.UpdateParametersForTellMe(a,i,l),l.SourceControlId=e;break;case"ButtonModel":i.payload&&"TabSwitchPayload"===i.payload.type?this.HandleTabSwitch(l,i):a=this.UpdateParametersForButton(l,t,i,e,a);break;case"CompoundButtonModel":l.MenuItemId=t.menuItemId,l.CommandValueId=i.payload.commandValueId,l.SourceControlId=e,this.SetToggledParameter(i,l),this.CloseAllMenus();break;case"ToggleButtonModel":l.MenuItemId=t.menuItemId,l.SourceControlId=e,this.SetToggledParameter(i,l),this.CloseAllMenus();break;case"ComboBoxModel":var d=i.payload.type;switch(d){case"MenuOpenPayload":case"MenuPopulatePayload":if(this.ShouldPoll(e))(p={})[i.payload.launcherId]=n,this._reactRibbonRootPoller.pollForStateAndUpdateCommands(p),this._lastPollTimes[e]=new Date;return;case"MenuClosePayload":return;case"ComboBoxPayload":case"ComboBoxPreviewPayload":var g=i.payload.newValue;if(!g)return;g.value?(l[jr.g.Value]=g.value,l[jr.g.IsFreeForm]=!0):(l[jr.g.Value]=g.text,l.MenuItemId=g.key,l.CommandValueId=g.commandValueId),"ComboBoxPreviewPayload"===d&&(a=t.commandPreviewId);break;case"ComboBoxRevertPreviewPayload":a=t.commandRevertId;break;default:return}break;case"FlyoutAnchorModel":this.HandleMenuOpenClosePayload(i.payload,o.i(this,this.UpdateFlyoutAnchorMenuState,"UpdateFlyoutAnchorMenuState")),l.launcherId=i.payload.launcherId;break;case"ColorPickerModel":switch(i.payload.type){case"ColorPickerPayload":l[br.Color]=i.payload.selectedColorId;break;case"ColorPickerPreviewPayload":a=t.commandPreviewId,l[br.Color]=i.payload.selectedColorId;break;case"ColorPickerRevertPreviewPayload":a=t.commandRevertId;break;default:return}break;case"SpinButtonModel":l[So.Number]=i.payload.value,l[So.UnitType]=Vu.r.convertStringToUnitType(i.payload.unitType.toLowerCase()),l[So.Text]=i.payload.reservedValue;break;case"SliderModel":l[mo.u.Value]=i.payload.value;break;case"InsertTableModel":l[ro.Rows]=i.payload.rows,l[ro.Columns]=i.payload.columns;break;case"CheckboxModel":l[gr.e.On]=i.payload.checked,l.MenuItemId=t.menuItemId;break;case"PreviewGalleryModel":if(this.HandleMenuOpenClosePayload(i.payload,o.i(this,this.UpdatePreviewGalleryMenuState,"UpdatePreviewGalleryMenuState"))){l.launcherId=i.payload.launcherId;break}return void this.ExecuteGalleryButtonCommand(i,e);case"DocumentTitleModel":switch(i.payload.type){case"DocumentTitleRenamePayload":l.newDocumentTitle=i.payload.newDocumentTitle;break;case"MenuOpenPayload":var p;return(p={})[i.payload.launcherId]=n,this._reactRibbonRootPoller.pollForStateAndUpdateCommands(p),void(this._lastPollTimes[e]=new Date);case"MenuClosePayload":default:return}break;case"MRUCompoundButtonModel":l.MenuItemId=i.payload.url,this.LogFileMenuMRUExecution(i.payload.pageId);break;case"NewBlankDocumentModel":case"CustomTemplateModel":l.MenuItemId=i.payload.assetId,l.SourceControlId=e,this.LogFileMenuTemplateExecution(i.payload.pageId);break;case"CoauthorGallery":l.RenderTime=i.triggerTime;break;case"SyncStatus":l.SourceControlId=e;break;default:return}if(a){l.CommandValueId||(l.CommandValueId=l.MenuItemId),t.legacyControlId&&(l.LegacyId=t.legacyControlId),l.SourceControlId||(l.SqmControlId=e),i.payload&&!_r.n.isNullOrUndefined(i.payload.keepFocusInRibbon)&&(l[fc.z.shouldCanvasTakeFocus]=!i.payload.keepFocusInRibbon),i.payload&&!_r.n.isNullOrUndefined(i.payload.shouldTakeFocus)&&(l[fc.z.shouldCanvasTakeFocus]=i.payload.shouldTakeFocus);var h=2;i.payload&&"inputMethod"in i.payload&&i.payload.inputMethod&&(h=i.payload.inputMethod,l[fc.z.inputMethod]=h),this._rootCommandHandler.executeCommand(a,l,this.GetSelectedTabId(),h,!0,(function(t){r.MoveFocusAfterCommandExecution(l,e)}),this.GetTelemetryData(i),this.GetUILocationFromPayload(i.payload))}},e.prototype.MoveFocusAfterCommandExecution=function(e,t){if(this._focusManager&&this.ShouldMoveFocus(e)&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("MoveFocusAfterCommandIsEnabled")){var n=(0,y.e)(Pe.AFrame,L.AFrameworkApplication.get_activeFrame());if(!this._focusManager.get_currentScope()&&n){var i="null";if(e){var r=e.Value;delete e.Value,i=P.j.toJSON(e),_r.n.isNullOrUndefined(r)||(e.Value=r)}S.ULS.sendTraceTag(39359317,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",t,i,n.get_ribbonFocusScopeName())}this._focusManager.focusLastEditableSurface()}},e.prototype.ShouldMoveFocus=function(e){return!!e&&!_r.n.isNullOrUndefined(e[fc.z.shouldCanvasTakeFocus])&&e[fc.z.shouldCanvasTakeFocus]},e.prototype.HandleTabSwitch=function(e,t){if(this._ribbonRoot.pollForStateAndUpdate(),this._ribbonSQMInformation&&this._actionManager){var n={};n[Sw.w.tabId]=t.payload.tabId,this._actionManager.processActionWithData(Fe.b.reportTabSwitch,2,n,this.GetTelemetryData(t))}var i=t.payload.tabId;e.NewContextId=i,e.NewContextCommand=this._externalUICommandDefinitionMapping.getTabCommandByExternalUxId(i),S.ULS.sendTraceTag(39879004,340,50,"HandleTabSwitch tabId: "+i)},e.prototype.HandleMenuOpenClosePayload=function(e,t){var n=e.type;return"MenuClosePayload"===n||"MenuOpenPayload"===n&&(t(e.launcherId),!0)},e.prototype.PopulateControlMenuOnExecute=function(e,t){if(e.payload&&e.payload.launcherId&&("MenuOpenPayload"===e.payload.type||"MenuPopulatePayload"===e.payload.type)){var n=e.payload.launcherId,i=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(n);if(i&&i.populationProps){var r=2;"inputMethod"in e.payload&&e.payload.inputMethod&&(r=e.payload.inputMethod),this._reactRibbonRootPoller.populateControlMenu(i,t,r)&&n in this._lastPollTimes&&delete this._lastPollTimes[n]}}},e.prototype.UpdateFlyoutAnchorMenuState=function(e){if(this.ShouldPoll(e)){var t=appChrome.selectors.getFlyoutAnchorMenuItems(e);this.UpdateMenuItems(t,e)}},e.prototype.UpdatePreviewGalleryMenuState=function(e){if(this.ShouldPoll(e)){var t=appChrome.selectors.getPreviewGalleryMenuItems(e);this.UpdateMenuItems(t,e)}},e.prototype.UpdateSplitButtonMenuState=function(e){if(this.ShouldPoll(e)){var t=appChrome.selectors.getSplitButtonMenuItems(e);this.UpdateMenuItems(t,e)}},e.prototype.UpdateStatefulSplitButtonMenuState=function(e){if(this.ShouldPoll(e)){var t=appChrome.selectors.getStatefulSplitButtonMenuItems(e);this.UpdateMenuItems(t,e)}},e.prototype.GetSelectedTabId=function(){return this.get_SelectorsAreReady()?appChrome.selectors.getSelectedTabId():null},e.prototype.UpdateMenuItems=function(e,t){this._reactRibbonRootPoller.pollForStateAndUpdateCommands(e),this._lastPollTimes[t]=new Date},e.prototype.ShouldPoll=function(e){var t=!0;e in this._lastPollTimes&&(t=this._lastPollTimes[e].getTime()<this._ribbonRoot.get_LastPollTime().getTime());return t&&this.get_SelectorsAreReady()},e.prototype.ExecuteGalleryButtonCommand=function(e,t){var n=this,i={},r=e.payload.selectedGalleryId,o=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(r);o&&(i.SourceControlId=r,i.MenuItemId=o.menuItemId,i.SqmControlId=t,o.legacyControlId&&(i.LegacyId=o.legacyControlId),e.payload&&!_r.n.isNullOrUndefined(e.payload.keepFocusInRibbon)&&(i[fc.z.shouldCanvasTakeFocus]=!e.payload.keepFocusInRibbon),e.payload&&!_r.n.isNullOrUndefined(e.payload.shouldTakeFocus)&&(i[fc.z.shouldCanvasTakeFocus]=e.payload.shouldTakeFocus),this.GetParametersByGalleryPayloadType(e.payload,i),this._rootCommandHandler.executeCommand(o.get_commandId(),i,this.GetSelectedTabId(),2,!0,(function(e){n.MoveFocusAfterCommandExecution(i,t)}),this.GetTelemetryData(e),this.GetUILocationFromPayload(e.payload)))},e.prototype.GetParametersByGalleryPayloadType=function(e,t){"CharacterGalleryPayload"===e.type&&(t.MenuItemId=e.character)},e.prototype.SetToggledParameter=function(e,t){e.payload&&"toggled"in e.payload&&(t[gr.e.On]=e.payload.toggled)},e.prototype.ManageAppFocus=function(e,t){"MenuOpen"===e?!this._modalDiv||"isShadowRendering"in t.payload&&t.payload.isShadowRendering||this._modalDiv.onMenuOpen():"MenuClose"===e&&this._modalDiv&&this._modalDiv.onMenuClose()},e.prototype.CloseAllMenus=function(){this._modalDiv&&this._modalDiv.onCloseAllMenus()},e.prototype.GetTelemetryData=function(e){var t=null;return _r.n.isNullOrUndefined(e.triggerTime)||((t={}).TriggerTime=e.triggerTime),t},e.prototype.HandleFileMenuPageSwitch=function(e,t,n){if(this._fileMenuSQMInformation&&this._actionManager){var i={};i[Cw.k.pageId]=n,this._actionManager.processActionWithData(Fe.b.reportFileMenuPageSwitch,2,i)}this.ShouldPoll(e)&&this.UpdateMenuItems(t.pageControlIdMap,e)},e.prototype.LogFileMenuTemplateExecution=function(e){if(this._actionManager)switch(e){case"FileHomePage":this._actionManager.processAction(Fe.b.reportTemplateFromHomePage,2);break;case"FileNewPage":this._actionManager.processAction(Fe.b.reportTemplateFromNewPage,2)}},e.prototype.LogFileMenuMRUExecution=function(e){if(this._actionManager)switch(e){case"FileHomePage":this._actionManager.processAction(Fe.b.reportMRUFromHomePage,2);break;case"FileOpenPage":this._actionManager.processAction(Fe.b.reportMRUFromOpenPage,2)}},e.prototype.GetUILocationFromPayload=function(e){if(e)switch(e.location){case"ContextMenu":return 19;case"Floatie":return 9;case"SingleLineRibbon":return 14;case"MultilineRibbon":return 15;case"Overflow":return 16;case"TellMe":return 17;case"FarPeripheralControls":return 18;case"Header":return 21;case"FileMenu":return 22;case"Ribbon":default:return 2}return 2},e}();(0,o.l)(vw,"4dab7edf$ReactExecuteCommandHandler",null,[]);var Tw=n(4976),Aw=function(){function e(){this._jewel=null}return e.prototype.get_jewel=function(){return this._jewel},e.prototype.set_jewel=function(e){return this._jewel=e,e},e.prototype.get_upperRibbonHeight=function(){return 0},e.prototype.get_lowerRibbonHeight=function(){return 0},e.prototype.get_minimized=function(){return!1},e.prototype.scaleHeader=function(){},e.prototype.toggleMinimizedState=function(e){},e.prototype.dismissTabPopup=function(e,t){return void 0===e&&(e=!0),void 0===t&&(t=!0),!1},e.prototype.setFocusOnCurrentTabTitle=function(){},e.prototype.selectTabById=function(e,t){return void 0===t&&(t=!1),!1},e.prototype.dismissAllTransientUI=function(){return!1},e.prototype.updateOpenMenu=function(e){return!(!this._jewel||!this._jewel.refreshOpenMenu(e))},e.prototype.get_tabPoppedUp=function(){return!1},e.prototype.get_selectedTabId=function(){return null},e.prototype.setControlVisibility=function(e,t){},e.prototype.getControlVisibility=function(e){return!1},e.prototype.forceEnableControl=function(e,t){},e.prototype.isControlEnabled=function(e){return!1},e.prototype.get_controlIdPrefix=function(){return null},e.prototype.set_controlIdPrefix=function(e){return e},e.prototype.beginModal=function(e,t,n){void 0===n&&(n=!1)},e.prototype.endModal=function(e,t,n){void 0===n&&(n=!1)},e.prototype.endBlockingModeKeepModal=function(){},e.prototype.getValidControl=function(e){return null},e.prototype.ensureBehaviorAttached=function(){},e.prototype.refresh=function(){},e.prototype.get_controls=function(){return null},e.prototype.refreshOpenMenu=function(e){return!1},e.prototype.commitAnyPendingChange=function(){},e.prototype.pollForStateAndUpdate=function(){},e.prototype.get_rootUser=function(){return null},e.prototype.set_rootUser=function(e){return e},e.prototype.updateControl=function(e){},e.prototype.get_inKeytipMode=function(){return!1},e.prototype.enterKeytipMode=function(e){void 0===e&&(e=null)},e.prototype.exitKeytipMode=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0)},e}();(0,o.l)(Aw,"6e7647b8$ReactRibbonExternal",null,[Tw.h,or.s,Cu.l]);var Iw=function(){function e(e,t,n,i){this._focusManager=null,this._actionManager=null,this._wacRibbonPanel=null,this._ribbonFocusId=null,this._focusManager=e,this._actionManager=t,this._wacRibbonPanel=n,this._ribbonFocusId=i}return e.prototype.initialize=function(){this._actionManager.addAction(Fe.b.ribbonMoveForward,Ue.m.frame,o.i(this,this.RibbonMoveForwardAction,"RibbonMoveForwardAction")),this._actionManager.addAction(Fe.b.ribbonMoveBackward,Ue.m.frame,o.i(this,this.RibbonMoveBackwardAction,"RibbonMoveBackwardAction")),this._actionManager.addAction(Fe.b.ribbonEsc,Ue.m.frame,o.i(this,this.RibbonEscAction,"RibbonEscAction"));var e=kI.o.initializeCuiScope(this._ribbonFocusId,null,this._wacRibbonPanel,!1,!0,!0);e.set_keyDownHandledExternally(!0),this.RebindTabHandlers(e,Fe.b.ribbonMoveForward,Fe.b.ribbonMoveBackward),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_Esc,0),Fe.b.ribbonEsc);var t=this._focusManager.getScope(Pe.AFrame.reactTransientUIFocusId);t.set_keyDownHandledExternally(!0),this.RebindTabHandlers(t,Fe.b.doBrowserDefault,Fe.b.doBrowserDefault),ye.p.get_instance().registerHandler(me.d.mouseDown,this._wacRibbonPanel,o.i(this,this.OnRibbonMouseDown,"OnRibbonMouseDown"));var n=AA.F6Manager.get_instance();Ln.AppChromeUtils.apiExists("enterKeytipMode")&&n.setOnPostF6(this._ribbonFocusId,(function(){appChrome.api.enterKeytipMode(!1)})),Ln.AppChromeUtils.apiExists("exitKeytipMode")&&n.setOnBeforeF6(this._ribbonFocusId,(function(e){appChrome.api.exitKeytipMode()}))},e.prototype.RibbonMoveForwardAction=function(e,t,n,i,r){return 4},e.prototype.RibbonMoveBackwardAction=function(e,t,n,i,r){return 4},e.prototype.RibbonEscAction=function(e,t,n,i,r){return Ln.AppChromeUtils.apiExists("inKeytipMode")&&!appChrome.api.inKeytipMode()&&this._focusManager.setScope(Pe.AFrame.documentFocusID),4},e.prototype.RebindTabHandlers=function(e,t,n){var i=Me.KeyInputManager.hashKey(Re.v.vK_Tab,0),r=Me.KeyInputManager.hashKey(Re.v.vK_Tab,4);e.unBindAction(i),e.unBindAction(r),e.bindAction(i,t),e.bindAction(r,n)},e.prototype.OnRibbonMouseDown=function(e){return e.innerEvent&&e.innerEvent.target&&"input"!==e.innerEvent.target.tagName.toLowerCase()&&e.innerEvent.preventDefault(),!1},e.prototype.dispose=function(){this._actionManager.removeAction(Fe.b.ribbonMoveForward,Ue.m.frame,o.i(this,this.RibbonMoveForwardAction,"RibbonMoveForwardAction")),this._actionManager.removeAction(Fe.b.ribbonMoveBackward,Ue.m.frame,o.i(this,this.RibbonMoveBackwardAction,"RibbonMoveBackwardAction")),this._actionManager.removeAction(Fe.b.ribbonEsc,Ue.m.frame,o.i(this,this.RibbonEscAction,"RibbonEscAction"))},e}();(0,o.l)(Iw,"5e43e7ba$ReactRibbonFocusManager",null,[Sys.IDisposable]);var ww=function(){function e(e,t,n,i,r,o,a,l,s,u){void 0===l&&(l=null),void 0===s&&(s=!0),void 0===u&&(u=null),this._ribbonRoot=null,this._ribbonPanel=null,this._actionManager=null,this._focusManager=null,this._shouldRenderRibbon=!1,this._ribbonFocusId=null,this._externalUICommandDefinitionMapping=null,this._commandHandler=null,this._unregisterBindCommandHandlerAction=null,this._ribbonExternal=null,this._jewel=null,this._elmJewelPlaceholder=null,this._modalContainer=null,this._jewelProperties=null,this._ribbonTrimmingProperties=null,this._ribbonFocusManager=null,this._setAppInitializationStatuses=[],this._ribbonPanel=e,this._modalContainer=t,this._ribbonFocusId=n,this._focusManager=i,this._actionManager=r,this._externalUICommandDefinitionMapping=o,this._ribbonRoot=u||new qu(Jo.f.get_instance(),this._externalUICommandDefinitionMapping),this._jewelProperties=a,this._ribbonExternal=new Aw,this._ribbonTrimmingProperties=l,this._shouldRenderRibbon=s}return e.prototype.initialize=function(t,n,i){var r=this;void 0===i&&(i=null),this._shouldRenderRibbon||this.SetAppInitializationStatus(5),i?i.then((function(){r.renderRibbon()})).catch((function(e){return S.ULS.sendTraceTag(35436050,340,10,"Failed to load the resources for the Ribbon")})):_w.then(_w.then(ut.Task.WAA(this.loadRibbonLocalizedJSFileAsync(t),this.loadRibbonJSFileAsync(e._commonJSFile)),(function(){return r.loadRibbonJSFileAsync(e._appChromeJSFile)})),(function(){return r.loadRibbonLocalizedJSFileAsync(n)})).CWo((function(e){r.renderRibbon()}),Qn.d.onlyOnRanToCompletion|Qn.d.executeSynchronously),this.logRibbonLoaded()},e.prototype.dispose=function(){this._unregisterBindCommandHandlerAction&&this._unregisterBindCommandHandlerAction(),this._jewel&&this._jewel.dispose(),this._ribbonFocusManager&&this._ribbonFocusManager.dispose();for(var e=0,t=this._setAppInitializationStatuses;e<t.length;e++){var n=t[e];ar.r.get_instance().clearAppInitializationStatus(n)}L.AFrameworkApplication.get_theActionManager().removeAction(Fe.b.reportOneLineRibbonLoaded,Ue.m.frame,Le.ActionManager.doNothingButReportHandler)},e.prototype.logRibbonLoaded=function(){S.ULS.sendTraceTag(34468252,340,50,"User is booting the Single Line Ribbon"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(Fe.b.reportOneLineRibbonLoaded,Ue.m.frame,Le.ActionManager.doNothingButReportHandler,96),L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.reportOneLineRibbonLoaded,2)},e.prototype.loadRibbonJSFileAsync=function(e){return Ge.w.get_instance().resolve(cw.n).loadSharedDependencyAsync(L.AFrameworkApplication.scriptUrlFromName(e,2))},e.prototype.loadRibbonLocalizedJSFileAsync=function(e){return""===e?ut.Task.fromResult(Boolean,!0):Ge.w.get_instance().resolve(cw.n).loadSharedDependencyAsync(L.AFrameworkApplication.scriptUrlFromName(e,3))},e.prototype.initializeRibbonStore=function(){(this._ribbonTrimmingProperties||this._jewelProperties)&&appChrome.api.dispatch(this.getTrimmedIdsHideActions()),this.setUlsExternalLogger(),Ln.AppChromeUtils.apiExists("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(L.AFrameworkApplication.get_staticContentScriptNameBase()),this._ribbonRoot.pollForStateAndUpdate()},e.prototype.renderRibbon=function(){this.initializeRibbonStore(),this._shouldRenderRibbon&&(appChrome.renderAppChrome(this._ribbonPanel,Ln.AppChromeUtils.getRenderAppChromeSettings()),this.SetAppInitializationStatus(10)),this.addBindCommandHandlerCallback(),this.buildAndSetJewel(),this._shouldRenderRibbon&&this.SetAppInitializationStatus(5),this.initializeFocusManager()},e.prototype.initializeFocusManager=function(){this._focusManager&&this._actionManager&&this._ribbonFocusId&&(this._ribbonFocusManager=new Iw(this._focusManager,this._actionManager,this._ribbonPanel,this._ribbonFocusId),this._ribbonFocusManager.initialize())},e.prototype.get_ribbonExternal=function(){return this._ribbonExternal},e.prototype.addBindCommandHandlerCallback=function(){var e=this,t=(0,y.e)(qu,this._ribbonRoot);this._commandHandler=new vw(this._ribbonRoot,t.get_reactRibbonRootPoller(),this._externalUICommandDefinitionMapping,this._focusManager,this._modalContainer,Ge.w.get_instance().tryResolve(dw.f),Ge.w.get_instance().tryResolve(gw.l),L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.appSettingsManager),this._unregisterBindCommandHandlerAction=appChrome.api.bindCommandHandler((function(t,n){e._commandHandler.executeCommand(t,n)}))},e.prototype.setUlsExternalLogger=function(){appChrome.api.initializeLogger(new hw.s)},e.prototype.getPollForStateAndUpdateActions=function(){return this._ribbonRoot?this._ribbonRoot.getPollForStateAndUpdateActions():new Array(0)},e.prototype.pollForStateUpdate=function(){var e=this.getPollForStateAndUpdateActions();e.length>0&&(this._ribbonRoot.set_LastPollTime(new Date),appChrome.api.dispatch(e)),this._jewel&&this._jewel.pollForStateAndUpdate()},e.prototype.updatePeopleWellControl=function(){this._ribbonRoot.updatePeopleWellControl()},e.prototype.updateDocChatControl=function(){this._ribbonRoot.updateDocChatControl()},e.prototype.onComponentBuilt=function(e,t){},e.prototype.activateAndSetCurrentContextualTab=function(e){var t=[appChrome.actions.activateDeactivateContextualTab(e,!0),appChrome.actions.setCurrentTab(e)];appChrome.api.dispatch(t)},e.prototype.getTrimmedIdsHideActions=function(){var e=L.AFrameworkApplication.appSettingsManager,t=new Array(0);e.getBooleanAppSetting("EnableTellMeForOneLineRibbonIsEnabled")?e.getBooleanAppSetting("OcpsIsEnabled")&&Ge.w.get_instance().resolveFuture(j.a).execute((function(e){e.isFeatureEnabled("ConnectedServices",!0).then((function(e){return e&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1)),null}))})):t.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0)),t.push.apply(t,this.getFileMenuTrimmingActions());var n=new pw.v(this._externalUICommandDefinitionMapping);if(this._ribbonTrimmingProperties.trimmedIds&&(mw.p.trimPeripheralControls(this._ribbonTrimmingProperties.trimmedIds),t.push.apply(t,n.getActionsForTrimmedIds(this._ribbonTrimmingProperties.trimmedIds))),this._ribbonTrimmingProperties.trimmedGallerySections)for(var i=0,r=this._ribbonTrimmingProperties.trimmedGallerySections;i<r.length;i++){var o=r[i];t.push(appChrome.actions.updateGallerySectionHiddenState(o.galleryId,o.sectionId,o.trimmedValue))}return t.push.apply(t,n.getActionsForTrimmedTabs(this._ribbonTrimmingProperties.trimmedTabs)),t},e.prototype.getFileMenuTrimmingActions=function(){var e=new Array(0);if(this._jewelProperties&&this._jewelProperties.trimmedIds){var t=this._jewelProperties.trimmedIds;for(var n in t){var i={key:n,value:t[n]},r=this._externalUICommandDefinitionMapping.getExternalUxIdsByLegacyControlId(i.key);if(r)for(var o=r.$$lge();o.$$mn();){var a=o.$$cu();e.push(appChrome.actions.updateControlHiddenState(a,i.value))}}}return e},e.prototype.updateControls=function(e){e&&this._ribbonRoot.get_reactRibbonRootPoller().pollForStateAndUpdateCommands(e)},e.prototype.populateControlMenu=function(e){this._ribbonRoot.get_reactRibbonRootPoller().populateControlMenu(this._externalUICommandDefinitionMapping.getCommandByExternalUxId(e),appChrome.selectors.getModelType(e))},e.prototype.showActionButton=function(e){var t=this;ar.r.get_instance().executeWhen(5,null).CW((function(n){appChrome.api.dispatch(t.getShowActionButtonStoreAction(e))}))},e.prototype.getShowActionButtonStoreAction=function(e){var t={};return t.actionButtonId=e,appChrome.actions.updatePeripheralControls(t)},e.prototype.getShowCopyLinkButtonStoreAction=function(e){var t={};return t.copyLinkButtonId=e,appChrome.actions.updatePeripheralControls(t)},e.prototype.SetAppInitializationStatus=function(e){ar.r.get_instance().setAppInitializationStatus(e),this._setAppInitializationStatuses.push(e)},e.prototype.buildAndSetJewel=function(){if(this._jewelProperties){this.InitializeJewelPlaceholder();var e=(0,U.m)(new fw.l,{trimmedIds:this._jewelProperties.trimmedIds}),t=new yw.JewelBuilder(e,this._elmJewelPlaceholder,ut.Task.fromResult(uw.j,(0,y.e)(uw.j,this)));if(t.set_dataSource(this._jewelProperties.dataSource),!t.buildJewel(this._jewelProperties.jewelId,null))throw Error.create("Jewel could not be built");this._jewel=t.get_jewel(),this._jewel&&(this._jewel.set_rootUser(this._ribbonRoot.get_rootUser()),this._jewel.pollForStateAndUpdate(),this._ribbonExternal.set_jewel(this._jewel),Ln.AppChromeUtils.appChromeContainsAction("updateFileMenuDisabledValue")&&appChrome.api.dispatch(appChrome.actions.updateFileMenuDisabledValue(!1)))}},e.prototype.InitializeJewelPlaceholder=function(){this._elmJewelPlaceholder=fr.n.createElement("div"),this._elmJewelPlaceholder.id="jewelcontainer",this._elmJewelPlaceholder.className="cui-jewel-container",this._elmJewelPlaceholder.style.display="block"},e.prototype.launchJewelMenu=function(e,t){this._jewel&&this._jewel.get_JewelMenuLauncher().launchMenuWithSubmenu(e,t)},e._commonJSFile="common",e._appChromeJSFile="appChrome",e}();(0,o.l)(ww,"581e5174$ReactRibbonUser",null,[sw,uw.j,Sys.IDisposable]);var xw=function(e){function t(t,n,i,r,o,a,l,s,u,c,d){void 0===u&&(u=null),void 0===c&&(c=!0),void 0===d&&(d=null);var g=e.call(this,t,n,r,o,a,l,s,u,c,d)||this;return g._generalCuiUserFuture=null,g._generalCuiUser=null,g._generalCuiUserFuture=i,g._generalCuiUserFuture.execute((function(e){g._generalCuiUser=e})),g._generalCuiUserFuture.execute((function(e){g._ribbonRoot.set_rootUser(e)})),g}return(0,v.t)(t,e),t.prototype.getPollForStateAndUpdateActions=function(){return this._generalCuiUser?(this._generalCuiUser.clearCache(),e.prototype.getPollForStateAndUpdateActions.call(this)):new Array(0)},t.prototype.onComponentBuilt=function(e,t){if(!e)throw Error.argumentNull();this._generalCuiUserFuture.execute((function(t){e.set_rootUser(t)}))},t}(ww);(0,o.l)(xw,"cddef4af$ReactRibbonUser",ww,[]);var Ew=(0,o.y)("da22ebae$IReactSharedHeaderPropsHelper"),Fw=n(7278),Pw=(0,o.y)("d5775eeb$ISearchOAuthManager"),Dw=n(3314),Rw=function(){function e(){this._searchOauthManager=null,this._searchOauthManager=Ge.w.get_instance().resolve(Pw)}return e.prototype.GetLokiTokenPromise=function(){return this._searchOauthManager?this._searchOauthManager.getTokenForEndpoint(L.AFrameworkApplication.lokiEndpointForSearch):null},e.prototype.GetSubstrateTokenPromise=function(){return this._searchOauthManager?this._searchOauthManager.getTokenForEndpoint(L.AFrameworkApplication.substrateEndpointForSearch):null},e.prototype.GetLokiTokenPromiseFunc=function(){return o.i(this,this.GetLokiTokenPromise,"GetLokiTokenPromise")},e.prototype.GetSubstrateTokenPromiseFunc=function(){return o.i(this,this.GetSubstrateTokenPromise,"GetSubstrateTokenPromise")},e.prototype.ShouldFetchTokensForSearch=function(){return!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_shouldFetchTokensForSearch()},e.prototype.getTokenRequestDict=function(){var e={};return this.ShouldFetchTokensForSearch()&&(e.Loki=this.GetLokiTokenPromiseFunc(),e.Substrate=this.GetSubstrateTokenPromiseFunc()),e},e.prototype.loadTellMeStrings=function(){var e=Ge.w.get_instance().resolve(Dw.d).getScriptLoader();e&&e.loadScript("tellme-strings").then((function(){appChrome.api.dispatch(appChrome.actions.updateHeaderSearchBoxVisibility(!0)),S.ULS.sendTraceTag(50376975,1300,50,"Loaded resource(s) for the TellMe providers")}))},e.isSearchEnabled=function(){return!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSharedHeaderSearchUxEnabled()},e}();(0,o.l)(Rw,"76364076$ReactSharedHeaderSearchUtils",null,[]);var Mw=function(){return function(){this.documentTitle=null,this.saveStatus=null,this.isVersionHistoryEnabled=!1,this.breadcrumbBrandName=null,this.breadcrumbBrandUrl=null,this.breadcrumbFolderName=null,this.breadcrumbFolderUrl=null,this.hideDocumentTitleInput=!1}}();(0,o.l)(Mw,"e6ac4c93$DocumentTitleAppProps",null,[]);var kw=function(){return function(){this.appName=null,this.userDisplayName=null,this.emailAddress=null,this.userID=null,this.culture=null,this.language=null,this.isConsumer=!1,this.showAppLauncher=!1,this.showMeControl=!1,this.assetsContainerOverride=null,this.controls=null,this.documentTitleAppProps=null,this.showChatControl=!1,this.showSearchControl=!1,this.enableSearchControl=!1,this.showGoPremiumControl=!1,this.signInLink=null,this.getTokenRequestDictionary=null,this.onHeaderReducersReady=null,this.setThemeDataCookie=null,this.getCookie=null,this.onFlexPaneOpen=null,this.onFlexPaneClose=null,this.enableTheming=!1}}();(0,o.l)(kw,"4fad3b03$HeaderAppProps",null,[]);var Nw=function(){return function(){this.ribbonToggleId=null}}();(0,o.l)(Nw,"981c5038$HeaderControls",null,[]);var Lw=n(1834),Bw=n(3537),Ow=function(){function e(){this._shellActor=null}return e.prototype.ShouldShowRibbonToggleButtonInHeader=function(){return!0},e.prototype.GetControls=function(){return(0,U.m)(new Nw,{ribbonToggleId:Fw.c.shouldShowRibbonToggle(this.ShouldShowRibbonToggleButtonInHeader())?"ToggleRibbonUXDialog":null})},e.prototype.GetDocumentTitleAppProps=function(){var e=L.AFrameworkApplication.docPropertiesProvider.get_breadcrumbDocName();return(0,U.m)(new Mw,{documentTitle:L.AFrameworkApplication.get_documentIsFolder()?e:Rn.l.getFileNameWithoutExtension(e),isVersionHistoryEnabled:this.ShouldShowVersionHistory(),breadcrumbBrandName:L.AFrameworkApplication.breadcrumbBrandName,breadcrumbBrandUrl:L.AFrameworkApplication.breadcrumbBrandUrl,breadcrumbFolderName:L.AFrameworkApplication.breadcrumbFolderName,breadcrumbFolderUrl:L.AFrameworkApplication.breadcrumbFolderUrl,hideDocumentTitleInput:!L.AFrameworkApplication.isRenameSupported()})},e.prototype.ShouldShowVersionHistory=function(){return!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSharedHeaderVersionHistoryEnabled()},e.prototype.ShouldEnableTheming=function(){return!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSharedHeaderThemingEnabled()},e.prototype.ShouldShowChatControl=function(){return!Fw.c.isOfficePresentationAttendeeMode()&&!L.AFrameworkApplication.hideHeader&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SkypeWebControlIsEnabled")},e.prototype.SetHeaderThemeDataCookie=function(e){for(var t=e.getEnumerator();t.$$mn();){var n=t.$$cu();re.z.setWithExpiration(n.get_key(),n.get_value(),re.z.maxComplianceAllowedRetentionInDays)}},e.prototype.ContinueShellServiceDataAsync=function(e){if(e.get_isCompleted()){var t=this._shellActor.get_shellServiceDataAsync().get_result(),n=x.x.serialize(t);appChrome.api.dispatch(appChrome.actions.setHeaderNavBarData(n)),S.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}else S.ULS.sendTraceTag(50967330,215,50,String.format("ContinueShellServiceData is not completed. IsFaulted:{0}, IsCanceled:{1}",e.get_isFaulted(),e.get_isCanceled()))},e.prototype.OnHeaderReducersReady=function(){var e=this;Ge.w.get_instance().resolveFuture(qe.u).execute((function(t){e._shellActor=t,t.get_shellServiceDataAsync().CW(o.i(e,e.ContinueShellServiceDataAsync,"ContinueShellServiceDataAsync"))})),Ge.w.get_instance().resolveFuture($i.i).execute((function(e){e.updateSaveStatusDisplay(!1,L.AFrameworkApplication.get_theActionManager().get_mode())}))},e.prototype.getProps=function(e){void 0===e&&(e=!1);var t=Ft.i.getCultureInfo(L.AFrameworkApplication.lcid),n=t?t.get_name():"en-us",i=t?Ft.i.getCultureInfo(t.get_languageId()).get_name():"en",r=Fw.c.shouldShowSwitcher(),a=Rw.isSearchEnabled(),l=Ge.w.get_instance().resolve(Ae),s=(0,U.m)(new kw,{appName:CommonUIStrings.l_AppNameShort,culture:n,language:i,isConsumer:!L.AFrameworkApplication.useO365ShellService,showAppLauncher:r,showMeControl:r,assetsContainerOverride:Bw.h.staticContentHost+L.AFrameworkApplication.get_scriptFolderPath()+"suiteux-shell",controls:this.GetControls(),documentTitleAppProps:e?null:this.GetDocumentTitleAppProps(),showChatControl:this.ShouldShowChatControl(),showGoPremiumControl:Fw.c.shouldShowUpsellButton(),onHeaderReducersReady:o.i(this,this.OnHeaderReducersReady,"OnHeaderReducersReady"),showSearchControl:a,enableSearchControl:a,onFlexPaneOpen:o.i(l,l.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:o.i(l,l.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.ShouldEnableTheming(),setThemeDataCookie:o.i(this,this.SetHeaderThemeDataCookie,"SetHeaderThemeDataCookie"),getCookie:Lw.z.get});if(!L.AFrameworkApplication.userNameUnknown||L.AFrameworkApplication.signoutUrl?(s.userDisplayName=L.AFrameworkApplication.userName,s.emailAddress=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName"),s.userID=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("Puid")||""):s.signInLink=L.AFrameworkApplication.signInUrl,a){var u=new Rw;u.loadTellMeStrings(),s.getTokenRequestDictionary=o.i(u,u.getTokenRequestDict,"getTokenRequestDict")}return s},e}();(0,o.l)(Ow,"2e261c87$ReactSharedHeaderPropsHelper",null,[Ew]);var Uw=function(){return function(){this.value=null,this.label=null}}();(0,o.l)(Uw,"f9a1906b$TextInfoSectionField",null,[]);var Hw=n(9230),Gw=n(1454),Ww=n(9116),Vw=function(){function e(e,t){this._clientId=null,this._resizableContainer=null,this._headerContainer=null,this._elmTopBar1=null,this._clientId=e,this._resizableContainer=t}return e.prototype.ensureTopBarDomElement=function(){return _r.n.isNullOrUndefined(this._elmTopBar1)?(this.EnsureHeaderDom(),this._elmTopBar1.style.display="block",this._resizableContainer&&this._resizableContainer.add_onResize(o.i(this,this.onResize,"onResize")),this._elmTopBar1):this._elmTopBar1},e.prototype.appendTopBarPeripheralElements=function(){this.ensureTopBarDomElement();var e=document.getElementById(this._clientId+"-"+Hw.r.topRowCenter),t=document.getElementById(this._clientId+"-"+Hw.r.topRowRight),n=document.getElementById(this._clientId+"-"+Hw.r.topRowLeft);this.AppendTopBarChildControl(n),this.AppendTopBarChildControl(e),this.AppendTopBarChildControl(t),this.ScaleHeader()},e.prototype.onResize=function(){this.ScaleHeader()},e.prototype.ScaleHeader=function(){this.EnhancedMobileViewIsEnabled()?(document.getElementById("application").style.minWidth="0px",new Ww.b(this._elmTopBar1,null,L.AFrameworkApplication.get_isRtl()).scaleNonCuiHeader(this._elmTopBar1)):Gw.k.scaleNonCuiHeaders(this._elmTopBar1,L.AFrameworkApplication.get_isRtl())},e.prototype.EnhancedMobileViewIsEnabled=function(){return!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EnhancedMobileViewIsEnabled")},e.prototype.EnsureHeaderDom=function(){var e;_r.n.isNullOrUndefined(this._headerContainer)&&(kI.o.tryEnsuredHeaderPanelInitialized((0,g.m)((function(){return e}),(function(t){return e=t})),!L.AFrameworkApplication.hideHeaderEmbedded)&&(this._headerContainer=fr.n.createElement("div"),this._headerContainer.className=kI.o.externalHeaderContainerClass,this._headerContainer.id=it.CuiHelper.externalHeaderFullTopBarsId,e.appendChild(this._headerContainer),this.EnsureExternalHeaderCss(),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled()&&!L.AFrameworkApplication.hideHeaderEmbedded&&this.EnsureFlexBoxPositioningCss(),this.EnsureTopBar1()))},e.prototype.AppendTopBarChildControl=function(e){_r.n.isNullOrUndefined(e)||(e.parentNode!==this._elmTopBar1&&this._elmTopBar1.appendChild(e),e.style.display="inline-block",fr.n.SetUnselectable(e,!0,!1))},e.prototype.EnsureTopBar1=function(){_r.n.isNullOrUndefined(this._elmTopBar1)&&(this._elmTopBar1=fr.n.createElement("div"),this._elmTopBar1.className=kI.o.get_topBarOneCssClass(),this._elmTopBar1.style.display="none",this._headerContainer.appendChild(this._elmTopBar1))},e.prototype.EnsureExternalHeaderCss=function(){Sys.UI.DomElement.addCssClass(this._headerContainer,kI.o.externalHeaderContainerClassToMimicRibbon),L.AFrameworkApplication.get_isRtl()&&fr.n.ensureCSSClassOnElement(this._headerContainer,"cui-rtl")},e.prototype.EnsureFlexBoxPositioningCss=function(){Sys.UI.DomElement.addCssClass(this._headerContainer,"FlexBoxLayout")},e}();(0,o.l)(Vw,"557db680$HeaderSkeleton",null,[]);var $w=n(7337),zw=n(1318),Kw=function(){function e(){}return e.onClickBreadcrumbLinkIPad=function(e){var t=!1,n=!0;if(Gl.n.get_instance().get_item(27)){zw.WoncaApp.get_instance().doOnBeforeAppCloseWork(null);var i=yi.App.onBeforeNavigateWebkitString();i&&2===yi.App.get_activeAppFrame().get_mode()&&(n=confirm(i))}return n?zw.WoncaApp.doOnAppCloseWork():t=!0,t},e}();(0,o.l)(Kw,"ad64ea32$RibbonUserUtil",null,[]);var qw=n(3770),jw=n(1833),Qw=function(e){function t(t,n,i){return void 0===n&&(n=null),void 0===i&&(i=null),e.call(this,t,n,i)||this}return(0,v.t)(t,e),t.prototype.get_SingleUserCollabGlyph16=function(){return 1===yi.App.get_mode()?t.SingleUserCollabGlyph16OneNote:t.SingleUserCollabGlyph16WordEditor},t.prototype.get_SingleUserCollabGlyph32=function(){return 1===yi.App.get_mode()?t.SingleUserCollabGlyph32OneNote:t.SingleUserCollabGlyph32WordEditor},t.prototype.get_MultipleUserCollabGlyph16=function(){return 1===yi.App.get_mode()?t.MultipleUserCollabGlyph16OneNote:t.MultipleUserCollabGlyph16WordEditor},t.prototype.getTopRightActionButtonInfo=function(){var e=null;return L.AFrameworkApplication.fileShareEnabled&&(e=(0,U.m)(new jw.i,{label:WoncaIntl.WoncaStrings.L_Share,command:"981334692",image:it.CuiHelper.shareButtonImg20,id:it.CuiHelper.shareButtonId})),e},t.prototype.getPeopleWellControlSettings=function(){var e=null;return L.AFrameworkApplication.peoplesWellIsEnabled&&(e=it.CuiHelper.getPeoplesWellDefaultControlSettings(L.AFrameworkApplication.get_imageClusterPath(),this.get_SingleUserCollabGlyph16(),L.AFrameworkApplication.get_imageClusterPath(),this.get_SingleUserCollabGlyph32(),L.AFrameworkApplication.get_imageClusterPath(),this.get_MultipleUserCollabGlyph16())),e},t.SingleUserCollabGlyph16OneNote="on_SingleCollabUserGlyph16",t.SingleUserCollabGlyph32OneNote="on_SingleCollabUserGlyph32",t.MultipleUserCollabGlyph16OneNote="on_MoreUsersGlyph16",t.SingleUserCollabGlyph16WordEditor="we_SingleCollabUserGlyph16",t.SingleUserCollabGlyph32WordEditor="we_SingleCollabUserGlyph32",t.MultipleUserCollabGlyph16WordEditor="we_MoreUsersGlyph16",t}(qw.b);(0,o.l)(Qw,"171b30cb$TopRowPeripheralControlCreator",qw.b,[]);var Jw=n(4589),Xw=(0,o.y)("2dd2ad0e$IWoncaAppChromeStateManager"),Yw=function(){function e(){}return e.executeIfAppChromeIsReady=function(e){Ln.AppChromeUtils.appChromeAlreadyLoaded()?e():S.ULS.sendTraceTag(51393038,340,10,"appChrome is not defined.")},e.executeWhen=function(t,n){var i=Ge.w.get_instance().tryResolve(Xw);i?i.executeWhen(t,(function(){e.executeIfAppChromeIsReady(n)})):e.executeIfAppChromeIsReady(n)},e}();(0,o.l)(Yw,"3d53d681$WoncaAppChromeStateManagerHelper",null,[]);var Zw=function(e){function t(t,n,i,r,o,a,l,s,u,c,d,g,p){void 0===d&&(d=null),void 0===g&&(g=!0),void 0===p&&(p=null);var h=this;if(h._hostingAppFrame=null,h._topRowPeripheralControlCreator=null,h._appSpecificStringsClass=null,h._resizableContainer=null,h._standaloneRoot=null,h._shouldShowActionButtonInRibbon=!1,h=e.call(this,n,t.get_documentPanel(),r,Yc.u.ribbonFocusId,o.get_focusManager(),o.get_actionManager(),s,u,c,g,p)||this,null==t)throw Error.argumentNull("hostingAppFrame");return h._hostingAppFrame=t,h._standaloneRoot=l,h._appSpecificStringsClass=i,h._resizableContainer=a,h._topRowPeripheralControlCreator=d,h._shouldShowActionButtonInRibbon=d.shouldShowActionButtonInRibbon(),W.y.get_isIPad()&&it.CuiHelper.registerOnClickBreadcrumbLink(Kw.onClickBreadcrumbLinkIPad),o.waitForReady((function(){h.UpdateRibbonFlexboxLayout(),L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderUxEnabled()?h.CreateReactHeader():h.CreateHeader(),h.CreateFileMenu(),h.RegisterCommands()}),null),h}return(0,v.t)(t,e),t.prototype.get_isDeepLinkLoad=function(){return!!L.AFrameworkApplication.appSettingsManager.get_appSettings().BootActivityNavigationId},t.prototype.UpdateRibbonFlexboxLayout=function(){ji.s.ensureCSSClassOnElement(this._ribbonPanel,"FlexBoxLayout"),ji.s.ensureCSSClassOnElement(this._hostingAppFrame.getDOMElement(),"cui-exth"),ji.s.ensureCSSClassOnElement(this._hostingAppFrame.getDOMElement(),"FlexBoxLayout")},t.prototype.CreateReactHeader=function(){var e=this;if(!L.AFrameworkApplication.hideHeaderEmbedded){var n=new Vw(t._ribbonClientID,this._resizableContainer).ensureTopBarDomElement(),i=kI.o.initializeCuiScope(Yc.u.headerUiFocusId,null,n,!0,!0,!0);i.set_keyDownHandledExternally(!0),this.RebindTabHandlers(i,Fe.b.ribbonMoveForward,Fe.b.ribbonMoveBackward),i.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_Esc,0),Fe.b.ribbonEsc),Yw.executeWhen(1,(function(){e.RenderSharedHeader(n)}))}},t.prototype.RenderSharedHeader=function(e){var t=new Ow;appChrome.renderSharedHeader(e,t.getProps()).then(o.i(this,this.OnSharedHeaderRender,"OnSharedHeaderRender"))},t.prototype.OnSharedHeaderRender=function(){this.get_isDeepLinkLoad()&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ImprovedDeepLinkLoadIsEnabled")?(ar.r.get_instance().executeWhen(12,(function(){(new Jw.d).dismissFastViewHeader()}),Qn.d.onlyOnRanToCompletion|Qn.d.executeSynchronously),S.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):(new Jw.d).dismissFastViewHeader()},t.prototype.CreateHeader=function(){var e=window.performance.now(),n=new Vw(t._ribbonClientID,this._resizableContainer),i=n.ensureTopBarDomElement(),r=[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings],o=new it.CuiHelper(Wy.f.box4ImageBase,this._appSpecificStringsClass,null,null,r);if(this._topRowPeripheralControlCreator||(this._topRowPeripheralControlCreator=new Qw(this._standaloneRoot)),this._topRowPeripheralControlCreator.createTopRowControls(i,o,t._ribbonClientID),n.appendTopBarPeripheralElements(),!L.AFrameworkApplication.hideHeaderEmbedded){S.ULS.sendTraceTag(595855182,338,50,"Header first render time: {0} ms",Math.round(window.performance.now()-e));kI.o.initializeCuiScope(Yc.u.headerUiFocusId,null,i,!0,!0,!0);(new Jw.d).dismissFastViewHeader(),S.ULS.sendTraceTag(595732180,338,50,"Header first interactive time: {0} ms",Math.round(window.performance.now()-e))}},t.prototype.RebindTabHandlers=function(e,t,n){var i=Me.KeyInputManager.hashKey(Re.v.vK_Tab,0),r=Me.KeyInputManager.hashKey(Re.v.vK_Tab,4);e.unBindAction(i),e.unBindAction(r),e.bindAction(i,t),e.bindAction(r,n)},t.prototype.CreateFileMenu=function(){var e=!!this._ribbonTrimmingProperties&&"FileMenu"in this._ribbonTrimmingProperties.trimmedTabs;L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactFileMenuUxEnabled()&&!e&&Yw.executeWhen(1,o.i(this,this.RenderFileMenu,"RenderFileMenu"))},t.prototype.RenderFileMenu=function(){var e=new Array(0);if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var t=[(0,U.m)(new Uw,{label:CommonUIStrings.L_DiagnosticsSessionId,value:L.AFrameworkApplication.userSessionId}),(0,U.m)(new Uw,{label:CommonUIStrings.L_DiagnosticsBuild,value:L.AFrameworkApplication.buildVersion})];e.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",t))}e.push.apply(e,this.getFileMenuTrimmingActions());var n=document.createElement("div");document.body.appendChild(n),appChrome.renderFileMenu(n,e)},t.prototype.RegisterCommands=function(){this._actionManager.addAction(Fe.b.tabSwitch,ol.d.view,o.i(this,this.TabSwitch,"TabSwitch")),this._actionManager.addAction(Fe.b.ribbonModeToggled,ol.d.view,o.i(this,this.RibbonModeToggled,"RibbonModeToggled")),this._actionManager.addAction(Fe.b.ribbonModeToggledToMLR,ol.d.view,o.i(this,this.RibbonModeToggledToMLR,"RibbonModeToggledToMLR")),this._actionManager.addAction(Fe.b.ribbonModeToggledToSLR,ol.d.view,o.i(this,this.RibbonModeToggledToSLR,"RibbonModeToggledToSLR"))},t.prototype.activateRibbonTab=function(e){this.activateAndSetCurrentContextualTab(e)},t.prototype.addTabData=function(e,t){},t.prototype.initializeRibbonStore=function(){var e=[];this._shouldShowActionButtonInRibbon&&e.push(this.getShowActionButtonStoreAction("Share")),this._ribbonTrimmingProperties&&(e.push.apply(e,this.getTrimmedIdsHideActions()),"FileMenu"in this._ribbonTrimmingProperties.trimmedTabs&&e.push(appChrome.actions.updateFileMenuHiddenValue(!0))),this.setUlsExternalLogger(),Ln.AppChromeUtils.apiExists("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(L.AFrameworkApplication.get_staticContentScriptNameBase()),e.push.apply(e,this.getPollForStateAndUpdateActions()),Ln.AppChromeUtils.appChromeContainsAction("setControlBehaviorAttached")&&e.push(appChrome.actions.setControlBehaviorAttached(!0)),appChrome.api.dispatch(e),ar.r.get_instance().setAppInitializationStatus(7),sn.e.get_instance().addDurationMetric(ln.c.appInitStart,ln.c.ribbonInteractiveReady,(new Date).getTime())},t.prototype.pollForStateUpdate=function(){ar.r.get_instance().isCompleted(7)&&this._generalCuiUser&&(Dr.t.mark(4893),Ef.StylePreviewGenerator.updatePreviewCssWithCurrentStyleSet(),e.prototype.pollForStateUpdate.call(this),Dr.t.mark(4894))},t.prototype.saveMinimizedStateToCookie=function(){},t.prototype.TabSwitch=function(e,t,n,i,r){var o=r;if(2===o[fc.z.inputMethod]){var a=(0,y.e)(yh.k,t),l=null;if(!a)return S.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(t),e,P.j.join(o," ",":")),8;if(!(l=(0,y.e)($w.p,a.view))||""===l.get_focusScopeId())return S.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(a.view),e,P.j.join(o," ",":"),this.GetInteractiveViewType(a.view)),8;this._focusManager.setScope(l.get_focusScopeId())}return 32},t.prototype.RibbonModeToggled=function(e,t,n,i,r){return 1===n?32:t.get_contextId()!==ol.d.view?2:(this.SetRibbonPreferenceCookie("true"===r.On.toString()),this.pollForStateUpdate(),32)},t.prototype.RibbonModeToggledToMLR=function(e,t,n,i,r){return 1===n?32:t.get_contextId()!==ol.d.view?2:(this.SetRibbonPreferenceCookie(!0),this.pollForStateUpdate(),32)},t.prototype.RibbonModeToggledToSLR=function(e,t,n,i,r){return 1===n?32:t.get_contextId()!==ol.d.view?2:(this.SetRibbonPreferenceCookie(!1),this.SetSLREnabledCookie(),this.pollForStateUpdate(),32)},t.prototype.SetSLREnabledCookie=function(){var e=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("IsSimplifiedRibbonOnCookieName");re.z.setWithExpiration(e,"true",re.z.maxComplianceAllowedRetentionInDays)},t.prototype.SetRibbonPreferenceCookie=function(e){var t=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("ReactRibbonMLRPreferenceCookieName");re.z.setWithExpiration(t,e.toString(),re.z.maxComplianceAllowedRetentionInDays)},t.prototype.GetInteractiveViewType=function(e){return e?"is ContentEditableView: "+e.get_isContentEditableView()+" is Editing View: "+e.get_isEditingView()+" is FishbowlView: "+e.get_isFishbowlView()+" is HtmlView: "+e.get_isHtmlView()+" is InteractiveView: "+e.get_isInteractiveView()+" is NavigationPaneView: "+e.get_isNavigationPaneView()+" is PageView: "+e.get_isPageView()+" is WordNavigationPaneHeadingsView "+e.get_isWordNavigationPaneHeadingsView():"null view"},t._ribbonClientID="WACRibbon",t}(xw);(0,o.l)(Zw,"4a599fd7$ReactRibbonUser",xw,[lw.s,sw,uw.j,Sys.IDisposable]);var ex=n(5933),tx=function(e){function t(t,n,i,r,o,a,l,s,u,c,d,g){var p=this;return p._shouldShowActionButtonInRibbon$3=!1,(p=e.call(this,t,n,i,r,o,a,l,s,u,c,d,!1,g)||this)._shouldShowActionButtonInRibbon$3=d.shouldShowActionButtonInRibbon(),p.SetupSimplifiedRibbonPlaceholderForRibbonPanel(),p.SetupFlexBoxForMainPanel(),p}return(0,v.t)(t,e),t.prototype.initializeRibbon=function(){ar.r.get_instance().setAppInitializationStatus(5),ar.r.get_instance().executeWhen(10,o.i(this,this.InitializeFullRibbon,"InitializeFullRibbon"),Qn.d.onlyOnRanToCompletion|Qn.d.executeSynchronously)},t.prototype.InitializeFullRibbon=function(){var e=this;appChrome.getLazyRibbonInitializationActions().then((function(t){return e._shouldShowActionButtonInRibbon$3&&t.push(e.getShowActionButtonStoreAction("Share")),e._ribbonTrimmingProperties&&t.push.apply(t,e.getTrimmedIdsHideActions()),t.push.apply(t,e.getPollForStateAndUpdateActions()),t.push(appChrome.actions.setControlBehaviorAttached(!0)),appChrome.api.dispatch(t),e.addBindCommandHandlerCallback(),e.buildAndSetJewel(),e.initializeFocusManager(),ar.r.get_instance().setAppInitializationStatus(7),sn.e.get_instance().addDurationMetric(ln.c.appInitStart,ln.c.ribbonInteractiveReady,(new Date).getTime()),e.logRibbonLoaded(),null}))},t.prototype.SetupFlexBoxForMainPanel=function(){var e=yi.App.get_activeAppFrame().getDOMElement();Sys.UI.DomElement.removeCssClass(e,t.WACFlexLayoutClass),Sys.UI.DomElement.addCssClass(e,t.OneNoteSimplifiedAppClass);var n=document.getElementById(t.AppHeaderPanel);if(Sys.UI.DomElement.addCssClass(n,t.SimplifiedHeaderClass),!L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteOreoIsEnabled")&&!ex.AppFrame.isGridLayoutEnabled()){var i=document.getElementById(t.WACNavPane),r=document.getElementById(Yc.u.documentPanelId),o=document.createElement("div");o.id=t.MainPanel,o.className=t.MainPanel,o.appendChild(i),o.appendChild(r),yi.App.get_activeAppFrame().get_wacInnerFrame().appendChild(o)}},t.prototype.SetupSimplifiedRibbonPlaceholderForRibbonPanel=function(){var e=document.getElementById(t.WACRibbonPlaceholder);if(e){e.style.height="73px";var n=document.createElement("div");n.id=t.OneLineRibbonUpper,n.className=t.OneLineRibbonUpper,e.appendChild(n);var i=document.createElement("div");i.id=t.OneLineRibbonLower,i.className=t.OneLineRibbonLower,e.appendChild(i)}},t.AppHeaderPanel="AppHeaderPanel",t.MainPanel="OneNoteMainPanel",t.OneLineRibbonLower="oneLineRibbonLower",t.OneLineRibbonUpper="oneLineRibbonUpper",t.OneNoteSimplifiedAppClass="OneNoteAppSimplified",t.OreoInnerFrame="OreoInnerFrame",t.SimplifiedHeaderClass="SimplifiedHeader",t.WACFlexLayoutClass="FlexBoxLayout",t.WACNavPane="applicationWACNavigationPanel",t.WACRibbonPlaceholder="WACRibbonPlaceholder",t.OneLineRibbonPlaceholderHeight=73,t}(Zw);(0,o.l)(tx,"91c7f7$ReactRibbonUser",Zw,[]);var nx=function(){return function(){this.accessibilityTextCommand=null,this.command=null,this.commandMenuClose=null,this.commandMenuOpen=null,this.menuControlExecutedCommand=null,this.onInteractionBegin=null,this.onRestoreFocus=null,this.onInputBoxFocus=null,this.onInputBoxBlur=null,this.populateQueryCommand=null,this.populateAsyncTriggerCommand=null,this.altText=null,this.placeHolderText=null,this.keytip=null}}();(0,o.l)(nx,"c4909782$TellMeSearchBoxInfo",null,[]);var ix=n(2854),rx=function(e){function t(){var t=e.call(this)||this;return t.showJewelId=null,t.jewelBuildOptions=null,t.displayMinimized=!1,t.staticUiTouchMode=!1,t.isSingleRowLayoutRibbon=!1,t}return(0,v.t)(t,e),t}(ix.l);(0,o.l)(rx,"608cf8f9$RibbonBuildOptions",ix.l,[]);var ox=n(1763),ax=n(8957),lx=n(7505),sx=n(6084),ux=(0,o.y)("17fdd5f6$IKeytipManager"),cx=n(7391),dx=n(713),gx=n(5642),px=function(){return function(e,t){this.component=null,this.next=null,this.component=e,this.next=t}}();(0,o.l)(px,"d5205897$ComponentStackNode",null,[]);var hx=function(){function e(){this._top=null}return e.prototype.push=function(e){var t=new px(e,this._top);this._top=t},e.prototype.pop=function(){if(this.get_isEmpty())return null;var e=this._top.component;return this._top=this._top.next,e},e.prototype.peek=function(){return this.get_isEmpty()?null:this._top.component},e.prototype.clear=function(){this._top=null},e.prototype.get_isEmpty=function(){return!this._top},e}();(0,o.l)(hx,"8ffe2577$ComponentStack",null,[]);var _x=n(2785),mx=n(6864),fx=function(){function e(e,t,n){this._ribbon=null,this._keyInputManager=null,this._pointerInputManager=null,this._displayedKeytips=null,this._layerStack=null,this._launcherWithFocus=null,this._inKeytipMode=!1,this._isMenuOpen=!1,this._inputStringCache=null,this.$$pf_OnExitCallback=null,this._generatedKeytipCounter=1,this._ribbon=e,this._keyInputManager=t,this._pointerInputManager=n,this._displayedKeytips=new C.c(cx.s),this._layerStack=new hx,this._inKeytipMode=!1,this._inputStringCache="",this.set_onExitCallback(null)}return e.prototype.get_DisplayedKeytips=function(){return this._displayedKeytips},e.prototype.get_LayerStack=function(){return this._layerStack},e.prototype.get_InputStringCache=function(){return this._inputStringCache},e.prototype.get_inKeytipMode=function(){return this._inKeytipMode},e.prototype.get_KeytipZIndex=function(){return this._ribbon?this._ribbon.get_tabPoppedUp()?this._ribbon.get_activeModalUIZIndex()+2:this._ribbon.get_activeModalUIZIndex()-2:0},e.prototype.get_onExitCallback=function(){return this.$$pf_OnExitCallback},e.prototype.set_onExitCallback=function(e){return this.$$pf_OnExitCallback=e,e},e.prototype.enterKeytipMode=function(){this._inKeytipMode||(S.ULS.sendTraceTag(19961422,340,50,"Entering keytip mode"),this._inKeytipMode=!0,this._isMenuOpen=!1,this._ribbon.prepareToEnterKeytipMode(),this.ShowChildKeytipsForParent(this._ribbon),this.RegisterHandlers())},e.prototype.exitKeytipMode=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this._inKeytipMode&&(S.ULS.sendTraceTag(19961423,340,50,"Exiting keytip mode"),this._inKeytipMode=!1,this.HideKeytips(),this._layerStack.clear(),this._ribbon.prepareToExitKeytipMode(t),this.UnregisterHandlers(),!e&&this.get_onExitCallback()&&this.get_onExitCallback()())},e.prototype.RegisterHandlers=function(){this._keyInputManager.registerHandlerWithCaptureOption(me.d.keyDown,this._ribbon.get_elementInternal(),o.i(this,this.KeyDownHandler,"KeyDownHandler"),!0),this._pointerInputManager.registerHandlerWithCaptureOption(me.d.pointerDown,this._ribbon.get_elementInternal(),o.i(this,this.PointerDownHandler,"PointerDownHandler"),!0),this._keyInputManager.registerHandler(me.d.keyPress,this._ribbon.get_elementInternal(),o.i(this,this.KeyPressHandler,"KeyPressHandler"))},e.prototype.UnregisterHandlers=function(){this._keyInputManager.unregisterHandlerWithCaptureOption(me.d.keyDown,this._ribbon.get_elementInternal(),o.i(this,this.KeyDownHandler,"KeyDownHandler"),!0),this._pointerInputManager.unregisterHandlerWithCaptureOption(me.d.pointerDown,this._ribbon.get_elementInternal(),o.i(this,this.PointerDownHandler,"PointerDownHandler"),!0),this._keyInputManager.unregisterHandler(me.d.keyPress,this._ribbon.get_elementInternal(),o.i(this,this.KeyPressHandler,"KeyPressHandler"))},e.prototype.ShowChildKeytipsForParent=function(e){if(e){if(this.HideKeytips(),this._inputStringCache="",this._layerStack.push(e),this.IsMenuComponent(e))this.showKeytipsForMenu(this.GetMenuLauncherFromComponent(e));else{if(e.get_children())for(var t=e.get_children().getEnumerator();t.moveNext();){var n=t.get_current();if(o.r(_x.Group,n)){var i=n;this.ShowKeytipsForGroup(i)}else n.get_HasKeytip()&&this.ShowComponentKeytip(n)}e===this._ribbon&&(this._ribbon.setFocusOnCurrentTabTitle(),this._ribbon.dismissTabPopup(!1),this._ribbon.get_jewelDisplayedComponent()&&this.ShowComponentKeytip(this._ribbon.get_jewelDisplayedComponent()),this.ShowKeytipsForStandaloneRoot())}this._displayedKeytips.get_count()||this.IsABacktrackingComponent(e)||this.exitKeytipMode()}},e.prototype.ShowKeytipsForStandaloneRoot=function(){var e=this._ribbon.get_theStandaloneRoot();if(e&&e.get_controls()){var t=e.get_controls();for(var n in t){var i={key:n,value:t[n]}.value;i.get_displayedComponent()&&this.ShowComponentKeytip(i.get_displayedComponent())}}},e.prototype.ShowKeytipsForGroup=function(e){if(e&&e.get_SelectedLayout()){for(var t=e.get_SelectedLayout().get_children().getEnumerator();t.moveNext();)for(var n=t.get_current().get_children().getEnumerator();n.moveNext();)for(var i=n.get_current().get_children().getEnumerator();i.moveNext();){var r=i.get_current();if(o.r(po.r,r)){var a=r;this.ShowComponentKeytip(a)}}e.get_hasElementDialogLauncherComponent()&&this.ShowComponentKeytip(e.get_elementDialogLauncherComponent())}},e.prototype.showKeytipsForMenu=function(e){if(e&&e.menuLaunched){for(var t=e.get_menu().get_children().getEnumerator();t.moveNext();)for(var n=t.get_current().get_children().getEnumerator();n.moveNext();){var i=n.get_current();this.ShowComponentKeytip(i)}this._isMenuOpen=!0}},e.prototype.ShowKeytipsFromList=function(e){for(var t=e.$$lge();t.$$mn();){var n=t.$$cu();this.ShowComponentKeytip(n)}},e.prototype.ShowComponentKeytip=function(e){e.ShowKeytip(this.get_KeytipZIndex())&&this._displayedKeytips.add(e)},e.prototype.HideKeytips=function(){for(var e=this._displayedKeytips.$$lge();e.$$mn();){var t=e.$$cu();!o.r(mx.Tab,t)&&o.r(po.r,t),t.HideKeytip()}this._displayedKeytips.clear()},e.prototype.ExitCurrentLayer=function(){if(this._layerStack.pop(),this._layerStack.get_isEmpty())this.exitKeytipMode(!1);else{this.HideKeytips();var e=this._layerStack.pop();this.IsMenuComponent(e)?this._launcherWithFocus=this.GetMenuLauncherFromComponent(e):this._isMenuOpen=!1,this.ShowChildKeytipsForParent(e)}},e.prototype.IsMenuComponent=function(e){return o.r(po.r,e)&&!!e.get_control()&&o.r(hr.MenuLauncher,e.get_control())},e.prototype.GetMenuLauncherFromComponent=function(e){return e.get_control()},e.prototype.KeyDownHandler=function(e){if(!this._inKeytipMode)return!1;var t=!1;if(!_r.n.isNullOrUndefined(e.innerEvent))switch(e.innerEvent.keyCode){case Re.v.vK_Esc:this.ExitCurrentLayer(),t=!0;break;case Re.v.vK_Tab:this.exitKeytipMode(void 0,!1),t=!1;break;case Re.v.vK_Enter:case Re.v.vK_Space:this.exitKeytipMode(void 0,!1),t=!0}return t},e.prototype.KeyPressHandler=function(e){if(!this._inKeytipMode)return!1;var t=!1;if(!_r.n.isNullOrUndefined(e.innerEvent)){var n=Me.KeyInputManager.getFieldFromDomEvent(e.innerEvent,"charCode")||Me.KeyInputManager.getKeyCodeFromDomEvent(e.innerEvent),i=String.fromCharCode(n).toUpperCase(),r=this.FindComponentToActivate(i);t=(t=o.r(mx.Tab,r)?this.SwitchTab(r):o.r(po.r,r)?this.ExecuteControlDefaultAction(r,e):this.FilterKeytips(i))||this._isMenuOpen}return t},e.prototype.PointerDownHandler=function(e){return!!this._inKeytipMode&&(this.exitKeytipMode(void 0,!1),!0)},e.prototype.FindComponentToActivate=function(e){for(var t=this._inputStringCache+e,n=this._displayedKeytips.$$lge();n.$$mn();){var i=n.$$cu();if(i.get_keytip()&&i.get_keytip().get_key()===t)return i}return null},e.prototype.FilterKeytips=function(e){for(var t=new C.c(cx.s),n=this._displayedKeytips.$$lge();n.$$mn();){var i=n.$$cu(),r=i.get_keytip().get_key();i.get_Enabled()&&e===r.substr(this._inputStringCache.length,1)&&t.add(i)}return t.get_count()>0&&(this.HideKeytips(),this.ShowKeytipsFromList(t),this._inputStringCache+=e,!0)},e.prototype.SwitchTab=function(e){return e.SetFocusOnTitle(),this.LogKeytipExecution(e.get_id(),"tab"),e.DoTitleDefaultAction(1),this._ribbon.setFocusOnCurrentTabTitle(),this.ShowChildKeytipsForParent(e),!0},e.prototype.ExecuteControlDefaultAction=function(e,t,n){if(void 0===n&&(n=!0),!e.get_Enabled())return!1;if(e.get_control().setFocusOnControl(),n&&this.LogKeytipExecution(e.get_control().get_id(),e.get_control().get_controlType()),this.IsAnEditableComponent(e))this.exitKeytipMode(void 0,!1);else if(e.get_control().behavior.doDefaultAction(t.get_sourceElement(),t.get_inputSource(),t.innerEvent),this.IsMenuComponent(e))if(this._launcherWithFocus=this.GetMenuLauncherFromComponent(e),this._launcherWithFocus.get_menu()&&this._launcherWithFocus.get_menu().get_elementInternal()){for(var i=this._launcherWithFocus.get_menu().get_menuLauncherChildren().getEnumerator();i.moveNext();){i.get_current().onMenuLaunchCallback=o.i(this,this.OnMenuLaunch,"OnMenuLaunch")}this._launcherWithFocus.onMenuCloseCallback=o.i(this,this.OnMenuClose,"OnMenuClose"),this._keyInputManager.registerHandler(me.d.keyDown,this._launcherWithFocus.get_menu().get_elementInternal(),o.i(this,this.KeyDownHandler,"KeyDownHandler")),this._keyInputManager.registerHandler(me.d.keyPress,this._launcherWithFocus.get_menu().get_elementInternal(),o.i(this,this.KeyPressHandler,"KeyPressHandler")),this.ShowChildKeytipsForParent(e)}else{var r=this._launcherWithFocus.get_menu()?this._launcherWithFocus.get_menu().get_id():"";S.ULS.sendTraceTag(19797896,340,10,"Unexpected null menu (id: "+r+") element; cannot invoke keytip")}else this.exitKeytipMode(L.AFrameworkApplication.get_theTaskManager().get_isYielding());return!0},e.prototype.OnMenuLaunch=function(e,t){this.ExecuteControlDefaultAction(e,t,!1)},e.prototype.OnMenuClose=function(e){void 0===e&&(e=!0),this._launcherWithFocus&&this._launcherWithFocus.get_menu()&&this._launcherWithFocus.get_menu().get_elementInternal()&&(this._keyInputManager.unregisterHandler(me.d.keyDown,this._launcherWithFocus.get_menu().get_elementInternal(),o.i(this,this.KeyDownHandler,"KeyDownHandler")),this._keyInputManager.unregisterHandler(me.d.keyPress,this._launcherWithFocus.get_menu().get_elementInternal(),o.i(this,this.KeyPressHandler,"KeyPressHandler")),e?(this._isMenuOpen=!1,this._launcherWithFocus=null,this.exitKeytipMode()):this.ExitCurrentLayer())},e.prototype.IsABacktrackingComponent=function(e){return this._isMenuOpen&&!this.IsAnEditableComponent(e)},e.prototype.IsAnEditableComponent=function(e){if(o.r(po.r,e)){var t=e.get_control();return o.r(dx.r,t)||o.r(Or.y,t)||o.r(gx.p,t)}return!1},e.prototype.LogKeytipExecution=function(e,t){S.ULS.sendTraceTag(19961424,340,50,"Executing keytip for {0} component (id: {1})",t,e)},e.prototype.getNewGeneratedKeytipString=function(){return this.GetNewGeneratedKeytipStringInternal(this._generatedKeytipCounter++)},e.prototype.GetNewGeneratedKeytipStringInternal=function(e){if(e<1)return null;for(var t=new Sys.StringBuilder,n=0;n<Math.ceil(e/9);n++)t.append(CommonUIStrings.l_AddInKeytip);return t.append(e%9?e%9:9),t.toString()},e}();(0,o.l)(fx,"4e9d45f$KeytipManager",null,[ux]);var yx=n(2863),Cx=function(){function e(e,t,n,i){if(this._groupId=null,this._layoutName=null,this._scaleWarningMessage=null,this._warnForScale=!1,this._scalingInfo=null,_r.n.isNullOrUndefined(e)||_r.n.isNullOrUndefined(t))throw Error.create("groupId, layoutName and message cannot be undefined or null");this._groupId=e,this._layoutName=t,this._scaleWarningMessage=n,this._warnForScale=i}return e.prototype.SetParent=function(e){this._scalingInfo=e},e.prototype.get_groupId=function(){return this._groupId},e.prototype.get_layoutName=function(){return this._layoutName},e.prototype.get_scaleWarningMessage=function(){return this._scaleWarningMessage},e.prototype.get_hasScaleWarning=function(){return this._warnForScale},e.prototype.get_previousLayoutName=function(){if(_r.n.isNullOrUndefined(this._scalingInfo))return null;for(var e=this._scalingInfo.getGroupMaxSize(this._groupId),t=this._scalingInfo.get_stepsInternal(),n=0;n<t.length;n++){var i=t[n];if(i===this)break;i.get_groupId()===this._groupId&&(e=i.get_layoutName())}return e},e}();(0,o.l)(Cx,"95d172ca$ScalingStep",null,[]);var Sx=function(){return function(){}}();(0,o.l)(Sx,"a4863cb5$Template",null,[]);var bx=function(){return function(){this.ribbon=null,this.controls=null,this.parameters=null}}();(0,o.l)(bx,"4f6e75ee$DeclarativeTemplateBuildContext",null,[]);var vx=function(e){function t(t){var n=e.call(this)||this;return n._data=null,n._data=new ox.o(t),n}return(0,v.t)(t,e),t.prototype.createGroup=function(e,t,n,i,r,o,a,l,s){var u=new bx;u.ribbon=e,u.controls=a,u.parameters=l;for(var c=e.CreateGroup(t,n,i,r,o,s),d=0;d<this._data.get_children().length;d++){var g=this.CreateLayoutFromData(this._data.get_children()[d],c,u);_r.n.isNullOrUndefined(g)||c.addChild(g)}return c},t.prototype.CreateLayoutFromData=function(e,t,n){var i=e[ox.o.ATTRIBUTES][ox.o.TITLE],r=n.ribbon.CreateLayout(t.get_id()+"-"+i,i,t.get_visible());return r.SetDelayedInitData(o.i(this,this.DelayInitLayout,"DelayInitLayout"),e,n),r},t.prototype.DelayInitLayout=function(e,t,n){var i=e,r=n;return this.FillLayout(t,i,r),i.OnDelayedInitFinished(!0),i},t.prototype.FillLayout=function(e,t,n){for(var i=e[ox.o.CHILDREN],r=0,o=0;o<i.length;o++){if(i[o][ox.o.NAME]===ox.o.SECTION){var a=this.CreateSectionFromData(i[o],n,t,r++);t.addChild(a)}}},t.prototype.CreateSectionFromData=function(e,t,n,i){var r,o=e[ox.o.ATTRIBUTES][ox.o.TYPE],a=e[ox.o.ATTRIBUTES][ox.o.ALIGNMENT],l=(e[ox.o.ATTRIBUTES][ox.o.HORIZONTALALIGNMENT],e[ox.o.ATTRIBUTES][ox.o.SHOWECTIONSEPERATOR]);switch(o){case ox.o.ONEROW:r=2;break;case ox.o.TWOROW:r=3;break;case ox.o.THREEROW:r=4;break;case ox.o.DIVIDER:r=1;break;default:throw Error.create('Invalid Section attribute "Type" found in XML: '+o)}var s=1;"Middle"===a&&(s=2);var u=!!l&&Boolean.parse(l),c=t.ribbon.CreateSection(n.get_id()+"-"+i,r,s,1,u,n.get_visible());return 1!==r&&(this.HandleRow(c.getRow(1),e[ox.o.CHILDREN][0],t),3!==c.get_type()&&4!==c.get_type()||this.HandleRow(c.getRow(2),e[ox.o.CHILDREN][1],t),4===c.get_type()&&this.HandleRow(c.getRow(3),e[ox.o.CHILDREN][2],t)),c},t.prototype.HandleRow=function(e,t,n){for(var i=t[ox.o.CHILDREN],r=0;r<i.length;r++){var o=null;i[r][ox.o.NAME]===ox.o.CONTROL&&(o=this.CreateControlComponentFromData(i[r],n)),_r.n.isNullOrUndefined(o)||e.addChild(o)}},t.prototype.CreateControlComponentFromData=function(e,t){var n=e[ox.o.ATTRIBUTES],i=n[ox.o.TEMPLATEALIAS],r=n[ox.o.DISPLAYMODE],a=t.controls[i],l=null;return!_r.n.isNullOrUndefined(a)&&o.r(cr.Control,a)&&(l=a.createComponentForDisplayMode(r)),l},t}(Sx);(0,o.l)(vx,"a61f6687$DeclarativeTemplate",Sx,[]);var Tx=function(){function e(){this._templates=null,this._templates={}}return e.prototype.addTemplate=function(e,t){this._templates[t]=e},e.prototype.removeTemplate=function(e){this._templates[e]=null},e.prototype.getTemplate=function(e){return this._templates[e]},e.prototype.loadTemplates=function(e){for(var t=ox.o.getFirstChildNodeWithName(e,ox.o.RIBBONTEMPLATES),n=ox.o.getNodeChildren(t),i=0;i<n.length;i++)this.LoadGroupTemplate(n[i])},e.prototype.LoadGroupTemplate=function(e){var t=new ox.o(e),n=t.get_attributes()[ox.o.id],i=t.get_attributes()[ox.o.CLASSNAME];_r.n.isNullOrUndefined(this._templates[n])&&_r.n.isNullOrUndefined(i)&&(this._templates[n]=new vx(e))},e.get_instance=function(){return _r.n.isNullOrUndefined(e._instance)&&(e._instance=new e),e._instance},e._instance=null,e}();(0,o.l)(Tx,"aa2d29a6$TemplateManager",null,[]);var Ax=function(e){function t(t,n,i,r){var o=e.call(this,t,n,ut.Task.fromResult(uw.j,i),r)||this;if(o._keytipManager=null,_r.n.isNullOrUndefined(n))throw Error.create("Ribbon placeholder DOM element is null or undefined.");return S.ULS.sendTraceTag(34468253,340,50,"User is booting the Classic Ribbon"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(Fe.b.reportLegacyRibbonLoaded,Ue.m.frame,Le.ActionManager.doNothingButReportHandler,96),L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.reportLegacyRibbonLoaded,2),o}return(0,v.t)(t,e),t.prototype.get_ribbon=function(){return this.get_root()},t.prototype.set_ribbon=function(e){return this.set_root(e),e},t.prototype.get_RibbonBuildOptions=function(){return this.get_options()},t.prototype.get_TableOfContentUpdateIsEnabled=function(){return!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordEditorTableOfContentUpdateIsEnabled")&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordEditorAutoSaveParametersIsEnabled")},t.prototype.buildRibbonAndInitialTab=function(e){if(_r.n.isNullOrUndefined(e))throw Error.create("Initial tab for ribbon is null or undefined");if(this.get_inQuery())return!1;var t=new yx.x;t.initialTabId=e,this.set_inQuery(!0);var n=new ax.v;return n.id=t.initialTabId,n.queryType=2,n.handler=o.i(this,this.OnReturnRibbonAndInitialTab,"OnReturnRibbonAndInitialTab"),n.data=t,this.get_dataSource().runQuery(n),ar.r.get_instance().setAppInitializationStatus(10),!0},t.prototype.buildRibbonFromData=function(e,t){var n=new yx.x;n.initialTabId=t;var i=new lx.r;i.success=!0,i.queryData=e,i.contextData=n,this.OnReturnRibbonAndInitialTab(i)},t.prototype.rebuildGroupsInTab=function(e){var t=new ax.v,n=new lx.r;t.id=e,t.queryType=2,t.handler=function(e){n=e},this.get_dataSource().runQuery(t);var i=new yx.x;i.initialTabId=this.get_ribbon().get_HomeTab().get_id(),i.initializedTab=this.get_ribbon().get_HomeTab();for(var r=ox.o.getFirstChildNodeWithName(n.queryData,ox.o.RIBBON),o=new ox.o(r),a=ox.o.getNodeChildren(ox.o.getFirstChildNodeWithName(o.get_node(),ox.o.TABS)),l=0;l<a.length;l++){var s=a[l];if(new ox.o(s).get_attributes()[ox.o.id]===e){for(var u=ox.o.getFirstChildNodeWithName(s,ox.o.GROUPS),c=ox.o.getNodeChildren(u),d=this.get_ribbon().GetChild(e),g=0;g<c.length;g++){var p=ox.o.getNodeAttribute(c[g],ox.o.id);_r.n.isNullOrUndefined(p)||_r.n.isNullOrUndefined(d.GetChild(p))||(d.removeChild(p),d.get_scaling().removeGroupMaxSize(p),d.get_scaling().removeScalingStepWithGroupId(p))}this.AddGroupToRibbon(e,s,i);break}}},t.prototype.rebuildJewel=function(){_r.n.isNullOrEmptyString(this.get_RibbonBuildOptions().showJewelId)||this.get_ribbon().RebuildAndSetJewel(this.get_RibbonBuildOptions().showJewelId,this.get_dataSource())},t.prototype.AddTabToRibbon=function(e,t,n){void 0===n&&(n=-1);var i=[];i[0]=e,this.AddTabsToRibbon(i,null,t,!0,n)},t.prototype.AddGroupToRibbon=function(e,t,n){var i=this.get_ribbon().GetChild(e);this.FillTab(i,t,n,!0),i.refreshInternal()},t.prototype.RemoveGroupAndTabFromRibbon=function(e,t){var n=this.get_ribbon().GetChild(e);if(n&&n.GetChild(t)){n.removeChild(t),n.get_scaling().removeGroupMaxSize(t),n.get_scaling().removeScalingStepWithGroupId(t);for(var i=n.get_children().getEnumerator();i.moveNext();){i.get_current();return}this.get_ribbon().removeChild(e)}},t.prototype.OnReturnRibbonAndInitialTab=function(e){var t=this,n=e.contextData;fr.n.ensureCSSClassOnElement(this.get_placeholder(),"loaded");var i=ox.o.getFirstChildNodeWithName(e.queryData,ox.o.TEMPLATES);_r.n.isNullOrUndefined(i)||Tx.get_instance().loadTemplates(i),this.set_ribbon(this.BuildRibbon(e.queryData,n)),this.get_ribbon().set_RibbonBuilder(this);var r=this.get_RibbonBuildOptions().displayMinimized;this.get_ribbon().set_MinimizedInternal(r);var o=this.get_ribbon().GetChild(n.initialTabId);this.get_ribbon().set_HomeTab(o),r||this.get_ribbon().MakeTabSelectedInternal(o),this.get_ribbon().set_ClientID(this.get_RibbonBuildOptions().clientID),this.get_ribbon().ensureDOMElement(),_r.n.isNullOrEmptyString(this.get_RibbonBuildOptions().showJewelId)||this.get_ribbon().BuildAndSetJewel(this.get_RibbonBuildOptions().showJewelId,this.get_dataSource()),fr.n.RemoveChildNodesSlow(this.get_placeholder()),this.get_placeholder().appendChild(this.get_ribbon().get_elementInternal()),this.get_ribbon().Scale(),this.get_buildClientTask().CWo((function(e){t.get_buildClientTask().get_result().onComponentBuilt(t.get_ribbon(),t.get_ribbon().get_id())}),Qn.d.onlyOnRanToCompletion|Qn.d.executeSynchronously)},t.prototype.OnReturnTab=function(e){var t=e.contextData;if(e.success){var n=ox.o.getFirstChildNodeWithName(e.queryData,ox.o.TAB);if(!n)return;var i=ox.o.getFirstChildNodeWithName(e.queryData,ox.o.TEMPLATES);i&&Tx.get_instance().loadTemplates(i),this.FillTab(t.initializedTab,n,t),t.initializedTab.OnDelayedInitFinished(!0)}},t.prototype.BuildRibbon=function(e,t){var n=ox.o.getFirstChildNodeWithName(e,ox.o.RIBBON);if(_r.n.isNullOrUndefined(n))throw Error.create("No ribbon element was present in the data");var i=new ox.o(n);this.set_ribbon(new Qr.Ribbon(i.get_attributes().Id,i.get_attributes(),this.get_RibbonBuildOptions().staticUiTouchMode,this.get__resizableContainer(),this.get_RibbonBuildOptions().isSingleRowLayoutRibbon)),this._keytipManager=new fx(this.get_ribbon(),Me.KeyInputManager.get_instance(),lr.z.get_instance()),this.get_ribbon().KeytipManager=this._keytipManager,this.get_ribbon().set_useDataCookie(!0);var r=ox.o.getNodeChildren(ox.o.getFirstChildNodeWithName(i.get_node(),ox.o.TABS));this.AddTabsToRibbon(r,null,t);var o=ox.o.getFirstChildNodeWithName(i.get_node(),ox.o.CONTEXTUALTABS);if(!_r.n.isNullOrUndefined(o))for(var a=ox.o.getNodeChildren(o),l=0;l<a.length;l++)this.AddContextualGroup(a[l],t);return this.get_ribbon()},t.prototype.AddContextualGroup=function(e,t){var n=ox.o.getNodeAttributes(e),i=0,r=n[ox.o.id];switch(n[ox.o.COLOR]){case ox.o.MAGENTA:i=3;break;case ox.o.GREEN:i=2;break;case ox.o.ORANGE:i=1;break;case ox.o.PURPLE:i=5;break;case ox.o.YELLOW:i=4;break;default:i=0}this.get_ribbon().addContextualGroup(r,n[ox.o.TITLE],i,n[ox.o.COMMAND]);var o=ox.o.getNodeChildren(e);this.AddTabsToRibbon(o,n[ox.o.id],t)},t.prototype.AddTabsToRibbon=function(e,t,n,i,r){void 0===i&&(i=!1),void 0===r&&(r=-1);for(var o=this.get_TableOfContentUpdateIsEnabled(),a=0;a<e.length;a++){var l=e[a],s=new ox.o(l).get_attributes()[ox.o.id];this.IsIdTrimmed(s)?"tabReferences"!==s||-1===r||o||this.get_ribbon().AddChildAtIndex(this.BuildTab(l,n,t,i),r+a):-1!==r?this.get_ribbon().AddChildAtIndex(this.BuildTab(l,n,t,i),r+a):this.get_ribbon().addChild(this.BuildTab(l,n,t,i))}},t.prototype.BuildTab=function(e,t,n,i){var r,a=new ox.o(e),l=a.get_attributes()[ox.o.KEYTIP];return!l&&this._keytipManager&&(l=this._keytipManager.getNewGeneratedKeytipString()),r=_r.n.isNullOrUndefined(n)?this.get_ribbon().CreateTab(a.get_attributes()[ox.o.id],a.get_attributes()[ox.o.TITLE],a.get_attributes()[ox.o.DESCRIPTION],a.get_attributes()[ox.o.COMMAND],a.get_attributes()[ox.o.CSSCLASS],l):this.get_ribbon().CreateContextualTab(a.get_attributes()[ox.o.id],a.get_attributes()[ox.o.TITLE],a.get_attributes()[ox.o.DESCRIPTION],a.get_attributes()[ox.o.COMMAND],n,a.get_attributes()[ox.o.CSSCLASS],l),a.get_children().length?this.FillTab(r,e,t,i):r.SetDelayedInitData(o.i(this,this.DelayInitTab,"DelayInitTab"),a.get_node(),t.clone()),r},t.prototype.FillTab=function(e,t,n,i){void 0===i&&(i=!1);for(var r=ox.o.getFirstChildNodeWithName(t,ox.o.GROUPS),o=ox.o.getNodeChildren(r),a={},l=0;l<o.length;l++)if(!this.isNodeTrimmed(o[l])){var s=this.BuildGroup(o[l],n,e);if(_r.n.isNullOrUndefined(s)){var u=ox.o.getNodeAttribute(o[l],ox.o.id);_r.n.isNullOrUndefined(u)||(a[u]=u)}else e.addChild(s)}var c=ox.o.getFirstChildNodeWithName(t,ox.o.SCALING),d=ox.o.getNodeChildren(c),g=null,p=!1;for(l=0;l<d.length;l++){var h=ox.o.getNodeName(d[l]),_=ox.o.getNodeAttributes(d[l]),m=_[ox.o.GROUPID];if(h===ox.o.MAXSIZE){if(this.IsIdTrimmed(m)||!_r.n.isNullOrUndefined(a[m]))continue;e.get_scaling().setGroupMaxSize(m,_[ox.o.SIZE])}else if(h===ox.o.SCALE){if(this.IsIdTrimmed(m)||!_r.n.isNullOrUndefined(a[m]))continue;e.get_scaling().addScalingStep(new Cx(m,_[ox.o.SIZE],g,p),i),g=null,p=!1}else{if(h!==ox.o.LOWSCALEWARNING)throw Error.create("Was expecting a node with name MaxSize or Scale.");g=_[ox.o.MESSAGE],p=!0}}e.scaleMax()},t.prototype.AssertScaleHasMatchingGroup=function(e,t){for(var n=e.get_children().getEnumerator();n.moveNext();){if(n.get_current().get_id()===t){!0;break}}},t.prototype.DelayInitTab=function(e,t,n){var i=n,r=e,a=new ox.o(t);if(i.initializedTab=e,!a.get_hasChildren()){var l=new ax.v;return l.id=i.initializedTab.get_id(),l.queryType=3,l.handler=o.i(this,this.OnReturnTab,"OnReturnTab"),l.data=i,this.get_dataSource().runQuery(l),null}return this.FillTab(r,t,i),r.OnDelayedInitFinished(!0),this.get_ribbon().refresh(),r},t.prototype.BuildGroup=function(e,t,n){var i=new ox.o(e),r=i.get_attributes()[ox.o.TEMPLATE],a=Tx.get_instance().getTemplate(r);if(_r.n.isNullOrUndefined(a))throw Error.create("A template with name: "+r+" could not be loaded.");for(var l={},s=null,u=0;u<i.get_children().length;u++)if(i.get_children()[u][ox.o.NAME]===ox.o.CONTROLS){s=i.get_children()[u];break}if(_r.n.isNullOrUndefined(s))throw Error.create("No Controls node found in this Group tag.");var c=ox.o.getNodeChildren(s);for(u=0;u<c.length;u++)if(!this.isNodeTrimmed(c[u])){var d=this.buildControl(c[u],t);if(d){this._keytipManager&&d.get_NeedsAKeytip()&&!d.get_controlProperties().Keytip&&(d.get_controlProperties().Keytip=this._keytipManager.getNewGeneratedKeytipString()),d.parentKeytipsIds=String.format("{0} {1}{2}",sx.v.ribbonShortcutId,n.get_id(),sx.v.keytipId),d.parentKeytipsKeys=n.get_keytip().get_key().toLocaleLowerCase();var g=l[d.get_templateAlias()];_r.n.isNullOrUndefined(g)?l[d.get_templateAlias()]=d:o.r(Array,g)?Array.add(g,d):l[d.get_templateAlias()]=[g,d]}}var p=i.get_attributes()[ox.o.id],h=this.IsIdTrimmed(_x.Group.getLauncherButtonId(p));return a.createGroup(this.get_ribbon(),p,i.get_attributes(),i.get_attributes()[ox.o.TITLE],i.get_attributes()[ox.o.DESCRIPTION],i.get_attributes()[ox.o.COMMAND],l,null,h)},t.prototype.clearGlobalAppState=function(){ar.r.get_instance().clearAppInitializationStatus(10),L.AFrameworkApplication.get_theActionManager().removeAction(Fe.b.reportLegacyRibbonLoaded,Ue.m.frame,Le.ActionManager.doNothingButReportHandler)},t}(Lr.Builder);(0,o.l)(Ax,"3b1d129e$RibbonBuilder",Lr.Builder,[]);var Ix=function(){function e(e,t,n){this._appFrame=null,this._ribbon=null,this._focusManager=null,this._appFrame=e,this._ribbon=t,this._focusManager=n}return e.prototype.initialize=function(e,t){var n=this;t.addAction(Fe.b.ribbonMoveForward,Ue.m.frame,o.i(this,this.RibbonMoveForwardAction,"RibbonMoveForwardAction")),t.addAction(Fe.b.ribbonMoveBackward,Ue.m.frame,o.i(this,this.RibbonMoveBackwardAction,"RibbonMoveBackwardAction"));var i=kI.o.initializeCuiScope(Yc.u.ribbonFocusId,o.i(this,this.RibbonScopeSetFocus,"RibbonScopeSetFocus"),e,!1,!0,!0);this.RebindTabHandlers(i),i.addOnBlur(o.i(this,this.RibbonScopeOnBlur,"RibbonScopeOnBlur")),this._appFrame.get_theF6Manager().setOnBeforeF6(Yc.u.ribbonFocusId,(function(e){n._ribbon.commitAnyPendingChange()})),kI.o.initializeCuiScope(Yc.u.headerUiFocusId,null,this._ribbon.get_peripheralContentContainer(),!0,!0,!0)},e.prototype.RibbonMoveForwardAction=function(e,t,n,i,r){var o=document.activeElement,a=this._focusManager.getCurrentRegion();return o&&!this._ribbon.get_tabShowing()&&o===a.listing.get_lastElement()?(a.listing.trySetCurrentElement(o),a.moveForward()?32:8):4},e.prototype.RibbonMoveBackwardAction=function(e,t,n,i,r){var o=document.activeElement,a=this._focusManager.getCurrentRegion();return o&&o===a.listing.get_firstElement()?(a.listing.trySetCurrentElement(o),a.moveBackward()?32:8):4},e.prototype.RebindTabHandlers=function(e){var t=Me.KeyInputManager.hashKey(Re.v.vK_Tab,0),n=Me.KeyInputManager.hashKey(Re.v.vK_Tab,4);e.unBindAction(t),e.unBindAction(n),e.bindAction(t,Fe.b.ribbonMoveForward),e.bindAction(n,Fe.b.ribbonMoveBackward)},e.prototype.RibbonScopeSetFocus=function(e,t){this._appFrame&&(this._ribbon.setFocusOnCurrentTabTitle(),e.name===Pe.AFrame.modalCommandUIFocusId||e.name.endsWith("/modal")||this._ribbon.enterKeytipMode(o.i(this,this.RestoreFocusOnRibbonBlur,"RestoreFocusOnRibbonBlur")))},e.prototype.RibbonScopeOnBlur=function(e,t){this._appFrame&&t&&t.name!==Pe.AFrame.modalCommandUIFocusId&&(this._ribbon.exitKeytipMode(),this._ribbon.get_tabPoppedUp()&&this._ribbon.dismissTabPopup())},e.prototype.RestoreFocusOnRibbonBlur=function(){St.FocusManager.instance().popScope(Yc.u.ribbonFocusId)},e}();(0,o.l)(Ix,"d5a420d8$RibbonFocusManager",null,[]);var wx=n(4524),xx=function(){function e(e,t){this._commandTrimmer=null,this._wrappingTrimmer=null,this._commandTrimmer=e,this._wrappingTrimmer=t}return e.prototype.setTrimmedIds=function(e){this._commandTrimmer.setTrimmedIds(e),this._wrappingTrimmer&&this._wrappingTrimmer.setTrimmedIds(e)},e.prototype.setJewelTrimmedIds=function(e){this._commandTrimmer.setJewelTrimmedIds(e),this._wrappingTrimmer&&this._wrappingTrimmer.setJewelTrimmedIds(e)},e.prototype.updateTrimmedIds=function(e){this._commandTrimmer.updateTrimmedIds(e),this._wrappingTrimmer&&this._wrappingTrimmer.updateTrimmedIds(e)},e}();(0,o.l)(xx,"1223810d$RibbonCommandTrimmer",null,[wx.r]);var Ex=n(2598),Fx=function(){function e(){}return e.trimButtonsForInsertPicture=function(e,t,n,i,r,o){e[t]=!0,e[n]=!0,e[i]=!0,o&&r?e[i]=!1:r?e[t]=!1:o&&(e[n]=!1)},e}();(0,o.l)(Fx,"ccad2de9$SharedRibbonConfig",null,[]);var Px=function(){function e(e,t){this._appSettingsManager=null,this._ribbonDependencies=null,this._appSettingsManager=e,this._ribbonDependencies=t}return e.prototype.setTrimmedIds=function(e){if(W.y.get_isIPad()&&W.y.get_iPadOsVersion()<6&&(e.fseaInsertPicture=!0),this._appSettingsManager.getBooleanAppSetting("InsertSymbolIsEnabled")||(e.grpInsertSymbols=!0),this._appSettingsManager.getBooleanAppSetting("ClipartInsertEnabled")||(e.fseaInsertClipart=!0),this._appSettingsManager.getBooleanAppSetting("UIDiscoverabilityEnabled")||(e.jbtnAccessibilityHelp=!0),L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()){var t=this._appSettingsManager.getBooleanAppSetting("InsertOnlinePictureEnabled"),n=L.AFrameworkApplication.isInsertOnlinePictureFromHostSupported();t||(e.fseaInsertOnlinePicture=!0,e.fseaFlyInsertOnlinePictureFromSearch=!0),n||(e.fseaFlyInsertOnlinePictureFromHost=!0,e.fseaInsertOnlinePictureFromHost=!0),n&&t?(e.fseaInsertOnlinePicture=!0,e.fseaInsertOnlinePictureFromHost=!0):e.flyOnlinePicture=!0,L.AFrameworkApplication.get_trimOICButtons()&&(e.btnOpenInClient=!0)}else Fx.trimButtonsForInsertPicture(e,"fseaInsertOnlinePicture","fseaInsertOnlinePictureFromHost","flyOnlinePicture",this._appSettingsManager.getBooleanAppSetting("InsertOnlinePictureEnabled"),L.AFrameworkApplication.isInsertOnlinePictureFromHostSupported()),this.setJewelTrimmedIds(e)},e.prototype.setJewelTrimmedIds=function(e){e.menuJewel=!0,L.AFrameworkApplication.showFeedbackButton||(e.jbtnGiveFeedback=!0)},e.prototype.updateTrimmedIds=function(e){delete e.menuJewel,L.AFrameworkApplication.privacyUrl||(e.jbtnPrivacy=!0),L.AFrameworkApplication.reportAbuseUrl||(e.jbtnReportAbuse=!0),L.AFrameworkApplication.termsUrl||(e.jbtnTermsOfUse=!0),L.AFrameworkApplication.fileShareEnabled||(e.jbtnFileSharing=!0),Gl.n.get_instance().get_item(50)&&L.AFrameworkApplication.replyWithChangesUrl||(e.jbtnShareRWC=!0),Gl.n.get_instance().get_item(58)&&(L.AFrameworkApplication.fileVersionUrl||L.AFrameworkApplication.useFileVersionPostMessage)||(e.jbtnVersion=!0),this._ribbonDependencies.officeTrialExperience&&this._ribbonDependencies.officeTrialExperience.get_offerOfficeTrialInFileMenu()||(e.btnjTryOffice=!0,e.btnjTryOfficeForWordEditor=!0),this._ribbonDependencies.macOfficeOffer&&this._ribbonDependencies.macOfficeOffer.get_shouldOfferMacOfficeTrialInFileMenu()||(e.btnjTryMacOffice=!0,e.btnjTryMacOfficeForWordEditor=!0),L.AFrameworkApplication.get_trimOICButtons()?(e.btnjOpenInClient=!0,e.btnjEditInClient=!0):Gl.n.get_instance().get_item(58)&&(e[yi.App.get_canEdit()?"btnjOpenInClient":"btnjEditInClient"]=!0),L.AFrameworkApplication.get_trimDownloadACopy()&&(e.jbtnDownloadACopy=!0,e.jbtnDownloadAsPdf=!0,e.jbtnDownloadAsOdt=!0),!L.AFrameworkApplication.get_protectFile()&&Gl.n.get_instance().get_item(52)&&(L.AFrameworkApplication.hostEmbeddedViewUrl||L.AFrameworkApplication.fileEmbedCommandUrl||L.AFrameworkApplication.useFileEmbedCommandPostMessage)||(e.jbtnFileEmbed=!0),Ex.f.includeCloseButton()||(e.btnjClose=!0),L.AFrameworkApplication.isVersionHistorySupported()||(e.btnjVersionHistory=!0),Gl.n.get_instance().get_item(58)?e.jbtnVersion&&e.btnjVersionHistory&&e.btnjOpenInClient&&(!Gl.n.get_instance().get_item(58)||e.btnjEditInClient)&&(e.faInfo=!0):e.btnjOpenInClient&&(e.faInfo=!0),L.AFrameworkApplication.get_readFromMruIsEnabled()||(e.faOpen=!0),e.jbtnFileSharing&&e.jbtnFileEmbed&&e.jbtnShareRWC&&(e.faShare=!0),e.AboutInformationMenuSectionDiagnostics=!this._appSettingsManager.getBooleanAppSetting("DiagnosticsInfoInJewelAboutMenuIsEnabled"),e.btnjTryOffice&&e.btnjTryMacOffice&&e.jbtnTermsOfUse&&e.jbtnPrivacy&&e.AboutInformationMenuSectionDiagnostics&&(e.faAbout=!0),e.jbtnHelp&&e.jbtnGiveFeedback&&e.jbtnReportAbuse&&(e.faHelp=!0),e.btnjClose&&(e.msJewelSecondary=!0),e.faOpen&&e.faNew&&(e.faHome=!0)},e}();(0,o.l)(Px,"7c610f63$WoncaCommandTrimmer",null,[wx.r]);var Dx=function(){function e(t,n,i,r,a,l,s,u,c,d){var g=this;if(void 0===d&&(d=null),this._hostingAppFrame=null,this._topRowPeripheralControlCreator=null,this._ribbonPanel=null,this._generalCuiUserFuture=null,this._generalCuiUser=null,this._theRibbon=null,this._standaloneRoot=null,this._ribbonCommandTrimmer=null,this._dataSource=null,this._ribbonMinimizedCookieName=null,this._ribbonDependencies=null,null==t)throw Error.argumentNull("hostingAppFrame");this._ribbonPanel=n,this._generalCuiUserFuture=r,this._hostingAppFrame=t,this._ribbonDependencies=a,this._standaloneRoot=s,this._ribbonCommandTrimmer=new xx(new Px(L.AFrameworkApplication.appSettingsManager,a),u),this._ribbonMinimizedCookieName=c,this._topRowPeripheralControlCreator=d,this._generalCuiUserFuture.execute((function(e){g._generalCuiUser=e})),Dr.t.mark(4891),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled()&&Sys.UI.DomElement.addCssClass(this._ribbonPanel,"FlexBoxLayout"),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()&&Sys.UI.DomElement.addCssClass(this._ribbonPanel,"MLRVisualRefresh");var p=[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings],h=new it.CuiHelper(Wy.f.box4ImageBase,i,null,null,p);W.y.get_isIPad()&&it.CuiHelper.registerOnClickBreadcrumbLink(Kw.onClickBreadcrumbLinkIPad),this._topRowPeripheralControlCreator||(this._topRowPeripheralControlCreator=new Qw(this._standaloneRoot));var _=new rx;_.clientID=e._ribbonClientID,_.showJewelId=2===yi.App.get_mode()?"jewelWordEditor":"jewelOneNote",_.trimmedIds={},_.displayMinimized=this.GetMinimizedStateFromCookie(this._hostingAppFrame.get_ribbonMinimizedByDefault()),_.staticUiTouchMode=this._hostingAppFrame.get_isStaticUiTouchMode(),_.jewelBuildOptions=new fw.l,_.jewelBuildOptions.trimmedIds=_.trimmedIds,this._ribbonCommandTrimmer.setTrimmedIds(_.trimmedIds),this.updateJewelBuildOptions(_.jewelBuildOptions);var m=a.areReady();m&&(this._ribbonCommandTrimmer.updateTrimmedIds(_.trimmedIds),this.CreatePeripheralSections(n,h)),Lr.Builder.enableInsertTable(),Lr.Builder.enableSpinner();var f=new Ax(_,n,this,l);this._dataSource=new ow.p(2===yi.App.get_mode()?e._wordEditorRibbonDataName:e._ribbonDataName,h),f.set_dataSource(this._dataSource),f.buildRibbonAndInitialTab("tabHome"),this._theRibbon=f.get_ribbon(),this._theRibbon.attachStandaloneRoot(this._standaloneRoot),r.execute((function(e){g.get_theRibbon().set_rootUser(e)})),new Ix(this._hostingAppFrame,this.get_theRibbon(),this._ribbonDependencies.get_focusManager()).initialize(this._ribbonPanel,this._ribbonDependencies.get_actionManager()),Dr.t.mark(4892);var y=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BootPerfRibbonPollIsEnabled"),C=new ge.c(y?0:2,1,y?0:100,o.i(this,this.InitialRootRefresh,"InitialRootRefresh"));L.AFrameworkApplication.get_theTaskManager().addTask(C);var S=new Jw.d;m?(ar.r.get_instance().setAppInitializationStatus(5),S.dismissFastViewRibbonAndHeader()):a.waitForReady((function(){var e=g.get_theRibbon().get_builder();g._ribbonCommandTrimmer.updateTrimmedIds(e.get_options().trimmedIds),g.updateJewelBuildOptions(e.get_options().jewelBuildOptions),e.rebuildJewel(),g.CreatePeripheralSections(n,h),g.get_theRibbon().reloadPeripherals(),ar.r.get_instance().setAppInitializationStatus(5),S.dismissFastViewRibbonAndHeader()}),null)}return e.prototype.get_standaloneRootControlManager=function(){return this._standaloneRoot.get_cuiControlManager()},e.prototype.updateJewelBuildOptions=function(e){},e.prototype.getPrintButtonInfo=function(){return null},e.prototype.getSyncStatusLabelInfo=function(){return null},e.prototype.getGiveFeedbackButtonInfo=function(){return null},e.prototype.getOpenInClientButtonInfo=function(){var e=null;return L.AFrameworkApplication.get_trimOICButtons()||((e=new jw.i).command="3588168074",e.label=this._hostingAppFrame.get_applicationInstance().get_editInClientButtonText()),e},e.prototype.getTellMeSearchBoxInfo=function(){var e=null;return L.AFrameworkApplication.tellMeIsEnabled&&((e=new nx).accessibilityTextCommand="4054875485",e.command="2652476189",e.commandMenuClose="4266170064",e.commandMenuOpen="2480888384",e.menuControlExecutedCommand="878547493",e.onInteractionBegin="586156566",e.onRestoreFocus="3243793933",e.onInputBoxFocus="2303219627",e.onInputBoxBlur="1024534176",e.populateQueryCommand="2652476189",e.populateAsyncTriggerCommand="2751631965",e.altText=String.format(CommonUIStrings.l_LookupHotkeyText,CommonUIStrings.l_LookupAltText),e.placeHolderText=CommonUIStrings.l_LookupAltText,e.keytip=CommonUIStrings.l_LookupAltTextKeytip),e},e.prototype.createBottomRowCenterControls=function(t,n){n.createBottomRowCenterControls(e._ribbonClientID,t,this.getPrintButtonInfo(),this.getTellMeSearchBoxInfo(),this.getOpenInClientButtonInfo(),this.getGiveFeedbackButtonInfo(),this.get_standaloneRootControlManager())},e.prototype.CreateBottomRowRightControls=function(t,n){this._topRowPeripheralControlCreator.createRibbonPeripheralControls(t,n,e._ribbonClientID),this.CreateSyncStatusControl(this._standaloneRoot.get_cuiControlManager(),t.lastChild)},e.prototype.CreateSyncStatusControl=function(t,n){var i=this.getSyncStatusLabelInfo();if(i&&t){var r={};r.Id=i.id,r.LabelText=i.labelText,r.QueryCommand=i.queryCommand,r.Image16by16=L.AFrameworkApplication.get_imageClusterPath(),r.Image16by16Class=Ct.ImageClusteringHelper.getImageClass(e.SyncStatusImg);var o=Yu.s.buildNodeXml("Label",null,r),a=t.hostControl(i.id,o,"Medium");a&&n&&(Sys.UI.DomElement.addCssClass(a,"SyncStatusControl"),n.insertBefore(a,n.firstChild))}},e.prototype.CreatePeripheralSections=function(t,n){this._topRowPeripheralControlCreator.createTopRowControls(t,n,e._ribbonClientID),this.createBottomRowCenterControls(t,n),this.CreateBottomRowRightControls(t,n)},e.prototype.dispose=function(){null!==this._theRibbon&&(this._theRibbon.dispose(),this._theRibbon=null),this._hostingAppFrame.disposeAllFloaties(),this._topRowPeripheralControlCreator&&(this._topRowPeripheralControlCreator.disposeTopRowControls(),this._topRowPeripheralControlCreator=null),this._hostingAppFrame=null},e.prototype.get_theRibbon=function(){return this._theRibbon},e.prototype.get_ribbonExternal=function(){return this._theRibbon},e.prototype.activateRibbonTab=function(e){this.get_theRibbon().selectTabById(e,!0)},e.prototype.launchJewelMenu=function(e,t){this.get_theRibbon().launchJewel(e,t)},e.prototype.addTabData=function(e,t){this._dataSource.addTabData(e,t)},e.prototype.InitialRootRefresh=function(e){this.get_theRibbon().refresh(),this.get_theRibbon().pollForStateAndUpdate()},e.prototype.pollForStateUpdate=function(){this._hostingAppFrame.workspace&&(2===this._hostingAppFrame.get_mode()||Gl.n.get_instance().get_item(7))&&(L.AFrameworkApplication.get_theTaskManager().get_isYielding()||this._generalCuiUser&&(Dr.t.mark(4893),this._generalCuiUser.clearCache(),Ef.StylePreviewGenerator.updatePreviewCssWithCurrentStyleSet(),this.get_theRibbon().get_root().pollForStateAndUpdate(),Dr.t.mark(4894),ar.r.get_instance().isCompleted(7)||(ar.r.get_instance().setAppInitializationStatus(7),ar.r.get_instance().setAppInitializationStatus(11),sn.e.get_instance().addDurationMetric(ln.c.appInitStart,ln.c.ribbonInteractiveReady,(new Date).getTime()))))},e.prototype.updatePeopleWellControl=function(){},e.prototype.updateDocChatControl=function(){},e.prototype.saveMinimizedStateToCookie=function(){re.z.setWithExpiration(this._ribbonMinimizedCookieName,this.get_theRibbon().get_minimized()?"true":"false",Pe.AFrame.uiCookieExpirationDays)},e.prototype.GetMinimizedStateFromCookie=function(e){return re.z.getBool(this._ribbonMinimizedCookieName,e)},e.prototype.updateControls=function(e){},e.prototype.onComponentBuilt=function(e,t){this._generalCuiUserFuture.execute((function(t){e.set_rootUser(t)}))},e._ribbonClientID="WACRibbon",e._ribbonDataName="OneNoteRibbonData",e._wordEditorRibbonDataName="WordEditorRibbonData",e._separatorID="sep1",e.SyncStatusImg="OLCalApptRecurI_16x16x32",e}();(0,o.l)(Dx,"9e674496$RibbonUser",null,[lw.s,sw,uw.j,Sys.IDisposable]);var Rx=function(){return function(){this.id=null,this.labelText=null,this.queryCommand=null}}();(0,o.l)(Rx,"b1cb1fe6$LabelInfo",null,[]);var Mx=n(4883),kx=function(){function e(t,n,i,r){void 0===r&&(r=!1),this.theAppSettingsManager=null,this.officeTrialExperience=null,this.macOfficeOffer=null,this.isPasteOptionsEnable=!1,this._isFullAppSettingsReady=!1,this._actionManager=null,this._focusManager=null,this.theAppSettingsManager=t,this._isFullAppSettingsReady=this.theAppSettingsManager.get_isFullAppSettingsReady(),this.officeTrialExperience=Ge.w.get_instance().tryResolve(JC.v),this.macOfficeOffer=Ge.w.get_instance().tryResolve(XC.u),e._callbackExecuted=!1,this.isPasteOptionsEnable=r,this._actionManager=n,this._focusManager=i}return e.prototype.get_actionManager=function(){return this._actionManager},e.prototype.get_focusManager=function(){return this._focusManager},e.prototype.areReady=function(){return this._isFullAppSettingsReady&&!!this.officeTrialExperience&&!!this.macOfficeOffer},e.prototype.waitForReady=function(e,t,n){var i=this;void 0===n&&(n=null),this.theAppSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){S.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready"),i._isFullAppSettingsReady=!0,i.ExecuteCallbackWhenReady(e,t)})),Ge.w.get_instance().resolveFuture(JC.v).execute((function(n){S.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready"),i.officeTrialExperience=n,i.ExecuteCallbackWhenReady(e,t)})),Ge.w.get_instance().resolveFuture(XC.u).execute((function(n){S.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready"),i.macOfficeOffer=n,i.ExecuteCallbackWhenReady(e,t)}))},e.prototype.ExecuteCallbackWhenReady=function(t,n){e._callbackExecuted||(this.areReady()?(S.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),t(this,n),e._callbackExecuted=!0):S.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))},e._callbackExecuted=!1,e}();(0,o.l)(kx,"2516fc77$RibbonDependencies",null,[Mx.b]);var Nx=function(e){function t(t,n,i,r,o,a,l,s,u,c,d){return e.call(this,t,n,i,r,new kx(L.AFrameworkApplication.appSettingsManager,a,l),o,s,u,c,d)||this}return(0,v.t)(t,e),t.prototype.getSyncStatusLabelInfo=function(){return!L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxFlightEnabled()&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteSyncStatusEnabled")?(0,U.m)(new Rx,{id:t.SyncStatusId,labelText:null,queryCommand:"894288409"}):null},t.prototype.getGiveFeedbackButtonInfo=function(){return L.AFrameworkApplication.showFeedbackButton?(0,U.m)(new jw.i,{command:"802602464",label:WoncaIntl.WoncaStrings.L_GiveFeedback}):null},t.prototype.getPrintButtonInfo=function(){return Ti.App.oneNotePrintIsEnabled?(0,U.m)(new jw.i,{command:"1588554917",label:OneNoteIntl.OneNoteStrings.L_Print}):null},t.prototype.createBottomRowCenterControls=function(t,n){if(Ti.App.get_isOneNoteEmbedded()&&Ti.App.oneNoteEmbedShowEditFlyout){var i=it.CuiHelper.createGenericPeripheralSection(Dx._ribbonClientID,Hw.r.bottomRowCenter);it.CuiHelper.addPrintButton(this.getPrintButtonInfo(),i,this.get_standaloneRootControlManager()),it.CuiHelper.addSeparator(i,this.get_standaloneRootControlManager()),this.AddEmbedOpenInClientFlyout(i),it.CuiHelper.addFeedbackButton(this.getGiveFeedbackButtonInfo(),this.get_standaloneRootControlManager(),i),t.appendChild(i)}else e.prototype.createBottomRowCenterControls.call(this,t,n)},t.prototype.AddEmbedOpenInClientFlyout=function(e){var t=this.get_standaloneRootControlManager().hostControl("OneNoteEmbedOpenInClientFlyoutAnchor_BottomRowCenter",this.BuildEmbedOpenInClientFlyoutXml(),"Medium");e.appendChild(t)},t.prototype.BuildEmbedOpenInClientFlyoutXml=function(){var e=[this.BuildOpenInClientButtonXml("btnEditInClient",Oi.u.openInClient,OneNoteIntl.OneNoteStrings.L_OpenInApp,"OneNote_32x32x32"),this.BuildOpenInClientButtonXml("btnFlyoutEditOnWeb",nS.u.embedEditInBrowser,OneNoteIntl.OneNoteStrings.L_OpenInWebApp,"EditInOneNoteWebApp_32x32x32")],t=Yu.s.buildMenuSectionXml("menuSectionEdit",Yu.s.buildControlsGroupXml("ctrlsEdit",e),"Menu32");return this.BuildFlyoutXml("flyoutOneNoteEdit",OneNoteIntl.OneNoteStrings.L_OpenInApp,t)},t.prototype.BuildOpenInClientButtonXml=function(e,t,n,i,r){return void 0===r&&(r=null),Yu.s.buildButtonXml(e,t.toString(),n,i,null,null,n,"Menu32",null,null,r)},t.prototype.BuildFlyoutXml=function(e,t,n){return Yu.s.buildFlyoutXml(e,"798637440",null,null,!1,!0,null,null,"None",null,null,t,null,t,null,!1,!1,!0,[n])},t.SyncStatusId="lblSyncStatus",t}(Dx);(0,o.l)(Nx,"f1a9ac76$RibbonUser",Dx,[]);var Lx=function(e){function t(t){return e.call(this,t,"SharingSet_Start_Glyph_OneNote_16x16x32")||this}return(0,v.t)(t,e),t.prototype.getTopRightActionButtonInfo=function(){return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteDisableFileSharing")?null:e.prototype.getTopRightActionButtonInfo.call(this)},t.prototype.shouldShowActionButtonInRibbon=function(){var e=this.getActionButtonInfo();return!(!e||"981334692"!==e.command)&&(!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxFlightEnabled())},t.prototype.shouldShowRibbonToggleButtonInHeader=function(){return!1},t}(Qw);(0,o.l)(Lx,"4f4b7eb$TopRowPeripheralControlCreator",Qw,[]);var Bx=n(2704),Ox=function(e){function t(t,n,i,r,o,a){var l=e.call(this,t,n,i,r)||this;return l._externalUICommandDefinitionMapping=null,l._reactRoot=null,l._externalUICommandDefinitionMapping=o,l._reactRoot=a,l}return(0,v.t)(t,e),t.prototype.createRibbonUser=function(e,t,n){return L.AFrameworkApplication.hideRibbonEmbedded?null:L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()?this.CreateSingleLineRibbon(e,t):this.CreateMultilineRibbon(e,t,n)},t.prototype.CreateSingleLineRibbon=function(e,t){var n=new kx(L.AFrameworkApplication.appSettingsManager,this._actionManager,this._focusManager),i=new xx(new Px(L.AFrameworkApplication.appSettingsManager,n),new Bx.h),r=this.InitializeSimplifiedRibbonJewelProperties(n,i),o={};i.setTrimmedIds(o);var a=new tx(e,t,OneNoteIntl.OneNoteStrings,this._generalCuiUserFuture,n,e,this._theStandaloneRoot,this._externalUICommandDefinitionMapping,r,new rw(o),new Lx(this._theStandaloneRoot),this._reactRoot);return a.initializeRibbon(),a},t.prototype.CreateMultilineRibbon=function(e,t,n){return new Nx(e,t,OneNoteIntl.OneNoteStrings,this._generalCuiUserFuture,e,this._actionManager,this._focusManager,this._theStandaloneRoot,new Bx.h,n,new Lx(this._theStandaloneRoot))},t.prototype.InitializeSimplifiedRibbonJewelProperties=function(e,t){var n=[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings],i=new it.CuiHelper(Wy.f.box4ImageBase,OneNoteIntl.OneNoteStrings,void 0,void 0,n),r=new ow.p("OneNoteJewelRibbonData",i),o={},a=new xx(new Px(L.AFrameworkApplication.appSettingsManager,e),t);return a.setTrimmedIds(o),a.updateTrimmedIds(o),new aw(r,o,"jewelOneNote")},t}(iw);(0,o.l)(Ox,"40ee5c96$OneNoteRibbonUserFactory",iw,[]);var Ux=(0,o.y)("a85f5fb2$IToolbarInitializer"),Hx=n(9958),Gx=n(3578),Wx=function(e){function t(n,i,r){var o=this;return o._overflowFlyoutAnchor=null,o.heroDockControls=null,o._heroDockProperties=null,o.heroControlCount=t.defaultHeroControlCount,(o=e.call(this,n,i,"","")||this).heroDockControls=new Array(0),o._heroDockProperties=r,o}return(0,v.t)(t,e),t.prototype.get_visibleInDOM=function(){return!0},t.prototype.get_cssClass=function(){return"cui-herodock"},t.prototype.refreshInternal=function(){this.refreshHeroDockVisuals(),e.prototype.refreshInternal.call(this)},t.prototype.ensureBehaviorAttached=function(){for(var t=0,n=this.heroDockControls;t<n.length;t++){n[t].ensureBehaviorAttachedIfAvailable()}e.prototype.ensureBehaviorAttached.call(this)},t.prototype.SplitHeroDockControls=function(e,t,n){e.val=new Array(0),t.val=new Array(0),n.val=new Array(0);for(var i=0;i<this.heroDockControls.length;i++){var r=this.heroDockControls[i];r.get_visible()?e.val.length<this.heroControlCount?e.val.push(r):o.r(Gx.FlyoutAnchor,r)?Array.addRange(t.val,r.GetControlsInFlyoutAnchorMenu()):t.val.push(r):n.val.push(r)}},t.prototype.CreateOverflowMenu=function(e){if(!e||!e.length)return null;for(var t={DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},n=new Mr.Menu(this.get_root(),this.get_id()+"OverflowMenu",null,null,null),i=new oo.z(this.get_root(),this.get_id()+"OverflowMenuSection",null,null,t,n),r=0,o=e;r<o.length;r++){var a=o[r];i.addChild(a.createComponentForDisplayMode("Menu20"))}return n.addChild(i),n},t.prototype.refreshHeroDockVisuals=function(){var e,t,n;this.RemoveChildren(),this.set_elementInternal(fr.n.removeChildNodes(this.get_elementInternal())),this.ensureDOMElement(),this.SplitHeroDockControls((0,g.m)((function(){return e}),(function(t){return e=t})),(0,g.m)((function(){return t}),(function(e){return t=e})),(0,g.m)((function(){return n}),(function(e){return n=e})));for(var i=0,r=e;i<r.length;i++){(d=r[i].createComponentForDisplayMode("Medium20")).set_Enabled(!0),this.AddChildAtIndex(d,this.get_children().get_count()),this.get_elementInternal().appendChild(d.get_elementInternal()),d.ensureRefreshed()}var o=this.CreateOverflowMenu(t);if(o){if(this._overflowFlyoutAnchor)this._overflowFlyoutAnchor.set_menu(o);else{var a=this.get_id()+"OverflowMenuLauncher",l={};l.Image20by20=this._heroDockProperties.OverflowMenuImage20by20,l.Image20by20Class=this._heroDockProperties.OverflowMenuImage20by20Class,l.PopulateDynamically="false",l.HideDefaultArrow="true",l.Alt=this._heroDockProperties.OverflowMenuTooltip,l.Command="798637440",l.Id=a,this._overflowFlyoutAnchor=new Gx.FlyoutAnchor(this.get_root(),a,l,o)}var s=this._overflowFlyoutAnchor.createComponentForDisplayMode("Small20");s.set_Enabled(!0),this.AddChildAtIndex(s,this.get_children().get_count()),this.get_elementInternal().appendChild(s.get_elementInternal()),s.ensureRefreshed()}if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(var u=0,c=n;u<c.length;u++){var d=c[u].createComponentForDisplayMode("Medium20");this.addChild(d),d.ensureRefreshed()}},t.prototype.dispose=function(){this._overflowFlyoutAnchor&&(this._overflowFlyoutAnchor.dispose(),this._overflowFlyoutAnchor=null);for(var t=0,n=this.heroDockControls;t<n.length;t++){n[t].dispose()}this.RemoveChildren(),e.prototype.dispose.call(this)},t.defaultHeroControlCount=4,t}(cx.s);(0,o.l)(Wx,"ae24835f$HeroDock",cx.s,[]);var Vx=function(e){function t(){var t=e.call(this)||this;return t.staticUiTouchMode=!1,t.isOneRowToolbar=!1,t.supportsEmphasizedControls=!1,t.maxElementsBeforeOverflow=Wx.defaultHeroControlCount,t}return(0,v.t)(t,e),t}(ix.l);(0,o.l)(Vx,"16b8b59$ToolbarBuildOptions",ix.l,[]);var $x=(0,o.y)("33d7b10d$IToolbar"),zx=n(9669),Kx=function(e){function t(t,n,i){var r=this;return r._alignment=null,r._dropFromStart=!1,(r=e.call(this,t,n,"","")||this)._alignment=i.Alignment,r._dropFromStart=i.ScalingDirection===ox.o.FIRSTTOLAST,r}return(0,v.t)(t,e),t.prototype.refreshInternal=function(){this.ensureDOMElementAndEmpty(),this.appendChildrenToElement(this.get_elementInternal()),e.prototype.refreshInternal.call(this)},t.prototype.appendChildrenToElement=function(e){for(var t=this.get_children().getEnumerator();t.moveNext();){var n=t.get_current();switch(n.ensureDOMElement(),this._alignment){case ox.o.LEFTALIGN:fr.n.ensureCSSClassOnElement(n.get_elementInternal(),"cui-toolbar-button-left");break;case ox.o.CENTERALIGN:fr.n.ensureCSSClassOnElement(n.get_elementInternal(),"cui-toolbar-button-center");break;case ox.o.RIGHTALIGN:fr.n.ensureCSSClassOnElement(n.get_elementInternal(),"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this._alignment)}n.get_visible()&&e.appendChild(n.get_elementInternal()),n.ensureRefreshed()}},t.prototype.ensureCorrectChildType=function(e){if(!o.r(po.r,e))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.")},t.prototype.get_cssClass=function(){switch(this._alignment){case ox.o.LEFTALIGN:return"cui-toolbar-buttondock alignleft";case ox.o.CENTERALIGN:return"cui-toolbar-buttondock aligncenter";case ox.o.RIGHTALIGN:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this._alignment)}},t.prototype.get_visibleInDOM=function(){return!0},t.prototype.get_alignment=function(){return this._alignment},t.prototype.GetWidthPx=function(){var e=0;if(this.get_alignment()===ox.o.CENTERALIGN)for(var t=this.get_children().getEnumerator();t.moveNext();){var n=t.get_current();n.get_visible()&&(e+=n.get_elementInternal().offsetWidth)}else e=this.get_elementInternal().offsetWidth;return e},t.prototype.GetStartPoint=function(){var e=null;if(this.get_alignment()===ox.o.CENTERALIGN)for(var t=this.get_children().getEnumerator();t.moveNext();){var n=t.get_current();if(n.get_visible()){e=Sys.UI.DomElement.getBounds(n.get_elementInternal());break}}else e=Sys.UI.DomElement.getBounds(this.get_elementInternal());return e?this.get_root().get_textDirection()?e.x+e.width:e.x:0},t.prototype.GetEndPoint=function(){var e=null;if(this.get_alignment()===ox.o.CENTERALIGN){if(this.get_children().get_count()>0)for(var t=this.get_children().GetEnumeratorAtPos(this.get_children().get_count()-1);t.movePrevious();){var n=t.get_current();if(n.get_visible()){e=Sys.UI.DomElement.getBounds(n.get_elementInternal());break}}}else e=Sys.UI.DomElement.getBounds(this.get_elementInternal());return e?this.get_root().get_textDirection()?e.x:e.x+e.width:0},t.prototype.EnsureNoChildrenScaledAway=function(){for(var e=this.get_children().getEnumerator();e.moveNext();){var t=e.get_current();o.r(po.r,t)&&!t.get_control().get_visible()||t.set_visible(!0)}},t.prototype.ScaleDownToFitSize=function(e){for(var t=this.get_children().ToArray(),n=new zx.y,i=this._dropFromStart?0:t.length-1,r=this.get_children().get_count(),a=this.get_root().get_supportsInvisibleControls();this.GetWidthPx()>=e&&!(i>=r||i<0);){var l=t[i];a&&o.r(po.r,l)&&l.get_control().get_visible()&&(n.add(l),l.ApplyHideElementOverride()),i+=this._dropFromStart?1:-1}for(var s=n.getEnumerator();s.moveNext();){(l=s.get_current()).RemoveHideElementOverride(),l.set_visible(!1)}},t}(cx.s);(0,o.l)(Kx,"853e2063$ButtonDock",cx.s,[]);var qx=function(e){function t(t,n,i,r,o,a,l){void 0===l&&(l=!1);var s=this;return s._builder$3=null,s._startDock=null,s._centerDock=null,s._endDock=null,s._multipleDocksOfSameType=!1,s._toolbarScalingOptimizationsEnabled=!1,s._toolbarSize=0,(s=e.call(this,t,n,a)||this)._builder$3=i,s.set_isStaticUiTouchMode(r),s.supportsEmphasizedControls=o,s._toolbarSize=0,_r.n.isNullOrUndefined(n.Size)||(n.Size===ox.o.ONEROW||i.get_options().isOneRowToolbar?s._toolbarSize=0:n.Size===ox.o.SINGLEDOCK&&(s._toolbarSize=1)),s._toolbarScalingOptimizationsEnabled=l,s}return(0,v.t)(t,e),t.prototype.get_supportsInvisibleControls=function(){return!0},t.prototype.addChild=function(t){if(e.prototype.addChild.call(this,t),o.r(Kx,t)&&!this._multipleDocksOfSameType){var n=t;n.get_alignment()===ox.o.LEFTALIGN?(this._startDock&&this.SetMultipleDocksOfSameType(),this._startDock=n):n.get_alignment()===ox.o.CENTERALIGN?(this._centerDock&&this.SetMultipleDocksOfSameType(),this._centerDock=n):n.get_alignment()===ox.o.RIGHTALIGN&&(this._endDock&&this.SetMultipleDocksOfSameType(),this._endDock=n)}},t.prototype.SetMultipleDocksOfSameType=function(){this._multipleDocksOfSameType=!0,this._startDock=null,this._centerDock=null,this._endDock=null},t.prototype.setControlVisibility=function(e,t,n){void 0===n&&(n=!0);var i=this.getControlById(e);_r.n.isNullOrUndefined(i)||i.get_visible()===t||(i.set_visible(t),n&&this.refresh())},t.prototype.refreshInternal=function(){e.prototype.refreshInternal.call(this),this.RefreshInternalCore(!0)},t.prototype.RefreshInternalCore=function(e){var t=this.get_root().get_controlWithFocus();_r.n.isNullOrUndefined(this.get_elementInternal())&&this.createToolbarStructure(),this.set_elementInternal(fr.n.removeChildNodes(this.get_elementInternal())),this.hiddenLabel&&this.get_elementInternal().appendChild(this.hiddenLabel);for(var n=this.get_children().getEnumerator();n.moveNext();){var i=n.get_current();i.get_visible()&&(i.ensureDOMElement(),this.get_elementInternal().appendChild(i.get_elementInternal()),i.ensureRefreshed())}this._centerDock&&e&&this.EnsureCenterDockLayout(),t&&t.setFocusOnControl(),this.set_dirty(!1)},t.prototype.EnsureCenterDockLayout=function(){if(this._centerDock.get_visible()&&this._centerDock.get_children().get_count()&&(this.ApplyMarginsToCenterDock(0,0),this.DoesCenterDockCollide(this._startDock,this._centerDock,this._endDock))){var e=0,t=0,n=this._startDock?this._startDock.GetWidthPx():0,i=this._endDock?this._endDock.GetWidthPx():0;(i>0||n>0)&&(i>n?(e=0,t=i-n):(e=n-i,t=0)),this.ApplyMarginsToCenterDock(e,t)}},t.prototype.DoesCenterDockCollide=function(e,t,n){var i=!1;return this.get_root().get_textDirection()?(e&&(i=e.GetEndPoint()<t.GetStartPoint()),!i&&n&&(i=t.GetEndPoint()<n.GetStartPoint())):(e&&(i=e.GetEndPoint()>t.GetStartPoint()),!i&&n&&(i=t.GetEndPoint()>n.GetStartPoint())),i},t.prototype.ApplyMarginsToCenterDock=function(e,t){this.get_textDirection()?(this._centerDock.get_elementInternal().style.marginRight=e+"px",this._centerDock.get_elementInternal().style.marginLeft=t+"px"):(this._centerDock.get_elementInternal().style.marginLeft=e+"px",this._centerDock.get_elementInternal().style.marginRight=t+"px")},t.prototype.createToolbarStructure=function(){this.ensureDOMElement()},t.prototype.pollForStateAndUpdateInternal=function(){var e=this;this.DoPoll((function(){Wc.z.prototype.pollForStateAndUpdateInternal.call(e)}))},t.prototype.pollForControlState=function(e){var t=this.getControlById(e);_r.n.isNullOrUndefined(t)||this.DoPoll(o.i(t,t.PollForStateAndUpdate,"PollForStateAndUpdate"))},t.prototype.DoPoll=function(e){this.needScaling=!1,this.needRefresh=!1,e(),(this.needScaling||this.needRefresh)&&(this._toolbarScalingOptimizationsEnabled||this.refresh(),this.Scale())},t.prototype.ensureCorrectChildType=function(e){if(!o.r(Wx,e)&&!o.r(Kx,e))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(o.r(Kx,e)&&e.get_alignment()===ox.o.CENTERALIGN)for(var t=this.get_children().getEnumerator();t.moveNext();){if(t.get_current().get_alignment()===ox.o.CENTERALIGN)throw Error.create("Can't add a centered buttondock because one is already present.")}},t.prototype.get_cssClass=function(){var t="cui-toolbar-toolbar ";return this._toolbarSize?1===this._toolbarSize&&(t+="cui-toolbar-singledock "):(t+="cui-toolbar-onerow ",L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()||(t+="UITextTranformUpperCase ")),t+e.prototype.get_cssClass.call(this)},t.prototype.get_domElementTagName=function(){return"div"},t.prototype.get_rootType=function(){return 26},t.prototype.get_ToolbarBuilder=function(){return this.get_builder()},t.prototype.set_ToolbarBuilder=function(e){return this.set_builder(e),e},t.prototype.CreateButtonDock=function(e,t){var n=e[ox.o.ATTRIBUTES];return new Kx(this.get_root(),n.Id,n)},t.prototype.ensureDOMElement=function(){e.prototype.ensureDOMElement.call(this),this.get_elementInternal().setAttribute("role","toolbar"),this.get_properties().Title&&this.get_elementInternal().setAttribute("title",this.get_properties().Title)},t.prototype.updateOpenMenu=function(e){return!(!this.get_root()||!this.get_root().refreshOpenMenu(e))},t.prototype.setFocusOnToolbar=function(){return this.SetFocusOnFirstControl()},t.prototype.Scale=function(){if(e.prototype.Scale.call(this),!fr.n.isTrue(this.get_properties().Scale))return!1;if(this._multipleDocksOfSameType)return!1;_r.n.isNullOrUndefined(this._startDock)||(this._startDock.set_visible(!0),this._startDock.EnsureNoChildrenScaledAway()),_r.n.isNullOrUndefined(this._centerDock)||(this._centerDock.set_visible(!0),this._centerDock.EnsureNoChildrenScaledAway()),_r.n.isNullOrUndefined(this._endDock)||(this._endDock.set_visible(!0),this._endDock.EnsureNoChildrenScaledAway()),this.RefreshInternalCore(!1);var t=this.get_elementInternal().offsetWidth,n=_r.n.isNullOrUndefined(this._startDock)?0:this._startDock.GetWidthPx(),i=_r.n.isNullOrUndefined(this._centerDock)?0:this._centerDock.GetWidthPx(),r=_r.n.isNullOrUndefined(this._endDock)?0:this._endDock.GetWidthPx();return r+i+n>=t&&(r+n>=t?(this.HideDockIfPresent(this._centerDock),r>=t?(this.HideDockIfPresent(this._startDock),this.ScaleDockIfPresent(this._endDock,t)):this.ScaleDockIfPresent(this._startDock,t-r)):this.ScaleDockIfPresent(this._centerDock,t-r-n)),this.needScaling=!1,this.refreshInternal(),!1},t.prototype.HideDockIfPresent=function(e){e&&e.set_visible(!1)},t.prototype.ScaleDockIfPresent=function(e,t){e&&e.ScaleDownToFitSize(t)},t.oneRowToolbarHeightPx=26,t}($r.b);(0,o.l)(qx,"903489df$Toolbar",$r.b,[$x]);var jx=function(e){function t(t,n,i,r,o){void 0===o&&(o=!1);var a=e.call(this,t,n,i,!1,!1,r,o)||this;return a._launchMenusUp=!0,a}return(0,v.t)(t,e),t.prototype.get_rootType=function(){return 7},t.prototype.get_cssClass=function(){return t.get_StatusBarClassName()+" "+e.prototype.get_cssClass.call(this)},t.get_StatusBarClassName=function(){var e="cui-statusbar";return L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()||(e+=" UISmallFont UITextTranformUpperCase"),e},t}(qx);(0,o.l)(jx,"65cb66b3$StatusBar",qx,[]);var Qx=n(9003),Jx=function(e){function t(){var t=e.call(this)||this;return t.toolbar=null,t.isStatusBar=!1,t}return(0,v.t)(t,e),t}(Qx.n);(0,o.l)(Jx,"3da24656$ToolbarBuildContext",Qx.n,[]);var Xx=function(e){function t(t,n,i,r){var o=e.call(this,t,n,ut.Task.fromResult(uw.j,i),r)||this;if(_r.n.isNullOrUndefined(n))throw Error.create("Toolbar placeholder DOM element is null or undefined.");return o}return(0,v.t)(t,e),t.prototype.get_toolbar=function(){return this.get_root()},t.prototype.set_toolbar=function(e){return this.set_root(e),e},t.prototype.get_ToolbarBuildOptions=function(){return this.get_options()},t.prototype.buildToolbar=function(){var e=new Jx,t=new ax.v;t.id="toolbar",t.queryType=1,t.handler=o.i(this,this.OnReturnToolbarData,"OnReturnToolbarData"),t.data=e,this.get_dataSource().runQuery(t)},t.prototype.OnReturnToolbarData=function(e){var t=this,n=e.contextData;this.set_toolbar(this.BuildToolbarFromData(e.queryData,n)),this.get_toolbar().set_ToolbarBuilder(this),this.get_toolbar().refreshInternal(),this.get_placeholder().appendChild(this.get_toolbar().get_elementInternal()),fr.n.ensureCSSClassOnElement(this.get_placeholder(),"loaded"),this.get_buildClientTask().CWo((function(e){t.get_buildClientTask().get_result().onComponentBuilt(t.get_toolbar(),t.get_toolbar().get_id())}),Qn.d.onlyOnRanToCompletion|Qn.d.executeSynchronously)},t.prototype.BuildToolbarFromData=function(e,t){var n=ox.o.getFirstChildNodeWithName(e,ox.o.TOOLBAR);if(_r.n.isNullOrUndefined(n)&&(n=ox.o.getFirstChildNodeWithName(e,ox.o.STATUSBAR),t.isStatusBar=!0),_r.n.isNullOrUndefined(n))throw Error.create("No toolbar element was present in the data");var i=new ox.o(n),r=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ToolbarScalingRedundancyEliminationIsEnabled");t.isStatusBar?this.set_toolbar(new jx(i.get_attributes()[ox.o.id],i.get_attributes(),this,this.get__resizableContainer(),r)):this.set_toolbar(new qx(i.get_attributes()[ox.o.id],i.get_attributes(),this,this.get_ToolbarBuildOptions().staticUiTouchMode,this.get_ToolbarBuildOptions().supportsEmphasizedControls,this.get__resizableContainer(),r)),this.get_toolbar().set_ClientID(this.get_options().clientID),this.get_toolbar().set_useDataCookie(!0),this.get_toolbar().refreshInternal();for(var o=ox.o.getNodeChildren(ox.o.getFirstChildNodeWithName(i.get_node(),ox.o.DOCKS)),a=0,l=this.BuildAllDocksFromData(o,t);a<l.length;a++){var s=l[a];this.get_toolbar().addChild(s)}return this.get_toolbar()},t.prototype.BuildAllDocksFromData=function(e,t){for(var n=new Array(0),i=0;i<e.length;i++)this.isNodeTrimmed(e[i])||Array.add(n,this.BuildDockFromData(e[i],t));return n},t.prototype.BuildDockFromData=function(e,t){var n=ox.o.getNodeName(e),i=null;return n===ox.o.BUTTONDOCK?i=this.BuildButtonDockFromData(e,t):n===ox.o.HERODOCK&&(i=this.BuildHeroDockFromData(e,t)),i},t.prototype.BuildHeroDockFromData=function(e,t){var n=new ox.o(e),i=e[ox.o.ATTRIBUTES],r=new Wx(this.get_root(),n.get_attributes()[ox.o.id],i);r.heroControlCount=this.get_ToolbarBuildOptions().maxElementsBeforeOverflow;for(var o=ox.o.getFirstChildNodeWithName(e,ox.o.CONTROLS),a=ox.o.getNodeChildren(o),l=new Array(0),s=0;s<a.length;s++){var u=a[s];if(!this.isNodeTrimmed(u)){var c=this.buildControl(u,t);Array.add(l,c)}}return r.heroDockControls=l,r},t.prototype.BuildButtonDockFromData=function(e,t){new ox.o(e);for(var n=this.get_toolbar().CreateButtonDock(e,t),i=ox.o.getFirstChildNodeWithName(e,ox.o.CONTROLS),r=ox.o.getNodeChildren(i),o=0;o<r.length;o++)if(!this.isNodeTrimmed(r[o])){var a=this.BuildToolbarControlComponent(r[o],t);n.addChild(a)}return n},t.prototype.BuildToolbarControlComponent=function(e,t){var n,i=new ox.o(e),r=i.get_name(),o=i.get_attributes()[ox.o.DISPLAYMODE];switch(n=t.isStatusBar?"Small14":"Small",r){case ox.o.button:return this.buildControl(e,t).createComponentForDisplayMode(_r.n.isNullOrEmptyString(o)?n:o);case ox.o.flyoutAnchor:return n=t.isStatusBar?"Medium14":"Medium",this.buildControl(e,t).createComponentForDisplayMode(_r.n.isNullOrEmptyString(o)?n:o);case ox.o.label:return this.buildControl(e,t).createComponentForDisplayMode(_r.n.isNullOrEmptyString(o)?n:o);case ox.o.separator:return this.buildControl(e,t).createComponentForDisplayMode("Small");case ox.o.toggleButton:return this.buildControl(e,t).createComponentForDisplayMode(_r.n.isNullOrEmptyString(o)?n:o);default:throw Error.create("Invalid control type.")}},t}(Lr.Builder);(0,o.l)(Xx,"9c0f00fe$ToolbarBuilder",Lr.Builder,[]);var Yx=function(){function e(t,n,i,r,a,l,s,u){var c=this;if(this._toolbarClientIdOneNote="toolbar",this._theReadingBar=null,this._topRowControls=null,this._hostingAppFrame=null,this._cuiUserFuture=null,this._theViewerChrome=null,null==t)throw Error.argumentNull("hostingAppFrame");this._hostingAppFrame=t,this._cuiUserFuture=r,Dr.t.mark(4895);var d=[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings],g=new it.CuiHelper(Wy.f.box4ImageBase,i,null,null,d);this._topRowControls=g.createTopRowControls(this._toolbarClientIdOneNote,n,null,u.get_cuiControlManager(),!0,!0);var p=new Vx;p.clientID=this._toolbarClientIdOneNote,p.staticUiTouchMode=t.get_isStaticUiTouchMode(),p.trimmedIds={},L.AFrameworkApplication.webEditingEnabled&&yi.App.get_canEdit()||(p.trimmedIds.btnEditOnWeb=!0,Ti.App.oneNoteMultipleAccessLevelsIsEnabled||(p.trimmedIds.btnjOpenInClient=!0,p.trimmedIds.jbtnEditOnWeb=!0,p.trimmedIds.jbtnCopyAndEdit=!0)),L.AFrameworkApplication.showFeedbackButton||(p.trimmedIds.jbtnGiveFeedback=!0),Ti.App.oneNotePrintIsEnabled||(p.trimmedIds.jbtnPrint=!0,p.trimmedIds.btnPrint=!0),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteCopyToCloudIsEnabled")&&"SkyDrive"===L.AFrameworkApplication.appSettingsManager.get_appSettings().FileSource||(p.trimmedIds.jbtnCopyToCloud=!0),L.AFrameworkApplication.privacyUrl||(p.trimmedIds.jbtnPrivacy=!0),L.AFrameworkApplication.reportAbuseUrl||(p.trimmedIds.jbtnReportAbuse=!0),L.AFrameworkApplication.termsUrl||(p.trimmedIds.jbtnTermsOfUse=!0),L.AFrameworkApplication.fileShareEnabled&&!L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteDisableFileSharing")||(p.trimmedIds.jbtnFileSharing=!0,p.trimmedIds.btnFileSharing=!0),a&&a.get_offerOfficeTrialInFileMenu()||(p.trimmedIds.btnjTryOffice=!0),l&&l.get_shouldOfferMacOfficeTrialInFileMenu()||(p.trimmedIds.btnjTryMacOffice=!0),L.AFrameworkApplication.get_trimOICButtons()||L.AFrameworkApplication.limitedEdit?(p.trimmedIds.btnjOpenInClient=!0,p.trimmedIds.btnOpenInClient=!0,p.trimmedIds.sep1=!0,p.trimmedIds.flyoutOneNoteEdit=!0):L.AFrameworkApplication.webEditingEnabled&&!Ti.App.oneNoteMultipleAccessLevelsIsEnabled?(yi.App.get_canEdit()?p.trimmedIds.btnOpenInClient=!0:p.trimmedIds.flyoutOneNoteEdit=!0,p.trimmedIds.btnCopyAndEdit=!0,p.trimmedIds.btnEditOnWeb=!0):Ti.App.oneNoteMultipleAccessLevelsIsEnabled?p.trimmedIds.btnEditOnWeb=!0:p.trimmedIds.flyoutOneNoteEdit=!0,L.AFrameworkApplication.copyAndEditUrl?(p.trimmedIds.jbtnEditOnWeb=!0,p.trimmedIds.btnEditOnWeb=!0,p.trimmedIds.btnFlyoutEditOnWeb=!0):(p.trimmedIds.jbtnCopyAndEdit=!0,p.trimmedIds.btnCopyAndEdit=!0,p.trimmedIds.btnFlyoutCopyAndEdit=!0),Ex.f.includeCloseButton()||(p.trimmedIds.btnjClose=!0),Ti.App.get_isOneNoteEmbedded()?(p.trimmedIds.flyoutEmbedOpenInApp=!Ti.App.oneNoteEmbedShowEditFlyout,p.trimmedIds.btnOpenInClient=Ti.App.oneNoteEmbedShowEditFlyout,p.trimmedIds.flyoutOneNoteEdit=!0,p.trimmedIds.btnEditOnWeb=!0,p.trimmedIds.btnFileSharing=!0,p.trimmedIds.btnShowAuthorInfo=!0):p.trimmedIds.flyoutEmbedOpenInApp=!0,this._theViewerChrome=new Hx.k(n,this._toolbarClientIdOneNote,s,L.AFrameworkApplication.hideHeader),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsEduUser")&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteViewImmersiveReaderInEduIsEnabled")?p.trimmedIds.btnImmersiveMode=!0:p.trimmedIds.btnImmersiveModeEdu=!0,L.AFrameworkApplication.mightNeedPrivacyDialog&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TrustCenterDialogIsEnabled")||(p.trimmedIds.jbtnTrustCenter=!0);var h=new Xx(p,this._theViewerChrome.get_toolbarContainer(),this,s);h.set_dataSource(new ow.p(e._toolbarDataName,g)),h.buildToolbar(),this._theReadingBar=h.get_toolbar(),this._cuiUserFuture.execute((function(e){c._theReadingBar.set_rootUser(e)})),this._theViewerChrome.scale(),kI.o.initializeCuiScope(ex.AppFrame.readingBarFocusId,null,this._theViewerChrome.get_toolbarContentContainer(),!1,!0,!0),t.get_theF6Manager().setOnBeforeF6(ex.AppFrame.readingBarFocusId,(function(e){c._theReadingBar.commitAnyPendingChange()})),kI.o.initializeCuiScope(ex.AppFrame.readingHeaderUiFocusId,null,this._theViewerChrome.get_peripheralContentContainer(),!1,!0,!0),Dr.t.mark(4896);var _=new ge.c(2,1,100,o.i(this,this.InitialRootRefresh,"InitialRootRefresh"));L.AFrameworkApplication.get_theTaskManager().addTask(_)}return e.prototype.RibbonScopeSetFocus=function(e,t){e.name===Pe.AFrame.appFocusId?St.FocusManager.tryFocus(this.get_theReadingBar().get_element()):this.get_theReadingBar().pollForStateAndUpdate()},e.prototype.dispose=function(){this._theViewerChrome&&(this._theViewerChrome.dispose(),this._theViewerChrome=null),this._theReadingBar&&(this._theReadingBar.dispose(),this._theReadingBar=null),it.CuiHelper.disposeTopRowControls(this._topRowControls),this._topRowControls=null},e.prototype.InitialRootRefresh=function(e){this._theReadingBar.refresh(),this._theReadingBar.pollForStateAndUpdate()},e.prototype.get_theReadingBar=function(){return this._theReadingBar},e.prototype.get_theViewerChrome=function(){return this._theViewerChrome},e.prototype.onComponentBuilt=function(e,t){this._cuiUserFuture.execute((function(t){e.set_rootUser(t)}))},e._readingBarName="OneNote Reading Mode",e._toolbarDataName="OneNoteToolbarData",e}();(0,o.l)(Yx,"b56d298e$ToolbarInitializer",null,[Ux,uw.j,Sys.IDisposable]);var Zx=function(){function e(e,t,n){this._generalCuiUser=null,this._officeTrialExperience=null,this._macOfficeOffer=null,this._generalCuiUser=e,this._officeTrialExperience=t,this._macOfficeOffer=n}return e.prototype.get_TheStandaloneRoot=function(){return Ge.w.get_instance().resolve(nu.r).get_sharedStandaloneRoot()},e.prototype.createToolbarInitializer=function(e,t){return new Yx(e,t,OneNoteIntl.OneNoteStrings,this._generalCuiUser,this._officeTrialExperience,this._macOfficeOffer,e,this.get_TheStandaloneRoot())},e}();(0,o.l)(Zx,"2a2be1ba$ToolbarInitializerFactory",null,[$A.z]);var eE=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"OneNote.UI"},e.prototype.init=function(){this._container.resolve($A.z),this._container.resolve(aI).performInitChecks();var t=yi.App.get_box4Bridge().get_commandUi(),n=yi.App.get_activeAppFrame(),i=new Hc(n,t,Ge.w.get_instance().resolveFuture(ou.h)),r={};L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteFormatPainterIsEnabled")||(r.floatiefseaFormatPainter=!0),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteImageCropIsEnabled")||(r.floatiebtnImageCropDialog=!0),i.initializeFloatie(e.FloatieDataVar,[WoncaIntl.WoncaStrings,OneNoteIntl.OneNoteStrings],r),this._container.resolve(wI).initialize(),this._container.resolve(ou.h);var a={tabInsert:e.InsertTabDataVar,tabView:e.ViewTabDataVar,ctabPictureTools:e.PictureToolsTabDataVar,"ContextualTabs.Tables.Layout":e.TableLayoutTabDataVar};L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInkInputEnabled")&&(a[e.DrawTabId]=e.DrawTabDataVar),!L.AFrameworkApplication.suppressHelp&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HelpTabIsEnabled")&&(a[e.HelpTabId]=e.HelpTabDataVar),(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioPlaybackIsEnabled")||L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioRecordingIsEnabled"))&&(a[e.AudioToolsTabId]=e.AudioToolsTabDataVar),!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()||(t.ribbonAddTabsContentAsync(a).CWo((function(e){var t=Jo.f.get_instance().get_ribbon();t&&t.ensureTabsInitialized(),ar.r.get_instance().setAppInitializationStatus(7),ar.r.get_instance().isCompleted(11)||ar.r.get_instance().setAppInitializationStatus(11)}),Qn.d.onlyOnRanToCompletion|Qn.d.executeSynchronously),Qr.Ribbon.add_onRibbonTabSwitchedEventHandler(o.i(this,this.OnRibbonTabSwitched,"OnRibbonTabSwitched")))},e.prototype.OnRibbonTabSwitched=function(e,t){t.NewContextId},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e,e.register(aI).as(zA.d).as(KA.d).as(Li.d).singleInstance().usingFactory((function(){return new aI(e.resolve(ci.c),e.resolve(di),L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.appSettingsManager)})),e.register(nI).as(Mg).usingFactory((function(){return new nI(e.resolve(lu),e.resolve(du))})),e.register(qA.v).singleInstance().usingFactory((function(){return new dI})),e.register(jA.f).singleInstance().usingFactory((function(){return new gI})),e.register(pI).singleInstance().usingFactory((function(){return new pI})),e.register(QA.w).singleInstance().usingFactory((function(){return new hI})),e.register(JA.c).singleInstance().usingFactory((function(){return new mI})),e.register(XA.d).singleInstance().usingFactory((function(){return new _I})),e.register(YA.x).singleInstance().usingFactory((function(){return new CI})),e.register(ZA.b).singleInstance().usingFactory((function(){return new uI})),e.register(cI.q).as(Uc.n).singleInstance().usingFactory((function(){return new cI.q(L.AFrameworkApplication.get_theActionManager(),Ge.w.get_instance().resolve(pu),Ge.w.get_instance().resolve(Eg.d))})),e.register(Bc.f).singleInstance().usingFactory((function(){return new yI})),e.register(wI).as(Ec).singleInstance(),e.register($A.z).singleInstance().usingFactory((function(){return new Zx(Ge.w.get_instance().resolveFuture(ou.h),Ge.w.get_instance().resolve(JC.v),Ge.w.get_instance().resolve(XC.u))})),e.register(nw).as(eI).as(tI).singleInstance().usingFactory((function(){return new nw})),L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&e.register(qu).singleInstance().usingFactory((function(){return new qu(Jo.f.get_instance(),e.resolve(ru.u),e.resolve(ou.h))})),e.register(Ox).as(IC.x).singleInstance().usingFactory((function(){return new Ox(e.resolveFuture(ou.h),L.AFrameworkApplication.get_theActionManager(),St.FocusManager.instance(),e.resolve(nu.r).get_sharedStandaloneRoot(),e.resolve(ru.u),e.tryResolve(qu))}))},e.main=function(){var t=Do.get_instance();t.enableInsertTable(),t.enableSpinner(),t.enableSlider(),B.o.get_instance().registerPackage(new e,6)},e.FloatieDataVar="OneNoteFloatieData",e.InsertTabDataVar="InsertTabData",e.DrawTabDataVar="DrawTabData",e.AudioToolsTabDataVar="AudioToolsTabData",e.PictureToolsTabDataVar="PictureToolsTabData",e.TableLayoutTabDataVar="TableLayoutTabData",e.ViewTabDataVar="ViewTabData",e.HelpTabDataVar="HelpTabData",e.InsertTabId="tabInsert",e.DrawTabId="tabDraw",e.AudioToolsTabId="ContextualTabs.Audio.Tools",e.PictureToolsTabId="ctabPictureTools",e.TableLayoutTabId="ContextualTabs.Tables.Layout",e.ViewTabId="tabView",e.HelpTabId="tabHelp",e}();(0,o.l)(eE,"11eca12f$OneNoteUIPackage",null,[s.u,u.s]);var tE=n(1389),nE=n(8626),iE=(0,o.y)("93bf7f4d$IContextMenuDataProvider"),rE=n(6513),oE=n(7662),aE=n(1380),lE=n(6201),sE=n(2132),uE=(0,o.y)("5e03419e$IApplication"),cE=(0,o.y)("e3e70408$IBrowser"),dE=(0,o.y)("4f378751$IDialogService"),gE=(0,o.y)("a3179a56$IEnterViewStrategy"),pE=n(2707),hE=function(){function e(e,t,n,i,r){this._actionManager=null,this._browserCutCommand=0,this._browserCopiedCommand=0,this._browserPastedCommand=0,this._pasteGivenTextCommand=0,this._actionManager=e,this._browserCutCommand=t,this._browserCopiedCommand=n,this._browserPastedCommand=i,this._pasteGivenTextCommand=r}return e.prototype.get_ActionManager=function(){return this._actionManager},e.prototype.browserCutAsync=function(e,t){this.get_ActionManager().processActionWithDataAsync(e,this._browserCutCommand,2,t,null,null)},e.prototype.browserCopiedAsync=function(e,t){this.get_ActionManager().processActionWithDataAsync(e,this._browserCopiedCommand,2,t,null,null)},e.prototype.browserPasted=function(e,t,n){n?this.get_ActionManager().processActionWithDataAsync(e,this._browserPastedCommand,2,t,null,null):this.get_ActionManager().processActionWithData(this._browserPastedCommand,2,t)},e.prototype.pasteGivenTextSync=function(e,t,n){void 0===n&&(n=!1);var i=new Dl.DictionaryPropertySet;i.setValue(Pl.k.pastedHtmlContent,e),i.setValue(Pl.k.pastingForOvertype,t),i.setValue(Pl.k.isEndOfParagraphLastContext,n),this.get_ActionManager().processActionWithData(this._pasteGivenTextCommand,2,i)},e}();(0,o.l)(hE,"f1691d1a$ClipboardCommands",null,[fd.h]);var _E=function(){function e(){}return e.prototype.ensureSelection=function(){},e}();(0,o.l)(_E,"807e3637$NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[sf]);var mE=function(){function e(e,t,n,i,r,o){this._lockedRangeEditor=null,this._characterPropertiesEditor=null,this._autoCorrectScheduler=null,this._externalSelectionManagerFuture=null,this._trackChangeEditor=null,this._trackChangeManager=null,this._lockedRangeEditor=e,this._characterPropertiesEditor=t,this._autoCorrectScheduler=n,this._externalSelectionManagerFuture=i,this._trackChangeEditor=r,this._trackChangeManager=o}return e.prototype.InsertLineBreakView=function(t,n,i,r,o){var a=n.view,l=n.get_nextContext();if(!l)return 2;if(Gl.n.get_instance().get_item(14)&&!this._lockedRangeEditor.isEnterAllowedForContextSet(l,!0))return 2;if(this._externalSelectionManagerFuture&&this._externalSelectionManagerFuture.get_instance()&&this._externalSelectionManagerFuture.get_instance().isExternalSelectionContext(l))return 2;var s=l,u=!e.get_SplitHyperlinkFixWithEnterIsEnabled()||!e.get_HyperlinkStrategy().isIpInHyperlink(s);if(this._autoCorrectScheduler&&u&&this._autoCorrectScheduler.tryToAutocorrectAtTextBreak(s.get_node(),Re.v.vK_Enter,l.get_cpBegin()),this._characterPropertiesEditor.insertBlobAtIp(s,(function(e){return new Lm.y(e,Lm.y.defaultLineBreakText)}),cs.AParagraphNode.embeddedObjectText),this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&this._trackChangeManager.get_changeTrackingDocumentSettingEnabled()){var c=new Ma.GraphTransaction(15);try{c.setFromNode(s.get_node()),this._trackChangeEditor.setTrackChangeOnParagraph(s.get_node(),s.get_cpBegin(),s.get_cpBegin()+1,1)}finally{c&&c.dispose()}}var d=s.get_node(),g=s.get_cpEnd()+1;if(" "===Ga.ParagraphReader.text(d).charAt(g)){var p=Wa.y.createTextRange(d,g,g+1);this._characterPropertiesEditor.replaceTextRange(p,"\xa0")}var h=Wa.y.createIpContext(s.get_node(),g);return a.get_selectionManager().setSelection(Ua.SelectionFactory.createSelectionFromContext(h)),32},e.get_HyperlinkStrategy=function(){return e._hyperlinkStrategy||(e._hyperlinkStrategy=Ge.w.get_instance().resolve(my.n))},e.get_SplitHyperlinkFixWithEnterIsEnabled=function(){return null==e._splitHyperlinkFixWithEnterIsEnabled&&(L.AFrameworkApplication.appSettingsManager?e._splitHyperlinkFixWithEnterIsEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SplitHyperlinkFixWithEnterIsEnabled"):e._splitHyperlinkFixWithEnterIsEnabled=!1),e._splitHyperlinkFixWithEnterIsEnabled},e._hyperlinkStrategy=null,e._splitHyperlinkFixWithEnterIsEnabled=null,e}();(0,o.l)(mE,"2b2a42fc$InsertLineBreakStrategy",null,[]);var fE=function(){function e(){}return e.get_OutlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=Ge.w.get_instance().resolve(ql.p))},e.get_ContextSetEditor=function(){return am.ContextSetEditor.get_instance()},e.get_TrackChangeEditor=function(){return e._trackChangeEditor||(e._trackChangeEditor=Ge.w.get_instance().resolve(es.x).get_instance())},e.get_TrackChangeManager=function(){return e._trackChangeManager||(e._trackChangeManager=Ge.w.get_instance().resolve(xa.b).get_instance())},e.InsertOutlineElementView=function(t,n,i,r,o){var a,l=o;if(l&&l.hasProperty(Pl.k.targetObject)){var s=n.view.get_targetNode().get_containingObjectSpace().getObject(l.getValue(mt.h,Pl.k.targetObject));a=Wa.y.create(s)}else a=e.get_ContextSetEditor().attemptToGeneralizeToNodeContextOfType(n.get_nextContext(),11);if(!a)return 8;var u=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(a,t,i,!0,r,o);if(32===u&&2===i){var c=n;if(!c.view.get_isInteractiveView())return 2;var d=c.view,g=d.get_selectionManager().get_selectionContextForActionDispatch();if(g=e.get_ContextSetEditor().attemptToGeneralizeToNodeContextOfType(g,11)){var p=new r_.z;if(p.set(g.get_node()),p.tryToRootAtOutlineAncestor(),l&&l.hasProperty(Pl.k.targetObject))for(var h=l.getProperty_Unchecked(Pl.k.targetObject);!p.get_currentNode().get_id().equals(h);){if(!p.returnToParent())break;if(_s.OutlineElementNavigator.returnToOutlineElement(p),11!==p.get_currentNodeType())break}_s.OutlineElementNavigator.moveToPreviousOutlineElement(p,!1,!1);var _=ga.SelectionEditor.findFirstOrLastSelectableContentNode(p,!0),m=void 0;m=Ga.ParagraphReader.canContainIpOrTextRange(_)?Ua.SelectionFactory.createIpSelection(_,0):Ua.SelectionFactory.createSelectionFromNode(_),d.get_selectionManager().setSelection(m)}}return u},e.InsertOutlineElement=function(t,n,i,r,o){var a=t===Oi.u.insertOEAbove,l=n.get_node(),s=o;if(s&&s.hasProperty(Pl.k.targetObject)&&!l.get_id().equals(s.getProperty_Unchecked(Pl.k.targetObject)))return 2;if(1===i)return 32;var u=new ha.g;u.set(l),u.tryToRootAtAncestorOfType(10);e.get_OutlineElementEditor().insertOutlineElementAsSibling(u,a,!0);if(e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()){var c=_s.OutlineElementNavigator.moveToContent(u);e.get_TrackChangeEditor().setTrackChangeEop(c,1)}return 32},e._outlineElementEditor=null,e._trackChangeEditor=null,e._trackChangeManager=null,e}();(0,o.l)(fE,"546b49f3$InsertOutlineElementStrategy",null,[]);var yE=function(){function e(e,t,n,i,r,o,a,l,s){this._autoCorrectScheduler=null,this._enterActor=null,this._insertionPointFormatting=null,this._listEditor=null,this._outlineElementEditor=null,this._lockedRangeEditor=null,this._selectionManager=null,this._selectionFactory=null,this._contentControlConverterFuture=null,this._autoCorrectScheduler=t,this._enterActor=e,this._insertionPointFormatting=r,this._listEditor=i,this._outlineElementEditor=n,this._lockedRangeEditor=o,this._selectionManager=a,this._selectionFactory=l,this._contentControlConverterFuture=s}return e.prototype.NewLineView=function(e,t,n,i,r){var o=t;if(!o.view.get_isInteractiveView())return 2;var a=o.view,l=null;a.get_isPageView()&&(l=a);var s=a.get_selectionManager().get_selectionContextForActionDispatch(),u=!0,c=!1,d=null;if(!s)return 2;var g=new Ma.GraphTransaction(15);g.setFromNode(a.get_targetNode());var p=null;2===n&&((p=new r_.z).set(s.get_node()),p.tryToRootAtOutlineAncestor(),d=new i_(p),2===yi.App.get_mode()&&ga.SelectionEditor.isInsertionPointContext(s)&&(p.returnToNodeOfType(11)&&gs.ListReader.isListOutlineElement(p)&&Ss.OutlineElementReader.isEmpty(p,!1)&&(u=!1),u&&yi.App.get_theCoauthManager().get_isCoauthorable()&&Ss.OutlineElementReader.isIpAtStartOrEnd(p,s,!1)&&!Ss.OutlineElementReader.isIpAtStartOrEnd(p,s,!0)&&(u=!1)),_s.OutlineElementNavigator.returnToOutlineElement(p),Ss.OutlineElementReader.isEmpty(p,!1)&&(vb.b.isOutlineElementWithNoteTags(p)&&(u=!1),1===yi.App.get_mode()&&gs.ListReader.isListOutlineElement(p)&&(c=!0)));var h=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(s,e,n,!1,i,r);if(u&&32===h&&2===n){if(!c){var _=!ga.SelectionEditor.isInsertionPointContext(s);_s.OutlineElementNavigator.moveToNextOrPreviousOutlineElement(p,!1,_,!1)}c&&d&&d.restore(p),Gl.n.get_instance().get_item(101)&&this._insertionPointFormatting.freeze(),a.get_selectionManager().setSelection(Ua.SelectionFactory.createCollapsedSelection(p.get_currentNode(),!0)),Gl.n.get_instance().get_item(101)&&this._insertionPointFormatting.thaw(),this._enterActor.get_UndoManager().interruptUndoMerging()}return l&&(u||l.scrollSelectionIntoView()),Dy.o.get_instance().updateVisibilityFromInputMethod(1),g.dispose(),h},e.prototype.NewLine=function(e,t,n,i,r){var o=!1;(pa.ImageReader.isInlineImageContext(t)||pa.ImageReader.isAnchoredImageContext(t))&&(t=this.ConvertImageContextToIpContext(t),o=!0);var a=t,l=ga.SelectionEditor.isInsertionPointContext(t);if(l&&this._lockedRangeEditor.get_isContentControlEditingEnabled()&&!this._lockedRangeEditor.isNewLineAllowedForIp(a))return 2;if(1===n)return 32;var s=a.get_node(),u=new ha.g;u.set(s),u.tryToRootAtOutlineAncestor(),_s.OutlineElementNavigator.returnToOutlineElement(u);var c=new Ma.GraphTransaction(15);if(c.setFromIterator(u),l){this._contentControlConverterFuture.get_instance()&&this._contentControlConverterFuture.get_instance().tryToConvertInlineContentControlToBlock(a);var d=!0;if(Gl.n.get_instance().get_item(101)&&Ga.ParagraphReader.isParagraphNode(s)&&a.get_cpBegin()===Ga.ParagraphReader.textLength(s)&&Cd.f.shouldCarryForwardFormattingFromIp(a)){9===Ga.ParagraphReader.getOutlineLevel(s)&&this._insertionPointFormatting.copyRunFormatting(a)}if(1===yi.App.get_mode()&&Ss.OutlineElementReader.isEmpty(u,!1)&&gs.ListReader.isListOutlineElement(u)&&(d=!1),this._listEditor.setListInfoAndInsertNewOE(u,d,a,s),this._autoCorrectScheduler&&this._autoCorrectScheduler.tryToAutocorrectAtTextBreak(s,Re.v.vK_Enter,a.get_cpBegin()),o){_s.OutlineElementNavigator.moveToNextOutlineElement(u,!1,!1);var g=u.goToFirstChildByRole(2),p=this._selectionFactory.createIpSelection(g,0);p&&this._selectionManager.setSelection(p)}}else this._outlineElementEditor.insertOutlineElementAsSibling(u,!0,!0);return c.dispose(),yi.App.get_activeAppFrame()&&yi.App.get_activeAppFrame().updateCommandUI(),32},e.prototype.ConvertImageContextToIpContext=function(t){var n,i=t;if(pa.ImageReader.isInlineImageContext(t))n=Wa.y.createIpContext(i.get_node(),i.get_cpBegin());else{var r=Ga.ParagraphReader.containingParagraph(i.get_node()),o=r.get_properties().getProperty_Unchecked(os.j.runIds),a=i.get_node().get_properties().getValue(Number,os.j.runId),l=r.get_characterProperties(),s=e.GetCpForRunId(a,o,l);n=Wa.y.createIpContext(r,s)}return n},e.FindRunIndexInRunIdsForRunId=function(e,t){for(var n=0;n<t.length&&!(e<t[n]);)n++;return n},e.GetCpForRunId=function(t,n,i){var r=0,o=e.FindRunIndexInRunIdsForRunId(t,n),a=0;if(o===n.length)a=i.get_length()-1;else for(;a<i.get_length();){var l=i.get_item(a);if(l.get_formatting()&&l.get_formatting().runIndex===o)break;a++}a<i.get_length()&&(r=i.get_item(a).get_cp());return r},e}();(0,o.l)(yE,"8fb87a28$NewLineStrategy",null,[]);var CE=function(){function e(e,t,n,i,r,o,a,l,s,u,c,d,g,p){this._undoManager=null,this._undoManagerFactory=null,this._enterViewStrategyLazy=null,this._newLineStrategy=null,this._insertLineBreakStrategy=null,this._undoManagerFactory=e,this._enterViewStrategyLazy=o,this._newLineStrategy=new yE(this,t,n,i,r,a,u,c,p),this._insertLineBreakStrategy=new mE(a,l,t,s,d,g)}return e.prototype.get_UndoManager=function(){return this._undoManager||(this._undoManager=this._undoManagerFactory())},e.prototype.registerActions=function(){var e=L.AFrameworkApplication.get_theActionManager(),t=o.i(this._newLineStrategy,this._newLineStrategy.NewLine,"NewLine");e.addActionWithFlags(Oi.u.enter,ol.d.view,o.i(this._enterViewStrategyLazy.get_value(),this._enterViewStrategyLazy.get_value().enterView,"enterView"),1124),e.addActionWithFlags(Oi.u.shiftEnter,ol.d.view,o.i(this._enterViewStrategyLazy.get_value(),this._enterViewStrategyLazy.get_value().shiftEnterView,"shiftEnterView"),1124),e.addAction(Oi.u.newLine,ol.d.view,o.i(this._newLineStrategy,this._newLineStrategy.NewLineView,"NewLineView")),e.addAction(Oi.u.newLine,ol.d.insertionPoint,t),e.addAction(Oi.u.newLine,ol.d.image,t),e.addAction(Oi.u.newLine,ol.d.textRange,t),e.addAction(Oi.u.newLine,ol.d.anchoredObject,t),e.addAction(Oi.u.newLine,ol.d.embeddedFile,t),e.addAction(Oi.u.newLine,ol.d.ink,t),e.addAction(Oi.u.newLine,ol.d.paragraph,t),e.addAction(Oi.u.newLine,ol.d.iFrame,t),e.addAction(Oi.u.newLine,ol.d.unsupportedObject,t),e.setActionFlags(Oi.u.newLine,1124),e.addActionWithFlags(Oi.u.insertLineBreak,ol.d.view,o.i(this._insertLineBreakStrategy,this._insertLineBreakStrategy.InsertLineBreakView,"InsertLineBreakView"),1028),e.addAction(Oi.u.insertOEAbove,ol.d.view,fE.InsertOutlineElementView),e.addAction(Oi.u.insertOEAbove,ol.d.outlineElement,fE.InsertOutlineElement),e.setActionFlags(Oi.u.insertOEAbove,1092)},e.get_instance=function(){return e._instance||(e._instance=e.GetInstanceWithResolvedDependencies())},e.GetInstanceWithResolvedDependencies=function(){return new e((function(){return Ge.w.get_instance().resolve(wa.n)}),Ge.w.get_instance().tryResolve(Ia.g),Ge.w.get_instance().resolve(ql.p),Ge.w.get_instance().resolve(jl.v),Ge.w.get_instance().resolve(Fg.c),Ge.w.get_instance().resolveLazy(gE),za.k.get_instance(),Ge.w.get_instance().resolve(ba.x),Ge.w.get_instance().resolveFuture(kg.i),fa.SelectionManager.get_instance(),Ge.w.get_instance().resolve(Kd),Ge.w.get_instance().resolve(es.x).get_instance(),Ge.w.get_instance().resolve(xa.b).get_instance(),Ge.w.get_instance().resolveFuture(Zl.t))},e._instance=null,e}();(0,o.l)(CE,"81ba782$EnterActor",null,[]);var SE=n(8593),bE=function(){function e(e,t,n){this._autoCorrectScheduler=null,this._undoManagerLazy=null,this._externalSelectionManagerFuture=null,this._autoCorrectScheduler=e,this._undoManagerLazy=t,this._externalSelectionManagerFuture=n}return e.prototype.get_UndoManager=function(){return this._undoManagerLazy.get_value()},e.prototype.enterView=function(t,n,i,r,o){var a,l,s;if(!this.ShouldProcessEnterView(n,i,!1,(0,g.m)((function(){return a}),(function(e){return a=e})),(0,g.m)((function(){return l}),(function(e){return l=e})),(0,g.m)((function(){return s}),(function(e){return s=e}))))return s;Dr.t.mark(5013);for(var u=e.get_contextSetEditor().breakDownContextSets(l),c=0;c<u.length;++c)if(u[c].get_isValid()){if((h=u[c].get_iterator()).tryToRootAtPageContent(),ys.OutlineReader.isOutline(h))return this.EnterAtOutlineHelper(a,h);if(Qs.q.isInTitle(h))return SE.f.get_instance().leaveTitle(t,l,a),this.get_UndoManager().interruptUndoMerging(),Dr.t.mark(5014),32}var d=this.getEnterViewNextAction(l);if(l.get_isContextSet()||ga.SelectionEditor.isTextRangeContext(l)||Ga.ParagraphReader.isParagraphContext(l)&&!ga.SelectionEditor.isBlockContext(l)){if(e.get_FeatureHelper()&&e.get_FeatureHelper().isFeatureEnabled(31)){var p=null;if(am.ContextSetEditor.get_instance().shrinkContextSetForDeleteAction(l,(0,g.m)((function(){return p}),(function(e){return p=e}))))return 8}s=this.EnterAtRangeSelectionHelper(n,a,t,r,o,d)}else if(ga.SelectionEditor.isEndOfParagraphContext(l))s=this.EnterAtEopHelper(n,a,t,r,o,d);else if(ga.SelectionEditor.isInsertionPointContext(l)){var h;if((h=new ha.g).set(l.get_node()),h.tryToRootAtAncestorOfType(10),this.needCheckHyperLink()){var _=l,m=Ha.HyperlinkReader.getHyperlinksInRange(_,!1);if(m.length>0)return m[0].hyperlink?(yi.App.followUrl(m[0].hyperlink.get_url()),32):(S.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",m[0].cpBegin,m[0].cpEnd),8)}if(js.TableCellReader.isInTableCell(h)&&!Gl.n.get_instance().get_item(77)&&(Pd.TableNavigator.returnToContainingCell(h),Gl.n.get_instance().get_item(30)&&js.TableCellReader.isLastCellInTable(h)&&!ys.OutlineReader.hasMultipleOutlineElements(h)&&ys.OutlineReader.isIpAtStartOrEnd(h,l,!0)&&(fs.OutlineNavigator.moveToFirstOutlineElement(h),gs.ListReader.isListOutlineElement(h)||(d=Oi.u.insertRowBelow),Pd.TableNavigator.returnToCell(h)),js.TableCellReader.isFirstCellInRow(h))){var f=new ha.g;if(f.setFrom(h),Pd.TableNavigator.returnToContainingRow(f),Gl.n.get_instance().get_item(30)&&Dd.v.isLastRowInTable(f)&&Dd.v.isEmpty(f)&&us.TableReader.getRowCount(Pd.TableNavigator.getContainingTable(f))>1)d=Oi.u.deleteRow;else if(ys.OutlineReader.isIpAtStartOrEnd(h,l,!1)){var y=l;Dd.v.isFirstRowInTable(f)&&y.get_ccBoundaryIdxAtCpBegin()<=0?(d=Oi.u.insertOEAbove,Pd.TableNavigator.returnToContainingTable(h),_s.OutlineElementNavigator.returnToOutlineElement(h),o||(o=new Dl.DictionaryPropertySet),o.setProperty_Unchecked(Pl.k.targetObject,h.get_currentNode().get_id())):Gl.n.get_instance().get_item(30)&&(d=Oi.u.insertRowAbove)}}s=this.EnterProcessNextActionHelper(n,a,t,r,o,d)}else ga.SelectionEditor.isBlockContext(l)&&(s=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,Oi.u.newLine,2,!1,r,o));return Dr.t.mark(5014),s},e.prototype.ShouldProcessEnterView=function(t,n,i,r,o,a){if(r.val=null,o.val=null,1===n)return a.val=32,!1;var l=t;return l.view.get_isInteractiveView()?(r.val=l.view,o.val=r.val.get_selectionManager().get_selectionContextForActionDispatch(),o.val?Gl.n.get_instance().get_item(14)&&!e.get_LockedRangeEditor().isEnterAllowedForContextSet(o.val,i)?(a.val=2,!1):this._externalSelectionManagerFuture&&this._externalSelectionManagerFuture.get_instance()&&this._externalSelectionManagerFuture.get_instance().isExternalSelectionContext(o.val)?(a.val=4,!1):(a.val=2,!0):(a.val=2,!1)):(a.val=2,!1)},e.prototype.shiftEnterView=function(t,n,i,r,o){var a,l,s;if(!this.ShouldProcessEnterView(n,i,!0,(0,g.m)((function(){return a}),(function(e){return a=e})),(0,g.m)((function(){return l}),(function(e){return l=e})),(0,g.m)((function(){return s}),(function(e){return s=e}))))return s;for(var u=e.get_contextSetEditor().breakDownContextSets(l),c=0;c<u.length;++c)if(u[c].get_isValid()){var d=u[c].get_iterator();if(d.tryToRootAtPageContent(),ys.OutlineReader.isOutline(d))return this.EnterAtOutlineHelper(a,d)}return l.get_isContextSet()||ga.SelectionEditor.isTextRangeContext(l)?s=this.EnterAtRangeSelectionHelper(n,a,t,r,o,Oi.u.insertLineBreak):ga.SelectionEditor.isEndOfParagraphContext(l)?s=this.EnterAtEopHelper(n,a,t,r,o,Oi.u.insertLineBreak):ga.SelectionEditor.isInsertionPointContext(l)?s=this.EnterProcessNextActionHelper(n,a,t,r,o,Oi.u.insertLineBreak):ga.SelectionEditor.isBlockContext(l)&&(s=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,Oi.u.newLine,2,!1,r,o)),s},e.prototype.EnterAtOutlineHelper=function(e,t){return e.get_selectionManager().setSelection(Ua.SelectionFactory.createCollapsedSelection(t.get_currentNode(),!1)),32},e.prototype.EnterAtRangeSelectionHelper=function(e,t,n,i,r,o){var a,l=new Ma.GraphTransaction(15);l.set_undoActionId(n),l.setFromNode(t.get_targetNode());var s=new Dl.DictionaryPropertySet;return s.setValue(Pl.k.doNotDeleteTableSegments,!0),32===(a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(e,Oi.u.deleteKey,2,!0,i,s))&&(a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(e,o,2,!1,i,r)),l.dispose(),a},e.prototype.EnterAtEopHelper=function(e,t,n,i,r,o){var a,l=new Ma.GraphTransaction(15);return l.set_undoActionId(n),l.setFromNode(t.get_targetNode()),t.get_selectionManager().setSelection(ga.SelectionEditor.collapseToIp(t.get_selectionManager().get_selectionCollection().get_item(0),!1,!1)),a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(e,o,2,!1,i,r),l.dispose(),a},e.prototype.EnterProcessNextActionHelper=function(e,t,n,i,r,o){var a,l=new Ma.GraphTransaction(15,n);return l.set_undoActionId(n),l.setFromNode(t.get_targetNode()),a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(e,o,2,!1,i,r),l.dispose(),a},e.get_contextSetEditor=function(){return am.ContextSetEditor.get_instance()},e.get_LockedRangeEditor=function(){return za.k.get_instance()},e.get_FeatureHelper=function(){return e._featureHelper||(e._featureHelper=Ge.w.get_instance().tryResolve(Yh.d))},e._featureHelper=null,e}();(0,o.l)(bE,"9f28815e$AEnterViewStrategy",null,[gE]);var vE=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}return(0,v.t)(t,e),t.prototype.getEnterViewNextAction=function(e){return Oi.u.newLine},t.prototype.needCheckHyperLink=function(){return!0},t}(bE);(0,o.l)(vE,"33edf8bf$EnterViewStrategy",bE,[]);var TE=function(){function e(){}return e.prototype.setFontName=function(e,t){},e}();(0,o.l)(TE,"a962c3e7$FontNameFormattingStrategyNoop",null,[Dg]);var AE=n(5570),IE=function(){function e(e,t,n,i,r,o,a,l,s,u,c,d,g){this._styleEditor=null,this._insertionPointFormatting=null,this._formattingEditor=null,this._paragraphEditor=null,this._paragraphReader=null,this._listEditor=null,this._listReader=null,this._characterPropertiesEditor=null,this._lockedRangeEditor=null,this._featureHelper=null,this._trackChangeManager=null,this._trackChangeEditor=null,this._textFormattingHelper=null,this._characterFormattings=null,this._paragraphStyles=null,this._paragraphProperties=null,this._sourceContextId=0,this._isBrushActive=!1,this._formatPainterStrategy=null,this._eventSource=new at.f,this._styleEditor=e,this._insertionPointFormatting=t,this._formattingEditor=n,this._paragraphEditor=i,this._paragraphReader=r,this._listEditor=o,this._listReader=a,this._characterPropertiesEditor=l,this._lockedRangeEditor=s,this._featureHelper=u,this._trackChangeManager=c,this._trackChangeEditor=d,this._textFormattingHelper=g}return e.prototype.get_EndOfParagraphFormattingIsEnabled=function(){return!!Gl.n.get_instance().get_item(105)&&(this._featureHelper?this._featureHelper.isFeatureEnabled(49):L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("Box4EndOfParagraphFormattingIsEnabled"))},e.prototype.get_FormatPainterStrategy=function(){return this._formatPainterStrategy||(this._formatPainterStrategy=Ge.w.get_instance().resolve(AE.n))},e.prototype.get_isBrushActive=function(){return this._isBrushActive},e.prototype.set_isBrushActive=function(t){return this._isBrushActive!==t&&(this._isBrushActive=t,this._eventSource.raiseEvent(e.BrushActiveStatusChangedEventKey)),t},e.prototype.add_brushStatusChanged=function(t){this._eventSource.addHandler(e.BrushActiveStatusChangedEventKey,t)},e.prototype.remove_brushStatusChanged=function(t){this._eventSource.removeHandler(e.BrushActiveStatusChangedEventKey,t)},e.prototype.pickFormatFromSelection=function(e){var t=e.get_firstContext();S.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",t.get_contextId()),this.Reset();var n=t.get_node(),i=this.IsMultipleParagraphsSelected(e);if(this.get_FormatPainterStrategy().shouldPickParaProps(t.get_contextId(),i))try{this._paragraphProperties=this._paragraphReader.getParagraphProperties(n)}catch(e){throw S.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",e.message),e}this._paragraphStyles=bs.StyleReader.getStyleFromParagraphNode(n);var r=vc.FormattingReader.getFormattingObject(t);r.get_formattingContainer()&&(this._characterFormattings=(0,y.e)(Es.t,r.get_formattingContainer().clone())),this._sourceContextId=i?ol.d.paragraph:t.get_contextId(),this.get_FormatPainterStrategy().adjustFormats(t.get_node(),this._paragraphProperties,this._characterFormattings)},e.prototype.applyFormatToSelection=function(e){for(var t=Gl.n.get_instance().get_item(14),n=this.IsMultipleParagraphsSelected(e),i=0;i<e.get_length();i++){var r=e.get_item(i);if(r.get_isGraphNodeContext()){var o=r,a=!1;if(o.get_contextId()===ol.d.insertionPoint||o.get_contextId()===ol.d.textRange)a=t&&this._lockedRangeEditor.isIpOrTextRangeContextInLockedRange(o);else if(o.get_contextId()===ol.d.paragraph)a=t&&this._lockedRangeEditor.isParaContextInLockedRange(o);else{if(o.get_contextId()!==ol.d.endOfParagraph){S.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",o.get_contextId());continue}a=t&&this._lockedRangeEditor.isEopContextInLockedRange(o)}if(S.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",o.get_contextId()),a){S.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");continue}var l=(0,y.e)(cs.AParagraphNode,o.get_node()),s=!1;l&&(s=o.get_contextId()===ol.d.textRange&&!!l&&!o.get_cpBegin()&&o.get_cpEnd()===this._paragraphReader.textLength(l));var u=this.get_FormatPainterStrategy().shouldApplyParaProps(this._sourceContextId,o.get_contextId(),n,s);if(u)try{Ga.ParagraphReader.isParagraphNode(l)?(this._paragraphStyles&&this._styleEditor.setStyleOnParagraphNode(this._paragraphStyles,l,!0),this._paragraphEditor.applyParagraphProperties(l,this._paragraphProperties)):S.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",o.get_node().get_type())}catch(e){throw S.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",e.message),e}var c=o;if(o.get_contextId()===ol.d.paragraph)c=Wa.y.createTextRange(l,0,Ga.ParagraphReader.textLength(l));else if(o.get_contextId()===ol.d.insertionPoint){var d=this._insertionPointFormatting.getSelectionForIpFormatting(o);c=fa.SelectionManager.createMultiRangeOrGraphContext(d)}if(c&&c.get_contextId()===ol.d.textRange)try{this.applyFormattingsToTextRange(c,this._characterFormattings,u?null:this._paragraphStyles)}catch(e){throw S.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",e.message),e}if(o.get_contextId()===ol.d.paragraph||o.get_contextId()===ol.d.endOfParagraph){var g=new ha.g;g.set(l),g.tryToRootAtOutlineAncestor(),g.returnToAncestorOfType(11);var p=gs.ListReader.isListOutlineElement(g),h=!Ga.ParagraphReader.textLength(l);if(S.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",p,h),p){this._listReader.moveToList(g);var _=g.get_currentNode();this._listReader.isListNode(_)&&this._listEditor.setListFormatting(_,l,this._characterFormattings)}else this.get_EndOfParagraphFormattingIsEnabled()&&this.applyFormattingsToEndOfParagraph(o,this._characterFormattings)}}else S.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",r.get_contextId())}},e.prototype.applyFormattingsToEndOfParagraph=function(e,t){if(t){var n=e.get_node(),i=n.get_characterProperties().get_last(),r=this._characterPropertiesEditor.ensureEndOfParagraphFormatting(n),o=r.cloneUnderDifferentChp(r.get_containingProperties());this.applyFormattingsToTextRangeCore(r,t,null),this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&this._trackChangeEditor.setFormattingTrackChangeOnParagraph(n,i,e.get_cpBegin(),e.get_cpEnd(),o,r,this._trackChangeManager.get_changeTrackingDocumentSettingEnabled())}},e.prototype.applyFormattingsToTextRange=function(e,t,n){var i=this;(t||n)&&(Cd.f.getBlobObjectsInRange(e).length>0&&S.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this._textFormattingHelper.applyCharacterFormattingOnTextRange(e,(function(e){i.applyFormattingsToTextRangeCore(e,t,n)})))},e.prototype.applyFormattingsToTextRangeCore=function(e,t,n){this._formattingEditor.clearCharacterFormatting(e),e.get_formattingContainer()&&e.get_formattingContainer().removeProperty(is.b.highlight),this._formattingEditor.clearCharacterStyle(e),this.copyProperties(e,n),this.copyProperties(e,t)},e.prototype.copyProperties=function(e,t){if(t){var n=e.get_paragraph().get_containingObjectSpace();if(n){var i,r=e.get_formattingContainer();r=r?(0,y.e)(xs.b,r.clone()):Es.t.constructExtendedSharedPropertySet(1179725);for(var o=0,a=t.listProperties();o<a.length;o++){var l=a[o];if(l!==os.j.atMentionBookmarkName&&l!==os.j.fieldInstruction&&l!==is.b.isLink&&l!==is.b.isLinkProtected&&l!==os.j.isDeadLink&&l!==is.b.languageID&&l!==os.j.languageHint&&l!==os.j.noProof){if(l===rs.o.characterStyle){var s=t.getValueWithDefault(mt.h,rs.o.characterStyle,mt.h.get_nil());if(s!==mt.h.get_nil()){var u=(0,y.e)(Es.t,n.getObject(s)),c=bs.StyleReader.getStyleName(u);if(c===Box4Intl.Box4Strings.L_StyleWordHyperlink){var d=bs.StyleReader.getStyleSetFromParagraphNode(e.get_paragraph()).getStyleByName(c);r.copyProperties(d);continue}}}r.setValue(l,t.getProperty_Unchecked(l))}}r.get_isSharable()?i=n.registerSharedObject(r):(n.registerObject(r),i=r),e.set_formattingId(i.get_id())}}},e.prototype.IsMultipleParagraphsSelected=function(e){return!e.get_containsSingleContext()&&e.get_lastContext().get_contextId()!==ol.d.endOfParagraph},e.prototype.Reset=function(){this._characterFormattings=null,this._paragraphStyles=null,this._paragraphProperties=null,this._sourceContextId=ol.d.none},e.BrushActiveStatusChangedEventKey="FormatPainterBrushActiveStatusChanged",e}();(0,o.l)(IE,"afc82517$FormatPainter",null,[pc.w]);var wE=function(){function e(e,t,n,i,r,o,a){void 0===a&&(a=!1),this._appFrame=null,this._focusManager=null,this._actionManager=null,this._activityManager=null,this._selectionReader=null,this._formatPainter=null,this._isCtrlShiftVReserved=!1,this._isRegisteredOnChangingPageOrMode=!1,this._formatPainterCursorPages=new Xg(Number),this._appFrame=e,this._focusManager=t,this._actionManager=n,this._activityManager=i,this._selectionReader=r,this._formatPainter=o,this._isCtrlShiftVReserved=a}return e.prototype.get__formatPainterCursorName=function(){return W.y.get_isInternetExplorerEdge()||W.y.get_isSafari9Up()?"url("+Wy.f.box4Image("FormatPainterText.cur")+"), pointer":'url("'+Wy.f.box4Image("FormatPainterText.cur")+'"), pointer'},e.prototype.registerActions=function(){var e=this,t=this._focusManager.getScope(Yc.u.editingFocusID);t.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_Esc,0),Oi.u.formatPainterCancel),t.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_C,6),Oi.u.formatPainterPick),this._isCtrlShiftVReserved||t.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_V,6),Oi.u.formatPainterApply),this._actionManager.addActionWithFlags(Oi.u.formatPainterPick,ol.d.view,o.i(this,this.handleFormatPainterPick,"handleFormatPainterPick"),4),this._actionManager.addActionWithFlags(Oi.u.formatPainterApply,ol.d.view,o.i(this,this.HandleFormatPainterApply,"HandleFormatPainterApply"),4),this._actionManager.addActionWithFlags(Oi.u.formatPainterCancel,ol.d.view,o.i(this,this.handleFormatPainterCancel,"handleFormatPainterCancel"),4),this._formatPainter.add_brushStatusChanged((function(t,n){e.updateUI(e._formatPainter.get_isBrushActive())}))},e.prototype.handleFormatPainterCancel=function(e,t,n,i,r){return this._formatPainter.set_isBrushActive(!1),32},e.prototype.handleFormatPainterPick=function(e,t,n,i,r){var a=!1,l=this._selectionReader.get_firstContextForCurrentSelection();if(l){switch(l.get_contextId()){case ol.d.textRange:case ol.d.paragraph:case ol.d.endOfParagraph:case ol.d.insertionPoint:a=!0}a&&ga.SelectionEditor.isTextRangeContext(l)&&Cd.f.containsNonFormattableBlobs(l)&&(this._activityManager.recordEvent(ah.f.noApply,{Reason:lh.i.containsNonFormattableBlob}),a=!1)}if(1===n||!a)return a?32:8;if(6!==this._actionManager.get_commandLocation()){if(this._formatPainter.get_isBrushActive())S.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button");else if(S.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this._formatPainter.pickFormatFromSelection(this._selectionReader.get_currentSelection()),!this._isRegisteredOnChangingPageOrMode){this._appFrame.add_modeSwitched(o.i(this,this.UpdateCursorOnModeSwitched,"UpdateCursorOnModeSwitched"));var s=this._appFrame.workspace.get_activeView();s&&s.get_isPageView()&&s.add_initialSelectionSet(o.i(this,this.UpdateCursorOnInitialSelection,"UpdateCursorOnInitialSelection")),this._isRegisteredOnChangingPageOrMode=!0}this._formatPainter.set_isBrushActive(!this._formatPainter.get_isBrushActive())}else S.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this._formatPainter.pickFormatFromSelection(this._selectionReader.get_currentSelection()),this._formatPainter.set_isBrushActive(!1);return 32},e.prototype.HandleFormatPainterApply=function(e,t,n,i,r){if(6===this._actionManager.get_commandLocation()||this._formatPainter.get_isBrushActive()){S.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this._actionManager.get_commandLocation());var o=this._appFrame.get_theStopwatchBuilder().makeAndStartStopwatch("UserAction","FormatPainterApply"),a=new Ma.GraphTransaction(15);a.set(this._selectionReader.get_firstNodeForCurrentSelection().get_containingGraph()),this._formatPainter.applyFormatToSelection(this._selectionReader.get_currentSelection()),this._formatPainter.set_isBrushActive(!1),a.dispose(),o.stop()}return 32},e.prototype.updateUI=function(e){var t=this._appFrame.get_theStopwatchBuilder().makeAndStartStopwatch("UserAction","FormatPainterUpdateCursor");this.OnUpdateCursor(e),this._appFrame.updateCommandUI(),t.stop()},e.prototype.UpdateCursorOnElementCollection=function(e,t){for(var n=0;n<e.length;n++)this.UpdateCursorOnElement(e[n],t);var i=this._appFrame.workspace.get_activeView();if(i&&i.get_isInteractiveView()){var r=i.get_editingDom().get_editingElement();this.UpdateCursorOnElement(r,t)}},e.prototype.UpdateCursorOnElement=function(e,t){e.style.cursor=t?this.get__formatPainterCursorName():""},e.prototype.UpdateCursorOnModeSwitched=function(e){this.OnUpdateCursor(this._formatPainter.get_isBrushActive())},e.prototype.UpdateCursorOnInitialSelection=function(e,t){this.OnUpdateCursor(this._formatPainter.get_isBrushActive())},e.prototype.OnUpdateCursor=function(e){var t=document.querySelectorAll(".OutlineElement");if(t.length>1){var n=t[t.length-2].style.cursor===this.get__formatPainterCursorName();if(this._appFrame.workspace.get_isEditingAllowed()){if((e&&!n||!e&&n)&&(this.UpdateCursorOnElementCollection(t,e),this.UpdateFormatPainterCursorPages(e)),!e&&this._isRegisteredOnChangingPageOrMode&&!this._formatPainterCursorPages.get_count()){this._appFrame.remove_modeSwitched(o.i(this,this.UpdateCursorOnModeSwitched,"UpdateCursorOnModeSwitched"));var i=this._appFrame.workspace.get_activeView();i&&i.get_isPageView()&&i.remove_initialSelectionSet(o.i(this,this.UpdateCursorOnInitialSelection,"UpdateCursorOnInitialSelection")),this._isRegisteredOnChangingPageOrMode=!1}}else n&&(this.UpdateCursorOnElementCollection(t,!1),this.UpdateFormatPainterCursorPages(!1))}},e.prototype.UpdateFormatPainterCursorPages=function(e){var t=this._appFrame.workspace.get_activeView();t&&(e?this._formatPainterCursorPages.add(t.get_targetNode().get_uniqueKey()):this._formatPainterCursorPages.remove(t.get_targetNode().get_uniqueKey()))},e}();(0,o.l)(wE,"4e882dc$FormatPainterActor",null,[]);var xE=n(290),EE=function(e){function t(t,n,i,r,o,a,l){var s=this;return s._droppedFile=null,s.isSuccessful=!1,(s=e.call(this,t,n,i,null,o,a)||this).dialogMode=!1,s.useFilePicker=!1,s.isSuccessful=!1,s._droppedFile=r,s}return(0,v.t)(t,e),t.prototype.get_uploadMode=function(){return"DragDropInsertImage"},t.prototype.showDialog=function(){},t.prototype.submitForm=function(e){var t=new sT.w(this._droppedFile.name,this._droppedFile);e.submitFormWithBlob(t)},t.prototype.finalizeUpload=function(e,t){this.insertPlaceholder()&&(this.replicatePlaceholder(e),this.isSuccessful=!0)},t}(Oy.e);(0,o.l)(EE,"5370e8b0$DragDropInsertImageUploader",Oy.e,[]);var FE=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,CommonUIStrings.l_AlternativeTextDialogLabel)},e.DialogHtmlFormat="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='titleText' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='500' autocomplete=\"off\"/> </div>",e}();(0,o.l)(FE,"4b267f3e$AltTextDialogHtml",null,[]);var PE=function(e){function t(n){var i=this;i._containingNode=null,i._imageProperties=null,(i=e.call(this)||this)._containingNode=n.get_node(),i._imageProperties=pa.ImageReader.getImagePropertiesFromContext(n),i.set_dialogHtml(FE.get_dialogHtml());var r={titleText:pa.ImageReader.getImageAltText(i._imageProperties)};i.set_dialogId(t.Id),i.initializeAndShow(CommonUIStrings.l_AlternativeTextDialogTitle,o.i(i,i.AltTextDialogHandler,"AltTextDialogHandler"),r);var a=document.getElementById("titleText");return a.focus(),a.select(),i}return(0,v.t)(t,e),t.prototype.AltTextDialogHandler=function(e,n){if(1===e){this.hide();var i=new Ma.GraphTransaction(15);i.setFromNode(this._containingNode),t.get_ImageEditor().setImageAltText(this._imageProperties,n.titleText),i.dispose()}Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()&&yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(this._containingNode)},t.get_ImageEditor=function(){return t._imageEditor||(t._imageEditor=Ge.w.get_instance().resolve(Za.w))},t.Id="AltTextDialog",t._imageEditor=null,t}(Bi.o);(0,o.l)(PE,"d192d31d$AltTextDialog",Bi.o,[]);var DE=function(){function e(e,t,n,i,r){this.minImageWidthMu=0,this.minImageHeightMu=0,this.maxImageWidthMu=0,this.maxImageHeightMu=0,this._imageEditor=null,this._externalSelectionManagerFuture=null,this.trackChangeManager=null,this._undoManager=null,this._actionManager=null,this._selectionManager=null,this._isSupportImageDragDropExternalEnabled=!1,this._imageEditor=e,this._externalSelectionManagerFuture=t,this.trackChangeManager=n,this._undoManager=i,this._selectionManager=r,this._isSupportImageDragDropExternalEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SupportImageDragDropExternalIsEnabled")}return e.prototype.get_pageReader=function(){return $s.PageReader.get_instance()},e.prototype.get_ExternalSelectionManager=function(){return this._externalSelectionManagerFuture.get_instance()},e.prototype.get_undoManager=function(){return this._undoManager},e.prototype.get_actionManager=function(){return this._actionManager},e.prototype.InitializeStatics=function(){this.minImageWidthMu=np.j.pixelsToMu(1,0),this.minImageHeightMu=np.j.pixelsToMu(1,1),this.maxImageWidthMu=np.j.pixelsToMu(1920,0),this.maxImageHeightMu=np.j.pixelsToMu(1280,1)},e.prototype.registerActions=function(e){this._actionManager=e;var t=o.i(this,this.PictureToolsTabViewHandler,"PictureToolsTabViewHandler"),n=o.i(this,this.InsertPictureDialogView,"InsertPictureDialogView"),i=o.i(this,this.InsertPicture,"InsertPicture"),r=o.i(this,this.GrowShrinkImage,"GrowShrinkImage");e.addActionWithFlags(Oi.u.insertPictureDialog,ol.d.view,n,1284),e.addAction(Oi.u.insertPicture,ol.d.insertionPoint,i),e.addAction(Oi.u.insertPicture,ol.d.image,i),e.setActionFlags(Oi.u.insertPicture,1284),e.addActionWithFlags(Oi.u.cgrpPictureToolsGroup,ol.d.view,t,4),this.addImageAction(e,Oi.u.editAltText,o.i(this,this.EditAltText,"EditAltText")),this.addImageAction(e,Oi.u.growImage,r),this.addImageAction(e,Oi.u.shrinkImage,r),this.addImageAction(e,Oi.u.queryImageResize,o.i(this,this.QueryImageResize,"QueryImageResize")),this.addImageAction(e,Oi.u.queryImageAbsoluteHeight,o.i(this,this.QueryImageAbsoluteHeight,"QueryImageAbsoluteHeight")),this.addImageAction(e,Oi.u.queryImageAbsoluteWidth,o.i(this,this.QueryImageAbsoluteWidth,"QueryImageAbsoluteWidth")),this.addImageAction(e,Oi.u.queryImageAltTextTitle,o.i(this,this.QueryImageAltTextTitle,"QueryImageAltTextTitle")),this.addImageAction(e,Oi.u.queryImageAltTextDescription,o.i(this,this.QueryImageAltTextDescription,"QueryImageAltTextDescription")),this.addImageAction(e,Oi.u.imageResize,o.i(this,this.ImageResize,"ImageResize")),this.addImageAction(e,Oi.u.setImageAbsoluteHeight,o.i(this,this.ImageAbsoluteHeight,"ImageAbsoluteHeight")),this.addImageAction(e,Oi.u.setImageAbsoluteWidth,o.i(this,this.ImageAbsoluteWidth,"ImageAbsoluteWidth")),this.addImageAction(e,Oi.u.setImageAltTextTitle,o.i(this,this.ImageAltTextTitle,"ImageAltTextTitle")),this.addImageAction(e,Oi.u.setImageAltTextDescription,o.i(this,this.ImageAltTextDescription,"ImageAltTextDescription")),this.addImageAction(e,Oi.u.queryImageLockAspectRatio,o.i(this,this.QueryImageLockAspectRatio,"QueryImageLockAspectRatio")),this.addImageAction(e,Oi.u.imageLockAspectRatio,o.i(this,this.ImageLockAspectRatio,"ImageLockAspectRatio")),this.addImageAction(e,Oi.u.downloadImage,o.i(this,this.DownloadImage,"DownloadImage")),this._isSupportImageDragDropExternalEnabled&&e.addActionWithFlags(Oi.u.dragDropLocalImagesContent,ol.d.view,o.i(this,this.DropLocalImagesContent,"DropLocalImagesContent"),4),e.setActionFlags(Oi.u.editAltText,4),e.setActionFlags(Oi.u.growImage,4),e.setActionFlags(Oi.u.shrinkImage,4),e.setActionFlags(Oi.u.queryImageResize,69),e.setActionFlags(Oi.u.queryImageAbsoluteHeight,69),e.setActionFlags(Oi.u.queryImageAbsoluteWidth,69),e.setActionFlags(Oi.u.queryImageLockAspectRatio,69),e.setActionFlags(Oi.u.queryImageAltTextTitle,69),e.setActionFlags(Oi.u.queryImageAltTextDescription,69),e.setActionFlags(Oi.u.imageLockAspectRatio,4),e.setActionFlags(Oi.u.imageResize,4),e.setActionFlags(Oi.u.setImageAbsoluteHeight,4),e.setActionFlags(Oi.u.setImageAbsoluteWidth,4),e.setActionFlags(Oi.u.setImageAltTextTitle,4),e.setActionFlags(Oi.u.setImageAltTextDescription,4),this.InitializeStatics()},e.prototype.addImageAction=function(e,t,n){e.addAction(t,ol.d.image,n),e.addAction(t,ol.d.floatingImage,n),e.addAction(t,ol.d.textRange,n),e.addAction(t,ol.d.anchoredObject,n)},e.prototype.DownloadImage=function(e,t,n,i,r){if(yi.App.disableEmbedDownload)return 8;var o=t.get_node();if(1===n)return o?32:2;if(2===n){var a=pa.ImageReader.getImagePropertiesFromContext(t),l=pa.ImageReader.getOriginalImageUrl(a,t.get_node().getParentGraphSpace().get_contentObjectSpace(),L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.get_activeFrame().get_highContrastDetector());return _y.saveFile(l),32}return 2},e.prototype.InsertPictureDialogView=function(e,t,n,i,r){var o=this._imageEditor.canInsertPictureInContext(t),a=r;return 2===n&&o?(Oi.u.insertPictureDialog===e&&(L.AFrameworkApplication.limitedEdit?L.AFrameworkApplication.showRequiresSignInDialog():this.createPictureUploader(t,a)),32):1===n&&Oi.u.insertPictureDialog===e&&o?32:2},e.prototype.createPictureUploader=function(e,t){return new Oy.e(e,Ce.y.get_instance(),L.AFrameworkApplication.appSettingsManager,t,this._undoManager,this._actionManager)},e.prototype.InsertPicture=function(e,t,n,i,r){return this._imageEditor.canInsertPictureInContext(t)?1===n?32:this._imageEditor.insertPictureInContext(t,r)?32:2:2},e.prototype.ValidateNonImageRelatedSettingsForEditActionsEnabled=function(t){return this.IfCompatMode()?(e.get_activityManager().recordEvent(ah.f.noApply,{Reason:lh.i.compatMode}),!1):Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().contextSetContainsLockedRange(t)?(e.get_activityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),!1):this.get_ExternalSelectionManager()&&this.get_ExternalSelectionManager().isExternalSelectionContext(t)?(e.get_activityManager().recordEvent(ah.f.noApply,{Reason:lh.i.externalSelection}),!1):!this._actionManager||3===this._actionManager.get_mode()||(e.get_activityManager().recordEvent(ah.f.noApply,{Reason:lh.i.failedToReadOnly}),!1)},e.prototype.AreEditActionsEnabled=function(t){this.ValidateNonImageRelatedSettingsForEditActionsEnabled(t);var n=pa.ImageReader.getImagePropertiesFromContext(t);if(!n)return!1;var i=!pa.ImageReader.getImageUploadState(n)&&!pa.ImageReader.isInvalidImage(n);return i||e.get_activityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsUnmodifyableImage}),i},e.prototype.InsertImageInContext=function(e,t){var n=new EE(t,Ce.y.get_instance(),L.AFrameworkApplication.appSettingsManager,e,this._undoManager,this._actionManager,this._selectionManager);new xE.h(document.body,o.i(n,n.onUploadFrameInitialized,"onUploadFrameInitialized"),o.i(n,n.uploadResponseReceived,"uploadResponseReceived"),L.AFrameworkApplication.appSettingsManager,!1);return n.isSuccessful},e.prototype.DropLocalImagesContent=function(e,t,n,i,r){S.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");var o=r.DataTransfer;if(o&&o.files&&o.files.length>0){for(var a=this._selectionManager.get_selectionCollection().get_currentSelection().get_firstContext(),l=a.get_node(),s=a.get_cpBegin(),u=0,c=0;c<o.files.length;c++){var d=o.files[c];Rn.l.toLower(d.type).indexOf("image")>=0&&this.InsertImageInContext(d,t)&&(this._selectionManager.setSelection(Ua.SelectionFactory.createIpSelection(l,s+u)),u++)}return 32}return S.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled"),2},e.prototype.arePictureActionsEnabled=function(e){return this.AreEditActionsEnabled(e)&&5===pa.ImageReader.getImageType(pa.ImageReader.getImagePropertiesFromContext(e))},e.prototype.areDrawingActionsEnabled=function(e){return this.AreEditActionsEnabled(e)&&10===pa.ImageReader.getImageType(pa.ImageReader.getImagePropertiesFromContext(e))},e.prototype.areGroupDrawingActionsEnabled=function(e){return this.AreEditActionsEnabled(e)&&48===pa.ImageReader.getImageType(pa.ImageReader.getImagePropertiesFromContext(e))},e.prototype.areTextBoxActionsEnabled=function(e){return this.AreEditActionsEnabled(e)&&11===pa.ImageReader.getImageType(pa.ImageReader.getImagePropertiesFromContext(e))},e.prototype.areInkActionsEnabled=function(e){return this.AreEditActionsEnabled(e)&&4===pa.ImageReader.getImageType(pa.ImageReader.getImagePropertiesFromContext(e))},e.prototype.areSmartArtEnabled=function(e){return this.AreEditActionsEnabled(e)&&6===pa.ImageReader.getImageType(pa.ImageReader.getImagePropertiesFromContext(e))},e.prototype.areImageNodeActionsEnabled=function(e){var t=Ge.w.get_instance().tryResolve(Yh.d);return t&&t.isFeatureEnabled(46)?this.arePictureActionsEnabled(e)||this.areDrawingActionsEnabled(e)||this.areGroupDrawingActionsEnabled(e)||this.areTextBoxActionsEnabled(e):this.arePictureActionsEnabled(e)},e.prototype.PictureToolsTabViewHandler=function(t,n,i,r,o){if(2===i)return L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n.get_nextContext(),t,i,!0,r,o);var a=n;if(!a.view.get_isInteractiveView())return 8;var l=a.view;if(!l.get_selectionManager())return 8;var s=l.get_selectionManager().get_selectionContextForActionDispatch(),u=e.get_ContextSetEditor().breakDownContextSets(s);return 1!==u.length?8:this.arePictureActionsEnabled(u[0])?(this.LogPictureToolsTabEnabled(),32):8},e.prototype.EditAltText=function(t,n,i,r,o){if(!this.arePictureActionsEnabled(n))return 8;if(1===i)return this.IfCompatMode()?2:32;if(Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()){var a=n.get_node().getValueWithDefault(Number,ep.p.lockId,ip.z.lockIdNil);if(a!==ip.z.lockIdNil){var l=yi.App.get_theCoauthManager().get_theLockManager().getLock(a);if(ls.CoauthLockEditor.getInstance().shouldLockBlockEditing(l))return e.get_activityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),2}}return this.getAltTextDialog(n),32},e.prototype.getAltTextDialog=function(e){return new PE(e)},e.prototype.GrowShrinkImage=function(e,t,n,i,r){if(!this.arePictureActionsEnabled(t))return 8;var o=pa.ImageReader.getImagePropertiesFromContext(t),a=pa.ImageReader.getImageWidthWithoutEffects(o),l=pa.ImageReader.getImageHeightWithoutEffects(o),s=e===Oi.u.growImage;if(S.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{IsGrow:s}),1===n)return this.IfCompatMode()||pa.ImageReader.isImageResizeLocked(o)?2:s&&a<this.maxImageWidthMu&&l<this.maxImageHeightMu?32:!s&&a>this.minImageWidthMu&&l>this.minImageHeightMu?32:2;var u=s?1.1:.9,c=a*u,d=l*u;return this.SetSize(o,t,c,d,!0),32},e.prototype.SetSize=function(e,t,n,i,r){if(void 0===r&&(r=!1),Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()){var o=t.get_node();yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(o)}var a=pa.ImageReader.isImageAspectRatioLocked(e),l=1;n>this.maxImageWidthMu?l=this.maxImageWidthMu/n:n<this.minImageWidthMu&&(l=this.minImageWidthMu/n);var s=1;i>this.maxImageHeightMu?s=this.maxImageHeightMu/i:i<this.minImageHeightMu&&(s=this.minImageHeightMu/i),(a||r)&&(l=Math.min(l,s),s=Math.min(l,s)),1!==l&&(n*=l),1!==s&&(i*=s),this.doSetSize(e,t,n,i)},e.prototype.doSetSize=function(e,t,n,i){this._imageEditor.setSizeHelper(e,t,n,i)},e.prototype.QueryImageResize=function(e,t,n,i,r){if(!this.areImageNodeActionsEnabled(t))return 8;var o=pa.ImageReader.getImagePropertiesFromContext(t),a=pa.ImageReader.getOriginalImageWidth(o),l=pa.ImageReader.getOriginalImageHeight(o);if(a<=0||l<=0)return 2;var s=pa.ImageReader.getImageWidthWithoutEffects(o)/a*100;return r.setValue(Pl.k.imageScale,s),32},e.prototype.ImageResize=function(t,n,i,r,o){if(!this.areImageNodeActionsEnabled(n))return 8;var a=pa.ImageReader.getImagePropertiesFromContext(n);if(1===i)return this.IfCompatMode()||pa.ImageReader.isImageResizeLocked(a)?2:32;S.ULS.sendTraceTag(20459937,322,50,"Change image scale.");var l=o.getValueWithDefault(Number,Pl.k.imageScale,-1)/100,s=o.getValueWithDefault(Boolean,Pl.k.imageScaleFromCurrent,!1),u=o.getValueWithDefault(Boolean,Pl.k.imageResizeIsHorizontal,!0),c=o.getValueWithDefault(Boolean,Pl.k.imageResizeIsVertical,!0);if(l<=0)return e.get_activityManager().recordEvent(ah.f.noApply,{Reason:lh.i.invalidScale}),2;var d,g,p=pa.ImageReader.getOriginalImageWidth(a),h=pa.ImageReader.getOriginalImageHeight(a),_=pa.ImageReader.getImageWidthWithoutEffects(a),m=pa.ImageReader.getImageHeightWithoutEffects(a);return p<=0||h<=0?(e.get_activityManager().recordEvent(ah.f.unexpectedState,{Reason:lh.i.invalidScale}),2):(s?(d=u?l*_:_,g=c?l*m:m):(d=u?l*p:_,g=c?l*h:m),this.SetSize(a,n,d,g),Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()&&yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(n.get_node()),32)},e.prototype.QueryImageAbsoluteHeight=function(e,t,n,i,r){if(!this.arePictureActionsEnabled(t))return 8;var o=pa.ImageReader.getImagePropertiesFromContext(t),a=pa.ImageReader.getImageHeightWithoutEffects(o);return a<=0?2:(r.setValue(Pl.k.imageAbsoluteHeight,a),32)},e.prototype.ImageAbsoluteHeight=function(t,n,i,r,o){if(!this.areImageNodeActionsEnabled(n))return 8;var a=pa.ImageReader.getImagePropertiesFromContext(n);if(1===i)return this.IfCompatMode()||pa.ImageReader.isImageResizeLocked(a)?2:32;S.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");var l=o.getValueWithDefault(Number,Pl.k.imageAbsoluteHeight,0),s=pa.ImageReader.isImageAspectRatioLocked(a);if(l<=0)return e.get_activityManager().recordEvent(ah.f.noApply,{Reason:lh.i.invalidScale}),2;var u,c,d=pa.ImageReader.getOriginalImageWidth(a),g=pa.ImageReader.getOriginalImageHeight(a),p=pa.ImageReader.getImageWidthWithoutEffects(a),h=p/pa.ImageReader.getImageHeightWithoutEffects(a);return d<=0||g<=0?(e.get_activityManager().recordEvent(ah.f.unexpectedState,{Reason:lh.i.invalidScale}),2):(u=s?l*h:p,c=l,this.SetSize(a,n,u,c),Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()&&yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(n.get_node()),yi.App.get_activeAppFrame().updateCommandUI(),32)},e.prototype.QueryImageAbsoluteWidth=function(e,t,n,i,r){if(!this.arePictureActionsEnabled(t))return 8;var o=pa.ImageReader.getImagePropertiesFromContext(t),a=pa.ImageReader.getImageWidthWithoutEffects(o);return a<=0?2:(r.setValue(Pl.k.imageAbsoluteWidth,a),32)},e.prototype.ImageAbsoluteWidth=function(t,n,i,r,o){if(!this.areImageNodeActionsEnabled(n))return 8;var a=pa.ImageReader.getImagePropertiesFromContext(n);if(1===i)return this.IfCompatMode()||pa.ImageReader.isImageResizeLocked(a)?2:32;S.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");var l=o.getValueWithDefault(Number,Pl.k.imageAbsoluteWidth,0),s=pa.ImageReader.isImageAspectRatioLocked(a);if(l<=0)return e.get_activityManager().recordEvent(ah.f.noApply,{Reason:lh.i.invalidScale}),2;var u,c,d=pa.ImageReader.getOriginalImageWidth(a),g=pa.ImageReader.getOriginalImageHeight(a),p=pa.ImageReader.getImageWidthWithoutEffects(a),h=pa.ImageReader.getImageHeightWithoutEffects(a),_=h/p;return d<=0||g<=0?(e.get_activityManager().recordEvent(ah.f.unexpectedState,{Reason:lh.i.invalidScale}),2):(c=s?l*_:h,u=l,this.SetSize(a,n,u,c),Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()&&yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(n.get_node()),yi.App.get_activeAppFrame().updateCommandUI(),32)},e.prototype.QueryImageLockAspectRatio=function(e,t,n,i,r){if(!this.arePictureActionsEnabled(t))return 8;var o=pa.ImageReader.getImagePropertiesFromContext(t),a=pa.ImageReader.isImageAspectRatioLocked(o);return r.setValue(Pl.k.imageLockAspectRatio,a),32},e.prototype.ImageLockAspectRatio=function(e,t,n,i,r){if(!this.arePictureActionsEnabled(t))return 8;var o=pa.ImageReader.getImagePropertiesFromContext(t);if(1===n&&this.IfCompatMode())return 2;if(Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()){var a=t.get_node();yi.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(a)}if(r){var l=r.getValueWithDefault(Boolean,Pl.k.imageLockAspectRatio,!0);S.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this._imageEditor.setImageLockAspectRatio(o,l),L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&yi.App.get_activeAppFrame().updateCommandUI()}return 32},e.prototype.QueryImageAltTextTitle=function(e,t,n,i,r){if(!this.arePictureActionsEnabled(t))return 8;var o=pa.ImageReader.getImagePropertiesFromContext(t),a=pa.ImageReader.getImageAltText(o);return r.setValue(Pl.k.imageAltTextTitle,a),32},e.prototype.ImageAltTextTitle=function(t,n,i,r,o){if(!this.arePictureActionsEnabled(n))return 8;if(1===i)return this.IfCompatMode()?2:32;if(Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()){var a=n.get_node().getValueWithDefault(Number,ep.p.lockId,ip.z.lockIdNil);if(a!==ip.z.lockIdNil){var l=yi.App.get_theCoauthManager().get_theLockManager().getLock(a);if(ls.CoauthLockEditor.getInstance().shouldLockBlockEditing(l))return e.get_activityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),2}}var s=pa.ImageReader.getImagePropertiesFromContext(n),u=o.getValueWithDefault(String,Pl.k.imageAltTextTitle,null);return this._imageEditor.setImageAltTextHelper(s,n,u),S.ULS.sendTraceTag(21297027,322,50,"Change image alt text."),this.trackChangeManager.alertUntrackedChange(10),32},e.prototype.QueryImageAltTextDescription=function(e,t,n,i,r){if(!this.arePictureActionsEnabled(t))return 8;var o=pa.ImageReader.getImagePropertiesFromContext(t),a=pa.ImageReader.getImageAltTextDescription(o);return r.setValue(Pl.k.imageAltTextDescription,a),32},e.prototype.ImageAltTextDescription=function(t,n,i,r,o){if(!this.arePictureActionsEnabled(n))return 8;if(1===i)return this.IfCompatMode()?2:32;if(Gl.n.get_instance().get_item(50)&&yi.App.get_theCoauthManager().get_isCoauthorable()){var a=n.get_node().getValueWithDefault(Number,ep.p.lockId,ip.z.lockIdNil);if(a!==ip.z.lockIdNil){var l=yi.App.get_theCoauthManager().get_theLockManager().getLock(a);if(ls.CoauthLockEditor.getInstance().shouldLockBlockEditing(l))return e.get_activityManager().recordEvent(ah.f.noApply,{Reason:lh.i.containsLockedRange}),2}}var s=pa.ImageReader.getImagePropertiesFromContext(n),u=o.getValueWithDefault(String,Pl.k.imageAltTextDescription,null);return this._imageEditor.setImageAltTextDescriptionHelper(s,n,u),S.ULS.sendTraceTag(21297029,322,50,"Change image alt text description."),this.trackChangeManager.alertUntrackedChange(10),32},e.prototype.LogPictureToolsTabEnabled=function(){S.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")},e.prototype.IfCompatMode=function(){return Gl.n.get_instance().get_item(51)&&this.get_pageReader().get_isCompatMode()},e.get_ContextSetEditor=function(){return am.ContextSetEditor.get_instance()},e.get_LockedRangeEditor=function(){return za.k.get_instance()},e.get_activityManager=function(){return xr.y.get_instance()},e.IsMsSaveBlobSupported=function(){var e=!1;return null!=window.navigator.msSaveBlob&&(e=!0),e},e}();(0,o.l)(DE,"aa4a140d$ImageActor",null,[]);var RE=function(){function e(){}return e.prototype.get_key=function(){return"LIST"},e.prototype.get_contentTitle=function(){return Box4Intl.Box4Strings.l_ListContentTitle},e.prototype.tryGetDocumentStructureDetails=function(t,n){n.val=null;var i=e.get_ListReader().getListInfo(t);if(!i)return!1;var r=this.getListItemInfo(t,i);return n.val=new da,n.val.set_providerKey(this.get_key()),n.val.contentId=r.listId,n.val.set_contentObject(r),!0},e.prototype.getContentIncrementalDetails=function(e,t){var n=e.get_contentObject(),i=this.GetItemAnnotationFromListInfo(n.listInfo),r=new la.o(String);if(t){var o=t.get_contentObject();o.level!==n.level?(r.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,n.level)),r.add(i)):o.id.equals(n.id)&&o.listInfo.get_listType()===n.listInfo.get_listType()||r.add(i)}else r.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),r.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,n.level)),r.add(i);return r.toArray().join(" ")},e.prototype.GetItemAnnotationFromListInfo=function(e){var t="",n=e.get_listStyle();if(e.get_listType()){if(1===e.get_listType())switch(n){case 1:t=this.get_bulletStyle1();break;case 2:t=this.get_bulletStyle2();break;case 3:t=this.get_bulletStyle3();break;default:t=this.get_bulletStyle1()}}else t=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,e.get_lastStartAt());return t},e.get_ListReader=function(){return e._listReader||(e._listReader=Ge.w.get_instance().resolve(Ql.c))},e._listReader=null,e}();(0,o.l)(RE,"f4edb040$ListDetailsProvider",null,[oa,yd.f]);var ME=function(){return function(e){this.Transaction=null,this.Stage=0,this.NewSelectionCollection=null,this.ContiguousSelectionIndex=0,this.InteractiveView=null,this.InteractiveView=e,this.Stage=0,this.ContiguousSelectionIndex=0}}();(0,o.l)(ME,"2c7c10a$SelectAllArguments",null,[]);var kE=function(){function e(e,t,n,i,r){this._pageContentReader=null,this._lazyUndoManager=null,this._graphTransactionFactory=null,this._isExpandSelectionEnabled=!1,this._isTwoDimensionalOutlinesEnabled=!1,this._pageContentReader=e,this._lazyUndoManager=t,this._graphTransactionFactory=n,this._isExpandSelectionEnabled=i,this._isTwoDimensionalOutlinesEnabled=r}return e.prototype.get_PageContentReader=function(){return this._pageContentReader},e.prototype.get_UndoManager=function(){return this._lazyUndoManager.get_value()},e.prototype.get_selectAllInOutlineHandler=function(){return this._isExpandSelectionEnabled?this._isTwoDimensionalOutlinesEnabled?o.i(this,this.ExpandSelectionOneNote,"ExpandSelectionOneNote"):o.i(this,this.ExpandSelectionWord,"ExpandSelectionWord"):o.i(this,this.SelectAllInOutline,"SelectAllInOutline")},e.prototype.get_selectAllOutlinesHandler=function(){return this._isTwoDimensionalOutlinesEnabled?o.i(this,this.SelectAllOutlines,"SelectAllOutlines"):null},e.prototype.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager();this.get_selectAllOutlinesHandler()&&t.addActionWithFlags(Oi.u.selectAllOutlines,ol.d.view,this.get_selectAllOutlinesHandler(),2),t.addAction(Oi.u.showContextMenuForSelection,Ue.m.frame,e.ShowContextMenuAtSelection),t.addAction(Oi.u.shiftF10Document,Ue.m.frame,e.ShowContextMenuAtSelection),t.addActionWithFlags(Oi.u.expandSelection,ol.d.view,this.get_selectAllInOutlineHandler(),2),t.addActionWithFlags(Oi.u.alwaysEnabledInEdit,ol.d.view,Pe.AFrame.doNothing,100),t.addActionWithFlags(Oi.u.moveIpToPageStart,ol.d.view,e.MoveIpToPageStart,4)},e.prototype.ExpandSelectionOneNote=function(e,t,n,i,r){return this.ExpandSelection(t,n,null)},e.prototype.ExpandSelection=function(e,t,n){if(1===t)return 32;var i=e;if(!i.view.get_isInteractiveView())return 2;var r=i.view;if(!r.get_selectionManager())return 8;var a,l,s=r.get_selectionManager().get_selectionCollection();if(!s||!s.get_length())return 8;if(Dr.t.mark(5798),yi.App.get_activeAppFrame().workspace.get_isEditingAllowed()||yi.App.get_activeAppFrame().workspace.get_isReviewingAllowed())a=ga.SelectionEditor.getNextSelectionExpansion(s);else{St.FocusManager.instance().scopeChanged(Pe.AFrame.documentFocusID);var u=r.get_targetNode();a=Ua.SelectionFactory.selectAllNormalOutlinesOnPage(u)}if(!a)return 8;if(this._isExpandSelectionEnabled&&!s.currentExpansionState&&S.ULS.sendTraceTag(39098305,324,50,"Progress selection start"),n&&this.get_PageContentReader().isPageContentNode(ga.SelectionEditor.getCurrentSelectionExpansionContainingNode(a)))l=n(r);else{var c=new ME(r);c.NewSelectionCollection=a,(l=new vp.a(null,o.i(this,this.ProcessSetSelection,"ProcessSetSelection"),c)).setDebugName("ExpandSelection"),l.run()}return l.get_inProgress()?1:32},e.prototype.ExpandSelectionWord=function(e,t,n,i,r){return t.view.get_isPageView()?this.ExpandSelection(t,n,o.i(this,this.StartOperationOfSelectAllInOutline,"StartOperationOfSelectAllInOutline")):this.SelectAllInOutline(e,t,n,i,r)},e.prototype.ProcessSetSelection=function(e,t){var n=t;return n.Stage?1===n.Stage?(n.InteractiveView.get_selectionManager().setSelectionFromSelectionCollectionAsync(n.NewSelectionCollection,e),n.Stage=2,!0):2===n.Stage&&(n.InteractiveView.get_selectionManager().get_selectionCollection().currentExpansionState=n.NewSelectionCollection.currentExpansionState,this.get_UndoManager().interruptUndoMerging(),n.Transaction.setAsyncOperation(e),n.Stage=3,n.Transaction.dispose(),Dr.t.mark(5799),!0):(n.Transaction=this._graphTransactionFactory.getTransaction(2),n.Transaction.setFromNode(n.InteractiveView.get_targetNode()),n.Stage=1,!0)},e.prototype.SelectAllInOutline=function(e,t,n,i,r){if(1===n)return 32;var o=t;if(!o.view.get_isInteractiveView())return 2;var a=o.view;return a.get_selectionManager()&&a.get_selectionManager().get_selectionCollection()&&a.get_selectionManager().get_selectionCollection().get_currentSelection()?this.StartOperationOfSelectAllInOutline(a).get_inProgress()?1:32:8},e.prototype.StartOperationOfSelectAllInOutline=function(e){L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings"),this._isExpandSelectionEnabled&&e.get_isPageView()&&S.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");var t=new vp.a(null,o.i(this,this.ProcessSelectAllInOutline,"ProcessSelectAllInOutline"),new ME(e));return t.setDebugName("SelectAllInOutline"),t.run(),t},e.prototype.ProcessSelectAllInOutline=function(e,t){var n=t;if(!n.Stage)return n.NewSelectionCollection=Ua.SelectionFactory.selectAllOutlineElementsInOutline(n.InteractiveView.get_selectionManager().get_selectionCollection().get_currentSelection()),n.Transaction=this._graphTransactionFactory.getTransaction(2),n.Transaction.setFromNode(n.InteractiveView.get_targetNode()),n.Stage=1,!0;if(1===n.Stage){if(!n.ContiguousSelectionIndex)return Gl.n.get_instance().get_item(77)&&Gl.n.get_instance().get_item(104)&&n.NewSelectionCollection.get_isTableCellSelection()?(n.InteractiveView.get_selectionManager().setSelectionFromSelectionCollectionAsync(n.NewSelectionCollection,e),n.ContiguousSelectionIndex=n.NewSelectionCollection.get_length()):(n.InteractiveView.get_selectionManager().setSelection(n.NewSelectionCollection.get_item(0),e),++n.ContiguousSelectionIndex),!0;if(n.ContiguousSelectionIndex<n.NewSelectionCollection.get_length())return n.InteractiveView.get_selectionManager().addSelectionToCollectionAlternate(n.NewSelectionCollection.get_item(n.ContiguousSelectionIndex),e),++n.ContiguousSelectionIndex,!0;n.Stage=2}return 2===n.Stage&&(n.InteractiveView.get_selectionManager().get_selectionCollection().currentExpansionState=n.NewSelectionCollection.currentExpansionState,this.get_UndoManager().interruptUndoMerging(),n.Transaction.setAsyncOperation(e),n.Stage=3,n.Transaction.dispose(),!0)},e.prototype.SelectAllOutlines=function(e,t,n,i,r){if(1===n)return 32;var a=t;if(!a.view.get_isInteractiveView())return 2;var l=a.view,s=l.get_targetNode(),u=Ua.SelectionFactory.selectAllNormalOutlinesOnPage(s);if(!u)return 8;var c=new ME(l);c.NewSelectionCollection=u;var d=new vp.a(null,o.i(this,this.ProcessSetSelection,"ProcessSetSelection"),c);return d.setDebugName("ExpandSelection"),d.run(),d.get_inProgress()?1:32},e.get_SelectionContextMenuProvider=function(){return e._selectionContextMenuProvider||(e._selectionContextMenuProvider=Ge.w.get_instance().resolve(Bc.f))},e.MoveIpToPageStart=function(e,t,n,i,r){if(1===n)return 32;var o=t;if(!o.view.get_isInteractiveView())return 8;var a=o.view,l=Ua.SelectionFactory.createCollapsedSelection(a.get_root().get_graphNode(),!0);return l?(a.get_selectionManager().setSelection(l),32):8},e.ShowContextMenuAtSelection=function(t,n,i,r,o){if(!Gl.n.get_instance().get_item(75))return 2;var a=yi.App.get_activeAppFrame().workspace.get_activeView();if(!a.get_isInteractiveView())return 2;if(a.get_isInteractiveView()&&1!==yi.App.get_activeAppFrame().get_state()){Dr.t.mark(4668);var l=a,s=l.get_selectionManager().get_selectionCollection().get_currentSelection();if(!s&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ContextMenuOnSelectionFixIsEnabled"))return 2;var u=ga.SelectionEditor.boundsFromSelection(s),c=u.x,d=u.y+u.height;if(!l.get_container())return 8;var g=Sys.UI.DomElement.getBounds(l.get_container());(u.y<g.y||u.y>g.y+g.height||u.x<g.x||u.x>g.x+g.width)&&(c=g.x,d=g.y),e.get_SelectionContextMenuProvider().showContextMenuForSelection(new Sys.UI.Point(c,d),1),Dr.t.mark(4669)}return 32},e._selectionContextMenuProvider=null,e}();(0,o.l)(kE,"246c4e63$SelectAllHandlers",null,[md]);var NE=function(e){function t(t,n,i){void 0===i&&(i=null);var r,o=e.call(this)||this;return o.set_buttonsOption(1),n?(r=CommonUIStrings.l_GoToClassicRibbonDialogMesage,o.addFeedbackLink(CommonUIStrings.l_ToggleRibbonUXDialogTellUsWhy,i)):r=CommonUIStrings.l_GoToSingleLineRibbonDialogMessage,o.messageBoxImpl(CommonUIStrings.l_ToggleRibbonUXDialogTitle,r,null,null,t,null),o}return(0,v.t)(t,e),t}(Vn.StandardDialog);(0,o.l)(NE,"4dcee2c3$ToggleRibbonUXDialog",Vn.StandardDialog,[]);var LE=function(){function e(){}return e.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addActionWithFlags(Fe.b.querySimplifiedRibbonIsEnabled,Ue.m.frame,e.QuerySimplifiedRibbonIsEnabled,101),t.addAction(Fe.b.toggleRibbonUXDialog,Ue.m.frame,e.ToggleRibbonUXDialog)},e.ToggleRibbonUXDialog=function(e,t,n,i,r){if(1===n)return 32;if(t.get_contextId()!==Ue.m.frame)return 2;var o=L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()?"Single Line Ribbon":"Classic Ribbon";return S.ULS.sendTraceTag(25523336,340,50,"User opened the toggle Ribbon UX dialog from the {0}",o),new NE((function(e,t){1===e&&L.AFrameworkApplication.get_theActionManager().processAction(Fe.b.toggleRibbonUX,2)}),L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()),32},e.QuerySimplifiedRibbonIsEnabled=function(e,t,n,i,r){return r[gr.e.On]=L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled(),32},e}();(0,o.l)(LE,"f93ece99$SimplifiedRibbonOptOutActor",null,[]);var BE=n(6078),OE=function(){function e(){}return e.get_ParagraphEditor=function(){return e._paragraphEditor||(e._paragraphEditor=Ge.w.get_instance().resolve(ns.g))},e.registerActions=function(){if(Gl.n.get_instance().get_item(54)||Gl.n.get_instance().get_item(84)){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(Oi.u.lineSpacingMenuOpen,ol.d.view,$f.applyFormattingToView),t.setActionFlags(Oi.u.lineSpacingMenuOpen,4),t.addAction(Oi.u.setLineSpacing,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.setLineSpacing,ol.d.paragraph,e.ApplySpacingToText),t.setActionFlags(Oi.u.setLineSpacing,4),t.addAction(Oi.u.setSpacingBeforeLine,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.setSpacingBeforeLine,ol.d.paragraph,e.ApplySpacingToText),t.setActionFlags(Oi.u.setSpacingBeforeLine,4),t.addAction(Oi.u.setSpacingAfterLine,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.setSpacingAfterLine,ol.d.paragraph,e.ApplySpacingToText),t.setActionFlags(Oi.u.setSpacingAfterLine,4),t.addAction(Oi.u.spinSpacingBefore,ol.d.view,e.SpinParaSpacing),t.addAction(Oi.u.spinSpacingBefore,ol.d.paragraph,e.SpinParaSpacing),t.setActionFlags(Oi.u.spinSpacingBefore,4),t.addAction(Oi.u.spinSpacingAfter,ol.d.view,e.SpinParaSpacing),t.addAction(Oi.u.spinSpacingAfter,ol.d.paragraph,e.SpinParaSpacing),t.setActionFlags(Oi.u.spinSpacingAfter,4),t.addAction(Oi.u.spacingBeforeAsString,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.spacingBeforeAsString,ol.d.paragraph,e.ApplySpacingAsString),t.setActionFlags(Oi.u.spacingBeforeAsString,4),t.addAction(Oi.u.spacingAfterAsString,ol.d.view,$f.applyFormattingToView),t.addAction(Oi.u.spacingAfterAsString,ol.d.paragraph,e.ApplySpacingAsString),t.setActionFlags(Oi.u.spacingAfterAsString,4)}},e.ApplySpacingAsString=function(t,n,i,r,o){return 1===i?32:(t===Oi.u.spacingBeforeAsString?t=Oi.u.setSpacingBeforeLine:t===Oi.u.spacingAfterAsString&&(t=Oi.u.setSpacingAfterLine),e.ApplySpacingToText(t,n,i,r,e.ParseSpacingCommandData(o)))},e.ParseSpacingCommandData=function(e){var t=e,n=t.indexOf(","),i=t.substring(0,n),r=t.substring(n+1,t.length),o=new AI;return o.value=parseFloat(i),o.unit=parseInt(r),o},e.SpinParaSpacing=function(e,t,n,i,r){if(2===n){var o=r,a=o[So.Text],l=o[So.Number],s=o.Increment,u=new AI,c=!1;if(""===a||s&&a===Box4Intl.Box4Strings.L_SpinnerAuto?(u.value=0,u.unit=yi.App.get_isEastAsian()?2:4,c=!0):l||s||(u.value=0,u.unit=1,c=!0),c){var d=e===Oi.u.spinSpacingBefore?Oi.u.setSpacingBeforeLine:Oi.u.setSpacingAfterLine;L.AFrameworkApplication.get_theActionManager().processActionWithData(d,2,u),yi.App.get_activeAppFrame().updateCommandUI()}}return 32},e.ApplySpacingToText=function(t,n,i,r,o){var a;if(!$f.shouldExecuteParagraphAction(i,n,(0,g.m)((function(){return a}),(function(e){return a=e}))))return a;var l=n.get_node();switch(t){case Oi.u.setLineSpacing:e.get_ParagraphEditor().setLineSpacing(l,new BE.o(2,o));break;case Oi.u.setSpacingBeforeLine:var s=o,u=new BE.o(s.unit,s.value);e.get_ParagraphEditor().setBeforeSpacing(l,u);break;case Oi.u.setSpacingAfterLine:var c=o,d=new BE.o(c.unit,c.value);e.get_ParagraphEditor().setAfterSpacing(l,d)}return 32},e._paragraphEditor=null,e}();(0,o.l)(OE,"240a4a2b$SpacingActor",null,[]);var UE=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.setLineSpacing=function(e){this._actionManager.processActionWithData(Oi.u.setLineSpacing,2,e)},e.prototype.setParagraphSpacing=function(e,t,n){this._actionManager.processActionWithData(e?Oi.u.setSpacingBeforeLine:Oi.u.setSpacingAfterLine,2,(0,U.m)(new AI,{value:t,unit:n}))},e}();(0,o.l)(UE,"747b4c74$SpacingCommands",null,[Qc]);var HE=n(5429),GE=function(){function e(){}return e.prototype.supportsListFormattingProperties=function(e){return e},e.prototype.isOnlySetEopFormatSupported=function(e){return!0},e}();(0,o.l)(GE,"32a8e877$EopFormattingStrategy",null,[Og]);var WE=function(){function e(){}return e.prototype.process=function(e,t,n,i){},e}();(0,o.l)(WE,"7c08cf70$NoOpFormattingViewOperationFinishedStageProcessor",null,[Bg]);var VE=function(){function e(e){this._formattingEditor=null,this._formattingEditor=e}return e.prototype.setFormattingsWithExistingFormatting=function(e,t,n){this._formattingEditor.setFontFace(e,t.get_cache().get_fontFace()),this._formattingEditor.setFontSize(e,t.get_cache().get_fontSize())},e.prototype.setDefaultFormattings=function(e,t,n){},e.prototype.getLineSpacing=function(e){return null},e.prototype.getParagraphSpacing=function(e){return null},e.prototype.getSpecialIndent=function(e){return null},e.prototype.getLeftIndent=function(e){return null},e.prototype.shouldSkipHightlightAfterPaste=function(e){return!1},e}();(0,o.l)(VE,"b0a155e7$FormattingStewardBridge",null,[HE.u]);var $E=function(){function e(){}return e.prototype.configure=function(e){e.register(Bg).singleInstance().usingFactory((function(){return new WE})),e.register(Og).singleInstance().usingFactory((function(){return new GE})),e.register(HE.u).singleInstance().usingFactory((function(){return new VE(e.resolve(Vs.z))}))},e}();(0,o.l)($E,"f75cc79d$WoncaActorsConfiguration",null,[u.s]);var zE=function(){function e(){e.InitializeParagraphStyleList()}return e.prototype.get_key=function(){return"FORMATTING_PARAGRAPH"},e.prototype.get_contentTitle=function(){return null},e.prototype.tryGetDocumentStructureDetails=function(t,n){if(n.val=null,!Ga.ParagraphReader.isParagraph(t))return!1;var i=bs.StyleReader.getStyleFromParagraphNode(t.get_currentNode());if(i&&2===bs.StyleReader.getStyleTargetType(i)){var r=bs.StyleReader.getStyleId(i);if(e._supportedParagraphStyles.contains(r)){var o=bs.StyleReader.getStyleName(i);n.val=new da,n.val.set_providerKey(this.get_key()),n.val.contentId=i.get_id(),n.val.set_contentObject(o)}}return!!n.val},e.prototype.getContentIncrementalDetails=function(e,t){var n=null;return t&&e.contentId.equals(t.contentId)||(n=e.get_contentObject()),n},e.prototype.tryCollapseNestedContent=function(e,t,n){return n.val=null,!1},e.InitializeParagraphStyleList=function(){e._supportedParagraphStyles=new qc.f(String),e._supportedParagraphStyles.add(bs.StyleReader.styleIdHeading1),e._supportedParagraphStyles.add(bs.StyleReader.styleIdHeading2),e._supportedParagraphStyles.add(bs.StyleReader.styleIdHeading3),e._supportedParagraphStyles.add(bs.StyleReader.styleIdHeading4),e._supportedParagraphStyles.add(bs.StyleReader.styleIdHeading5),e._supportedParagraphStyles.add(bs.StyleReader.styleIdHeading6),e._supportedParagraphStyles.add(bs.StyleReader.styleIdTitle),e._supportedParagraphStyles.add(bs.StyleReader.styleIdCitation),e._supportedParagraphStyles.add(bs.StyleReader.get_wordStyleIdHeading1()),e._supportedParagraphStyles.add(bs.StyleReader.get_wordStyleIdHeading2()),e._supportedParagraphStyles.add(bs.StyleReader.get_wordStyleIdHeading3()),e._supportedParagraphStyles.add(bs.StyleReader.get_wordStyleIdHeading4()),e._supportedParagraphStyles.add(bs.StyleReader.get_wordStyleIdHeading5()),e._supportedParagraphStyles.add(bs.StyleReader.get_wordStyleIdHeading6()),e._supportedParagraphStyles.add(bs.StyleReader.get_wordStyleIdHeading7()),e._supportedParagraphStyles.add(bs.StyleReader.get_wordStyleIdHeading8()),e._supportedParagraphStyles.add(bs.StyleReader.get_wordStyleIdHeading9()),e._supportedParagraphStyles.add(bs.StyleReader.get_wordStyleIdTitle()),e._supportedParagraphStyles.add(bs.StyleReader.get_wordStyleIdSubtitle())},e._supportedParagraphStyles=null,e}();(0,o.l)(zE,"e172edb$ParagraphStyleDetailsProvider",null,[oa,yd.f]);var KE=function(){function e(e,t){this._futureAccessibilityContextManager=null,this._lazyListDetailsProvider=null,this._futureAccessibilityContextManager=e,this._lazyListDetailsProvider=t}return e.prototype.RegisterContentDetailsProviders=function(){var e=this;this._futureAccessibilityContextManager.execute((function(t){t.registerStructuralContentDetailsProvider(e._lazyListDetailsProvider.get_value()),t.registerStructuralContentDetailsProvider(new zE)}))},e}();(0,o.l)(KE,"67affa9c$AccessibilityActor",null,[]);var qE=n(2310),jE=n(9369),QE=n(6628),JE=function(){function e(){}return e.RegisterActions=function(){L.AFrameworkApplication.get_theActionManager().addActionWithFlags(nS.u.forceUpdateCommandUI,ol.d.view,e.ForceUpdateCommandUI,64)},e.ForceUpdateCommandUI=function(e,t,n,i,r){return 1===n?32:(yi.App.get_activeAppFrame().forceUpdateCommandUI(),32)},e}();(0,o.l)(JE,"399da5a9$CommandUIActor",null,[]);var XE=function(){function e(){}return e.get_InternalLinkManager=function(){return Ge.w.get_instance().resolve(ob.b)},e.RegisterActions=function(){L.AFrameworkApplication.get_theActionManager().addAction(Oi.u.commandingNav,ol.d.view,e.NavToPage)},e.NavToPage=function(t,n,i,r,o){if(!o)return 2;var a=o,l=e.ParseClientUrlToInternalUrl(a);return l?(e.get_InternalLinkManager().activatePage(l),32):2},e.ParseClientUrlToInternalUrl=function(t){var n=unescape(decodeURI(t)),i=n.indexOf(e._sectionNameSuffix,0),r=n.lastIndexOf(e._sectionNamePrefix,i),o=t.indexOf(e._pageIdPrefix,0)+e._pageIdPrefix.length,a=t.indexOf(e._pageIdSuffix,o);if(!e.IsValidId(r,i)||!e.IsValidId(o,a))return null;var l=n.substring(r+1,i),s=t.substring(o,a);return e.IsValidGuid(s)?String.format("onenote:{0}.one#&page-id={{{1}}}&end",l,s):null},e.IsValidId=function(e,t){return-1!==e&&-1!==t&&!(e>=t)},e.IsValidGuid=function(e){return!(!e||!e.length)&&ai.l.isValid(e)},e._sectionNamePrefix="/",e._sectionNameSuffix=".one",e._pageIdPrefix="&page-id=",e._pageIdSuffix="&end",e}();(0,o.l)(XE,"e63c0dac$CommandingNavActor",null,[]);var YE=function(){function e(){}return e.get_PageEditor=function(){return e._pageEditor||(e._pageEditor=Ge.w.get_instance().resolve(Kb.f))},e.get_PageNavigator=function(){return Ii.PageNavigator.get_instance()},e.get_PageReader=function(){return $s.PageReader.get_instance()},e.get_BusinessBarControllerFuture=function(){return e._businessBarControllerFuture||(e._businessBarControllerFuture=Ge.w.get_instance().resolveFuture(Li.d))},e.get_ContextMenuDataProvider=function(){return e._contextMenuDataProvider||(e._contextMenuDataProvider=Ge.w.get_instance().resolve(iE))},e.RegisterActions=function(){if(Gl.n.get_instance().get_item(21)){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(Oi.u.toggleConflictPagesVisibility,ol.d.page,e.ToggleVisibility),t.addAction(Oi.u.deleteConflictPage,ol.d.page,e.DeleteConflict),t.addAction(Oi.u.toggleConflictPagesVisibility,ol.d.view,yi.App.get_activeAppFrame().workspace.currentPageActorHandler),t.addAction(Oi.u.deleteConflictPage,ol.d.view,yi.App.get_activeAppFrame().workspace.currentPageActorHandler)}},e.ToggleVisibility=function(t,n,i,r,o){var a;if(a=o&&o.PageId?e.get_ContextMenuDataProvider().clickedPage(o):n.get_node(),e.get_PageReader().isConflictPageNode(a)){var l=e.get_PageNavigator().getContainingPage(a),s=yi.App.get_activeAppFrame().workspace.get_activePage();s&&e.get_PageReader().isConflictPageNode(s)&&e.get_PageNavigator().getContainingPage(s)===l&&2===i&&yi.App.get_activeAppFrame().workspace.set_activePage(l),a=l}if(!e.get_PageReader().hasConflictPages(a))return 8;if(1===i)return 32;var u=new Ma.GraphTransaction(3);return u.setFromNode(a),e.get_PageEditor().setConflictPagesVisibility(a,!e.get_PageReader().areConflictPagesVisible(a)),u.dispose(),e.get_BusinessBarControllerFuture().execute((function(e){e.checkCurrentPageStatusBusinessBars()})),32},e.DeleteConflict=function(t,n,i,r,o){var a,l=o;return a=l&&l.ConflictId&&l.PageId?e.GetConflictPageFromActionData(o):sI.conflictPageClicked||n.get_node(),e.get_PageReader().isConflictPageNode(a)?1===yi.App.get_activeAppFrame().get_mode()?8:1===i?32:(e.get_PageEditor().showDeletePageDialog(a),32):8},e.GetConflictPageFromActionData=function(t){var n=t,i=e.get_ContextMenuDataProvider().clickedPage(t),r=mt.h.createFromString(n.ConflictId.toString());return i.getChildGraphSpaceNodeForObjectSpace(r)},e._pageEditor=null,e._businessBarControllerFuture=null,e._contextMenuDataProvider=null,e}();(0,o.l)(YE,"5b2d0637$ConflictPageActor",null,[]);var ZE=function(){function e(){}return e.prototype.RegisterActions=function(e){e.addAction(nS.u.copyToCloud,Ue.m.frame,o.i(this,this.OnCopyNotebook,"OnCopyNotebook"))},e.prototype.OnCopyNotebook=function(t,n,i,r,o){if(1===i)return 32;var a=L.AFrameworkApplication.appSettingsManager.get_appSettings()[e.CopyNotebookURL],l=L.AFrameworkApplication.appSettingsManager.get_appSettings()[e.NotebookId],s=L.AFrameworkApplication.appSettingsManager.get_appSettings()[e.NotebookName];if(a&&s&&l){S.ULS.sendTraceTag(8721284,339,50,"WAC initiated Copy Notebook Capture API"),l=Rn.l.urlKeyValueEncode(l),s=Rn.l.urlKeyValueEncode(s);var u=String.format(e.CopyNotebookURLFormat,a,l,s);window.open(u,e.WindowType,e.WindowSpecs)}else S.ULS.sendTraceTag(8721285,339,50,"WAC unable to initiate Copy Notebook Capture API");return 32},e.CopyNotebookURL="OneNoteCopyNotebookURL",e.NotebookId="NotebookId",e.NotebookName="NotebookName",e.CopyNotebookURLFormat="{0}?id={1}&name={2}",e.WindowType="_blank",e.WindowSpecs="width=800,height=600",e}();(0,o.l)(ZE,"9845b91d$CopyToCloudActor",null,[]);var eF=n(1674),tF=function(){function e(){}return e.get_UnsupportedNodeEditor=function(){return tm.q.get_instance()},e.DeleteBlockContent=function(e,t,n,i,r){if(1===n)return 32;var o=t,a=o.get_node();return Ga.ParagraphReader.isParagraphContext(o)&&!a.get_isBlockContent()?2:eF.g.deleteOutlineElementContent(a,n)},e}();(0,o.l)(tF,"40e75b9b$DeleteBlockContentStrategy",null,[]);var nF=n(9096),iF=function(){function e(){}return e.prototype.get_LockedRangeEditor=function(){return za.k.get_instance()},e.prototype.deleteParagraphContent=function(t,n,i,r,a){var l=n;if(1===i)return 32;var s=t===Oi.u.backspace||t===Oi.u.deleteFromInputEvent;if(this.get_LockedRangeEditor().get_isContentControlEditingEnabled()){if(this.get_LockedRangeEditor().isGraphNodeContextInEmptyContentControl(l)&&e.get_ContentControlOperator()){var u=l.clone();if(u.set_ccBoundaryIdxAtCpEnd(u.get_ccBoundaryIdxAtCpEnd()+1),u.set_ccBoundaryIdxAtCpBegin(u.get_ccBoundaryIdxAtCpBegin()-1),this.get_LockedRangeEditor().isTextRangeContextDeletable(u)){var c=[u];return e.get_ContentControlOperator().releaseContentControlsInContexts(c),32}}if(Gl.n.get_instance().get_item(14)&&this.get_LockedRangeEditor().isLockedForDeleteOrBackspaceKey(l,s))return 2}if(e.get_ExternalSelectionManagerFuture()&&e.get_ExternalSelectionManagerFuture().get_instance()&&e.get_ExternalSelectionManagerFuture().get_instance().isExternalSelectionContext(l))return 4;var d=l.get_node(),p=l.get_cpBegin(),h=l.get_cpEnd(),_=l.get_ccBoundaryIdxAtCpBegin(),m=l.get_ccBoundaryIdxAtCpEnd(),f=Ga.ParagraphReader.text(d),C=f.length,S=t,b=!1;if(p===h){if(s&&!p||!s&&p===C)return 2;s?(Gl.n.get_instance().get_item(14)&&(b=this.get_LockedRangeEditor().moveIpToStartOfFieldRangeIfExists(d,(0,g.m)((function(){return p}),(function(e){return p=e})))),b||(b=this.get_LockedRangeEditor().moveIpToStartOfContentControlIfExists(l,(0,g.m)((function(){return p}),(function(e){return p=e})),(0,g.m)((function(){return _}),(function(e){return _=e})))),b||(p--,Rn.l.isLowSurrogateCharAt(f,p)&&p--),S=Oi.u.backspaceCharacter):(Gl.n.get_instance().get_item(14)&&(b=this.get_LockedRangeEditor().moveIpToEndOfFieldRangeIfExists(d,(0,g.m)((function(){return h}),(function(e){return h=e})))),b||(b=this.get_LockedRangeEditor().moveIpToEndOfContentControlIfExists(l,(0,g.m)((function(){return h}),(function(e){return h=e})),(0,g.m)((function(){return m}),(function(e){return m=e})))),b||(h++,Rn.l.isLowSurrogateCharAt(f,h)&&h++),S=Oi.u.deleteCharacter)}var v=p===h?Wa.y.createIpContext(d,p):Wa.y.createTextRange(d,p,h);if(b&&this.get_LockedRangeEditor().get_isContentControlEditingEnabled()&&(s?v.set_ccBoundaryIdxAtCpBegin(_):v.set_ccBoundaryIdxAtCpEnd(m)),Gl.n.get_instance().get_item(14)&&!this.get_LockedRangeEditor().isTextRangeContextDeletable(v))return 2;this.acquireLocksForGraphNode(d);var T=new Ma.GraphTransaction(15);T.set_undoActionId(S),T.setFromNode(d);var A=o.r(xm,a)&&a.forceDeletion;if(e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()&&!A){var I=e.get_TrackChangeManager().beginUntrackedChangeCapture();try{var w,x=e.get_TrackChangeReader().splitAndSortTrackableContexts(v);if(x.getUntrackedChangeType((0,g.m)((function(){return w}),(function(e){return w=e})))){var E=(0,y.e)(ph.d,a);!!E&&E.getValueWithDefault(Boolean,ep.p.isDeleteFromOvertype,!1)||1===w?e.get_TrackChangeManager().set_pendingUntrackedChangeAlert(w):e.get_TrackChangeManager().alertUntrackedChange(w)}for(var F=0,P=function(t){var n,i=x.getContext(t,(0,g.m)((function(){return n}),(function(e){return n=e})));n?(e.get_HyperlinkEditor().normalizeHyperlinksinGraphNodeContext(i,null),F+=e.get_TrackChangeEditor().setTrackChangeOnContext(i,2),e.get_TrackChangeEditor().set_cpPositionAfterTrackChange(h+F)):D.deleteParagraphContentUsingReplaceTextRange(i)},D=this,R=x.get_length()-1;R>=0;--R)P(R)}finally{I&&I.dispose()}}else this.deleteParagraphContentUsingReplaceTextRange(v);return T.dispose(),32},e.prototype.acquireLocksForGraphNode=function(e){},e.get_TrackChangeManager=function(){return e._trackChangeManager||(e._trackChangeManager=Ge.w.get_instance().resolve(xa.b).get_instance())},e.get_TrackChangeEditor=function(){return e._trackChangeEditor||(e._trackChangeEditor=Ge.w.get_instance().resolve(es.x).get_instance())},e.get_TrackChangeReader=function(){return e._trackChangeReader||(e._trackChangeReader=Ge.w.get_instance().resolve(Ta.p).get_instance())},e.get_HyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=Ge.w.get_instance().resolve(Ba.o))},e.get_ExternalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=Ge.w.get_instance().resolveFuture(kg.i))},e.get_ContentControlOperator=function(){return e._futureCCOperator||(e._futureCCOperator=Ge.w.get_instance().resolveFuture(nF.r)),e._futureCCOperator.get_instance()},e._trackChangeManager=null,e._trackChangeEditor=null,e._trackChangeReader=null,e._hyperlinkEditor=null,e._externalSelectionManagerFuture=null,e._futureCCOperator=null,e}();(0,o.l)(iF,"39b89485$ADeleteParagraphContentStrategy",null,[]);var rF=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.deleteParagraphContentUsingReplaceTextRange=function(e){t.get_CharacterPropertiesEditor().replaceTextRange(Wa.y.createTextRange(e.get_node(),e.get_cpBegin(),e.get_cpEnd()),"",void 0,void 0,Oi.u.backspaceDelete)},t.get_CharacterPropertiesEditor=function(){return t._characterPropertiesEditor||(t._characterPropertiesEditor=Ge.w.get_instance().resolve(ba.x))},t.get_UnsupportedNodeEditor=function(){return tm.q.get_instance()},t._characterPropertiesEditor=null,t}(iF);(0,o.l)(rF,"22e07cdc$DeleteParagraphContentStrategy",iF,[]);var oF=n(7332),aF=n(851),lF=function(){return function(e,t,n,i){this.viewContext=null,this.reportingData=null,this.actionData=null,this.actionId=0,this.viewContext=e,this.reportingData=n,this.actionData=i,this.actionId=t}}();(0,o.l)(lF,"e960ef65$DeleteActionData",null,[]);var sF=function(){function e(){}return e.prototype.get_ClipboardOperationCutStrategy=function(){return e._clipboardOperationCutStrategy||(e._clipboardOperationCutStrategy=Ge.w.get_instance().resolve($d))},e.prototype.get_IsContentControlEditingEnabled=function(){return e._ccConfigSettings||(e._ccConfigSettings=Ge.w.get_instance().tryResolve(Q_.i)),!!e._ccConfigSettings&&e._ccConfigSettings.get_isContentControlEditingEnabled()},e.prototype.trackContextForNonIpDelete=function(e){return!ga.SelectionEditor.isTextRangeContext(e)},e.prototype.deleteView=function(t,n,i,r,o){if(1===i)return 32;var a=!1;t===Oi.u.ctrlDelete&&(t=Oi.u.deleteKey,a=!0),t===Oi.u.ctrlBackspace&&(t=Oi.u.backspace,a=!0),t===Oi.u.deleteFromAgaveRichAPI&&(n=new yh.k(yi.App.get_activeAppFrame().workspace.get_contentView()));var l=n;if(!l.view.get_isInteractiveView())return 2;var s=l.view.get_selectionManager();Dy.o.get_instance().setVisibility(!1);var u=t===Oi.u.deleteKey,c=s.get_selectionCollection().get_length()>0?s.get_selectionCollection().get_item(0):null;if(a&&this.get_IsContentControlEditingEnabled()&&c&&ga.SelectionEditor.isInsertionPointSelection(c)&&Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().isLockedForDeleteOrBackspaceKey(c.get_firstContext(),!u,!0))return 2;var d=e.getSelectionToDelete(c,u,a);return this.DeleteViewInternal(t,n,i,r,o,d,u,a)},e.prototype.DeleteViewInternal=function(t,n,i,r,o,a,l,s){var u=this,c=n,d=c.view,p=d.get_selectionManager(),h=o,_=o;if(t===Oi.u.deleteFromAgaveRichAPI&&(h=null,_=null,a=new Ah.Selection(o,!0)),!a)return 32;var m,f=new lF(c,t,r,_),y=this.ShouldDeleteTableSegments(h,l,p),C=!1;if(this.shouldPerformDeleteRowColumnInComplexTable(t,y,p,(0,g.m)((function(){return C}),(function(e){return C=e}))))return t=C?Oi.u.deleteColumn:Oi.u.deleteRow,L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,t,i,!1,r,o);if(this.get_IsContentControlEditingEnabled()&&e.get_ContentControlOperator()&&1===p.get_selectionCollection().get_length()&&ga.SelectionEditor.isInsertionPointSelection(a)&&a.get_containsSingleContext()&&e.get_ContentControlOperator().selectAdjacentContentControlIfExist(a.get_firstContext(),l))return 32;l?Dr.t.mark(m=5009):Dr.t.mark(m=5011);var S=new Ma.GraphTransaction(15);S.set_undoActionId(t),S.setFromNode(d.get_targetNode());var b=null,v=this.GetContextToDelete(t,o,p,a,l,(0,g.m)((function(){return b}),(function(e){return b=e}))),T=null;if(am.ContextSetEditor.get_instance().shrinkContextSetForDeleteAction(v,(0,g.m)((function(){return T}),(function(e){return T=e})))&&(v=T),!v)return S.dispose(),32;if(this.get_IsContentControlEditingEnabled()&&e.get_ContentControlOperator()){var A=am.ContextSetEditor.get_instance().breakDownContextSets(v);e.get_ContentControlOperator().releaseContentControlsInContexts(A)}this.TrackIfNodeCanBeDisconnectedDuringDelete(v);var I=this.getAdjacentIp(v,a,l),w=null;l?w=new Tm(a):I&&(w=new Tm(I));var x=!1;if(ga.SelectionEditor.isInsertionPointContext(v)){if(t===Oi.u.deleteFromInputEvent)return 2;var E=rm.getNormalizer(d.get_targetNode(),y);e.get_cpuMeter().profileFunction((function(){u.DeleteAtInsertionPointContext(t,n,r,o,v,l,w,a,E,p,y,f,I)}),"DeleteViewStrategy:DeleteAtInsertionPointContext")}else e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()?(this.TrackContentDeletionChange(t,d.get_targetNode(),v,l,a,p,y,s,f,w),x=!0):x=this.PerformUntrackedDelete(t,d.get_targetNode(),v,p,y,f,w,b);return e.fixConsecutiveSpaces(p),this.ResetNodeCanBeDisconnectedDuringDeleteProperty(v),S.dispose(),Dr.t.mark(m+1),t===Oi.u.deleteFromAgaveRichAPI?x?32:8:32},e.prototype.deleteFromInputEvent=function(e,t,n,i,r){return t.view.get_isInteractiveView()?this.DeleteViewInternal(e,t,n,i,null,r,!1,!1):2},e.prototype.PerformUntrackedDelete=function(t,n,i,r,a,l,s,u){var c=rm.getNormalizer(n,a);this.trackContextForNonIpDelete(i)&&c.trackContext(i);var d=e.get_ActivityManager().startActivity(t);d.get_properties().set_item("CountOfParagraphsDeleted",e.get_ParagraphReader().countOfParagraphsInContext(i).toString());var g=e.dispatchDeleteConditional(e.ShouldDispatchWithSpecialize,o.i(this,this.shouldDispatchNoSpecialize,"shouldDispatchNoSpecialize"),i,r,a,c,l,s,u);return d.end(),g},e.prototype.TrackContentDeletionChange=function(t,n,i,r,o,a,l,s,u,c){var d=0,g=null,p=am.ContextSetEditor.get_instance().breakDownContextSets(i),h=p[p.length-1];if(h.get_contextId()===ol.d.paragraph||h.get_contextId()===ol.d.endOfParagraph){var _=ha.g.createFromNode(h.get_node());_.tryToRootAtOutlineAncestor(),_s.OutlineElementNavigator.returnToOutlineElement(_),_s.OutlineElementNavigator.moveToNextOutlineElement(_,!0,!1)&&(g=_s.OutlineElementNavigator.moveToContent(_))&&(d=e.get_ParagraphReader().textLength(g))}else d=e.get_ParagraphReader().textLength(h.get_node())-h.get_cpEnd();var m=(0,y.e)(ph.d,u.actionData),f=!!m&&m.getValueWithDefault(Boolean,ep.p.isDeleteFromOvertype,!1);if(f)this.performContextDeletion(t,n,i,a,l,u,c,!1,f);else{var C=e.get_TrackChangeManager().beginUntrackedChangeCapture();try{this.performContextDeletion(t,n,i,a,l,u,c,!0)}finally{C&&C.dispose()}}var S=null;if(r){var b=void 0,v=null;if(i.get_isContextSet()){var T=p.length-1;do{v=p[T],T--}while(!v.get_node().get_isConnected()&&T>=0)}else v=i;if(!e.get_ParagraphReader().isParagraphNode(v.get_node()))return;switch(h.get_contextId()){case ol.d.paragraph:case ol.d.endOfParagraph:b=g&&g.get_isConnected()?0:d;break;case ol.d.insertionPoint:case ol.d.textRange:b=d;break;default:b=0}S=Ua.SelectionFactory.createIpSelection(v.get_node(),e.get_ParagraphReader().textLength(v.get_node())-b),v.get_actualCpBegin()===S.get_firstContext().get_cpBegin()&&S.get_firstContext().set_ccBoundaryIdxAtCpBegin(v.get_ccBoundaryIdxAtCpBegin())}else{var A=o.get_firstContext().get_node();if(!e.get_ParagraphReader().isParagraphNode(A))return;var I=o.get_firstContext().get_contextId()===ol.d.paragraph?0:o.get_firstContext().get_contextId()===ol.d.endOfParagraph?e.get_ParagraphReader().textLength(A):o.get_firstContext().get_cpBegin();S=Ua.SelectionFactory.createIpSelection(A,I)}fa.SelectionManager.get_instance().setSelection(S)},e.prototype.performContextDeletion=function(t,n,i,r,o,a,l,s,u){void 0===u&&(u=!1),i=this.GeneralizeContext(r,i);var c,d=e.get_TrackChangeReader().splitAndSortTrackableContexts(i);d.getUntrackedChangeType((0,g.m)((function(){return c}),(function(e){return c=e})))&&(s&&1!==c?e.get_TrackChangeManager().alertUntrackedChange(c):e.get_TrackChangeManager().set_pendingUntrackedChangeAlert(c));for(var p=function(i){var s,c=d.getContext(i,(0,g.m)((function(){return s}),(function(e){return s=e})));if(s){var p=u&&c.get_contextId()===ol.d.endOfParagraph&&i===d.get_length()-1;e.get_HyperlinkEditor().normalizeHyperlinksinGraphNodeContext(c,2),p||e.get_TrackChangeEditor().setTrackChangeOnContext(c,2)}else h.PerformUntrackedDelete(t,n,c,r,o,a,l,null)},h=this,_=d.get_length()-1;_>=0;--_)p(_)},e.prototype.GeneralizeContext=function(e,t){if(o.r(FS.u,t))for(var n=Y_.generalizeSelectionToOEs(e.get_selectionCollection(),!0),i=0;i<n.get_length();i++)if(n.getContext(i).get_contextId()===ol.d.table)return n;return t},e.prototype.GetContextToDelete=function(e,t,n,i,r,o){var a=null;return e===Oi.u.deleteFromAgaveRichAPI?(a=j_.x.createSet(t),o.val=lm.a.get_instance().createReferenceToCurrentSelection()):(o.val=null,a=1===n.get_selectionCollection().get_length()?fa.SelectionManager.createMultiRangeOrGraphContext(i):n.get_selectionContextForActionDispatch()),a},e.prototype.CanDisconnectNodeDuringDelete=function(t){return!!t.get_isGraphNodeContext()&&(t.get_contextId()===ol.d.paragraph&&(!!e.get_ParagraphReader().isParagraphNode(t.get_node())&&((!e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()||!e.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled())&&(!Gl.n.get_instance().get_item(14)||!e.get_LockedRangeEditor().isParaContextInLockedRange(t)))))},e.prototype.TrackIfNodeCanBeDisconnectedDuringDelete=function(e){if(e.get_isContextSet())for(var t=e,n=0;n<t.get_length();n++)this.TrackIfNodeCanBeDisconnectedDuringDelete(t.getContext(n));else this.CanDisconnectNodeDuringDelete(e)&&e.get_node().set_canBeDisconnectedDuringDelete(!0)},e.prototype.ResetNodeCanBeDisconnectedDuringDeleteProperty=function(t){if(t.get_isContextSet())for(var n=t,i=0;i<n.get_length();i++)this.ResetNodeCanBeDisconnectedDuringDeleteProperty(n.getContext(i));else if(t.get_isGraphNodeContext()){var r=t.get_node();r&&e.get_ParagraphReader().isParagraphNode(r)&&r.set_canBeDisconnectedDuringDelete(!1)}},e.prototype.DeleteAtInsertionPointContext=function(t,n,i,r,o,a,l,s,u,c,d,g,p){var h=new ha.g,_=o.get_node();h.set(_),h.tryToRootAtOutlineAncestor(),!ga.SelectionEditor.isIpAtStartOrEnd(h.get_currentNode(),o,a)||e.get_LockedRangeEditor().get_isContentControlEditingEnabled()&&e.get_LockedRangeEditor().isGraphNodeContextInEmptyContentControl(o)?e.DeleteFromIpInMiddle(t,o,a,l,s,u,c,d,g):this.deleteFromIpAtStartOrEnd(n,i,r,o,a,l,s,u,c,g,p,h,_)},e.prototype.handleListOutlineElement=function(t,n,i,r){return!(t||!gs.ListReader.isListOutlineElement(n))&&(r.val=e.removeList(n,i),!0)},e.prototype.handleIndentOnDelete=function(e,t,n,i,r,o){return!!(Gl.n.get_instance().get_item(65)&&!e&&Ss.OutlineElementReader.getFirstLineIndentWithTabs(t)>0)&&(o.val=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,Oi.u.removeFirstLineIndent,2,!1,i,r),!0)},e.prototype.handleWordParagraphFormatting=function(e,t,n,i,r,o){return!!(Gl.n.get_instance().get_item(54)&&!e&&Ss.OutlineElementReader.getHangingIndent(t)>0)&&(o.val=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,Oi.u.removeHangingIndent,2,!1,i,r),!0)},e.prototype.handlePromoteOnBackspace=function(t,n,i,r,o,a){return!(!Gl.n.get_instance().get_item(80)||t||!e.get_IndentationEditor().canPromote(n,-1))&&(a.val=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(i,Oi.u.promoteIndent,2,!1,r,o),!0)},e.prototype.handleAdjacentOutlineElement=function(t,n,i,r,o,a,l,s,u,c,d){var g=new r_.z;if(g.setFrom(n),_s.OutlineElementNavigator.moveToNextOrPreviousOutlineElement(g,!1,!t,!1)){d.val=!0,c.val=32;var p=new ha.g;return p.setFrom(g),_s.OutlineElementNavigator.moveToContent(g),a&&r&&ga.SelectionEditor.isBlockContext(r.get_firstContext())?(i.trackContext(o),e.get_OutlineElementEditor().removeContainingOutlineElement(n.get_currentNode())):g.get_currentNode().get_isBlockContent()?(Gl.n.get_instance().get_item(68)&&i.trackContext(o),_s.OutlineElementNavigator.returnToOutlineElement(g),g.disconnectNodeAndReturnToParent()):Gl.n.get_instance().get_item(66)&&t&&a?e.get_LockedRangeEditor().isParagraphNodeDeletable(s)&&!this.ProcessEopDeletionTrackChange(t,s,g.get_currentNode(),r,d)&&(i.trackContext(o),e.get_ListEditor().removeList(n),this.get_deleteParagraphNodeStrategy()&&this.get_deleteParagraphNodeStrategy().prepareEmptyParagraphNodeForDelete(s),n.disconnectNodeAndReturnToParent()):us.TableReader.isTable(g)?(i.trackContext(o),this.get_deleteTableStrategy()&&(d.val=this.get_deleteTableStrategy().deleteAtTable(t,p,n,g,l,u,c))):e.get_ParagraphReader().isParagraphNode(g.get_currentNode())&&(this.ProcessEopDeletionTrackChange(t,s,g.get_currentNode(),r,d)||this.get_deleteParagraphNodeStrategy()&&this.get_deleteParagraphNodeStrategy().deleteAtParagrahNode(t,i,o,n,s,g)),!0}return!1},e.prototype.ProcessEopDeletionTrackChange=function(t,n,i,r,o){if(e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()){if(e.get_ContentControlReader()){var a=e.get_ContentControlReader().isParagraphInBlockContentControl(i),l=e.get_ContentControlReader().isParagraphInBlockContentControl(n);if(a!==l)return!1;if(l)return this.get_IsContentControlEditingEnabled()&&e.AreParagraphsInSameBlockContentControl(n,i,t)&&e.get_TrackChangeManager().alertUntrackedChange(1),!1}var s=t?n:i,u=s.get_characterProperties().get_last(),c=L.AFrameworkApplication.userName;if(!u.get_trackChangeInsert()||u.get_trackChangeInsert().authorName!==c)return e.get_TrackChangeEditor().setTrackChangeEop(s,2),r&&(fa.SelectionManager.get_instance().setSelection(r),o.val=!1),!0}return!1},e.prototype.handleTableStructureModificationOnDelete=function(t,n,i,r,o,a,l,s){if(Gl.n.get_instance().get_item(67)&&Ss.OutlineElementReader.isFirstOrLastOutlineElementInOutline(n,t)){var u;if(js.TableCellReader.isInTableCell(n))Pd.TableNavigator.returnToContainingCell(n),js.TableCellReader.isEmpty(n)&&i.trackContext(r),s.val=e.ModifyTableStructure(n,l,t,o,a,(0,g.m)((function(){return u}),(function(e){return u=e}))),u||(s.val=2);return!0}return!1},e.prototype.handleIsFirstOrLastOutlineElementInOutline=function(t,n,i,r,o,a,l,s){return!Ss.OutlineElementReader.isFirstOrLastOutlineElementInOutline(n,t)&&(e.doCrossNodeDelete(i,r,t,a,o,l,s),!1)},e.prototype.deleteFromIpAtStartOrEnd=function(t,n,i,r,o,a,l,s,u,c,d,p,h){var _=!1,m=2,f=e.get_ParagraphReader().isEmpty(p),y=p.get_currentNode();_s.OutlineElementNavigator.returnToOutlineElement(p),this.handleListOutlineElement(o,p,c,(0,g.m)((function(){return m}),(function(e){return m=e})))||this.handleIndentOnDelete(o,p,t,n,i,(0,g.m)((function(){return m}),(function(e){return m=e})))||this.handleWordParagraphFormatting(o,p,t,n,i,(0,g.m)((function(){return m}),(function(e){return m=e})))||this.handlePromoteOnBackspace(o,p,t,n,i,(0,g.m)((function(){return m}),(function(e){return m=e})))||this.handleAdjacentOutlineElement(o,p,s,d,r,f,y,h,u,(0,g.m)((function(){return m}),(function(e){return m=e})),(0,g.m)((function(){return _}),(function(e){return _=e})))||this.handleTableStructureModificationOnDelete(o,p,s,r,u,c,y,(0,g.m)((function(){return m}),(function(e){return m=e})))||this.handleIsFirstOrLastOutlineElementInOutline(o,p,n,i,s,l,(0,g.m)((function(){return m}),(function(e){return m=e})),(0,g.m)((function(){return _}),(function(e){return _=e}))),e.normalizeOrCancel(s,32===m),_&&e.restoreSelection(u,a)},e.prototype.ShouldDeleteTableSegments=function(e,t,n){return e&&e.hasProperty(Pl.k.doNotDeleteTableSegments)?this.get_ClipboardOperationCutStrategy().shouldDeleteTableForCut()||e.getValue(Boolean,Pl.k.doNotDeleteTableSegments)?!e.getValueWithDefault(Boolean,Pl.k.doNotDeleteTableSegments,!1):this.getDefaultShouldDeleteTableSegments(!1,n):this.getDefaultShouldDeleteTableSegments(t,n)},e.prototype.shouldPerformDeleteRowColumnInComplexTable=function(e,t,n,i){return i.val=!1,!1},e.get_CharacterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=Ge.w.get_instance().resolve(ba.x))},e.get_ListReader=function(){return e._listReader||(e._listReader=Ge.w.get_instance().resolve(Ql.c))},e.get_ParagraphReader=function(){return e._paragraphReader||(e._paragraphReader=Ge.w.get_instance().resolve(Jd.s))},e.get_HyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=Ge.w.get_instance().resolve(Ba.o))},e.get_ListEditor=function(){return e._listEditor||(e._listEditor=Ge.w.get_instance().resolve(jl.v))},e.get_OutlineElementEditor=function(){return e._oulineElementEditor||(e._oulineElementEditor=Ge.w.get_instance().resolve(ql.p))},e.get_UnsupportedNodeEditor=function(){return tm.q.get_instance()},e.get_IndentationEditor=function(){return hs.z.get_getOutlineElementIndentationEditor()},e.get_TrackChangeManager=function(){return e._trackChangeManager||(e._trackChangeManager=Ge.w.get_instance().resolve(xa.b).get_instance())},e.get_TrackChangeEditor=function(){return e._trackChangeEditor||(e._trackChangeEditor=Ge.w.get_instance().resolve(es.x).get_instance())},e.get_TrackChangeReader=function(){return e._trackChangeReader||(e._trackChangeReader=Ge.w.get_instance().resolve(Ta.p).get_instance())},e.get_ActivityManager=function(){return xr.y.get_instance()},e.get_LockedRangeEditor=function(){return za.k.get_instance()},e.get_ContentControlOperator=function(){return e._futureCCOperator||(e._futureCCOperator=Ge.w.get_instance().resolveFuture(nF.r)),e._futureCCOperator.get_instance()},e.get_ContentControlReader=function(){return e._contentControlReader||(e._contentControlReader=Ge.w.get_instance().tryResolve(oF.c))},e.get_HyperlinkStrategy=function(){return e._hyperlinkStrategy||(e._hyperlinkStrategy=Ge.w.get_instance().resolve(my.n))},e.get_cpuMeter=function(){return aF.r.get_instance()},e.fixConsecutiveSpaces=function(t){if(1===t.get_selectionCollection().get_length()){var n=t.get_selectionCollection().get_item(0);if(ga.SelectionEditor.isInsertionPointSelection(n)){var i=n.get_firstContext(),r=i.get_node(),o=i.get_cpBegin(),a=e.get_ParagraphReader().text(r);o<a.length&&o>0&&" "===a.charAt(o-1)&&" "===a.charAt(o)&&e.get_CharacterPropertiesEditor().replaceTextRange(Wa.y.createTextRange(r,o-1,o),"\xa0")}}},e.getSelectionToDelete=function(e,t,n){if(!e)return null;if(!n)return e;var i=ga.SelectionEditor.findNextOrPreviousIp(e,!1,!t,!0,!0,!0);return Ua.SelectionFactory.extendSelection(e,i.get_firstContext(),!1)},e.backspaceHyperlink=function(t,n,i){if(!n.hyperlink.get_isInFieldRange()){var r=new Ma.GraphTransaction(15);try{r.setFromNode(t.get_node()),e.get_HyperlinkStrategy().removeHyperlink(t,n)}finally{r&&r.dispose()}e.get_TrackChangeManager().get_trackHyperlinkIsEnabled()||e.get_TrackChangeManager().alertUntrackedChange(4)}},e.removeList=function(t,n){var i=e.get_ListReader().getListInfo(t).get_isOrdered()?Oi.u.toggleNumberedList:Oi.u.toggleBulletsList;return L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n.viewContext,i,2,!1,n.reportingData,n.actionData)},e.doCrossNodeDelete=function(e,t,n,i,r,o,a){var l=ga.SelectionEditor.findNextOrPreviousIp(i,!1,!n,!1,!1,!0);if(l){var s=Ua.SelectionFactory.extendSelection(i,l.get_firstContext());o.val=32;for(var u=0;u<s.get_length();++u){r.trackContext(s.get_item(u));var c=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(s.get_item(u),Oi.u.deleteKey,2,!0,e,t);2!==c&&(o.val=c)}32===o.val&&(a.val=!0)}},e.dispatchDeleteConditional=function(t,n,i,r,o,a,l,s,u){var c=!1;return t(i)?(c=e.dispatchDelete(i,!0,r,o,a,l))&&e.UpdateSelection(s,r,u):n(i)?(c=e.dispatchDelete(i,!1,r,o,a,l))&&e.UpdateSelection(s,r,u):(a.normalize(),e.UpdateSelection(s,r,u)),c},e.UpdateSelection=function(t,n,i){i&&i.restoreSelection()||e.restoreSelection(n,t)},e.dispatchDelete=function(t,n,i,r,o,a){if(!r&&!ys.OutlineReader.isOutlineLevelContext(t)){var l=e.tryToGetFullSelectedTable(i);l&&o.setTableAsNotDeletable(l)}var s=32===L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(t,a.actionId,2,n,a.reportingData,a.actionData);return e.normalizeOrCancel(o,s),s},e.normalizeOrCancel=function(e,t){t?e.normalize():e.cancel()},e.restoreSelection=function(e,t){if(t){var n=t.restore();n&&e.setSelection(n)}},e.DeleteFromIpInMiddle=function(t,n,i,r,o,a,l,s,u){var c,d=n;if(!i&&e.get_HyperlinkStrategy().isIpAtEndOfHyperlink(d,(0,g.m)((function(){return c}),(function(e){return c=e}))))r=new Tm(o),e.backspaceHyperlink(d,c,t),a.normalize(),e.restoreSelection(l,r);else if(e.dispatchDelete(n,!1,l,s,a,u))if(i&&e.get_TrackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_TrackChangeManager().get_changeTrackingDocumentSettingEnabled()){var p=e.get_TrackChangeEditor().get_cpPositionAfterTrackChange();if(p){var h=n.get_node();l.setSelection(Ua.SelectionFactory.createIpSelection(h,p)),e.get_TrackChangeEditor().set_cpPositionAfterTrackChange(null)}else e.restoreSelection(l,r)}else e.restoreSelection(l,r)},e.AreParagraphsInSameBlockContentControl=function(t,n,i){var r,o;i?(r=t,o=n):(r=n,o=t);var a=e.get_ContentControlReader().isParagraphStartOrEndWithBlockContentControl(r,!1),l=e.get_ContentControlReader().isParagraphStartOrEndWithBlockContentControl(o,!0);return!(a&&l)},e.ModifyTableStructure=function(e,t,n,i,r,o){var a=2;if(o.val=!0,js.TableCellReader.isEmpty(e)){var l=Pd.TableNavigator.getContainingTable(e),s=us.TableReader.getRowCount(l),u=us.TableReader.getColumnCount(l);if(1===s&&1===u)a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(Wa.y.create(l),Oi.u.collapseTable,2,!1,r.reportingData,r.actionData),i.setSelection(Ua.SelectionFactory.createIpSelection(t,0)),o.val=!1;else if(1===s)a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(r.viewContext,Oi.u.deleteColumn,2,!1,r.reportingData,r.actionData);else{var c=js.TableCellReader.isEmptyIncludingTheRestOfTheRow(e);if(js.TableCellReader.isFirstCellInRow(e)&&c)a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(r.viewContext,Oi.u.deleteRow,2,!1,r.reportingData,r.actionData);else if(!n&&c){a=32;var d=ga.SelectionEditor.findPreviousIp(i.get_selectionCollection().get_currentSelection(),!1,!1,!1,!0);i.setSelection(d),o.val=!1}}}return a},e.ShouldDispatchWithSpecialize=function(t){return t.get_isContextSet()||ys.OutlineReader.isOutlineLevelContext(t)||e.get_ParagraphReader().isParagraphContext(t)},e.tryToGetFullSelectedTable=function(e){var t=Y_.generalizeSelectionToOEs(e.get_selectionCollection(),!0);if(t&&1===t.get_length()){var n=t.getContext(0).get_node();if(us.TableReader.isTableNode(n))return n}return null},e._listReader=null,e._characterPropertiesEditor=null,e._oulineElementEditor=null,e._paragraphReader=null,e._hyperlinkEditor=null,e._listEditor=null,e._trackChangeManager=null,e._trackChangeEditor=null,e._trackChangeReader=null,e._futureCCOperator=null,e._contentControlReader=null,e._clipboardOperationCutStrategy=null,e._ccConfigSettings=null,e._hyperlinkStrategy=null,e}();(0,o.l)(sF,"9a88436f$ADeleteViewStrategy",null,[]);var uF=(0,o.y)("e9571584$IDeleteParagraphNodeStrategy"),cF=function(){function e(){}return e.prototype.get_OutlineElementEditor=function(){return e._oulineElementEditor||(e._oulineElementEditor=Ge.w.get_instance().resolve(ql.p))},e.prototype.deleteAtParagrahNode=function(e,t,n,i,r,o){e?(_s.OutlineElementNavigator.returnToOutlineElement(o),t.trackNode(o.get_currentNode()),this.get_OutlineElementEditor().merge(i,o,!1,!1)):(_s.OutlineElementNavigator.returnToOutlineElement(o),t.trackContext(n),this.get_OutlineElementEditor().merge(o,i,!1,!1))},e.prototype.prepareEmptyParagraphNodeForDelete=function(e){},e._oulineElementEditor=null,e}();(0,o.l)(cF,"775b1d75$DeleteParagraphNodeStrategy",null,[uF]);var dF=(0,o.y)("a0c13f14$IDeleteTableStrategy"),gF=function(){function e(){}return e.prototype.deleteAtTable=function(t,n,i,r,o,a,l){return t?(e.EnsureGraphSafeForDeleteIntoTable(i,r,n),eF.g.deleteIntoTable(i,r,o),!0):e.BackspaceIntoTable(i,r,o)},e.get_IndentationEditor=function(){return hs.z.get_getOutlineElementIndentationEditor()},e.get_OutlineElementEditor=function(){return e._oulineElementEditor||(e._oulineElementEditor=Ge.w.get_instance().resolve(ql.p))},e.EnsureGraphSafeForDeleteIntoTable=function(t,n,i){if(i.hasAncestor(t.get_currentNode())){var r=new i_(n),o=new i_(i);e.get_IndentationEditor().demote(t,Ss.OutlineElementReader.getAbsoluteOutlineLevel(i)-Ss.OutlineElementReader.getAbsoluteOutlineLevel(t),0),r.restore(n),o.restore(i)}},e.BackspaceIntoTable=function(t,n,i){Pd.TableNavigator.moveToLastRow(n),Pd.TableNavigator.moveToLastColumn(n),fs.OutlineNavigator.moveToLastOutlineElement(n),_s.OutlineElementNavigator.moveToContent(n);var r=Ga.ParagraphReader.canContainIpOrTextRange(n.get_currentNode());return _s.OutlineElementNavigator.returnToOutlineElement(n),r?(e.get_OutlineElementEditor().merge(n,t,!1,!1),!0):(Pd.TableNavigator.returnToCell(n),n.addChild(t.get_currentNode(),t.get_role()),t.disconnectNodeAndReturnToParent(),i.get_anchor().invalidateViewChannelForAllViews(9),!1)},e._oulineElementEditor=null,e}();(0,o.l)(gF,"7c71a4e5$DeleteTableStrategy",null,[dF]);var pF=n(4581),hF=function(e){function t(){var t=e.call(this)||this;return t._deleteParagraphNodeStrategy=null,t._deleteTableStrategy=null,t._deleteTableStrategy=new gF,t._deleteParagraphNodeStrategy=new cF,t}return(0,v.t)(t,e),t.prototype.get_deleteTableStrategy=function(){return this._deleteTableStrategy},t.prototype.get_deleteParagraphNodeStrategy=function(){return this._deleteParagraphNodeStrategy},t.prototype.shouldDispatchNoSpecialize=function(e){return ga.SelectionEditor.isTextRangeContext(e)||pa.ImageReader.isImageContext(e)||N_.EmbeddedFileReader.isEmbeddedFileContext(e)||Vf.q.isIFrameContext(e)||t.get_UnsupportedNodeEditor().isUnsupportedContext(e)||pF.r.isBlockInkContext(e)},t.prototype.getDefaultShouldDeleteTableSegments=function(e,t){return!0},t.prototype.getAdjacentIp=function(e,t,n){return ga.SelectionEditor.findNextOrPreviousIp(t,!0,!n,!1,!1,!0)},t.prototype.HandleOutlineElementWithNoteTags=function(e,t,n,i,r,o){return!(!vb.b.isOutlineElementWithNoteTags(t)||(o.val=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,nS.u.noteTagRemoveAll,2,!1,i,r),e))},t.prototype.deleteFromIpAtStartOrEnd=function(e,t,n,i,r,o,a,l,s,u,c,d,p){var h=!1,_=2,m=Ga.ParagraphReader.isEmpty(d),f=d.get_currentNode();_s.OutlineElementNavigator.returnToOutlineElement(d),this.handleListOutlineElement(r,d,u,(0,g.m)((function(){return _}),(function(e){return _=e})))||this.HandleOutlineElementWithNoteTags(r,d,e,t,n,(0,g.m)((function(){return _}),(function(e){return _=e})))||this.handlePromoteOnBackspace(r,d,e,t,n,(0,g.m)((function(){return _}),(function(e){return _=e})))||this.handleAdjacentOutlineElement(r,d,l,c,i,m,f,p,s,(0,g.m)((function(){return _}),(function(e){return _=e})),(0,g.m)((function(){return h}),(function(e){return h=e})))||this.handleTableStructureModificationOnDelete(r,d,l,i,s,u,f,(0,g.m)((function(){return _}),(function(e){return _=e})))||this.handleIsFirstOrLastOutlineElementInOutline(r,d,t,n,l,a,(0,g.m)((function(){return _}),(function(e){return _=e})),(0,g.m)((function(){return h}),(function(e){return h=e}))),sF.normalizeOrCancel(l,32===_),h&&sF.restoreSelection(s,o)},t.get_UnsupportedNodeEditor=function(){return tm.q.get_instance()},t}(sF);(0,o.l)(hF,"e538dcf6$DeleteViewStrategy",sF,[]);var _F=function(e){function t(){var t=e.call(this)||this;return t._deleteBlockContentStategy=null,t._deleteViewStrategy=null,t._deleteParagraphContentStrategy=null,t._deleteBlockContentStategy=new tF,t._deleteViewStrategy=new hF,t._deleteParagraphContentStrategy=new rF,t}return(0,v.t)(t,e),t.prototype.get_deleteViewStrategy=function(){return this._deleteViewStrategy},t.prototype.get_deleteParagraphContentStrategy=function(){return this._deleteParagraphContentStrategy},t.prototype.registerAppSpecificActions=function(t,n,i,r){var o=tF.DeleteBlockContent;t.addAction(Oi.u.backspace,ol.d.image,o),t.addAction(Oi.u.backspace,ol.d.embeddedFile,o),t.addAction(Oi.u.backspace,ol.d.paragraph,o),t.addAction(Oi.u.backspace,ol.d.ink,o),t.addAction(Oi.u.backspace,ol.d.iFrame,o),t.addAction(Oi.u.backspace,ol.d.floatingImage,i),t.addAction(Oi.u.backspace,ol.d.floatingEmbeddedFile,i),t.addAction(Oi.u.backspace,ol.d.floatingInk,i),t.addAction(Oi.u.backspace,ol.d.floatingIFrame,i),t.addAction(Oi.u.backspace,ol.d.unsupportedObject,o),t.addActionWithFlags(Oi.u.backspaceKeyHandler,Ue.m.frame,eF.g.backspaceKeyHandler,96),t.addAction(Oi.u.deleteKey,ol.d.image,o),t.addAction(Oi.u.deleteKey,ol.d.embeddedFile,o),t.addAction(Oi.u.deleteKey,ol.d.paragraph,o),t.addAction(Oi.u.deleteKey,ol.d.ink,o),t.addAction(Oi.u.deleteKey,ol.d.iFrame,o),t.addAction(Oi.u.deleteKey,ol.d.floatingImage,i),t.addAction(Oi.u.deleteKey,ol.d.floatingEmbeddedFile,i),t.addAction(Oi.u.deleteKey,ol.d.floatingInk,i),t.addAction(Oi.u.deleteKey,ol.d.floatingIFrame,i),t.addAction(Oi.u.deleteKey,ol.d.unsupportedObject,o),t.addAction(Oi.u.deleteFromAgaveRichAPI,ol.d.image,o),t.addAction(Oi.u.deleteFromAgaveRichAPI,ol.d.embeddedFile,o),t.addAction(Oi.u.deleteFromAgaveRichAPI,ol.d.paragraph,o),t.addAction(Oi.u.deleteFromAgaveRichAPI,ol.d.ink,o),t.addAction(Oi.u.deleteFromAgaveRichAPI,ol.d.iFrame,o),t.setActionFlags(Oi.u.deleteFromAgaveRichAPI,64),e.prototype.registerAppSpecificActions.call(this,t,n,i,r)},t.get_instance=function(){return t._instance||(t._instance=new t)},t._instance=null,t}(eF.g);(0,o.l)(_F,"f280d96b$DeleteActor",eF.g,[]);var mF=function(){function e(e,t){this._outlineElementReader=null,this._titleReader=null,this._outlineElementReader=e,this._titleReader=t}return e.prototype.isParentOfDeletedOutlineElements=function(e){return 10===e.get_currentNodeType()||16===e.get_currentNodeType()},e.prototype.canDeleteWithoutMerge=function(e){return this._outlineElementReader.isOutlineElement(e)&&this._outlineElementReader.isEmpty(e,!0)&&!this._titleReader.isInTitle(e)},e.prototype.shouldKeepOutlineElementAfterDelete=function(e,t){return this._outlineElementReader.isLastOutlineElementInOutline(e)},e.prototype.shouldFollowFirstSelectedOEAfterDelete=function(e,t){return!1},e}();(0,o.l)(mF,"e1d6f745$DeleteOutlineElementNodeStrategy",null,[em.j]);var fF=function(){function e(){}return e.prototype.findPageInActiveSection=function(e){var t=mt.h.createFromString(e);return L.AFrameworkApplication.get_activeFrame().workspace.get_activeSection().getChildGraphSpaceNodeForObjectSpace(t)},e.prototype.findGraphSpaceNode=function(e,t){for(var n=this.SetUpTraverser(t);n.moveNext();){var i=(0,y.e)(wi.n,n.get_currentNode());if(!i)return null;if(131120===t?i.get_hasPageMetadata()&&i.get_objectSpaceId().toString()===e:i.get_hasSectionMetadata()&&i.get_oneNoteLocalSectionId()===e)return i}return null},e.prototype.SetUpTraverser=function(e){var t=131121===e||131122===e?yi.App.theNotebookManager.get_defaultNotebookNode():yi.App.theNotebookManager.get_notebookNode(),n=X_.z.createTraverser(t);return n.setFilter(o.i(this,this.GraphSpaceNodeFilter,"GraphSpaceNodeFilter"),null),n},e.prototype.GraphSpaceNodeFilter=function(e,t){return e.get_currentNode().get_isGraphSpace()},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();(0,o.l)(fF,"bea305b3$GraphHelper",null,[]);var yF=function(){function e(){}return e.prototype.clickedPage=function(e){var t=e,n=fF.get_instance().findPageInActiveSection(t.PageId);return n},e.prototype.clickedSection=function(e){var t=e,n=fF.get_instance().findGraphSpaceNode(t.SectionId,131121);return n},e.prototype.getColorFromActionData=function(e){var t=e.SectionBGRColor;return ff.o.notebookBGRValueToColor[t.toString()]},e}();(0,o.l)(yF,"7c205933$OreoContextMenuDataProvider",null,[iE]);var CF=function(){function e(t){e._contextMenuDataProvider=t}return e.prototype.isMultiplePages=function(t,n){void 0===n&&(n="PageId");var i=t;return o.r(yF,e._contextMenuDataProvider)&&!!i&&n in i&&i[n].indexOf(",")>0},e.prototype.getMultiplePagesAsActionData=function(e,t){void 0===t&&(t="PageId");for(var n=e[t].split(","),i=new C.c(Object),r=0,o=n;r<o.length;r++){var a=o[r],l={};l[t]=a,i.add(l)}return i},e.prototype.getMultiplePagesAsList=function(e,t){void 0===t&&(t="PageId");for(var n=new C.c(wi.n),i=0,r=e[t].split(",");i<r.length;i++){var o=r[i],a=fF.get_instance().findPageInActiveSection(o);n.add(a)}return n},e.get_instance=function(){return e._instance||(e._instance=e.GetInstanceWithResolvedDependencies())},e.GetInstanceWithResolvedDependencies=function(){return new e(e.get_ContextMenuDataProvider())},e.get_ContextMenuDataProvider=function(){return e._contextMenuDataProvider||(e._contextMenuDataProvider=Ge.w.get_instance().resolve(iE))},e._contextMenuDataProvider=null,e._instance=null,e}();(0,o.l)(CF,"33a16585$MultiPageHelper",null,[]);var SF,bF=function(){function e(){this._pageEditor=null,this._sectionEditor=null,this._folderEditor=null,this._contextMenuDataProvider=null}return e.prototype.get_PageEditor=function(){return this._pageEditor||(this._pageEditor=Ge.w.get_instance().resolve(Kb.f))},e.prototype.get_SectionEditor=function(){return this._sectionEditor||(this._sectionEditor=Ge.w.get_instance().resolve(db.f))},e.prototype.get_FolderEditor=function(){return this._folderEditor||(this._folderEditor=Ge.w.get_instance().tryResolve(Hb.x))},e.prototype.get_ContextMenuDataProvider=function(){return this._contextMenuDataProvider||(this._contextMenuDataProvider=Ge.w.get_instance().resolve(iE))},e.prototype.RegisterActions=function(){var e=L.AFrameworkApplication.get_theActionManager();e.addAction(nS.u.movePageInSection,ol.d.view,o.i(this,this.MovePageInSection,"MovePageInSection")),e.addAction(nS.u.moveSectionInFolder,ol.d.view,o.i(this,this.MoveSectionInFolder,"MoveSectionInFolder")),e.addAction(nS.u.movePageToSection,ol.d.view,o.i(this,this.MovePageToSection,"MovePageToSection"))},e.prototype.MovePageInSection=function(e,t,n,i,r){var o=r;if(CF.get_instance().isMultiplePages(r,"DragPageId")){for(var a=CF.get_instance().getMultiplePagesAsActionData(r,"DragPageId"),l=o.DropPageId,s=a.$$lge();s.$$mn();){var u=s.$$cu();u.DropPageId=l,this.MovePageInSection(e,t,n,i,u),l=u.DragPageId}return 32}var c=fF.get_instance().findGraphSpaceNode(o.DragPageId,131120),d=fF.get_instance().findGraphSpaceNode(o.DropPageId,131120),g=c.getParentGraphSpace();return this.get_PageEditor().move(c,g,d,!1,!0),32},e.prototype.MoveSectionInFolder=function(e,t,n,i,r){var o=r,a=fF.get_instance().findGraphSpaceNode(o.DragSectionId,131121),l=null,s=o.DropSectionId;return""!==s&&(l=fF.get_instance().findGraphSpaceNode(s,131121)),l=fF.get_instance().findGraphSpaceNode(o.DropSectionId,131121),this.get_FolderEditor().moveSection(a,l),32},e.prototype.MovePageToSection=function(e,t,n,i,r){var o=r;if(CF.get_instance().isMultiplePages(r,"DragPageId")){for(var a=CF.get_instance().getMultiplePagesAsActionData(r,"DragPageId"),l=o.DropSectionId,s=a.$$lge();s.$$mn();){var u=s.$$cu();u.DropSectionId=l,this.MovePageToSection(e,t,n,i,u)}return 32}var c=fF.get_instance().findGraphSpaceNode(o.DragPageId,131120),d=fF.get_instance().findGraphSpaceNode(o.DropSectionId,131121);if(d)if(d.get_isContentPresent())this.get_PageEditor().move(c,d,null,!0,!0);else{var g=this.get_PageEditor().createDeferredPageMoveCallback(c,d,null,!0);this.get_SectionEditor().load(d,g,null,null)}return 32},e}();(0,o.l)(bF,"5ca6960$DragAndDropActor",null,[]),function(e){e[e.oneDrive=0]="oneDrive",e[e.local=1]="local"}(SF||(SF={})),(0,o.h)("4b14cf33$FileInsertType",SF);var vF=function(){return function(){this.radioButtonDomElementId=null,this.imageCssClass=null,this.headerText=null,this.explanationText=null}}();(0,o.l)(vF,"fdf0cfc4$InsertFileTypeRadioButtonData",null,[]);var TF=function(e){function t(n,i){var r=this;return r._clickInputManager=null,r._keypressInputManager=null,r._oneDriveRadioElement=null,r._localRadioElement=null,r._oneDriveButtonData=null,r._localButtonData=null,r._hiddenInputElement=null,r._selectedInsertType=0,(r=e.call(this)||this)._clickInputManager=n,r._keypressInputManager=i,r._oneDriveButtonData=(0,U.m)(new vF,{headerText:OneNoteIntl.OneNoteStrings.L_AttachAsOneDriveFile,explanationText:OneNoteIntl.OneNoteStrings.L_AttachAsOneDriveFileExplanation,imageCssClass:"one_FromOnlineServices_48x48x32",radioButtonDomElementId:"oneDriveFileInsert"}),r._localButtonData=(0,U.m)(new vF,{headerText:OneNoteIntl.OneNoteStrings.L_AttachACopy,explanationText:OneNoteIntl.OneNoteStrings.L_AttachACopyExplanation,imageCssClass:"one_Attachment_48x48x32",radioButtonDomElementId:"insertLocalFile"}),r.set_buttonsOption(0),r.set_dialogHtml(String.format('\r\n\t\t\t\t<div class="ChooseInsertFileTypeContainer" role="radiogroup" aria-labelledby="WACDialogTitleText">\r\n\t\t\t\t\t{0}{1}\r\n\t\t\t\t\t<input id="{2}" type="hidden"/>\r\n\t\t\t\t</div>',r.RadioButtonHtml(r._oneDriveButtonData),r.RadioButtonHtml(r._localButtonData),t.hiddenInputElementId)),r}return(0,v.t)(t,e),t.prototype.get_SelectedInsertType=function(){return this._selectedInsertType},t.prototype.set_SelectedInsertType=function(e){switch(this._selectedInsertType=e,this.UpdateHiddenControlValue(this._selectedInsertType),this._selectedInsertType){case 0:this.UpdateRadioButtonState(this._oneDriveRadioElement,!0),this.UpdateRadioButtonState(this._localRadioElement,!1);break;case 1:this.UpdateRadioButtonState(this._localRadioElement,!0),this.UpdateRadioButtonState(this._oneDriveRadioElement,!1)}return e},t.prototype.onInnerHtmlSet=function(){this._oneDriveRadioElement=document.getElementById(this._oneDriveButtonData.radioButtonDomElementId),this._localRadioElement=document.getElementById(this._localButtonData.radioButtonDomElementId),this._hiddenInputElement=document.getElementById(t.hiddenInputElementId)},t.prototype.attachDialogEvents=function(){var t=this;e.prototype.attachDialogEvents.call(this),this._clickInputManager.registerHandler(me.d.click,this._oneDriveRadioElement,(function(e){return t.SetSelectedInsertType(0),!0})),this._clickInputManager.registerHandler(me.d.click,this._localRadioElement,(function(e){return t.SetSelectedInsertType(1),!0})),this._keypressInputManager.registerHandler(me.d.keyDown,this._oneDriveRadioElement,(function(e){return(e.innerEvent.keyCode===Sys.UI.Key.down||e.innerEvent.keyCode===Sys.UI.Key.up)&&(t.SetSelectedInsertType(1),!0)})),this._keypressInputManager.registerHandler(me.d.keyDown,this._localRadioElement,(function(e){return(e.innerEvent.keyCode===Sys.UI.Key.down||e.innerEvent.keyCode===Sys.UI.Key.up)&&(t.SetSelectedInsertType(0),!0)})),this.set_SelectedInsertType(0)},t.prototype.SetSelectedInsertType=function(e){e!==this.get_SelectedInsertType()&&(S.ULS.sendTraceTag(24261851,339,50,"User changed insert file type selection"),this.set_SelectedInsertType(e))},t.prototype.UpdateRadioButtonState=function(e,t){e.setAttribute(vt.t.ariaRoleAttribute,vt.t.ariaRadioRole),e.setAttribute(vt.t.ariaCheckedAttribute,t),e.tabIndex=t?0:-1,t&&e.focus(),e.children[0].className="radioContainer"+(t?" selected":"")},t.prototype.UpdateHiddenControlValue=function(e){this._hiddenInputElement.value=SF[e]},t.prototype.RadioButtonHtml=function(e){return String.format('\r\n\t\t\t\t\t<div id="{0}" class="InsertFileTypeContainer">\r\n\t\t\t\t\t\t<div class="radioContainer">\r\n\t\t\t\t\t\t\t<div class="radioOuter">\r\n\t\t\t\t\t\t\t\t<div class="radioInner"></div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class="InsertFileTypeIconOuterContainer">\r\n\t\t\t\t\t\t\t<div class="InsertFileTypeIconInnerContainer"> \r\n\t\t\t\t\t\t\t\t<div class="clip48x48"> \r\n\t\t\t\t\t\t\t\t\t<img class="{1}" role="presentation" src="{2}"> \r\n\t\t\t\t\t\t\t\t</div> \r\n\t\t\t\t\t\t\t</div> \r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class="InsertFileTypeExplanationContainer">\r\n\t\t\t\t\t\t\t<span class="InsertFileTypeHeader">{3}</span>\r\n\t\t\t\t\t\t\t<br/>\r\n\t\t\t\t\t\t\t<span class="InsertFileTypeExplanation">{4}</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t',e.radioButtonDomElementId,e.imageCssClass,L.AFrameworkApplication.get_imageClusterPath(),e.headerText,e.explanationText)},t.hiddenInputElementId="selectedInsertType",t}(Bi.o);(0,o.l)(TF,"8f977fbc$EqualChoiceInsertFileTypeDialog",Bi.o,[]);var AF=n(3318),IF=n(6684),wF=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,OneNoteIntl.OneNoteStrings.L_InsertPrintoutPickerDialogBody,CommonUIStrings.l_FileUploadNoFileSpecified)},e.DialogHtmlFormat="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>",e}();(0,o.l)(wF,"cd152f32$InsertPrintoutDialogHtml",null,[]);var xF=function(e){function t(t,n,i,r,o,a,l){return void 0===l&&(l=null),e.call(this,t,n,i,r,o,a,l,gT.w.onosFilePrintoutBaseRoute)||this}return(0,v.t)(t,e),t}(gT.w);(0,o.l)(xF,"50432977$OneNotePrintoutUploadFrame",gT.w,[]);var EF=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,v.t)(t,e),t.prototype.get_titleText=function(){return OneNoteIntl.OneNoteStrings.L_InsertPrintoutPickerDialogHeader},t.prototype.get_dialogLayout=function(){return wF.get_dialogHtml()},t.prototype.setUpUploadFrame=function(e,t){return new xF(e,o.i(t,t.onUploadFrameInitialized,"onUploadFrameInitialized"),o.i(t,t.uploadResponseReceived,"uploadResponseReceived"),L.AFrameworkApplication.appSettingsManager,!0,null)},t}(IF.k);(0,o.l)(EF,"56ecb89a$InsertPrintoutDialog",IF.k,[]);var FF=function(e){function t(t,n,i,r,o,a){var l=this;return l._firstImagePlaceholderNode=null,l._containingOutlineNode=null,l._containingOutlineElementNode=null,l=e.call(this,t,n,i,r,o,a)||this}return(0,v.t)(t,e),t.prototype.get_uploadMode=function(){return"InsertPrintout"},t.prototype.get_narrationText=function(){return OneNoteIntl.OneNoteStrings.L_FileAttachmentUploadingText},t.prototype.showDialog=function(){if(uT.i.canOpenFilePickerDirectly()||this.nativeFileOpenDialogIsEnabled&&W.y.get_isWebKit())this.dialogMode=!1,this.uploadFrame=new xF(document.body,o.i(this,this.onUploadFrameInitialized,"onUploadFrameInitialized"),o.i(this,this.uploadResponseReceived,"uploadResponseReceived"),this.get_appSettingsManager(),!1,null);else{this.dialogMode=!0;var e=new EF(this,this._fileEditor);this.uploadFrame=e.uploadFrame}},t.prototype.validateFileExtension=function(e){return!!this.IsValidFileExtension(e)||(this._utils.showErrorDialog(OneNoteIntl.OneNoteStrings.L_InsertPrintoutUnsupportedDialogHeader,OneNoteIntl.OneNoteStrings.L_InsertPrintoutUnsupportedDialogBody),this.onUploadComplete(),!1)},t.prototype.IsValidFileExtension=function(e){var n=this._utils.extractExtensionFromFilename(e);return(n=n?Rn.l.toLower(n):null)===t.WordDocumentFileExtension||n===t.PDFDocumentFileExtension?(S.ULS.sendTraceTag(18483163,339,50,"{0}:SupportedExtension:{1}",this.get_uploadMode(),n),!0):(S.ULS.sendTraceTag(18483164,339,50,"{0}:UnsupportedExtension",this.get_uploadMode()),!1)},t.prototype.insertPlaceholder=function(e){this.desiredRevisionId=ai.l.create();var t=this._fileEditor.insertPlaceholders(this.get_context(),null,this.desiredRevisionId,e);return this.fileNode=t.fileNode,this._firstImagePlaceholderNode=t.imageNode,this._containingOutlineElementNode=t.imageContainingOutlineElementNode,this._containingOutlineNode=t.imageContainingOutlineNode,!!this.fileNode&&!!this._firstImagePlaceholderNode},t.prototype.createUploadParametersDictionary=function(){var t=e.prototype.createUploadParametersDictionary.call(this);return t[dp.h.isPrintout]="1",t[dp.h.printoutImageNodeId]=this._firstImagePlaceholderNode.get_id().toString(),t[dp.h.printoutImageContainingOutlineElementNodeId]=this._containingOutlineElementNode.get_id().toString(),t[dp.h.printoutImageContainingOutlineNodeId]=this._containingOutlineNode.get_id().toString(),t},t.prototype.cleanUpAfterFailedPlaceholderUpload=function(){dT.r.setUploading(this.fileNode,!1),dT.r.setUploading(this._firstImagePlaceholderNode,!1)},t.WordDocumentFileExtension="docx",t.PDFDocumentFileExtension="pdf",t}(AF.f);(0,o.l)(FF,"7c55b2e6$InsertPrintoutUploader",AF.f,[]);var PF=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,OneNoteIntl.OneNoteStrings.l_EmbeddedFileAltTextDialogLabel)},e.DialogHtmlFormat="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='titleText' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='500' autocomplete=\"off\"/> </div>",e}();(0,o.l)(PF,"d9642191$EmbeddedFileAltTextDialogHtml",null,[]);var DF=function(e){function t(t){var n=this;n._containingNode=null,(n=e.call(this)||this)._containingNode=t.get_node(),n.set_dialogHtml(PF.get_dialogHtml());var i={titleText:N_.EmbeddedFileReader.getEmbeddedFileAltText(n._containingNode)};n.initializeAndShow(CommonUIStrings.l_AlternativeTextDialogTitle,o.i(n,n.AltTextDialogHandler,"AltTextDialogHandler"),i);var r=document.getElementById("titleText");return r.focus(),r.select(),n}return(0,v.t)(t,e),t.prototype.AltTextDialogHandler=function(e,t){if(1===e){this.hide();var n=new Ma.GraphTransaction(15);n.setFromNode(this._containingNode),this.SetEmbeddedFileAltText(this._containingNode,t.titleText),n.dispose()}},t.prototype.SetEmbeddedFileAltText=function(e,t){e.get_properties().setValue(rs.o.imageTitle,t)},t}(Bi.o);(0,o.l)(DF,"1222f4cd$EmbeddedFileAltTextDialog",Bi.o,[]);var RF=function(){function e(e,t,n,i,r,o,a){this._clickInputManager=null,this._keyInputManager=null,this._actionManager=null,this._insertFileEditor=null,this._insertPrintoutEditor=null,this._utils=null,this._undoManager=null,this._clickInputManager=e,this._keyInputManager=t,this._actionManager=n,this._insertFileEditor=i,this._insertPrintoutEditor=r,this._utils=o,this._undoManager=a}return e.prototype.get_pageReader=function(){return $s.PageReader.get_instance()},e.prototype.registerActions=function(){this._actionManager.addActionWithFlags(nS.u.insertFileDialog,ol.d.view,o.i(this,this.InsertFileDialogView,"InsertFileDialogView"),4),this._actionManager.addActionWithFlags(nS.u.insertPrintoutDialog,ol.d.view,o.i(this,this.InsertPrintoutDialogView,"InsertPrintoutDialogView"),4),this._actionManager.addActionWithFlags(nS.u.insertLocalFile,ol.d.view,o.i(this,this.InsertFileDialogView,"InsertFileDialogView"),4),this._actionManager.addActionWithFlags(nS.u.editEmbeddedFileAltText,ol.d.embeddedFile,o.i(this,this.EditEmbeddedFileAltText,"EditEmbeddedFileAltText"),4)},e.prototype.InsertFileDialogView=function(e,t,n,i,r){var o=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInsertOneDriveFileIsEnabled"),a=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("OneNoteInsertOneDriveFileTreatmentMode"),l=this.CreateShowInsertFileDialogAction(e,t,o,a);return l?this.ShowInsertDialogView(n,t,"InsertFile",l):2},e.prototype.CreateShowInsertFileDialogAction=function(e,t,n,i){var r=this;if(e===nS.u.insertLocalFile||!n)return function(){new AF.f(t,Ce.y.get_instance(),L.AFrameworkApplication.appSettingsManager,r._utils,r._insertFileEditor,r._undoManager)};if("EqualChoice"===i){var a={};return a[TF.hiddenInputElementId]="",function(){new TF(r._clickInputManager,r._keyInputManager).initializeAndShow(OneNoteIntl.OneNoteStrings.L_ChooseFileTypeDialogTitle,o.i(r,r.OnFileTypeChosen,"OnFileTypeChosen"),a)}}return null},e.prototype.OnFileTypeChosen=function(e,t){if(1===e){var n=t[TF.hiddenInputElementId];"oneDrive"===n?(S.ULS.sendTraceTag(24261849,339,50,"Insert OneDrive file chosen"),this._actionManager.processAction(Oi.u.insertOneDriveFile,2)):"local"===n&&(S.ULS.sendTraceTag(24261850,339,50,"Insert local file chosen"),this._actionManager.processAction(nS.u.insertLocalFile,2))}},e.prototype.InsertPrintoutDialogView=function(e,t,n,i,r){var o=this;return this.ShowInsertDialogView(n,t,"InsertPrintout",(function(){new FF(t,Ce.y.get_instance(),L.AFrameworkApplication.appSettingsManager,o._utils,o._insertPrintoutEditor,o._undoManager)}))},e.prototype.ShowInsertDialogView=function(e,t,n,i){return 1===e?this._insertFileEditor.canInsertFileInContext(t)?32:2:2===e?(S.ULS.sendTraceTag(18483139,339,50,"{0}:Click",n),L.AFrameworkApplication.limitedEdit?L.AFrameworkApplication.showRequiresSignInDialog():i(),32):2},e.prototype.EditEmbeddedFileAltText=function(e,t,n,i,r){return 1===n?32:(this.showAltTextDialog(t),32)},e.prototype.showAltTextDialog=function(e){return new DF(e)},e}();(0,o.l)(RF,"f1df675a$EmbeddedFileActor",null,[]);var MF=function(){return function(){this.id=null,this.listId=null,this.listInfo=null,this.level=0}}();(0,o.l)(MF,"bd270f59$ListItemInfo",null,[]);var kF=function(e){function t(){return e.call(this)||this}return(0,v.t)(t,e),t.prototype.get_bulletStyle1=function(){return WoncaIntl.WoncaStrings.L_BulletStyle1},t.prototype.get_bulletStyle2=function(){return WoncaIntl.WoncaStrings.L_BulletStyle2},t.prototype.get_bulletStyle3=function(){return WoncaIntl.WoncaStrings.L_BulletStyle3},t.prototype.getListItemInfo=function(e,t){var n=new ha.g;n.setFrom(e),n.returnToParent();var i=n.get_currentNode().get_id();return(0,U.m)(new MF,{id:e.get_currentNode().get_id(),listId:i,listInfo:t,level:1})},t.prototype.tryCollapseNestedContent=function(e,t,n){var i=e.get_contentObject(),r=t.get_contentObject(),o=(0,U.m)(new MF,{id:r.id,listId:e.contentId,listInfo:r.listInfo,level:i.level+1});return n.val=new da,n.val.set_providerKey(this.get_key()),n.val.contentId=e.contentId,n.val.set_contentObject(o),!0},t}(RE);(0,o.l)(kF,"1640f551$HierarchicalListDetailsProvider",RE,[]);var NF=n(4767),LF=n(1262),BF=n(1111),OF=n(3261),UF=function(e){function t(t){return e.call(this,t)||this}return(0,v.t)(t,e),t.prototype.setUpUploadFrame=function(e,t){return new BF.w(e,o.i(t,t.onUploadFrameInitialized,"onUploadFrameInitialized"),o.i(t,t.uploadResponseReceived,"uploadResponseReceived"),L.AFrameworkApplication.appSettingsManager,!0)},t}(OF.d);(0,o.l)(UF,"7e81f66e$OneNoteInsertImageDialog",OF.d,[]);var HF=function(e){function t(t,n,i,r,o,a){return e.call(this,t,n,i,r,o,a)||this}return(0,v.t)(t,e),t.prototype.showDialog=function(){if(uT.i.canOpenFilePickerDirectly()||this.nativeFileOpenDialogIsEnabled&&W.y.get_isWebKit())this.dialogMode=!1,this.uploadFrame=new BF.w(document.body,o.i(this,this.onUploadFrameInitialized,"onUploadFrameInitialized"),o.i(this,this.uploadResponseReceived,"uploadResponseReceived"),this.get_appSettingsManager(),!1);else{this.dialogMode=!0;var e=new UF(this);this.uploadFrame=e.uploadFrame}},t.prototype.submitForm=function(t){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteContentSyncUploadAttachmentIsEnabled")&&Ti.App.get_instance().get_isContentSyncEnabled()?t.submitFormWithRequest():e.prototype.submitForm.call(this,t)},t}(Oy.e);(0,o.l)(HF,"106fca85$OneNoteImageUploader",Oy.e,[]);var GF=function(e){function t(t,n,i,r,o){return e.call(this,t,n,i,r,o)||this}return(0,v.t)(t,e),t.prototype.arePictureActionsEnabled=function(t){return Vf.q.isIFrameContext(t)||Vf.q.isFloatingIFrameContext(t)?(DE.get_activityManager().recordEvent(NF.f.noApply,{Reason:LF.i.containsIFrame}),!1):e.prototype.arePictureActionsEnabled.call(this,t)},t.prototype.createPictureUploader=function(e,t){return new HF(e,Ce.y.get_instance(),L.AFrameworkApplication.appSettingsManager,t,this.get_undoManager(),this.get_actionManager())},t}(DE);(0,o.l)(GF,"a3af7355$ImageActor",DE,[]);var WF=function(){function e(){}return e.prototype.getCurrentPageUrl=function(){var e=sI.get_pageClicked();return Ti.App.buildPageUrl(e)},e.prototype.getWebAppLink=function(e){return Ti.App.buildPageUrl(e)},e.prototype.getNativeAppLink=function(e){return Ti.App.buildClientUrl(e)},e}();(0,o.l)(WF,"af32ec34$Application",null,[uE]);var VF=function(){function e(){}return e.prototype.copyToClipboard=function(e){var t=document.createElement("textarea");t.innerText=e,document.body.appendChild(t),t.select();var n=window.document.execCommand("copy");return document.body.removeChild(t),n},e.prototype.copyHyperlinkToClipboard=function(e,t,n){var i=document.createElement("textarea"),r=OneNoteIntl.OneNoteStrings.L_HyperlinkWebViewText,o=String.format('<a href="{0}">{1}</a>&nbsp; (<a href="{2}&{3}">{4}</a>)',t,n,e,_S.u.oneNotePreserveLink,r);return i.innerText=o,wo.n.addHandler(i,me.d.copy,(function(t){var n=t.rawEvent;n.clipboardData?(n.clipboardData.setData("text/html",o),n.clipboardData.setData("text/plain",e)):window.clipboardData.setData("Text",e),n.preventDefault(),document.body.removeChild(i)})),document.body.appendChild(i),i.select(),window.document.execCommand("copy")},e}();(0,o.l)(VF,"406c3c62$Browser",null,[cE]);var $F=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,Box4Intl.Box4Strings.l_GetPageUrlTextPrompt)},e.DialogHtmlFormat="<div class='WACDialogRow' id='block1'> <label id='prompt' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <div id='PageUrl' class='GetPageUrlDialog'></div> </div>",e}();(0,o.l)($F,"e6840795$GetPageUrlDialogHtml",null,[]);var zF=function(e){function t(t){var n=this;return n._anchorPageUrl=null,n._pageUrl=null,n._pageUrlIFrame=null,(n=e.call(this)||this)._pageUrl=t,n}return(0,v.t)(t,e),t.prototype.onInnerHtmlSet=function(){this._pageUrlIFrame=document.createElement("iframe"),this._pageUrlIFrame.className="ObjectInDialog CopyLinkToPageDialog",wo.n.addHandler(this._pageUrlIFrame,"load",o.i(this,this.onUrlFrameLoad,"onUrlFrameLoad")),document.getElementById("PageUrl").appendChild(this._pageUrlIFrame)},t.prototype.onUrlFrameLoad=function(e){L.AFrameworkApplication.get_isRtl()&&this._pageUrlIFrame.contentWindow.document.body.setAttribute("dir","rtl");var t=this._pageUrlIFrame.contentWindow.document.createElement("span");t.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName,t.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize,ji.s.setElementText(t,this._pageUrl),this._anchorPageUrl=this._pageUrlIFrame.contentWindow.document.createElement("a"),this._anchorPageUrl.href=this._pageUrl,this._anchorPageUrl.style.cursor="default",this._anchorPageUrl.style.textDecoration="none",this._anchorPageUrl.style.color="#3B3B3B",this._anchorPageUrl.tabIndex=-1,this._anchorPageUrl.appendChild(t),wo.n.addHandler(this._anchorPageUrl,"click",o.i(this,this.LinkClickHandler,"LinkClickHandler"));var n=this._pageUrlIFrame.contentWindow.document.createElement("div");n.style.wordWrap="break-word",n.style.wordBreak="break-all",n.appendChild(this._anchorPageUrl),this._pageUrlIFrame.contentWindow.document.body.appendChild(n),yi.App.get_activeAppFrame().get_theKeyInputManager().initializeForElement(this._pageUrlIFrame.contentWindow.document.body),W.y.get_isInternetExplorerNonEdge()?(wo.n.addHandler(this._pageUrlIFrame,"focus",o.i(this,this.OnUrlFrameFocus,"OnUrlFrameFocus")),wo.n.addHandler(this._pageUrlIFrame,"beforedeactivate",o.i(this,this.OnUrlFrameLostFocus,"OnUrlFrameLostFocus"))):(wo.n.addHandler(this._pageUrlIFrame.contentWindow,"focus",o.i(this,this.OnUrlFrameFocus,"OnUrlFrameFocus")),wo.n.addHandler(this._pageUrlIFrame.contentWindow,"blur",o.i(this,this.OnUrlFrameLostFocus,"OnUrlFrameLostFocus")))},t.prototype.OnUrlFrameLostFocus=function(e){if(this._pageUrlIFrame.contentWindow)if(W.y.get_supportsDomL2Selection()){var t=this._pageUrlIFrame.contentWindow.getSelection();t&&t.removeAllRanges()}else this._pageUrlIFrame.contentWindow.document.execCommand("Unselect",!1,null)},t.prototype.OnUrlFrameFocus=function(e){if(this._pageUrlIFrame.contentWindow)if(W.y.get_supportsDomL2Selection()){var t=this._pageUrlIFrame.contentWindow.getSelection();t&&(t.removeAllRanges(),t.selectAllChildren(this._pageUrlIFrame.contentWindow.document.body))}else this._pageUrlIFrame.contentWindow.document.execCommand("SelectAll",!1,null)},t.prototype.LinkClickHandler=function(e){e.preventDefault(),e.stopPropagation()},t.prototype.GetPageUrlDialogHandler=function(e,t){this.hide()},t.prototype.detachDialogEvents=function(){wo.n.removeHandler(this._anchorPageUrl,"click",o.i(this,this.LinkClickHandler,"LinkClickHandler")),this._pageUrlIFrame&&(wo.n.removeHandler(this._pageUrlIFrame,"load",o.i(this,this.onUrlFrameLoad,"onUrlFrameLoad")),W.y.get_isInternetExplorerNonEdge()?(wo.n.removeHandler(this._pageUrlIFrame,"focus",o.i(this,this.OnUrlFrameFocus,"OnUrlFrameFocus")),wo.n.removeHandler(this._pageUrlIFrame,"beforedeactivate",o.i(this,this.OnUrlFrameLostFocus,"OnUrlFrameLostFocus"))):(wo.n.removeHandler(this._pageUrlIFrame.contentWindow,"focus",o.i(this,this.OnUrlFrameFocus,"OnUrlFrameFocus")),wo.n.removeHandler(this._pageUrlIFrame.contentWindow,"blur",o.i(this,this.OnUrlFrameLostFocus,"OnUrlFrameLostFocus"))),this._pageUrlIFrame.contentWindow&&this._pageUrlIFrame.contentWindow.document&&this._pageUrlIFrame.contentWindow.document.body&&yi.App.get_activeAppFrame().get_theKeyInputManager().deinitializeForElement(this._pageUrlIFrame.contentWindow.document.body)),e.prototype.detachDialogEvents.call(this)},t.prototype.display=function(){this.set_dialogHtml($F.get_dialogHtml()),this.set_buttonsOption(0),this.setButtonText(1,Box4Intl.Box4Strings.l_GetPageUrlCloseButton),this.showDialog(Box4Intl.Box4Strings.l_GetPageUrlTitle,o.i(this,this.GetPageUrlDialogHandler,"GetPageUrlDialogHandler")),this.setFocusOnElement(this._pageUrlIFrame)},t.get_PageReader=function(){return $s.PageReader.get_instance()},t}(Bi.o);(0,o.l)(zF,"fc31c82f$GetPageUrlDialog",Bi.o,[]);var KF=function(){function e(){}return e.prototype.displayPageUrlDialog=function(e){new zF(e).display()},e}();(0,o.l)(KF,"d221865b$DialogService",null,[dE]);var qF=n(1718),jF=n(8157),QF=function(){function e(e,t,n){this.color=0,this.labelText=null,this.image32by32Class=null,this.color=e,this.labelText=t,this.image32by32Class=Ct.ImageClusteringHelper.getImageClass("InkColorCircle_"+n+"_32x32x32")}return e.prototype.get_color=function(){return this.color},e.prototype.get_labelText=function(){return this.labelText},e.prototype.get_image32by32Class=function(){return this.image32by32Class},e.getShorthandInkColorInformation=function(t){return 3===tb.u.getModeForInkShorthandColor()?e._shorthandColorsForHighlighter[t]:e._shorthandColorsForPen[t]},e._shorthandColorsForPen=[new e(4210752,OneNoteIntl.OneNoteStrings.L_InkColor_Black,"Black"),new e(1266618,OneNoteIntl.OneNoteStrings.L_InkColor_Blue,"Blue"),new e(1473821,OneNoteIntl.OneNoteStrings.L_InkColor_DarkGreen,"Green"),new e(12986680,OneNoteIntl.OneNoteStrings.L_InkColor_Red,"Red")],e._shorthandColorsForHighlighter=[new e(16446240,OneNoteIntl.OneNoteStrings.L_InkColor_Yellow,"Yellow"),new e(16741286,OneNoteIntl.OneNoteStrings.L_InkColor_Pink,"Pink"),new e(4045055,OneNoteIntl.OneNoteStrings.L_InkColor_SkyBlue,"LightBlue"),new e(8847190,OneNoteIntl.OneNoteStrings.L_InkColor_LightGreen,"Lime")],e}();(0,o.l)(QF,"ea47a483$ShorthandColorInformation",null,[]);var JF=function(){function e(){}return e.GetInkThicknessDropDownXml=function(){return e.get_InkThicknessUIBuilder().buildInkThicknessXml()},e.GetInkThicknessDropDownMenuProps=function(){return e.get_InkThicknessUIBuilder().buildInkThicknessProps()},e.get_InkThicknessUIBuilder=function(){return Ge.w.get_instance().resolve(GS)},e.RegisterActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addActionWithFlags(nS.u.queryInkThickness,ol.d.application,e.queryInkThickness,96),t.addActionWithFlags(nS.u.queryInkThicknessPosition,ol.d.view,e.QueryInkThicknessPositionHandler,96),t.addActionWithFlags(nS.u.populateInkThicknessDropDown,ol.d.view,e.populateInkThicknessDropDown,100),t.addActionWithFlags(nS.u.inkThicknessDropDownOpen,ol.d.view,e.InkThicknessDropDownOpenHandler,68),t.addAction(nS.u.changeInkThickness,ol.d.view,e.ChangeInkThicknessHandler)},e.InkThicknessDropDownOpenHandler=function(e,t,n,i,r){return 32},e.queryInkThickness=function(e,t,n,i,r){return 32},e.QueryInkThicknessPositionHandler=function(t,n,i,r,o){if(1===i)return 32;var a=o,l=e.getIndexFromActionData(a),s=tb.u.getCurrentInkThicknessIndex();return a[to.u.On]=l===s,32},e.populateInkThicknessDropDown=function(t,n,i,r,o){if(1===i)return 32;var a=o;return L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()?a.MenuItems=e.GetInkThicknessDropDownMenuProps():a.PopulationXML=e.GetInkThicknessDropDownXml(),32},e.ChangeInkThicknessHandler=function(t,n,i,r,o){if(1===i)return 32;if(2!==i)return 2;var a=(0,y.e)(Object,o);if(!a)return S.ULS.sendTraceTag(17897472,339,10,"ChangeInkThicknessHandler actionData was not a dictionary"),2;var l=e.getIndexFromActionData(a);return S.ULS.sendTraceTag(17897473,339,50,"Changing ink thickness index to {0}",l),e.SwitchToInkThickness(l,n,i),32},e.SwitchToInkThickness=function(e,t,n){if(4===Ti.App.oneNoteInputMode||!Ti.App.oneNoteInputMode||1===Ti.App.oneNoteInputMode){var i=tb.u.getModeForInkShorthandColor();qF.o.handleEnterMode(t,n,i)}tb.u.setCurrentInkThicknessIndex(e),qF.o.updateCurrentDrawingAttributesInCanvas()},e.getIndexFromActionData=function(e){var t=e.SourceControlId;if(!t||""===t)return S.ULS.sendTraceTag(17897474,339,10,"GetInkThicknessIndexFromActionData actionData dictionary contained empty or null controlId"),Number.NaN;var n=t.split("_");return parseInt(n[1])},e}();(0,o.l)(JF,"8c398488$InkThicknessActor",null,[]);var XF=function(){function e(){}return e.RegisterActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addActionWithFlags(nS.u.changeToInkShorthandColor,ol.d.view,e.ChangeToInkShorthandColor,4),t.addActionWithFlags(nS.u.queryInkShorthandColor,ol.d.view,e.QueryInkShorthandColor,96),t.addAction(nS.u.changeInkColor,ol.d.view,e.ChangeInkColorHandler)},e.ChangeToInkShorthandColor=function(t,n,i,r,o){return e.HandleChangeToInkShorthand(i,n,o)},e.QueryInkShorthandColor=function(t,n,i,r,o){return e.HandleQueryInkShorthandColor(i,o)},e.HandleChangeToInkShorthand=function(t,n,i){if(1===t)return 32;var r=i,o=JF.getIndexFromActionData(r),a=QF.getShorthandInkColorInformation(o);return e.SwitchToInkColor(a.get_color(),n,t),S.ULS.sendTraceTag(17897440,339,50,"Switching to shorthand color: {0} in input mode {1}",o,Ti.App.oneNoteInputMode),32},e.HandleQueryInkShorthandColor=function(e,t){if(1===e)return 32;var n=t,i=JF.getIndexFromActionData(n),r=QF.getShorthandInkColorInformation(i);n[gr.e.Image32by32Class]=r.get_image32by32Class(),n[gr.e.LabelText]=r.get_labelText(),n[mr.b.iconColor]="#"+jF.h.convertFromIntToHex(r.get_color());var o=tb.u.getCurrentInkColor()===r.get_color()&&(2===Ti.App.oneNoteInputMode||3===Ti.App.oneNoteInputMode);return n[gr.e.On]=o,32},e.ChangeInkColorHandler=function(t,n,i,r,o){if(1===i)return 32;if(2!==i)return 2;var a=(0,y.e)(Object,o);if(!(a&&"Color"in a))return S.ULS.sendTraceTag(17897441,339,10,"ChangeInkColorHandler actionData was not a dictionary or did not contain Color"),2;var l=a.Color;if(!l||""===l)return S.ULS.sendTraceTag(17897442,339,10,"ChangeInkColorHandler actionData dictionary contained empty or null color"),2;S.ULS.sendTraceTag(17897443,339,50,"Changing ink color to {0} via color selector",l);var s=jF.h.convertFromHexToInt(l);return e.SwitchToInkColor(s,n,i),32},e.SwitchToInkColor=function(e,t,n){if(4===Ti.App.oneNoteInputMode||!Ti.App.oneNoteInputMode||1===Ti.App.oneNoteInputMode){var i=tb.u.getModeForInkShorthandColor();qF.o.handleEnterMode(t,n,i)}tb.u.setCurrentInkColor(e),qF.o.updateCurrentDrawingAttributesInCanvas()},e}();(0,o.l)(XF,"a76ed943$InkColorActor",null,[]);var YF=function(){function e(){}return e.prototype.clickedPage=function(e){return sI.get_pageClicked()},e.prototype.clickedSection=function(e){return sI.sectionClicked},e.prototype.getColorFromActionData=function(e){return e},e}();(0,o.l)(YF,"1de345b1$LegacyContextMenuDataProvider",null,[iE]);var ZF=function(){function e(){}return e.RegisterActions=function(t){t.addAction(Oi.u.readingFrameMode,Ue.m.frame,e.OneNoteModeHandler),t.addAction(Oi.u.editFrameMode,Ue.m.frame,e.OneNoteModeHandler)},e.OneNoteModeHandler=function(e,t,n,i,r){if(1!==n)return 2;if(t.get_contextId()!==Ue.m.frame)return 2;var o=t.frame;if(!o)return 16;switch(e){case Oi.u.readingFrameMode:return 1===o.get_mode()?32:8;case Oi.u.editFrameMode:return 2===o.get_mode()?32:8;default:return 2}},e}();(0,o.l)(ZF,"e330d811$ModeActor",null,[]);var eP=function(){function e(){}return e.RegisterActions=function(t){t.addAction(Oi.u.readingMode,Ue.m.frame,e.OneNoteModeSwitchHandler),t.addAction(Oi.u.switchToEditMode,Ue.m.frame,e.OneNoteModeSwitchHandler),t.addActionWithFlags(nS.u.oneNoteGetDocumentViewMode,Ue.m.frame,e.OreoGetDocumentViewModeHandler,64)},e.OneNoteModeSwitchHandler=function(t,n,i,r,o){if(n.get_contextId()!==Ue.m.frame)return 2;S.ULS.sendTraceTag(41263305,339,50,"OneNoteModeSwitchHandler mode {0}",t);var a=n.frame;switch(t){case Oi.u.readingMode:return 1===i?yi.App.get_activeAppFrame().workspace.isViewModeEnabled?32:8:a&&1===a.get_mode()?8:(L.AFrameworkApplication.get_theActionManager().processAction(nS.u.exitInkingOrEraserMode,2),a.switchToMode(1),e.NotifyOreoOnSwitchMode(a.get_modeName()),a.updateCommandUI(),L.AFrameworkApplication.get_activeFrame().animateDocumentPanel(!0,!0),32);case Oi.u.switchToEditMode:var l=yi.App.get_activeAppFrame().workspace.get_canSwitchToEditMode();return 1===i?l?32:8:!l||a&&2===a.get_mode()?8:(a.switchToMode(2),e.NotifyOreoOnSwitchMode(a.get_modeName()),a.updateCommandUI(),yi.App.get_box4Bridge().get_commandUi().isRibbonMinimized((function(e){e||L.AFrameworkApplication.get_activeFrame().animateDocumentPanel(!1,!0)})),32);default:return 2}},e.OreoGetDocumentViewModeHandler=function(t,n,i,r,o){if(n.get_contextId()!==Ue.m.frame)return 2;var a=n.frame;return e.NotifyOreoOnSwitchMode(a.get_modeName()),32},e.NotifyOreoOnSwitchMode=function(e){var t={};t.mode=e,L.AFrameworkApplication.get_theActionManager().processActionWithData(nS.u.oneNoteOnSwitchMode,2,t)},e}();(0,o.l)(eP,"a5a04d03$ModeSwitchActor",null,[]);var tP=n(8399),nP=function(){function e(){}return e.get_DialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,Box4Intl.Box4Strings.l_EnterSectionName,Box4Intl.Box4Strings.l_BlankSectionNameAlert,Box4Intl.Box4Strings.l_SectionNameTooLongAlert,Box4Intl.Box4Strings.l_SectionNameInUseAlert,Box4Intl.Box4Strings.l_SectionNameInvalidCharactersAlert,Box4Intl.Box4Strings.l_ConsecutivePeriodsAlert,Box4Intl.Box4Strings.l_LeadingPeriodAlert,Box4Intl.Box4Strings.l_TrailingPeriodAlert,Box4Intl.Box4Strings.l_InvalidFileNameAlert)},e.DialogHtmlFormat="<div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtSectionName' >{0}</label> <input type='text' id='txtSectionName' class='WACDialogInput' autocomplete=\"off\"/> <div class='WACDialogError' id='blankSectionError' role='alert'>{1}</div> <div class='WACDialogError' id='nameTooLongError' role='alert'>{2}</div> <div class='WACDialogError' id='nameInUseError' role='alert'>{3}</div> <div class='WACDialogError' id='invalidCharactersError' role='alert'>{4}</div> <div class='WACDialogError' id='consecutivePeriodsError' role='alert'>{5}</div> <div class='WACDialogError' id='leadingPeriodError' role='alert'>{6}</div> <div class='WACDialogError' id='trailingPeriodError' role='alert'>{7}</div> <div class='WACDialogError' id='invalidFileNameError' role='alert'>{8}</div> </div>",e}();(0,o.l)(nP,"78b331cf$SectionNameEditDialogHtml",null,[]);var iP=n(1982),rP=function(e){function t(n,i,r,a){var l=this;l._folderContentEditor=null,l._folderEditor=null,l._sectionEditor=null,l._sectionName="",l._creatingNewSection=!1,l._insertAfter=null,l._insertIn=null,l._textEntryBox=null,(l=e.call(this)||this)._sectionName=n,l._creatingNewSection=a,l._insertAfter=i,l._insertIn=r,t._invalidFileNames||l.CreateInvalidFileNameList(),l.set_dialogHtml(nP.get_DialogHtml());var s={txtSectionName:n};return St.FocusManager.instance().get_currentScope()&&St.FocusManager.instance().get_currentScope().name===Yc.u.fishbowlFocusId&&l.set_dismissFocusScope(St.FocusManager.instance().get_currentScope().name),a?l.initializeAndShow(Box4Intl.Box4Strings.l_NameSectionTitle,o.i(l,l.SectionNameDialogHandler,"SectionNameDialogHandler"),s):l.initializeAndShow(Box4Intl.Box4Strings.l_RenameSectionTitle,o.i(l,l.SectionNameDialogHandler,"SectionNameDialogHandler"),s),l._textEntryBox=document.getElementById("txtSectionName"),l._textEntryBox&&(l._keyInputManager.registerHandler(me.d.keyPress,l._textEntryBox,o.i(l,l.OnKeyEvent,"OnKeyEvent")),l._keyInputManager.registerHandler(me.d.keyUp,l._textEntryBox,o.i(l,l.OnKeyEvent,"OnKeyEvent")),l.setFocusOnElement(l._textEntryBox),l._textEntryBox.setAttribute("spellcheck","false")),l}return(0,v.t)(t,e),t.prototype.get_FolderEditor=function(){return this._folderEditor||(this._folderEditor=Ge.w.get_instance().resolve(Hb.x))},t.prototype.get_FolderContentEditor=function(){return this._folderContentEditor||(this._folderContentEditor=Ge.w.get_instance().resolve(Gb.s))},t.prototype.get_SectionEditor=function(){return this._sectionEditor||(this._sectionEditor=Ge.w.get_instance().resolve(db.f))},t.prototype.get_newName=function(){return this._sectionName},t.prototype.OnKeyEvent=function(e){return e.innerEvent.keyCode===Re.v.vK_Enter&&(this._textEntryBox.value.length>0&&this.executeDismissButton(this.getButtonElement(1)),!0)},t.prototype.CreateInvalidFileNameList=function(){t._invalidFileNames=[],Array.add(t._invalidFileNames,"CON"),Array.add(t._invalidFileNames,"PRN"),Array.add(t._invalidFileNames,"AUX"),Array.add(t._invalidFileNames,"NUL"),Array.add(t._invalidFileNames,"COM"),Array.add(t._invalidFileNames,"COM1"),Array.add(t._invalidFileNames,"COM2"),Array.add(t._invalidFileNames,"COM3"),Array.add(t._invalidFileNames,"COM4"),Array.add(t._invalidFileNames,"COM5"),Array.add(t._invalidFileNames,"COM6"),Array.add(t._invalidFileNames,"COM7"),Array.add(t._invalidFileNames,"COM8"),Array.add(t._invalidFileNames,"COM9"),Array.add(t._invalidFileNames,"LPT"),Array.add(t._invalidFileNames,"LPT1"),Array.add(t._invalidFileNames,"LPT2"),Array.add(t._invalidFileNames,"LPT3"),Array.add(t._invalidFileNames,"LPT4"),Array.add(t._invalidFileNames,"LPT5"),Array.add(t._invalidFileNames,"LPT6"),Array.add(t._invalidFileNames,"LPT7"),Array.add(t._invalidFileNames,"LPT8"),Array.add(t._invalidFileNames,"LPT9")},t.prototype.SectionNameDialogHandler=function(e,t){if(0!==e)if(this._sectionName=t.txtSectionName.trim(),this._creatingNewSection){if(!this._sectionName)return;var n=ha.g.createFromNode(this._insertIn);this.get_FolderContentEditor().createSectionAfter(n,this._insertAfter,this._sectionName),iP.u.dispatchActionToOreoWithData(nS.u.oneNoteNewSectionCreated,t)}else{if(!this._sectionName)return;var i=new Ma.GraphTransaction(7);i.setFromNode(this._insertAfter),this.get_SectionEditor().setTitleForRenameSection(this._insertAfter,this._sectionName),this.get_SectionEditor().setFileIdForSection(this._insertAfter),this._insertAfter.get_anchor().invalidateViewChannelForAllViews(4),i.dispose()}},t.prototype.validate=function(){var e=document.getElementById("txtSectionName");document.getElementById("blankSectionError").style.display="none",document.getElementById("nameTooLongError").style.display="none",document.getElementById("nameInUseError").style.display="none",document.getElementById("invalidCharactersError").style.display="none",document.getElementById("leadingPeriodError").style.display="none",document.getElementById("trailingPeriodError").style.display="none",document.getElementById("consecutivePeriodsError").style.display="none",document.getElementById("invalidFileNameError").style.display="none";var n=e.value.trim(),i=null;if(n&&""!==n){if(n.startsWith("."))i=document.getElementById("leadingPeriodError");else if(n.endsWith("."))i=document.getElementById("trailingPeriodError");else if(n.indexOf("..")>=0)i=document.getElementById("consecutivePeriodsError");else if(n.length>50)i=document.getElementById("nameTooLongError");else if(this.get_FolderEditor().sectionNameInUse(n,this._insertIn)&&this._sectionName.toLowerCase()!==n.toLowerCase())i=document.getElementById("nameInUseError");else if(t._invalidFileNames&&Array.contains(t._invalidFileNames,n.toUpperCase()))i=document.getElementById("invalidFileNameError");else for(var r=0;r<t._invalidSectionNameChars.length;++r)if(n.indexOf(t._invalidSectionNameChars.charAt(r))>=0){i=document.getElementById("invalidCharactersError");break}}else i=document.getElementById("blankSectionError");return!i||(i.style.display="inline-block",!1)},t.prototype.close=function(){this.hide()},t.prototype.hide=function(){e.prototype.hide.call(this),L.AFrameworkApplication.get_theActionManager().processActionAsync(null,nS.u.dialogHidden,2,null,null)},t.prototype.dispose=function(){this._textEntryBox&&(this._keyInputManager.unregisterHandler(me.d.keyPress,this._textEntryBox,o.i(this,this.OnKeyEvent,"OnKeyEvent")),this._keyInputManager.unregisterHandler(me.d.keyUp,this._textEntryBox,o.i(this,this.OnKeyEvent,"OnKeyEvent")),this._textEntryBox=null),e.prototype.dispose.call(this)},t.show=function(e,n,i){var r="";i||(r=lb.j.getTitle(e)),t.AddDialogHiddenAction(),new t(r,e,n,i)},t.AddDialogHiddenAction=function(){t._isDialogHiddenActionAdded||(L.AFrameworkApplication.get_theActionManager().addAction(nS.u.dialogHidden,ol.d.view,Le.ActionManager.doNothingButReportHandler),t._isDialogHiddenActionAdded=!0)},t._invalidSectionNameChars='~#%&*{}|\\/:"<>?^',t._invalidFileNames=null,t._isDialogHiddenActionAdded=!1,t}(Bi.o);(0,o.l)(rP,"582de1d3$SectionNameEditDialog",Bi.o,[]);var oP=function(){function e(){}return e.get_PageEditor=function(){return e._pageEditor||(e._pageEditor=Ge.w.get_instance().resolve(Kb.f))},e.get_PageNavigator=function(){return Ii.PageNavigator.get_instance()},e.get_PageReader=function(){return $s.PageReader.get_instance()},e.get_SectionContentEditor=function(){return e._sectionContentEditor||(e._sectionContentEditor=Ge.w.get_instance().resolve($b.x))},e.get_FolderContentEditor=function(){return e._folderContentEditor||(e._folderContentEditor=Ge.w.get_instance().resolve(Gb.s))},e.get_FolderEditor=function(){return e._folderEditor||(e._folderEditor=Ge.w.get_instance().resolve(Hb.x))},e.get_SectionNavPaneContextMenu=function(){return e._sectionNavPaneContextMenu||(e._sectionNavPaneContextMenu=Ge.w.get_instance().tryResolve(JA.c))},e.get_PageNavPaneContextMenu=function(){return e._pageNavPaneContextMenu||(e._pageNavPaneContextMenu=Ge.w.get_instance().tryResolve(QA.w))},e.get_SectionEditor=function(){return e._sectionEditor||(e._sectionEditor=Ge.w.get_instance().resolve(db.f))},e.get_ContextMenuDataProvider=function(){return e._contextMenuDataProvider||(e._contextMenuDataProvider=Ge.w.get_instance().resolve(iE))},e.RegisterActions=function(){if(Gl.n.get_instance().get_item(18)){var t=L.AFrameworkApplication.get_theActionManager(),n=e.SwitchPage,i=e.MovePage,r=e.MoveSection,o=e.FocusedSectionExpand,a=e.FocusedSectionCollapse,l=e.FocusedItemDelete,s=e.FocusedSectionRename,u=e.FocusedItemNextSection,c=e.FocusedItemPreviousSection,d=e.FocusedPageIncreaseIndent,g=e.FocusedPageDecreaseIndent,p=e.ShiftF10NavPane;t.addAction(Oi.u.newPage,ol.d.view,e.NewPage),t.addAction(Oi.u.createNewPage,ol.d.section,e.NewPageProtoButton),t.addAction(nS.u.onboardingNewPage,ol.d.view,e.NewPage),t.addAction(Oi.u.newSection,ol.d.view,e.NewSection),t.addAction(nS.u.onboardingNewSection,ol.d.view,e.NewSection),t.addAction(Oi.u.switchPage,ol.d.application,Le.ActionManager.doNothingHandler),t.addActionWithFlags(Oi.u.ctrlPageUp,Ue.m.frame,n,64),t.addActionWithFlags(Oi.u.ctrlShiftPageUp,Ue.m.frame,n,64),t.addActionWithFlags(Oi.u.ctrlPageDown,Ue.m.frame,n,64),t.addActionWithFlags(Oi.u.ctrlShiftPageDown,Ue.m.frame,n,64),t.addActionWithFlags(Oi.u.altPageDown,ol.d.view,n,64),t.addActionWithFlags(Oi.u.altPageUp,ol.d.view,n,64),t.addActionWithFlags(Oi.u.altShiftHome,ol.d.view,n,64),t.addActionWithFlags(Oi.u.altShiftEnd,ol.d.view,n,64),t.addActionWithFlags(Oi.u.altShiftUpArrow,ol.d.view,i,68),t.addActionWithFlags(Oi.u.altShiftDownArrow,ol.d.view,i,68),t.addActionWithFlags(Oi.u.ctrlAltShiftUpArrow,ol.d.view,r,68),t.addActionWithFlags(Oi.u.ctrlAltShiftDownArrow,ol.d.view,r,68),t.addAction(Oi.u.focusedSectionExpand,Ue.m.frame,o),t.addAction(Oi.u.focusedSectionCollapse,Ue.m.frame,a),t.addActionWithFlags(Oi.u.focusedItemDelete,Ue.m.frame,l,4),t.addActionWithFlags(Oi.u.focusedSectionRename,Ue.m.frame,s,4),t.addAction(Oi.u.focusedItemNextSection,Ue.m.frame,u),t.addAction(Oi.u.focusedItemPreviousSection,Ue.m.frame,c),t.addActionWithFlags(Oi.u.focusedPageIncreaseIndent,Ue.m.frame,d,4),t.addActionWithFlags(Oi.u.focusedPageDecreaseIndent,Ue.m.frame,g,4),t.addAction(Oi.u.shiftF10NavPane,Ue.m.frame,p),t.addAction(Oi.u.createNewPage,ol.d.view,yi.App.get_activeAppFrame().workspace.currentSectionActorHandler),t.addAction(Oi.u.sectionExpand,ol.d.application,Le.ActionManager.doNothingButReportHandler),t.addAction(Oi.u.sectionCollapse,ol.d.application,Le.ActionManager.doNothingButReportHandler),t.addAction(nS.u.oneNoteRefreshPageContent,ol.d.view,e.RefreshPageContent),Ti.App.get_isEmbedMessageEnabled()&&(e._embedMessageSender=new $C(L.AFrameworkApplication.appSettingsManager.get_appSettings().OneNoteEmbedHostingApp,L.AFrameworkApplication.hostPostmessenger))}},e.RegisterShortcuts=function(){var t=St.FocusManager.instance(),n=t.getScope(Yc.u.editingFocusID),i=t.getScope(Pe.AFrame.mainAppFocusId),r=t.getScope(Yc.u.navigationFocusId);e.RegisterMainShortcuts(i),e.RegisterEditingShortcuts(n),e.SectionNavPaneFocusId=Yc.u.navigationFocusId,e.PageNavPaneFocusId=Yc.u.navigationFocusId,e.RegisterNavigationShortcuts(r)},e.RegisterMainShortcuts=function(e){Gl.n.get_instance().get_item(21)&&(e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_Home,5),Oi.u.altShiftHome),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_End,5),Oi.u.altShiftEnd),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_PageUp,1),Oi.u.altPageUp),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_PageDown,1),Oi.u.altPageDown),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_PageUp,Me.KeyInputManager.get_commandKeyModifier()),Oi.u.ctrlPageUp),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_PageUp,4|Me.KeyInputManager.get_commandKeyModifier()),Oi.u.ctrlShiftPageUp),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_PageDown,Me.KeyInputManager.get_commandKeyModifier()),Oi.u.ctrlPageDown),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_PageDown,4|Me.KeyInputManager.get_commandKeyModifier()),Oi.u.ctrlShiftPageDown),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_UpArrow,5),Oi.u.altShiftUpArrow),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_DownArrow,5),Oi.u.altShiftDownArrow))},e.RegisterEditingShortcuts=function(e){e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_UpArrow,5|Me.KeyInputManager.get_commandKeyModifier()),Oi.u.ctrlAltShiftUpArrow),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_DownArrow,5|Me.KeyInputManager.get_commandKeyModifier()),Oi.u.ctrlAltShiftDownArrow)},e.RegisterNavigationShortcuts=function(e){e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_F10,4),Oi.u.shiftF10NavPane),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_F10,4|Me.KeyInputManager.get_commandKeyModifier()),Oi.u.shiftF10NavPane),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_RightArrow,0),Oi.u.focusedSectionExpand),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_LeftArrow,0),Oi.u.focusedSectionCollapse),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_Backspace,0),Fe.b.doNothingInEdit),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_Delete,0),Oi.u.focusedItemDelete),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_R,Me.KeyInputManager.get_commandKeyModifier()),Oi.u.focusedSectionRename),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_Tab,Me.KeyInputManager.get_commandKeyModifier()),Oi.u.focusedItemNextSection),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_Tab,4|Me.KeyInputManager.get_commandKeyModifier()),Oi.u.focusedItemPreviousSection),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_RightArrow,Me.KeyInputManager.get_commandKeyModifier()),Oi.u.focusedPageIncreaseIndent),e.bindAction(Me.KeyInputManager.hashKey(Re.v.vK_LeftArrow,Me.KeyInputManager.get_commandKeyModifier()),Oi.u.focusedPageDecreaseIndent)},e.NewPage=function(t,n,i,r,o){var a,l=yi.App.get_activeAppFrame().workspace;if(1===i)return!l.get_activeSection()||lb.j.isReadOnly(l.get_activeSection())?8:2===yi.App.get_activeAppFrame().get_mode()&&l.get_activeSection()&&l.get_contentView().get_isAttached()?32:8;var s=new Ma.GraphTransaction(7);if(s.setFromNode(l.get_navigationPaneView().get_targetNode()),!l.get_activeSection()||lb.j.isReadOnly(l.get_activeSection()))return 8;a=l.get_activeSection().getContentGraph();var u=new ha.g;u.set(a);var c=null,d=(0,y.e)(Object,o);return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteOreoOnboardingIsEnabled")&&d&&e.pageTitleActionKey in d&&(c=(c=d[e.pageTitleActionKey]).trim()),l.set_activePage(e.get_SectionContentEditor().createPage(u,null,null,c)),s.dispose(),32},e.NewPageProtoButton=function(t,n,i,r,o){if(2===i){var a=n.get_node();if(!a||lb.j.isReadOnly(a))return 8;a.ensureContentGraphConnection();var l=new ha.g;l.set(a),xi.r.moveToContentIfLoaded(l);var s=new Ma.GraphTransaction(7);s.setFromIterator(l);var u=null,c=(0,y.e)(Object,o);L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteOreoOnboardingIsEnabled")&&c&&e.pageTitleActionKey in c&&(u=(u=c[e.pageTitleActionKey]).trim());var d=e.get_SectionContentEditor().createPage(l,null,null,u);return d&&yi.App.get_activeAppFrame().workspace.set_activePage(d),s.dispose(),e._embedMessageSender&&e.EmbeddedOneNoteNewPageCreated(a,d),32}return 8},e.NewSection=function(t,n,i,r,o){if(1===i)return 2===yi.App.get_activeAppFrame().get_mode()&&yi.App.notebookMode&&yi.App.get_activeAppFrame().workspace.get_contentView().get_isAttached()?32:8;var a=null,l=null,s=(0,y.e)(Object,o);if(s&&e.sectionIdKey in s)l=(a=e.get_ContextMenuDataProvider().clickedSection(o)).getParentGraphSpace();else{var u=new ha.g;for(u.set(yi.App.get_activeAppFrame().workspace.get_activeFolder()),l=u.get_currentNode(),a=u.goToLastChildByRole(49);a&&ab.FolderReader.isFolderNode(a);)a=u.goToPreviousSiblingByRole(49)}if(s&&e.sectionNameActionKey in s){var c=s[e.sectionNameActionKey];c=c.trim();var d=null;e.pageTitleActionKey in s&&(d=s[e.pageTitleActionKey]);var g=ha.g.createFromNode(l);e.get_FolderContentEditor().createSectionAfter(g,a,c,!0,d)}else rP.show(a,l,!0);return 32},e.SwitchPage=function(t,n,i,r,o){if(!yi.App.get_activeAppFrame().workspace.get_activePage())return 32;var a,l=yi.App.get_activeAppFrame().workspace.get_activePage(),s=yi.App.get_activeAppFrame().workspace.get_activeSection(),u=s.getParentGraphSpace();if(t===Oi.u.altShiftHome)a=pb.FolderNavigator.getFirstVisiblePageIfLoaded(u);else if(t===Oi.u.altShiftEnd)a=pb.FolderNavigator.getLastVisiblePageIfLoaded(u);else if(t===Oi.u.altPageUp)a=lb.j.getFirstVisiblePageIfLoaded(s);else if(t===Oi.u.altPageDown)a=lb.j.getLastVisiblePageIfLoaded(s);else if(t===Oi.u.ctrlPageUp||t===Oi.u.ctrlShiftPageUp)a=e.get_FolderEditor().getPreviousPage(l,s);else{if(t!==Oi.u.ctrlPageDown&&t!==Oi.u.ctrlShiftPageDown)return 8;a=e.get_FolderEditor().getNextPage(l,s)}return a&&yi.App.get_activeAppFrame().workspace.set_activePage(a),32},e.MovePage=function(t,n,i,r,o){var a=yi.App.get_activeAppFrame().workspace.get_activePage();if(!a)return 32;var l=t===Oi.u.altShiftDownArrow;return e.get_PageEditor().moveGivenPage(a,l),32},e.MoveSection=function(t,n,i,r,o){var a=yi.App.get_activeAppFrame().workspace.get_activeSection();return a?(e.get_SectionEditor().moveGivenSection(a,t===Oi.u.ctrlAltShiftDownArrow),32):32},e.ShiftF10NavPane=function(t,n,i,r,o){if(2===yi.App.get_activeAppFrame().get_mode()){var a=e.PerformActionOnFocusedPage((function(t){var n=t.get_sourceNode(),i=Sys.UI.DomElement.getBounds(t.get_label()),r=new Sys.UI.Point(i.x,i.y+i.height);return e.get_PageNavPaneContextMenu()&&e.get_PageNavPaneContextMenu().showAt(r,n,1),!0}));if(32===a)return a;e.PerformActionOnFocusedSection((function(t){var n=t.get_sourceNode(),i=Sys.UI.DomElement.getBounds(t.get_label()),r=new Sys.UI.Point(i.x,i.y+i.height);return e.get_SectionNavPaneContextMenu()&&e.get_SectionNavPaneContextMenu().showAt(r,n,1),!0}))}return 32},e.FocusedItemDelete=function(t,n,i,r,o){var a=e.PerformActionOnFocusedPage((function(t){return e.get_PageEditor().showDeletePageDialog(t.get_sourceNode()),!0}));return 32===a?a:e.PerformActionOnFocusedSection((function(t){var n=t.get_sourceNode();return!(!n.get_isContentPresent()||lb.j.isSectionNode(n)&&!lb.j.hasSectionBeenPersisted(n))&&(e.get_SectionEditor().showDeleteSectionDialog(n),!0)}))},e.FocusedSectionRename=function(t,n,i,r,o){return e.PerformActionOnFocusedSection((function(e){var t=e.get_sourceNode();if(!t.get_isContentPresent())return!1;var n=t.getParentGraphSpace();return rP.show(t,n,!1),!0}))},e.FocusedSectionExpand=function(t,n,i,r,o){return e.PerformActionOnFocusedSection((function(e){return e.setExpanded(!0),!0}))},e.FocusedSectionCollapse=function(t,n,i,r,o){return e.PerformActionOnFocusedSection((function(e){return e.setExpanded(!1),!0}))},e.FocusedPageIncreaseIndent=function(t,n,i,r,o){return e.PerformActionOnFocusedPage((function(t){return e.get_PageEditor().increaseIndent(t.get_sourceNode(),2),!0}))},e.FocusedPageDecreaseIndent=function(t,n,i,r,o){return e.PerformActionOnFocusedPage((function(t){return e.get_PageEditor().decreaseIndent(t.get_sourceNode(),2),!0}))},e.FocusedItemNextSection=function(t,n,i,r,o){var a=e.PerformActionOnFocusedSection((function(t){var n=Rm.SectionNavigator.getNextSection(t.get_sourceNode());return e.UpdateFocusedElement(n),!0}));return 32===a?a:e.PerformActionOnFocusedPage((function(t){var n=Rm.SectionNavigator.getNextSection(e.get_PageNavigator().getContainingSection(t.get_sourceNode()));return e.UpdateFocusedElement(n),!0}))},e.FocusedItemPreviousSection=function(t,n,i,r,o){var a=e.PerformActionOnFocusedSection((function(t){var n=Rm.SectionNavigator.getPreviousSection(t.get_sourceNode());return e.UpdateFocusedElement(n),!0}));return 32===a?a:e.PerformActionOnFocusedPage((function(t){var n=e.get_PageNavigator().getContainingSection(t.get_sourceNode());return e.UpdateFocusedElement(n),!0}))},e.PerformActionOnFocusedSection=function(t){if(St.FocusManager.usable()){if(St.FocusManager.instance().getCurrentRegion()!==St.FocusManager.instance().getRegion(e.SectionNavPaneFocusId))return 8;var n=St.FocusManager.instance().getRegion(e.SectionNavPaneFocusId).listing.get_currentElement();if(!n)return 8;var i=e.GetSectionViewIfSection(n);if(i&&t(i))return 32}return 8},e.PerformActionOnFocusedPage=function(t){if(St.FocusManager.usable()){if(St.FocusManager.instance().getCurrentRegion()!==St.FocusManager.instance().getRegion(e.PageNavPaneFocusId))return 8;var n=St.FocusManager.instance().getRegion(e.PageNavPaneFocusId).listing.get_currentElement();if(!n)return 8;var i=e.GetPageViewIfPage(n);if(i&&t(i))return 32}return 8},e.GetLinkElement=function(t){var n=null,i=null;for(t&&(i=t.firstChild);i&&!n;)n=1===ji.s.getTag(i)?i:e.GetLinkElement(i),i=i.nextSibling;return n},e.GetSectionViewIfSection=function(t){if(!t)return null;var n=e.FocusedView(t);if(n&&lb.j.isSectionNode(n.get_sourceNode())){var i=n;if(e.GetLinkElement(i.get_protoButton())!==t)return i}return null},e.GetPageViewIfPage=function(t){if(!t)return null;var n=e.FocusedView(t);return n&&e.get_PageReader().isPageNode(n.get_sourceNode())?n:null},e.FocusedView=function(t){var n=tP.j.getViewElement(t);return n||(t.parentNode?e.FocusedView(t.parentNode):null)},e.UpdateFocusedElement=function(t){if(t){var n=new ge.c(2,1,0,(function(n){var i=yi.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId(),r=e.GetLinkElement(t.getHtmlViewElement(i).get_htmlElement());St.FocusManager.instance().getRegion(e.SectionNavPaneFocusId).listing.forceSetCurrentElement(r)}));L.AFrameworkApplication.get_theTaskManager().addTask(n)}},e.EmbeddedOneNoteNewPageCreated=function(t,n){if(!t||!n)return S.ULS.sendTraceTag(17691993,339,50,"New Page Node is Null"),!1;var i=lb.j.getTitle(t).toLocaleLowerCase(),r=e.get_PageReader().getNotebookManagementEntityId(n).toString().toLowerCase();return e._embedMessageSender.sendNewPageMesssageToHostApp(i,r),!0},e.RefreshPageContent=function(e,t,n,i,r){return 1===n?32:2===n?(yi.App.get_activeAppFrame().workspace.get_contentView().onResize(),32):8},e.SectionNavPaneFocusId=null,e.PageNavPaneFocusId=null,e._folderContentEditor=null,e._folderEditor=null,e._pageEditor=null,e._sectionContentEditor=null,e._sectionEditor=null,e._contextMenuDataProvider=null,e._embedMessageSender=null,e.pageTitleActionKey="PageTitle",e.sectionNameActionKey="SectionName",e.sectionIdKey="SectionId",e._sectionNavPaneContextMenu=null,e._pageNavPaneContextMenu=null,e}();(0,o.l)(oP,"58e0e982$NavigationPaneActor",null,[]);var aP=function(){function e(){}return e.RegisterActions=function(){oP.RegisterActions()},e.RegisterShortcuts=function(){var e=St.FocusManager.instance(),t=e.getScope(Yc.u.editingFocusID),n=e.getScope(Pe.AFrame.mainAppFocusId),i=e.getScope(ex.AppFrame.navSectionListFocusId),r=e.getScope(ex.AppFrame.navPageListFocusId);oP.RegisterMainShortcuts(n),oP.RegisterEditingShortcuts(t),oP.SectionNavPaneFocusId=ex.AppFrame.navSectionListFocusId,oP.RegisterNavigationShortcuts(i),oP.PageNavPaneFocusId=ex.AppFrame.navPageListFocusId,oP.RegisterNavigationShortcuts(r)},e}();(0,o.l)(aP,"526d589d$MultiColumnNavigationPaneActor",null,[]);var lP=function(e){function t(){var t=e.call(this)||this;return t.FileId=null,t.PageId=null,t.CellId=null,t.Operation=null,t}return(0,v.t)(t,e),t.prototype.getClassId=function(){return 58},t.construct=function(e,n,i,r){var o=new t;return o.FileId=n,o.PageId=e,o.CellId=NS.j.serialize(i),o.Operation=r,o},t}(lp.z);(0,o.l)(lP,"3ca28755$PageEventNotificationRequest",lp.z,[]);var sP=function(){function e(){}return e.prototype.RegisterActions=function(e){e.addActionWithFlags(nS.u.pageDeactivated,ol.d.view,o.i(this,this.onPageDeactivated,"onPageDeactivated"),64),e.addActionWithFlags(nS.u.pageDeleted,ol.d.view,o.i(this,this.onPageDeleted,"onPageDeleted"),64)},e.prototype.onPageDeactivated=function(t,n,i,r,o){var a=this.GetRequest(e.Navigation);if(!a)return 8;var l=bS.x.constructFromSingleRequest(a);return this.SendRequest(this.GetHeaders(),l,a),32},e.prototype.onPageDeleted=function(t,n,i,r,o){var a=this.GetRequest(e.Delete);if(!a)return 8;var l=bS.x.constructFromSingleRequest(a);return this.SendRequest(this.GetHeaders(),l,a),32},e.prototype.SendRequest=function(e,t,n){L.AFrameworkApplication.theClientRequestManager.addRequest(yi.App.webServiceBase+"OneNote.ashx",2,t,e,!1,2,o.i(this,this.RequestSucceeded,"RequestSucceeded"),o.i(this,this.OnFailure,"OnFailure"),n)},e.prototype.GetRequest=function(e){var t=yi.App.get_activeAppFrame().workspace;if(!(t&&t.get_activePage()&&t.get_activePage().get_contentReplicator()&&t.get_activePage().get_contentReplicator().get_node()))return null;var n=$s.PageReader.get_instance().getNotebookManagementEntityId(t.get_activePage().get_contentReplicator().get_node()).toString();return n?lP.construct(n,yi.App.get_activeAppFrame().workspace.get_activePage().get_fileQuerySignature(),yi.App.get_activeAppFrame().workspace.get_activePage().get_objectSpaceId(),e):null},e.prototype.GetHeaders=function(){var e={"Content-Type":"application/json; charset=utf-8"};return e},e.prototype.RequestSucceeded=function(e){},e.prototype.OnFailure=function(e){},e.Navigation="navigation",e.Delete="delete",e}();(0,o.l)(sP,"2b44b887$NavigationEventsActor",null,[]);var uP=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.get_ActionManager=function(){return this._actionManager},e.prototype.newPageProtoButton=function(e){e?this.get_ActionManager().processActionAgainstContext(e,Oi.u.createNewPage,2,!1,null,null):this.get_ActionManager().processAction(Oi.u.createNewPage,2)},e.prototype.newSection=function(){this.get_ActionManager().processAction(Oi.u.newSection,2)},e}();(0,o.l)(uP,"8a34157d$NavigationPaneCommands",null,[tE.k]);var cP=n(3686),dP=n(9551),gP=n(971),pP=n(2394),hP=n(6326),_P=function(){function e(){}return e.get_NoteTagContextMenu=function(){return e._noteTagContextMenu||(e._noteTagContextMenu=Ge.w.get_instance().tryResolve(qA.v))},e.get_NoteTagEditor=function(){return Tb.n.get_instance()},e.get_ContextSetEditor=function(){return am.ContextSetEditor.get_instance()},e.RegisterActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(nS.u.noteTagsFlyoutEnabled,ol.d.view,e.NoteTagsFlyoutEnabled),t.setActionFlags(nS.u.noteTagsFlyoutEnabled,100),t.addAction(nS.u.insertNoteTag,ol.d.outlineElement,e.ToggleNoteTag),t.addAction(nS.u.insertNoteTag,ol.d.floatingImage,e.ToggleNoteTag),t.addAction(nS.u.insertNoteTag,ol.d.floatingInk,e.ToggleNoteTag),t.addAction(nS.u.insertNoteTag,ol.d.floatingEmbeddedFile,e.ToggleNoteTag),t.addAction(nS.u.insertNoteTag,ol.d.view,e.AddRemoveNoteTagViewHandler),t.setActionFlags(nS.u.insertNoteTag,12),t.addAction(nS.u.noteTagRemoveAll,ol.d.outlineElement,e.RemoveNoteTags),t.addAction(nS.u.noteTagRemoveAll,ol.d.floatingImage,e.RemoveNoteTags),t.addAction(nS.u.noteTagRemoveAll,ol.d.floatingInk,e.RemoveNoteTags),t.addAction(nS.u.noteTagRemoveAll,ol.d.floatingEmbeddedFile,e.RemoveNoteTags),t.addAction(nS.u.noteTagRemoveAll,ol.d.view,e.AddRemoveNoteTagViewHandler),t.setActionFlags(nS.u.noteTagRemoveAll,4),t.addAction(nS.u.noteTagRemove,ol.d.view,e.RemoveNoteTag),t.addAction(nS.u.noteTagRemove,ol.d.noteTag,e.RemoveNoteTag),t.setActionFlags(nS.u.noteTagRemove,4),t.addAction(nS.u.noteTagMark,ol.d.view,e.MarkNoteTag),t.addAction(nS.u.noteTagMark,ol.d.noteTag,e.MarkNoteTag),t.setActionFlags(nS.u.noteTagMark,68)},e.NoteTagsFlyoutEnabled=function(e,t,n,i,r){return 1===n?L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(t,nS.u.insertNoteTag,n,!0,i,r):32},e.AddRemoveNoteTagViewHandler=function(t,n,i,r,o){if(r.dataValue1=42,r.dataValue2=0,!n.view.get_isPageView())return 8;var a=n.view.get_selectionManager();if(!a)return 8;var l=a.get_selectionContextForActionDispatch();if(!l)return 8;var s=e.get_ContextSetEditor().getOutlineElementsAndFloatingObjects(l);if(!s)return 8;var u=null;1!==i&&(u=new Ma.GraphTransaction(15)).setFromNode(n.view.get_targetNode());var c=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(s,t,i,!1,r,o);return u&&u.dispose(),c},e.ToggleNoteTag=function(t,n,i,r,o){var a=n,l=new ha.g;if(l.set(a.get_node()),Ss.OutlineElementReader.isOutlineElement(l)&&_s.OutlineElementNavigator.moveToContent(l),1===i)return 32;var s=pP.k.create(dP.t.noteTagActor,cP.m.insertNoteTag,!0);if(gP.ReportData.isLoggingEnabled()&&s.start(),!vb.b.supportsNoteTags(l.get_currentNode()))return gP.ReportData.isLoggingEnabled()&&s.fail("CurrentNodeDoesNotSupportNoteTags"),8;if("string"==typeof o&&!(o=e.ParseAutomationNoteTagInput(o)))return gP.ReportData.isLoggingEnabled()&&s.fail("ActionDataIsEmpty"),8;var u,c,d=o,p=d.getValueWithDefault(String,Pl.k.controlId,null),h=-1;if(p&&(h=parseInt(p.substring(2,p.length)),gP.ReportData.isLoggingEnabled()&&s.addToPayload("NoteTagType",h)),h<0||h>28)return gP.ReportData.isLoggingEnabled()&&s.fail("UnknownNoteTagType","apm3e"),8;Ab.b.getDefaultShapeAndLabelForType(h,(0,g.m)((function(){return c}),(function(e){return c=e})),(0,g.m)((function(){return u}),(function(e){return u=e}))),gP.ReportData.isLoggingEnabled()&&(s.addToPayload("NoteTagShape",c),s.addToPayload("NoteTagLabel",u));var _=!1,m=new Ma.GraphTransaction(15);m.setFromNode(l.get_currentNode());var f=d.getValueWithDefault(Number,Pl.k.noteTagToggleState,0);if(bb.n.goToNoteTagContainer(l)&&(Ab.b.goToNoteTagByType(l,h)||u&&Ab.b.goToNoteTagByShapeAndLabel(l,c,u))){var y=Ab.b.getNoteTagType(l.get_currentNode()),C=Ab.b.getNoteTagLabel(l.get_currentNode()),S=Ab.b.getNoteTagShape(l.get_currentNode());if(u&&h===y&&C!==u&&S!==c)bb.n.removeNoteTag(l),f=0;else{_=!0;var b=Ab.b.isNoteTagMarked(l.get_currentNode());switch(f||(f=!b&&Ab.b.isNoteTagMarkable(l.get_currentNode())?2:3),f){case 1:b&&e.get_NoteTagEditor().toggleNoteTagMark(l.get_currentNode());break;case 2:b||e.get_NoteTagEditor().toggleNoteTagMark(l.get_currentNode());break;case 3:bb.n.removeNoteTag(l)}}}return _||(f||(f=1),3!==f&&(vb.b.isNoteTagContainer(l)&&bb.n.returnToNoteTagContainerOwner(l),e.get_NoteTagEditor().insertDefaultNoteTag(l,h),2===f&&e.get_NoteTagEditor().toggleNoteTagMark(l.get_currentNode()))),d.setValue(Pl.k.noteTagToggleState,f),m.dispose(),L.AFrameworkApplication.get_activeFrame().setFocusOnDocument(),r.dataValue1=h,r.dataValue2=f,gP.ReportData.isLoggingEnabled()&&s.stop(hP.t.success),32},e.ParseAutomationNoteTagInput=function(e){if(null==e)return null;var t=e.split(",");if(2!==t.length)return null;var n=new Dl.DictionaryPropertySet;return n.setValue(Pl.k.controlId,t[0]),n.setValue(Pl.k.noteTagToggleState,parseInt(t[1])),n},e.RemoveNoteTags=function(e,t,n,i,r){var o=t,a=new ha.g;if(a.set(o.get_node()),Ss.OutlineElementReader.isOutlineElement(a)&&_s.OutlineElementNavigator.moveToContent(a),!vb.b.hasNoteTags(a))return 8;if(1===n)return 32;var l=new Ma.GraphTransaction(15);return l.setFromNode(a.get_currentNode()),bb.n.removeAllNoteTags(a),l.dispose(),32},e.RemoveNoteTag=function(t,n,i,r,o){if(n.get_contextId()===ol.d.view)return e.HandleViewLevelContextMenuAction(t,i,r,o);if(1===i)return 32;var a=n,l=new ha.g;l.set(a.get_node());var s=new Ma.GraphTransaction(15);return s.setFromNode(l.get_currentNode()),l.tryToRootAtAncestorOfType(8)&&bb.n.removeNoteTag(l),s.dispose(),32},e.MarkNoteTag=function(t,n,i,r,o){if(n.get_contextId()===ol.d.view)return e.HandleViewLevelContextMenuAction(t,i,r,o);var a=n;if(!Ab.b.isNoteTagMarkable(a.get_node()))return 2;if(1===i)return 32;var l=new ha.g;l.set(a.get_node());var s=new Ma.GraphTransaction(15);return s.setFromNode(l.get_currentNode()),e.get_NoteTagEditor().toggleNoteTagMark(l.get_currentNode()),s.dispose(),32},e.HandleViewLevelContextMenuAction=function(t,n,i,r){if(!e.get_NoteTagContextMenu()||!e.get_NoteTagContextMenu().get_noteTagClicked()||!e.get_NoteTagContextMenu().get_noteTagClicked().get_isConnected())return 2;var o=Wa.y.create(e.get_NoteTagContextMenu().get_noteTagClicked());return L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(o,t,n,!1,i,r)},e._noteTagContextMenu=null,e}();(0,o.l)(_P,"7d626130$NoteTagActor",null,[]);var mP=function(){function e(e,t,n,i,r,o,a){this._contentView=null,this._graphSpaceEditor=null,this._pageReader=null,this._clipboardRoot=null,this._graphNodeFactory=null,this._graphTransactionFactory=null,this._undoManager=null,this._clipboardPages=null,this._contentView=i,this._pageReader=n,this._graphSpaceEditor=t,this._graphNodeFactory=r,this._graphTransactionFactory=o,this._undoManager=a,this._clipboardPages=null,this._clipboardRoot=r.create(2097162);var l=new wi.n(-1);e.get_theGraph().addRoot(l);var s=new ha.g;s.set(l);var u=this._graphTransactionFactory.getTransaction(3);u.setFromIterator(s),s.addChild(this._clipboardRoot,50),u.dispose()}return e.prototype.get_containsPages=function(){return!!this._clipboardPages&&this._clipboardPages.length>0},e.prototype.clearClipboard=function(){if(this._clipboardPages){var e=ha.g.createFromNode(this._clipboardRoot),t=this._graphTransactionFactory.getTransaction(2);t.setFromIterator(e),e.goToFirstChild()&&e.disconnectNodeAndReturnToParent(),e.set(this._clipboardRoot.getGraphSpace());for(var n=0,i=this._clipboardPages;n<i.length;n++){var r=i[n];e.goToChild(r)&&e.disconnectNodeAndReturnToParent()}t.dispose(),this._clipboardPages=null}},e.prototype.copyPagesToOneNoteClipboard=function(e,t){void 0===t&&(t=null),this.clearClipboard(),this._clipboardPages=this.PagesClipboardCopy(e,this._clipboardRoot.getGraphSpace(),!0),this.LogResult(e,this._clipboardPages,"OneNote.Actors.OneNoteClipboard.CopyPagesToOneNoteClipboard: {0}")},e.prototype.pastePagesFromOneNoteClipboard=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.RegisterSectionForUndo(e);var i=this.PagesClipboardCopy(this._clipboardPages,e,!1,t);e.ensureContentGraphConnection(),this.LogResult(this._clipboardPages,i,"OneNote.Actors.OneNoteClipboard.PastePagesFromOneNoteClipboard: {0}")},e.prototype.CleanAndCacheNewPage=function(e,t){e.updateCachedMetadata(),this._pageReader.getMetadataForWrite(e).set_hasConflictPages(!1),this._pageReader.getMetadataForWrite(e).set_hasPageVersions(!1),this._pageReader.getMetadataForWrite(e).set_notebookManagementEntityId(t)},e.prototype.CountChildren=function(e){for(var t=0,n=0,i=e;n<i.length;n++)for(var r=i[n],o=X_.z.createTraverser(r);o.moveNext();)o.get_currentNode().getGraphSpace()===r.getGraphSpace()&&t++;return t},e.prototype.PrepareUndo=function(e){this._undoManager.addPageUndo(e)},e.prototype.RegisterSectionForUndo=function(e){this._undoManager.register(e),this._undoManager.setActive(e)},e.prototype.LogResult=function(e,t,n){var i=this.CountChildren(e),r=this.CountChildren(t),o={};o.sourceObjectID=this.ObjectIdsToString(e),o.targetObjectID=this.ObjectIdsToString(t),o.PageSizeByChildrenCountSource=i.toString(),o.PageSizeByChildrenCountTarget=r.toString(),o.Success=(i===r).toString(),S.ULS.sendTraceTag(8246433,339,50,n,o)},e.prototype.ObjectIdsToString=function(e){var t=new Array(0);return e.forEach((function(e){t.push(e.get_objectSpaceId().toString())})),t.join(",")},e.prototype.PagesClipboardCopy=function(e,t,n,i){var r;void 0===i&&(i=null),n?(r=this._graphTransactionFactory.getTransaction(2)).setFromNode(e[0].getParentGraphSpace()):((r=this._graphTransactionFactory.getTransaction(15)).setFromNode(t),r.set_undoActionId(nS.u.pastePage));var o=new ha.g,a=new Array(0),l=e;i&&(l=e.slice(0,e.length).reverse());for(var s=i,u=0,c=l;u<c.length;u++){var d=c[u];o.set(t);var g=t.createChildGraphSpace(1,"Clipboard");n&&g.get_contentReplicator().set_enabled(0),s?o.insertChild(g,i,49):o.addChild(g,49),xi.r.moveToContentIfLoaded(o);var p=this._graphNodeFactory.create(393224),h=ai.l.create();if(p.setValue(is.b.notebookManagementEntityGuid,h),p.setValue(is.b.topologyCreationTimeStamp,new Date),i){var _=new ha.g;_.set(i),_.tryToRootAtAncestorOfType(5),_.returnToAncestorOfType(6),o.insertChild(p,_.get_currentNode(),1)}else o.addChild(p,1);o.goToChild(p),o.addChild(g,45),this._graphSpaceEditor.copyContent(d,g),this.CleanAndCacheNewPage(g,h),a.push(g)}if(r.dispose(),!n)for(var m=0,f=a;m<f.length;m++){g=f[m];this.PrepareUndo(g)}return a},e.prototype.readyForCopyClipboardOperation=function(e,t,n){if(t&&t.get_isContentPresent()&&!this._contentView.get_isFishbowlView()){for(var i=0,r=e;i<r.length;i++){if(!r[i].get_isContentPresent())return!1}return!0}return!1},e.prototype.readyForPasteClipboardOperation=function(e,t){return this.get_containsPages()&&e.get_isContentPresent()?this._contentView.get_isFishbowlView()?8:1===yi.App.get_activeAppFrame().get_mode()?8:32:8},e}();(0,o.l)(mP,"e952d9a1$OneNoteClipboard",null,[]);var fP=n(2782),yP=function(){function e(){}return e.prototype.isCustomBaseUrlEnabled=function(){return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteContentSyncUploadAttachmentIsEnabled")&&Ti.App.get_instance().get_isContentSyncEnabled()},e.prototype.getCustomBaseUrl=function(){var t="https://"+Ti.App.get_instance().get_oneNoteOnlineSyncAttachmentEndpoint()+e.ONOSOnlineImageBaseRoute;if(!yi.App.get_activeAppFrame().workspace.get_activeSection()||!yi.App.get_activeAppFrame().workspace.get_activePage())return t;var n=decodeURIComponent(Ti.App.extractSiteUrl().toLowerCase());return t=Oe.n.addParameterValue(t,dp.h.webUrl,n),t=Oe.n.addParameterValue(t,dp.h.pageId,this.GetPageId(yi.App.get_activeAppFrame().workspace.get_activeSection().get_fileId())),t=Oe.n.addParameterValue(t,dp.h.querySignature,L.AFrameworkApplication.get_rootQuerySignature())},e.prototype.GetPageId=function(e){var t=fP.h.getHostResourceData(e);return t.HostId+"|"+yi.App.get_activeAppFrame().workspace.get_activePage().get_objectSpaceId()+"|"+t.HostResourceId},e.ONOSOnlineImageBaseRoute="/OnlineImage",e}();(0,o.l)(yP,"72951937$OneNoteImageStewardBridge",null,[wg]);var CP=function(){function e(e,t){this._box4PasteStewardUtils=null,this._postHyperlinkAutoCorrectStrategy=null,this._box4PasteStewardUtils=e,this._postHyperlinkAutoCorrectStrategy=t}return e.prototype.tryHandlePageBreak=function(e,t,n){return this._box4PasteStewardUtils.isPageBreak(t)},e.prototype.handleParagraphEnd=function(e,t){return this._box4PasteStewardUtils.escapeTextOfParagraphEnd(e,t)},e.prototype.handleTabCharacter=function(e,t){},e.prototype.setParagraphProperties=function(e,t,n,i,r){void 0===i&&(i=null),void 0===r&&(r=null)},e.prototype.setListInfo=function(e,t,n){},e.prototype.isFormatless=function(e){return this._box4PasteStewardUtils.isFormatless(e)},e.prototype.get_isPasteBrAsNewParagraphEnabled=function(){return this._box4PasteStewardUtils.get_isPasteBrAsNewParagraphEnabled()},e.prototype.setLineSpacing=function(e,t){},e.prototype.setParagraphSpacing=function(e,t){},e.prototype.setSpecialIndent=function(e,t){},e.prototype.setLeftIndent=function(e,t){},e.prototype.get_shouldSkipSettingIndentation=function(){return!1},e.prototype.processExternalHyperlink=function(e,t){var n=Ga.ParagraphReader.text(e.get_node());Ha.HyperlinkReader.isValidUrl(n)&&(n.startsWith(Ha.HyperlinkReader.protocolHttp)||n.startsWith(Ha.HyperlinkReader.protocolHttps)||n.startsWith(Ha.HyperlinkReader.protocolWWW))&&this._postHyperlinkAutoCorrectStrategy.postProcessHyperlink(e,t)},e}();(0,o.l)(CP,"287967c3$OneNotePasteStewardBridge",null,[Nd.n]);var SP=function(){function e(e){this._url=null,this._url=e}return e.prototype.registerActions=function(e){e.addActionWithFlags(nS.u.goToStickyNotesLink,ol.d.application,o.i(this,this.GoToStickyNotesLink,"GoToStickyNotesLink"),96)},e.prototype.GoToStickyNotesLink=function(e,t,n,i,r){return 1===n?32:(El.r.traceTag(37028113,306,50,"User is going to Sticky Notes Experience"),window.open(this._url),32)},e}();(0,o.l)(SP,"65fb34ba$OneNoteStickyNotesLinkActor",null,[]);var bP=n(7191),vP=n(3666),TP=n(2484),AP=function(){function e(t){this._undoManager=null,this._undoManagerFactory=null,this._undoManagerFactory=t,e._verticalUnit=np.j.inchesToPixels(.1,1),e._horizontalUnit=np.j.inchesToPixels(.1,0)}return e.prototype.get_UndoManager=function(){return this._undoManager||(this._undoManager=this._undoManagerFactory())},e.prototype.RegisterActions=function(){var t=L.AFrameworkApplication.get_theActionManager();Gl.n.get_instance().get_item(17)&&(t.addAction(Oi.u.createOutlineBelow,ol.d.view,o.i(this,this.CreateOutlineBelowView,"CreateOutlineBelowView")),t.addAction(Oi.u.createOutlineBelow,ol.d.outline,e.CreateOutlineBelow),t.setActionFlags(Oi.u.createOutlineBelow,4)),t.addActionWithFlags(Oi.u.moveOutline,ol.d.view,e.MoveOutline,4),t.addActionWithFlags(Oi.u.resizeOutline,ol.d.view,e.ResizeOutline,4),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteTraverseOutlinesIsEnabled")&&(t.addAction(nS.u.navigateToPrevOutline,ol.d.view,o.i(this,this.NavigateToPreviousOutline,"NavigateToPreviousOutline")),t.addAction(nS.u.navigateToNextOutline,ol.d.view,o.i(this,this.NavigateToNextOutline,"NavigateToNextOutline")))},e.prototype.NavigateToPreviousOutline=function(e,t,n,i,r){var o=this.GetSiblingOutline(t,!0);return o?(this.SetSelectionToFirstCPOrElement(o),32):8},e.prototype.NavigateToNextOutline=function(e,t,n,i,r){var o=this.GetSiblingOutline(t,!1);return o?(this.SetSelectionToFirstCPOrElement(o),32):8},e.prototype.CreateOutlineBelowView=function(t,n,i,r,o){Dr.t.mark(4672);var a=n.view,l=a.get_selectionManager().get_selectionCollection().get_currentSelection().get_firstContext(),s=ha.g.createFromNode(l.get_node());if(s.tryToRootAtPageContent(),Qs.q.isInTitle(s))return 8;if(fs.OutlineNavigator.returnToOutline(s)&&ys.OutlineReader.isEphemeral(s))return 8;var u=new Ma.GraphTransaction(15);u.setFromNode(l.get_node());var c=e.get_ContextSetEditor().attemptToGeneralizeToNodeContextOfType(a.get_selectionManager().get_selectionContextForActionDispatch(),10),d=c?L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(c,t,i,!1,r,o):8,g=null;if(32===d&&2===i){var p=ha.g.createFromNode(a.get_targetNode());g=e.get_PageNavigator().moveToFirstOrLastContentOutline(p,!0),a.get_selectionManager().setSelection(Ua.SelectionFactory.createSelectionFromNode(p.get_currentNode())),this.get_UndoManager().interruptUndoMerging()}if(u.dispose(),g){var h=g.getHtmlViewElement(a.get_viewId());h&&h.get_htmlElement().scrollIntoView()}return Dr.t.mark(4673),d},e.prototype.GetSiblingOutline=function(e,t){var n=e.view.get_selectionManager().get_selectionCollection().get_currentSelection().get_firstContext();if(!n)return null;var i=ha.g.createFromNode(n.get_node());return i.tryToRootAtPageContent(),i.returnToOutlineNode(),fs.OutlineNavigator.moveToNextOrPreviousSelectableOutline(i,t),i.get_currentNode()},e.prototype.SetSelectionToFirstCPOrElement=function(e){var t=new ha.g;t.set(e),t.tryToRootAtOutlineAncestor(),fs.OutlineNavigator.moveToFirstOutlineElement(t),_s.OutlineElementNavigator.moveToContent(t);for(var n=t.get_currentNode();t.goToFirstChild();){var i=t.get_currentNode();if(26===i.get_type())break;n=i}var r=null;if(12===n.get_type()){var o=(0,y.e)(TP.q,n);r=Ua.SelectionFactory.createIpSelection(o,0)}else r=Ua.SelectionFactory.createSelectionFromNode(n);fa.SelectionManager.get_instance().setSelection(r)},e.get_instance=function(){return e._instance||(e._instance=e.GetInstanceWithResolvedDependencies())},e.GetInstanceWithResolvedDependencies=function(){return new e((function(){return Ge.w.get_instance().resolve(wa.n)}))},e.get_ContextSetEditor=function(){return am.ContextSetEditor.get_instance()},e.get_PageNavigator=function(){return Ii.PageNavigator.get_instance()},e.get_PageReader=function(){return $s.PageReader.get_instance()},e.get_PageContentEditor=function(){return e._pageContentEditor||(e._pageContentEditor=Ge.w.get_instance().resolve(jh.m))},e.get_OutlineEditor=function(){return e._outlineEditor||(e._outlineEditor=Ge.w.get_instance().resolve(zl.a))},e.CreateOutlineBelow=function(t,n,i,r,o){var a=new ha.g;a.set(yi.App.get_activeAppFrame().workspace.get_activePage());var l=new Ma.GraphTransaction(7);l.setFromIterator(a),xi.r.moveToContentIfLoaded(a),e.get_PageNavigator().moveToPageContent(a);var s=e.get_PageReader().getOutlineCount(a),u=e.get_PageReader().isRtl(a.get_currentNode());return e.get_PageContentEditor().createOutline(a),qs.v.setMuPosition(a.get_currentNode(),u?-1*s:s,s+2),e.get_OutlineEditor().appendOutlineElement(a,!0),l.dispose(),32},e.MoveOutline=function(t,n,i,r,a){if(1===i)return 32;var l=n.view,s=l.get_selectionManager().get_selectionCollection().get_currentSelection().get_firstContext();yi.App.get_activeAppFrame().get_theCursorManager().setCursor(3),e._incrementHorz=0,e._incrementVert=0;s.get_node().getHtmlViewElement(yi.App.get_activeAppFrame().workspace.get_contentView().get_viewId());e._movingElements=new Array(0),e._oldPointPixels=new Array(0);for(var u=l.get_selectionManager().get_selectionCollection(),c=0;c<u.get_length();++c){var d=u.get_item(c).get_firstContext().get_node().getHtmlViewElement(l.get_viewId());d&&o.r(bP.f,d)&&(Array.add(e._movingElements,d),Array.add(e._oldPointPixels,d.get_currentDisplayedLocation()))}return l.get_selectionManager().get_theDelayedSelectionTask().forcePendingTasks(),L.AFrameworkApplication.get_theTaskManager().pause(),e._commitHandler=e._commitMoveHandler,yi.App.get_activeAppFrame().get_theKeyInputManager().capture(e.MoveOutlineKeyTrap,null),yi.App.get_activeAppFrame().get_theMouseInputManager().capture(e.CancelTrapMouseTrap,null),yi.App.get_activeAppFrame().get_theClickInputManager().capture(e.CancelTrapMouseTrap,null),yi.App.get_activeAppFrame().get_theContextMenuInputManager().set_isSuppressingMenus(!0),32},e.ResizeOutline=function(t,n,i,r,o){if(1===i)return 32;var a=n.view,l=a.get_selectionManager().get_selectionCollection().get_currentSelection().get_firstContext();return yi.App.get_activeAppFrame().get_theCursorManager().setCursor(11),e._incrementHorz=0,e._resizingElement=l.get_node().getHtmlViewElement(yi.App.get_activeAppFrame().workspace.get_contentView().get_viewId()),e._oldWidthPixels=e._resizingElement.get_currentDisplayedWidth(),a.get_selectionManager().get_theDelayedSelectionTask().forcePendingTasks(),L.AFrameworkApplication.get_theTaskManager().pause(),e._commitHandler=e._commitResizeHandler,yi.App.get_activeAppFrame().get_theKeyInputManager().capture(e.ResizeOutlineKeyTrap,null),yi.App.get_activeAppFrame().get_theMouseInputManager().capture(e.CancelTrapMouseTrap,null),yi.App.get_activeAppFrame().get_theClickInputManager().capture(e.CancelTrapMouseTrap,null),yi.App.get_activeAppFrame().get_theContextMenuInputManager().set_isSuppressingMenus(!0),32},e.MoveOutlineKeyTrap=function(t){if(t.eventName!==me.d.keyDown)return!0;if(t.innerEvent.keyCode===Re.v.vK_Esc)e.Cancel();else if(t.innerEvent.keyCode===Re.v.vK_Enter)e.Commit();else if(t.innerEvent.keyCode===Re.v.vK_Left||t.innerEvent.keyCode===Re.v.vK_Right){t.innerEvent.keyCode===Re.v.vK_Right?e._incrementHorz++:e._incrementHorz--;for(var n=0;n<e._movingElements.length;++n)e._movingElements[n].set_currentDisplayedLocation(new Sys.UI.Point(e._oldPointPixels[n].x+e._incrementHorz*e._horizontalUnit,e._movingElements[n].get_currentDisplayedLocation().y))}else if(t.innerEvent.keyCode===Re.v.vK_Up||t.innerEvent.keyCode===Re.v.vK_Down){t.innerEvent.keyCode===Re.v.vK_Up?e._incrementVert--:e._incrementVert++;for(n=0;n<e._movingElements.length;++n)e._movingElements[n].set_currentDisplayedLocation(new Sys.UI.Point(e._movingElements[n].get_currentDisplayedLocation().x,e._oldPointPixels[n].y+e._incrementVert*e._verticalUnit))}return!0},e.CommitMove=function(){var t=new Ma.GraphTransaction(15);t.setFromNode(e._movingElements[0].get_sourceNode());for(var n=0;n<e._movingElements.length;++n){var i=0;if(10===e._movingElements[n].get_sourceNode().get_type())i=e._movingElements[n].get_outlineTitleHeight();qs.v.setPixelPosition(e._movingElements[n].get_sourceNode(),e._oldPointPixels[n].x+e._incrementHorz*e._horizontalUnit,e._oldPointPixels[n].y+e._incrementVert*e._verticalUnit+i),e._movingElements[n].resumeNormalRender()}yi.App.get_theViewManager().getView(e._movingElements[0].get_viewId()).get_selectionManager().setSelection(Ua.SelectionFactory.createCollapsedSelection(e._movingElements[0].get_sourceNode(),!1)),t.dispose()},e.ResizeOutlineKeyTrap=function(t){if(t.eventName!==me.d.keyDown)return!0;if(t.innerEvent.keyCode===Re.v.vK_Esc)e.Cancel();else if(t.innerEvent.keyCode===Re.v.vK_Enter)e.Commit();else if(t.innerEvent.keyCode===Re.v.vK_Left||t.innerEvent.keyCode===Re.v.vK_Right){var n=e._resizingElement.get_isRtl()?-1:1;t.innerEvent.keyCode===Re.v.vK_Right?e._incrementHorz+=n:e._incrementHorz-=n,e._incrementHorz=Math.max(e._incrementHorz,(e.MinimumWidthPixels-e._oldWidthPixels)/e._horizontalUnit),e._resizingElement.set_currentDisplayedWidth(e._oldWidthPixels+e._incrementHorz*e._horizontalUnit)}return!0},e.CommitResize=function(){var t=new Ma.GraphTransaction(15);t.setFromNode(e._resizingElement.get_sourceNode());var n=e._resizingElement.get_currentDisplayedWidth();(new vP.c).setOutlineWidthInPixels(e._resizingElement.get_sourceNode(),n),e._resizingElement.resumeNormalRender(),yi.App.get_theViewManager().getView(e._resizingElement.get_viewId()).get_selectionManager().setSelection(Ua.SelectionFactory.createCollapsedSelection(e._resizingElement.get_sourceNode(),!1)),t.dispose()},e.Cancel=function(){var t=e._resizingElement||e._movingElements[0],n=new Ma.GraphTransaction(3);if(n.setFromNode(t.get_sourceNode()),e._resizingElement&&e._resizingElement.resumeNormalRender(),e._movingElements)for(var i=0;i<e._movingElements.length;++i)e._movingElements[i].resumeNormalRender();t.get_source().invalidateViewElements(4,!0),t.get_sourceNode().get_anchor().invalidateViewChannelForAllViews(128),n.dispose(),e.EndTrap()},e.Commit=function(){e._commitHandler(),e.EndTrap()},e.CancelTrapMouseTrap=function(t){return t.eventName===me.d.click&&e.EndTrap(),!0},e.EndTrap=function(){L.AFrameworkApplication.get_theTaskManager().resume(),yi.App.get_activeAppFrame().get_theCursorManager().resetCursor(),yi.App.get_activeAppFrame().get_theMouseInputManager().releaseCapture(),yi.App.get_activeAppFrame().get_theClickInputManager().releaseCapture(),yi.App.get_activeAppFrame().get_theKeyInputManager().releaseCapture(),yi.App.get_activeAppFrame().get_theContextMenuInputManager().set_isSuppressingMenus(!1),e._commitHandler=null,e._resizingElement=null,e._movingElements=null},e._pageContentEditor=null,e.MinimumWidthPixels=110,e._movingElements=null,e._resizingElement=null,e._oldPointPixels=null,e._oldWidthPixels=0,e._incrementHorz=0,e._incrementVert=0,e._commitMoveHandler=e.CommitMove,e._commitResizeHandler=e.CommitResize,e._commitHandler=null,e._verticalUnit=0,e._horizontalUnit=0,e._instance=null,e._outlineEditor=null,e}();(0,o.l)(AP,"b241aa92$OutlineActor",null,[]);var IP=n(2035),wP=function(e){function t(t){var n=this;return n._sourceGraphNode=null,(n=e.call(this)||this)._sourceGraphNode=t,n}return(0,v.t)(t,e),t.prototype.get_sourceGraphNode=function(){return this._sourceGraphNode},t.prototype.setButtonsOption=function(){this.set_buttonsOption(2),this.setButtonText(1,OneNoteIntl.OneNoteStrings.L_Move),this.setButtonText(2,Box4Intl.Box4Strings.L_Copy)},t.prototype.getDialogTitle=function(){return OneNoteIntl.OneNoteStrings.L_MoveOrCopyDialogTitle},t.prototype.getIntroLabel=function(){return OneNoteIntl.OneNoteStrings.L_MoveOrCopyIntroLabel},t.prototype.sectionPickerDialogHandler=function(t,n){if(e.prototype.sectionPickerDialogHandler.call(this,t,n),1===t||2===t){var i={};i.source=this.get_sourceGraphNode(),i.destination=this.get_destinationGraphNode(),i.shouldCopy=1!==t,L.AFrameworkApplication.get_theActionManager().processActionWithData(nS.u.moveOrCopyPage,2,i)}},t}(ew);(0,o.l)(wP,"df376bb$MoveOrCopyPageDialog",ew,[]);var xP=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._contextMenuDataProvider=null,this._pageEditor=null,this._sectionEditor=null,this._sectionContentEditor=null,this._pageSeriesEditor=null,this._multiPageHelper=null,this._contextMenuDataProvider=e,this._multiPageHelper=t}return e.prototype.get_Workspace=function(){return yi.App.get_activeAppFrame().workspace},e.prototype.get_ContextMenuDataProvider=function(){return this._contextMenuDataProvider||(this._contextMenuDataProvider=Ge.w.get_instance().resolve(iE))},e.prototype.get_PageEditor=function(){return this._pageEditor||(this._pageEditor=Ge.w.get_instance().resolve(Kb.f))},e.prototype.get_SectionEditor=function(){return this._sectionEditor||(this._sectionEditor=Ge.w.get_instance().resolve(db.f))},e.prototype.get_PageNavigator=function(){return Ii.PageNavigator.get_instance()},e.prototype.get_PageReader=function(){return $s.PageReader.get_instance()},e.prototype.get_PageSeriesEditor=function(){return this._pageSeriesEditor||(this._pageSeriesEditor=Ge.w.get_instance().resolve(zb))},e.prototype.get_MultiPageHelper=function(){return this._multiPageHelper||(this._multiPageHelper=CF.get_instance())},e.prototype.get_SectionContentEditor=function(){return this._sectionContentEditor||(this._sectionContentEditor=Ge.w.get_instance().resolve($b.x))},e.prototype.get_Clipboard=function(){return Ge.w.get_instance().resolve(mP)},e.prototype.get_Browser=function(){return Ge.w.get_instance().resolve(cE)},e.prototype.get_Application=function(){return Ge.w.get_instance().resolve(uE)},e.prototype.get_DialogService=function(){return Ge.w.get_instance().resolve(dE)},e.prototype.RegisterActions=function(){var e=L.AFrameworkApplication.get_theActionManager();e.addAction(Oi.u.deletePage,ol.d.view,o.i(this,this.DeletePage,"DeletePage")),e.addAction(Oi.u.newPageAfterThisPage,ol.d.view,o.i(this,this.NewPage,"NewPage")),e.addAction(Oi.u.increaseIndent,ol.d.view,o.i(this,this.IncreaseIndent,"IncreaseIndent")),e.addAction(Oi.u.decreaseIndent,ol.d.view,o.i(this,this.DecreaseIndent,"DecreaseIndent")),e.addAction(Oi.u.getPageUrl,ol.d.view,o.i(this,this.GetPageUrl,"GetPageUrl")),e.addAction(nS.u.copyPage,ol.d.view,o.i(this,this.CopyPage,"CopyPage")),e.addAction(nS.u.pastePage,ol.d.view,o.i(this,this.PastePage,"PastePage")),e.addAction(nS.u.showVersions,ol.d.view,o.i(this,this.ShowVersions,"ShowVersions")),e.addAction(nS.u.hideVersions,ol.d.view,o.i(this,this.HideVersions,"HideVersions")),e.addAction(nS.u.showConflicts,ol.d.view,o.i(this,this.ShowConflicts,"ShowConflicts")),e.addAction(nS.u.hideConflicts,ol.d.view,o.i(this,this.HideConflicts,"HideConflicts")),e.addAction(nS.u.openPageInNewTab,ol.d.view,o.i(this,this.OpenPageInNewTab,"OpenPageInNewTab")),e.addAction(nS.u.showMoveOrCopyPageDialog,ol.d.view,o.i(this,this.ShowMoveOrCopyPageDialog,"ShowMoveOrCopyPageDialog")),e.addAction(nS.u.moveOrCopyPage,ol.d.view,o.i(this,this.MoveOrCopyPage,"MoveOrCopyPage"))},e.prototype.DeletePage=function(e,t,n,i,r){if(this.get_MultiPageHelper().isMultiplePages(r))return this.DeleteMultiplePages(n,r);var o=this.get_ContextMenuDataProvider().clickedPage(r);return 1===yi.App.get_activeAppFrame().get_mode()||lb.j.isReadOnly(this.get_Workspace().get_activeSection())?8:this.get_PageReader().hasLockOnPageNode(o)&&Ti.App.get_isCurrentUserNotebookGuest()?8:(2===n&&(!yi.App.theNotebookManager.get_isRecycleBinEnabled()||o.get_isPasswordProtectedUnlockable()||!Ti.App.get_instance().notebookType.retrieved||Ti.App.get_instance().notebookType.isEduNotebook||this.get_PageReader().hasLockOnPageNode(o)?this.get_PageEditor().showDeletePageDialog(o):this.get_PageEditor().deletePage(o,!1)),32)},e.prototype.DeleteMultiplePages=function(e,t){for(var n=this.get_MultiPageHelper().getMultiplePagesAsList(t),i=n.get_item(0),r=n.$$lge();r.$$mn();){var o=r.$$cu();if(this.get_PageReader().hasLockOnPageNode(o)&&Ti.App.get_isCurrentUserNotebookGuest())return 8}if(1===yi.App.get_activeAppFrame().get_mode()||lb.j.isReadOnly(this.get_Workspace().get_activeSection()))return 8;if(2===e)if(yi.App.theNotebookManager.get_isRecycleBinEnabled()&&!i.get_isPasswordProtectedUnlockable())for(var a=n.$$lge();a.$$mn();){var l=a.$$cu();this.get_PageEditor().deletePage(l,!1)}else this.get_PageEditor().showDeleteMultiplePagesDialog(n);return 32},e.prototype.NewPage=function(t,n,i,r,o){if(this.get_MultiPageHelper().isMultiplePages(o))return 8;var a=this.get_ContextMenuDataProvider().clickedPage(o);if(1===yi.App.get_activeAppFrame().get_mode()||lb.j.isReadOnly(this.get_Workspace().get_activeSection()))return 8;if(2===i){var l=new ha.g;l.set(a),l.tryToRootAtAncestorOfType(5),l.returnToAncestorOfType(6);var s=l.get_currentNode(),u=l.getChildCount();l.returnToAncestorOfType(5);var c=new Ma.GraphTransaction(7);c.setFromIterator(l);var d=void 0;this.get_PageReader().getLevel(a)===$s.PageReader.minPageLevel&&1===u?(this.get_SectionContentEditor().insertPageSeries(l,s),d=this.get_PageSeriesEditor().createPage(l)):d=this.get_PageSeriesEditor().createPageAfterSubpage(a),this.get_Workspace().set_activePage(d),c.dispose(),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteTemplatesAddInIsEnabled")&&Ti.App.oneNoteUserSettingsRetrieved&&!Ti.App.oneNoteUserSettings.DisablePageTemplates&&Ti.App.activatedAddins.contains("Templates")&&e.get_FutureAddinInstaller().execute((function(e){e.activateTemplatesAddin()}))}return 32},e.prototype.IncreaseIndent=function(e,t,n,i,r){if(this.get_MultiPageHelper().isMultiplePages(r)){for(var o=this.get_MultiPageHelper().getMultiplePagesAsActionData(r).$$lge();o.$$mn();){var a=o.$$cu(),l=this.IncreaseIndent(e,t,n,i,a);if(1===n&&8===l)return 8}return 32}var s=this.get_ContextMenuDataProvider().clickedPage(r);return 1===yi.App.get_activeAppFrame().get_mode()||lb.j.isReadOnly(this.get_Workspace().get_activeSection())?8:this.get_PageEditor().increaseIndent(s,n)},e.prototype.DecreaseIndent=function(e,t,n,i,r){if(this.get_MultiPageHelper().isMultiplePages(r)){for(var o=this.get_MultiPageHelper().getMultiplePagesAsActionData(r).$$lge();o.$$mn();){var a=o.$$cu(),l=this.DecreaseIndent(e,t,n,i,a);if(1===n&&8===l)return 8}return 32}var s=this.get_ContextMenuDataProvider().clickedPage(r);return 1===yi.App.get_activeAppFrame().get_mode()||lb.j.isReadOnly(this.get_Workspace().get_activeSection())?8:this.get_PageEditor().decreaseIndent(s,n)},e.prototype.GetPageUrl=function(e,t,n,i,r){if(this.get_MultiPageHelper().isMultiplePages(r))return 8;if(2===n){var o=this.get_ContextMenuDataProvider().clickedPage(r);this.CopyPageLinkToClipboard(o)}return 32},e.prototype.oreoIsCopyPageLinkToClipboardAllowed=function(e){return!this.get_MultiPageHelper().isMultiplePages(e)},e.prototype.oreoCopyPageLinkToClipboard=function(e){var t=fF.get_instance().findPageInActiveSection(e);this.CopyPageLinkToClipboard(t)},e.prototype.CopyPageLinkToClipboard=function(t){var n,i=this.get_Application().getWebAppLink(t);i=e.FormatUrlStringToIncludeEntryPoint(i,e.NavPaneGetCopyLinkUrlEntryPointParam);try{if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteHyperlinkIsEnabled")){var r=this.get_Application().getNativeAppLink(t),o=this.get_PageReader().getTitle(t);n=this.get_Browser().copyHyperlinkToClipboard(i,r,o)}else n=this.get_Browser().copyToClipboard(i)}catch(e){n=!1}n||this.get_DialogService().displayPageUrlDialog(i)},e.prototype.CopyPage=function(e,t,n,i,r){var o=this.get_MultiPageHelper().isMultiplePages(r)?this.get_MultiPageHelper().getMultiplePagesAsList(r).toArray():[this.get_ContextMenuDataProvider().clickedPage(r)];return this.get_Clipboard()&&this.get_Clipboard().readyForCopyClipboardOperation(o,this.get_Workspace().get_activeSection(),this.get_Clipboard())?(2===n&&this.get_Clipboard().copyPagesToOneNoteClipboard(o),32):8},e.prototype.PastePage=function(e,t,n,i,r){var o=null;if(this.get_MultiPageHelper().isMultiplePages(r)){var a=this.get_MultiPageHelper().getMultiplePagesAsList(r);o=a.get_item(a.get_count()-1)}else o=this.get_ContextMenuDataProvider().clickedPage(r);var l=this.get_Workspace().get_activeSection();return 1===n?this.get_Clipboard()?this.get_Clipboard().readyForPasteClipboardOperation(l,this.get_Clipboard()):8:2===n?(this.get_Clipboard().pastePagesFromOneNoteClipboard(l,o),32):2},e.prototype.ShowMoveOrCopyPageDialog=function(e,t,n,i,r){if(this.get_MultiPageHelper().isMultiplePages(r))return 8;var o=this._contextMenuDataProvider.clickedPage(r);return 1===n?1===yi.App.get_activeAppFrame().get_mode()||lb.j.isReadOnly(this.get_PageNavigator().getContainingSection(o))||this.get_PageReader().hasLockOnPageNode(o)&&Ti.App.get_isCurrentUserNotebookGuest()?8:32:2===n?this.get_PageReader().hasLockOnPageNode(o)&&Ti.App.get_isCurrentUserNotebookGuest()?8:(S.ULS.sendTraceTag(21807104,339,50,"Show Move or Copy Page Dialog for page {0}",o.get_objectSpaceId().toString()),new wP(o),32):2},e.prototype.MoveOrCopyPage=function(e,t,n,i,r){if(this.get_MultiPageHelper().isMultiplePages(r))return 8;if(1===n)return 32;if(2===n){var o=r,a=o.source,l=o.destination,s=o.shouldCopy;return this.MoveOrCopyPageToSection(a,l,s),32}return 2},e.prototype.MoveOrCopyPageToSection=function(e,t,n){var i=this;S.ULS.sendTraceTag(21353692,339,50,"Move or copy page start for page {0}.",e.get_objectSpaceId().toString());var r=this.get_PageReader().getTitle(e),o=lb.j.getTitle(t);if(t.get_isContentPresent())if(n){this.get_PageEditor().copy(e,t,null,!0,!1);var a=String.format(OneNoteIntl.OneNoteStrings.L_CopyPageSucceedToastMessage,r,o);this.ShowToast(a)}else this.get_PageEditor().move(e,t,null,!0,!1),this.get_Workspace().onGraphSpaceShutdown(e);else{var l=null;l=n?this.get_PageEditor().createDeferredPageCopyCallback(e,t,null,!0):this.get_PageEditor().createDeferredPageMoveCallback(e,t,null,!0,!1);var s=String.format(OneNoteIntl.OneNoteStrings.L_MoveOrCopyPageFailureToastMessage,r,o);this.get_SectionEditor().load(t,l,(function(e,t){S.ULS.sendTraceTag(38105924,339,15,s),i.ShowToast(s)}),null)}},e.prototype.ShowToast=function(e){var t=yi.App.get_activeAppFrame().get_notificationBar().createEntry(e,!1);yi.App.get_activeAppFrame().get_notificationBar().addEntry(t)},e.prototype.ShowVersions=function(e,t,n,i,r){if(this.get_MultiPageHelper().isMultiplePages(r))return 8;var o=this.get_ContextMenuDataProvider().clickedPage(r);return 1===n?this.get_PageReader().areVersionsVisible(o)?8:32:2},e.prototype.HideVersions=function(e,t,n,i,r){if(this.get_MultiPageHelper().isMultiplePages(r))return 8;var o=this.get_ContextMenuDataProvider().clickedPage(r);return 1===n?this.get_PageReader().areVersionsVisible(o)?32:8:2},e.prototype.ShowConflicts=function(e,t,n,i,r){if(this.get_MultiPageHelper().isMultiplePages(r))return 8;var o=this.get_ContextMenuDataProvider().clickedPage(r);return 1===n?this.get_PageReader().hasConflictPages(o)&&!this.get_PageReader().areConflictPagesVisible(o)?32:8:2},e.prototype.HideConflicts=function(e,t,n,i,r){if(this.get_MultiPageHelper().isMultiplePages(r))return 8;var o=this.get_ContextMenuDataProvider().clickedPage(r);return 1===n?this.get_PageReader().hasConflictPages(o)&&this.get_PageReader().areConflictPagesVisible(o)?32:8:2},e.prototype.OpenPageInNewTab=function(t,n,i,r,o){if(CF.get_instance().isMultiplePages(o))return 8;if(2===i){var a=this.get_ContextMenuDataProvider().clickedPage(o),l=this.get_Application().getWebAppLink(a),s=e.FormatUrlStringToIncludeEntryPoint(l,e.NavPaneGetOpenInNewTabUrlEntryPointParam);window.open(s,"_blank"),S.ULS.sendTraceTag(23459852,1600,50,"Open page in new tab")}return 32},e.get_FutureAddinInstaller=function(){return e._futureAddinInstaller||(e._futureAddinInstaller=Ge.w.get_instance().resolveFuture(IP.p)),e._futureAddinInstaller},e.FormatUrlStringToIncludeEntryPoint=function(e,t){var n="?";return e.indexOf(n)>=0&&(n="&"),String.format("{0}{1}{2}",e,n,t)},e.NavPaneGetCopyLinkUrlEntryPointParam="wdorigin=703",e.NavPaneGetOpenInNewTabUrlEntryPointParam="wdorigin=716",e._futureAddinInstaller=null,e}();(0,o.l)(xP,"4f6064e$PageNavPaneContextMenuActor",null,[rE.o]);var EP=function(){function e(){this._pageEditor=null,this._pageContentEditor=null}return e.prototype.get_PageEditor=function(){return this._pageEditor||(this._pageEditor=Ge.w.get_instance().resolve(Kb.f))},e.prototype.get_PageReader=function(){return $s.PageReader.get_instance()},e.prototype.get_PageNavigator=function(){return Ii.PageNavigator.get_instance()},e.prototype.get_PageContentEditor=function(){return this._pageContentEditor||(this._pageContentEditor=Ge.w.get_instance().resolve(mv.m))},e.prototype.RegisterActions=function(e){e.addAction(nS.u.changePageColor,ol.d.page,o.i(this,this.ChangePageColor,"ChangePageColor")),e.addAction(nS.u.clearPageColor,ol.d.page,o.i(this,this.ClearPageColor,"ClearPageColor")),e.addAction(nS.u.changePageColor,ol.d.view,yi.App.get_activeAppFrame().workspace.currentPageActorHandler),e.addAction(nS.u.clearPageColor,ol.d.view,yi.App.get_activeAppFrame().workspace.currentPageActorHandler)},e.prototype.ChangePageColor=function(e,t,n,i,r){var o=t.get_node();if(!this.get_PageReader().isPageNode(o))return 8;var a=this.get_PageNavigator().getPageContentNodeIfLoaded(o);if(!this.get_PageReader().isPageContentNode(a))return 8;if(1===n)return 32;if(2===n){var l=(0,y.e)(Object,r);if(!(l&&"Color"in l))return 8;var s=l.Color;if(!s||""===s)return 8;var u=parseInt(s,16);if(isNaN(u))return 8;var c=ff.o.rgbToBgr(u),d=new Ma.GraphTransaction(15);return d.setFromNode(a),this.get_PageContentEditor().setPageColor(a,c),d.dispose(),32}return 2},e.prototype.ClearPageColor=function(e,t,n,i,r){var o=t.get_node();if(!this.get_PageReader().isPageNode(o))return 8;var a=this.get_PageNavigator().getPageContentNodeIfLoaded(o);if(!this.get_PageReader().isPageContentNode(a))return 8;if(1===n)return 32;if(2===n){var l=new Ma.GraphTransaction(15);return l.setFromNode(a),this.get_PageContentEditor().setPageColor(a,ff.o.nil),l.dispose(),32}return 2},e}();(0,o.l)(EP,"ba7f0386$PageSetupActor",null,[]);var FP=n(9970),PP=function(){function e(t,n,i,r,o){this._actionManager=null,this._dialogFactoryLazy=null,this._featureHelper=null,this._appSettingsManager=null,this._actionManager=t,this._dialogFactoryLazy=n,e._lineSpacingHelper=i,this._featureHelper=r,this._appSettingsManager=o}return e.prototype.registerActions=function(){this._actionManager.addActionWithFlags(Oi.u.launchParagraphDialog,ol.d.view,o.i(this,this.paragraphDialogViewHandler,"paragraphDialogViewHandler"),4),this._actionManager.addAction(Oi.u.launchParagraphDialog,ol.d.paragraph,o.i(this,this.paragraphDialogHandler,"paragraphDialogHandler")),this._actionManager.addActionWithFlags(Oi.u.querySpacingAfterDialog,ol.d.view,Fc.queryDialogControl,96),this._actionManager.addActionWithFlags(Oi.u.querySpacingBeforeDialog,ol.d.view,Fc.queryDialogControl,96),this._actionManager.addActionWithFlags(Oi.u.queryLineSpacingAtDialog,ol.d.view,Fc.queryDialogControl,96),this._actionManager.addActionWithFlags(Oi.u.queryLineSpacingDialog,ol.d.view,Fc.queryDialogControl,96),this._actionManager.addActionWithFlags(Oi.u.spinSpacingBeforeDialog,ol.d.view,Fc.handleDialogControl,96),this._actionManager.addActionWithFlags(Oi.u.spinSpacingAfterDialog,ol.d.view,Fc.handleDialogControl,96),this._actionManager.addActionWithFlags(Oi.u.openSpacingAfterDialog,ol.d.view,Fc.handleDialogControl,96),this._actionManager.addActionWithFlags(Oi.u.openSpacingBeforeDialog,ol.d.view,Fc.handleDialogControl,96),this._actionManager.addActionWithFlags(Oi.u.openLineSpacingAtDialog,ol.d.view,Fc.handleDialogControl,96),this._actionManager.addActionWithFlags(Oi.u.spinLineSpacingAtDialog,ol.d.view,Fc.handleDialogControl,96),this._actionManager.addActionWithFlags(Oi.u.openLineSpacingDialog,ol.d.view,Fc.handleDialogControl,96)},e.prototype.paragraphDialogHandler=function(e,t,n,i,r){if(1===n)return 3===this._actionManager.get_mode()?32:8;var o=t.get_node(),a=this.tryGetSectionNode(t),l=3===r.inputMethod;return this._dialogFactoryLazy.get_value().createParagraphDialog(this.getPropertiesForParagraphDialog(o),this.getValiditiyCheckConstants(a),l),32},e.prototype.paragraphDialogViewHandler=function(t,n,i,r,o){var a=n.view.get_selectionManager();if(!a)return 8;if(Gl.n.get_instance().get_item(54)&&e.get_LockedRangeEditor().isContextSetInLockedParagraphs(a.get_selectionContextForActionDispatch()))return 8;if(1===i)return 3===this._actionManager.get_mode()?32:8;var l=a.get_selectionCollection().get_currentSelection(),s=this.tryGetSectionNode(n),u=3===o.inputMethod;if(1===l.get_length()&&ga.SelectionEditor.isInsertionPointContext(l.get_item(0))){var c=l.get_item(0).get_node();return this._dialogFactoryLazy.get_value().createParagraphDialog(this.getPropertiesForParagraphDialog(c),this.getValiditiyCheckConstants(s),u),32}for(var d=[],g=0;g<l.get_length();g++){var p=l.get_item(g);if(!g&&ga.SelectionEditor.isEndOfParagraphContext(p)||Ga.ParagraphReader.isParagraphContext(p)||ga.SelectionEditor.isTextRangeContext(p)){var h=p;Array.add(d,h.get_node())}}if(!d.length)return 8;var _=new Array(d.length);for(g=0;g<d.length;g++)_[g]=this.getPropertiesForParagraphDialog(d[g]);var m=FP.APropertySet.getIntersection(_);return this._dialogFactoryLazy.get_value().createParagraphDialog(m,this.getValiditiyCheckConstants(s),u),32},e.prototype.getPropertiesForParagraphDialog=function(t){var n=t,i=new Dl.DictionaryPropertySet;i.setValue(Pl.k.justification,Ga.ParagraphReader.getJustification(n));var r=e._lineSpacingHelper.getParagraphSpacing(n),o=r.lineSpacing;i.setValue(Pl.k.lineSpacingUnit,o.unit),i.setValue(Pl.k.lineSpacingValue,o.value);var a=r.beforeSpacing;i.setValue(Pl.k.paraSpacingBeforeUnit,a.unit),i.setValue(Pl.k.paraSpacingBeforeValue,a.value);var l=r.afterSpacing;return i.setValue(Pl.k.paraSpacingAfterUnit,l.unit),i.setValue(Pl.k.paraSpacingAfterValue,l.value),i},e.get_LockedRangeEditor=function(){return za.k.get_instance()},e._lineSpacingHelper=null,e}();(0,o.l)(PP,"1857c84c$ParagraphDialogActor",null,[]);var DP=function(e){function t(t,n,i,r,o){return e.call(this,t,n,i,r,o)||this}return(0,v.t)(t,e),t.prototype.getValiditiyCheckConstants=function(e){return null},t.prototype.tryGetSectionNode=function(e){return null},t.prototype.getPropertiesForParagraphDialog=function(t){var n=e.prototype.getPropertiesForParagraphDialog.call(this,t);return n.setValue(is.b.fontSize,t.get_characterProperties().get_first().get_formatting().get_cache().get_fontSize()),n.setValue(is.b.font,t.get_characterProperties().get_first().get_formatting().get_cache().get_fontFace()),n},t}(PP);(0,o.l)(DP,"47c5ac54$ParagraphDialogActor",PP,[]);var RP=function(){function e(){e._refCount++,Ji.EventHandlerManager.get_instance().EnableEventHandling(!1)}return e.prototype.dispose=function(){--e._refCount||Ji.EventHandlerManager.get_instance().EnableEventHandling(!0)},e._refCount=0,e}();(0,o.l)(RP,"452492a0$DisabledEventHandler",null,[Sys.IDisposable]);var MP=function(){function e(){}return e.RegisterActions=function(){Ti.App.oneNotePrintIsEnabled&&L.AFrameworkApplication.get_theActionManager().addAction(Oi.u.print,Ue.m.frame,e.requestPrintPreview)},e.requestPrintPreview=function(t,n,i,r,o){if(!yi.App.get_activeAppFrame().workspace.get_contentView()||!yi.App.get_activeAppFrame().workspace.get_contentView().get_isPageView()||!yi.App.get_activeAppFrame().workspace.get_contentView().get_targetNode())return 8;if(1===i)return 32;var a=new Date;if(Math.abs(a.getTime()-e._lastPrintRequestStamp.getTime())<e.RefractoryPeriodInMSecs)return 8;e._lastPrintRequestStamp=a;var l=new RP;try{var s=yi.App.get_activeAppFrame().workspace.get_contentView(),u=L.AFrameworkApplication.get_isRtl(),c=s.get_isSingleOutlineLayout(),d=s.getViewWidth(),g="",p="",h=document.getElementById("BottomRightPin");null!=h&&(g=h.style.left,p=h.style.top);var _=!1,m=!1,f=document.getElementById("PageContentContainer");if(f){for(var y=f.children,C=0;C<y.length;C++){if(y[C].className.indexOf("WACImageContainer")>-1){_=!0;break}}m=f.getElementsByTagName("svg").length>0}return S.ULS.sendTraceTag(4813469,330,50,"OneNote.PrintActor.RequestPrintPreview {0}",{isSingleOutlineLayout:c,viewWidth:d,contentWidth:g,contentHeight:p,hasPageLevelImages:_,containsInk:m,isRtl:u}),St.FocusManager.tryFocus(window.self)?(W.y.get_isInternetExplorerNonEdge()||W.y.get_isInternetExplorerEdge()?window.document.execCommand("print",!1,null):window.print(),S.ULS.sendTraceTag(4813470,330,50,"OneNote.PrintActor.RequestPrintPreview: SUCCESS"),32):(S.ULS.sendTraceTag(4813471,330,50,"OneNote.PrintActor.RequestPrintPreview: FAILURE"),8)}finally{l&&l.dispose()}},e._lastPrintRequestStamp=new Date,e.RefractoryPeriodInMSecs=1500,e}();(0,o.l)(MP,"cbf65f03$PrintActor",null,[]);var kP=function(){function e(e,t){this._actionManager=null,this._proofingManager=null,this.hideSpellingErrorsToggle=!1,this._actionManager=e,this._proofingManager=t,this.InitializeHideSpellingErrorsToggleFromCookie()}return e.prototype.get_HideSpellingErrorsCookie=function(){var t=re.z.get(e.HideSpellingErrorsCookieValue);return!!t&&"true"===t.toLowerCase()},e.prototype.set_HideSpellingErrorsCookie=function(t){return re.z.setWithExpiration(e.HideSpellingErrorsCookieValue,t.toString(),e.HideSpellingErrorsCookieExpirationDays)||S.ULS.sendTraceTag(6824535,339,50,"Failed to set cookie for hide spelling errors to {0}",t.toString()),t},e.prototype.RegisterActions=function(){this._actionManager.addActionWithFlags(nS.u.hideSpellingErrorsQueryCommand,ol.d.view,o.i(this,this.HideSpellingErrorsButtonQueryCommand,"HideSpellingErrorsButtonQueryCommand"),100),this._actionManager.addActionWithFlags(nS.u.hideSpellingErrorsCommand,ol.d.view,o.i(this,this.HideSpellingErrorsButtonCommand,"HideSpellingErrorsButtonCommand"),4)},e.prototype.InitializeHideSpellingErrorsToggleFromCookie=function(){this.hideSpellingErrorsToggle=this.get_HideSpellingErrorsCookie(),this.hideSpellingErrorsToggle?(S.ULS.sendTraceTag(6685903,339,50,"HideProofingErrors:Initialized:On"),this.HideOrShowSpellingErrors()):S.ULS.sendTraceTag(6685905,339,50,"HideProofingErrors:Initialized:Off")},e.prototype.HideOrShowSpellingErrors=function(){this.hideSpellingErrorsToggle?S.ULS.sendTraceTag(6685906,339,50,"HideProofingErrors:Toggled:Off"):S.ULS.sendTraceTag(6685904,339,50,"HideProofingErrors:Toggled:On"),this._proofingManager.set_shouldHideSpellingErrors(this.hideSpellingErrorsToggle)},e.prototype.HideSpellingErrorsButtonQueryCommand=function(e,t,n,i,r){return 1===n?32:(r[gr.e.On]=this.hideSpellingErrorsToggle,32)},e.prototype.HideSpellingErrorsButtonCommand=function(e,t,n,i,r){return 1===n?32:(this.hideSpellingErrorsToggle=!this.hideSpellingErrorsToggle,this.HideOrShowSpellingErrors(),this.set_HideSpellingErrorsCookie(this.hideSpellingErrorsToggle),32)},e.GetHideSpellingActorWithResolvedDependencies=function(){return new e(L.AFrameworkApplication.get_theActionManager(),yi.App.theProofingManager)},e.get_instance=function(){return e._singletonInstance||(e._singletonInstance=e.GetHideSpellingActorWithResolvedDependencies())},e.HideSpellingErrorsCookieValue="OneNoteHideSpellingErrors",e.HideSpellingErrorsCookieExpirationDays=30,e._singletonInstance=null,e}();(0,o.l)(kP,"b6e4c216$ProofingActor",null,[]);var NP=n(7538),LP=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,OneNoteIntl.OneNoteStrings.l_PasswordProtectedSectionDialogDescription,OneNoteIntl.OneNoteStrings.l_PasswordProtectedSectionDialogEnterPassword,OneNoteIntl.OneNoteStrings.l_PasswordProtectedSectionRequestFailedText)},e.DialogHtmlFormat="<div class='WACDialogRow' id='description'> {0} </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='password' >{1}</label> <input type='password' id='password' class='WACDialogInput' autocomplete=\"off\"/> <div class='WACDialogError' id='errorText' role='alert'>{2}</div> </div>",e}();(0,o.l)(LP,"38120cea$EnterPasswordDialogHtml",null,[]);var BP=function(e){function t(t){var n=e.call(this)||this;n.set_dialogHtml(LP.get_dialogHtml()),n.setButtonText(1,CommonUIStrings.l_DialogOk);St.FocusManager.instance().get_currentScope()&&St.FocusManager.instance().get_currentScope().name===Yc.u.fishbowlFocusId&&n.set_dismissFocusScope(St.FocusManager.instance().get_currentScope().name),n.initializeAndShow(OneNoteIntl.OneNoteStrings.l_PasswordProtectedSectionDialogTitle,o.i(n,n.EnterPasswordDialogHandler,"EnterPasswordDialogHandler"),{password:""}),n.setDescribedByForDialog("description");var i=document.getElementById("errorText");return i&&(i.style.display="none",76===t?(i.style.display="inline-block",i.innerText=OneNoteIntl.OneNoteStrings.l_PasswordProtectedSectionWrongPasswordText,L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.passwordProtectionWrongPassword,2)):-1!==t&&t&&(i.style.display="inline-block",i.innerText=OneNoteIntl.OneNoteStrings.l_PasswordProtectedSectionRequestFailedText,L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.passwordProtectionRequestFailed,2))),document.getElementById("password").focus(),n}return(0,v.t)(t,e),t.prototype.detachDialogEvents=function(){L.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().unregisterHandler(me.d.keyDown,document.getElementById("password"),o.i(this,this.EnterPasswordDialogKeyHandler,"EnterPasswordDialogKeyHandler")),L.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().unregisterHandler(me.d.keyPress,document.getElementById("password"),o.i(this,this.EnterPasswordDialogKeyHandler,"EnterPasswordDialogKeyHandler")),L.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().unregisterHandler(me.d.keyUp,document.getElementById("password"),o.i(this,this.EnterPasswordDialogKeyHandler,"EnterPasswordDialogKeyHandler")),e.prototype.detachDialogEvents.call(this)},t.prototype.attachDialogEvents=function(){L.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().registerHandler(me.d.keyDown,document.getElementById("password"),o.i(this,this.EnterPasswordDialogKeyHandler,"EnterPasswordDialogKeyHandler")),L.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().registerHandler(me.d.keyPress,document.getElementById("password"),o.i(this,this.EnterPasswordDialogKeyHandler,"EnterPasswordDialogKeyHandler")),L.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().registerHandler(me.d.keyUp,document.getElementById("password"),o.i(this,this.EnterPasswordDialogKeyHandler,"EnterPasswordDialogKeyHandler")),e.prototype.attachDialogEvents.call(this)},t.prototype.EnterPasswordDialogKeyHandler=function(e){return e.innerEvent.keyCode===Sys.UI.Key.enter&&(e.eventName===me.d.keyUp&&this.getButtonElement(1).click(),!0)},t.prototype.EnterPasswordDialogHandler=function(e,t){0!==e&&L.AFrameworkApplication.get_theActionManager().processActionWithData(Oi.u.unlockCurrentSection,2,t.password)},t}(Bi.o);(0,o.l)(BP,"3ca9c556$EnterPasswordDialog",Bi.o,[]);var OP=function(e){function t(){var t=e.call(this)||this;return t.FileQuerySignature=null,t.Password=null,t}return(0,v.t)(t,e),t.prototype.getClassId=function(){return 30},t.constructUnlockSectionRequest=function(e,n){var i=new t;return i.FileQuerySignature=e,i.Password=n,i},t}(lp.z);(0,o.l)(OP,"d2bf2813$UnlockSectionRequest",lp.z,[]);var UP=function(){function e(){}return e.RegisterActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addActionWithFlags(Oi.u.tryPassword,ol.d.view,e.TryPassword,64),t.addAction(Oi.u.lockAllSections,ol.d.application,e.LockAllSections),t.addAction(Oi.u.lockAllSectionsOnTimer,ol.d.application,e.LockAllSectionsOnTimer),t.addAction(Oi.u.unlockCurrentSection,ol.d.application,e.UnlockCurrentSection),t.addActionWithFlags(Oi.u.passwordProtectionRequestFailed,ol.d.application,Le.ActionManager.doNothingButReportHandler,64),t.addActionWithFlags(Oi.u.passwordProtectionWrongPassword,ol.d.application,Le.ActionManager.doNothingButReportHandler,64)},e.TryPassword=function(e,t,n,i,r){return new BP(-1),32},e.LockAllSectionsOnTimer=function(t,n,i,r,o){if(!(!((new Date).getTime()-L.AFrameworkApplication.get_latestActivityTime().getTime()>NP.h.lockInterval)||e.LockAllSectionsHelper()))return 32;var a=new ge.c(2,1,NP.h.lockInterval,e.LockAllProtectedSections);return L.AFrameworkApplication.get_theTaskManager().addTask(a),32},e.LockAllSections=function(t,n,i,r,o){return e.LockAllSectionsHelper(),32},e.LockAllSectionsHelper=function(){var e=!1,t=Ti.App.get_activeOneNoteFrame().workspace.get_unlockedSections();for(var n in t){var i={key:n,value:t[n]};i.value.get_isConnected()&&(i.value.tryLockSection()||(e=!0))}return e},e.UnlockCurrentSection=function(t,n,i,r,o){return e.MakeUnlockRequest(o)?32:8},e.MakeUnlockRequest=function(t){if(!t)return!1;var n=Ti.App.get_activeOneNoteFrame().workspace.get_activeSection();if(Ti.App.get_instance().get_isCSEncryptedSectionEnabled()&&(n.get_contentReplicator()||S.ULS.sendTraceTag(41011233,395,10,"Unlock Encrypted section: IsContentSyncSocketConnected is true but the active section:{0} does not have a content replicator associated with it.",n.get_objectSpaceId()),n.get_contentReplicator()&&n.get_contentReplicator().get_isUsingOneNoteContentSync()))return n.get_contentReplicator().startWithPassword(t,e.UnlockSucceededContentSync,e.UnlockFailedContentSync),!0;S.ULS.sendTraceTag(42014680,339,15,"Falling back to wac sync for encrypted sections.");var i=OP.constructUnlockSectionRequest(n.get_fileQuerySignature(),t),r=bS.x.constructFromSingleRequest(i),o={"Content-Type":"application/json; charset=utf-8"};return L.AFrameworkApplication.theClientRequestManager.addRequest(yi.App.webServiceBase+"OneNote.ashx",2,r,o,!1,2,e.UnlockRequestSucceeded,e.UnlockRequestFailed,i),!0},e.UnlockSucceededContentSync=function(){S.ULS.sendTraceTag(40739596,339,15,"Unlocking the encrypted section with the given password succeeded."),Ti.App.get_activeOneNoteFrame().workspace.onAfterSectionUnlock();var t=new ge.c(2,1,NP.h.lockInterval,e.LockAllProtectedSections);L.AFrameworkApplication.get_theTaskManager().addTask(t)},e.UnlockFailedContentSync=function(e){S.ULS.sendTraceTag(40739597,339,15,"Unlocking the encrypted section with the given password failed with status code:{0}. Prompting password dialog again.",e),new BP(e)},e.UnlockRequestSucceeded=function(t){var n,i;if(hp.j.tryDeserializeServerResponse(t.get_data().responseData,(0,g.m)((function(){return i}),(function(e){return i=e}))))if((n=i.Responses[0]).StatusCode)new BP(n.StatusCode);else{var r=Ti.App.get_activeOneNoteFrame().workspace;r.get_activeSection().set_encryptionSessionString(n.EncryptionSessionString),r.onAfterSectionUnlock();var o=new ge.c(2,1,NP.h.lockInterval,e.LockAllProtectedSections);L.AFrameworkApplication.get_theTaskManager().addTask(o)}else new BP(14)},e.UnlockRequestFailed=function(e){var t,n=14;hp.j.tryDeserializeServerResponse(e.get_data().responseData,(0,g.m)((function(){return t}),(function(e){return t=e})))&&(n=t.Responses[0].StatusCode),new BP(n)},e.LockAllProtectedSections=function(e){L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.lockAllSectionsOnTimer,2)},e}();(0,o.l)(UP,"5e298211$ProtectedSectionActor",null,[]);var HP=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.get_ActionManager=function(){return this._actionManager},e.prototype.showPasswordDialog=function(){this.get_ActionManager().processAction(Oi.u.tryPassword,2)},e}();(0,o.l)(HP,"7dbc0f2e$ProtectedSectionCommands",null,[nE.c]);var GP=function(){function e(e,t,n){this._recycleBinManager=null,this._contextMenuDataProvider=null,this._pageEditor=null,this._recycleBinManager=e,this._pageEditor=t,this._contextMenuDataProvider=n}return e.prototype.RegisterActions=function(e){e.addAction(nS.u.toggleRecycleBinVisibility,ol.d.view,o.i(this,this.ToggleRecycleBinVisibility,"ToggleRecycleBinVisibility")),e.addAction(nS.u.toggleRecycleBinVisibility,ol.d.page,o.i(this,this.ToggleRecycleBinVisibility,"ToggleRecycleBinVisibility")),e.addActionWithFlags(nS.u.queryRecycleBinVisibility,ol.d.view,o.i(this,this.QueryRecycleBinVisibility,"QueryRecycleBinVisibility"),96),e.addActionWithFlags(nS.u.queryRecycleBinVisibility,ol.d.page,o.i(this,this.QueryRecycleBinVisibility,"QueryRecycleBinVisibility"),96),e.setActionFlags(nS.u.queryRecycleBinVisibility,64),e.addAction(nS.u.showRestorePageDialog,ol.d.view,o.i(this,this.ShowRestorePageDialog,"ShowRestorePageDialog")),e.addAction(nS.u.restorePage,ol.d.view,o.i(this,this.RestorePage,"RestorePage")),e.addAction(nS.u.permanentlyDeletePage,ol.d.view,o.i(this,this.PermanentlyDeletePage,"PermanentlyDeletePage"))},e.prototype.ToggleRecycleBinVisibility=function(e,t,n,i,r){return!Ti.App.get_instance().notebookType.retrieved||Ti.App.get_instance().notebookType.isEduNotebook||this._recycleBinManager.isRecycleBinLoading()?8:1===n?32:2===n?(this._recycleBinManager&&this._recycleBinManager.setRecycleBinVisibility(!this._recycleBinManager.isRecycleBinVisible()),yi.App.get_activeAppFrame().updateCommandUI(),32):2},e.prototype.QueryRecycleBinVisibility=function(e,t,n,i,r){this._recycleBinManager&&(r[gr.e.On]=this._recycleBinManager.isRecycleBinVisible());return 32},e.prototype.ShowRestorePageDialog=function(e,t,n,i,r){if(1===yi.App.get_activeAppFrame().get_mode())return 8;if(1===n)return 32;if(2===n){var o=this._contextMenuDataProvider.clickedPage(r),a=Ge.w.get_instance().tryResolve(eI);return a&&a.createRestorePageDialog(o),32}return 2},e.prototype.RestorePage=function(e,t,n,i,r){if(1===yi.App.get_activeAppFrame().get_mode())return 8;if(1===n)return 32;if(2===n){var o=r,a=o.source,l=o.destination;return this._pageEditor.restorePage(a,l),32}return 2},e.prototype.PermanentlyDeletePage=function(e,t,n,i,r){if(1===yi.App.get_activeAppFrame().get_mode())return 8;if(1===n)return 32;if(2===n){var o=this._contextMenuDataProvider.clickedPage(r);return this._pageEditor.deletePage(o,!0),32}return 2},e}();(0,o.l)(GP,"4b9ac650$RecycleBinActor",null,[]);var WP=function(){function e(){}return e.get_dialogHtml=function(){return Bi.o.formatHtml(e.DialogHtmlFormat,Box4Intl.Box4Strings.l_PasswordProtectedSectionLockWarningMessage)},e.DialogHtmlFormat="<div class='WACDialogRow' id='description'> {0} </div>",e}();(0,o.l)(WP,"c42a1e35$LockFailedDialogHtml",null,[]);var VP=function(e){function t(t){var n=e.call(this)||this;n.setButtonText(1,CommonUIStrings.l_DialogOk),n.set_buttonsOption(4),n.set_dialogHtml(WP.get_dialogHtml()),n.setButtonText(1,Box4Intl.Box4Strings.l_PasswordProtectedSectionLockButton),n.setButtonText(2,Box4Intl.Box4Strings.l_PasswordProtectedSectionNoLockButton);var i={section:t};return n.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,o.i(n,n.LockFailedDialogHandler,"LockFailedDialogHandler"),i),n.setDescribedByForDialog("description"),n}return(0,v.t)(t,e),t.prototype.LockFailedDialogHandler=function(e,t){1===e&&t.section.forceLockSection()},t.showDialogForSingleSection=function(e){var n=e;n.getHtmlViewElement(yi.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId()).setIsLoading(!1),new t(n)},t}(Bi.o);(0,o.l)(VP,"68377589$LockFailedDialog",Bi.o,[]);var $P=function(){function e(){}return e.prototype.get_Application=function(){return Ge.w.get_instance().resolve(uE)},e.prototype.get_Browser=function(){return Ge.w.get_instance().resolve(cE)},e.prototype.get_DialogService=function(){return Ge.w.get_instance().resolve(dE)},e.prototype.RegisterActions=function(){var e=L.AFrameworkApplication.get_theActionManager();e.addAction(Oi.u.renameSection,ol.d.view,o.i(this,this.RenameSection,"RenameSection")),e.addAction(Oi.u.deleteSection,ol.d.view,o.i(this,this.DeleteSection,"DeleteSection")),e.addAction(Oi.u.lockSection,ol.d.view,o.i(this,this.LockSection,"LockSection")),e.addAction(Oi.u.newPageInSection,ol.d.view,o.i(this,this.NewPage,"NewPage")),e.addAction(Oi.u.newSectionAfterSection,ol.d.view,o.i(this,this.NewSection,"NewSection")),e.addAction(Oi.u.changeSectionColor,ol.d.application,o.i(this,this.ChangeSectionColor,"ChangeSectionColor")),e.addAction(Oi.u.sectionColorMenu,ol.d.view,o.i(this,this.SectionColorMenu,"SectionColorMenu")),e.addActionWithFlags(Oi.u.querySectionColor,ol.d.view,o.i(this,this.QuerySectionColor,"QuerySectionColor"),97),e.addAction(nS.u.pastePageInSection,ol.d.view,o.i(this,this.PastePage,"PastePage")),e.addAction(nS.u.getSectionUrl,ol.d.view,o.i(this,this.GetSectionUrl,"GetSectionUrl"))},e.prototype.GetSectionUrl=function(t,n,i,r,o){var a=e.get_ContextMenuDataProvider().clickedSection(o);return this.IsCopySectionLinkAllowed(a)?(2===i&&this.CopySectionLinkToClipboard(a),32):8},e.prototype.oreoCopySectionLinkToClipboard=function(e){var t=fF.get_instance().findGraphSpaceNode(e,131121);this.CopySectionLinkToClipboard(t)},e.prototype.CopySectionLinkToClipboard=function(t){var n,i=this.get_Application().getWebAppLink(t);i=xP.FormatUrlStringToIncludeEntryPoint(i,e.NavPaneCopyLinkToSectionEntryPointParam);try{if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteHyperlinkIsEnabled")){var r=this.get_Application().getNativeAppLink(t),o=lb.j.getTitle(t);n=this.get_Browser().copyHyperlinkToClipboard(i,r,o)}else n=this.get_Browser().copyToClipboard(i)}catch(e){n=!1}n||this.get_DialogService().displayPageUrlDialog(i)},e.prototype.oreoIsCopySectionLinkAllowed=function(t){var n=e.get_ContextMenuDataProvider().clickedSection(t);return this.IsCopySectionLinkAllowed(n)},e.prototype.IsCopySectionLinkAllowed=function(e){return!!e&&e.get_isContentPresent()},e.prototype.RenameSection=function(t,n,i,r,o){var a=e.get_ContextMenuDataProvider().clickedSection(o);if(!(a&&1!==yi.App.get_activeAppFrame().get_mode()&&yi.App.notebookMode&&this.UserHasFullAccessToSection(a)&&a.get_isContentPresent()))return 8;if(1===i&&!lb.j.hasSectionBeenPersisted(a))return 8;if(2===i){var l=(0,y.e)(Object,o);if(l&&e.newTitleKey in l){e.get_ContextMenuDataProvider().clickedSection(o);var s=l[e.newTitleKey];if(!s)return 8;var u=new Ma.GraphTransaction(7);u.setFromNode(a),e.get_SectionEditor().setTitleForRenameSection(a,s),e.get_SectionEditor().setFileIdForSection(a),a.get_anchor().invalidateViewChannelForAllViews(4),u.dispose()}else{var c=a.getParentGraphSpace();rP.show(a,c,!1)}}return 32},e.prototype.DeleteSection=function(t,n,i,r,o){var a=e.get_ContextMenuDataProvider().clickedSection(o);return a&&1!==yi.App.get_activeAppFrame().get_mode()&&yi.App.notebookMode&&this.UserHasAccessToDeleteSection(a)&&a.get_isContentPresent()&&(1!==i||lb.j.hasSectionBeenPersisted(a))?(2===i&&("boolean"==typeof o&&o?e.get_SectionEditor().deleteSection(a):e.get_SectionEditor().showDeleteSectionDialog(a)),32):8},e.prototype.LockSection=function(t,n,i,r,a){var l=e.get_ContextMenuDataProvider().clickedSection(a);if(2===i)if(l.isSectionLockable()){if(!l.tryLockSection())return 8}else l.getHtmlViewElement(yi.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId()).setIsLoading(!0),yi.App.theNotebookManager.saveNotebook(o.i(this,this.LockSaveSucceeded,"LockSaveSucceeded"),VP.showDialogForSingleSection,l,!1);return 32},e.prototype.LockSaveSucceeded=function(e){var t=e;t.getHtmlViewElement(yi.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId()).setIsLoading(!1),t.tryLockSection()},e.prototype.NewPage=function(t,n,i,r,o){var a=e.get_ContextMenuDataProvider().clickedSection(o);if(!a||1===yi.App.get_activeAppFrame().get_mode()||!this.UserHasFullAccessToSection(a))return 8;if(2===i){var l=new ha.g;l.set(a),xi.r.moveToContentIfLoaded(l);var s=new Ma.GraphTransaction(7);s.setFromIterator(l),a.ensureContentGraphConnection(),yi.App.get_activeAppFrame().workspace.set_activePage(e.get_SectionContentEditor().createPage(l)),s.dispose()}return 32},e.prototype.NewSection=function(t,n,i,r,o){if(1===yi.App.get_activeAppFrame().get_mode()||!yi.App.notebookMode)return 8;var a=e.get_ContextMenuDataProvider().clickedSection(o);if(2===i){var l=a,s=a.getParentGraphSpace();rP.show(l,s,!0)}return 32},e.prototype.ChangeSectionColor=function(t,n,i,r,o){var a=e.get_ContextMenuDataProvider().clickedSection(o);return a&&1!==yi.App.get_activeAppFrame().get_mode()&&yi.App.notebookMode&&this.UserHasFullAccessToSection(a)&&a.get_isContentPresent()?(2===i&&e.get_SectionEditor().setSectionColor(a,e.get_ContextMenuDataProvider().getColorFromActionData(o)),32):8},e.prototype.SectionColorMenu=function(t,n,i,r,o){var a=e.get_ContextMenuDataProvider().clickedSection(o);return a&&1!==yi.App.get_activeAppFrame().get_mode()&&yi.App.notebookMode&&this.UserHasFullAccessToSection(a)&&a.get_isContentPresent()?32:8},e.prototype.QuerySectionColor=function(t,n,i,r,o){var a=o,l=e.get_ContextMenuDataProvider().clickedSection(o),s=parseInt(a.MenuItemId);if(isNaN(s))return 8;var u=s,c=lb.j.getSectionColor(l),d=ff.o.notebookBGRValueToColor[c.toString()];return a.On=u===d,32},e.prototype.PastePage=function(t,n,i,r,o){var a=e.get_ContextMenuDataProvider().clickedSection(o);return a&&this.UserHasFullAccessToSection(a)?1===i?e.get_Clipboard()?e.get_Clipboard().readyForPasteClipboardOperation(a,e.get_Clipboard()):8:2===i?(e.get_Clipboard().pastePagesFromOneNoteClipboard(a),32):2:8},e.prototype.UserHasFullAccessToSection=function(e){return!lb.j.isReadOnly(e)&&1===e.get_accessRights()},e.prototype.UserHasAccessToDeleteSection=function(e){return!!e&&1===e.get_accessRights()&&(!lb.j.isReadOnly(e)||lb.j.isReadOnlyCausedByQuotaExceeded(e))},e.get_ContextMenuDataProvider=function(){return e._contextMenuDataProvider||(e._contextMenuDataProvider=Ge.w.get_instance().resolve(iE))},e.get_SectionContentEditor=function(){return e._sectionContentEditor||(e._sectionContentEditor=Ge.w.get_instance().resolve($b.x))},e.get_SectionEditor=function(){return e._sectionEditor||(e._sectionEditor=Ge.w.get_instance().resolve(db.f))},e.get_Clipboard=function(){return e._clipboard||(e._clipboard=Ge.w.get_instance().resolve(mP))},e._contextMenuDataProvider=null,e._sectionContentEditor=null,e._sectionEditor=null,e._clipboard=null,e.newTitleKey="NewTitle",e.NavPaneCopyLinkToSectionEntryPointParam="wdorigin=717",e}();(0,o.l)($P,"b0cbc8f4$SectionNavPaneContextMenuActor",null,[oE.y]);var zP=function(){function e(){}return e.prototype.registerActions=function(e){e.addAction(nS.u.updateCustomHeaderButtonBadge,ol.d.application,o.i(this,this.UpdateCustomHeaderButtonBadge,"UpdateCustomHeaderButtonBadge")),e.addAction(nS.u.updateCustomHeaderButtonState,ol.d.application,o.i(this,this.UpdateCustomHeaderButtonState,"UpdateCustomHeaderButtonState"))},e.prototype.UpdateCustomHeaderButtonBadge=function(e,t,n,i,r){if(1===n)return 32;var o=r,a=o.id.toString(),l=o.badge;return appChrome.api.dispatch(appChrome.actions.setCustomHeaderButtonBadge(a,l)),32},e.prototype.UpdateCustomHeaderButtonState=function(e,t,n,i,r){if(1===n)return 32;var o=r,a=o.id.toString(),l=o.state;return appChrome.api.dispatch(appChrome.actions.setCustomHeaderButtonState(a,l)),32},e}();(0,o.l)(zP,"cdf50e89$SharedHeaderNotificationActor",null,[]);var KP=n(6999),qP=function(){function e(e,t,n,i,r,o,a,l,s){void 0===i&&(i=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===a&&(a=null),void 0===l&&(l=null),void 0===s&&(s=null),this._autoCorrectRules=null,this._autoCorrectScheduler=null,this._undoManager=null,this._undoManagerFactory=null,this._tabActorPromoteDemoteStrategy=null,this._externalSelectionManagerFuture=null,this._tabPresenterFactory=null,this._blobEditor=null,this._featureHelper=null,this._graphTransactionFactory=null,this._userHasTriedInsertingInlineTab=!1,this._undoManagerFactory=e,this._tabActorPromoteDemoteStrategy=t,this._externalSelectionManagerFuture=n,this._autoCorrectRules=i,this._autoCorrectScheduler=r,this._tabPresenterFactory=o,this._blobEditor=a,this._featureHelper=l,this._graphTransactionFactory=s}return e.prototype.get_UndoManager=function(){return this._undoManager||(this._undoManager=this._undoManagerFactory())},e.prototype.registerActions=function(){var e=L.AFrameworkApplication.get_theActionManager(),t=o.i(this,this.TabView,"TabView");e.addActionWithFlags(Oi.u.tab,ol.d.view,t,1124),e.addActionWithFlags(Oi.u.shiftTab,ol.d.view,t,1124),e.addAction(Oi.u.inlineTab,ol.d.view,Le.ActionManager.doNothingButReportHandler)},e.prototype.TabView=function(t,n,i,r,o){var a=this;if(1===i)return 32;var l,s=t===Oi.u.shiftTab;if(!n.view.get_isInteractiveView())return 2;var u=n.view,c=u.get_selectionManager(),d=c.get_selectionContextForActionDispatch();if(!d)return 2;if(Gl.n.get_instance().get_item(14)&&e.get_LockedRangeEditor().contextSetContainsLockedRange(d))return 2;if(this._externalSelectionManagerFuture&&this._externalSelectionManagerFuture.get_instance()&&this._externalSelectionManagerFuture.get_instance().isExternalSelectionContext(d))return 4;var g=null,p=Le.ActionManager.nullAction,h=!1,_=ga.SelectionEditor.isInsertionPointContext(d);if(d.get_isContextSet()){if(c.get_selectionCollection().isOutlineLevelSelection){var m=d.getContext(0);(g=new ha.g).set(m.get_node()),g.tryToRootAtPageContent(),p=s?Oi.u.selectPreviousOutline:Oi.u.selectNextOutline}if((p=this._tabActorPromoteDemoteStrategy.priorityPromoteDemote(n,r,o,p,s?Oi.u.promoteIndent:Oi.u.demoteIndent))===Le.ActionManager.nullAction){var f=e.get_ContextSetEditor().attemptToGeneralizeToNodeContextOfType(d,16);if(f)s&&(p=Oi.u.navigatePreviousCell),(g=new ha.g).set(f.get_node()),g.tryToRootAtOutlineAncestor();else{if(Gl.n.get_instance().get_item(77))return 2;if(e.IsContextInTitle(d)){if(s)return 2;p=Oi.u.leaveTitle}else p=s?Oi.u.promoteIndent:Oi.u.demoteIndent}}}else{if(!d.get_isGraphNodeContext())return 2;if((g=new ha.g).set(d.get_node()),ga.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(g),ys.OutlineReader.isOutlineLevelContext(d))p=s?Oi.u.selectPreviousOutline:Oi.u.selectNextOutline;else{p=s?this._tabActorPromoteDemoteStrategy.graphNodePlanPromote(g,d,p,n):this._tabActorPromoteDemoteStrategy.graphNodePlanDemote(g,d,p,n),Ss.OutlineElementReader.isOutlineElement(g)&&d.get_contextId()===ol.d.insertionPoint&&(h=Ss.OutlineElementReader.isIpAtStartOrEnd(g,d,!1));var y=gs.ListReader.isListOutlineElement(g)&&h;p!==Le.ActionManager.nullAction||js.TableCellReader.isTableCellOrInside(g)||y||(this._userHasTriedInsertingInlineTab||(S.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this._userHasTriedInsertingInlineTab=!0),L.AFrameworkApplication.get_theActionManager().processAction(Oi.u.inlineTab,2),L.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),this._featureHelper&&this._featureHelper.isFeatureEnabled(76)&&this._featureHelper.isFeatureEnabled(75)&&this.insertInlineTab(n))}}if(!s&&p===Le.ActionManager.nullAction&&js.TableCellReader.isTableCellOrInside(g))if(Pd.TableNavigator.returnToCell(g),js.TableCellReader.isLastCellInTable(g)||us.TableReader.isInComplexTable(g)&&js.TableCellReader.isLastCellInTableIgnoringGhostCells(g)){if(!(p=this.actionWhenTabAtLastCell(g,d)))return 2}else p=Oi.u.navigateNextCell;if(p===Le.ActionManager.nullAction)return 2;switch(p){case Oi.u.leaveTitle:SE.f.get_instance().leaveTitle(t,d,n.view),l=32;break;case Oi.u.enterTitle:SE.f.get_instance().enterTitle(t,d,n.view),l=32;break;case Oi.u.navigateNextCell:case Oi.u.navigatePreviousCell:var C=p===Oi.u.navigatePreviousCell;if(_&&this._autoCorrectRules&&this._autoCorrectScheduler){var b=this._autoCorrectRules.findGraphAutoCorrectMatch(d,-1,!0,Re.v.vK_Tab);b&&this._autoCorrectScheduler.scheduleAction(b)}if(l=32,Pd.TableNavigator.returnToCell(g),Pd.TableNavigator.moveToNextOrPreviousCell(g,C)){var v=!0,T=!1;ys.OutlineReader.hasMultipleOutlineElements(g)||(fs.OutlineNavigator.moveToFirstOrLastOutlineElement(g,!1),_s.OutlineElementNavigator.moveToContent(g),Ga.ParagraphReader.canContainIpOrTextRange(g.get_currentNode())&&(v=!1,Ga.ParagraphReader.textLength(g.get_currentNode())||(T=!0)),T||Pd.TableNavigator.returnToCell(g));var A=void 0;if(T)A=Ua.SelectionFactory.createIpSelection(g.get_currentNode(),0);else if(A=Ua.SelectionFactory.createSelectionFromNode(g.get_currentNode()),!v&&ga.SelectionEditor.isEndOfParagraphContext(A.get_lastContext())){var I=A.toArray();Array.removeAt(I,I.length-1),A=new Ah.Selection(I,A.isForward)}c.setSelection(A)}break;case Oi.u.selectPreviousOutline:case Oi.u.selectNextOutline:p===Oi.u.selectNextOutline?fs.OutlineNavigator.moveToNextOrPreviousSelectableOutline(g,!1):fs.OutlineNavigator.moveToNextOrPreviousSelectableOutline(g,!0),c.setSelection(Ua.SelectionFactory.createSelectionFromNode(g.get_currentNode())),l=32;break;case Oi.u.splitInsertColumnAfter:if(l=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,p,i,!0,r,o),1===yi.App.get_mode()&&Pd.TableNavigator.moveToNextOrPreviousCell(g,!1)){Pd.TableNavigator.returnToCell(g);A=Ua.SelectionFactory.createCollapsedSelection(g.get_currentNode(),!0);if(ga.SelectionEditor.isEndOfParagraphContext(A.get_lastContext())){I=A.toArray();Array.removeAt(I,I.length-1),A=new Ah.Selection(I,A.isForward)}c.setSelection(A)}break;default:if(l=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,p,i,!0,r,o),!h&&_&&(p===Oi.u.promoteIndent||p===Oi.u.demoteIndent)){var w=c.get_selectionCollection().get_currentSelection(),x=ga.SelectionEditor.boundsFromSelection(w).y;yi.App.registerAfterActionCallback((function(){a.MoveIpToStartOfLine(c,u,x)}))}}return 32===l&&n.view.get_isInteractiveView()&&this.get_UndoManager().interruptUndoMerging(),l},e.prototype.MoveIpToStartOfLine=function(e,t,n){if(e&&t){var i,r=e.get_selectionCollection().get_currentSelection();ga.SelectionEditor.boundsFromSelection(r).y<n?(i=ga.SelectionEditor.findLineEndIp(t,r,!1),i=ga.SelectionEditor.findNextIp(i,!1,!1,!1,!0)):i=ga.SelectionEditor.findLineFirstIp(t,r,!1),e.setSelection(i)}},e.prototype.actionWhenTabAtLastCell=function(e,t){return Oi.u.insertRowBelow},e.prototype.insertInlineTab=function(e){},e.prototype.moveIp=function(e,t,n){if(e&&t){var i,r=e.get_selectionCollection().get_currentSelection();ga.SelectionEditor.boundsFromSelection(r).y<n?(i=ga.SelectionEditor.findLineEndIp(t,r,!1),i=ga.SelectionEditor.findNextIp(i,!1,!1,!1,!0)):i=ga.SelectionEditor.findNextIp(r,!1,!1,!1,!0),e.setSelection(i)}},e.get_LockedRangeEditor=function(){return za.k.get_instance()},e.get_ContextSetEditor=function(){return am.ContextSetEditor.get_instance()},e.IsContextInTitle=function(t){var n=e.get_ContextSetEditor().attemptToGeneralizeToNodeContextOfType(t,10);return!!n&&Qs.q.isContextInTitle(n)},e}();(0,o.l)(qP,"125c517d$TabActor",null,[]);var jP=(0,o.y)("70948dc3$ITabActorPromoteDemoteStrategy"),QP=function(){function e(e){this._indentationEditor=null,this._indentationEditor=e}return e.prototype.get_IndentationEditor=function(){return this._indentationEditor},e.prototype.priorityPromoteDemote=function(e,t,n,i,r){i===Le.ActionManager.nullAction&&(32===L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(e,r,1,!0,t,n)&&(i=r));return i},e.prototype.graphNodePlanPromote=function(e,t,n,i){return Qs.q.isInTitle(e)?Ga.ParagraphReader.isParagraphContext(t)?(n=Oi.u.selectPreviousOutline,fs.OutlineNavigator.returnToOutline(e)):n=Le.ActionManager.nullAction:(_s.OutlineElementNavigator.returnToOutlineElement(e),n=this.get_IndentationEditor().canPromote(e,-1)?Oi.u.promoteIndent:js.TableCellReader.isTableCellOrInside(e)?Oi.u.navigatePreviousCell:this.IsFirstOutlineInPage(e)?Oi.u.enterTitle:Oi.u.promoteIndent),n},e.prototype.graphNodePlanDemote=function(e,t,n,i){return Qs.q.isInTitle(e)?Ga.ParagraphReader.isParagraphContext(t)?(n=Oi.u.selectNextOutline,fs.OutlineNavigator.returnToOutline(e)):n=Oi.u.leaveTitle:ga.SelectionEditor.isInsertionPointContext(t)?ga.SelectionEditor.isIpAtStartOrEnd(e.get_currentNode(),t,!1)?(_s.OutlineElementNavigator.returnToOutlineElement(e),this.get_IndentationEditor().canDemote(e,1)&&(n=Oi.u.demoteIndent)):js.TableCellReader.isInTableCell(e)||(n=Oi.u.createTable):(_s.OutlineElementNavigator.returnToOutlineElement(e),this.get_IndentationEditor().canDemote(e,1)&&(n=Oi.u.demoteIndent)),n},e.prototype.IsFirstOutlineInPage=function(e){return ms.k.first===Ss.OutlineElementReader.getAbsoluteOutlineLevel(e)&&(fs.OutlineNavigator.returnToOutline(e),!e.goToPreviousSiblingByRole(1))},e.getAnInstanceWithResolvedDependencies=function(){return new e(hs.z.get_getOutlineElementIndentationEditor())},e}();(0,o.l)(QP,"3814aa52$TabActorPromoteDemoteStrategy",null,[jP]);var JP=function(e){function t(t,n,i,r,o){return e.call(this,t,n,i,r,o)||this}return(0,v.t)(t,e),t.prototype.actionWhenTabAtLastCell=function(e,t){return 1===us.TableReader.getRowCount(Pd.TableNavigator.getContainingTable(e))?ga.SelectionEditor.isInsertionPointContext(t)?Oi.u.splitInsertColumnAfter:Oi.u.insertColumnAfter:ga.SelectionEditor.isInsertionPointContext(t)?Oi.u.splitInsertRowBelow:Oi.u.insertRowBelow},t.get_Instance=function(){return t._instance||(t._instance=t.GetInstanceWithResolvedDependencies())},t.GetInstanceWithResolvedDependencies=function(){return new t((function(){return Ge.w.get_instance().resolve(wa.n)}),QP.getAnInstanceWithResolvedDependencies(),Ge.w.get_instance().resolveFuture(kg.i),Ge.w.get_instance().resolve(Ca.r),Ge.w.get_instance().resolve(Ia.g))},t._instance=null,t}(qP);(0,o.l)(JP,"6421cea5$TabActor",qP,[]);var XP=function(){function e(){}return e.RegisterActions=function(t){t.addActionWithFlags(Fe.b.toggleRibbonUX,Ue.m.frame,e.ToggleRibbonUXHandler,128)},e.ToggleRibbonUXHandler=function(t,n,i,r,o){if(n.get_contextId()!==Ue.m.frame)return 2;var a=L.AFrameworkApplication.get_activeFrame();return a?(a.beforeRefreshDocument(),e.SaveCookieAndRefresh(a),32):8},e.SaveCookieAndRefresh=function(e){var t=!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled();t?S.ULS.sendTraceTag(36717077,340,50,"User is switching to Classic Ribbon from Single Line Ribbon in OneNote"):S.ULS.sendTraceTag(36717078,340,50,"User is switching to Single Line Ribbon from Classic Ribbon in OneNote");var n=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("IsSimplifiedRibbonOnCookieName");re.z.setWithExpiration(n,(!t).toString(),re.z.maxComplianceAllowedRetentionInDays),e.refreshDocument(null)},e}();(0,o.l)(XP,"f4770037$ToggleRibbonUXActor",null,[]);var YP=function(){function e(){}return e.get_PageEditor=function(){return e._pageEditor||(e._pageEditor=Ge.w.get_instance().resolve(Kb.f))},e.get_PageNavigator=function(){return Ii.PageNavigator.get_instance()},e.get_PageReader=function(){return $s.PageReader.get_instance()},e.get_VersionHistoryEditor=function(){return e._versionHistoryEditor||(e._versionHistoryEditor=Ge.w.get_instance().tryResolve(qb.e))},e.get_BusinessBarControllerFuture=function(){return e._businessBarControllerFuture||(e._businessBarControllerFuture=Ge.w.get_instance().resolveFuture(Li.d))},e.get_ContextMenuDataProvider=function(){return e._contextMenuDataProvider||(e._contextMenuDataProvider=Ge.w.get_instance().resolve(iE))},e.RegisterActions=function(){if(Gl.n.get_instance().get_item(47)){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(Oi.u.toggleVersionsVisibility,ol.d.page,e.ToggleVisibility),t.addAction(Oi.u.queryVersionsVisibility,ol.d.page,e.QueryVisibility),t.addAction(Oi.u.restoreVersion,ol.d.page,e.RestoreVersion),t.addAction(Oi.u.deleteVersion,ol.d.page,e.DeleteVersion),t.addAction(Oi.u.toggleVersionsVisibility,ol.d.view,yi.App.get_activeAppFrame().workspace.currentPageActorHandler),t.addAction(Oi.u.queryVersionsVisibility,ol.d.view,yi.App.get_activeAppFrame().workspace.currentPageActorHandler),t.addAction(Oi.u.restoreVersion,ol.d.view,yi.App.get_activeAppFrame().workspace.currentPageActorHandler),t.addAction(Oi.u.deleteVersion,ol.d.view,yi.App.get_activeAppFrame().workspace.currentPageActorHandler),t.setActionFlags(Oi.u.queryVersionsVisibility,1)}},e.ToggleVisibility=function(t,n,i,r,o){var a=n.get_node();if(o){var l=o;if(l.PageId)a=e.get_ContextMenuDataProvider().clickedPage(o);else{var s=e.GetToggleVersionsSourceControl(l);3!==s&&s?1===s&&(a=sI.get_versionClicked()||sI.get_pageClicked()):a=n.get_node()}}if(!e.get_PageReader().isVersioningEnabled())return 8;if(1===i)return e.get_PageReader().isConflictPageNode(a)?8:32;if(e.get_PageReader().isVersionNode(a)){var u=e.get_PageNavigator().getContainingPageFromVersion(a),c=yi.App.get_activeAppFrame().workspace.get_activePage();c&&e.get_PageReader().isVersionNode(c)&&e.get_PageNavigator().getContainingPageFromVersion(c)===u&&yi.App.get_activeAppFrame().workspace.set_activePage(u),a=u}else if(e.get_PageReader().isConflictPageNode(a))return 8;var d=new Ma.GraphTransaction(3);d.setFromNode(a);var g=!e.get_PageReader().areVersionsVisible(a);e.get_PageEditor().setVersionsVisibility(a,g);var p=e.get_PageNavigator().getVersionHistoryNode(a);return p&&g&&(p.get_contentReplicator()||(p.attachContentReplicator("VersionHistory"),p.get_contentReplicator().forceInbound(null,null,null))),yi.App.get_activeAppFrame().updateCommandUI(),d.dispose(),sI.set_versionClicked(null),32},e.GetToggleVersionsSourceControl=function(e){switch(e.SourceControlId){case"fsbcShowVersions":return 3;case"fseaToggleVersionsVisibilityBusinessBar":return 0;case"fseaToggleVersionsVisibility":return 1;default:return 2}},e.QueryVisibility=function(t,n,i,r,o){var a=n.get_node(),l=e.get_PageReader().isVersionNode(a)||e.get_PageReader().isConflictPageNode(a)&&e.get_PageReader().areVersionsVisible(e.get_PageNavigator().getContainingPage(a))||e.get_PageReader().areVersionsVisible(a);return o.setValue(Pl.k.versionsVisible,l),32},e.RestoreVersion=function(t,n,i,r,o){var a,l=o;if(a=l&&l.VersionId&&l.PageId?e.GetVersionPageFromActionData(o):sI.get_versionClicked()||n.get_node(),!e.get_PageReader().isVersionNode(a))return 8;if(1===yi.App.get_activeAppFrame().get_mode())return 8;if(!e.get_PageReader().isVersioningEnabled())return 8;if(1===i)return 32;var s=new Ma.GraphTransaction(7);return s.setFromNode(a),e.get_VersionHistoryEditor().restoreVersion(a),s.dispose(),e.get_BusinessBarControllerFuture().execute((function(e){e.checkCurrentPageStatusBusinessBars()})),sI.set_versionClicked(null),32},e.DeleteVersion=function(t,n,i,r,o){var a,l=o;if(a=l&&l.VersionId&&l.PageId?e.GetVersionPageFromActionData(o):sI.get_versionClicked()||n.get_node(),!e.get_PageReader().isVersionNode(a))return 8;if(1===yi.App.get_activeAppFrame().get_mode())return 8;if(!e.get_PageReader().isVersioningEnabled())return 8;if(1===i)return 32;var s=new Ma.GraphTransaction(7);return s.setFromNode(a),e.get_PageEditor().showDeletePageDialog(a),s.dispose(),e.get_BusinessBarControllerFuture().execute((function(e){e.checkCurrentPageStatusBusinessBars()})),sI.set_versionClicked(null),32},e.GetVersionPageFromActionData=function(t){var n=t,i=e.get_ContextMenuDataProvider().clickedPage(t),r=mt.h.createFromString(n.VersionId.toString());return e.get_PageNavigator().getVersionHistoryNode(i).getChildGraphSpaceNodeForContext(r,!1)},e._pageEditor=null,e._versionHistoryEditor=null,e._businessBarControllerFuture=null,e._contextMenuDataProvider=null,e}();(0,o.l)(YP,"b02ace8a$VersionHistoryActor",null,[]);var ZP=n(4711),eD=function(){function e(){this._container=null,this._businessBarControllerFuture=null}return e.prototype.get_businessBarControllerFuture=function(){return this._businessBarControllerFuture||(this._businessBarControllerFuture=Ge.w.get_instance().resolveFuture(Li.d))},e.prototype.get_name=function(){return"OneNote.Actors"},e.prototype.init=function(){if(Gl.n.get_instance().get_item(3)&&YE.RegisterActions(),Si.InteractiveViewManager.get_instance().get_editingView().set_deleteActionsEnabled(!0),_F.get_instance().registerActions(L.AFrameworkApplication.get_theActionManager()),CE.get_instance().registerActions(),this._container.resolve(GF).registerActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteParagraphSpacingIsEnabled")&&(OE.registerActions(),this._container.resolve(DP).registerActions()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAutoCorrectOptionSettingIsEnabled")&&this._container.resolve(zg).registerActions(),(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioPlaybackIsEnabled")||L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioRecordingIsEnabled"))&&this._container.resolve(QE.c).registerActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioPlaybackIsEnabled")&&this._container.resolve(qE.AudioPlaybackActor).registerActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioRecordingIsEnabled")&&this._container.resolve(jE.h).registerActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInsertFileIsEnabled")&&this._container.resolve(RF).registerActions(),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteSyncStatusEnabled")&&!L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSyncUxFeatureEnabled()&&this._container.resolve(KP.n).registerActions(L.AFrameworkApplication.get_theActionManager()),Ti.App.oneNoteMultiColumnNavPaneIsEnabled?(aP.RegisterActions(),aP.RegisterShortcuts()):(oP.RegisterActions(),oP.RegisterShortcuts()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteCopyToCloudIsEnabled")&&this._container.resolve(ZE).RegisterActions(L.AFrameworkApplication.get_theActionManager()),this._container.resolve(EP).RegisterActions(L.AFrameworkApplication.get_theActionManager()),eP.RegisterActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteModeIsEnabled")&&ZF.RegisterActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxFlightEnabled()&&XP.RegisterActions(L.AFrameworkApplication.get_theActionManager()),_P.RegisterActions(),AP.get_instance().RegisterActions(),UP.RegisterActions(),JE.RegisterActions(),Ti.App.oneNoteHideSpellingIsEnabled&&kP.get_instance().RegisterActions(),Ti.App.oneNotePrintIsEnabled)MP.RegisterActions();else{var e=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("IrmPolicyDescription");e&&this.get_businessBarControllerFuture().execute((function(t){t.showIRMPolicyDescription(e)}))}JP.get_Instance().registerActions(),Gl.n.get_instance().get_item(47)&&YP.RegisterActions(),this._container.resolve($P).RegisterActions(),this._container.resolve(xP).RegisterActions(),Ti.App.get_isEmbedMessageEnabled()&&XE.RegisterActions(),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInkInputEnabled")&&(qF.o.RegisterActions(),JF.RegisterActions(),XF.RegisterActions()),Ti.App.oneNoteRecycleBinIsEnabled&&this._container.resolve(GP).RegisterActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteUpdatePageCacheIsEnabled")&&!L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteContentSyncIsEnabled")&&this._container.resolve(sP).RegisterActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteFormatPainterIsEnabled")&&this._container.resolve(wE).registerActions(),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxFlightEnabled()&&LE.registerActions(),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderUxEnabled()&&this._container.resolve(zP).registerActions(L.AFrameworkApplication.get_theActionManager()),this._container.resolve(tE.k),this._container.resolve(nE.c),this._container.resolve(KE).RegisterContentDetailsProviders(),yi.App.get_activeAppFrame().updateCommandUI(),this._container.resolve(bF).RegisterActions()},e.prototype.dispose=function(){},e.prototype.configure=function(e){var t=this;this._container=e,(new $E).configure(e),e.register(fd.h).singleInstance().usingFactory((function(){return new hE(L.AFrameworkApplication.get_theActionManager(),Oi.u.browserCut,Oi.u.browserCopied,Oi.u.browserPasted,Oi.u.pasteGivenText)})),e.register(Cg).singleInstance().usingFactory((function(){return new I_(!1,e.resolve(eg.x).getBooleanAppSetting("SplitHyperlinkFixWithEnterIsEnabled"))})),e.register(mg).singleInstance().usingFactory((function(){return new zp(e.resolve(eg.x).getBooleanAppSetting("ExternalPasteImprovementsEnabled")&&e.resolve(eg.x).getBooleanAppSetting("ListMarkerIsEnabled"),void 0,void 0,void 0,void 0,!0)})),e.register(DP).singleInstance().usingFactory((function(){return new DP(L.AFrameworkApplication.get_theActionManager(),e.resolveLazy(tI),e.resolve(ZP.d),e.resolveLazy(Yh.d),L.AFrameworkApplication.appSettingsManager)})),e.register(Qc).singleInstance().usingFactory((function(){return new UE(L.AFrameworkApplication.get_theActionManager())})),e.register(yP).as(wg).singleInstance().usingFactory((function(){return new yP})),e.register(CP).as(Nd.n).singleInstance().usingFactory((function(){return new CP(e.resolve(Ld),e.resolve(La))})),e.register(_E).as(sf).singleInstance().usingFactory((function(){return new _E})),e.register(tE.k).singleInstance().usingFactory((function(){return new uP(L.AFrameworkApplication.get_theActionManager())})),e.register(nE.c).singleInstance().usingFactory((function(){return new HP(L.AFrameworkApplication.get_theActionManager())})),e.register(kF).as(RE),e.register(KE).singleInstance().usingFactory((function(){return new KE(e.resolveFuture(ea.t),e.resolveLazy(kF))})),e.register(GF).as(DE).singleInstance().usingFactory((function(){return new GF(e.resolve(SS.w),e.resolveFuture(kg.i),e.resolve(xa.b).get_instance(),e.resolve(wa.n),e.resolve(ES.l))})),e.register(iE).singleInstance().usingFactory((function(){return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteOreoNavPaneIsEnabled")?new yF:new YF})),e.register(xP).as(rE.o).singleInstance().usingFactory((function(){return new xP})),e.register($P).as(oE.y).singleInstance().usingFactory((function(){return new $P})),e.register(EP).singleInstance().usingFactory((function(){return new EP})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInsertFileIsEnabled")&&e.register(RF).singleInstance().usingFactory((function(){return new RF(Xt.s.get_instance(),L.AFrameworkApplication.get_activeFrame().get_theKeyInputManager(),L.AFrameworkApplication.get_theActionManager(),e.resolve(dT.r),e.resolve(mT),e.resolve(hT.c),e.resolve(wa.n))})),e.register(QE.c).singleInstance().usingFactory((function(){return new QE.c})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioPlaybackIsEnabled")&&e.register(qE.AudioPlaybackActor).singleInstance().usingFactory((function(){return new qE.AudioPlaybackActor})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteCopyToCloudIsEnabled")&&e.register(ZE).singleInstance().usingFactory((function(){return new ZE})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioRecordingIsEnabled")&&e.register(jE.h).singleInstance().usingFactory((function(){return new jE.h(e.resolve(oT),e.resolve(dT.r))})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteSyncStatusEnabled")&&!L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSyncUxFeatureEnabled()&&e.register(KP.n).singleInstance().usingFactory((function(){return new KP.n(e.resolve(nu.r),e.resolve(aE.i),e.resolve(lE.l),e.resolve($i.i))})),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderUxEnabled()&&e.register(zP).singleInstance().usingFactory((function(){return new zP})),Ti.App.oneNoteRecycleBinIsEnabled&&e.register(GP).singleInstance().usingFactory((function(){return new GP(e.resolve(sE.t),e.resolve(Kb.f),e.resolve(iE))})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteUpdatePageCacheIsEnabled")&&!L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteContentSyncIsEnabled")&&e.register(sP).singleInstance().usingFactory((function(){return new sP})),e.register(mP).singleInstance().usingFactory((function(){return new mP(yi.App.theNotebookManager,e.resolve(Vb.e),$s.PageReader.get_instance(),Ti.App.get_activeOneNoteFrame().workspace.get_contentView(),e.resolve(bg.u),e.resolve(cg.c),e.resolve(wa.n))})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteFormatPainterIsEnabled")&&(this._container.register(IE).as(pc.w).singleInstance().usingFactory((function(){return new IE(t._container.resolve(ts.e),t._container.resolve(Fg.c),t._container.resolve(Vs.z),t._container.resolve(ns.g),t._container.resolve(Jd.s),t._container.resolve(jl.v),t._container.resolve(Ql.c),t._container.resolve(ba.x),za.k.get_instance(),null,t._container.resolve(xa.b).get_instance(),t._container.resolve(es.x).get_instance(),t._container.resolve(Kf.d))})),this._container.register(wE).singleInstance().usingFactory((function(){return new wE(yi.App.get_activeAppFrame(),St.FocusManager.instance(),L.AFrameworkApplication.get_theActionManager(),xr.y.get_instance(),VI.z.get_instance(),t._container.resolve(pc.w))}))),e.register(uE).usingFactory((function(){return new WF})),e.register(cE).usingFactory((function(){return new VF})),e.register(dE).usingFactory((function(){return new KF})),e.register(gE).singleInstance().usingFactory((function(){return new vE(e.tryResolve(Ia.g),e.resolveLazy(wa.n),e.resolveFuture(kg.i))})),e.register(md).singleInstance().usingFactory((function(){return new kE($s.PageReader.get_instance(),e.resolveLazy(wa.n),e.resolve(cg.c),!0,!0)})),e.register(em.j).singleInstance().usingFactory((function(){return new mF(e.resolve(lg.x),e.resolve(pE.d))})),e.register(TE).as(Dg).singleInstance().usingFactory((function(){return new TE})),e.register(bF).singleInstance().usingFactory((function(){return new bF})),e.register(SP).singleInstance().usingFactory((function(){return new SP(L.AFrameworkApplication.appSettingsManager.getStringAppSetting("OneNoteStickyNotesLinkValue"))}))},e.main=function(){B.o.get_instance().registerPackage(new e)},e}();(0,o.l)(eD,"955fc5af$OneNoteActorsPackage",null,[s.u,u.s]);var tD=n(3237),nD=(0,o.y)("d7229f03$ITaskPaneManager"),iD=function(){return function(){this.entry=null,this.show=!1}}();(0,o.l)(iD,"abd24bf8$AnimationBatchEntry",null,[]);var rD=n(5898),oD=function(){function e(){var e=this;this._containerLeft=null,this._containerRight=null,this._taskPaneDomLoaded=!1,this._modalDiv=null,this._leftTaskPaneVisibleCount=0,this._rightTaskPaneVisibleCount=0,this._paneOrderPreferenceLeft=[],this._paneOrderPreferenceRight=[],this._taskPaneEntries={},this._animationQueue=[],this._isReactTaskPaneInfraEnabled=!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactTaskPaneInfrastructureEnabled(),this.addPreferredOrderList(),this._taskPaneDomLoaded=!1,ar.r.get_instance().executeWhen(14,(function(){e.createTaskPaneContainers()}))}return e.prototype.get_taskPaneEntries=function(){return this._taskPaneEntries},e.prototype.createTaskPaneEntry=function(t,n,i,r){var o=this.getTaskPaneEntryId(n);S.ULS.sendTraceTag(4290588,320,50,"Create new task pane."),this.createTaskPaneContainers();var a=document.createElement("div");return a.id=o,a.className=e.WacTaskPaneEntryClass,a.style.width="0",this._isReactTaskPaneInfraEnabled||(this.AddEntryToContainer(i,o,a),this._taskPaneEntries[o]=t.createTaskPaneEntry(o,i,r,a)),a},e.prototype.createTaskPaneContainers=function(){this._taskPaneDomLoaded||this.SetupTaskPaneContainers()},e.prototype.AddEntryToContainer=function(e,t,n){var i=null,r=null;if(e?1===e&&(i=this._containerRight,r=this._paneOrderPreferenceRight):(i=this._containerLeft,r=this._paneOrderPreferenceLeft),i){for(var o=!1,a=0;a<r.length;a++)if(o){if(r[a]in this._taskPaneEntries)return void this.insertTaskPaneEntryBefore(i,n,this._taskPaneEntries[r[a]])}else r[a]===t&&(o=!0);i.appendChild(n)}},e.prototype.insertTaskPaneEntryBefore=function(e,t,n){e.insertBefore(t,n.get_element())},e.prototype.disposeTaskPaneEntry=function(e){var t=this.getTaskPaneEntryId(e);if(t in this._taskPaneEntries){var n=this._taskPaneEntries[t];n.get_element().parentNode.removeChild(n.get_element()),delete this._taskPaneEntries[t]}},e.prototype.showTaskPaneEntry=function(e){var t=this.getTaskPaneEntryId(e);if(t in this._taskPaneEntries){var n=this._taskPaneEntries[t];if(n&&!n.get_isVisible()){this.ShowHideTaskPaneEntry(n,!0);var i=this.CalculateAdjustWidthSize(n,!0);this.adjustAppSize(n.get_position(),!0,i),1===n.get_position()&&P.j.count(this._taskPaneEntries)>1&&this.LogVisibleTaskPanes()}}},e.prototype.hideTaskPaneEntry=function(e){var t=this.getTaskPaneEntryId(e);if(t in this._taskPaneEntries){var n=this._taskPaneEntries[t];if(n&&n.get_isVisible()){this.ShowHideTaskPaneEntry(n,!1);var i=this.CalculateAdjustWidthSize(n,!1);this.adjustAppSize(n.get_position(),!1,i)}}},e.prototype.createTaskPaneModalDiv=function(e){if(this._modalDiv)return this._modalDiv;var t=document.createElement("div");return document.body.appendChild(t),t&&(this._modalDiv=new bw(t,e)),this._modalDiv},e.prototype.ShowHideTaskPaneEntry=function(e,t){var n=this;e.get_element()&&(e.set_isVisible(t),this._animationQueue.push((0,U.m)(new iD,{entry:e,show:t}))),e.get_position()?this._rightTaskPaneVisibleCount+=t?1:-1:this._leftTaskPaneVisibleCount+=t?1:-1,1===this._animationQueue.length&&window.setTimeout(o.i(this,this.startPaneAnimation,"startPaneAnimation"),0),ar.r.get_instance().executeWhen(14,(function(){e.get_element()&&e.get_element().parentNode&&(!e.get_position()&&!n._leftTaskPaneVisibleCount||1===e.get_position()&&!n._rightTaskPaneVisibleCount?(e.get_element().parentNode.style.minHeight="0px",e.get_element().parentNode.style.height="0px",e.get_element().parentNode.style.overflow="hidden"):(e.get_element().parentNode.style.minHeight="",e.get_element().parentNode.style.height="",e.get_element().parentNode.style.overflow=""))}))},e.prototype.startPaneAnimation=function(){this.onPaneAnimation();var e=Kc.Enumerable.where(iD,Kc.Enumerable.asEnumerable(iD,this._animationQueue),(function(e){return!e.entry.get_position()})),t=Kc.Enumerable.where(iD,e,(function(e){return!e.show}));if(Kc.Enumerable.any(iD,t)&&Kc.Enumerable.Ct(iD,t)!==Kc.Enumerable.Ct(iD,e)){for(var n=t.$$ge();n.$$mn();){n.$$cu().entry.get_element().style.width="0"}e=Kc.Enumerable.where(iD,e,(function(e){return e.show}))}var i=Kc.Enumerable.where(iD,Kc.Enumerable.asEnumerable(iD,this._animationQueue),(function(e){return 1===e.entry.get_position()})),r=Kc.Enumerable.where(iD,i,(function(e){return!e.show}));if(Kc.Enumerable.any(iD,r)&&Kc.Enumerable.Ct(iD,r)!==Kc.Enumerable.Ct(iD,i)){for(var o=r.$$ge();o.$$mn();){o.$$cu().entry.get_element().style.width="0"}i=Kc.Enumerable.where(iD,i,(function(e){return e.show}))}for(var a=Kc.Enumerable.concat(iD,e,i).$$ge();a.$$mn();){var l=a.$$cu(),s=l.entry;PC.WacAirSpace.setAnimationClass(s.get_element(),Er.j.showHideTaskPaneAnimationClass);var u=new rD.f(s.get_element());l.show?u.animateWidth(0,s.get_width()):u.animateWidth(s.get_width(),0),PC.WacAirSpace.animate(u,null,null)}this._animationQueue.length=0},e.prototype.onPaneAnimation=function(){},e.prototype.CalculateAdjustWidthSize=function(e,t){var n=e.get_width(),i=e.get_position()?this._rightTaskPaneVisibleCount:this._leftTaskPaneVisibleCount;return(t&&1===i||!t&&!i)&&(n+=1),n},e.prototype.SetupTaskPaneContainers=function(){this._taskPaneDomLoaded||(this._containerLeft||(this._containerLeft=document.createElement("div"),this._containerLeft.id=e.WacTaskPaneContainerLeftId,this._containerLeft.className=e.WacTaskPaneContainerClass,Sys.UI.DomElement.addCssClass(this._containerLeft,"alignLeft"),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled()&&Sys.UI.DomElement.addCssClass(this._containerLeft,"FlexBoxLayout"),this._isReactTaskPaneInfraEnabled&&Sys.UI.DomElement.addCssClass(this._containerLeft,e.WacReactTaskPaneContainerClass),this.addTaskPaneContainer(0,this._containerLeft)),this._containerRight||(this._containerRight=document.createElement("div"),this._containerRight.id=e.WacTaskPaneContainerRightId,this._containerRight.className=e.WacTaskPaneContainerClass,Sys.UI.DomElement.addCssClass(this._containerRight,"alignRight"),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled()&&Sys.UI.DomElement.addCssClass(this._containerRight,"FlexBoxLayout"),this._isReactTaskPaneInfraEnabled&&Sys.UI.DomElement.addCssClass(this._containerRight,e.WacReactTaskPaneContainerClass),this.addTaskPaneContainer(1,this._containerRight)),this.onTaskPaneContainersAdded(this._containerLeft,this._containerRight),this._taskPaneDomLoaded=!0)},e.prototype.onTaskPaneContainersAdded=function(e,t){},e.prototype.addTaskPaneToPreferredList=function(e,t){Array.add(1===e?this._paneOrderPreferenceRight:this._paneOrderPreferenceLeft,t)},e.prototype.getTaskPaneEntryId=function(e){return e+"-Entry"},e.prototype.LogVisibleTaskPanes=function(){for(var e=0,t=0,n=P.j.getKeys(this._taskPaneEntries);t<n.length;t++){var i=n[t],r=(0,y.e)(tD.u,this._taskPaneEntries[i]);r&&r.get_isVisible()&&1===r.get_position()&&e++}2===e?S.ULS.sendTraceTag(595855454,320,50,"2 simultaneous panes open"):e>2&&S.ULS.sendTraceTag(595855455,320,50,e+" simultaneous panes open")},e.WacTaskPaneContainerLeftId="WACTaskPaneContainerLeft",e.WacTaskPaneContainerRightId="WACTaskPaneContainerRight",e.WacTaskPaneContainerClass="WACTaskPaneContainer",e.WacTaskPaneEntryClass="WACTaskPaneEntry",e.WacReactTaskPaneContainerClass="WACReactTaskPaneContainer",e}();(0,o.l)(oD,"c41459a6$ATaskPaneManager",null,[nD]);var aD=function(e){function t(t,n){var i=this;return i._actionManager=null,i._isAppRtl=!1,i._viewPanelLeft=0,i._viewPanelRight=0,i._newViewPanelLeft=0,i._newViewPanelRight=0,(i=e.call(this)||this)._actionManager=t,i._isAppRtl=n,i}return(0,v.t)(t,e),t.prototype.addTaskPaneContainer=function(e,t){var n=yi.App.get_activeAppFrame().get_viewPanelContainer();n.parentNode&&(e?1===e&&(n.parentNode.insertBefore(t,n.nextSibling),ar.r.get_instance().executeWhen(14,(function(){regionComposer.getRegion("FarPane").appendChild(t),Sys.UI.DomElement.addCssClass(t,"regionComposer"),regionComposer.WindowUtils.registerBoundingWindowRectsChanged("farPane",(function(e,n){3===n?Sys.UI.DomElement.addCssClass(t,"DL"):Sys.UI.DomElement.removeCssClass(t,"DL")}))}))):(n.parentNode.insertBefore(t,n),ar.r.get_instance().executeWhen(14,(function(){regionComposer.getRegion("NearPane").appendChild(t),Sys.UI.DomElement.addCssClass(t,"regionComposer")}))))},t.prototype.adjustAppSize=function(e,t,n){if(!ar.r.get_instance().isCompleted(14)){var i=t?n:-n;e?this._newViewPanelRight+=i:this._newViewPanelLeft+=i}},t.prototype.onPaneAnimation=function(){if(!ar.r.get_instance().isCompleted(14)){var e=yi.App.get_activeAppFrame().get_viewPanelContainer();if(PC.WacAirSpace.setAnimationClass(e,Er.j.showHideTaskPaneAnimationClass),this._viewPanelLeft!==this._newViewPanelLeft){var t=new EC.r(e);t.animateX(this._viewPanelLeft,this._newViewPanelLeft,this._isAppRtl),PC.WacAirSpace.animate(t,null,o.i(this,this.ForceInteractiveViewRefreshOutline,"ForceInteractiveViewRefreshOutline")),this._viewPanelLeft=this._newViewPanelLeft}if(this._viewPanelRight!==this._newViewPanelRight){var n=new EC.r(e);n.animateXRight(this._viewPanelRight,this._newViewPanelRight,this._isAppRtl),PC.WacAirSpace.animate(n,null,o.i(this,this.ForceInteractiveViewRefreshOutline,"ForceInteractiveViewRefreshOutline")),this._viewPanelRight=this._newViewPanelRight}}},t.prototype.ForceInteractiveViewRefreshOutline=function(e){Si.InteractiveViewManager.get_instance().forEach((function(e){e.forceResize()}))},t.prototype.getOwnerDOMDocument=function(){return yi.App.get_activeAppFrame().get_viewPanelContainer().ownerDocument},t}(oD);(0,o.l)(aD,"461e0cd9$TaskPaneManager",oD,[]);var lD=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,v.t)(t,e),t.prototype.registerActions=function(){},t.prototype.addPreferredOrderList=function(){},t.GetTaskPaneManagerWithResolvedDependencies=function(){return new t(L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.get_isRtl())},t}(aD);(0,o.l)(lD,"ba08ee21$TaskPaneManager",aD,[]);var sD=function(){function e(){this._taskPaneManager=null}return e.prototype.get_name=function(){return"OneNote.TaskPaneManager"},e.prototype.configure=function(e){},e.prototype.init=function(){this._taskPaneManager=lD.GetTaskPaneManagerWithResolvedDependencies(),this._taskPaneManager.registerActions(),yi.App.get_activeAppFrame().set_taskPaneManager(this._taskPaneManager)},e.prototype.dispose=function(){},e}();(0,o.l)(sD,"ae75e4ef$OneNoteTaskPaneManagerPackage",null,[s.u,u.s]);var uD=function(){function e(){}return e.main=function(){B.o.get_instance().registerPackage(new sD)},e}();(0,o.l)(uD,"d32b1f11$Program",null,[]),Type.registerNamespace("AppRealtimeChannel"),Type.registerNamespace("B4A11Y"),Type.registerNamespace("B4Ac"),Type.registerNamespace("B4AuC"),Type.registerNamespace("B4CS"),Type.registerNamespace("B4IE"),Type.registerNamespace("B4Im"),Type.registerNamespace("B4LE"),Type.registerNamespace("B4NLE"),Type.registerNamespace("B4OLE"),Type.registerNamespace("B4TLE"),Type.registerNamespace("B4TaE"),Type.registerNamespace("B4UI"),Type.registerNamespace("B4Up"),Type.registerNamespace("BasicChat"),Type.registerNamespace("Box3"),Type.registerNamespace("Box4.AtMentions"),Type.registerNamespace("Box4.ClipArt"),Type.registerNamespace("Box4.Clipboard"),Type.registerNamespace("Box4.Insights"),Type.registerNamespace("Box4.ListMarker"),Type.registerNamespace("Box4.ListMarkerGallery"),Type.registerNamespace("Box4.Media"),Type.registerNamespace("Box4.TaskPaneManager"),Type.registerNamespace("CAUI"),Type.registerNamespace("CNT"),Type.registerNamespace("CUIB"),Type.registerNamespace("CommandUI"),Type.registerNamespace("CommandUI.Controls"),Type.registerNamespace("CommandUI.Controls.SearchBoxComponents"),Type.registerNamespace("CommandUI.TaskPane"),Type.registerNamespace("Common"),Type.registerNamespace("Common.App.ActivityAggregator"),Type.registerNamespace("Common.App.AltTextDialog"),Type.registerNamespace("Common.App.ApplicationFeatureHelper"),Type.registerNamespace("Common.App.BrowserInfoLogger"),Type.registerNamespace("Common.App.ChromeExtensionHelper"),Type.registerNamespace("Common.App.CommandUIActors"),Type.registerNamespace("Common.App.EventsCacheManager"),Type.registerNamespace("Common.App.HostNotification"),Type.registerNamespace("Common.App.InsertFile"),Type.registerNamespace("Common.App.InsertPicture"),Type.registerNamespace("Common.App.Insights"),Type.registerNamespace("Common.App.NewAndOpen.Core"),Type.registerNamespace("Common.App.OneDriveFilePickerApi"),Type.registerNamespace("Common.App.OpenInClient"),Type.registerNamespace("Common.App.SafeLinks"),Type.registerNamespace("Common.App.SaveStatus"),Type.registerNamespace("Common.App.SessionExpiration"),Type.registerNamespace("Common.App.TaskPaneManager"),Type.registerNamespace("ONAc"),Type.registerNamespace("ONEF"),Type.registerNamespace("ONIE"),Type.registerNamespace("ONIL"),Type.registerNamespace("ONLE"),Type.registerNamespace("ONNE"),Type.registerNamespace("ONNLE"),Type.registerNamespace("ONOLE"),Type.registerNamespace("ONTLE"),Type.registerNamespace("ONTaE"),Type.registerNamespace("ONUI"),Type.registerNamespace("ONUp"),Type.registerNamespace("OneNote.CommandUIActors"),Type.registerNamespace("OneNote.CommandingEditors"),Type.registerNamespace("OneNote.FasterOutbound"),Type.registerNamespace("OneNote.Navigation"),Type.registerNamespace("OneNote.PageHtmlRecall"),Type.registerNamespace("OneNote.SessionExpiration"),Type.registerNamespace("OneNote.SyncUX"),Type.registerNamespace("OneNote.TaskPaneManager"),Type.registerNamespace("Wonca.UI"),O.main(),$.main(),ae.main(),be.main(),We.main(),en.main(),hn.main(),Un.main(),ti.main(),ui.main(),hi.main(),vi.main(),Pi.main(),Vi.main(),Yi.main(),er.main(),Xo.main(),ya.main(),Ka.main(),qa.main(),ja.main(),Qa.main(),Vl.main(),$l.main(),Ys.main(),Zs.main(),eu.main(),nd.main(),_d.main(),My.main(),Ly.main(),Qy.main(),gC.main(),bC.main(),HC.main(),QC.main();yS.main(),xS.main(),US.main(),ib.main(),mb.main(),Fb.main(),Bb.main(),vv.main(),Ov.main(),rT.main(),fT.main(),hA.main(),fA.main(),yA.main(),VA.main(),eE.main(),eD.main(),uD.main()},5429:function(e,t,n){"use strict";n.d(t,{u:function(){return i}});var i=(0,n(4115).y)("115211ce$IFormattingStewardBridge")},5487:function(e,t,n){"use strict";n.d(t,{p:function(){return i}});var i=(0,n(4115).y)("3db67dd0$ISemanticTableEventAcceptor")},6589:function(e,t,n){"use strict";n.r(t),n.d(t,{BreadcrumbContainer:function(){return c}});var i=n(1817),r=n(2130),o=n(417),a=n(9958),l=n(3116),s=n(2946),u=n(4115),c=function(e){function t(){var t=e.call(this)||this;return t._breadcrumbItems=null,t.set_elmContainer(a.k.createUnselectableElement("span")),t.get_elmContainer().className="cui-herobar-breadcrumbContainer",t.get_elmContainer().id="viewerChrome-breadcrumbContainer",l.AFrameworkApplication.hideHeader&&(o.CuiHelper.createAppBrandElement(t.get_elmContainer()),(l.AFrameworkApplication.breadcrumbBrandName||l.AFrameworkApplication.breadcrumbFolderName)&&o.CuiHelper.createAppBrandSeparatorElement(t.get_elmContainer())),t._breadcrumbItems=o.CuiHelper.createHostBrandAndFolderElements(t.get_elmContainer(),o.CuiHelper.breadcrumbAlternateSeparatorImageName),t}return(0,i.t)(t,e),t.prototype.getBreadcrumbItem=function(e){if(!this._breadcrumbItems)return null;for(var t=0;t<this._breadcrumbItems.length;t++)if(this._breadcrumbItems[t].id===e)return this._breadcrumbItems[t];return null},t.prototype.truncateWidth=function(n){if(this._elementToTruncate=this.getBreadcrumbItem(o.CuiHelper.breadcrumbFolderId),this._elementToTruncate){var i=t.CalculateBreadcrumbFolderNameMaxWidth(this.get_elmContainer().offsetWidth,this._elementToTruncate.offsetWidth,n);i>0&&e.prototype.truncateWidth.call(this,i)}},t.prototype.dispose=function(){s.EventHandlerManager.get_instance().unregisterAllHandlersForDOMArray(this._breadcrumbItems)},t.CalculateBreadcrumbFolderNameMaxWidth=function(e,t,n){return t-(e-n)},t}(r.m);(0,u.l)(c,"dc73de44$BreadcrumbContainer",r.m,[])},6628:function(e,t,n){"use strict";n.d(t,{c:function(){return h}});var i=n(4115),r=n(2927),o=n(463),a=n(7386),l=n(3116),s=n(6325),u=n(8028),c=n(8923),d=n(2280),g=n(253),p=n(9369),h=function(){function e(){}return e.prototype.registerActions=function(e){e.addActionWithFlags(a.u.queryAudioTabGroup,d.d.view,i.i(this,this.QueryAudioTabGroup,"QueryAudioTabGroup"),96)},e.prototype.QueryAudioTabGroup=function(t,n,i,r,o){return e.get_isRecordingAudio()||this.IsRibbonEnabledForAudioPlayback(n)?32:8},e.prototype.IsRibbonEnabledForAudioPlayback=function(e){return l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioPlaybackIsEnabled")&&this.IsPlayableAudioOnPage(e)},e.prototype.IsPlayableAudioOnPage=function(e){var t=e;if(!t.view.get_isInteractiveView())return!1;var n=t.view;if(!n.get_selectionManager())return!1;var i=c.PageNavigator.get_instance().navigateToPageContentNode(n.get_targetNode());if(!i||!i.get_properties().hasProperty(o.b.audioRecordingGuids))return!1;for(var a=g.z.createTraverser(i);a.moveNext();)if(a.get_currentNode()){if(u.EmbeddedFileReader.isPlayableAudio(a.get_currentNode()))return!0}else r.ULS.sendTraceTag(39987159,324,15,"traverser node is null");return!1},e.get_isRecordingAudio=function(){return l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioRecordingIsEnabled")&&s.w.get_instance().resolve(p.h).get_isRecording()},e}();(0,i.l)(h,"67b943ef$AudioToolsActor",null,[])},6813:function(e,t,n){"use strict";n.r(t),n.d(t,{ReactOICErrorDialogWithTrial:function(){return s}});var i=n(1817),r=n(4115),o=n(3516),a=n(9847),l=n(6618),s=function(e){function t(t,n,i,o,s,u){var c=e.call(this,t,n,i,o,s,u)||this,d={errorMessage:c.get_errorMessageNoOffice(),offerString:c.get_offerString()},g=new l.o(!1,!1,!0);if(c.get_showHelpLink()){g.set_buttonsOption(1);d.helpLink={type:"AppLinkProps",id:"helpLink",text:c.get_helpLinkText(),handler:function(e){a.Redirect.showHelp(c.get_helpLinkContentId())}}}else g.set_buttonsOption(4),g.setButtonText(2,c.get_iHaveOfficeButtonText());g.setButtonText(1,c.get_actionButtonText()),g.set_dialogId(c.get_id());var p={id:c.get_id(),dialogIcon:c.get_icon(),bodyControls:d};return g.initializeAndShow(c.get_dialogTitle(),r.i(c,c.reactOICErrorDialogWithTrialHandler,"reactOICErrorDialogWithTrialHandler"),p),c}return(0,i.t)(t,e),t}(o.p);(0,r.l)(s,"55093f9$ReactOICErrorDialogWithTrial",o.p,[])},7118:function(e,t,n){"use strict";var i=n(2927),r=n(4115),o=function(){function e(){}return e.serializeUsageData=function(e,t){var n={},i=function(e,t){null!=t&&(n[e]=t)},r=null;switch(e){case 0:var o=t;r="HtmlProcessor",i("SessionID",o.a),i("Elements",o.b.toString()),i("PrunedElements",o.c.toString()),i("TransparentElements",o.d.toString()),i("VoidElements",o.e.toString()),i("UnknownElements",o.f.toString());break;case 1:var a=t;r="WordConverter",i("SessionID",a.a),i("BulletsConverted",a.b.toString()),i("NumberedConverted",a.c.toString());break;case 2:var l=t;r="FormattingSteward",i("SessionID",l.a),i("Lang",l.b.toString()),i("TextDir",l.c.toString()),i("Bold",l.d.toString()),i("Math",l.e.toString()),i("Italics",l.f.toString()),i("Underline",l.g.toString()),i("Strikethrough",l.h.toString()),i("Subscript",l.i.toString()),i("Superscript",l.j.toString()),i("Fontsize",l.k.toString()),i("Fontface",l.l.toString()),i("GrowFontsize",l.m.toString()),i("ShrinkFontsize",l.n.toString()),i("FontColor",l.o.toString()),i("FontHighlight",l.p.toString()),i("ParagraphStyle",l.q.toString()),i("TextAlign",l.r.toString()),i("TextIndent",l.s.toString()),i("MarginLeft",l.t.toString()),i("ParagraphSpaceBefore",l.u.toString()),i("ParagraphSpaceAfter",l.v.toString()),i("LineSpace",l.w.toString()),i("CellShadingColor",l.x.toString());break;case 3:var s=t;r="SemanticEvents",i("SessionID",s.a),i("Text",s.b.toString()),i("LineBreak",s.c.toString()),i("Image",s.d.toString()),i("File",s.e.toString()),i("FormattingChange",s.f.toString()),i("Anchor",s.g.toString()),i("Paragraph",s.h.toString()),i("Math",s.i.toString()),i("List",s.j.toString()),i("ListItem",s.k.toString()),i("RenderAugmentation",s.l.toString()),i("Span",s.m.toString());break;case 4:var u=t;r="SemanticTableEvents",i("SessionID",u.a),i("Tables",u.b.toString()),i("TableRow",u.c.toString()),i("TableCell",u.d.toString()),i("TablePart",u.e.toString());break;case 5:var c=t;r="HtmlEvents",i("OperationId",c.a),i("SourceApp",c.b),i("Browser",c.c),i("Text",null==c.d?null:c.d.toString()),i("A",null==c.e?null:c.e.toString()),i("Abbr",null==c.f?null:c.f.toString()),i("Acronym",null==c.g?null:c.g.toString()),i("Address",null==c.h?null:c.h.toString()),i("Applet",null==c.i?null:c.i.toString()),i("Area",null==c.j?null:c.j.toString()),i("B",null==c.k?null:c.k.toString()),i("Base",null==c.l?null:c.l.toString()),i("Basefont",null==c.m?null:c.m.toString()),i("Bdo",null==c.n?null:c.n.toString()),i("Big",null==c.o?null:c.o.toString()),i("Blockquote",null==c.p?null:c.p.toString()),i("Body",null==c.q?null:c.q.toString()),i("Br",null==c.r?null:c.r.toString()),i("Button",null==c.s?null:c.s.toString()),i("Caption",null==c.t?null:c.t.toString()),i("Center",null==c.u?null:c.u.toString()),i("Cite",null==c.v?null:c.v.toString()),i("Code",null==c.w?null:c.w.toString()),i("Col",null==c.x?null:c.x.toString()),i("Colgroup",null==c.y?null:c.y.toString()),i("Dd",null==c.z?null:c.z.toString()),i("Del",null==c.ba?null:c.ba.toString()),i("Dfn",null==c.bb?null:c.bb.toString()),i("Dir",null==c.bc?null:c.bc.toString()),i("Div",null==c.bd?null:c.bd.toString()),i("Dl",null==c.be?null:c.be.toString()),i("Dt",null==c.bf?null:c.bf.toString()),i("Em",null==c.bg?null:c.bg.toString()),i("Fieldset",null==c.bh?null:c.bh.toString()),i("Font",null==c.bi?null:c.bi.toString()),i("Form",null==c.bj?null:c.bj.toString()),i("Frame",null==c.bk?null:c.bk.toString()),i("Frameset",null==c.bl?null:c.bl.toString()),i("H",null==c.bm?null:c.bm.toString()),i("Head",null==c.bn?null:c.bn.toString()),i("Hr",null==c.bo?null:c.bo.toString()),i("Html",null==c.bp?null:c.bp.toString()),i("I",null==c.bq?null:c.bq.toString()),i("Iframe",null==c.br?null:c.br.toString()),i("Img",null==c.bs?null:c.bs.toString()),i("Input",null==c.bt?null:c.bt.toString()),i("Ins",null==c.bu?null:c.bu.toString()),i("Isindex",null==c.bv?null:c.bv.toString()),i("Kbd",null==c.bw?null:c.bw.toString()),i("Label",null==c.bx?null:c.bx.toString()),i("Legend",null==c.by?null:c.by.toString()),i("Li",null==c.bz?null:c.bz.toString()),i("Link",null==c.ca?null:c.ca.toString()),i("Map",null==c.cb?null:c.cb.toString()),i("Math",null==c.cc?null:c.cc.toString()),i("Menu",null==c.cd?null:c.cd.toString()),i("Meta",null==c.ce?null:c.ce.toString()),i("Noframes",null==c.cf?null:c.cf.toString()),i("Noscript",null==c.cg?null:c.cg.toString()),i("Object",null==c.ch?null:c.ch.toString()),i("Ol",null==c.ci?null:c.ci.toString()),i("Optgroup",null==c.cj?null:c.cj.toString()),i("Option",null==c.ck?null:c.ck.toString()),i("P",null==c.cl?null:c.cl.toString()),i("Param",null==c.cm?null:c.cm.toString()),i("Pre",null==c.cn?null:c.cn.toString()),i("Q",null==c.co?null:c.co.toString()),i("S",null==c.cp?null:c.cp.toString()),i("Samp",null==c.cq?null:c.cq.toString()),i("Script",null==c.cr?null:c.cr.toString()),i("Select",null==c.cs?null:c.cs.toString()),i("Small",null==c.ct?null:c.ct.toString()),i("Span",null==c.cu?null:c.cu.toString()),i("Strike",null==c.cv?null:c.cv.toString()),i("Strong",null==c.cw?null:c.cw.toString()),i("Style",null==c.cx?null:c.cx.toString()),i("Sub",null==c.cy?null:c.cy.toString()),i("Sup",null==c.cz?null:c.cz.toString()),i("Tables",null==c.da?null:c.da.toString()),i("Tbody",null==c.db?null:c.db.toString()),i("Td",null==c.dc?null:c.dc.toString()),i("Textarea",null==c.dd?null:c.dd.toString()),i("Tfoot",null==c.de?null:c.de.toString()),i("Th",null==c.df?null:c.df.toString()),i("Thead",null==c.dg?null:c.dg.toString()),i("Title",null==c.dh?null:c.dh.toString()),i("Tr",null==c.di?null:c.di.toString()),i("Tt",null==c.dj?null:c.dj.toString()),i("U",null==c.dk?null:c.dk.toString()),i("Ul",null==c.dl?null:c.dl.toString()),i("Var",null==c.dm?null:c.dm.toString()),i("Unknown",null==c.dn?null:c.dn.toString());break;case 6:var d=t;r="List",i("SessionID",d.a),i("MaxListLevel",d.b.toString())}return n.Table=r,Sys.Serialization.JavaScriptSerializer.serialize(n)},e}();(0,r.l)(o,"e7f4edf4$UsageDataSerialization",null,[]);var a=n(3116),l=n(4631);n.d(t,{z:function(){return s}});var s=function(){function e(){}return e.get_IsLoggingDisabled=function(){return null==e._isLoggingDisabled&&(e._isLoggingDisabled=!!a.AFrameworkApplication.appSettingsManager&&a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UsageEditorLoggingIsDisabled")),e._isLoggingDisabled},e.get_IsLoggingEnabledWord=function(){return null==e._isLoggingEnabledWord&&(e._isLoggingEnabledWord=!!a.AFrameworkApplication.appSettingsManager&&a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordUsageEditorLoggingIsEnabled")),e._isLoggingEnabledWord},e.LogUsageData=function(e){i.ULS.sendTraceTag(5822145,307,50,e)},e.getHtmlProcessorUsageDataInstance=function(e){var t={};return t.a=e,t.b=0,t.c=0,t.d=0,t.e=0,t.f=0,t},e.logHtmlProcessorUsageData=function(t){e.get_IsLoggingDisabled()||e.LogUsageData(o.serializeUsageData(0,t))},e.getWordConverterUsageDataInstance=function(e){var t={};return t.a=e,t.b=0,t.c=0,t},e.logWordConverterUsageData=function(t){e.get_IsLoggingDisabled()||e.LogUsageData(o.serializeUsageData(1,t))},e.getHtmlEventUsageDataInstance=function(e,t){var n={};return n.c=l.h[e],n.a=t,n},e.logHtmlEventsUsageData=function(t){e.get_IsLoggingEnabledWord()&&e.LogUsageData(o.serializeUsageData(5,t))},e.getSemanticEventsUsageDataInstance=function(e){var t={};return t.a=e,t.b=0,t.c=0,t.d=0,t.e=0,t.f=0,t.g=0,t.h=0,t.i=0,t.j=0,t.k=0,t.l=0,t.m=0,t},e.logSemanticEventsUsageData=function(t){e.get_IsLoggingDisabled()||e.LogUsageData(o.serializeUsageData(3,t))},e.getSemanticTableEventsUsageDataInstance=function(e){var t={};return t.a=e,t.b=0,t.c=0,t.d=0,t.e=0,t},e.logSemanticTableEventsUsageData=function(t){e.get_IsLoggingDisabled()||e.LogUsageData(o.serializeUsageData(4,t))},e.getFormattingStewardUsageDataInstance=function(e){var t={};return t.a=e,t.b=0,t.c=0,t.d=0,t.e=0,t.f=0,t.g=0,t.h=0,t.i=0,t.j=0,t.k=0,t.l=0,t.m=0,t.n=0,t.o=0,t.p=0,t.q=0,t.r=0,t.u=0,t.v=0,t.w=0,t.x=0,t.s=0,t.t=0,t},e.logFormattingStewardUsageData=function(t){e.get_IsLoggingDisabled()||e.LogUsageData(o.serializeUsageData(2,t))},e.getListUsageDataInstance=function(e){var t={};return t.a=e,t.b=-1,t},e.logListUsageData=function(t){!e.get_IsLoggingDisabled()&&t&&t.b>=0&&e.LogUsageData(o.serializeUsageData(6,t))},e._isLoggingDisabled=null,e._isLoggingEnabledWord=null,e}();(0,r.l)(s,"cd5d0f72$UsageEditor",null,[])},7543:function(e,t,n){"use strict";n.d(t,{j:function(){return o}});var i=n(7560),r=n(4115),o=function(){function e(){}return e.get_AutoCorrectListFallbackTable=function(){return e._autoCorrectListFallbackTable||(e._autoCorrectListFallbackTable=[],e.MapCultureLanguageIdToCultureLcid(i.i.getCultureInfo("ar-sa")),e.MapCultureLanguageIdToCultureLcid(i.i.getCultureInfo("de-de")),e.MapCultureLanguageIdToCultureLcid(i.i.getCultureInfo("es-es")),e.MapCultures(i.i.getCultureInfo("en-029"),i.i.getCultureInfo("en-us")),e.MapCultures(i.i.getCultureInfo("en-au"),i.i.getCultureInfo("en-us")),e.MapCultures(i.i.getCultureInfo("en-bz"),i.i.getCultureInfo("en-us")),e.MapCultures(i.i.getCultureInfo("en-ca"),i.i.getCultureInfo("en-us")),e.MapCultures(i.i.getCultureInfo("en-gb"),i.i.getCultureInfo("en-us")),e.MapCultures(i.i.getCultureInfo("en-id"),i.i.getCultureInfo("en-us")),e.MapCultures(i.i.getCultureInfo("en-my"),i.i.getCultureInfo("en-us")),e.MapCultures(i.i.getCultureInfo("en-ph"),i.i.getCultureInfo("en-us")),e.MapCultures(i.i.getCultureInfo("zh-tw"),i.i.getCultureInfo("en-us")),e.MapCultureLanguageIdToCultureLcid(i.i.getCultureInfo("fr-fr")),e.MapCultures(i.i.getCultureInfo("hr-ba"),i.i.getCultureInfo("hr-hr")),e.MapCultures(i.i.getCultureInfo("it-ch"),i.i.getCultureInfo("it-it")),e.MapCultures(i.i.getCultureInfo("nb-no"),i.i.getCultureInfo("nn-no")),e.MapCultureLanguageIdToCultureLcid(i.i.getCultureInfo("nl-nl")),e.MapCultures(i.i.getCultureInfo("ro-md"),i.i.getCultureInfo("ro-ro")),e.MapCultures(i.i.getCultureInfo("ru-md"),i.i.getCultureInfo("ru-ru")),e.MapCultures(i.i.getCultureInfo("sr-latn-ba"),i.i.getCultureInfo("sr-latn-cs")),e.MapCultures(i.i.getCultureInfo("sr-latn-me"),i.i.getCultureInfo("sr-latn-cs")),e.MapCultures(i.i.getCultureInfo("sr-latn-rs"),i.i.getCultureInfo("sr-latn-cs")),e.MapCultureLanguageIdToCultureLcid(i.i.getCultureInfo("sr-cyrl-cs")),e.MapCultures(i.i.getCultureInfo("sv-fi"),i.i.getCultureInfo("sv-se"))),e._autoCorrectListFallbackTable},e.MapCultureLanguageIdToCultureLcid=function(t){e._autoCorrectListFallbackTable[t.get_languageId()]=t.get_LCID()},e.UnmapCulture=function(t){e._autoCorrectListFallbackTable[t.get_LCID()]=t.get_LCID()},e.MapCultures=function(t,n){e._autoCorrectListFallbackTable[t.get_LCID()]=n.get_LCID()},e.GetFallbackLcid=function(t){var n=i.i.getCultureInfo(t);if(!n)return 0;var r=e.get_AutoCorrectListFallbackTable()[n.get_LCID()]||e.get_AutoCorrectListFallbackTable()[n.get_languageId()]||0;return r===t?0:r},e._autoCorrectListFallbackTable=null,e}();(0,r.l)(o,"c7c345d7$AutoCorrectListFallback",null,[])},7629:function(e,t,n){"use strict";n.d(t,{l:function(){return g}});var i=n(1817),r=n(8202),o=n(9375),a=n(8548),l=n(9368),s=n(7275),u=n(654),c=n(8399),d=n(4115),g=function(e){function t(t,n,i,r,o,a){return e.call(this,t,n,i,r,o,a)||this}return(0,i.t)(t,e),t.prototype.get_commandId=function(){return o.u.autoCorrectLetterList},t.prototype.doGraphCorrection=function(e){if(this.get_listCommands()){var n=u.g.createFromNode(e);if(n.tryToRootAtOutlineAncestor(),l.OutlineElementNavigator.returnToOutlineElement(n),this.get_listEditor().shouldAutocorrectList(n)){var i=this.matchResults[0],r=a.l.isUpperCase(i.charAt(0)),o=t.NumberFromLetterString(i),c=r?4:2,d=s.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchEndIndex()+1);this.get_listEditor().autocorrectNumberList(e,n,c,o,d,i,this.get_listCommands())}}},t.CreateGraphCorrectionAction=function(e,n,i,r,o,a){return new t(null,e,n,i,r,o)},t.CreateHtmlCorrectionAction=function(e,n,i,r,o,a){return new t(e,c.j.getOwner(e).get_sourceNode(),n,i,r,o)},t.NumberFromLetterString=function(e){if(!e)return 0;var t=a.l.toLower(e);t.charAt(0);if(!a.l.isAlpha(t.charAt(0)))return 0;var n,i=t.charCodeAt(0)-"a".charCodeAt(0)+1;for(n=1;n<t.length&&t.charAt(n)===t.charAt(0);n++);return 26*(n-1)+i},t}(r.n);(0,d.l)(g,"9f40fcca$LetterListAction",r.n,[])},7953:function(e,t,n){"use strict";n.d(t,{r:function(){return d}});var i=n(1817),r=n(8202),o=n(9375),a=n(9368),l=n(7275),s=n(654),u=n(8399),c=n(4115),d=function(e){function t(t,n,i,r,o,a){return e.call(this,t,n,i,r,o,a)||this}return(0,i.t)(t,e),t.prototype.get_commandId=function(){return o.u.autocorrectNumberList},t.prototype.doGraphCorrection=function(e){if(this.get_listCommands()){var t=s.g.createFromNode(e);if(t.tryToRootAtOutlineAncestor(),a.OutlineElementNavigator.returnToOutlineElement(t),this.get_listEditor().shouldAutocorrectList(t)){var n=this.matchResults[0],i=parseInt(n);if(!(i>=99999999)){var r=l.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchEndIndex()+1);this.get_listEditor().autocorrectNumberList(e,t,1,i,r,n,this.get_listCommands())}}}},t.CreateGraphCorrectionAction=function(e,n,i,r,o,a){return new t(null,e,n,i,r,o)},t.CreateHtmlCorrectionAction=function(e,n,i,r,o,a){return new t(e,u.j.getOwner(e).get_sourceNode(),n,i,r,o)},t}(r.n);(0,c.l)(d,"f13ce5d7$NumberListAction",r.n,[])},7979:function(e,t,n){"use strict";n.d(t,{q:function(){return i}});var i=(0,n(4115).y)("2e649b80$IFormattingSteward")},8202:function(e,t,n){"use strict";n.d(t,{n:function(){return c}});var i=n(1817),r=n(4355),o=n(4561),a=n(9233),l=n(9375),s=n(6325),u=n(4115),c=function(e){function t(t,n,i,r,o,a){var l=e.call(this,t,n,i,r,a)||this;return l._listCommands=null,l._characterPropertiesEditor$1=null,l.matchResults=null,l.matchResults=o,l._characterPropertiesEditor$1=a,l}return(0,i.t)(t,e),t.prototype.get_listCommands=function(){return this._listCommands||(this._listCommands=s.w.get_instance().tryResolve(r.c))},t.prototype.get_listEditor=function(){return t._listEditor||(t._listEditor=s.w.get_instance().resolve(o.v))},t.prototype.get_isGraphOnlyOperation=function(){return!0},t.prototype.get_commandId=function(){return l.u.autoCorrectRegexCorrect},t._listEditor=null,t}(a.z);(0,u.l)(c,"fe8cca85$RegexCorrectAction",a.z,[])},8207:function(e,t,n){"use strict";n.d(t,{l:function(){return c}});var i=n(1817),r=n(9233),o=n(9375),a=n(8548),l=n(7275),s=n(8399),u=n(4115),c=function(e){function t(t,n,i,r,o,a,l,s){var u=e.call(this,t,n,i,r,o)||this;return u._characterPropertiesEditor$1=null,u._lockedRangeEditor=null,u._isLockedRangesEnabled=!1,u._trackChangeReader=null,u._characterPropertiesEditor$1=o,u._lockedRangeEditor=a,u._isLockedRangesEnabled=l,u._trackChangeReader=s,u}return(0,i.t)(t,e),t.prototype.get_isGraphOnlyOperation=function(){return!0},t.prototype.get_commandId=function(){return o.u.autoCorrectUpperFirstLetter},t.prototype.doHtmlCorrection=function(e){var t=a.l.substring(e.innerText,this.get_matchStartIndex(),this.get_matchEndIndex());t.charAt(0)!==t.charAt(0).toUpperCase()&&(t=t.charAt(0).toUpperCase()+t.substring(1,t.length)),e.innerText=a.l.substring(e.innerText,0,this.get_matchStartIndex())+t+a.l.right(e.innerText,this.get_matchEndIndex())},t.prototype.doGraphCorrection=function(e){var t=this.get_matchStartIndex(),n=this.get_matchStartIndex()+1,i=e.get_characterData().substring(t,n).charAt(0);if(!a.l.isUpperCase(i)){var r=l.y.createTextRange(e,t,n);this.IsContextInLockedRange(r)||this._trackChangeReader&&this._trackChangeReader.isTextRangeInsideDeletionChange(e,t,n)||this._characterPropertiesEditor$1.replaceTextRange(r,i.toUpperCase().toString(),!0,!1)}},t.prototype.IsContextInLockedRange=function(e){return!!this._isLockedRangesEnabled&&(!!this._lockedRangeEditor&&this._lockedRangeEditor.isIpOrTextRangeContextInLockedRange(e))},t.CreateHtmlCorrectionAction=function(e,n,i,r){var o=s.j.getOwner(e);return new t(e,o?o.get_sourceNode():null,n,i,r,null,!1,null)},t.CreateGraphCorrectionAction=function(e,n,i,r,o,a,l){return new t(null,e,n,i,r,o,a,l)},t}(r.z);(0,u.l)(c,"cb71637f$UpperFirstLetterAutoCorrect",r.z,[])},8279:function(e,t,n){"use strict";n.d(t,{h:function(){return s}});var i=n(4115),r=n(2927),o=n(3116),a=n(6121),l=n(577),s=function(){function e(e){this._audioStream=null,this._recorder=null,this._context=null,this._audioFileUploader=null,this._blob=null,this._audioFileUploader=e}return e.prototype.startRecording=function(t,n){(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia).bind(navigator)({audio:!0},function(i){this._audioStream=i;var r=window.AudioContext||window.webkitAudioContext;this._context=this._context||new r;var o=this._context.createMediaStreamSource(i);this._recorder=new Recorder(o,{workerPath:window.URL.createObjectURL(new Blob([n],{type:"application/javascript"})),numChannels:e.NumChannels}),this._recorder.record(),t(!0,null)}.bind(this),function(e){t(!1,e)}.bind(this))},e.prototype.getSupportedMaxDuration=function(){if(!this._audioStream||!this._recorder||!this._context)return 0;var t=this._context.sampleRate,n=o.AFrameworkApplication.appSettingsManager.getIntAppSetting("OneNoteInsertFileMaxSize",0),i=e.PCM16BitsBytesPerSample*t*e.NumChannels;return(1024*n-e.PCM16BitsHeaderSizeinBytes)/i},e.prototype.stopRecording=function(){if(this._audioStream&&this._recorder){this._audioStream.getAudioTracks()[0].stop(),this._recorder.stop();var e=i.i(this,this.exportWav,"exportWav");this._recorder.exportWAV(e),this.clearRecording()}},e.prototype.clearRecording=function(){this._recorder&&this._recorder.clear()},e.prototype.exportWav=function(e){this._blob=e,this.UploadBlob()},e.prototype.UploadBlob=function(){this._audioFileUploader.get_uploadState()?2===this._audioFileUploader.get_uploadState()?(r.ULS.sendTraceTag(9213718,339,50,"AudioRecording:Stop:Upload:Start"),this._audioFileUploader.upload(this._blob)):window.setTimeout(i.i(this,this.UploadBlob,"UploadBlob"),1e3):r.ULS.sendTraceTag(9213717,339,50,"AudioRecording:Stop:Upload:Cancelled")},e.showRecordingFailedUploadError=function(){var e=new a.StandardDialog;e.set_buttonsOption(0),e.showError(l.o.recordingFailedUpload,OneNoteIntl.OneNoteStrings.L_RecordingFailedUploadTitle,OneNoteIntl.OneNoteStrings.L_RecordingFailedUpload,null,!0)},e.NumChannels=1,e.PCM16BitsHeaderSizeinBytes=44,e.PCM16BitsBytesPerSample=2,e}();(0,i.l)(s,"e2dd7316$AudioRecorder",null,[])},8901:function(e,t,n){"use strict";n.d(t,{m:function(){return i}});var i=(0,n(4115).y)("e0297f87$IViewerChromeItemContainer")},9233:function(e,t,n){"use strict";n.d(t,{z:function(){return _}});var i=n(3361),r=n(1838),o=n(8548),a=n(4670),l=n(4392),s=n(3285),u=n(4841),c=n(6596),d=n(3315),g=n(3910),p=n(2442),h=n(4115),_=function(){function e(e,t,n,i,r){this._isFired=!1,this._htmlTarget=null,this._graphTarget=null,this._matchStartIndex=0,this._matchEndIndex=0,this._originalString=null,this._lengthChange=0,this._graphSelection=null,this._selectionSet=!1,this._needToCheckOriginalString=!0,this._characterPropertiesEditor=null,this._lastValidateResultIsValid=!0,this._invalidReason=null,this._lastValidateResultIsMatchTextSame=!0,this._htmlTarget=e,this._graphTarget=t,this._matchStartIndex=n,this._matchEndIndex=i,this._characterPropertiesEditor=r,this._originalString=e?e.innerText:g.ParagraphReader.text(t)}return e.prototype.get_isGraphOnlyOperation=function(){throw Error.notImplemented("The inherit class should have the default value.")},e.prototype.set_isGraphOnlyOperation=function(e){return e},e.prototype.get_lengthChange=function(){return this._lengthChange},e.prototype.set_lengthChange=function(e){return this._lengthChange=e,e},e.prototype.get_currentSelection=function(){return this._graphSelection},e.prototype.set_currentSelection=function(e){return this._graphSelection=e,e},e.prototype.get_htmlTarget=function(){return this._htmlTarget},e.prototype.get_graphTarget=function(){return this._graphTarget},e.prototype.get_matchStartIndex=function(){return this._matchStartIndex},e.prototype.get_matchEndIndex=function(){return this._matchEndIndex},e.prototype.get_needToCheckOriginalString=function(){return this._needToCheckOriginalString},e.prototype.set_needToCheckOriginalString=function(e){return this._needToCheckOriginalString=e,e},e.prototype.get_isFired=function(){return this._isFired},e.prototype.get_isUndoableByBackspace=function(){return!1},e.prototype.get_OriginalString=function(){return this._originalString},e.prototype.setNewSelection=function(e){this._selectionSet=!0,this._graphSelection=e},e.prototype.invoke=function(){if(this._isFired=!0,this._htmlTarget&&this._htmlTarget.parentNode&&!this.get_isGraphOnlyOperation()){var t=this._htmlTarget.innerText;return this.get_needToCheckOriginalString()&&o.l.substring(this._originalString,this._matchStartIndex,this._matchEndIndex)!==o.l.substring(t,this._matchStartIndex,this._matchEndIndex)?0:(this.doHtmlCorrection(this._htmlTarget),this.set_lengthChange(this._htmlTarget.innerText.length-t.length),1)}if(this._lastValidateResultIsMatchTextSame||r.y.get_instance().recordEvent("MatchTextIsNotTheSame",{Reason:"MatchTextIsNotTheSame"}),!this._lastValidateResultIsValid)return r.y.get_instance().recordEvent("AbortedAction",{Reason:this._invalidReason}),0;var n=(t=g.ParagraphReader.text(this._graphTarget)).length,i=this._originalString.length,d=o.l.substring(this._originalString,this._matchStartIndex,this._matchEndIndex).trimEnd(),h=o.l.substring(t,this._matchStartIndex,this._matchEndIndex).trimEnd();if(d===h&&this._matchEndIndex>i&&(this._matchEndIndex=i),this.get_needToCheckOriginalString()&&d!==h){var _=d.replace(new RegExp('"',"g"),"");if(_!==o.l.substr(h,0,_.length))return 0;this._matchEndIndex-=2}if(p.n.get_instance().get_item(50)&&a.App.get_theCoauthManager().get_isCoauthorable()&&l.CoauthLockEditor.getInstance().shouldLockBlockEditing(e.get_LockedRangeEditor().getCoauthLockForParagraphOrImage(this._graphTarget)))return 0;var m=new s.GraphTransaction(15);if(m.setFromNode(this._graphTarget),m.set_undoActionId(this.get_commandId()),this.doGraphCorrection(this._graphTarget),this.set_lengthChange(g.ParagraphReader.textLength(this._graphTarget)-n),this._graphSelection&&!this._selectionSet&&u.SelectionEditor.isInsertionPointSelection(this._graphSelection)){var f=this._graphSelection.get_firstContext(),y=f.get_cpBegin(),C=f.get_cpEnd(),S=f.get_node();S===this._graphTarget&&this.get_lengthChange()&&(y>=this._matchEndIndex&&(y+=this.get_lengthChange()),C>=this._matchEndIndex&&(C+=this.get_lengthChange()),this._graphSelection=c.SelectionFactory.createTextRangeOrIpSelection(S,y,C))}return m.dispose(),2},e.prototype.validateAction=function(){return this._lastValidateResultIsMatchTextSame=this.checkMatchTextIsTheSame(),!0},e.prototype.doHtmlCorrection=function(e){},e.prototype.checkMatchTextIsTheSame=function(){var e=g.ParagraphReader.text(this._graphTarget);return o.l.substring(this._originalString,this._matchStartIndex,this._matchEndIndex).trimEnd()===o.l.substring(e,this._matchStartIndex,this._matchEndIndex).trimEnd()},e.get_LockedRangeEditor=function(){return d.k.get_instance()},e}();(0,h.l)(_,"752556a7$AutoCorrectAction",null,[i.c])},9369:function(e,t,n){"use strict";n.d(t,{h:function(){return v}});var i=n(4115),r=n(4232),o=n(3660),a=n(2927),l=n(7386),s=n(3116),u=n(3213),c=n(6121),d=n(5538),g=n(8541),p=n(6325),h=n(8730),_=n(4670),m=n(577),f=n(4841),y=n(2280),C=n(9192),S=n(5309),b=n(8279),v=function(){function e(e,t){this._recordingGlyph=null,this._recordingWillStopWarning=null,this._audioFileUploader=null,this._fileEditor=null,this._permissionDeniedDialog=null,this._deviceNotFoundDialog=null,this._isRecordingPromptShowing=!1,this._isRecording=!1,this._isLibraryLoaded=!1,this._startTime=0,this._workerScriptText=null,this._maxDuration=0,this._audioRecorder=p.w.get_instance().tryResolve(b.h),this._recordingLengthTimer=-1,this._audioFileUploader=e,this._fileEditor=t}return e.prototype.get_maxDuration=function(){if(!this._maxDuration){var e=s.AFrameworkApplication.appSettingsManager.getIntAppSetting("OneNoteAudioRecordingMaxDuration",207);this._audioRecorder?this._maxDuration=Math.max(e,Math.floor(this._audioRecorder.getSupportedMaxDuration())):this._maxDuration=e,this._maxDuration-=1}return this._maxDuration},e.prototype.get_isRecording=function(){return this._isRecording||!!this._audioFileUploader.get_uploadState()},e.prototype.get_recordingDuration=function(){return this._startTime?((new Date).getTime()-this._startTime)/1e3:0},e.prototype.get_IsPermissionDeniedDialogShowing=function(){return!!this._permissionDeniedDialog&&this._permissionDeniedDialog.get_isShowing()},e.prototype.get_IsDeviceNotFoundDialogShowing=function(){return!!this._deviceNotFoundDialog&&this._deviceNotFoundDialog.get_isShowing()},e.prototype.registerActions=function(e){e.addAction(l.u.recordAudio,y.d.view,i.i(this,this.RecordAudio,"RecordAudio")),e.addAction(l.u.recordAudio,y.d.insertionPoint,i.i(this,this.RecordAudio,"RecordAudio")),e.setActionFlags(l.u.recordAudio,4),e.addAction(l.u.stopAudioRecording,y.d.view,i.i(this,this.StopAudioRecording,"StopAudioRecording")),e.setActionFlags(l.u.stopAudioRecording,4),e.addAction(l.u.cancelAudioRecording,y.d.view,i.i(this,this.CancelAudioRecording,"CancelAudioRecording")),e.setActionFlags(l.u.cancelAudioRecording,4)},e.prototype.RecordAudio=function(e,t,n,i,r){var o=this;if(1===n){var l=t.get_nextContext();if(!l||!f.SelectionEditor.isInsertionPointContext(l))return 2;var u=this._fileEditor.canInsertFileInContext(t);return this.get_isRecording()||!u||this._isRecordingPromptShowing||this.get_IsPermissionDeniedDialogShowing()||this.get_IsDeviceNotFoundDialogShowing()?8:32}if(2===n){if(a.ULS.sendTraceTag(9213704,339,50,"AudioRecording:Start:Click"),s.AFrameworkApplication.limitedEdit)return s.AFrameworkApplication.showRequiresSignInDialog(),32;if(this._isLibraryLoaded)this.StartRecording(t);else{var c=s.AFrameworkApplication.scriptUrlFromName("recorder.min.js",5),p=g.v.create(c);p.add_loadFinished((function(e,n){o.StartRecording(t,e,n)})),d.z.enqueueResourceWithoutEnabling(p)}return 32}return 8},e.prototype.StartRecording=function(e,t,n){var r=this;void 0===t&&(t=null),void 0===n&&(n=null),this._isLibraryLoaded=!0,this._workerScriptText?(this._isRecordingPromptShowing=!0,a.ULS.sendTraceTag(9213705,339,50,"AudioRecording:Start:Start"),this._audioRecorder.startRecording(i.i(this,this.AudioRecordingStartedCallback,"AudioRecordingStartedCallback"),this._workerScriptText),this._audioFileUploader.createPlaceholder(e)):this.RequestWorkerScriptAndInvoke((function(){r.StartRecording(e,t,n)}))},e.prototype.StopAudioRecording=function(t,n,i,r,o){if(1===i)return this._isRecording&&this._startTime>0?32:8;if(2===i){a.ULS.sendTraceTag(9213706,339,50,"AudioRecording:Stop:Click"),this._audioRecorder.stopRecording();var l=((new Date).getTime()-this._startTime)/1e3;return l>this.get_maxDuration()-e.WarningDuration&&e.ShowRecordingLengthWarning(this.get_maxDuration()),this.ResetRecordingUI(),a.ULS.sendTraceTag(9213707,339,50,"AudioRecording:Duration:{0}",l),32}return 8},e.prototype.CancelAudioRecording=function(e,t,n,i,o){return 2===n?(0,r.e)(C.k,o)!==this._audioFileUploader.get_placeholder()?8:(this._audioFileUploader.reset(),this._audioRecorder.clearRecording(),this.ResetRecordingUI(),a.ULS.sendTraceTag(9246720,339,50,"AudioRecording:Cancel"),32):8},e.prototype.AddAudioRecordingGlyphToRibbonTab=function(){var e=document.getElementById("ContextualTabs.Audio.Tools-title");if(e){var t=e.getElementsByTagName("a")[0];if(!this._recordingGlyph){this._recordingGlyph=t.ownerDocument.createElement("span"),this._recordingGlyph.className="clip16x16 RibbonRecordingGlyph";var n=t.ownerDocument.createElement("img");n.className=u.ImageClusteringHelper.getImageClassWithCluster(s.AFrameworkApplication.get_imageClusterName(),"JotAudioStartRecording_16x16x32"),n.src=s.AFrameworkApplication.get_imageClusterPath(),this._recordingGlyph.appendChild(n)}t.insertBefore(this._recordingGlyph,t.firstChild)}},e.prototype.RemoveAudioRecordingGlyphFromRibbonTab=function(){var e=document.getElementById("ContextualTabs.Audio.Tools-title");if(e&&this._recordingGlyph){var t=e.getElementsByTagName("a")[0];t&&t.contains(this._recordingGlyph)&&t.removeChild(this._recordingGlyph)}},e.prototype.RecordingLengthTick=function(){if(this.get_recordingDuration()<this.get_maxDuration()){var t=Math.round(this.get_maxDuration()-this.get_recordingDuration());t<=e.WarningDuration&&(this._recordingWillStopWarning?this._recordingWillStopWarning.set_message(String.format(OneNoteIntl.OneNoteStrings.L_RecordingWillStop,t)):(this._recordingWillStopWarning=_.App.get_activeAppFrame().get_notificationBar().createEntry(String.format(OneNoteIntl.OneNoteStrings.L_RecordingWillStop,t),!0),this._recordingWillStopWarning.set_image(5),this._recordingWillStopWarning.set_imagePath("JotAudioStartRecording_16x16x32"),_.App.get_activeAppFrame().get_notificationBar().addEntry(this._recordingWillStopWarning))),_.App.get_activeAppFrame().updateCommandUI(),this._recordingLengthTimer=window.setTimeout(i.i(this,this.RecordingLengthTick,"RecordingLengthTick"),1e3)}else this.CancelRecordingLengthTimer(),a.ULS.sendTraceTag(9213708,339,50,"AudioRecording:Timeout"),s.AFrameworkApplication.get_theActionManager().processAction(l.u.stopAudioRecording,2)},e.prototype.CancelRecordingLengthTimer=function(){var e=this;this._recordingWillStopWarning&&(_.App.get_activeAppFrame().get_notificationBar().removeEntry(this._recordingWillStopWarning),this._recordingWillStopWarning=null),h.n.cancelPendingTimeout((0,o.m)((function(){return e._recordingLengthTimer}),(function(t){return e._recordingLengthTimer=t})))},e.prototype.ShowRecordingPermissionsDeniedError=function(){this._permissionDeniedDialog=new c.StandardDialog,this._permissionDeniedDialog.set_buttonsOption(0),this._permissionDeniedDialog.showError(m.o.recordingDeniedPermissions,OneNoteIntl.OneNoteStrings.L_RecordingDeniedPermissionsTitle,OneNoteIntl.OneNoteStrings.L_RecordingDeniedPermissions,null,!0)},e.prototype.ShowRecordingDeviceNotFoundError=function(){this._deviceNotFoundDialog=new c.StandardDialog,this._deviceNotFoundDialog.set_buttonsOption(0),this._deviceNotFoundDialog.showError(m.o.recordingDeviceNotFound,OneNoteIntl.OneNoteStrings.L_RecordingDeniedPermissionsTitle,OneNoteIntl.OneNoteStrings.L_RecordingDeviceNotFound,null,!0)},e.prototype.AudioRecordingStartedCallback=function(t,i){if(this._isRecordingPromptShowing=!1,this._audioFileUploader.get_uploadState())if(t)this._isRecording=!0,e.ActivateAudioToolsRibbonTab(),this.AddAudioRecordingGlyphToRibbonTab(),s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioPlaybackIsEnabled")&&p.w.get_instance().resolve(n(2310).AudioPlaybackActor).unattachAudioPlaybackControls(),a.ULS.sendTraceTag(9213710,339,50,"AudioRecording:Start:Success"),this._startTime=(new Date).getTime(),this.RecordingLengthTick(),_.App.get_activeAppFrame().forceUpdateCommandUI();else{var r=i.name;a.ULS.sendTraceTag(9213709,339,50,"AudioRecording:Start:Failed:{0}",r),"PermissionDeniedError"===r||"NotAllowedError"===r?this.ShowRecordingPermissionsDeniedError():"NotFoundError"===r&&this.ShowRecordingDeviceNotFoundError(),this._audioFileUploader.reset(),this._audioRecorder.clearRecording(),this.ResetRecordingUI()}else this._audioRecorder.clearRecording(),_.App.get_activeAppFrame().forceUpdateCommandUI()},e.prototype.ResetRecordingUI=function(){this.RemoveAudioRecordingGlyphFromRibbonTab(),this.CancelRecordingLengthTimer(),this._isRecording=!1,this._startTime=0,_.App.get_activeAppFrame().forceUpdateCommandUI()},e.prototype.RequestWorkerScriptAndInvoke=function(e){var t=this,n=s.AFrameworkApplication.scriptUrlFromName("recorderWorker.min.js",5),i=new XMLHttpRequest;i.open("GET",n,!0),i.onreadystatechange=function(){4===i.readyState&&200===i.status?(t._workerScriptText=i.responseText,e()):a.ULS.sendTraceTag(17584719,339,15,"AudioRecording:RequestWorkerScriptAndInvoke:Fail")},i.send()},e.ActivateAudioToolsRibbonTab=function(){var e=S.n.getOneNoteBox4BridgeCommandUi();e.isRibbonMinimized((function(t){t&&e.ribbonToggleMinimizedState(2)})),e.ribbonActivateTab("ContextualTabs.Audio.Tools")},e.ShowRecordingLengthWarning=function(e){var t=_.App.get_activeAppFrame().get_notificationBar().createEntry(String.format(OneNoteIntl.OneNoteStrings.L_RecordingTimeLimit,e),!1);t.set_image(3),_.App.get_activeAppFrame().get_notificationBar().addEntry(t)},e.WarningDuration=15,e}();(0,i.l)(v,"4932309$AudioRecordingActor",null,[])},9394:function(e,t,n){"use strict";var i=n(1527),r=n(6315),o=n(5315),a=n(2988),l=n(2846),s=n(4821),u=n(1582),c=n(5429),d=n(4115),g=(0,d.y)("46af2774$IBox4PasteSteward"),p=n(2743),h=n(5487),_=n(9126),m=n(9062),f=n(3116),y=n(7560),C=n(6325),S=n(7118),b=n(8978),v=n(1817),T=(0,d.y)("906e84b1$IFormattingSteward"),A=n(7979),I=function(){function e(e,t){void 0===t&&(t=null),this.nextSteward=null,this.usageData=null,this.nextSteward=e,this.usageData=t||S.z.getFormattingStewardUsageDataInstance("")}return e.prototype.get_nextSteward=function(){return this.nextSteward},e.prototype.get_usageData=function(){return this.usageData},e.prototype.setLang=function(e){return this.get_usageData().b++,this.get_nextSteward().setLang(e)},e.prototype.setTextDir=function(e){return this.get_usageData().c++,this.get_nextSteward().setTextDir(e)},e.prototype.setBold=function(e){return this.get_usageData().d++,this.get_nextSteward().setBold(e)},e.prototype.setItalics=function(e){return this.get_usageData().f++,this.get_nextSteward().setItalics(e)},e.prototype.setUnderline=function(e){return this.get_usageData().g++,this.get_nextSteward().setUnderline(e)},e.prototype.setStrikethrough=function(e){return this.get_usageData().h++,this.get_nextSteward().setStrikethrough(e)},e.prototype.setSubscript=function(e){return this.get_usageData().i++,this.get_nextSteward().setSubscript(e)},e.prototype.setSuperscript=function(e){return this.get_usageData().j++,this.get_nextSteward().setSuperscript(e)},e.prototype.setFontsize=function(e){return this.get_usageData().k++,this.get_nextSteward().setFontsize(e)},e.prototype.setFontface=function(e,t){return void 0===t&&(t=!1),this.get_usageData().l++,this.get_nextSteward().setFontface(e,t)},e.prototype.growFontsize=function(){return this.get_usageData().m++,this.get_nextSteward().growFontsize()},e.prototype.shrinkFontsize=function(){return this.get_usageData().n++,this.get_nextSteward().shrinkFontsize()},e.prototype.setFontColor=function(e){return this.get_usageData().o++,this.get_nextSteward().setFontColor(e)},e.prototype.setFontHighlight=function(e){return this.get_usageData().p++,this.get_nextSteward().setFontHighlight(e)},e.prototype.setMath=function(e){return this.get_usageData().e++,this.get_nextSteward().setMath(e)},e.prototype.setTextCapsType=function(e){return this.get_nextSteward().setTextCapsType(e)},e.prototype.setParagraphStyleType=function(e){return this.get_usageData().q++,this.get_nextSteward().setParagraphStyleType(e)},e.prototype.setParagraphStyle=function(e){return this.get_usageData().q++,this.get_nextSteward().setParagraphStyle(e)},e.prototype.setCharacterStyle=function(e){return this.get_usageData().q++,this.get_nextSteward().setCharacterStyle(e)},e.prototype.setParagraphHeadingStyle=function(e){return this.get_usageData().q++,this.get_nextSteward().setParagraphHeadingStyle(e)},e.prototype.setTextAlign=function(e){return this.get_usageData().r++,this.get_nextSteward().setTextAlign(e)},e.prototype.setTextIndent=function(e){return this.get_usageData().s++,this.get_nextSteward().setTextIndent(e)},e.prototype.setMarginLeft=function(e){return this.get_usageData().t++,this.get_nextSteward().setMarginLeft(e)},e.prototype.setParagraphProperties=function(e){return this.get_nextSteward().setParagraphProperties(e)},e.prototype.setCellShadingColor=function(e){return this.get_usageData().x++,this.get_nextSteward().setCellShadingColor(e)},e.prototype.resetJustification=function(){return this.get_nextSteward().resetJustification()},e.prototype.setParagraphSpacing=function(e,t){return this.get_usageData().u++,this.get_usageData().v++,this.get_nextSteward().setParagraphSpacing(e,t)},e.prototype.setLineSpacing=function(e){return this.get_usageData().w++,this.get_nextSteward().setLineSpacing(e)},e.prototype.clearFormatting=function(){return this.get_nextSteward().clearFormatting()},e.prototype.clone=function(){return new e(this.get_nextSteward().clone(),this.get_usageData())},e}();(0,d.l)(I,"e408a2af$FormattingStewardUsageCollector",null,[A.q]);var w=function(e){function t(t,n){return void 0===n&&(n=null),e.call(this,t,n)||this}return(0,v.t)(t,e),t.prototype.get_NextBox4Steward=function(){return this.get_nextSteward()},t.prototype.get_justification=function(){return this.get_NextBox4Steward().get_justification()},t.prototype.set_justification=function(e){return this.get_NextBox4Steward().set_justification(e),e},t.prototype.get_textIndent=function(){return this.get_NextBox4Steward().get_textIndent()},t.prototype.get_marginLeft=function(){return this.get_NextBox4Steward().get_marginLeft()},t.prototype.get_paragraphSpacing=function(){return this.get_NextBox4Steward().get_paragraphSpacing()},t.prototype.get_lineSpacing=function(){return this.get_NextBox4Steward().get_lineSpacing()},t.prototype.get_specialIndent=function(){return this.get_NextBox4Steward().get_specialIndent()},t.prototype.get_leftIndent=function(){return this.get_NextBox4Steward().get_leftIndent()},t.prototype.get_paragraphProperties=function(){return this.get_NextBox4Steward().get_paragraphProperties()},t.prototype.get_paragraph=function(){return this.get_NextBox4Steward().get_paragraph()},t.prototype.set_paragraph=function(e){return this.get_NextBox4Steward().set_paragraph(e),e},t.prototype.get_formattingObject=function(){return this.get_NextBox4Steward().get_formattingObject()},t.prototype.get_tableFormattingProperties=function(){return this.get_NextBox4Steward().get_tableFormattingProperties()},t.prototype.tryApplyParagraphStyle=function(e){return this.get_NextBox4Steward().tryApplyParagraphStyle(e)},t.prototype.tryApplyCharacterStyle=function(e){return this.get_NextBox4Steward().tryApplyCharacterStyle(e)},t.prototype.clone=function(){return new t(this.get_nextSteward().clone(),this.get_usageData())},t}(I);(0,d.l)(w,"ef16f191$FormattingStewardUsageCollector",I,[T,A.q]);var x=n(3910),E=n(382),F=n(8661),P=n(2726),D=n(9368),R=n(24),M=n(8182),k=n(5885),N=n(3660),L=n(3992),B=n(1859),O=n(463),U=n(7093),H=n(2183),G=n(5004),W=n(8928),V=n(2601),$=n(3824),z=n(8548),K=n(4011),q=n(2442),j=n(7101),Q=n(3787),J=function(){function e(){}return e.yellow="FFFF00",e.lime="00FF00",e.aqua="00FFFF",e.fuchsia="FF00FF",e.blue="0000FF",e.red="FF0000",e.navy="000080",e.teal="008080",e.green="008000",e.purple="800080",e.maroon="800000",e.olive="808000",e.gray="808080",e.sliver="C0C0C0",e.black="000000",e}();(0,d.l)(J,"341320cc$FontHighlightColorEnum",null,[]);var X=n(4613),Y=n(7275),Z=n(1334),ee=n(6078),te=function(){function e(t,n,i,r,o,a,l,s,u,c){if(void 0===u&&(u=null),void 0===c&&(c=!1),this._paragraph=null,this._containerChp=null,this._paragraphStyleType=0,this._paragraphStyle=null,this._characterStyle=null,this._justification=0,this._textIndent=null,this._marginLeft=null,this._paragraphSpacing=null,this._lineSpacing=null,this._specialIndent=null,this._leftIndent=null,this._tableFormattingProperties=null,this._fontService=null,this._customFontService=null,this.$$pf_ParagraphProperties=null,this._formattingEditor=null,this._styleEditor=null,this._formattingReader=null,this._formattingStewardBridge=null,this._followDestinationFormattingPasteIsEnabled=!1,this.DefaultParagraphSpacingInPoints=K.Font.get_defaultSize()*e.ParagraphSpacingRatio,this.set_paragraph(t),this._formattingEditor=n,this._styleEditor=i,this._formattingReader=r,this._formattingStewardBridge=o,this._fontService=a,this._customFontService=l,this._followDestinationFormattingPasteIsEnabled=s,u)m.r.shipAssertTag(4223818,307,!!u._containerChp),this._containerChp=u._containerChp.cloneUnderDifferentParagraph(this.get_paragraph()),this._paragraphStyleType=u._paragraphStyleType,this._paragraphStyle=u._paragraphStyle,u._paragraphSpacing&&(this._paragraphSpacing=new Z.v,this._paragraphSpacing.afterSpacing.value=u._paragraphSpacing.afterSpacing.value,this._paragraphSpacing.beforeSpacing.value=u._paragraphSpacing.beforeSpacing.value),u._lineSpacing&&(this._lineSpacing=u._lineSpacing.clone()),this._justification=u._justification,this._tableFormattingProperties=u._tableFormattingProperties.clone(),this._textIndent=u._textIndent,this._marginLeft=u._marginLeft,this._specialIndent=u._specialIndent,this._leftIndent=u._leftIndent,u.get_paragraphProperties()&&this.set_paragraphProperties(u.get_paragraphProperties());else{this._containerChp=new Q.j(this.get_paragraph(),0),this._containerChp.set_formatting(new X.a(this._containerChp,G.h.get_nil()));var d=Y.y.createIpContextAtEndOfParagraph(t),g=this._formattingReader.getFormattingObject(d);this.SetDefaultLanguage(g),e.ShouldUseExistingFormatting(t)?(this._formattingStewardBridge.setFormattingsWithExistingFormatting(this._containerChp.get_formatting(),g,c),t.hasProperty(O.b.layoutAlignmentInParent)?this._justification=t.getValue(Number,O.b.layoutAlignmentInParent):this._justification=0):this._justification=-1,this._paragraphStyleType=0,this._paragraphStyle=null,this._paragraphSpacing=this.GetDefaultParagraphSpacing(),this._followDestinationFormattingPasteIsEnabled&&(this._paragraphSpacing=this._formattingStewardBridge.getParagraphSpacing(t),this._lineSpacing=this._formattingStewardBridge.getLineSpacing(t),this._specialIndent=this._formattingStewardBridge.getSpecialIndent(t),this._leftIndent=this._formattingStewardBridge.getLeftIndent(t)),this._tableFormattingProperties=new W.DictionaryPropertySet,this._formattingStewardBridge.setDefaultFormattings(this._containerChp.get_formatting(),t,c)}}return e.prototype.get_paragraph=function(){return this._paragraph},e.prototype.set_paragraph=function(e){return m.r.shipAssertTag(4223816,307,!!e&&x.ParagraphReader.isParagraphNode(e)),this._paragraph=e,e},e.prototype.get_formattingObject=function(){return this._containerChp.get_formatting()},e.prototype.get_ParagraphStyleTypeValue=function(){return this._paragraphStyleType},e.prototype.get_ParagraphStyleValue=function(){return this._paragraphStyle},e.prototype.get_CharacterStyle=function(){return this._characterStyle},e.prototype.get_justification=function(){return this._justification},e.prototype.set_justification=function(e){return m.r.shipAssertTag(4223817,307,1===e||2===e||3===e||q.n.get_instance().get_item(54)&&6===e),this._justification=e,e},e.prototype.get_textIndent=function(){return this._textIndent},e.prototype.get_marginLeft=function(){return this._marginLeft},e.prototype.get_paragraphSpacing=function(){return this._paragraphSpacing},e.prototype.set_paragraphSpacing=function(e){return this._paragraphSpacing=e,e},e.prototype.get_lineSpacing=function(){return this._lineSpacing},e.prototype.set_lineSpacing=function(e){return this._lineSpacing=e,e},e.prototype.get_specialIndent=function(){return this._specialIndent},e.prototype.set_specialIndent=function(e){return this._specialIndent=e,e},e.prototype.get_leftIndent=function(){return this._leftIndent},e.prototype.set_leftIndent=function(e){return this._leftIndent=e,e},e.prototype.get_tableFormattingProperties=function(){return this._tableFormattingProperties},e.prototype.get_paragraphProperties=function(){return this.$$pf_ParagraphProperties},e.prototype.set_paragraphProperties=function(e){return this.$$pf_ParagraphProperties=e,e},e.prototype.SetDefaultLanguage=function(e){var t=this._formattingReader.language(e);t&&this._formattingEditor.setLanguageOnRange(this._containerChp.get_formatting(),t,0,e.get_cache().get_isNoProof(),!1)},e.prototype.GetDefaultParagraphSpacing=function(){if(q.n.get_instance().get_item(54))return null;var e=new Z.v;return e.afterSpacing.value=this.DefaultParagraphSpacingInPoints,e.beforeSpacing.value=this.DefaultParagraphSpacingInPoints,e},e.prototype.setLang=function(e){var t=y.i.getCultureInfo(e);return t&&this._formattingEditor.setLanguageOnParagraph(this._containerChp.get_formatting(),t.get_LCID()),!0},e.prototype.setTextDir=function(e){return!1},e.prototype.setBold=function(e){return this._formattingEditor.setBold(this._containerChp.get_formatting(),e),!0},e.prototype.setItalics=function(e){return this._formattingEditor.setItalic(this._containerChp.get_formatting(),e),!0},e.prototype.setUnderline=function(e){return this._formattingEditor.setUnderline(this._containerChp.get_formatting(),e),!0},e.prototype.setStrikethrough=function(e){return this._formattingEditor.setStrikethrough(this._containerChp.get_formatting(),e),!0},e.prototype.setSubscript=function(e){return this._formattingEditor.setSubscript(this._containerChp.get_formatting(),e),!0},e.prototype.setSuperscript=function(e){return this._formattingEditor.setSuperscript(this._containerChp.get_formatting(),e),!0},e.prototype.setFontsize=function(e){return!(e<=0)&&(this._formattingEditor.setFontSize(this._containerChp.get_formatting(),e),!0)},e.prototype.setFontface=function(e,t){if(!e||""===e)return!1;var n;if($.v.trySupportDocumentFont(e,(0,N.m)((function(){return n}),(function(e){return n=e}))))return this._formattingEditor.setFontFace(this._containerChp.get_formatting(),n.get_fontName()),!0;var i=!1,r=$.v.normalizedFontName(e);return t&&this.IsSupportedFont(r,this._fontService)&&(this._fontService.createFontUrl(e),i=!0),this.IsSupportedFont(r,this._customFontService)&&(i=!0),i&&this._formattingEditor.setFontFace(this._containerChp.get_formatting(),r),i},e.prototype.IsSupportedFont=function(e,t){return!!t&&t.get_isEnabled()&&t.isSupportedFont(e)},e.prototype.growFontsize=function(){return this._formattingEditor.growFontSizeAndSet(this._containerChp.get_formatting()),!0},e.prototype.shrinkFontsize=function(){return this._formattingEditor.shrinkFontSizeAndSet(this._containerChp.get_formatting()),!0},e.prototype.setFontColor=function(e){if(!this._formattingEditor.isSchemeColor(e)){if(null===e||""===e)return!1;e=n(1705).Box4PasteSteward.ConvertRgbToBgr(e)}var t=null;return this.get_paragraphProperties()&&this.get_paragraphProperties().hasOwnProperty(H.j.listLevel.id.toString())&&(t=this.get_paragraphProperties()[H.j.listLevel.id.toString()]),this._formattingEditor.setFontColor(this._containerChp.get_formatting(),e,t),!0},e.prototype.setFontHighlight=function(t){if(!t||""===t)return!1;var i=t;return!(q.n.get_instance().get_item(49)&&!e.get_wordSupportHighlightColorSet().contains(t))&&(!this._formattingStewardBridge.shouldSkipHightlightAfterPaste(this._containerChp.get_formatting())&&(this._formattingEditor.setFontHighlight(this._containerChp.get_formatting(),n(1705).Box4PasteSteward.ConvertRgbToBgr(i)),!0))},e.prototype.setMath=function(e){return this._formattingEditor.setMath(this._containerChp.get_formatting(),e),!0},e.prototype.setTextCapsType=function(e){var t=0;switch(z.l.toLower(e)){case"small-caps":t=1;break;case"uppercase":t=2}return this._formattingEditor.setTextProperty(this._containerChp.get_formatting(),U.o.capitalization,t),!0},e.prototype.setCellShadingColor=function(e){return!(!e||""===e)&&(this._tableFormattingProperties.setValue(O.b.cellShadingColor,parseInt(n(1705).Box4PasteSteward.ConvertRgbToBgr(e),16)),!0)},e.prototype.setParagraphHeadingStyle=function(e){return!(e<=0)&&this.setParagraphStyle(j.StyleReader.getStyleHeading(e))},e.prototype.setParagraphStyleType=function(e){return this.clearFormatting(),this._paragraphStyleType=e,!0},e.prototype.setParagraphStyle=function(e){return!!(e&&e.length>0&&n(1705).Box4PasteSteward.get_SupportedStyleSet()&&n(1705).Box4PasteSteward.get_SupportedStyleSet().getStyleById(e))&&(this._paragraphStyle=e,!0)},e.prototype.setCharacterStyle=function(e){return!!(e&&e.length>0&&n(1705).Box4PasteSteward.get_SupportedStyleSet()&&n(1705).Box4PasteSteward.get_SupportedStyleSet().getStyleById(e))&&(this._characterStyle=e,!0)},e.prototype.tryApplyCharacterStyle=function(e){if(this.get_CharacterStyle()){var t=n(1705).Box4PasteSteward.get_SupportedStyleSet()||j.StyleReader.getStyleSetFromParagraphNode(e);if(!t)return m.r.shipAssertTag(41968715,307,!1),!1;var i=t.getStyleById(this.get_CharacterStyle());return i&&this._formattingEditor.setCharacterStyle(this._containerChp.get_formatting(),i),!0}return!1},e.prototype.setParagraphSpacing=function(e,t){return!q.n.get_instance().get_item(54)&&(m.r.shipAssertTag(5297416,307,e>=0&&t>=0),e>=0&&(this._paragraphSpacing.beforeSpacing.value=e),t>=0&&(this._paragraphSpacing.afterSpacing.value=t),e>=0||t>=0)},e.prototype.setLineSpacing=function(e){if(!q.n.get_instance().get_item(54)||!e)return!1;var t=parseFloat(z.l.substring(e,0,z.l.toLower(e).indexOf("px")));if(!isNaN(t))return this._lineSpacing=new ee.o(3,V.j.pixelsToTwips(t,1)),!0;var n=parseFloat(z.l.substring(e,0,z.l.toLower(e).indexOf("%")));return!isNaN(n)&&(this._lineSpacing=new ee.o(2,n/100),!0)},e.prototype.setTextAlign=function(e){var t=0;if(!e||""===e)return!1;switch(e){case"left":t=1;break;case"center":t=2;break;case"right":t=3;break;case"justify":q.n.get_instance().get_item(54)&&(t=6)}return!!t&&(this.set_justification(t),!0)},e.prototype.setTextIndent=function(e){return this._textIndent=e,!0},e.prototype.setMarginLeft=function(e){return this._marginLeft=e,!0},e.prototype.setParagraphProperties=function(e){return this.set_paragraphProperties(JSON.parse(e)),!!this.get_paragraphProperties()},e.prototype.clearFormatting=function(){return this._containerChp.set_formatting(new X.a(this._containerChp,G.h.get_nil())),!0},e.prototype.resetJustification=function(){return this._justification=0,!0},e.prototype.tryApplyParagraphStyle=function(e){if(!q.n.get_instance().get_item(71))return!1;if(this.get_ParagraphStyleTypeValue()>0&&n(1705).Box4PasteSteward.ParagraphStyleStrings[this.get_ParagraphStyleTypeValue()]){if(m.r.shipAssertTag(4223819,307,1<=this.get_ParagraphStyleTypeValue()),m.r.shipAssertTag(4223820,307,this.get_ParagraphStyleTypeValue()<=7),!(i=j.StyleReader.getStyleSetFromParagraphNode(e)))return m.r.shipAssertTag(4223821,307,!1),!1;var t=i.getStyleById(n(1705).Box4PasteSteward.ParagraphStyleStrings[this.get_ParagraphStyleTypeValue()]);return this._styleEditor.setStyleOnParagraphNode(t,e,!1),!0}if(this.get_ParagraphStyleValue()){var i;if(!(i=n(1705).Box4PasteSteward.get_SupportedStyleSet()||j.StyleReader.getStyleSetFromParagraphNode(e)))return m.r.shipAssertTag(41968716,307,!1),!1;t=i.getStyleById(this.get_ParagraphStyleValue());return this._styleEditor.setStyleOnParagraphNode(t,e,!1),!0}return!1},e.prototype.clone=function(){return new e(this.get_paragraph(),this._formattingEditor,this._styleEditor,this._formattingReader,this._formattingStewardBridge,this._fontService,this._customFontService,this._followDestinationFormattingPasteIsEnabled,this)},e.get_wordSupportHighlightColorSet=function(){return e._wordSupportHighlightColorSet||(e._wordSupportHighlightColorSet=new L.e(String,B.b.get_ordinalIgnoreCase()),e._wordSupportHighlightColorSet.add(J.yellow),e._wordSupportHighlightColorSet.add(J.lime),e._wordSupportHighlightColorSet.add(J.aqua),e._wordSupportHighlightColorSet.add(J.fuchsia),e._wordSupportHighlightColorSet.add(J.blue),e._wordSupportHighlightColorSet.add(J.red),e._wordSupportHighlightColorSet.add(J.navy),e._wordSupportHighlightColorSet.add(J.teal),e._wordSupportHighlightColorSet.add(J.green),e._wordSupportHighlightColorSet.add(J.purple),e._wordSupportHighlightColorSet.add(J.maroon),e._wordSupportHighlightColorSet.add(J.olive),e._wordSupportHighlightColorSet.add(J.gray),e._wordSupportHighlightColorSet.add(J.sliver),e._wordSupportHighlightColorSet.add(J.black)),e._wordSupportHighlightColorSet},e.ShouldUseExistingFormatting=function(e){if(!q.n.get_instance().get_item(71))return!0;var t=j.StyleReader.getStyleId(j.StyleReader.getStyleFromParagraphNode(e));return t===j.StyleReader.get_wordStyleIdDefaultParagraphFont()||t===j.StyleReader.get_wordStyleIdNormal()||t===j.StyleReader.get_wordStyleIdNoSpacing()||t===j.StyleReader.styleIdNormal},e._wordSupportHighlightColorSet=null,e.ParagraphSpacingRatio=.25,e}();(0,d.l)(te,"4ee0d578$FormattingSteward",null,[T,A.q]);var ne=n(2057),ie=function(){function e(){}return e.prototype.tryHandlePageBreak=function(e,t,n){return!1},e.prototype.handleParagraphEnd=function(e,t){return e},e.prototype.handleTabCharacter=function(e,t){},e.prototype.setParagraphProperties=function(e,t,n,i,r){void 0===i&&(i=null),void 0===r&&(r=null)},e.prototype.setListInfo=function(e,t,n){},e.prototype.isFormatless=function(e){return!1},e.prototype.get_isPasteBrAsNewParagraphEnabled=function(){return!1},e.prototype.setLineSpacing=function(e,t){},e.prototype.setParagraphSpacing=function(e,t){},e.prototype.setSpecialIndent=function(e,t){},e.prototype.setLeftIndent=function(e,t){},e.prototype.get_shouldSkipSettingIndentation=function(){return!1},e.prototype.processExternalHyperlink=function(e,t){},e}();(0,d.l)(ie,"102b7dfd$NoOpPasteStewardBridge",null,[ne.n]);var re=n(9730),oe=function(){function e(e,t){this.noteTagName=null,this.noteTagStatus=null,this.noteTagName=e,this.noteTagStatus=t||"Normal"}return e.prototype.get_noteTagName=function(){return this.noteTagName},e.prototype.get_noteTagStatus=function(){return this.noteTagStatus},e}();(0,d.l)(oe,"a8993573$NoteTagInfoBox4",null,[]);var ae=function(){function e(){}return e.translateListToBox4=function(e){for(var t=new re.c(oe),n=e.$$lge();n.$$mn();){var i=n.$$cu(),r=new oe(i.get_noteTagName(),i.get_noteTagStatus());t.add(r)}return t},e}();(0,d.l)(ae,"2a91d916$NoteTagInfoUtils",null,[]),n.d(t,{a:function(){return le}});var le=function(){function e(e,t,n,i){void 0===n&&(n=null),void 0===i&&(i=null),this._lcid=null,this._iterator=null,this._box4PasteStewardBridge=null,this.usageData=null,this._fontService=null,this._customFontService=null,this.$$pf_PendingIndentationLevel=0,this.followDestinationFormattingPasteIsEnabled=f.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FollowDestinationFormattingPasteIsEnabled"),this._iterator=e,this._lcid=t,this._box4PasteStewardBridge=i||new ie,this.usageData=n||S.z.getFormattingStewardUsageDataInstance(f.AFrameworkApplication.userSessionId)}return e.prototype.get_usageData=function(){return this.usageData},e.prototype.get_characterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=C.w.get_instance().resolve(r.x))},e.prototype.get_FontService=function(){return this._fontService||(this._fontService=C.w.get_instance().tryResolve(i.h))},e.prototype.get_CustomFontService=function(){return this._customFontService||(this._customFontService=C.w.get_instance().tryResolve(b.o))},e.prototype.reset=function(){},e.prototype.get_defaultFormatting=function(){return this.getDefaultFormatting(!1)},e.prototype.getDefaultFormatting=function(t){m.r.shipAssertTag(4223770,307,k.OutlineElementReader.isOutlineElement(this._iterator));var n=D.OutlineElementNavigator.moveToContent(this._iterator);D.OutlineElementNavigator.returnToOutlineElement(this._iterator),m.r.shipAssertTag(4223771,307,!!n&&x.ParagraphReader.isParagraphNode(n));var i=new te(n,e.get_FormattingEditor(),e.get_StyleEditor(),e.get_FormattingReader(),e.get_FormattingStewardBridge(),this.get_FontService(),this.get_CustomFontService(),this.followDestinationFormattingPasteIsEnabled,void 0,t);return new w(i,this.get_usageData())},e.prototype.onText=function(e,t){},e.prototype.onLineBreak=function(e){},e.prototype.onTab=function(e){},e.prototype.onImage=function(e){},e.prototype.onFile=function(e){},e.prototype.onFormattingChange=function(e){},e.prototype.onAnchorStart=function(e,t){},e.prototype.onAnchorEnd=function(){},e.prototype.onParagraphStart=function(e){},e.prototype.onParagraphEnd=function(){},e.prototype.onPreFormattedTextStart=function(){},e.prototype.onPreFormattedTextEnd=function(){},e.prototype.onMathStart=function(e,t){},e.prototype.onMathEnd=function(){},e.prototype.onListStart=function(e){},e.prototype.onListEnd=function(){},e.prototype.onListItemStart=function(e){},e.prototype.onListItemEnd=function(){},e.prototype.onRenderAugmentation=function(e){},e.prototype.onSpanStart=function(){},e.prototype.onSpanEnd=function(){},e.prototype.moveToNextOutlineElementForHtmlImport=function(t){k.OutlineElementReader.isOutlineElement(this._iterator)?(e.get_outlineElementEditor().insertOutlineElementBelow(this._iterator,!0),D.OutlineElementNavigator.moveToNextOutlineElement(this._iterator,!1,!1)):M.OutlineReader.isOutline(this._iterator)?R.OutlineNavigator.moveToFirstOutlineElement(this._iterator)?t?(this._iterator.disconnectNodeAndReturnToParent(),e.get_outlineEditor().appendOutlineElement(this._iterator,!1)):e.get_outlineElementEditor().removeContent(this._iterator):e.get_outlineEditor().appendOutlineElement(this._iterator,!1):m.r.shipAssertTag(8128524,307,!1,"Unexpected node type {0} encountered",this._iterator.get_currentNodeType())},e.prototype.getNewOutlineElementInfo=function(e){var t=null;if(e&&e.get_ownerHtmlElementInfo()&&e.get_cultureName())try{t=(0,_.m)(new P.d,{languageId:y.i.getCultureInfo(e.get_cultureName()).get_LCID()})}catch(t){m.r.shipAssertTag(8128526,307,!1,"Setting up culture {0} encountered {1}",e.get_cultureName(),t)}return t||null==this._lcid||(t=(0,_.m)(new P.d,{languageId:this._lcid})),t},e.prototype.get_pendingIndentationLevel=function(){return this.$$pf_PendingIndentationLevel},e.prototype.set_pendingIndentationLevel=function(e){return this.$$pf_PendingIndentationLevel=e,e},e.prototype.applyPendingListAndIndentationInfo=function(e,t){},e.prototype.trackTableToDelist=function(e){},e.prototype.clearPendingIndentation=function(){},e.prototype.get_continuingExistingList=function(){return!1},e.prototype.get_currentlyUnderPastedList=function(){return!1},e.prototype.listInfoFromListSemanticArgs=function(e){var t,n=1;if(e.get_isListNumbered())switch(t=0,e.get_listStyleType()){case 1:n=0;break;case 7:n=1;break;case 8:n=2;break;case 9:n=3;break;case 10:n=4;break;case 11:n=5}else switch(t=1,e.get_listStyleType()){case 1:n=0;break;case 3:n=1;break;case 4:n=2;break;case 5:n=3}var i,r;return r=(i=E.ListReader.get_externalPasteImprovementsEnabled())?F.j.createFromScratch(t,n,ae.translateListToBox4(e.ownerNoteTagInfo),e.get_listId(),e.get_listLevel(),e.get_levelText(),e.get_font()):F.j.createFromScratch(t,n,ae.translateListToBox4(e.ownerNoteTagInfo)),e.get_isListNumbered()&&!e.get_isAutoNumber()&&(i&&e.get_listId()>0&&e.get_listLevel()>=0&&!e.get_pasteFromRichClient()?r.set_restartAt(e.get_startNumber()):r.set_restartAt(e.get_currentNumber())),this._box4PasteStewardBridge.setListInfo(this._iterator,r,e),r},e.prototype.onTableStart=function(e){},e.prototype.onTableEnd=function(){},e.prototype.onTableRowStart=function(e){},e.prototype.onTableRowEnd=function(){},e.prototype.onTableCellStart=function(e){},e.prototype.onTableCellEnd=function(){},e.prototype.onTablePartStart=function(e){},e.prototype.onTablePartEnd=function(){},e.get_outlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=C.w.get_instance().resolve(o.p))},e.get_outlineEditor=function(){return e._outlineEditor||(e._outlineEditor=C.w.get_instance().resolve(a.a))},e.get_FormattingEditor=function(){return e._formattingEditor||(e._formattingEditor=C.w.get_instance().resolve(l.z))},e.get_StyleEditor=function(){return e._styleEditor||(e._styleEditor=C.w.get_instance().resolve(s.e))},e.get_FormattingReader=function(){return e._formattingReader||(e._formattingReader=C.w.get_instance().resolve(u.d))},e.get_FormattingStewardBridge=function(){return e._formattingStewardBridge||(e._formattingStewardBridge=C.w.get_instance().resolve(c.u))},e._outlineElementEditor=null,e._outlineEditor=null,e._characterPropertiesEditor=null,e._formattingEditor=null,e._styleEditor=null,e._formattingReader=null,e._formattingStewardBridge=null,e}();(0,d.l)(le,"8c611488$Box4PasteStewardBase",null,[g,p.m,h.p])},9485:function(e,t,n){"use strict";n.d(t,{p:function(){return f}});var i=n(1817),r=n(6315),o=n(2806),a=n(8202),l=n(9375),s=n(6325),u=n(8548),c=n(3285),d=n(8661),g=n(9368),p=n(7275),h=n(654),_=n(8399),m=n(4115),f=function(e){function t(n,i,r,o,a,l){var s=e.call(this,n,i,r,o,a,l)||this;return t._characterPropertiesEditor=l,s}return(0,i.t)(t,e),t.prototype.get_commandId=function(){return l.u.autoCorrectBulletList},t.prototype.doGraphCorrection=function(e){if(this.get_listCommands()){var n=h.g.createFromNode(e);if(n.tryToRootAtOutlineAncestor(),g.OutlineElementNavigator.returnToOutlineElement(n),this.get_listEditor().shouldAutocorrectList(n)){var i=null,r=t.get_ListReader().getListInfo(n),o=this.matchResults[0];switch(u.l.charAt(o,0)){case"*":(i=d.j.createFromScratch(1,1)).set_autoTriggerString("*");break;default:i=d.j.createFromScratch(1,0)}if(!r||!i.hasMatchingListFormat(r)){var a=new c.GraphTransaction(15);a.setFromIterator(n),t._characterPropertiesEditor.replaceTextRange(p.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchEndIndex()+1),"",!0,!1),this.get_listEditor().setListBaseStyleIfNecessary(i),this.get_listCommands().bullets(i.get_listType(),i.get_listStyle()),a.dispose()}}}},t.get_CharacterPropertiesEditor=function(){return t._characterPropertiesEditor||(t._characterPropertiesEditor=s.w.get_instance().resolve(r.x))},t.get_ListReader=function(){return t._listReader||(t._listReader=s.w.get_instance().resolve(o.c))},t.CreateGraphCorrectionAction=function(e,n,i,r,o,a){return new t(null,e,n,i,r,o)},t.CreateHtmlCorrectionAction=function(e,n,i,r,o,a){return new t(e,_.j.getOwner(e).get_sourceNode(),n,i,r,o)},t._characterPropertiesEditor=null,t._listReader=null,t}(a.n);(0,m.l)(f,"16f0e512$BulletListAction",a.n,[])},9676:function(e,t,n){"use strict";n.d(t,{u:function(){return d}});var i=n(1817),r=n(2846),o=n(9233),a=n(9375),l=n(6325),s=n(3285),u=n(7275),c=n(4115),d=function(e){function t(n,i,r,o,a){var l=e.call(this,n,i,r,o,a)||this;return t._characterPropertiesEditor=a,l}return(0,i.t)(t,e),t.prototype.get_isGraphOnlyOperation=function(){return!0},t.prototype.get_commandId=function(){return a.u.autoCorrectOrdinalsReplace},t.prototype.doHtmlCorrection=function(e){},t.prototype.doGraphCorrection=function(e){var n=u.y.createTextRange(e,this.get_matchEndIndex()-2,this.get_matchEndIndex()),i=new s.GraphTransaction(15);i.setFromNode(e);for(var r=!1,o=null,a=0;a<e.get_characterProperties().get_length();){var l=!!(d=e.get_characterProperties().get_item(a)).get_fieldRangeStart()||d.get_isStartOfOutermostField(),c=!!d.get_fieldRangeEnd()||d.get_isEndOfOutermostField();if(d.get_cp()>=n.get_cpBegin()){d.get_cp()>n.get_cpBegin()||!d.get_formatting()?o=r?d.get_formatting():t._characterPropertiesEditor.splitFormattingAtChpIndexAndUpdateWordRunProperties(e,a,n.get_cpBegin(),o):(o=d.get_formatting(),c&&(r=!1),l&&(r=!0)),a++;break}d.get_formatting()&&(o=d.get_formatting()),c&&(r=!1),l&&(r=!0),a++}for(;a<e.get_characterProperties().get_length();){var d;if((d=e.get_characterProperties().get_item(a)).get_cp()>=n.get_cpEnd()){(d.get_cp()>n.get_cpEnd()||!d.get_formatting()&&!d.get_isEndOfParagraph())&&(r||t._characterPropertiesEditor.splitFormattingAtChpIndexAndUpdateWordRunProperties(e,a,n.get_cpEnd(),o)),r||t.get_formattingEditor().setSuperscript(o,!0);break}d.get_formatting()&&(r||t.get_formattingEditor().setSuperscript(o,!0),o=d.get_formatting());l=!!d.get_fieldRangeStart()||d.get_isStartOfOutermostField(),c=!!d.get_fieldRangeEnd()||d.get_isEndOfOutermostField();l&&(r=!0),!l&&c&&(r=!1),a++}i.dispose()},t.get_formattingEditor=function(){return t._formattingEditor||(t._formattingEditor=l.w.get_instance().resolve(r.z))},t.CreateGraphCorrectionAction=function(e,n,i,r){return new t(null,e,n,i,r)},t._characterPropertiesEditor=null,t._formattingEditor=null,t}(o.z);(0,c.l)(d,"16c1ae44$OrdinalsReplaceCorrectAction",o.z,[])},9868:function(e,t,n){"use strict";n.d(t,{y:function(){return o}});var i=n(8548),r=n(4115),o=function(){function e(e,t,n,i){this._contentStr=null,this._triggerKey=null,this._languageId=0,this._originalWord=null,this._contentStr=e,this._triggerKey=t,this._languageId=i,this._originalWord=n}return e.prototype.IsParagraphBegin=function(){return!!this._originalWord&&(this._contentStr=this._contentStr.trimStart(),this._contentStr===this._originalWord)},e.prototype.IsWordAfterTwoCharWithDotBetweenEach=function(){if(!this._contentStr)return!1;var e=this._contentStr.lastIndexOf(" ");return-1!==e&&"."===this._contentStr.charAt(e-1)&&"."===this._contentStr.charAt(e-3)},e.prototype.IsWordAfterOneCharWithDot=function(){if(!this._contentStr)return!1;var e=this._contentStr.lastIndexOf(" ");if(-1!==e){var t=this._contentStr.substring(0,e-1).lastIndexOf(" ");if("."===this._contentStr.charAt(t+2))return!0}return!1},e.prototype.IsOneLetterAfterWithDotAtParagraphHead=function(){return!(!this.IsParagraphBegin()||(1!==this._originalWord.length||"."!==this._triggerKey)&&"."!==this._contentStr.charAt(1))},e.prototype.IsOneLetterAfterwithSlash=function(){if(!this._originalWord)return!1;return"\\/".indexOf(this._triggerKey)>=0||3===this._originalWord.length&&"\\/".indexOf(this._originalWord.charAt(1))>=0},e.prototype.IsMailAddress=function(){return!!this._originalWord&&this._originalWord.indexOf("@")>=0},e.prototype.IsLink=function(){if(!this._originalWord)return!1;for(var t=0,n=e.get_LinkableProtocolList();t<n.length;t++){var r=n[t];if(i.l.startsWith(this._originalWord+this._triggerKey,r))return!0}return!1},e.prototype.IsLetterIWithQuote=function(){return!!this._originalWord&&("i"===this._originalWord&&e.Quotes.indexOf(this._triggerKey)>=0)},e.prototype.isDaishorNorwegian=function(){return 1030===this._languageId||2068===this._languageId},e.prototype.isGreekSenteceEnd=function(){return!1},e.prototype.IsCommonSentenceEndMark=function(){if(!this._contentStr)return!1;var t=i.l.lastIndexOfWhiteSpace(this._contentStr,this._contentStr.length-1);if(-1!==t&&this._contentStr.substring(t+1,this._contentStr.length)===this._originalWord){var n=this._contentStr.charAt(t-1);if(e.SentenceDelimiters.indexOf(n)>=0)return!0;if(e.Quotes.indexOf(n)>=0){var r=this._contentStr.charAt(t-2);if(e.SentenceDelimiters.indexOf(r)>=0)return!0}}return!1},e.prototype.checkCurrentWordWithAutoCorrectConditions=function(){return!!this._contentStr&&(!(this.IsWordAfterTwoCharWithDotBetweenEach()||this.IsOneLetterAfterWithDotAtParagraphHead()||this.IsOneLetterAfterwithSlash()||this.IsWordAfterOneCharWithDot())&&(!this.IsMailAddress()&&!this.IsLink()&&(!!this.IsParagraphBegin()||(!!this.IsLetterIWithQuote()||!!this.IsCommonSentenceEndMark()))))},e.get_LinkableProtocolList=function(){return e._linkableProtocolListAutoCorrectDisabled||(e._linkableProtocolListAutoCorrectDisabled=["http:","https:","ftp://","mailto:","\\\\","www."])},e.SentenceDelimiters=".!?",e.Quotes="'\"",e._linkableProtocolListAutoCorrectDisabled=null,e}();(0,r.l)(o,"a42f79a7$FirstLetterUpperCaseRules",null,[])},9958:function(e,t,n){"use strict";var i=n(4115),r=(0,i.y)("7da64d40$IViewerChrome"),o=n(3660),a=n(417),l=n(9230),s=n(1454),u=n(9116),c=n(3116),d=n(9229),g=function(){function e(e,t,n,i,r){this._elmTopBar1=null,this._elmTopBar2=null,this._breadcrumb=null,this._documentTitle=null,this._toolbarContainer=null,this._elmTopBar1=e,this._elmTopBar2=t,this._breadcrumb=n,this._documentTitle=i,this._toolbarContainer=r}return e.prototype.AdjustBreadcrumbDisplay=function(){var e=!!c.AFrameworkApplication.breadcrumbBrandName,t=!!c.AFrameworkApplication.breadcrumbFolderName;if(!c.AFrameworkApplication.get_isEmbedded()&&e&&t){var n=this._breadcrumb.getBreadcrumbItem(a.CuiHelper.breadcrumbFolderId),i=this._breadcrumb.getBreadcrumbItem(a.CuiHelper.folderSeparatorId);n&&i&&s.k.AdjustBreadcrumbDisplay(i,n)}},e.prototype.ScaleHerobar=function(){var t=this,n=[function(){e.TrimLongestElement(t._breadcrumb,t._documentTitle,e.TruncatedElementWidth)},function(){e.TrimBreadcrumbAndDocumentTitle(t._breadcrumb,t._documentTitle,e.TruncatedElementWidth)},function(){e.HideDocumentTitleAndUntruncateBreadcrumb(t._breadcrumb,t._documentTitle)},function(){t._breadcrumb.truncateWidth(e.TruncatedElementWidth)},i.i(this._breadcrumb,this._breadcrumb.hide,"hide")];e.ShowAndUntruncateAllElements(this._breadcrumb,this._documentTitle),e.InvokeScalingSteps(n,(function(){return e.HerobarElementBoundsOverlap(t._breadcrumb,t._documentTitle,t._toolbarContainer,c.AFrameworkApplication.get_isRtl())}))},e.prototype.ScaleHeader=function(){this.EnhancedMobileViewIsEnabled()?(document.getElementById("application").style.minWidth="0px",new u.b(this._elmTopBar1,this._elmTopBar2,c.AFrameworkApplication.get_isRtl()).scaleHeader()):s.k.scaleHeaderUsingContainers(this._elmTopBar1,this._elmTopBar2,c.AFrameworkApplication.get_isRtl())},e.prototype.EnhancedMobileViewIsEnabled=function(){return!!c.AFrameworkApplication.appSettingsManager&&c.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EnhancedMobileViewIsEnabled")},e.prototype.scaleViewerChrome=function(){this.ScaleHeader(),this.AdjustBreadcrumbDisplay(),this.ScaleHerobar()},e.ShowAndUntruncateAllElements=function(e,t){e&&e.undoScaling(),t&&t.undoScaling()},e.HerobarElementBoundsOverlap=function(t,n,i,r){return e.ViewerChromeItemsOverlap(t,n,r)||e.ViewerChromeItemsOverlap(n,i,r)||e.ViewerChromeItemsOverlap(t,i,r)},e.ViewerChromeItemsOverlap=function(e,t,n){return!(!e||!t)&&(!(!e.get_isVisible()||!t.get_isVisible())&&d.g.leftBoundsOverlapsRightBounds(e.get_containerBounds(),t.get_containerBounds(),n))},e.TrimLongestElement=function(e,t,n){e&&t&&(e.get_containerBounds().width>t.get_containerBounds().width?e.truncateWidth(n):t.truncateWidth(n))},e.TrimBreadcrumbAndDocumentTitle=function(e,t,n){e&&e.truncateWidth(n),t&&t.truncateWidth(n)},e.HideDocumentTitleAndUntruncateBreadcrumb=function(e,t){t.hide(),e.undoScaling()},e.InvokeScalingSteps=function(e,t){for(var n=0;t()&&n<e.length;)e[n](),n++},e.TruncatedElementWidth=200,e}();(0,i.l)(g,"31b0a092$ViewerChromeScalingManager",null,[]);var p=n(1155),h=n(4297),_=n(5866);n.d(t,{k:function(){return m}});var m=function(){function e(e,t,n,r){var a=this;void 0===r&&(r=!1),this._elmViewerChromeContainer=null,this._elmToolbarTopBars=null,this._elmHeaderContainer=null,this._elmTopBar1=null,this._elmTopBar2=null,this._elmTopRowLeft=null,this._elmTopRowCenter=null,this._elmTopRowRight=null,this._breadcrumbContainer=null,this._documentTitleContainer=null,this._toolbarContainer=null,this.viewerChromeScalingManager=null,this._resizableContainer=null,this._headerIsHidden=!1,this._appHasExternalHeader=!1,this._appExternalHeaderPanel=null,this._appHasExternalHeader=p.o.tryEnsuredHeaderPanelInitialized((0,o.m)((function(){return a._appExternalHeaderPanel}),(function(e){return a._appExternalHeaderPanel=e})),!r),this._headerIsHidden=r,this.CreateViewerChromeStructure(),e.appendChild(this._elmViewerChromeContainer),this._headerIsHidden||this.PopulateHeader(t),this.PopulateHerobarContainers(),this.viewerChromeScalingManager=new g(this._elmTopBar1,this._elmTopBar2,this._breadcrumbContainer,this._documentTitleContainer,this._toolbarContainer),this._resizableContainer=n||new h.o,this._resizableContainer.add_onResize(i.i(this,this.scale,"scale")),this.scale()}return e.prototype.get_toolbarWithTopbarHeight=function(){return e.calculateToolbarWithTopBarHeight(this._headerIsHidden,this._appHasExternalHeader)},e.prototype.get_ViewerChromeCssClass=function(){return"cui-viewerchrome"},e.prototype.get_toolbarContainer=function(){return this._toolbarContainer.get_elmContainer()},e.prototype.get_peripheralContentContainer=function(){return this._elmTopBar1},e.prototype.get_toolbarContentContainer=function(){return this._elmTopBar2},e.prototype.CreateViewerChromeStructure=function(){this._elmViewerChromeContainer=e.createUnselectableElement("div"),this._elmViewerChromeContainer.className=this.get_ViewerChromeCssClass(),this.EnsureTopBars(),this.EnsureTopBars1And2()},e.prototype.EnsureTopBars=function(){this._elmToolbarTopBars=e.createUnselectableElement("div"),this._elmToolbarTopBars.id=a.CuiHelper.headerTopBarsId,this._elmToolbarTopBars.className="cui-ribbonTopBars",this._elmViewerChromeContainer.appendChild(this._elmToolbarTopBars),this.EnsureHeaderDom()},e.prototype.EnsureHeaderDom=function(){this._appHasExternalHeader?(this._elmHeaderContainer=e.createUnselectableElement("div"),this._elmHeaderContainer.className="cui-ribbonTopBars",this._elmHeaderContainer.id=a.CuiHelper.externalHeaderViewerChromeTopBarsId,this._appExternalHeaderPanel.appendChild(this._elmHeaderContainer),Sys.UI.DomElement.addCssClass(this._elmHeaderContainer,this.get_ViewerChromeCssClass()),Sys.UI.DomElement.addCssClass(this._elmViewerChromeContainer,"cui-exth")):this._elmHeaderContainer=this._elmToolbarTopBars},e.prototype.EnsureTopBars1And2=function(){this._elmTopBar1=e.createUnselectableElement("div"),this._elmTopBar1.className="cui-topBar1";var t=c.AFrameworkApplication.appSettingsManager.get_appSettings();"TransitionalHeaderUIInViewEnabled"in t&&Boolean.parse(t.TransitionalHeaderUIInViewEnabled)&&c.AFrameworkApplication.get_activeFrame()&&c.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isTransistionalHeaderUIEnabled()&&(this._elmTopBar1.className+=" cui-topBar1-transistionalHeaderUI"),c.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LegacyHeaderAppColorIsEnabled")&&(this._elmTopBar1.className+=" cui-topBar1-transistionalHeaderUI"),this._headerIsHidden&&(this._elmTopBar1.style.display="none"),this._elmHeaderContainer.appendChild(this._elmTopBar1),this._elmTopBar2=e.createUnselectableElement("div"),this._elmTopBar2.className="cui-topBar2",this._elmToolbarTopBars.appendChild(this._elmTopBar2)},e.prototype.PopulateHeader=function(t){this._elmTopRowLeft=document.getElementById(t+"-"+l.r.topRowLeft),this._elmTopRowCenter=document.getElementById(t+"-"+l.r.topRowCenter),this._elmTopRowRight=document.getElementById(t+"-"+l.r.topRowRight),this._elmTopRowLeft&&(this._elmTopRowLeft.parentNode.removeChild(this._elmTopRowLeft),this._elmTopBar1.appendChild(this._elmTopRowLeft),this._elmTopRowLeft.style.display="inline-block",e.SetUnselectable(this._elmTopRowLeft)),this._elmTopRowCenter&&(this._elmTopRowCenter.parentNode.removeChild(this._elmTopRowCenter),this._elmTopBar1.appendChild(this._elmTopRowCenter),this._elmTopRowCenter.style.display="inline-block",e.SetUnselectable(this._elmTopRowCenter)),this._elmTopRowRight&&(this._elmTopRowRight.parentNode.removeChild(this._elmTopRowRight),this._elmTopBar1.appendChild(this._elmTopRowRight),this._elmTopRowRight.style.display="inline-block",e.SetUnselectable(this._elmTopRowRight))},e.prototype.PopulateHerobarContainers=function(){this._breadcrumbContainer=new(n(6589).BreadcrumbContainer),this._documentTitleContainer=new(n(4136).DocumentTitleContainer),this._toolbarContainer=new(n(1057).ToolbarContainer),this._elmTopBar2.appendChild(this._breadcrumbContainer.get_elmContainer()),this._elmTopBar2.appendChild(this._documentTitleContainer.get_elmContainer()),this._elmTopBar2.appendChild(this._toolbarContainer.get_elmContainer())},e.prototype.scale=function(){this.viewerChromeScalingManager.scaleViewerChrome()},e.prototype.dispose=function(){this._documentTitleContainer&&(this._documentTitleContainer.dispose(),this._documentTitleContainer=null),this._breadcrumbContainer&&(this._breadcrumbContainer.dispose(),this._breadcrumbContainer=null),this._elmToolbarTopBars=null,this._elmTopBar1=null,this._elmTopBar2=null,this._elmTopRowLeft=null,this._elmTopRowCenter=null,this._elmTopRowRight=null,this._resizableContainer.remove_onResize(i.i(this,this.scale,"scale")),this._resizableContainer=null,this._appExternalHeaderPanel&&_.s.clearElementHtml(this._appExternalHeaderPanel)},e.calculateToolbarWithTopBarHeight=function(t,n){return(t||n?0:e.UnifiedHeaderHeightPx)+e.TopBar2HeightPx},e.createUnselectableElement=function(t){var n=document.createElement(t);return e.SetUnselectable(n),n},e.SetUnselectable=function(e){e.setAttribute("unselectable","on")},e.UnifiedHeaderHeightPx=48,e.TopBar2HeightPx=40,e}();(0,i.l)(m,"a12fa7c$ViewerChrome",null,[Sys.IDisposable,r])}}]);
//# sourceMappingURL=https://onenotewebclientbuilds.blob.core.windows.net/official/16.0.12223.31675/OneNoteDS.box4.dll1.js.map